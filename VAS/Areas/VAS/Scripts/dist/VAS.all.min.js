(()=>{var t={141:()=>{VAS=window.VAS||{},function(e,t){e.VAS_PrMonthlySalesWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a,i,n=this,l=(this.ctx,t('<div class="h-100 w-100">')),s=null,o="",r=0,c=0,u="";var d,g=[];this.currentPage=1,this.totalPages=0;var p=0;function v(){console.log(i.getValue()),l.find("#VAS_PageCount_"+p).text(n.currentPage+VIS.Msg.getMsg("VAS_Of")+n.totalPages);var e=g[n.currentPage-1],t=parseFloat(e.PreviousTotal),a=parseFloat(e.CurrentTotal),o=function(e,t){if(0===t)return e>0?"100%":"0%";var a=e-t,i=a/t*100;return i.toFixed(2)+"%"}(a,t);l.find("#VAS_ProductRank_"+p).text("#"+n.currentPage),l.find("#VAS_ProductName_"+p).text(e.ProductName),l.find("#VAS_LastYearSales_"+p).text(u+" "+V(t)+" "+s),l.find("#VAS_CurrentSales_"+p).text(u+" "+ +V(a)+" "+s),l.find(".repfix-resultTxt").text(o);var c=l.find(".VAS-graph-result .vis");o.startsWith("-")?c.removeClass("vis-trending-up").addClass("vis-trending-down"):c.removeClass("vis-trending-down").addClass("vis-trending-up"),r>0&&i.setValue(r)}function _(e){t.ajax({url:VIS.Application.contextUrl+"Product/GetProductMonthlySalesData",data:{ProductID:e,OrganizationUnit:r},dataType:"json",success:function(e){A(JSON.parse(e)),v()},error:function(e,t,a){console.error("Failed to fetch product data:",t,a)}})}function V(e){return e>=1e12?(s=VIS.Msg.getMsg("VAS_Trillion"),(e/1e12).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e9?(s=VIS.Msg.getMsg("VAS_Billion"),(e/1e9).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e6?(s=VIS.Msg.getMsg("VAS_Million"),(e/1e6).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e3?(s=VIS.Msg.getMsg("VAS_Thousand"),(e/1e3).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):(s="",e.toLocaleString(window.navigator.language,{minimumFractionDigits:c,maximumFractionDigits:c}))}function A(e){const a=e.map(e=>e.month),i=e.map(e=>e.cy_month_sales),n=e.map(e=>e.ly_month_sales),s={labels:a,datasets:[{label:VIS.Msg.getMsg("VAS_CurrentYearSales"),data:i,fill:!1,borderColor:"rgb(75, 192, 192)",tension:.1,datalabels:{backgroundColor:"rgba(75, 192, 192, 0.2)",borderRadius:3,padding:6,font:{weight:"bold",size:12},align:"center",anchor:"end"}},{label:VIS.Msg.getMsg("VAS_LastYearSales"),data:n,fill:!1,borderColor:"rgb(255, 99, 132)",tension:.1,datalabels:{backgroundColor:"rgba(255, 99, 132, 0.2)",borderRadius:3,padding:6,font:{weight:"bold",size:12},align:"center",anchor:"end"}}]},o={type:"line",data:s,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",display:!0},datalabels:{display:!0}}},plugins:[ChartDataLabels]};if(d)d.data=s,d.update();else{l.find("canvas").remove();const e=t("<canvas></canvas>");l.find(".VAS-chart-container").append(e),e.css("height","100%"),e.css("width","100%");const a=e[0].getContext("2d");d=new Chart(a,o)}}this.initalize=function(){p=this.widgetInfo.AD_UserHomeWidgetID,e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),l.append(e);var i=function(e){var i=(new Date).getFullYear(),n=i-1,l=t('<div class="VAS-org-unitsales-col VAS-content-container vis-formouterwrpdiv"><div class="VAS-sales-heading">'+VIS.Msg.getMsg("VAS_HighestSellingProduct")+'</div><div class="VAS-organization-block"><div id="VAS_Org_'+e+'" class="VAS_OrgUnitControl"></div><div class="VAS-pagination-container"></div></div><div class="VAS-graph-details"><div class="VAS-salesGraph-heading"><span id="VAS_ProductRank_'+e+'">#1</span>&nbsp<span id="VAS_ProductName_'+e+'"> Product Name</span></div><div class="VAS-totalSales-col"><div class="VAS-startSale-box"><div class="VAS-yearTxt"><span>'+n+'<span></div><div class="VAS-totalSale"><span id="VAS_LastYearSales_'+e+'">520 €</span></div></div><div class="VAS-endSale-box"><div class="VAS-yearSale-col"><div class="VAS-yearTxt"><span>'+i+'<span></div><div class="VAS-totalSale"><span id="VAS_CurrentSales_'+e+'">520 €</span></div></div><div class="VAS-graph-result"><span class="vis vis-trending-down"></span><div class="repfix-resultTxt">-10.32%</div></div></div></div><div class="VAS-graph-col VAS-chart-container" style="display: flex; align-items: center; justify-content: center;"></div></div>');return a=l.find("#VAS_Org_"+e),l}(p);l.append(i)},this.intialLoad=function(){t.ajax({url:VIS.Application.contextUrl+"Product/GetProductSalesAndDetails",data:{OrganizationUnit:r,Type:"DESC"},dataType:"json",success:function(s){if(s=JSON.parse(s)){if(g=s.products,n.totalPages=g.length,u=s.Symbol,c=s.StdPrecision,function(){var e=l.find(".VAS-pagination-container");if(e.empty(),g.length>0){n.totalPages=g.length;var a=t('<div class="VAS-pagination-col"><div class="VAS-arrow-col"><a href="#" id="VAS_Prev_Page_'+p+'"><span class="fa fa-arrow-left"></span></a><a href="#" id="VAS_Next_Page_'+p+'"><span class="fa fa-arrow-right"></span></a></div><div class="VAS-page-count"><span id="VAS_PageCount_'+p+'">1 of '+n.totalPages+"</span></div></div>");a.find("#VAS_Prev_Page_"+p).on("click",function(e){e.preventDefault(),n.currentPage>1&&(n.currentPage--,_(g[n.currentPage-1].Product_ID))}),a.find("#VAS_Next_Page_"+p).on("click",function(e){e.preventDefault(),n.currentPage<n.totalPages&&(n.currentPage++,_(g[n.currentPage-1].Product_ID))}),e.append(a)}}(),g.length>0){g[0];A(s.product_monthly_sales)}o=s.sqlWhereForLookup,a.empty(),orgDivInputWrap=t('<div class="input-group vis-input-wrap">'),$lookupOrg=VIS.MLookupFactory.get(VIS.Env.getCtx(),n.windowNo,0,VIS.DisplayType.Search,"AD_Org_ID",0,!1,o),i=new VIS.Controls.VTextBoxButton("AD_Org_ID",!1,!1,!0,VIS.DisplayType.Search,$lookupOrg),$orgControlWrap=t('<div class="vis-control-wrap">'),orgDivInputWrap.append($orgControlWrap),$orgControlWrap.append(i.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+VIS.Msg.getMsg("VAS_OrgUnit")+'</label><span class= "vis-ev-ctrlinfowrap"</span>'),a.append(orgDivInputWrap),i.fireValueChanged=function(){r=null==i.getValue()?0:i.getValue(),n.intialLoad()},v(),l.find(".VAS-graph-details").show(),l.find(".VAS-pagination-container").show(),e[0].style.visibility="hidden"}else g=[],l.find(".VAS-graph-details").hide(),l.find(".VAS-pagination-container").hide(),e[0].style.visibility="hidden"},error:function(t,a,i){console.error("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return l},this.refreshWidget=function(){d=null,n.currentPage=1,n.totalPages=0,n.intialLoad()}},e.VAS_PrMonthlySalesWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad()},50)},e.VAS_PrMonthlySalesWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_PrMonthlySalesWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_PrMonthlySalesWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},284:()=>{VAS=window.VAS||{},function(e,t){e.VAS_ARInvoiceWidget=function(){var a;this.frame,this.windowNo;var i=this,n=t('<div class="h-100 w-100">'),l=t('<div class="vas-arwidg-receivable-container">'),s=(this.ctx,[]),o=new VIS.CultureSeparator,r=null,c=null,u=null;function d(t,a){var i,n=t<0,l=Math.abs(t);return l>=1e12?(u=e.translatedTexts.VAS_Trillion,i=(l/1e12).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):l>=1e9?(u=e.translatedTexts.VAS_Billion,i=(l/1e9).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):(u="",i=l.toLocaleString(window.navigator.language,{minimumFractionDigits:a,maximumFractionDigits:a})),(n?"-":"")+i}this.initalize=function(){c=0!=VIS.Utility.Util.getValueOfInt(this.widgetInfo.AD_UserHomeWidgetID)?this.widgetInfo.AD_UserHomeWidgetID:i.windowNo,(a=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>')).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),a[0].style.visibility="visible",n.append(a),a[0].style.visibility="visible"},this.intialLoad=function(){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetARInvSchData",{ISOtrx:VIS.Env.getCtx().isSOTrx(i.windowNo)},function(g){var p,v=g;if(null!=v&&v.length>0){p=["VAS_30","VAS_30to60","VAS_60to90","VAS_90to120","VAS_Older","VAS_TotalRec","VAS_TotalPurchase","VAS_Trillion","VAS_Billion"],e.translatedTexts=VIS.Msg.translate(VIS.Env.getCtx(),p,!0),r=[e.translatedTexts.VAS_30,e.translatedTexts.VAS_30to60,e.translatedTexts.VAS_60to90,e.translatedTexts.VAS_90to120,e.translatedTexts.VAS_Older],function(e){o.isDecimalSeparatorDot(window.navigator.language)?(s=e.split("."))[3]=".":e.contains(",")&&((s=e.split(","))[3]=",");0==VIS.Utility.Util.getValueOfDecimal(s[1])&&(s[1]="")}(v[5].arTotalAmtWidget[0].totalAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:v[0].stdPrecision,maximumFractionDigits:v[0].stdPrecision})),l.append('  <div class="vas-arwidg-totalAmt-box" id="vas_arwidtotaamtContainer_'+c+'">    <div class="vas-arwidg-totalRec-amount">      <h1 class="vas-arwidg-rtl-amt">'+s[0]+'<span class="vas-arwidg-cur-symbol">'+s[1]+'<span><span class="vas-arwidg-Symbol">'+v[4].Symbol+'</span></h1>      <div class="vas-arwidg-totalRecTxt">'+(1==VIS.Env.getCtx().isSOTrx(i.windowNo)?e.translatedTexts.VAS_TotalRec:e.translatedTexts.VAS_TotalPurchase)+"</div>    </div>  </div>");for(var _=t('<div class="vas-arwidg-rec-listing" id="vas_listContainer_'+c+'">'),V=0;V<v.length-1;V++){var A='<div class="vas-arwidg-receiveTxt-box"><div class="vas-arwidg-orderTxt">'+r[V]+'</div><div class="vas-arwidg-recBox-amt"><span class="vas-vaswidg-Symbol">'+v[V].Symbol+"</span>"+d(v[V].daysAmt,v[V].stdPrecision)+u;_.append(A)}l.append(_),n.append(l)}a[0].style.visibility="hidden"})},this.getRoot=function(){return n},this.refreshWidget=function(){a[0].style.visibility="visible",l.find("#vas_arwidtotaamtContainer_"+c).remove(),l.find("#vas_listContainer_"+c).remove(),i.intialLoad()}},e.VAS_ARInvoiceWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad()},50)},e.VAS_ARInvoiceWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_ARInvoiceWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_ARInvoiceWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},290:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.VAS_CalloutContract")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.CalculateContDuration=function(e,t,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";this.setCalloutActive(!0);var o=a.getValueOfDate(i.getValue("StartDate")),r=a.getValueOfDate(i.getValue("EndDate"));if(0!=o&&0!=r){var c=(r.getDate()-o.getDate())/30+(r.getMonth()-o.getMonth()+12*(r.getFullYear()-o.getFullYear())),u=(r.getMonth()-o.getMonth())/12+(r.getFullYear()-o.getFullYear()),d=c%12;i.setValue("VAS_ContractMonths",Math.round(d)),i.setValue("VAS_ContractDuration",Math.round(u))}return this.setCalloutActive(!1),i=l=null,""},i.prototype.EndDate=function(e,t,a,i,n,l){if(this.isCalloutActive()||null==n||""==n.toString())return"";if(this.setCalloutActive(!0),null!=a.getValue("StartDate")||null!=a.getValue("DateDoc")){var s=new Date(a.getValue("StartDate")),o=new Date(a.getValue("DateDoc")),r=new Date(n),c=new Date(n);if(r=r.setHours(0,0,0,0),s=s.setHours(0,0,0,0),o=o.setHours(0,0,0,0),r<s||r<o)return a.setValue("EndDate",null),this.setCalloutActive(!1),"VAS_EndDateMustGreater"}return a.setValue("VAS_RenewalDate",new Date(c.setDate(c.getDate()+1))),this.setCalloutActive(!1),a=n=null,""},i.prototype.StartDate=function(e,t,a,i,n,l){if(this.isCalloutActive()||null==n||""==n.toString())return"";this.setCalloutActive(!0);var s=new Date(n),o=new Date(a.getValue("EndDate"));return o=o.toISOString(),s=s.toISOString(),null!=a.getValue("EndDate")&&o<s?(a.setValue("StartDate",null),this.setCalloutActive(!1),"VAS_EndDateMustGreater"):(this.setCalloutActive(!1),a=n=null,"")},i.prototype.RenewalDate=function(e,t,a,i,n,l){if(this.isCalloutActive()||null==n||""==n.toString())return"";if(this.setCalloutActive(!0),null!=a.getValue("EndDate")&&null!=a.getValue("VAS_RenewalDate")){var s=new Date(a.getValue("VAS_RenewalDate"));s.setHours(0,0,0,0);var o=new Date(a.getValue("EndDate"));if(o.setHours(0,0,0,0),s<o)return a.setValue("VAS_RenewalDate",null),this.setCalloutActive(!1),"VAS_RenewalMustGreater"}return this.setCalloutActive(!1),a=n=null,""},i.prototype.TerminationDate=function(e,t,a,i,n,l){if(this.isCalloutActive()||null==n||""==n.toString())return"";if(this.setCalloutActive(!0),null!=a.getValue("StartDate")&&null!=a.getValue("VAS_TerminationDate")&&null!=a.getValue("DateDoc")){var s=new Date(a.getValue("VAS_TerminationDate"));s.setHours(0,0,0,0);var o=new Date(a.getValue("StartDate"));o.setHours(0,0,0,0);var r=new Date(a.getValue("DateDoc"));if(r.setHours(0,0,0,0),s<o||s<r)return a.setValue("VAS_TerminationDate",null),this.setCalloutActive(!1),"VAS_TerminationMustGreater"}return this.setCalloutActive(!1),a=n=null,""},i.prototype.ContractRef=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);var r=e.dataContext.getJSONRecord("MVASContract/GetContractDetails",a.getValueOfInt(s));if(r){if("Y"==r.IsExpiredContracts)return this.setCalloutActive(!1),"VAS_ContractExpired";n.setValue("ContractType",r.ContractType),n.setValue("C_BPartner_ID",r.C_BPartner_ID),n.setValue("Bill_Location_ID",r.Bill_Location_ID),n.setValue("Bill_User_ID",r.Bill_User_ID),n.setValue("VAS_Jurisdiction",r.VAS_Jurisdiction),n.setValue("C_Currency_ID",r.C_Currency_ID),n.setValue("C_IncoTerm_ID",r.C_IncoTerm_ID),n.setValue("C_PaymentTerm_ID",r.C_PaymentTerm_ID),n.setValue("C_Project_ID",r.C_Project_ID),n.setValue("M_PriceList_ID",r.M_PriceList_ID),n.setValue("VA009_PaymentMethod_ID",r.VA009_PaymentMethod_ID),n.setValue("C_BPartner_Location_ID",r.Bill_Location_ID),n.setValue("VAS_ContractCategory_ID",r.VAS_ContractCategory_ID),null!=n.getField("VA097_VendorDetails_ID")&&n.setValue("VA097_VendorDetails_ID",r.VA097_VendorDetails_ID)}return this.setCalloutActive(!1),n=s=null,""},i.prototype.PriceList=function(i,n,l,s,o,r){var c=null;if(this.isCalloutActive()||null==o||""==o.toString())return"";try{var u=a.getValueOfInt(o.toString());if(null==u||0==u)return"";this.setCalloutActive(!0),null!=(c=e.dataContext.getJSONRecord("MPriceList/GetPriceListData",o.toString()))&&l.setValue("C_Currency_ID",c.C_Currency_ID)}catch(e){return this.setCalloutActive(!1),null!=c&&c.close(),this.log(t.SEVERE,"",e),e}return this.setCalloutActive(!1),l=o=null,""},i.prototype.BPartner=function(t,i,n,l,s,o){var r=null;if(this.isCalloutActive()||null==s||""==s.toString())return"";try{var c=0,u="N",d="N";if(null!=s&&(c=a.getValueOfInt(s.toString())),0==c)return"";if(a.getValueOfBoolean(n.getValue("IsReturnTrx")))return"";this.setCalloutActive(!0);var g=!1,p="VA009_",v=t.isSOTrx(i);if(null!=(r=e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix",p))&&(g=r.VA009_),p=g.toString()+","+c,null!=(r=e.dataContext.getJSONRecord("MVASContract/GetBPartnerData",p))){var _=a.getValueOfString(n.getValue("ContractType"));"ASP"==_&&n.setValue("VAS_Jurisdiction",r.VAS_TaxJurisdiction);var V=a.getValueOfInt("ASR"==_?r.M_PriceList_ID:r.PO_PriceList_ID);0!=V&&n.setValue("M_PriceList_ID",V);var A=a.getValueOfInt("ASR"==_?r.C_IncoTerm_ID:r.C_IncoTermPO_ID);A>0&&n.setValue("C_IncoTerm_ID",A),n.setValue("Bill_BPartner_ID",c);var m=a.getValueOfInt(r.Bill_Location_ID);if(0==m){var f=a.getValueOfInt(r.Bill_BPartner_ID);f>0&&n.setValue("Bill_BPartner_ID",f)}else n.setValue("Bill_Location_ID",m);var D=a.getValueOfInt(r.C_BPartner_Location_ID);if(c.toString()==t.getContext("C_BPartner_ID")){var h=t.getContext("C_BPartner_Location_ID");h.length>0&&(D=a.getValueOfInt(h))}if(0==D?n.setValue("C_BPartner_Location_ID",null):(n.setValue("C_BPartner_Location_ID",D),"Y"==a.getValueOfString(r.IsShipTo)&&n.setValue("Bill_Location_ID",D)),g){var C=a.getValueOfInt(r.VA009_PaymentMethod_ID);if(T<=0){var S=e.dataContext.getJSONRecord("MBPartner/GetBPDetails",c);null!=S&&(u=a.getValueOfString(S.IsVendor),d=a.getValueOfString(S.IsCustomer),v?"Y"==u?(C=0,PaymentBasetype=null,"Y"==d&&(C=a.getValueOfInt(S.VA009_PaymentMethod_ID))):"Y"==d&&(C=a.getValueOfInt(S.VA009_PaymentMethod_ID)):C="Y"==u?a.getValueOfInt(S.VA009_PO_PaymentMethod_ID):0)}}0==C?n.setValue("VA009_PaymentMethod_ID",null):n.setValue("VA009_PaymentMethod_ID",C);var I=a.getValueOfInt(r.AD_User_ID);if(c.toString()==t.getContext("C_BPartner_ID")){var y=t.getContext("AD_User_ID");y.length>0&&(I=a.getValueOfInt(y))}0==I?n.setValue("AD_User_ID",null):(n.setValue("AD_User_ID",I),n.setValue("Bill_User_ID",I));var O=a.getValueOfInt(n.getValue("C_PaymentTerm_ID")),T=a.getValueOfDecimal(n.getValue("C_Order_Blanket"));if(O>0&&T>0);else ii=a.getValueOfInt("ASR"==_?r.C_PaymentTerm_ID:r.PO_PaymentTerm_ID),this.checkAdvancePaymentTerm(a.getValueOfInt(n.getValue("C_DocTypeTarget_ID")),ii)?0!=ii&&n.setValue("C_PaymentTerm_ID",ii):n.setValue("C_PaymentTerm_ID",null)}}catch(e){return this.setCalloutActive(!1),e}this.setCalloutActive(!1)},i.prototype.checkAdvancePaymentTerm=function(t,i){var n=!0,l=e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_");if(null!=l&&!l.VA009_)return n;if(0!=a.getValueOfInt(t)&&0!=a.getValueOfInt(i)){var s=t.toString()+","+i.toString();n=e.dataContext.getJSONRecord("MOrder/checkAdvancePaymentTerm",s)}return n},i.prototype.SetProductUOM=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l)return"";this.setCalloutActive(!0);var o=e.dataContext.getJSONRecord("MVASContract/GetProductUOM",l.toString());return null!=o?(i.setValue("C_UOM_ID",o),this.setCalloutActive(!1),""):void 0},i.prototype.UpdateIsSOTrx=function(e,t,a,i,n,l){if(this.isCalloutActive()||null==n||""==n.toString()||0==n)return"";this.setCalloutActive(!0),e.setIsSOTrx(t,"ASR"==n),"ASR"==n&&(a.setValue("IsSOTrx","ASR"==n),a.setValue("VAS_Jurisdiction",null)),this.setCalloutActive(!1)},e.Model.VAS_CalloutContract=i}(VIS,jQuery)},315:()=>{VAS=window.VAS||{},function(e,t){e.AttachUserToBP=function(){var a;this.frame,this.windowNo;var n,l,s,o,r,c,u,d,g,p=null,v=1,_=10,V=null,A=this,m=[],f=null,D=null,h=null,C=null,S=0,I=[],y=null,O=null,T=null,w=null,P=null,b=null,M=null,x=null,N=[],L=null,R=0,U=0;function E(){C=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),y=t("<div class='vas-parent'>"),V=t("<div id='vas-recordCount'><span class='vas-recordCount'></span></div>"),O=t("<div class='vas-businessPartnerInput py-2'>"),c=t("<div class='vas-root'>"),f=t("<div>"),M=t("<div class= 'd-flex'>"),D=t("<div class='vas-lowerDiv'>"),h=t("<div class='vas-bottom'>"),g=t('<div class="input-group-append vas-businessPartnerButton"><button class="input-group-text vas-businessPartnerSearch"><i class="fa fa-search" aria-hidden="true"></i></button></div>'),d=t("<button class='vas-actionbtn'> "+VIS.Msg.getMsg("Cancel")+" </button>"),u=t("<button class='vas-actionbtn vas-disableBtn ' > "+VIS.Msg.getMsg("Ok")+" </button>"),n=t('<ul class="vis-ad-w-p-s-plst"">'),liPage=t("<li></li>"),l=t('<li style="opacity: 0.6;" class ="vas-disablePage" ><div><i class="vis vis-pageup" title="'+VIS.Msg.getMsg("PageDown")+'" style="opacity: 0.6;"></i></div></li>'),r=t("<select class = 'vis-statusbar-combo'></select>"),s=t("<li>").append(r),o=t('<li style="opacity: 1"><div><i class="vis vis-pagedown " title="'+VIS.Msg.getMsg(" PageUp")+'" style = "opacity: 0.6;" ></i ></div ></li> '),n.append(liPage).append(l).append(s).append(o),T=t('<div class="input-group vis-input-wrap mb-0 vas-inputboxPadding" >'),w=t('<div class="vis-control-wrap"><input type="text" maxlength="80" disabled /><label>'+VIS.Msg.getMsg("Employee")+" </label></div>"),T.append(w),w.find("input").val(VIS.context.getContext(a,"Value")),P=t('<div class="input-group vis-input-wrap mb-0 vas-inputboxPadding" >'),b=t('<div class="vis-control-wrap"><input type="text" maxlength="80"  data-hasbtn=" " /><label>'+VIS.Msg.getMsg("VAS_SearchExistingUser")+"</label></div>"),P.append(b).append(g),O.append(T).append(P),y.append(O),f.append(y),M.append(n).append(u).append(d),h.append(V).append(M),c.append(f).append(D).append(h),c.append(C),r.on("change",function(){B(v=r.val(),_,!0),r.find("option[value='"+v+"']").prop("selected",!0),v>=L?(o.css("opacity","0.6"),o.addClass("vas-disablePage"),l.css("opacity","1"),t(l).removeClass("vas-disablePage")):(o.css("opacity","1"),o.removeClass("vas-disablePage")),v<=1?(l.css("opacity","0.6"),t(l).addClass("vas-disablePage"),o.css("opacity","1"),o.removeClass("vas-disablePage")):(l.css("opacity","1"),t(l).removeClass("vas-disablePage"))}),u.on(VIS.Events.onTouchStartOrClick,function(){t.ajax({url:VIS.Application.contextUrl+"VAS/VASAttachUserToBP/UpdateUser",type:"POST",data:{userNames:I,userIds:N,c_BPartnerID:S},success:function(t){if(0==(t=JSON.parse(t)).length)A.frame.close();else{for(var a="<ul>",i=0;i<t.length;i++)a+="<li>"+t[i].userName+":"+t[i].error+"</li>";a+="</ul>",new e.AttachError(A.WindowNo,a).show()}},error:function(e){console.log(e)}})}),l.on("click",function(){o.css("opacity","1"),o.removeClass("vas-disablePage"),(v=r.val()-1)>=1&&(B(v,_,!0),r.val(v)),v<=1&&(l.css("opacity","0.6"),t(l).addClass("vas-disablePage"))}),o.on("click",function(){l.css("opacity","1"),t(l).removeClass("vas-disablePage"),(v=parseInt(r.val())+1)<=L&&(B(v,_,!0),r.val(v)),v>=L&&(o.css("opacity","0.6"),o.addClass("vas-disablePage"))}),g.on(VIS.Events.onTouchStartOrClick,function(){N=[],t(u).addClass("vas-disableBtn"),x=b.children("input").val(),v=1,R=0,m=[],Q(!0),B(v,_,!0),o.css("opacity","1"),o.removeClass("vas-disablePage"),b.children("input").val("")}),d.on(VIS.Events.onTouchStartOrClick,function(){A.frame.close()}),y.on("keyup",function(e){v=1,R=0,m=[],13===e.keyCode&&(x=b.children("input").val(),N=[],t(u).addClass("vas-disableBtn"),Q(!0),B(v,_,!0),o.css("opacity","1"),o.removeClass("vas-disablePage"),b.children("input").val(""))})}function k(e){if(null==e.recid){if(0==U)return void u.addClass("vas-disableBtn");for(var a=w2ui["GridDiv"+A.windowNo].records.length,i=new Set(N),n=0;n<a;n++){var l=w2ui["GridDiv"+A.windowNo].records[n].recid;i.has(l)||N.push(l)}t(u).removeClass("vas-disableBtn")}else{var s=e.recid;if(null!=s&&-1===N.indexOf(s))for(N.push(s),n=0;n<N.length;n++)N[n]=parseInt(N[n],10);t(u).removeClass("vas-disableBtn")}}function G(e){if(null==e.recid){var a=[];for(R=w2ui["GridDiv"+A.windowNo].records.length,i=0;i<R;i++)recid=w2ui["GridDiv"+A.windowNo].records[i].recid,a.push(recid),N=N.filter(function(e){return e!=a[i]});0==N.length&&t(u).addClass("vas-disableBtn")}else recordId=e.recid,0==(N=N.filter(function(e){return e!=recordId})).length&&t(u).addClass("vas-disableBtn")}function B(e,a,i){var n=[];t.ajax({url:VIS.Application.contextUrl+"VAS/VASAttachUserToBP/GetUserList",type:"GET",data:{searchKey:x,pageNo:e,pageSize:a},contentType:"application/json; charset=utf-8",success:function(e){if(e=JSON.parse(e),V.find("span.vas-recordCount").text(VIS.Msg.getMsg("VAS_totalRecords")+": "+e.RecordCount),L=0==e.RecordCount?1:Math.ceil(e.RecordCount/a),null!=e&&null!=e.UserList){R=0,R+=e.UserList.length,U=e.RecordCount;for(var t=0;t<e.UserList.length;t++){var l={};l.recid=e.UserList[t].recid,l.Image=e.UserList[t].ImageUrl,l.Name=e.UserList[t].Name,l.Email=e.UserList[t].Email,l.Mobile=e.UserList[t].Mobile,l.SuperVisor=e.UserList[t].SupervisorName,l.User_ID=e.UserList[t].UserID,n.push(l)}}F(n,i),Q(!1)},error:function(e){Q(!1),console.log(e)}})}function F(e,a){null==p&&0==(m=[]).length&&(m.push({field:"recid",caption:"recid",sortable:!1,size:"0%",hidden:!0}),m.push({field:"Image",caption:VIS.Msg.getMsg("VAS_Image"),sortable:!1,size:"8%",min:35,hidden:!1,render:function(e){return null!=e.Image?'<div class="vis-grid-row-td-icon-center vis-gridImageicon"><img class="vas-businessPartnerImg" alt='+e.Image+' src="'+VIS.Application.contextUrl+e.Image+'"></div>':'<div class="vis-grid-row-td-icon-center vis-gridImageicon" ><div class="vis-app-user-img-wrap"><i class="fa fa-user"></i><img src="" alt="profile image"></div></div>'}}),m.push({field:"User_ID",caption:VIS.Msg.getMsg("VAS_UserID"),sortable:!1,size:"14%",hidden:!1}),m.push({field:"Name",caption:VIS.Msg.getMsg("Name"),sortable:!1,size:"19%",hidden:!1}),m.push({field:"Email",caption:VIS.Msg.getMsg("VAS_Email"),sortable:!1,size:"27%",hidden:!1}),m.push({field:"Mobile",caption:VIS.Msg.getMsg("Mobile"),sortable:!1,size:"16%",hidden:!1}),m.push({field:"SuperVisor",caption:VIS.Msg.getMsg("VAS_SuperVisor"),sortable:!1,size:"16%",hidden:!1}),w2utils.encodeTags(e),p=t(D).w2grid({name:"GridDiv"+A.windowNo,recordHeight:35,show:{selectColumn:!0},multiSelect:!0,columns:m,records:e,onSelect:k,onUnselect:G})),a?(p.clear(),p.add(e)):v>1&&p.add(e),function(){if(r.empty(),L>0){for(var e=0;e<L;e++)r.append(t("<option>").val(e+1).text(e+1));r.val(v)}}(),N.length>0&&p.select.apply(p,N)}function Q(e){C[0].style.visibility=e?"visible":"hidden"}this.display=function(){Q(!0),B(v,_,!1)},this.Initialize=function(){E()},this.getRoot=function(){return c},this.disposeComponent=function(){c&&c.remove(),null!=p&&p.destroy(),p=null,c=null,C=null,m=null,this.getRoot=null,this.disposeComponent=null,this.lowerDiv=null,this.upperDiv=null,this.frame=null,this.bottomDiv=null,this.parentDiv=null,this.$employee=null,this.$textEmployee=null,this.$searchEmployee=null,this.$textSearchEmployee=null,this.inputDiv=null,I=null,u&&u.off(VIS.Events.onTouchStartOrClick),d&&d.off(VIS.Events.onTouchStartOrClick),u=d=null,selectedRecordIds=null,N=null},e.AttachUserToBP.prototype.init=function(e,t){this.frame=t,S=t.getRecord_ID(),this.windowNo=e,a=e,this.Initialize(),this.frame.getContentGrid().append(this.getRoot()),this.frame.getContentGrid().height();this.display()},e.AttachUserToBP.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.AttachUserToBP.prototype.setWidth=function(){return 900},e.AttachUserToBP.prototype.setHeight=function(){return 620},e.AttachUserToBP=e.AttachUserToBP}}(VAS,jQuery)},318:()=>{!function(e,t){function a(a,i,n){this.windowNo=a,this.AD_Client_ID=i,this.AD_Org_ID=0,this.DateFrom=null,this.DateTo=null;var l=this;this.ASchemas=[],this.ASchema=[],this.log=e.Logging.VLogger.getVLogger("AccountViewer"),this.dataByData=null,this._elements=[],this.documentQuery=!1,this.C_AcctSchema_ID=0,this.PostingType="",this.AD_Table_ID=n,this.Record_ID=0,this.whereInfo=[],this.tableInfo=[],this.displayQty=!1,this.displaySourceAmt=!1,this.displayDocumentInfo=!1,this.sortBy1="",this.sortBy2="",this.sortBy3="",this.sortBy4="",this.group1=!1,this.group2=!1,this.group3=!1,this.group4=!1,this._leadingColumns=0,this._ref1=null,this._ref2=null,this.TABLE_ALIAS="zz",this.FUNCTION_COUNT="Count",this.FUNCTION_SUM="Sum",this.onLoaded=null,this.HasOrgUnit=null,0==this.AD_Client_ID&&(this.AD_Client_ID=e.Env.getCtx().getContextAsInt(this.windowNo,"AD_Client_ID")),0==this.AD_Client_ID&&(this.AD_Client_ID=e.Env.getCtx().ctx.AD_Client_ID),0==this.AD_Org_ID&&(this.AD_Org_ID=Number(e.context.getWindowTabContext(this.windowNo,0,"AD_Org_ID")));e.translatedTexts=e.Msg.translate(e.Env.getCtx(),["AmtAcctCr","AmtAcctDr","AmtSourceCr","AmtSourceDr"],!0),this.ELEMENTTYPE_AD_Reference_ID=181,this.ELEMENTTYPE_Account="AC",this.ELEMENTTYPE_Activity="AY",this.ELEMENTTYPE_BPartner="BP",this.ELEMENTTYPE_LocationFrom="LF",this.ELEMENTTYPE_LocationTo="LT",this.ELEMENTTYPE_Campaign="MC",this.ELEMENTTYPE_Organization="OO",this.ELEMENTTYPE_OrgTrx="OT",this.ELEMENTTYPE_Project="PJ",this.ELEMENTTYPE_Product="PR",this.ELEMENTTYPE_SubAccount="SA",this.ELEMENTTYPE_SalesRegion="SR",this.ELEMENTTYPE_UserList1="U1",this.ELEMENTTYPE_UserList2="U2",this.ELEMENTTYPE_UserElement1="X1",this.ELEMENTTYPE_UserElement2="X2",this.getClientAcctSchema=function(a,i){var n=[],s=this;return t.ajax({url:e.Application.contextUrl+"AcctViewerData/GetClientAcctSchema",type:"POST",async:!0,data:{ad_client_id:a,ad_org_id:i},success:function(t){if(t.result&&t.result.AcctSchemas)for(var a=t.result.AcctSchemas,i=0;i<a.length;i++){var l={};c_acctschema_id=a[i].Key,l.Key=c_acctschema_id,l.Name=e.Utility.encodeText(a[i].Name),n.push(l)}if(t.result&&t.result.OtherAcctSchemas){var o=t.result.OtherAcctSchemas;for(i=0;i<o.length;i++){var r={};r.Key=o[i].Key,r.Name=e.Utility.encodeText(o[i].Name),n.push(r)}}s.ASchemas=n,s.ASchema=n[0],s.onLoaded&&s.onLoaded()},error:function(e){l.log.info(e),s.onLoaded&&s.onLoaded()}}),n},this.getClientAcctSchema(this.AD_Client_ID,this.AD_Org_ID)}function i(i,n,l,s,o){var r=t("<div style='position:relative;'>"),c=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),u=this,d=n,g=l,p=s,v=o;this.arrListColumns=[],this.dGrid=null,this.menuForm=!1;var _=!1,V="C_AcctSchema_ID",A="PostingType",m="AD_Org_ID",f="AD_OrgTrx_ID",D="Account_ID",h="SelectDocument",C="AcctDateFrom",S="M_Product_ID",I="C_BPartner_ID",y="C_Project_ID",O="C_Campaign_ID",T=e.Application.contextUrl+"Areas/VIS/Images/base/Find24.gif",w=(e.Application.contextUrl,e.Application.contextUrl,e.Application.contextUrl,t("<button id='btnRefresh_"+p+"'style='margin-top: 0;' class='VIS_Pref_btn-2'><i class='vis vis-refresh'></i></button>")),P=t("<button class='VIS_Pref_btn-2' id='btnPrint_"+p+"' style='margin-top: 0px; margin-left: 10px;'><i class='vis vis-print'></button>"),b=t("<button class='VIS_Pref_btn-2' id='btnRePost_"+p+"' style='margin-top: 10px;'><img src='"+T+"'/></button>"),M=t("<button class='input-group-text' Name='btnSelctDoc' id='btnSelctDoc_"+p+"'><i class='vis vis-find'></i></button>"),x=t("<button class='input-group-text' Name='btnAccount' id='btnAccount_"+p+"'><i class='vis vis-find'></i></button>"),N=t("<button class='input-group-text' Name='btnProduct' id='btnProduct_"+p+"'><i class='vis vis-find'></i></button>"),L=t("<button class='input-group-text' Name='btnBPartner' id='btnBPartner_"+p+"'><i class='vis vis-find'></i></button>"),R=t("<button class='input-group-text'Name='btnProject' id='btnProject_"+p+"'><i class='vis vis-find'></i></button>"),U=t("<button class='input-group-text' Name='btnCampaning' id='btnCampaning_"+p+"'><i class='vis vis-find'></i></button>"),E=t("<button class='input-group-text' Name='btnOrgUnit' id='btnOrgUnit_"+p+"'><i class='vis vis-find'></i></button>"),k=t("<button Name='btnSelctDocClear' id='btnSelctDocClear_"+p+"' class='input-group-text'><i class='vis vis-mark'></i></button>"),G=t("<button  Name='btnAccountClear' id='btnAccountClear_"+p+"'   class='input-group-text'><i class='vis vis-mark'></i></button>"),B=t("<button  Name='btnProductClear' id='btnProductClear_"+p+"'   class='input-group-text'><i class='vis vis-mark'></i></button>"),F=t("<button Name='btnBPartnerClear' id='btnBPartnerClear_"+p+"' class='input-group-text'><i class='vis vis-mark'></i></button>"),Q=t("<button  Name='btnProjectClear' id='btnProjectClear_"+p+"'   class='input-group-text'><i class='vis vis-mark'></i></button>"),$=t("<button Name='btnCampaningClear' id='btnCampaningClear_"+p+"' class='input-group-text'><i class='vis vis-mark'></i></button>"),W=t("<button Name='btnOrgUnitClear' id='btnOrgUnitClear_"+p+"' class='input-group-text'><i class='vis vis-mark'></i></button>"),J=new e.Controls.VComboBox("",!1,!1,!0),j=new e.Controls.VComboBox("",!1,!1,!0),z=new e.Controls.VComboBox("",!1,!1,!0),q=new e.Controls.VComboBox("",!1,!1,!0),Y=new e.Controls.VComboBox("",!1,!1,!0),H=new e.Controls.VComboBox("",!1,!1,!0),K=new e.Controls.VComboBox("",!1,!1,!0),Z=new e.Controls.VComboBox("",!1,!1,!0),X=new e.Controls.VComboBox("",!1,!1,!0),ee=new e.Controls.VLabel,te=new e.Controls.VLabel,ae=new e.Controls.VLabel,ie=new e.Controls.VLabel,ne=new e.Controls.VLabel,le=new e.Controls.VLabel,se=new e.Controls.VLabel,oe=new e.Controls.VLabel,re=new e.Controls.VLabel,ce=new e.Controls.VLabel,ue=new e.Controls.VLabel,de=new e.Controls.VLabel,ge=new e.Controls.VLabel,pe=new e.Controls.VLabel,ve=new e.Controls.VLabel,_e=new e.Controls.VLabel,Ve=new e.Controls.VLabel,Ae=new e.Controls.VLabel,me=t("<button id='btnSel5_"+p+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+T+"' /><span></span></button>"),fe=t("<button id='btnSel6_"+p+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+T+"' /><span></span></button>"),De=t("<button id='btnSel7_"+p+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+T+"' /><span></span></button>"),he=t("<button id='btnSel8_"+p+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+T+"' /><span></span></button>"),Ce=new e.Controls.VLabel,Se=new e.Controls.VLabel,Ie=new e.Controls.VLabel,ye=null,Oe=null,Te=t("<label id='lblSelectDoc_"+p+"' class='VIS_Pref_Label_Font vis-ec-col-lblchkbox'><input id='chkSelectDoc_"+p+"' type='checkbox' checked class='VIS_Pref_automatic'>SelectDoc</label>"),we=t("<input id='chkQty_"+p+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblQty_"+p+"' class='VIS_Pref_Label_Font'>chkQty</label></span>"),Pe=t("<input id='chkforcePost_"+p+"' type='checkbox' class='VIS_Pref_automatic' style='display: inline-block;margin-left: 20px; margin-top: 0;'><span><label id='lblforcePost_"+p+"' class='VIS_Pref_Label_Font'>chkforcePost</label></span>"),be=t("<span style='margin-left: 20px;'><label id='lblDrAndCR_"+p+"' class='VIS_Pref_Label_Font'></label></span>"),Me=t("<input id='chkDisDocinfo_"+p+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblDisDocinfo_"+p+"' class='VIS_Pref_Label_Font'>chkDisDocinfo</label></span>"),xe=t("<input id='chkDisSouce_"+p+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblDisSouce_"+p+"' class='VIS_Pref_Label_Font'>chkDisSouce</label></span>"),Ne=t("<input id='chkSumriz1_"+p+"' type='checkbox' class='VIS_Pref_automatic'>"),Le=t("<input id='chkSumriz2_"+p+"' type='checkbox' class='VIS_Pref_automatic'>"),Re=t("<input id='chkSumriz3_"+p+"' type='checkbox' class='VIS_Pref_automatic'>"),Ue=t("<input id='chkSumriz4_"+p+"' type='checkbox' class='VIS_Pref_automatic'>"),Ee=t("<input id='vdtpkAccDateFrom_"+p+"' type='date' name='DateOrdered'>"),ke=t("<input id='vdtpkAccDateTo_"+p+"' type='date' name='DateOrdered'>"),Ge=null,Be=null,Fe=null,Qe=null,$e=null,We=null,Je=(t(window).width(),t(window).width(),t(window).height()-200),je=null;function ze(){Oe.css("color","rgba(var(--v-c-on-secondary), 1)"),ye.css("font-size","1rem").css("color","rgba(var(--v-c-primary), 1)"),Fe.show(),Be.show(),ulPaging.css("display","none"),divPaging.css("display","none"),We.css("display","none"),b.hide(),btnExportExcel.hide(),Pe.hide(),w.show(),Ce.getControl().show(),be.hide(),te.getControl().hide(),j.getControl().hide(),Be.find("#btnSelctDoc_"+p).attr("name",Be.find("#btnSelctDoc_"+p).parent().find("select").val()+"_ID"),Be.find("#btnSelctDocClear_"+p).attr("name",Be.find("#btnSelctDocClear_"+p).parent().find("select").val()+"_ID")}function qe(){ye.css("color","rgba(var(--v-c-on-secondary), 1)"),Oe.css("font-size","1rem").css("color","rgba(var(--v-c-primary), 1)"),Fe.hide(),Be.hide(),ulPaging.css("display","block"),divPaging.css("display","block"),be.show(),w.hide(),Ce.getControl().hide(),divPaging.append(ulPaging),$e.append(divPaging),We.css("display","block"),notShowPosted?(b.hide(),Pe.hide()):(b.show(),Pe.show(),btnExportExcel.show()),te.getControl().show(),j.getControl().show()}function Ye(e){c.css("display",e?"block":"none")}function He(e){var a=e.attr("name");if(e.find("span").text(" "),t("#txt"+e.attr("id").substring(3)).val(""),je.whereInfo.length>0){var i=je.whereInfo.map(function(e){return e.Key==a}).indexOf(!0);je.whereInfo.splice(i,1)}return e.width=44,0}function Ke(){null!=ye&&ye.on(e.Events.onTouchStartOrClick,function(){ze()}),null!=Oe&&Oe.on(e.Events.onTouchStartOrClick,function(){u.dGrid.refresh(),qe()}),null!=J&&J.getControl().change(function(){Ze()}),null!=j&&j.getControl().change(function(){Ye(!0),je.C_AcctSchema_ID=j.getControl().find("option:selected").val(),setTimeout(function(){je.Query(i,tt,at,1)},2)}),null!=w&&w.on("click",function(){Ye(!0),j.setValue(J.getControl().find("option:selected").val()),et(),Ye(!1)}),null!=Te&&Te.change(function(){it()}),null!=Y&&Y.getControl().change(function(){nt(),je.Record_ID=l,je.AD_Table_ID}),null!=b&&(b.on("click",function(){Ye(!0);var a=void e.ADialog.confirm("PostImmediate?",!0,"","Confirm",function(a){if(a){if(Ye(!0),je.documentQuery&&0!=je.AD_Table_ID&&0!=je.Record_ID){var i=Pe.prop("checked");n=function(a){var n=!1;if("Yes"==a&&(n=!0),window.FRPT&&n){var l=Number(e.context.getWindowTabContext(p,0,"AD_Org_ID")),s=Number(e.context.getWindowTabContext(p,0,"C_DocType_ID"));t.ajax({url:e.Application.contextUrl+"FRPT/PostingLogicFRPT/PostImediateFRPT",dataType:"json",async:!0,data:{AD_Client_ID:je.AD_Client_ID,AD_Table_ID:je.AD_Table_ID,Record_ID:je.Record_ID,force:i,OrgID:l,AD_Window_ID:v,DocTypeID:s},error:function(t){Ye(!1),e.ADialog.info(e.Msg.getMsg("ERRORGettingPostingServer"))},success:function(t){t.result&&(e.ADialog.info("",!0,t.result,null),et()),Ye(!1)}})}else t.ajax({url:e.Application.contextUrl+"Posting/PostImmediate",dataType:"json",data:{AD_Client_ID:je.AD_Client_ID,AD_Table_ID:je.AD_Table_ID,Record_ID:je.Record_ID,force:i},error:function(t){Ye(!1),e.ADialog.info(e.Msg.getMsg("ERRORGettingPostingServer"))},success:function(e){"OK"==e.result&&et(),Ye(!1)}})},t.ajax({url:e.Application.contextUrl+"Posting/PostByNewLogic",dataType:"json",async:!0,data:{AD_Client_ID:e.context.getAD_Client_ID()},error:function(t){alert(e.Msg.getMsg("ERRORGettingPostingServer"))},success:function(e){n&&n(e.result)}})}return!0}return Ye(!1),!1;var n});setTimeout(function(){var i;a?(i=je.Record_ID,t.ajax({url:e.Application.contextUrl+"AcctViewerData/AcctViewerRePost",type:"POST",async:!0,data:{dataRecID:i},success:function(e){},error:function(e){$selfObj.log.info(e),Ye(!1)}})):Ye(!1)},5)}),btnExportExcel.on("click",function(){t.ajax({url:e.Application.contextUrl+"Posting/DownloadExcel",dataType:"json",data:{AD_Table_ID:n,Record_ID:l},error:function(t){Ye(!1),e.ADialog.info(e.Msg.getMsg("ERRORGettingPostingServer"))},success:function(t){if(null!=t&&t.FileContents.length>0){var a=new Uint8Array(t.FileContents),i=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=document.createElement("a");n.href=window.URL.createObjectURL(i),n.download=t.FileDownloadName,n.click()}else e.ADialog.info(e.Msg.getMsg("ExcelError"))}})})),null!=M&&M.on("click",function(){lt(M)}),null!=x&&x.on("click",function(){lt(x)}),null!=N&&N.on("click",function(){lt(N)}),null!=L&&L.on("click",function(){lt(L)}),null!=R&&R.on("click",function(){lt(R)}),null!=U&&U.on("click",function(){lt(U)}),null!=E&&E.on("click",function(){lt(E)}),null!=k&&k.on("click",function(){He(M)}),null!=G&&G.on("click",function(){He(x)}),null!=B&&B.on("click",function(){He(N)}),null!=F&&F.on("click",function(){He(L)}),null!=Q&&Q.on("click",function(){He(R)}),null!=$&&$.on("click",function(){He(U)}),null!=W&&W.on("click",function(){He(E)})}function Ze(){var t=J.getControl().find("option:selected").val();if(null!=t){je.C_AcctSchema_ID=t;var a=je.getAcctSchemaElements(je.C_AcctSchema_ID);H.getControl().empty(),K.getControl().empty(),Z.getControl().empty(),X.getControl().empty(),Xe({Key:"",Name:""}),Xe({Key:"DateAcct",Name:e.Msg.translate(e.Env.getCtx(),"DateAcct")}),Xe({Key:"DateTrx",Name:e.Msg.translate(e.Env.getCtx(),"DateTrx")}),Xe({Key:"C_Period_ID",Name:e.Msg.translate(e.Env.getCtx(),"C_Period_ID")});var i=[];i.push(pe),i.push(ve),i.push(_e),i.push(Ve);var n=[];n.push(N),n.push(L),n.push(R),n.push(U),n.push(B),n.push(F),n.push(Q),n.push($),n.push(me),n.push(fe),n.push(De),n.push(he),n.push(E),n.push(W);for(var l=0,s=0;s<a.length&&l<i.length;s++){var o=a[s][0],r=je.getColumnName(o.elementtype),c=je.getColumnName(o.elementtype);Xe({Key:r,Name:e.Msg.translate(e.Env.getCtx(),c)}),"OO"!=o.elementtype&&"AC"!=o.elementtype&&(i[l].getControl().text(e.Msg.translate(e.Env.getCtx(),c)),i[l].getControl().show(),n[l].attr("Name",r),n[l].find("span").text(""),n[l].show(),l++)}for(;l<i.length;)i[l].getControl().hide(),l++;H.getControl().prop("selectedIndex",0),K.getControl().prop("selectedIndex",0),Z.getControl().prop("selectedIndex",0),X.getControl().prop("selectedIndex",0)}}function Xe(e){H.getControl().append(" <option selected value='"+e.Key+"' >"+e.Name+"</option>"),K.getControl().append(" <option selected value='"+e.Key+"' >"+e.Name+"</option>"),Z.getControl().append(" <option selected value='"+e.Key+"' >"+e.Name+"</option>"),X.getControl().append(" <option selected value='"+e.Key+"' >"+e.Name+"</option>")}function et(){var t="";je.C_AcctSchema_ID=0,je.AD_Org_ID=0;var a=J.getControl().find("option:selected").val();if(null!=a&&(je.C_AcctSchema_ID=a),t=t.concat("C_AcctSchema_ID=").concat(je.C_AcctSchema_ID),null!=(a=z.getControl().find("option:selected").val())&&"0"!=a&&(je.PostingType=a),t=t.concat(", PostingType=").concat(je.PostingType),je.documentQuery=Te.find("input").prop("checked"),t=t.concat(", DocumentQuery=").concat(je.documentQuery),Te.find("input").prop("checked")){if(0==je.AD_Table_ID||0==je.Record_ID)return;t=t.concat(", AD_Table_ID=").concat(je.AD_Table_ID).concat(", Record_ID=").concat(je.Record_ID)}else{je.DateFrom=Ee.val(),""!=je.DateFrom&&(t=t.concat(", DateFrom=").concat(je.DateFrom)),je.DateTo=ke.val(),""!=je.DateTo&&(t=t.concat(", DateTo=").concat(je.DateTo)),null!=(a=q.getControl().find("option:selected").val())&&(je.AD_Org_ID=a),t=t.concat(", AD_Org_ID=").concat(je.AD_Org_ID);var n=je.whereInfo;if(null!=n)for(var l=0;l<n.length;l++)t=t.concat(", ").concat(n[l].Value)}je.displayQty=we.prop("checked"),t=t.concat(", - Display Qty=").concat(je.displayQty),je.displaySourceAmt=xe.prop("checked"),t=t.concat(", Source=").concat(je.displaySourceAmt),je.displayDocumentInfo=Me.prop("checked"),t=t.concat(", Doc=").concat(je.displayDocumentInfo),null!=H.getControl().find("option:selected").val()&&(je.sortBy1=H.getControl().find("option:selected").val()),je.group1=Ne.prop("checked"),t=t.concat(" - Sorting: ").concat(je.sortBy1).concat("/").concat(je.group1),null!=K.getControl().find("option:selected").val()&&(je.sortBy2=K.getControl().find("option:selected").val()),je.group2=Le.prop("checked"),t=t.concat(", ").concat(je.sortBy2).concat("/").concat(je.group2),null!=Z.getControl().find("option:selected").val()&&(je.sortBy3=Z.getControl().find("option:selected").val()),je.group3=Re.prop("checked"),t=t.concat(", ").concat(je.sortBy3).concat("/").concat(je.group3),null!=X.getControl().find("option:selected").val()&&(je.sortBy4=X.getControl().find("option:selected").val()),je.group4=Ue.prop("checked"),t=t.concat(", ").concat(je.sortBy4).concat("/").concat(je.group4),w.Enabled=!1,Ce.getControl().text(e.Msg.translate(e.Env.getCtx(),"Processing")),u.getIsMenu()?_?(u.dGrid.refresh(),qe()):ze():qe(),_=!0;je.Query(i,tt,at,1),je.C_AcctSchema_ID>0&&(je.C_AcctSchema_ID==j.oldValue&&j.setValue(null),j.setValue(je.C_AcctSchema_ID)),w.Enabled=!0,Ce.getControl().text(e.Msg.getMsg("VIS_EnterSelctionAndDisplayToQueryFind"))}function tt(a){null!=a&&function(a){null!=u.dGrid&&(u.dGrid.destroy(),u.dGrid=null),u.arrListColumns=[];for(var i=[],n=1,l=0;l<a.Data.length;l++){var s=a.Data[l];be.text(a.DebitandCredit);for(var o={},r=0;r<a.Columns.length;r++)if(u.arrListColumns.length!=a.Columns.length&&(null==s[r]||"number"!=typeof s[r]||e.translatedTexts.AmtAcctCr!=a.Columns[r]&&e.translatedTexts.AmtAcctDr!=a.Columns[r]&&e.translatedTexts.AmtSourceCr!=a.Columns[r]&&e.translatedTexts.AmtSourceDr!=a.Columns[r]?u.arrListColumns.push({field:a.Columns[r],caption:e.Msg.translate(e.Env.getCtx(),a.Columns[r]),sortable:!0,size:"16%",hidden:!1}):u.arrListColumns.push({field:a.Columns[r],caption:e.Msg.translate(e.Env.getCtx(),a.Columns[r]),sortable:!0,size:"16%",hidden:!1,style:"text-align: right"})),null!=s[r]&&"object"==typeof s[r])o[a.Columns[r]]=s[r].Name;else if(null!=s[r]&&a.DataType[r].indexOf("Date")>=0){if(""!=s[r]){var c=new Date(s[r]);null!=i&&(o[a.Columns[r]]=c.toLocaleDateString())}}else null==s[r]||"number"!=typeof s[r]||e.translatedTexts.AmtAcctCr!=a.Columns[r]&&e.translatedTexts.AmtAcctDr!=a.Columns[r]&&e.translatedTexts.AmtSourceCr!=a.Columns[r]&&e.translatedTexts.AmtSourceDr!=a.Columns[r]?o[a.Columns[r]]=s[r]:o[a.Columns[r]]=parseFloat(s[r]).toLocaleString(window.navigator.language,{minimumFractionDigits:a.Precision,maximumFractionDigits:a.Precision});o.recid=n,n++,i.push(o)}setTimeout(10),w2utils.encodeTags(i),u.dGrid=t(We).w2grid({name:"gridAccViewer"+p,recordHeight:37,columns:u.arrListColumns,records:i})}(a),Ye(!1)}function at(e){if(cmbPage.empty(),e.TotalPage>0){for(var a=0;a<e.TotalPage;a++)cmbPage.append(t("<option value="+(a+1)+">"+(a+1)+"</option>"));cmbPage.val(e.CurrentPage),e.TotalPage>e.CurrentPage?(liNextPage.css("opacity","1"),liLastPage.css("opacity","1")):(liNextPage.css("opacity","0.6"),liLastPage.css("opacity","0.6")),e.CurrentPage>1?(liFirstPage.css("opacity","1"),liPrevPage.css("opacity","1")):(liFirstPage.css("opacity","0.6"),liPrevPage.css("opacity","0.6")),1==e.TotalPage&&(liFirstPage.css("opacity","0.6"),liPrevPage.css("opacity","0.6"),liNextPage.css("opacity","0.6"),liLastPage.css("opacity","0.6"))}else liFirstPage.css("opacity","0.6"),liPrevPage.css("opacity","0.6"),liNextPage.css("opacity","0.6"),liLastPage.css("opacity","0.6")}function it(){Te.find("input").prop("checked")?(Y.getControl().removeAttr("disabled"),M.removeAttr("disabled"),k.removeAttr("disabled"),Ee.attr("disabled","disabled"),ke.attr("disabled","disabled"),q.getControl().attr("disabled","disabled"),x.attr("disabled","disabled"),N.attr("disabled","disabled"),L.attr("disabled","disabled"),R.attr("disabled","disabled"),U.attr("disabled","disabled"),E.attr("disabled","disabled"),G.attr("disabled","disabled"),B.attr("disabled","disabled"),F.attr("disabled","disabled"),Q.attr("disabled","disabled"),$.attr("disabled","disabled"),W.attr("disabled","disabled"),me.attr("disabled","disabled"),fe.attr("disabled","disabled"),De.attr("disabled","disabled"),he.attr("disabled","disabled")):(Y.getControl().attr("disabled","disabled"),M.attr("disabled","disabled"),k.attr("disabled","disabled"),Ee.removeAttr("disabled"),ke.removeAttr("disabled"),q.getControl().removeAttr("disabled"),x.removeAttr("disabled"),N.removeAttr("disabled"),L.removeAttr("disabled"),R.removeAttr("disabled"),U.removeAttr("disabled"),E.removeAttr("disabled"),G.removeAttr("disabled"),B.removeAttr("disabled"),F.removeAttr("disabled"),Q.removeAttr("disabled"),$.removeAttr("disabled"),W.removeAttr("disabled"),me.removeAttr("disabled"),fe.removeAttr("disabled"),De.removeAttr("disabled"),he.removeAttr("disabled"))}function nt(){var e=Y.getControl().find("option:selected").val();null!=e&&null!=jQuery.grep(je.tableInfo,function(t){return t.Name==e})[0]&&(je.AD_Table_ID=jQuery.grep(je.tableInfo,function(t){return t.Name==e})[0].Key),M.find("span").text(""),M.attr("Name",e+"_ID"),k.attr("Name",e+"_ID")}function lt(a){null==je.HasOrgUnit&&t.ajax({url:e.Application.contextUrl+"AcctViewerData/HasOrganizationUnit",dataType:"json",async:!1,error:function(t){alert(e.Msg.getMsg("ERROR"))},success:function(e){null!=e&&(je.HasOrgUnit=e.result)}});var i=a.attr("name"),n="IsSummary='N'",l=i;if(i.equals("Account_ID"))l="C_ElementValue_ID",null!=(s=je.getAcctSchemaElement("AC"))&&(n+=" AND C_Element_ID="+s.c_element_id);else if(i.equals("User1_ID")){l="C_ElementValue_ID",null!=(s=je.getAcctSchemaElement("U1"))&&(n+=" AND C_Element_ID="+s.c_element_id)}else if(i.equals("User2_ID")){var s;l="C_ElementValue_ID",null!=(s=je.getAcctSchemaElement("U2"))&&(n+=" AND C_Element_ID="+s.c_element_id)}else Te.find("input").prop("checked")&&(n="");var o,r=l.substring(0,l.length-3);"M_Product_ID"==i?o=new e.InfoWindow(101,"",je.windowNo,"",!1):"C_BPartner_ID"==i?o=new e.InfoWindow(100,"",je.windowNo,"",!1):i==f?(r=(l=m).substring(0,l.length-3),je.HasOrgUnit&&(n+=" AND (IsCostCenter='Y' OR IsProfitCenter='Y')"),o=new e.infoGeneral(!0,je.windowNo,"",r,l,!1,n)):o=new e.infoGeneral(!0,je.windowNo,"",r,l,!1,n),o.onClose=function(){var e=null,n=o.getSelectedValues();return null!=n&&n.length>0&&(e=l+"="+n.toString()),o=null,null==e||0==e.length||0==n.length?(He(a),0):(a==M?je.Record_ID=n:(He(a),je.whereInfo.push({Key:i,Value:i+"="+n})),a.attr("id")=="btnAccount_"+p&&t("#txtAccount_"+p).val(je.getButtonText(r,l,e)),a.attr("id")=="btnOrgUnit_"+p&&t("#txtOrgUnit_"+p).val(je.getButtonText(r,l,e)),a.attr("id")=="btnProduct_"+p&&t("#txtProduct_"+p).val(je.getButtonText(r,l,e)),a.attr("id")=="btnBPartner_"+p&&t("#txtBPartner_"+p).val(je.getButtonText(r,l,e)),a.attr("id")=="btnProject_"+p&&t("#txtProject_"+p).val(je.getButtonText(r,l,e)),a.find("span").text(je.getButtonText(r,l,e)),""!=a.find("span").text()?a.AutoSize=!0:a.Width=44,n)},o.show()}function st(t,a){for(var i=0;i<a.length;i++)t.append(" <option selected value='"+a[i].Key+"' >"+e.Utility.decodeText(a[i].Name)+"</option>");t.prop("selectedIndex",0)}divPaging=t("<div class='d-flex align-items-center ml-auto'><button id='btnExportExcel_"+u.windowNo+"' class='vis-btnExcelExport mr-2'><span class='vis vis-doc-excel'> "+e.Msg.getMsg("ExcelExportData")+"</span></button><div class='vis-info-pagingwrp' style='text-align: right; flex: 1;''></div>"),ulPaging=t('<ul class="vis-statusbar-ul">'),liFirstPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="'+e.Msg.getMsg("FirstPage")+'" style="opacity: 0.6;"></i></div></li>'),liPrevPage=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="'+e.Msg.getMsg("PageUp")+'" style="opacity: 0.6;"></i></div></li>'),cmbPage=t("<select>"),liCurrPage=t("<li>").append(cmbPage),liNextPage=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="'+e.Msg.getMsg("PageDown")+'" style="opacity: 0.6;"></i></div></li>'),liLastPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="'+e.Msg.getMsg("LastPage")+'" style="opacity: 0.6;"></i></div></li>'),ulPaging.append(liFirstPage).append(liPrevPage).append(liCurrPage).append(liNextPage).append(liLastPage),liFirstPage.on("click",function(){"1"==t(this).css("opacity")&&(Ye(!0),je.Query(i,tt,at,1))}),liPrevPage.on("click",function(){"1"==t(this).css("opacity")&&(Ye(!0),je.Query(i,tt,at,parseInt(cmbPage.val())-1))}),liNextPage.on("click",function(){"1"==t(this).css("opacity")&&(Ye(!0),je.Query(i,tt,at,parseInt(cmbPage.val())+1))}),liLastPage.on("click",function(){"1"==t(this).css("opacity")&&(Ye(!0),je.Query(i,tt,at,parseInt(cmbPage.find("Option:last").val())))}),cmbPage.on("change",function(){Ye(!0),je.Query(i,tt,at,cmbPage.val())}),btnExportExcel=divPaging.find("#btnExportExcel_"+u.windowNo),this.showDialog=function(){!function(){notShowPosted=e.Env.getCtx().getContext("#SHOW_REPOST").equals("N"),Ge=t("<div id='topDiv_"+p+"' style='float: left; width: 100%;'><div id='queryDiv_"+p+"'style='display: inline-block; margin-right: 15px; margin-top: 5px' ><label id='lblquery_"+p+"' class='VIS_Pref_Label_Font' style='cursor: pointer;font-size: 1rem;color: rgba(var(--v-c-primary), 1);'>"+e.Msg.getMsg("ViewerQuery")+"</label></div><div id='resulttopDiv_"+p+"' style='display: inline-block; width: 160px;'><label id='lblresult_"+p+"' class='VIS_Pref_Label_Font' style='vertical-align: middle; cursor: pointer;'>"+e.Msg.getMsg("ViewerResult")+"</label></div></div></div>");var a=t("<div id='resultTopFilterDiv_"+p+"' style='float: right;width: 50%;'>"),i=t('<div class="input-group vis-input-wrap">'),n=t('<div class="vis-control-wrap">');a.append(i),i.append(n),n.append(j.getControl()).append(te.getControl()),Ge.append(a),Be=t("<div class='vis-leftsidebarouterwrap' id='leftSideDiv_"+p+"' style='float: left;background-color: rgba(var(--v-c-secondary), 1);overflow: auto;padding: 10px;'>"),e.Application.isRTL&&Be.css("float","right"),Be.css("width","50%"),Be.css("height",Je),Qe=t("<div style='float: left;width: 100%;height: 100%;' id='parameterLeftDiv_"+p+"'>"),Be.append(Qe);var l=t("<table style='width: 100%;height: 100%;'>"),s=t("<tr>"),o=t("<td>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">');Qe.append(l),l.append(s),s.append(o),o.append(d),d.append(g),g.append(J.getControl()).append(ee.getControl()),s=t("<tr>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">'),l.append(s),o=t("<td>"),s.append(o),o.append(d),d.append(g),g.append(z.getControl()).append(ae.getControl()),s=t("<tr>"),o=t("<td>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">'),l.append(s),s.append(o),o.append(d),d.append(g),g.append(Te),s=t("<tr>"),o=t("<td>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">');var v=t('<div class="input-group-append">');l.append(s),s.append(o),o.append(d),d.append(g),d.append(v),g.append(Y.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")),v.append(M).append(k),s=t("<tr>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">'),l.append(s),o=t("<td>"),s.append(o),o.append(d),d.append(g),g.append(Ee).append(ie.getControl()),s=t("<tr>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">'),l.append(s),o=t("<td>"),s.append(o),o.append(d),d.append(g),g.append(ke).append(ne.getControl()),s=t("<tr>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">'),l.append(s),o=t("<td>"),s.append(o),o.append(d),d.append(g),g.append(q.getControl()).append(le.getControl()),s=t("<tr>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">'),v=t('<div class="input-group-append">');var _=t('<input type="text" id="txtAccount_'+p+'" readonly data-hasbtn=" ">');l.append(s),o=t("<td>"),s.append(o),o.append(d),d.append(g),d.append(v),g.append(_).append(se.getControl()),v.append(x).append(G),s=t("<tr>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">'),v=t('<div class="input-group-append">'),_=t('<input type="text" id="txtOrgUnit_'+p+'" readonly data-hasbtn=" ">'),l.append(s),o=t("<td>"),s.append(o),o.append(d),d.append(g),d.append(v),g.append(_).append(Ae.getControl()),v.append(E).append(W),s=t("<tr>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">'),v=t('<div class="input-group-append">'),_=t('<input type="text" id="txtProduct_'+p+'" readonly data-hasbtn=" ">'),l.append(s),o=t("<td>"),s.append(o),o.append(d),d.append(g),d.append(v),g.append(_).append(oe.getControl()),v.append(N).append(B),s=t("<tr>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">'),v=t('<div class="input-group-append">'),_=t('<input type="text" id="txtBPartner_'+p+'" readonly data-hasbtn=" ">'),l.append(s),o=t("<td>"),s.append(o),o.append(d),d.append(g),d.append(v),g.append(_).append(re.getControl()),v.append(L).append(F),s=t("<tr>"),d=t('<div class="input-group vis-input-wrap">'),g=t('<div class="vis-control-wrap">'),v=t('<div class="input-group-append">'),_=t('<input type="text" id="txtProject_'+p+'" readonly data-hasbtn=" ">'),l.append(s),o=t("<td>"),s.append(o),o.append(d),d.append(g),d.append(v),g.append(_).append(ce.getControl()),v.append(R).append(Q),(Fe=t("<div id='rightSideDiv_"+p+"' style='float: right;margin-bottom: 3px; margin-right: 0px; '>")).css("width","50%"),Fe.css("height",Je),Qe=t("<div style='float: left;width: 100%;height: 100%;' id='parameterRightDiv_"+p+"'>"),Fe.append(Qe),l=t("<table style='width: 100%;height: 100%;'>"),s=t("<tr>"),o=t("<td style='padding: 0px 15px 0px;'>"),Qe.append(l),l.append(s),s.append(o),o.append(Me),s=t("<tr>"),o=t("<td style='padding: 0px 15px 0px;'>"),l.append(s),s.append(o),o.append(xe),s=t("<tr>"),o=t("<td style='padding: 0px 15px 0px;'>"),l.append(s),s.append(o),o.append(we),s=t("<tr>"),o=t("<td style='padding: 0px 15px 0px;'>"),l.append(s),s.append(o),o.append(de.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")),o=t("<td style='padding: 0px 15px 0px;'>"),s.append(o),o.append(ge.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")),s=t("<tr>"),o=t("<td style='padding: 0px 15px 0px;'>"),l.append(s),s.append(o),o.append(H.getControl().css("display","inline-block").css("width","100%").css("height","32px")),o=t("<td style='padding: 0px 15px 0px;'>"),s.append(o),o.append(Ne),s=t("<tr>"),o=t("<td style='padding: 0px 15px 0px;'>"),l.append(s),s.append(o),o.append(K.getControl().css("display","inline-block").css("width","100%").css("height","32px")),o=t("<td style='padding: 0px 15px 0px;'>"),s.append(o),o.append(Le),s=t("<tr>"),o=t("<td style='padding: 0px 15px 0px;'>"),l.append(s),s.append(o),o.append(Z.getControl().css("display","inline-block").css("width","100%").css("height","32px")),o=t("<td style='padding: 0px 15px 0px;'>"),s.append(o),o.append(Re),s=t("<tr>"),o=t("<td style='padding: 0px 15px 0px;'>"),l.append(s),s.append(o),o.append(X.getControl().css("display","inline-block").css("width","100%").css("height","32px")),o=t("<td style='padding: 0px 15px 0px;'>"),s.append(o),o.append(Ue),$e=t("<div class='vis-acctviewerbottdiv'>"),u.getIsMenu()||($e.append(b),$e.append(Pe).append(be)),$e.append(Ce.getControl().addClass("VIS_Pref_Label_Font")),$e.append(w),$e.append(P),(We=t("<div id='resultDiv_"+p+"' style='float: left; width: 100%; display: none;'>")).css("height",Je),r.append(Ge).append(Be).append(Fe).append(We).append($e),r.append(c)}(),Ye(!0),ye=r.find("#lblquery_"+p),Oe=r.find("#lblresult_"+p),u.getIsMenu()?ze():qe(),b.hide(),Pe.hide(),P.hide(),Se.getControl().text(e.Msg.getMsg("Selection")),ee.getControl().text(e.Msg.translate(e.Env.getCtx(),V)),te.getControl().text(e.Msg.translate(e.Env.getCtx(),V)),ae.getControl().text(e.Msg.translate(e.Env.getCtx(),A)),Te.find("label").text(e.Msg.getMsg(h)),le.getControl().text(e.Msg.translate(e.Env.getCtx(),m)),se.getControl().text(e.Msg.translate(e.Env.getCtx(),D)),ie.getControl().text(e.Msg.translate(e.Env.getCtx(),C)),ne.getControl().text(e.Msg.translate(e.Env.getCtx(),"AcctDateTo")),oe.getControl().text(e.Msg.translate(e.Env.getCtx(),S)),re.getControl().text(e.Msg.translate(e.Env.getCtx(),I)),ce.getControl().text(e.Msg.translate(e.Env.getCtx(),"Project")),ue.getControl().text(e.Msg.translate(e.Env.getCtx(),O)),Ae.getControl().text(e.Msg.translate(e.Env.getCtx(),"OrganizationUnit")),Ie.getControl().text(e.Msg.getMsg("Display")),we.find("label").text(e.Msg.getMsg("DisplayQty")),xe.find("label").text(e.Msg.getMsg("DisplaySourceInfo")),Me.find("label").text(e.Msg.getMsg("DisplayDocumentInfo")),de.getControl().text(e.Msg.getMsg("SortBy")),ge.getControl().text(e.Msg.getMsg("GroupBy")),Ce.getControl().css("color","rgba(var(--v-c-primary), 1)"),b.text(e.Msg.getMsg("RePost")),notShowPosted?(b.hide(),Pe.find("label").text(e.Msg.getMsg("Force")),Pe.hide()):(b.show(),Pe.find("label").text(e.Msg.getMsg("Force")),Pe.show()),Ke(),function(t,n){(je=new a(p,i,t)).onLoaded=function(){st(J.getControl(),je.getAcctSchema()),j.getControl().append("<option value='-1' ></option>"),st(j.getControl(),je.getAcctSchema()),Ze(),st(Y.getControl(),je.getTable()),st(z.getControl(),je.getPostingType()),st(q.getControl(),je.getOrg()),M.find("span").text(""),x.attr("Name",D),G.attr("Name",D),x.find("span").text(""),N.attr("Name",S),B.attr("Name",S),N.find("span").text(""),L.attr("Name",I),F.attr("Name",I),L.find("span").text(""),R.attr("Name",y),Q.attr("Name",y),R.find("span").text(""),U.attr("Name",O),$.attr("Name",O),U.find("span").text(""),E.attr("Name",f),W.attr("Name",f),E.find("span").text("");var a=0!=t&&0!=n;a&&Te.find("input").prop("checked",!0),it(),nt(),Ce.getControl().text(e.Msg.getMsg("VIS_EnterSelctionAndDisplayToQueryFind")),Ce.getControl().css("color","rgba(var(--v-c-primary), 1)"),a&&(je.AD_Table_ID=t,je.Record_ID=n),et()}}(d,g),r.dialog({modal:!0,resizable:!1,title:e.Msg.getMsg("AcctViewer"),width:t(window).width()/2+t(window).width()/2/2,position:{at:"center top",of:window},close:function(){null!=u.dGrid&&(u.dGrid.destroy(),u.dGrid=null),u.dispose(),u=null,r.dialog("destroy"),r=null}})},this.disposeComponent=function(){w&&w.off("click"),P&&P.off("click"),b&&b.off("click"),M&&M.off("click"),x&&x.off("click"),N&&N.off("click"),L&&L.off("click"),R&&R.off("click"),U&&U.off("click"),k&&k.off("click"),G&&G.off("click"),B&&B.off("click"),F&&F.off("click"),Q&&Q.off("click"),$&&$.off("click"),W&&W.off("click"),E&&E.off("click"),d=null,g=null,p=null,this.arrListColumns=null,this.dGrid=null,V=null,A=null,m=null,D=null,h=null,C=null,T=null,w=null,P=null,b=null,btnExportExcel=null,M=null,x=null,N=null,L=null,R=null,U=null,k=null,G=null,B=null,F=null,Q=null,$=null,J=null,j=null,z=null,q=null,Y=null,H=null,K=null,Z=null,X=null,ee=null,te=null,ae=null,ie=null,ne=null,le=null,se=null,oe=null,re=null,ce=null,ue=null,de=null,ge=null,pe=null,ve=null,_e=null,Ve=null,me=null,fe=null,De=null,he=null,Ce=null,Se=null,Ie=null,ye=null,Oe=null,Te=null,we=null,Pe=null,Me=null,xe=null,Ne=null,Le=null,Re=null,Ue=null,Ee=null,ke=null,Ge=null,Be=null,Fe=null,Qe=null,$e=null,We=null,Je=null,je=null,c=null,this.disposeComponent=null}}a.prototype.getAcctSchema=function(){return this.ASchemas},a.prototype.getTable=function(){var a=[],i=this;return t.ajax({url:e.Application.contextUrl+"AcctViewerData/AcctViewerGetTabelData",type:"POST",async:!1,success:function(t){if(null!=this.tableInfo&&null!=this.tableInfo||(this.tableInfo=[]),t.result){a.push({Key:"",Name:""});for(var n=t.result,l=0;l<n.length;l++){var s=n[l].AD_Table_ID,o=e.Utility.encodeText(n[l].TableName),r="";r="C_Order"==o?e.Msg.getMsg("Order"):e.Msg.translate(e.Env.getCtx(),o+"_ID"),a.push({Key:o,Name:r}),i.tableInfo.push({Key:s,Name:o}),s==this.AD_Table_ID&&o}}},error:function(e){$selfObj.log.info(e)}}),a},a.prototype.getOrg=function(){var a=[],i=this.AD_Client_ID;return t.ajax({url:e.Application.contextUrl+"AcctViewerData/AcctViewerGetOrgData",type:"POST",async:!1,data:{client_id:i},success:function(t){var i=t.result;if(i){a.push({Key:0,Name:""});for(var n=0;n<i.length;n++)a.push({Key:i[n].AD_Org_ID,Name:e.Utility.encodeText(i[n].OrgName)})}},error:function(e){$selfObj.log.info(e)}}),a},a.prototype.getPostingType=function(){var a=[];return t.ajax({url:e.Application.contextUrl+"AcctViewerData/AcctViewerGetPostingType",type:"POST",async:!1,data:{reference_id:125},success:function(t){var i=t.result;if(i){a.push({Key:0,Name:""});for(var n=0;n<i.length;n++)a.push({Key:i[n].PostingValue,Name:e.Utility.encodeText(i[n].PostingName)})}},error:function(e){$selfObj.log.info(e)}}),a},a.prototype.getAcctSchemaElements=function(a){this._elements=[];var i=this._elements;return t.ajax({url:e.Application.contextUrl+"AcctViewerData/AcctViewerGetAcctSchElements",type:"POST",async:!0,data:{keys:a},success:function(t){var a=t.result;if(a)for(var n=0;n<a.length;n++){var l=[];l.push({c_acctschema_element_id:a[n].C_AcctSchema_Element_ID,name:e.Utility.encodeText(a[n].ElementName),elementtype:a[n].ElementType,c_elementvalue_id:a[n].C_ElementValue_ID,seqno:a[n].SeqNo,detail:a[n].Detail,c_element_id:a[n].C_Element_ID}),i.push(l)}},error:function(e){$selfObj.log.info(e)}}),i},a.prototype.getAcctSchemaElement=function(e){null==this._elements&&this.getAcctSchemaElements();for(var t=0;t<this._elements.length;t++){var a=this._elements[t][0];if(a.elementtype.equals(e))return a}return null},a.prototype.getColumnName=function(e){return e.equals(this.ELEMENTTYPE_Organization)?"AD_Org_ID":e.equals(this.ELEMENTTYPE_Account)?"Account_ID":e.equals(this.ELEMENTTYPE_BPartner)?"C_BPartner_ID":e.equals(this.ELEMENTTYPE_Product)?"M_Product_ID":e.equals(this.ELEMENTTYPE_Activity)?"C_Activity_ID":e.equals(this.ELEMENTTYPE_LocationFrom)?"C_LocFrom_ID":e.equals(this.ELEMENTTYPE_LocationTo)?"C_LocTo_ID":e.equals(this.ELEMENTTYPE_Campaign)?"C_Campaign_ID":e.equals(this.ELEMENTTYPE_OrgTrx)?"AD_OrgTrx_ID":e.equals(this.ELEMENTTYPE_Project)?"C_Project_ID":e.equals(this.ELEMENTTYPE_SalesRegion)?"C_SalesRegion_ID":e.equals(this.ELEMENTTYPE_UserList1)?"User1_ID":e.equals(this.ELEMENTTYPE_UserList2)?"User2_ID":e.equals(this.ELEMENTTYPE_UserElement1)?"UserElement1_ID":e.equals(this.ELEMENTTYPE_UserElement2)?"UserElement2_ID":""},a.prototype.getButtonText=function(a,i,n){var l=e.Env.getAD_Language(e.Env.getCtx()),s="<"+n+">";return t.ajax({url:e.Application.contextUrl+"AcctViewerData/AcctViewerGetButtonText",type:"POST",async:!1,data:{lookupDirEmbeded:null,tName:a,wheres:" avd WHERE avd.",selectSQLs:n,language:l,ColumnName:i},success:function(e){var t=e.result;""!=t&&(s=t)},error:function(e){$selfObj.log.info(e)}}),s},a.prototype.Query=function(t,a,i,n){var l="";if(0!=this.C_AcctSchema_ID&&(l=l.concat(this.TABLE_ALIAS).concat(".C_AcctSchema_ID=").concat(this.C_AcctSchema_ID)),null!=this.PostingType&&this.PostingType.length>0&&(l.length>0&&(l=l.concat(" AND ")),l=l.concat(this.TABLE_ALIAS).concat(".PostingType='").concat(this.PostingType).concat("'")),this.documentQuery)l.length>0&&(l=l.concat(" AND ")),l=l.concat(this.TABLE_ALIAS).concat(".AD_Table_ID=").concat(this.AD_Table_ID).concat(" AND ").concat(this.TABLE_ALIAS).concat(".Record_ID=").concat(this.Record_ID);else{var s=this.whereInfo;if(null!=s)for(var o=0;o<s.length;o++){var r=s[o].Value;null!=r&&r.length>0&&(l.length>0&&(l=l.concat(" AND ")),l=l.concat(this.TABLE_ALIAS).concat(".").concat(r))}null==!this.DateFrom&&null==this.DateTo||(l.length>0&&(""!=this.DateFrom||""!=this.DateTo)&&(l=l.concat(" AND ")),""!=this.DateFrom&&""!=this.DateTo?l=l.concat("TRUNC(").concat(this.TABLE_ALIAS).concat(".DateAcct,'DD') BETWEEN ").concat(e.DB.to_date(this.DateFrom)).concat(" AND ").concat(e.DB.to_date(this.DateTo)):""!=this.DateFrom?l=l.concat("TRUNC(").concat(this.TABLE_ALIAS).concat(".DateAcct,'DD') >= ").concat(e.DB.to_date(this.DateFrom)):""!=this.DateTo&&(l=l.concat("TRUNC(").concat(this.TABLE_ALIAS).concat(".DateAcct,'DD') <= ").concat(e.DB.to_date(this.DateTo)))),0!=this.AD_Org_ID&&(l.length>0&&(l=l.concat(" AND ")),l=l.concat(this.TABLE_ALIAS).concat(".AD_Org_ID=").concat(this.AD_Org_ID))}var c="";this.sortBy1.length>0&&(c=c.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy1)),this.sortBy2.length>0&&(c.length>0&&(c=c.concat(",")),c=c.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy2)),this.sortBy3.length>0&&(c.length>0&&(c=c.concat(",")),c=c.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy3)),this.sortBy4.length>0&&(c.length>0&&(c=c.concat(",")),c=c.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy4)),0==c.length&&(c=c.concat(this.TABLE_ALIAS).concat(".Fact_Acct_ID")),n||(n=1),this.getDataModel(t,l,c,this.group1,this.group2,this.group3,this.group4,this.sortBy1,this.sortBy2,this.sortBy3,this.sortBy4,this.displayDocumentInfo,this.displaySourceAmt,this.displayQty,a,i,n)},a.prototype.getDataModel=function(a,i,n,l,s,o,r,c,u,d,g,p,v,_,V,A,m){var f=this;t.ajax({url:e.Application.contextUrl+"Common/GetDataQuery",async:!0,dataType:"json",type:"POST",data:{AD_Client_ID:a,whereClause:i,orderClause:n,gr1:l,gr2:s,gr3:o,gr4:r,sort1:c,sort2:u,sort3:d,sort4:g,displayDocInfo:p,displaySrcAmt:v,displayqty:_,pageNo:m},success:function(e){e=JSON.parse(e),f.dataByData=e,A(e.pSetting),V(e)}})},i.prototype.dispose=function(){this.disposeComponent()},i.prototype.setIsMenu=function(e){null!=e&&null!=e&&(this.menuForm=e)},i.prototype.getIsMenu=function(){return this.menuForm},e.AcctViewer=i}(VIS,jQuery)},472:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutProject")}function i(){e.CalloutEngine.call(this,"VIS.CalloutProjectLine")}function i(){e.CalloutEngine.call(this,"VIS.CalloutProjectLine")}function n(){e.CalloutEngine.call(this,"VIS.CalloutProjectCBPartner")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.Planned=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";if(this.isCalloutActive()||null==s)return"";var r,c,u,d;this.setCalloutActive(!0);var g=0,p=a.getStdPrecision(),v=p;if(0!=(f=a.getContextAsInt(i,"M_PriceList_Version_ID"))){var _=e.dataContext.getJSONRecord("MProject/GetPriceListPrecision",f.toString());null!=_&&(p=t.getValueOfInt(_.StdPrecision),v=t.getValueOfInt(_.PriceListPrecision))}var V=t.getValueOfInt(n.getValue("C_ProjectTask_ID")),A=t.getValueOfInt(n.getValue("C_Project_ID")),m=t.getValueOfInt(n.getValue("M_Product_ID")),f=V.toString()+","+A.toString()+","+m.toString(),D=e.dataContext.getJSONRecord("MProject/GetProjectPriceLimit",f);null==(r=t.getValueOfDecimal(n.getValue("PlannedQty")))&&(r=Envs.ONE),c=null==(c=t.getValueOfDecimal(n.getValue("PlannedPrice")))?e.Env.ZERO:c.toFixed(v),u=null==(u=t.getValueOfDecimal(n.getValue("PriceList")))?c:u.toFixed(v),d=null==(d=t.getValueOfDecimal(n.getValue("Discount")))?e.Env.ZERO:d.toFixed(v);var h=l.getColumnName();if("PlannedPrice"==h){if(0==u)d=e.Env.ZERO;else{var C=(c*e.Env.ONEHUNDRED/u).toFixed(10);d=e.Env.ONEHUNDRED-C}n.setValue("Discount",d.toFixed(v)),n.setValue("PlannedPrice",c),this.log.fine("PriceList="+u+" - Discount="+d+" -> [PlannedPrice="+c+"] (Precision="+v+")")}else if("PriceList"==h){if(0==e.Env.signum(u))d=e.Env.ZERO;else{C=c*e.Env.ONEHUNDRED/u;d=e.Env.ONEHUNDRED-C}n.setValue("Discount",d.toFixed(v)),n.setValue("PriceList",u),this.log.fine("[PriceList="+u+"] - Discount="+d+" -> PlannedPrice="+c+" (Precision="+v+")")}else if("Discount"==h){C=(d/e.Env.ONEHUNDRED).toFixed(10);c=u*(C=e.Env.ONE-C),t.scale(c)>v&&(c=c.toFixed(v)),n.setValue("PlannedPrice",c),n.setValue("Discount",d),this.log.fine("PriceList="+u+" - [Discount="+d+"] -> PlannedPrice="+c+" (Precision="+v+")")}var S=r*c;return t.scale(S)>p&&(S=S.toFixed(p)),null!=r&&(g=(g=(t.getValueOfDecimal(n.getValue("PlannedPrice"))-D)*t.getValueOfDecimal(n.getValue("PlannedQty"))).toFixed(p)),this.log.fine("PlannedQty="+r+" * PlannedPrice="+c+" -> PlannedAmt="+S+" (Precision="+p+")"),n.setValue("PlannedAmt",S),n.setValue("PlannedMarginAmt",g),this.setCalloutActive(!1),a=i=n=l=s=null,""},a.prototype.Product=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r=t.getValueOfInt(s),c=a.getContextAsInt(i,"M_PriceList_Version_ID");if(null==r||0==t.getValueOfInt(r)||0==c)return"";this.setCalloutActive(!0);var u=a.getContextAsInt(i,"C_BPartner_ID"),d=t.getValueOfDecimal(n.getValue("PlannedQty")),g=t.getValueOfDateTime(n.getValue("PlannedDate"));if(null==g){null==(g=t.getValueOfDateTime(n.getValue("DateContract")))&&null==(g=t.getValueOfDateTime(n.getValue("DateFinish")))&&(g=new Date);var p,v=r.toString().concat(",",u.toString(),",",d.toString(),",",isSOTrx,",",M_PriceList_ID.toString(),",",c.toString(),",",g.toString(),",",null);p=e.dataContext.getJSONRecord("MProductPricing/GetProductPricing",v);return n.setValue("PriceList",p.PriceList),n.setValue("PlannedPrice",p.PriceActual),n.setValue("Discount",p.Discount),n.setValue("PlannedAmt",p.LineAmt),""}return a=i=n=s=null,""},e.Model.CalloutProject=a,e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.Charge=function(t,a,i,n,l,s){if(null==l||""==l.toString())return"";var o=i.getValue("C_Charge_ID").toString(),r=e.dataContext.getJSONRecord("MCharge/GetCharge",o);return i.setValue("PlannedQty",1),i.setValue("PlannedPrice",r),i=l=null,""},e.Model.CalloutProjectLine=i,e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.Charge=function(t,a,i,n,l,s){if(null==l||""==l.toString())return"";var o=i.getValue("C_Charge_ID").toString(),r=e.dataContext.getJSONRecord("MCharge/GetCharge",o);return i.setValue("PlannedQty",1),i.setValue("PlannedPrice",r),i=l=null,""},e.Model.CalloutProjectLine=i,e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.SetAddress=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return n.setValue("C_BPartner_Location_ID",null),n.setValue("AD_User_ID",null),n.setValue("M_PriceList_Version_ID",null),"";try{if(this.setCalloutActive(!0),"C_BPartner_ID"==l.getColumnName()){null!=n.getField("Ref_BPartner_ID")&&n.setValue("Ref_BPartner_ID",s);var r=null;if(null!=(r=e.dataContext.getJSONRecord("MBPartner/GetBPData",t.getValueOfString(n.getValue("C_BPartner_ID")))))0==(c=e.Utility.Util.getValueOfInt(r.C_BPartner_Location_ID))?n.setValue("C_BPartner_Location_ID",null):n.setValue("C_BPartner_Location_ID",c),0==(u=e.Utility.Util.getValueOfInt(r.AD_User_ID))?n.setValue("AD_User_ID",null):n.setValue("AD_User_ID",u),0==(d=e.Utility.Util.getValueOfInt(r.M_PriceList_Version_ID))?n.setValue("M_PriceList_Version_ID",null):n.setValue("M_PriceList_Version_ID",d)}else if("C_BPartnerSR_ID"==l.getColumnName()){null!=n.getField("Ref_BPartner_ID")&&n.setValue("Ref_BPartner_ID",s);var c,u,d;r=null;if(null!=(r=e.dataContext.getJSONRecord("MBPartner/GetBPData",t.getValueOfString(n.getValue("C_BPartnerSR_ID")))))0==(c=e.Utility.Util.getValueOfInt(r.C_BPartner_Location_ID))?n.setValue("C_BPartner_Location_ID",null):n.setValue("C_BPartner_Location_ID",c),0==(u=e.Utility.Util.getValueOfInt(r.AD_User_ID))?n.setValue("AD_User_ID",null):n.setValue("AD_User_ID",u),0==(d=e.Utility.Util.getValueOfInt(r.M_PriceList_Version_ID))?n.setValue("M_PriceList_Version_ID",null):n.setValue("M_PriceList_Version_ID",d)}}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),""},e.Model.CalloutProjectCBPartner=n}(VIS,jQuery)},745:()=>{VAS=window.VAS||{},function(e,t){e.CreateLinesRequisition=function(){var a;this.frame,this.windowNo,this.Record_ID,this.Table_ID;var i,n,l,s,o,r,c,u,d,g,p=this,v=t("<div>"),_=null,V=null,A=0,m=0;e.translatedTexts=null;var f=VIS.DisplayType.GetNumberFormat(VIS.DisplayType.Amount),D=VIS.Env.isDecimalPoint();function h(e,t){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VCreateFrom/GetRequisitionLines",{M_Requisition_ID:e,M_Product_ID:t},C)}function C(e){null!=e&&d.add(e),a[0].style.visibility="hidden"}function S(){s=[];for(var e=d.getSelection(),t=0;t<e.length;t++)s.push({M_Product_ID:d.records[e[t]-1].M_Product_ID,C_Charge_ID:d.records[e[t]-1].C_Charge_ID,Product:d.records[e[t]-1].Product,ASI_ID:d.records[e[t]-1].ASI_ID,C_UOM_ID:d.records[e[t]-1].C_UOM_ID,M_ReqLine_ID:d.records[e[t]-1].M_ReqLine_ID,M_Requisition_ID:d.records[e[t]-1].M_Requisition_ID,EnteredQty:d.records[e[t]-1].EnteredQty,Price:d.records[e[t]-1].Price})}function I(e,t){var a=!1;if(e.value_new=VIS.Utility.Util.getValueOfString(t),e.value_new.contains(".")){a=!0;for(var i=[],n=0;n<e.value_new.length;n++)"."===e.value_new[n]&&i.push(n);i.length>1&&(e.value_new=y(e.value_new,"."))}if(e.value_new.contains(","))if(a)e.value_new=y(e.value_new,",");else{for(i=[],n=0;n<e.value_new.length;n++)","===e.value_new[n]&&i.push(n);i.length>1?e.value_new=y(e.value_new,","):e.value_new=e.value_new.replace(",",".")}return""==e.value_new&&(e.value_new="0"),e.value_new}function y(e,t){var a=e.split(t);return(e=a.slice(0,-1).join("")+"."+a.slice(-1)).indexOf(".")==e.length-1&&(e=e.replace(".","")),e}this.initalize=function(){e.translatedTexts=VIS.Msg.translate(VIS.Env.getCtx(),["M_Product_ID","M_Requisition_ID","ASI","C_UOM_ID","M_RequisitionLine_ID"],!0),v.append('<div class="VIS_Pref_show vis-formouterwrpdiv"><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="VAS_Requisition_'+p.windowNo+'"></div></div><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="VAS_Product_'+p.windowNo+'" ></div></div></div>'),v.append('<div class="vis-crtfrm-datawrp" style="height: 48.5%;"><div id="VAS_RequisitionGrd_'+p.windowNo+'" style="height:350px;" ></div></div>'),v.append('<div class="vis-ctrfrm-btnwrp"><input id="VAS_CancelBtn_'+p.windowNo+'" class= "VIS_Pref_btn-2" type = "button" value = "'+VIS.Msg.getMsg("Cancel")+'"><input id="VAS_ApplyBtn_'+p.windowNo+'" class="VIS_Pref_btn-2" type="button" value="'+VIS.Msg.getMsg("Apply")+'"><input id="VAS_OKBtn_'+p.windowNo+'" class="VIS_Pref_btn-2" type="button" value="'+VIS.Msg.getMsg("OK")+'"></div>'),(a=t("<div class='vis-apanel-busy'>")).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),a[0].style.visibility="visible",v.append(a),a[0].style.visibility="visible"},this.intialLoad=function(){i=v.find("#VAS_OKBtn_"+p.windowNo),n=v.find("#VAS_ApplyBtn_"+p.windowNo),l=v.find("#VAS_CancelBtn_"+p.windowNo),r=v.find("#VAS_Product_"+p.windowNo),c=v.find("#VAS_Requisition_"+p.windowNo),g=v.find("#VAS_RequisitionGrd_"+p.windowNo),function(){var a="M_Requisition.DOcStatus IN ('CO') AND M_Requisition.IsActive='Y' AND M_Requisition.AD_Client_ID=@AD_Client_ID@ AND M_Requisition_ID IN (SELECT Distinct M_requisition_ID FROM M_requisitionline WHERE M_RequisitionLine_ID IN (SELECT req.M_RequisitionLine_ID FROM M_RequisitionLine req LEFT JOIN C_RfqLine oline ON (req.M_RequisitionLine_ID = oline.M_RequisitionLine_ID) WHERE oline.M_RequisitionLine_ID IS NULL OR req.Qty - req.DTD001_DeliveredQty > (SELECT SUM(rl.Qty) FROM C_RfqLineQty rl INNER JOIN C_RfqLine cl ON rl.C_RfqLine_ID = cl.C_RfqLine_ID WHERE cl.M_RequisitionLine_ID = req.M_RequisitionLine_ID) AND oline.C_Rfq_ID IN (SELECT C_Rfq_ID FROM C_Rfq WHERE C_Rfq_ID IN (oline.C_Rfq_ID) AND DocStatus NOT IN ('RE','VO')))) ";_=VIS.MLookupFactory.get(VIS.Env.getCtx(),p.windowNo,0,VIS.DisplayType.MultiKey,"M_Requisition_ID",0,!1,a),V=new VIS.Controls.VTextBoxButton("M_Requisition_ID",!0,!1,!0,VIS.DisplayType.MultiKey,_);var i=t('<div class="vis-control-wrap">'),n=t('<div class="input-group-append">');c.append(i),i.append(V.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+VIS.Msg.getMsg("DTD001_Requisition")+"</label>"),c.append(n),n.append(V.getBtn(0)),n.append(V.getBtn(1)),o=VIS.MLookupFactory.getMLookUp(VIS.Env.getCtx(),p.windowNo,2221,VIS.DisplayType.Search),u=new VIS.Controls.VTextBoxButton("M_Product_ID",!1,!1,!0,VIS.DisplayType.Search,o);var l=t('<div class="vis-control-wrap">'),s=t('<div class="input-group-append">');r.append(l),l.append(u.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.M_Product_ID+"</label>"),r.append(s),s.append(u.getBtn(0)),s.append(u.getBtn(1))}(),u.fireValueChanged=function(){null!=u.value?(a[0].style.visibility="visible",A=u.value,d.clear(),h(m,A)):(A=0,d.clear(),h(m,A))},V.fireValueChanged=function(e){a[0].style.visibility="visible",m=V.getValue(),d.clear(),h(m,A)},i.on("click touchstart",function(e){d.records.length>0?(a[0].style.visibility="visible",S(),CreateLines(!1)):VIS.ADialog.error("VIS_PlzSelLines")}),n.on("click touchstart",function(e){d.records.length>0?(a[0].style.visibility="visible",S(),CreateLines(!0)):VIS.ADialog.error("VIS_PlzSelLines")}),l.on("click touchstart",function(e){p.frame.close()}),a[0].style.visibility="hidden"},this.LoadRequisitionGrid=function(){d=null,(d=g.w2grid({name:"VAS_RequisitionGrid_"+p.windowNo,recordHeight:25,show:{toolbar:!1,selectColumn:!0,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!0,toolbarSave:!0},multiSelect:!0,columns:[{field:"M_Product_ID",caption:e.translatedTexts.M_Product_ID,sortable:!1,size:"12%"},{field:"C_Charge_ID",caption:e.translatedTexts.M_Product_ID,sortable:!1,size:"12%"},{field:"Product",caption:e.translatedTexts.M_Product_ID,sortable:!1,size:"12%"},{field:"C_UOM_ID",caption:e.translatedTexts.M_Product_ID,sortable:!1,size:"12%"},{field:"UOM",caption:e.translatedTexts.C_UOM_ID,sortable:!1,size:"12%"},{field:"ASI_ID",caption:e.translatedTexts.M_Product_ID,sortable:!1,size:"12%"},{field:"ReqQty",caption:VIS.Msg.getMsg("VAS_ReqQty"),sortable:!1,size:"12%"},{field:"PendingQty",caption:VIS.Msg.getMsg("QtyPending"),sortable:!1,size:"12%"},{field:"EnteredQty",caption:VIS.Msg.getMsg("QtyEntered"),sortable:!1,size:"12%",editable:{type:"number"},render:function(e,t,a){var i=e.EnteredQty;return i=I(event,i),parseFloat(i).toLocaleString()}},{field:"Price",caption:VIS.Msg.getMsg("Price"),sortable:!1,size:"12%"},{field:"M_ReqLine_ID",caption:e.translatedTexts.M_RequisitionLine_ID,sortable:!1,size:"80px",display:!1},{field:"M_Requisition_ID",caption:e.translatedTexts.M_Requisition_ID,sortable:!1,size:"80px",display:!1}],records:[],onChange:function(e){VIS.Utility.Util.getValueOfInt(e.value_new)>w2ui["VAS_RequisitionGrid_"+p.windowNo].get(e.recid).ReqQty?(w2ui["VAS_RequisitionGrid_"+p.windowNo].get(e.recid).EnteredQty=e.value_previous,w2ui["VAS_RequisitionGrid_"+p.windowNo].refreshCell(e.recid,"EnteredQty"),e.preventDefault(),VIS.ADialog.error("VAS_QtyGrtrReqQty")):VIS.Utility.Util.getValueOfInt(e.value_new)>w2ui["VAS_RequisitionGrid_"+p.windowNo].get(e.recid).PendingQty?(w2ui["VAS_RequisitionGrid_"+p.windowNo].get(e.recid).EnteredQty=e.value_new,w2ui["VAS_RequisitionGrid_"+p.windowNo].refreshCell(e.recid,"EnteredQty"),VIS.ADialog.warn("DTD001_EntQtyGrtrPendQTy")):(w2ui["VAS_RequisitionGrid_"+p.windowNo].get(e.recid).EnteredQty=e.value_new,w2ui["VAS_RequisitionGrid_"+p.windowNo].refreshCell(e.recid,"EnteredQty"))},onEditField:function(e){id=e.recid,d.records[e.index][d.columns[e.column].field]=I(e,d.records[e.index][d.columns[e.column].field]);var a=f.GetFormatAmount(d.records[e.index][d.columns[e.column].field],"init",D);d.records[e.index][d.columns[e.column].field]=f.GetConvertedString(a,D),t("#grid_VAS_RequisitionGrid_"+p.windowNo+"_rec_"+id).keydown(function(e){return!!(D||190!=e.keyCode&&110!=e.keyCode)&&((!D||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which?!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||e.target.value.indexOf(",")>-1&&(e.target.value=e.target.value.replace(",","")):e.target.value.indexOf(".")>-1&&(e.target.value=e.target.value.replace(".","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))})}})).hideColumn("M_Product_ID"),d.hideColumn("C_Charge_ID"),d.hideColumn("C_UOM_ID"),d.hideColumn("ASI_ID"),d.hideColumn("Price"),d.hideColumn("M_ReqLine_ID"),d.hideColumn("M_Requisition_ID")},CreateLines=function(e){t.ajax({url:VIS.Application.contextUrl+"VCreateFrom/SaveRfqLines",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({C_RFQ_ID:p.Record_ID,Data:s}),success:function(t){""!=JSON.parse(t)&&(V.setValue(null,!1,!0),u.setValue(null,!1,!0),d.clear(),VIS.ADialog.info("",!0,JSON.parse(t),"")),a[0].style.visibility="hidden",e||p.frame.close()},error:function(){a[0].style.visibility="hidden"}})},this.getRoot=function(){return v}},e.CreateLinesRequisition.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.Record_ID=this.frame.getRecord_ID(),this.Table_ID=this.frame.getAD_Table_ID(),this.initalize(),this.intialLoad(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.LoadRequisitionGrid()},50),window.setTimeout(function(){},50)},e.CreateLinesRequisition.prototype.setHeight=function(){return"575"},e.CreateLinesRequisition.prototype.setWidth=function(){return"1050"},e.CreateLinesRequisition.prototype.dispose=function(){w2ui["VAS_RequisitionGrid_"+this.windowNo].destroy(),this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$OkBtn=null,$ApplyBtn=null,$root=null,_ProductLookUp=null,_ProductCtrl=null,_RequisitionCtrl=null,lookupRequisition=null,$RequisitionControl=null,SelectedRecords=null}}(VAS,jQuery)},818:()=>{VAS=window.VAS||{},function(e,t){e.VAS_InvoiceMatchedTabPanel=function(){this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var a=this.ctx,n=1,l=10,s=this,o=0,r=0,c=null,u=null,d=null,g=null,p=null,v=null,_=null,V=null,A=null;e.translatedTexts=VIS.Msg.translate(a,["VAS_Quantity","VAS_PO","VAS_GRN","VAS_Matched","VAS_UnMatched"],!0);var m=t('<div class = "vas-invmatch-Data-root"></div>'),f=t("<div class ='vas-invmatch-DataWrapper'></div>");V=t('<div class="vas-invmatch-data-Paging mr-3">');this.init=function(){$bsyDiv=t("<div class='vis-apanel-busy'>"),$bsyDiv.css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),$bsyDiv[0].style.visibility="visible",m.append($bsyDiv),f.append('<div class="vas-invmatch-DataListGroup"><div id="VAS-ScheduleData_'+s.windowNo+'" class="VAS-ScheduleData mb-2"></div></div>'),m.append(f),c=t('<ul class="vis-statusbar-ul">'),u=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="First Page" style="opacity: 0.6;"></i></div></li>'),d=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="Page Up" style="opacity: 0.6;"></i></div></li>'),g=t("<select>"),p=t("<li>").append(g),v=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="Page Down" style="opacity: 0.6;"></i></div></li>'),_=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="Last Page" style="opacity: 0.6;"></i></div></li>'),c.append(u).append(d).append(p).append(v).append(_),V.append(c),u.on("click",function(){"1"==t(this).css("opacity")&&(n=1,s.getInvoiceLineData(r))}),d.on("click",function(){"1"==t(this).css("opacity")&&(n--,s.getInvoiceLineData(r))}),v.on("click",function(){"1"==t(this).css("opacity")&&(n++,s.getInvoiceLineData(r))}),_.on("click",function(){"1"==t(this).css("opacity")&&(n=parseInt(g.find("Option:last").val()),s.getInvoiceLineData(r))}),g.on("change",function(){n=g.val(),s.getInvoiceLineData(r)}),m.append(V)},this.getInvoiceLineData=function(e){$bsyDiv[0].style.visibility="visible",t.ajax({url:VIS.Application.contextUrl+"VAS/PoReceipt/GetInvoiceLineMatchData",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{InvoiceId:e,pageNo:n,pageSize:l},success:function(e){if(f.find("#VAS-ScheduleData_"+s.windowNo).empty(),f.find("#vas_norecordcont_"+s.windowNo).remove(),""!=JSON.parse(e)){if(null!=(e=JSON.parse(e))&&e.length>0){for(o=Math.ceil(e[0].RecordCount/l),i=0;i<e.length;i++){A="";e[i].C_OrderLine_ID,e[i].M_InOutLine_ID;if(0==i&&(e[i].DiscrepancyCount>0||0!=e[i].TotalAdvanceAmt)){let t;e[i].DiscrepancyCount>0&&(t=VIS.Msg.getMsg("VAS_DiscrepancyFound")+e[i].DiscrepancyCount+VIS.Msg.getMsg("VAS_DiscrepancyLines")),0!=e[i].TotalAdvanceAmt&&(""==VIS.Utility.Util.getValueOfString(t)?t=e[i].TotalAdvanceAmt+VIS.Msg.getMsg("VAS_AdvancePayNotPaid"):t+=e[i].TotalAdvanceAmt+VIS.Msg.getMsg("VAS_AdvancePayNotPaid")),A='<div class="vas-invmatch-DiscrepancyFont"><span class="vas-invmatch-discrepancytextcolor">'+t+"</span></div>"}A+='<div data-C_Invoiceline_ID="'+e[i].C_Invoiceline_ID+'" class="vas-invmatch-datalist"><div class="vas-invmatch-DataListItem mb-2 vas-invmatch-DataListItem-block">';let t=e[i].IsDiscrepancy;if(A+=t?'<span class="vas-invmatch-DataListNotPaid">'+VIS.Msg.getMsg("VAS_Discrepancy")+"</span>":'<span class="vas-invmatch-DataListPaid">'+VIS.Msg.getMsg("VAS_Matched")+"</span>",A+='<div class="vas-invmatch-Data-sglItem mb-2" style="flex-direction:column"><div class="vas-invmatch-headerRow"><span class="" title="'+VIS.Msg.getMsg("VAS_LineNo")+'">'+e[i].Line+'</span><span class="font-weight-bold" style="margin-left:25px" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+e[i].ProductName+"</span></div>",t||(A+='<div class="vas-invmatch-Qty"><span>'+VIS.Msg.getMsg("VAS_Match-QtyOrder")+e[i].QtyOrdered.toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].UOMPrecision,maximumFractionDigits:e[i].UOMPrecision})+";"+VIS.Msg.getMsg("VAS_Match-QtyDeliver")+e[i].OrderDelivered.toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].UOMPrecision,maximumFractionDigits:e[i].UOMPrecision})+";"+VIS.Msg.getMsg("VAS_Match-QtyInvoice")+e[i].QtyInvoiced.toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].UOMPrecision,maximumFractionDigits:e[i].UOMPrecision})+"</span></div>"),A+="</div> ",t){A+='<div class="vas-invmatch-Data-sglItem vas-invmatch-ExpectedMargin mb-2"><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="vas-invmatch-DataElementValue vas-invmatch-setCol1Width">&nbsp;</span></div><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="vas-vas-invmatch-DataElementTTl font-weight-bold">'+VIS.Msg.getMsg("VAS_Expected")+'</span></div><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="vas-vas-invmatch-DataElementTTl font-weight-bold">'+VIS.Msg.getMsg("VAS_Actual")+"</span></div></div>";let t="vas-invmatch-DataElementValue text-right";"CO"==e[i].DocStatus||"CL"==e[i].DocStatus?e[i].ExpectedOrder<0&&(t="vas-invmatch-DataElementValue text-right vas-invmatch-notMatched"):e[i].ExpectedOrder-e[i].QtyInvoiced<0&&(t="vas-invmatch-DataElementValue text-right vas-invmatch-notMatched"),A+='<div class="vas-invmatch-Data-sglItem vas-invmatch-DataRow mb-2"><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="vas-invmatch-DataElementValue">'+VIS.Msg.getMsg("VAS_Order")+'</span></div><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="'+t+'" title="'+VIS.Msg.getMsg("VAS_OrderedQty")+'">'+(e[i].ExpectedOrder+("CO"==e[i].DocStatus||"CL"==e[i].DocStatus?e[i].QtyInvoiced:0)).toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].UOMPrecision,maximumFractionDigits:e[i].UOMPrecision})+'</span></div><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="'+t+'" title="'+VIS.Msg.getMsg("VAS_InvoicedQty")+'">'+e[i].QtyInvoiced.toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].UOMPrecision,maximumFractionDigits:e[i].UOMPrecision})+"</span></div></div>",t="vas-invmatch-DataElementValue text-right","CO"==e[i].DocStatus||"CL"==e[i].DocStatus?e[i].ExpectedGRN<0&&(t="vas-invmatch-DataElementValue text-right vas-invmatch-notMatched"):e[i].ExpectedGRN-e[i].QtyInvoiced<0&&(t="vas-invmatch-DataElementValue text-right vas-invmatch-notMatched"),A+='<div class="vas-invmatch-Data-sglItem vas-invmatch-DataRow mb-2"><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="vas-invmatch-DataElementValue">'+VIS.Msg.getMsg("VAS_GRN")+'</span></div><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="'+t+'" title="'+VIS.Msg.getMsg("VAS_MovementQty")+'">'+(e[i].ExpectedGRN+("CO"==e[i].DocStatus||"CL"==e[i].DocStatus?e[i].QtyInvoiced:0)).toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].UOMPrecision,maximumFractionDigits:e[i].UOMPrecision})+'</span></div><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="'+t+'" title="'+VIS.Msg.getMsg("VAS_InvoicedQty")+'">'+e[i].QtyInvoiced.toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].UOMPrecision,maximumFractionDigits:e[i].UOMPrecision})+"</span></div></div>",t="vas-invmatch-DataElementValue text-right",0!=e[i].C_OrderLine_ID&&e[i].OrderPrice-e[i].InvoicePrice<0&&(t="vas-invmatch-DataElementValue text-right vas-invmatch-notMatched"),A+='<div class="vas-invmatch-Data-sglItem vas-invmatch-DataRow mb-2"><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="vas-invmatch-DataElementValue">'+VIS.Msg.getMsg("VAS_Price")+'</span></div><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="'+t+'" title="'+VIS.Msg.getMsg("VAS_OrderPrice")+'">'+e[i].OrderPrice.toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].InvoicePriceListPrecision,maximumFractionDigits:e[i].InvoicePriceListPrecision})+'</span></div><div class="vas-scheduleDataElement vas-invmatch-setCol1Width"><span class="'+t+'" title="'+VIS.Msg.getMsg("VAS_InvoicePrice")+'">'+e[i].InvoicePrice.toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].InvoicePriceListPrecision,maximumFractionDigits:e[i].InvoicePriceListPrecision})+"</span></div></div>",A+='<div class="vas-invmatch-Data-sglItem vas-invmatch-DataRow mb-2" style="background-color:white"><div class="vas-scheduleDataElement"><span class="vas-invmatch-Qty">'+VIS.Msg.getMsg("VAS_Match-QtyOrder")+e[i].QtyOrdered.toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].UOMPrecision,maximumFractionDigits:e[i].UOMPrecision})+";"+VIS.Msg.getMsg("VAS_Match-QtyDeliver")+e[i].OrderDelivered.toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].UOMPrecision,maximumFractionDigits:e[i].UOMPrecision})+";"+VIS.Msg.getMsg("VAS_Match-QtyInvoice")+e[i].QtyInvoiced.toLocaleString(window.navigator.language,{minimumFractionDigits:e[i].UOMPrecision,maximumFractionDigits:e[i].UOMPrecision})+"</span></div></div>"}A+="</div></div>",f.find("#VAS-ScheduleData_"+s.windowNo).append(A)}m.find(".vas-invmatch-data-Paging").show(),function(e){if(g.empty(),e>0){for(var a=0;a<e;a++)g.append(t("<option value="+(a+1)+">"+(a+1)+"</option>"));g.val(n),e>n?(v.css("opacity","1"),_.css("opacity","1")):(v.css("opacity","0.6"),_.css("opacity","0.6")),n>1?(u.css("opacity","1"),d.css("opacity","1")):(u.css("opacity","0.6"),d.css("opacity","0.6")),1==e&&(u.css("opacity","0.6"),d.css("opacity","0.6"),v.css("opacity","0.6"),_.css("opacity","0.6"))}else u.css("opacity","0.6"),d.css("opacity","0.6"),v.css("opacity","0.6"),_.css("opacity","0.6")}(o)}}else f.append('<div class="vas-igwidg-notfounddiv" id="vas_norecordcont_'+s.windowNo+'">'+VIS.Msg.getMsg("VAS_NoMatchDataFound")+"</div>"),m.find(".vas-invmatch-data-Paging").hide();$bsyDiv[0].style.visibility="hidden"},error:function(e){$bsyDiv[0].style.visibility="hidden",console.log(e)}})},this.getRoot=function(){return m},e.VAS_InvoiceMatchedTabPanel.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,s.windowNo=e,this.init()},e.VAS_InvoiceMatchedTabPanel.prototype.refreshPanelData=function(e,t){this.record_ID=e,r=e,n=1,l=10,this.selectedRow=t,this.getInvoiceLineData(e)},e.VAS_InvoiceMatchedTabPanel.prototype.sizeChanged=function(e){this.panelWidth=e},e.VAS_InvoiceMatchedTabPanel.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,lblTitle=null}}}(VAS,jQuery)},1025:()=>{VAS=window.VAS||{},function(e,t){e.VAS_PendingDeliveryWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[],r=0;this.initalize=function(){const a='<div id="VAS_DeliveryContainer_'+(l=this.widgetInfo.AD_UserHomeWidgetID)+'" class="VAS-deliveries-container-pending">    <div class="VAS-deliveries-heading">        <h6>'+VIS.Msg.getMsg("VAS_Pendingdeliveries")+'</h6>    </div>    <div class="VAS-delivery-count">        <div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_Deliveries")+' <span id="VAS_DeliveryCount_'+l+'">0</span></div>    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">        </div>    </div>    <div class="VAS-height-container">        <div id="VAS_DeliveryBox_'+l+'" class="VAS-deliveries-listing">        </div>        <div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing">        </div>    </div><div class="VAS-pagination-container"></div></div>';e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append(a)},this.intialLoad=function(c){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_DeliveryContainer_"+l).show(),t.ajax({url:VIS.Application.contextUrl+"Product/GetExpectedDelivery",data:{pageNo:c,pageSize:4,Type:"PD"},dataType:"json",success:function(u){u=JSON.parse(u);if(n.find("#VAS_DeliveryBox_"+l).empty(),n.find("#VAS_OrderContainer").remove,null!=u&&null!=u.Orders&&u.Orders.length>0){for(i=0;i<u.Orders.length;i++){var d='<div id="VAS_OrderContainer_'+l+'" class="VAS-delivery-box" >    <div class="VAS-box-heading">        <div class="VAS-icon-w-name">            <i class="fa fa-file-text" aria-hidden="true"></i>            <div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor"                 title="'+VIS.Msg.getMsg("Document_No")+'"                 data-doc-no="'+u.Orders[i].DocumentNo+'"                 data-customer-name="'+u.Orders[i].CustomerName+'"                 data-orderid="'+u.Orders[i].C_Order_ID+'">                '+u.Orders[i].DocumentNo+'            </div>        </div>        <div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+u.Orders[i].LineCount+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+u.Orders[i].CustomerName+'</div>    </div>    <div class="VAS-spaceBetween-col grid-2-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_DeliveryLocation")+'">'+u.Orders[i].DeliveryLocation+'</div>        <div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_ProductLocation")+'">'+u.Orders[i].ProductLocation+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+u.Orders[i].Symbol+"</span> "+u.Orders[i].GrandTotal.toLocaleString()+"</div>    </div></div>";n.find("#VAS_DeliveryBox_"+l).append(d)}s=[],u.Orders.forEach(function(e){e.OrderLines&&e.OrderLines.length>0&&(s[e.DocumentNo]=e.OrderLines)}),1==c&&(n.find("#VAS_DeliveryCount_"+l).text(u.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/4);var s=t('<div class="VAS-slider-arrows VAS-orders-text-white">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(u.RecordCount),r=u.AD_Window_ID),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){!function(i,c,u){n.find("#VAS_DeliveryContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var d='<div id="VAS_ProductContainer_'+l+'" class="VAS-deliveries-container-pending"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-deliveries-heading">        <h6>            <span id="VAS_BackTodelivery_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToDeliveries")+'        </h6><span id="VAS_GenerateDeliveryOrder_'+l+'" class="VAS-generate-delivery-btn" data-orderid="'+u+'" title="'+VIS.Msg.getMsg("VAS_GenerateDeliverOrder")+'"><i class="fa fa-truck" aria-hidden="true"></i></span>    </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading VAS-orders-text-white">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text VAS-orders-text-white" aria-hidden="true"></i>                    <div class="VAS-doc-no VAS-orders-text-white" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>                <div class="VAS-expectedTxt" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+c+'</div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count VAS-orders-text-white"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(d);var g=s[i]||[],p=6,v=Math.ceil(g.length/p),_=1;function V(e){e<1&&(e=1),e>v&&(e=v);var t=((_=e)-1)*p,a=Math.min(t+p,g.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s,r=g[i],c=o.includes(r.C_OrderLine_ID),u="I"!=r.ProductType||r.OnHandQty>0&&r.OnHandQty>=r.QtyOrdered,d=u?"VAS-delivery-box":"VAS-delivery-box no-stock";s="I"!=r.ProductType||r.OnHandQty>=r.QtyOrdered?"badge-green":r.OnHandQty<r.QtyOrdered&&r.OnHandQty>0?"badge-orange":"badge-red",n.find("#VAS_OrderLine_"+l).append('<div class="'+d+'"><div class="VAS-box-heading"><div class="VAS-icon-w-name"><input type="checkbox" class="VAS-selection-checkbox" data-orderlineid="'+r.C_OrderLine_ID+'"'+(c?" checked":"")+(u?"":" disabled")+'/> <i class="fa fa-file-text" aria-hidden="true"></i><div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+r.ProductName+'</div></div><div class="VAS-total-items-count"><span title = "'+VIS.Msg.getMsg("VAS_RemianingQty")+'" class="badge badge-light '+s+'"> '+r.QtyEntered+'</span ></div > </div><div class="VAS-spaceBetween-col"><div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+r.AttributeName+'</div><div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+r.UOM+"</div></div></div>")}n.find("#VAS_TotalQty_"+l).text(g.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details VAS-orders-text-white">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+_+VIS.Msg.getMsg("VAS_Of")+v+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}g.length>0&&V(_);function A(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateShipment",data:{C_Order_ID:i,C_OrderLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).Shipment_ID>0)try{if(r>0){var i={TabWhereClause:"M_InOut.M_InOut_ID="+t.Shipment_ID,TabLayout:"Y",TabIndex:"0"};a.widgetFirevalueChanged(i),a.currentPage=1,a.intialLoad(a.currentPage)}}catch(e){console.log(e)}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_DeliveryOrderNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}}),console.log("Generating delivery order for ID:",i)}n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackTodelivery_"+l),n.off("click","#VAS_GenerateDeliveryOrder_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){V(_-1)}),n.on("click","#VAS_NextPage_"+l,function(){V(_+1)}),n.on("click","#VAS_BackTodelivery_"+l,function(){n.find("#VAS_DeliveryContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("orderlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateDeliveryOrder_"+l).show():n.find("#VAS_GenerateDeliveryOrder_"+l).hide(),console.log(o)}),n.on("click","#VAS_GenerateDeliveryOrder_"+l,function(){A(t(this).data("orderid"))}),n.find("#VAS_GenerateDeliveryOrder_"+l).hide()}(n.find(this).data("doc-no"),t(this).data("customer-name"),t(this).data("orderid"))})}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_PendingDeliveryWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_PendingDeliveryWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_PendingDeliveryWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_PendingDeliveryWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_PendingDeliveryWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_PendingDeliveryWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},1071:()=>{!function(e,t){function a(){this.frame,this.windowNo;var a=this;this.arrListColumns=[],this.PreviewColumns=[];var i=VIS.Env.getCtx(),n=null;this.dGrid=null;var l=null,s=2,o=1,r=[],c=[],u=0,d=!1,g=1;this.lblOrg=new VIS.Controls.VLabel,this.lblCustomer=new VIS.Controls.VLabel,this.lblResource=new VIS.Controls.VLabel,this.tabRecordSelection=new VIS.Controls.VLabel,this.cmbOrg=new VIS.Controls.VComboBox("",!1,!1,!0),this.vSearchCustomer=null,this.vSearchResource=null,this.vSearchRequest=null,this.vSearchTask=null,this.vSearchTimeAndExpense=null,this.vSearchProject=null;var p=null,v=new VIS.CultureSeparator,_=VIS.DisplayType.GetNumberFormat(VIS.DisplayType.Amount),V=VIS.Env.isDecimalPoint();this.$root=t("<div class='vis-formouterwrpdiv vas-arinvroot'>"),this.$busyDiv=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),this.topDiv=null,this.sideDiv=null,this.gridSelectDiv=null,this.bottumDiv=null,this.PreviewGridDiv=null;var A=null,m=0,f=null,D=null,h=null,C=null,S=null,I=null,y=null,O=null,T=null,w=null,P=null,b=null,M=null,x=null,N=null,L=null;this.btnToggel=null,this.spnSelect=null,this.btnSpaceDiv=null,this.lblGenrate=null,this.lblSelect=null;var R=null,U=null,E=!1,k=[],G=[],B=[],F=[],Q=[],$=[],W=[],J=[],j=[],z=[],q=[],Y=[],H=[],K=[],Z=[],X=[],ee=[],te=null,ae=260,ie=50,ne=null,le=t(window).width()-(ae+20+5),se=t(window).width()-70,oe=[{ColumnName:"AD_Org_ID",TableName:"S_TimeExpense"},{ColumnName:"C_BPartner_ID",TableName:"S_TimeExpenseLine"},{ColumnName:"S_Resource_ID",TableName:"S_Resource"},{ColumnName:"C_ProjectRef_ID",TableName:"C_Order"},{ColumnName:"R_Request_ID",TableName:"S_TimeExpenseLine"},{ColumnName:"S_TimeExpense_ID",TableName:"S_TimeExpense"},{ColumnName:"VA075_Task_ID",TableName:"VA075_Task"},{ColumnName:"C_DocTypeTarget_ID",TableName:"C_Invoice"}],re=null;function ce(){R=VIS.dataContext.getJSONRecord("VIS/ModulePrefix/GetModulePrefix","VA075_"),ve(oe),function(){U=t('<div class="vas-tis-top-fields">'),T=t('<div class="input-group vis-input-wrap">');var n="AD_Org.AD_Org_ID <> 0 AND AD_Org.IsActive='Y' AND AD_Org.IsSummary='N' AND AD_Org.IsCostCenter='N' AND AD_Org.IsProfitCenter='N'",l=VIS.MLookupFactory.get(VIS.Env.getCtx(),a.windowNo,re.AD_Org_ID,VIS.DisplayType.TableDir,"AD_Org_ID",0,!1,n);a.cmbOrg=new VIS.Controls.VComboBox("AD_Org_ID",!0,!1,!0,l,150,VIS.DisplayType.TableDir),a.cmbOrg.setMandatory(!0);var s=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');T.append(s),s.append(a.cmbOrg.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append('<label class="vas-tis-lablels">'+e.translatedTexts.AD_Org_ID+"</label>"),T.append(s),o.append(a.cmbOrg.getBtn(0)),T.append(o),ne=t('<div class="vas-DocTyperDiv">');var r=t('<div class="input-group vis-input-wrap">'),c="C_DocType.IsActive = 'Y' AND C_DocType.DocBaseType = 'ARI' AND C_DocType.IsSOTrx = 'Y' AND  C_DocType.IsReturnTrx = 'N' AND C_DocType.IsExpenseInvoice = 'N'  AND C_DocType.AD_Org_ID IN (0,@AD_Org_ID@) AND C_DocType.AD_Client_ID IN (0,@AD_Client_ID@)",u=VIS.MLookupFactory.get(VIS.Env.getCtx(),a.windowNo,re.C_DocTypeTarget_ID,VIS.DisplayType.TableDir,"C_DocType_ID",0,!1,c);a.cmbDocType=new VIS.Controls.VComboBox("C_DocType_ID",!0,!1,!0,u,50,VIS.DisplayType.TableDir);var d=t('<div class="vis-control-wrap">'),g=t('<div class="input-group-append">');r.append(d),d.append(a.cmbDocType.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append('<label class="vas-tis-lablels">'+e.translatedTexts.VAS_InvoiceType+"</label>"),r.append(d),g.append(a.cmbDocType.getBtn(0)),r.append(g),ne.append(r);var p=t('<div class="vas-CustomerDiv">'),v="C_BPartner.IsActive='Y' AND C_BPartner.AD_Org_ID IN (0,@AD_Org_ID@) AND C_BPartner.IsCustomer = 'Y' AND C_BPartner.IsSummary = 'N'";w=t('<div class="input-group vis-input-wrap">');var _=VIS.MLookupFactory.get(VIS.Env.getCtx(),a.windowNo,re.C_BPartner_ID,VIS.DisplayType.MultiKey,"C_BPartner_ID",0,!1,v);a.vSearchCustomer=new VIS.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,VIS.DisplayType.MultiKey,_);var V=t('<div class="vis-control-wrap">'),A=t('<div class="input-group-append">');w.append(V),V.append(a.vSearchCustomer.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.VAS_Customer+"</label>"),w.append(V),A.append(a.vSearchCustomer.getBtn(0)),w.append(A),p.append(w);var m=t('<div class="vas-ResourceDiv">');P=t('<div class="input-group vis-input-wrap">');var S="S_Resource.IsActive='Y' AND S_Resource.AD_Org_ID IN(0,@AD_Org_ID@)",I=VIS.MLookupFactory.get(VIS.Env.getCtx(),a.windowNo,re.S_Resource_ID,VIS.DisplayType.MultiKey,"S_Resource_ID",0,!1,S);a.vSearchResource=new VIS.Controls.VTextBoxButton("S_Resource_ID",!0,!1,!0,VIS.DisplayType.MultiKey,I,0);var y=t('<div class="vis-control-wrap">'),O=t('<div class="input-group-append">');P.append(y),y.append(a.vSearchResource.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.S_Resource_ID+"</label>"),P.append(O),O.append(a.vSearchResource.getBtn(0)),P.append(O),m.append(P);var b=t('<div class="vas-FromdateDiv">');$FromDatewrapDiv=t('<div class="input-group vis-input-wrap">'),f=new VIS.Controls.VDate("DateReport",!0,!1,!0,VIS.DisplayType.Date,"DateReport");var M=t('<div class="vis-control-wrap">');$FromDatewrapDiv.append(M),M.append(f.getControl().attr("placeholder"," ").attr("data-placeholder","")).append('<label class="vas-tis-lablels">'+e.translatedTexts.VAS_FromDate+"</label>"),b.append($FromDatewrapDiv);var x=t('<div class="vas-todateDiv">');$toDatewrapDiv=t('<div class="input-group vis-input-wrap">'),D=new VIS.Controls.VDate("DateReport",!0,!1,!0,VIS.DisplayType.Date,"DateReport");var N=t('<div class="vis-control-wrap">');$toDatewrapDiv.append(N),N.append(D.getControl().attr("placeholder"," ").attr("data-placeholder","")).append('<label class="vas-tis-lablels">'+e.translatedTexts.VAS_toDate+"</label>"),x.append($toDatewrapDiv),U.append(T).append(p).append(m).append(b).append(x),h=t('<div class="vas-tis-dropdown-lbl">'),C=t('<div class="vas-tis-dropdown-lbl">'),a.vSearchCustomer.fireValueChanged=function(){for(var e=_,i="",n=a.vSearchCustomer.value.toString().split(","),l=0;l<n.length;l++)i=e.getDisplay(n[l]),-1==J.indexOf(n[l])&&null!=n[l]&&(h.append('<div class="vas-selected-lbl">'+i+'<span class="vis vis-cross" data-custId="'+n[l]+'"></span></div>'),p.append(h),J.push(n[l]),h.find(".vis-cross").on("click",function(){var e=t(this).attr("data-custId");J=jQuery.grep(J,function(t){return VIS.Utility.Util.getValueOfInt(t)!=VIS.Utility.Util.getValueOfInt(e)}),t(this).parent().remove(),0==h.find(".vis-cross").length&&h.remove()}));a.vSearchCustomer.setValue(null)},a.vSearchResource.fireValueChanged=function(){for(var e=I,i="",n=a.vSearchResource.value.toString().split(","),l=0;l<n.length;l++)i=e.getDisplay(n[l]),-1==$.indexOf(n[l])&&null!=n[l]&&(C.append('<div class="vas-selected-lbl">'+i+'<span class="vis vis-cross" data-resourceid="'+n[l]+'"></span></div>'),m.append(C),$.push(n[l]),C.find(".vis-cross").on("click",function(){var e=t(this).attr("data-resourceid");$=jQuery.grep($,function(t){return VIS.Utility.Util.getValueOfInt(t)!=VIS.Utility.Util.getValueOfInt(e)}),t(this).parent().remove(),0==C.find(".vis-cross").length&&C.remove()}));a.vSearchResource.setValue(null)},a.cmbOrg.fireValueChanged=function(){i.setContext(a.windowNo,"AD_Org_ID",a.cmbOrg.getValue())}}(),function(){var i=t('<div class="vas-tis-leftbuttondiv">');a.topDiv=t("<div id='topDiv_"+a.windowNo+"' class='vis-archive-l-s-head vis-frm-ls-top' style='padding: 0;'><div id='btnSpaceDiv_"+a.windowNo+"' class='vas-spacediv'><button id='btnSpace_"+a.windowNo+"' class='vis-archive-sb-t-button' ><i class='vis vis-arrow-left'></i></button></div><div id='spnSelect_"+a.windowNo+"' class='vas-RecordSelection'><div class='vas-SelectDiv'><label id='spnSelectRecord_"+a.windowNo+"' class='VIS_Pref_Label_Font vas-SpnSelect'>"+e.translatedTexts.VAS_RecordSelection+"</label></div><div class='vas-tis-filter dropdown'><div class='vas-tis-icondiv'><a class='vas-tis-refreshicon' id='vas-tis-refresh_"+a.windowNo+"'><span class='glyphicon glyphicon-refresh'></span></a><span class='vas-tis-filterspn btn d-flex position-relative' type='button' id='vas_tis_dropdownMenu_"+a.windowNo+"'><i class='fa fa-filter vas-tis-filterIcon'></i></span></div><div class='vas-tis-filterPopupWrap' id='vas_tis_FilterPopupWrap_"+a.windowNo+"'></div></div>"),a.btnSpaceDiv=a.topDiv.find("#btnSpaceDiv_"+a.windowNo),a.recordDiv=a.topDiv.find("#spnSelect_"+a.windowNo),a.LeftsideDiv=t("<div id='sideDiv_"+a.windowNo+"' class='vas-tis-leftsidewrap vis-leftsidebarouterwrap px-3'>"),a.SearchBtn=t("<input id='SearchBtn_"+a.windowNo+"' class='VIS_Pref_btn-2 vas-searchbtn' type='button' value='"+e.translatedTexts.Search+"'>"),a.bottumDiv=t("<div class='vis-info-btmcnt-wrap vis-p-t-10 vas-BottomBtnDiv'>"),a.PreviewBtn=t("<button id='PreviewBtn_"+a.windowNo+"' class='VIS_Pref_btn-2 mr-2 vas-tis-btnmargin'>"+e.translatedTexts.VAS_Preview+"</button>"),a.GenerateInvBtn=t("<button id='VAS_GenInvoice_"+a.windowNo+"' class='VIS_Pref_btn-2 vas-tis-btnmargin'>"+e.translatedTexts.VAS_GenInvoice+"</button>"),i.append(a.SearchBtn),a.LeftsideDiv.append(U).append(i);var n=t("<div class='vas-tis-rightbottomdiv'>");n.append(a.GenerateInvBtn).append(a.PreviewBtn),a.bottumDiv.append(ne).append(n),a.gridSelectDiv=t("<div id='gridSelectDiv_"+a.windowNo+"' class='vis-frm-grid-outerwrp'>"),a.$root.append(a.topDiv).append(a.LeftsideDiv).append(a.gridSelectDiv).append(a.bottumDiv)}(),(A=t('<div class="vis-busyindicatorouterwrap" style="visibility: hidden;"></div>')).append(t('<div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div>')),a.setBusy(!1),a.$root.append(A)}function ue(i){var n="hsl("+(Math.floor(360*Math.random())+0)+", 100%,"+(Math.floor(16*Math.random())+60)+"%)";null!=a.dGrid&&(a.dGrid.destroy(),a.dGrid=null),0==a.arrListColumns.length&&(a.arrListColumns.push({field:"recid",caption:e.translatedTexts.VAS_RecordNo,sortable:!0,size:"1%",min:50,hidden:!0}),a.arrListColumns.push({field:"DocumentNo",caption:e.translatedTexts.VAS_RecordId,sortable:!0,size:"30%",min:100,hidden:!1,render:function(e,t,a){return'<a href="#" class="vas-decoration-style">'+e.DocumentNo+"</a>"},editable:{type:"text"}}),a.arrListColumns.push({field:"C_BPartner",caption:e.translatedTexts.VAS_Customer,sortable:!0,size:"25%",min:120,hidden:!1,render:function(e){var t="",a=e.C_BPartner.trim().split(" ");return t=a[0].substring(0,1).toUpper(),a.length>1?t+=a[a.length-1].substring(0,1).toUpper():t=a[0].substring(0,2).toUpper(),null!=e.ImageUrl?'<div class="vas-tis-gridimg vis-gridImageicon"><img class="vas-businessPartnerImg" alt="'+e.ImageUrl+'" src="'+VIS.Application.contextUrl+e.ImageUrl+'"><div class="vas-tis-bpstyling">'+e.C_BPartner+"</div>":'<div style="float:left ;background-color:'+n+'" class="vis-grid-row-td-icon"><span style="font-size: 16px;">'+t+'</span></div><div class="vas-tis-bpstyling">'+e.C_BPartner+"</div>"}}),a.arrListColumns.push({field:"S_Resource_ID",caption:e.translatedTexts.S_Resource_ID,sortable:!0,size:"14%",min:150,hidden:!1}),a.arrListColumns.push({field:"M_Product",caption:e.translatedTexts.VAS_ProductOrCharge,sortable:!0,size:"25%",min:100,hidden:!1,render:function(e){var t="",a=e.M_Product.trim().split(" ");return t=a[0].substring(0,1).toUpper(),a.length>1?t+=a[a.length-1].substring(0,1).toUpper():t=a[0].substring(0,2).toUpper(),null!=e.productImgUrl?'<div class="vas-tis-gridimg vis-gridImageicon"><img class="vas-businessPartnerImg" alt="'+e.productImgUrl+'" src="'+VIS.Application.contextUrl+e.productImgUrl+'"><div class="vas-tis-bpstyling">'+e.M_Product+"</div>":'<div style="float:left;background-color:'+n+'" class="vis-grid-row-td-icon"><span style="font-size: 16px;">'+t+'</span></div><div class="vas-tis-bpstyling">'+e.M_Product+"</div>"}}),a.arrListColumns.push({field:"Qty",caption:e.translatedTexts.Qty,sortable:!0,size:"5%",min:100,hidden:!1,render:function(e,t,a){return e.Qty+" "+e.UomName}}),a.arrListColumns.push({field:"Price",caption:e.translatedTexts.Price,sortable:!0,size:"10%",min:100,hidden:!1,style:"text-align:right;",editable:{type:"number"},render:function(e,t,a){var i=e.Price;return s=e.StdPrecision,parseFloat(i).toLocaleString(window.navigator.language,{minimumFractionDigits:s,maximumFractionDigits:s})}}),a.arrListColumns.push({field:"Amount",caption:e.translatedTexts.VAS_TotalBilableAmount,sortable:!0,size:"18%",min:100,hidden:!1,style:"text-align:right;",render:function(e,t,a){var i=e.Amount;return s=e.StdPrecision,parseFloat(i).toLocaleString(window.navigator.language,{minimumFractionDigits:s,maximumFractionDigits:s})+" "+e.ISO_Code}}),a.arrListColumns.push({field:"C_BPartner_ID",caption:e.translatedTexts.C_BPartner_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"VA009_PaymentMethod_ID",caption:e.translatedTexts.VA009_PaymentMethod_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"M_PriceList_ID",caption:e.translatedTexts.M_PriceList_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"C_BPartner_Location_ID",caption:e.translatedTexts.C_BPartner_Location_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"M_Product_ID",caption:e.translatedTexts.M_Product_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"C_Charge_ID",caption:e.translatedTexts.C_Charge_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"C_Currency_ID",caption:e.translatedTexts.C_Currency_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"C_PaymentTerm_ID",caption:e.translatedTexts.C_PaymentTerm_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"C_Uom_ID",caption:e.translatedTexts.C_Uom_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"LocationName",caption:e.translatedTexts.VAS_LocationName,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"recordCount",caption:e.translatedTexts.VAS_recordCounted,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"RecordedDate",caption:e.translatedTexts.VAS_RecordedDate,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"EstimatedTime",caption:e.translatedTexts.VAS_EstimatedTime,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"ProjReq_Name",caption:e.translatedTexts.VAS_ProjReq_Name,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"ProjReq_ID",caption:e.translatedTexts.VAS_ProjReq_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"PhaseName",caption:e.translatedTexts.VAS_PhaseName,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"PriceStd",caption:e.translatedTexts.PriceStd,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"PriceLimit",caption:e.translatedTexts.PriceLimit,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"StdPrecision",caption:e.translatedTexts.StdPrecision,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"EnforcePriceLimit",caption:e.translatedTexts.EnforcePriceLimit,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"VA075_WorkOrderOperation_ID",caption:e.translatedTexts.VA075_WorkOrderOperation_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"S_TimeExpenseLine_ID",caption:e.translatedTexts.S_TimeExpenseLine_ID,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"ISO_Code",caption:e.translatedTexts.VAS_ISO_Code,sortable:!0,size:"16%",min:150,hidden:!0}),a.arrListColumns.push({field:"RequestSummary",caption:e.translatedTexts.VAS_RequestSummary,sortable:!0,size:"16%",min:150,hidden:!0})),w2utils.encodeTags(i),a.dGrid=t(a.gridSelectDiv).w2grid({name:"gridGenForm_"+a.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:a.arrListColumns,records:i,scorll:!0,onSelect:function(t){a.dGrid.records.length>0&&pe(t,a.dGrid,!1),t.onComplete=function(){(r.length>0||c.length>0)&&function(t){var a=e.translatedTexts.VAS_InvoiceCreationFail;if(r.length>0)for(var i=0;i<r.length;i++)t.unselect(r[i]);if(c.length>0)for(i=0;i<c.length;i++)t.unselect(c[i]);VIS.ADialog.info("","",a)}(a.dGrid)}},onUnselect:ge,onEditField:function(i){if(1==i.column){i.stopPropagation(),i.preventDefault();var n=new Date(a.dGrid.records[i.index].RecordedDate),l=t("<div>"),s='<div class="vas-taskDescDailog">                                                                        <div class="vas-taskDesc_feildWrap mb-2 ">                                                                            <div class="vas-taskDesc_feild">                                                                                      <span class="vas-taskdescTtl">'+e.translatedTexts.VAS_RecordingDate+'</span>                                                                 <span class="vas-taskdescValue">'+(n.toLocaleDateString()||"")+'</span>                                                                 </div>                                                                                                              <div class="vas-taskDesc_feild">                                                                                      <span class="vas-taskdescTtl text-right">'+e.translatedTexts.VAS_RequestOrProject+'</span>                                            <span class="vas-taskdescValue text-right">'+(a.dGrid.records[i.index].ProjReq_Name||"")+'</span>                                       </div>                                                                                                            </div>                                                                                                              <div class="vas-projectTimeline mb-2">                                                                                <span class="vas-taskdescTtl">'+e.translatedTexts.VAS_RequestOrProject+"</span></div>";if(null!=a.dGrid.records[i.index].PhaseName){s+='<div class="vas-tis-roadmap-container"> <div class="vas-tis-steps-row">';for(var o="",r=0,c=a.dGrid.records[i.index].PhaseName,u="vas-tis-next-row",d="vas-tis-reverse-row",g="",p=0;p<c.length;p++)2==p&&(g=d),p>2&&0==r&&g==d?g=u:0==r&&g==u&&(g=d),o="IP"==c[p].PhaseStatus?"vas-tis-step-inprogress":"CO"==c[p].PhaseStatus?"vas-tis-step-completed":"DR"==c[p].PhaseStatus?"vas-tis-step-drafted":"vas-tis-step-null",0==p&&(s+='<div class="vas-tis-steps-col '+o+' w-33"><div class="vas-tis-step-start"><div class="vas-tis-step-circle"><span class="vis vis-markx"></span></div><span>'+e.translatedTexts.VAS_Start+'</span></div><div class="vas-tis-step-content"><div class="vas-tis-step-circle"><span class="vis vis-markx"></span></div><span>'+c[0].PhaseName+"</span></div></div>"),1==p&&(s+=de(c[1],o)),p>1&&(0==r&&2==p&&(s+=de(c[p],o),s+="</div>"),1==(r+=1)?(s+='<div class="vas-tis-steps-row '+g+'">',s+=de(c[p],o)):s+=de(c[p],o),2==r&&p!=c.length-1&&(o="IP"==c[p+1].PhaseStatus?"vas-tis-step-inprogress":"CO"==c[p+1].PhaseStatus?"vas-tis-step-completed":"DR"==c[p+1].PhaseStatus?"vas-tis-step-drafted":"vas-tis-step-null",s+=de(c[p],o),r=0)),0==r&&p>1&&(s+="</div>")}else null!=a.dGrid.records[i.index].RequestSummary&&(s+='<div class="vas-tis-requestsummary p-3 mb-3 mt-1">'+(a.dGrid.records[i.index].RequestSummary||"")+"</div>");s+='</div>   </div>                                                                                                            <div class="vas-taskDesc_feildWrap mb-2 ">                                                                            <div class="vas-taskDesc_feild">                                                                                      <span class="vas-taskdescTtl">'+e.translatedTexts.VAS_EstimatedTime+'</span>                                                                 <span class="vas-taskdescValue">'+(a.dGrid.records[i.index].EstimatedTime||"")+'</span>                                                                   </div>                                                                                                              <div class="vas-taskDesc_feild">                                                                                      <span class="vas-taskdescTtl text-right">'+e.translatedTexts.VAS_RecordedTime+'</span>                                                       <span class="vas-taskdescValue text-right">'+(a.dGrid.records[i.index].Qty||"")+"</span>                                                        </div>                                                                                                            </div>                                                                                                             </div>",l.append(s);var _=new VIS.ChildDialog;_.setContent(l),_.setTitle(e.translatedTexts.VAS_RequestInfoDialog),_.setWidth("50%"),_.setEnableResize(!0),_.setModal(!0),_.show(),_.hideButtons()}else 6==i.column&&(i.onComplete=function(e){id=e.recid,t("#grid_gridGenForm_"+a.windowNo+"_rec_"+id).keydown(function(e){var t=v.isDecimalSeparatorDot(window.navigator.language);return!!(t||190!=e.keyCode&&110!=e.keyCode)&&((!t||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which||(this.value=this.value.replace(".","")),!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||(this.value=this.value.replace(",","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))})})},onChange:function(e){if(null!=a.dGrid.getChanges(e.recid)&&6==e.column){if(""==e.value_new?e.value_new=0:(e.value_new=_.GetConvertedNumber(e.value_new,V),e.value_new=e.value_new.toLocaleString(window.navigator.language,{minimumFractionDigits:s,maximumFractionDigits:s}),e.value_new=_.GetConvertedNumber(e.value_new,V)),"Y"==a.dGrid.records[e.index].EnforcePriceLimit&&parseFloat(e.value_new)<a.dGrid.records[e.index].PriceLimit)return VIS.ADialog.info("VAS_PriceLimitExceeds"),e.value_new=e.value_original,a.dGrid.getChanges(e.recid).Price=e.value_original,a.dGrid.records[e.index].Price=e.value_original,void a.dGrid.refreshCell(e.recid,"Price");a.dGrid.records[e.index].Price=e.value_new,a.dGrid.records[e.index].Amount=e.value_new*a.dGrid.records[e.index].Qty,a.dGrid.refreshCell(e.recid,"Amount"),a.dGrid.refreshCell(e.recid,"Price")}}}),a.gridSelectDiv.find("#grid_gridGenForm_"+a.windowNo+"_records").off("scroll",_e),a.gridSelectDiv.find("#grid_gridGenForm_"+a.windowNo+"_records").on("scroll",_e)}function de(e,t){return'<div class="vas-tis-steps-col '+t+' w-33"><div class="vas-tis-step-content"><div class="vas-tis-step-circle"><span class="vis vis-markx"></span></div><span>'+e.PhaseName+"</span></div></div>"}function ge(e){pe(e,a.dGrid,!0)}function pe(e,t,a){if(null==e.recid){k=[],G=[];for(var i=0;i<t.records.length;i++)a?(k=[],G=[],r=[],c=[]):(0==t.records[i].C_PaymentTerm_ID&&r.push(t.records[i].recid),0==t.records[i].VA009_PaymentMethod_ID?c.push(t.records[i].recid):k.push(t.records[i]));!function(e,t){if(0===e.length)return void(G=[]);for(var a=0;a<e.length;a++){for(var i=e[a],n=!0,l=0;l<G.length;l++)if(i.C_BPartner_ID===G[l].C_BPartner_ID&&i.C_BPartner_Location_ID===G[l].C_BPartner_Location_ID&&i.VA009_PaymentMethod_ID===G[l].VA009_PaymentMethod_ID&&i.M_PriceList_ID===G[l].M_PriceList_ID){G[l].recordCount=G[l].recordCount+1,n=!1;break}n&&t&&(i.recordCount=1,G.push(i))}}(k,!0)}else a?(Ve(e,t,!1),k=jQuery.grep(k,function(t){return VIS.Utility.Util.getValueOfInt(t.recid)!=VIS.Utility.Util.getValueOfInt(e.recid)})):(r=[],c=[],0==t.records[e.index].C_PaymentTerm_ID&&-1==r.indexOf(t.records[e.index].recid)&&r.push(t.records[e.index].recid),0==t.records[e.index].VA009_PaymentMethod_ID&&-1==c.indexOf(t.records[e.index].recid)?c.push(t.records[e.index].recid):k.push(t.records[e.index]),Ve(e,t,!0))}e.translatedTexts=VIS.Msg.translate(i,["VAS_TimeRecordDoc","VAS_Customer","S_Resource_ID","M_Product_ID","Qty","VAS_TotalBilableAmount","Price","C_BPartner_ID","VA009_PaymentMethod_ID","M_PriceList_ID","C_Charge_ID","C_Currency_ID","C_Uom_ID","VAS_LocationName","VAS_recordCounted","VAS_RecordedDate","VAS_EstimatedTime","VAS_ProjReq_Name","VAS_ProjReq_ID","VAS_PhaseName","PriceStd","PriceLimit","StdPrecision","EnforcePriceLimit","VA075_WorkOrderOperation_ID","S_TimeExpenseLine_ID","AD_Org_ID","VAS_FromDate","VAS_toDate","VAS_RecordSelection","Search","VAS_RecordNo","VAS_Preview","VAS_GenInvoice","S_TimeExpense_ID","C_Project_ID","R_Request_ID","C_Task_ID","VAS_RecordedTime","VAS_EstimatedTime","VAS_RequestOrProject","VAS_RecordingDate","VAS_Filter","VAS_ProductOrCharge","VAS_CustImage","VAS_RecordCount","VAS_Start","VA075_Task_ID","VAS_Apply","VAS_UomName","VAS_PreviewDialog","VAS_RequestInfoDialog","VAS_SubTotal","VAS_ISO_Code","VAS_BindPaymentTerm","VAS_Refresh","VAS_ZeroPriceFor","VAS_TaskType","VAS_RecordId","VAS_PaymentMethodNotBinded","VAS_PaymentTermNotBinded","VAS_InvoiceCreationFail","VAS_PayTermNotBined","VAS_PayMethod","VAS_And","C_DocType_ID","VAS_InvoiceType"],!0),this.setBusy=function(e){A[0].style.visibility=e?"visible":"hidden"};var ve=function(e){re=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS_TimeSheetInvoices/GetColumnID",{ColumnData:JSON.stringify(e)},null)};function _e(){t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&o<g&&(a.setBusy(!0),Ae(++o,150,!0))}function Ve(e,t,a){for(var i=!0,n=0;n<G.length;n++){if(a&&t.records[e.index].C_BPartner_ID===G[n].C_BPartner_ID&&t.records[e.index].C_BPartner_Location_ID===G[n].C_BPartner_Location_ID&&t.records[e.index].VA009_PaymentMethod_ID===G[n].VA009_PaymentMethod_ID&&t.records[e.index].M_PriceList_ID===G[n].M_PriceList_ID){G[n].recordCount=G[n].recordCount+1,i=!1;break}a||t.records[e.index].C_BPartner_ID!==G[n].C_BPartner_ID||t.records[e.index].C_BPartner_Location_ID!==G[n].C_BPartner_Location_ID||t.records[e.index].VA009_PaymentMethod_ID!==G[n].VA009_PaymentMethod_ID||t.records[e.index].M_PriceList_ID!==G[n].M_PriceList_ID||(G[n].recordCount=G[n].recordCount-1,G[n].recordCount<=0&&(G=jQuery.grep(G,function(e){return e.recordCount>0})))}i&&a&&(t.records[e.index].recordCount=1,G.push(t.records[e.index]))}function Ae(e,i,n){var s=[];if(k=[],G=[],B=[],r=[],c=[],0!=VIS.Utility.Util.getValueOfInt(l)){var o=VIS.Env.getCtx().getAD_Client_ID();return a.setBusy(!0),t.ajax({url:VIS.Application.contextUrl+"VAS_TimeSheetInvoices/LoadGridData",type:"POST",data:{AD_Client_ID:VIS.Utility.Util.getValueOfInt(o),AD_Org_ID:VIS.Utility.Util.getValueOfInt(l),C_BPartner_ID:J.toString(),S_Resource_ID:$.toString(),TimExpenSeDoc:F.toString(),C_Project_ID:j.toString(),R_Request_ID:Q.toString(),C_Task_ID:W.toString(),FromDate:f.getValue(),toDate:D.getValue(),TaskType:p,pageNo:e,pageSize:i},success:function(t){var l=JSON.parse(t);if(l&&l.length>0){var o=0;o=n?a.dGrid.records.length+1:1,1==e&&l.length>0&&(u=l[0].countRecords,g=Math.ceil(u/i));for(var r=0;r<l.length;r++){var c={};c.DocumentNo=l[r].DocumentNo,c.C_BPartner=l[r].CustomerName,c.S_Resource_ID=l[r].ResourceName,c.M_Product=l[r].ProductName,c.Qty=l[r].Qty,c.Price=l[r].PriceList,c.PriceStd=l[r].PriceStd,c.PriceLimit=l[r].PriceLimit,c.Amount=l[r].PriceList*l[r].Qty,c.C_BPartner_ID=l[r].CustomerId,c.StdPrecision=l[r].stdPrecision,c.VA009_PaymentMethod_ID=l[r].VA009_PaymentMethod_ID,c.M_PriceList_ID=l[r].M_PriceList_ID,c.C_BPartner_Location_ID=l[r].C_Location_ID,c.M_Product_ID=l[r].M_Product_ID,c.C_Charge_ID=l[r].C_Charge_ID,c.C_Uom_ID=l[r].C_Uom_ID,c.C_PaymentTerm_ID=l[r].C_PaymentTerm_ID,c.C_Currency_ID=l[r].C_Currency_ID,c.UomName=l[r].UomName,c.ISO_Code=l[r].ISO_Code,c.ImageUrl=l[r].ImageUrl,c.productImgUrl=l[r].productImgUrl,c.LocationName=l[r].LocationName,c.ProjReq_ID=l[r].ProjReq_ID,c.ProjReq_Name=l[r].ProjReq_Name,c.RecordedDate=l[r].RecordedDate,c.EstimatedTime=l[r].EstimatedTime,c.EnforcePriceLimit=l[r].EnforcePriceLimit,c.S_TimeExpenseLine_ID=l[r].S_TimeExpenseLine_ID,c.VA075_WorkOrderOperation_ID=l[r].VA075_WorkOrderOperation_ID,null!=l[r].PhaseInfo?c.PhaseName=l[r].PhaseInfo:null!=l[r].RequestSummary&&(c.RequestSummary=l[r].RequestSummary),c.recordCount=0,c.recid=o,o++,s.push(c)}}else VIS.ADialog.info("NoDataFound");n?a.dGrid.add(s):ue(s),a.setBusy(!1)},error:function(e){}}),s}VIS.ADialog.info("VAS_PlzSelectOrganization")}function me(i){var n="hsl("+(Math.floor(360*Math.random())+0)+", 100%,"+(Math.floor(16*Math.random())+60)+"%)";a.PreviewColumns=[],null!=a.dGridPreview&&(a.dGridPreview.destroy(),a.dGridPreview=null),0==a.PreviewColumns.length&&(a.PreviewColumns.push({field:"M_Product",caption:e.translatedTexts.VAS_ProductOrCharge,sortable:!0,size:"16%",min:150,hidden:!1,render:function(e){var t="",a=e.M_Product.trim().split(" ");return t=a[0].substring(0,1).toUpper(),a.length>1?t+=a[a.length-1].substring(0,1).toUpper():t=a[0].substring(0,2).toUpper(),null!=e.productImgUrl?'<div class="vas-tis-gridimg vis-gridImageicon"><img class="vas-businessPartnerImg" alt="'+e.productImgUrl+'" src="'+VIS.Application.contextUrl+e.productImgUrl+'"><div class="vas-tis-bpstyling">'+e.M_Product+"</div>":'<div style="float:left;margin:6px;background-color:'+n+'" class="vis-grid-row-td-icon"><span style="font-size: 16px;">'+t+'</span></div><div class="vas-tis-prodicon" style"text-overflow: ellipsis;">'+e.M_Product+"</div>"}}),a.PreviewColumns.push({field:"Price",caption:e.translatedTexts.Price,size:"16%",sortable:!0,size:"16%",min:150,style:"text-align:right;",hidden:!1,render:function(e,t,a){var i=e.Price;return s=e.StdPrecision,parseFloat(i).toLocaleString(window.navigator.language,{minimumFractionDigits:s,maximumFractionDigits:s})}}),a.PreviewColumns.push({field:"UomName",caption:e.translatedTexts.VAS_UomName,sortable:!0,size:"16%",min:150,hidden:!1}),a.PreviewColumns.push({field:"Qty",caption:e.translatedTexts.Qty,size:"16%",sortable:!0,size:"16%",min:150,hidden:!1}),a.PreviewColumns.push({field:"Amount",caption:e.translatedTexts.VAS_TotalBilableAmount,size:"16%",sortable:!0,style:"text-align:right;",size:"16%",min:150,hidden:!1,render:function(e,t,a){m+=e.Amount;var i=e.Amount;return s=e.StdPrecision,parseFloat(i).toLocaleString(window.navigator.language,{minimumFractionDigits:s,maximumFractionDigits:s})+" "+e.ISO_Code}})),a.dGridPreview=t(a.PreviewGridDiv).w2grid({name:"GridPreview_"+a.windowNo,recordHeight:29,columns:a.PreviewColumns,records:i})}function fe(){null==a.cmbOrg.oldValue&&a.cmbOrg.setValue(0),null==a.cmbDocType.oldValue&&a.cmbDocType.setValue(0),a.cmbDocType.setValue(null),a.cmbOrg.setValue(null),f.setValue(null),D.setValue(null)}function De(){h.remove(),C.remove()}function he(){k=[],G=[],B=[],F=[],Q=[],p=null,L=null,$=[],W=[],J=[],j=[],X=[],ee=[],Z=[],K=[],z=[],H=[],Y=[],q=[],r=[],c=[]}this.Initialize=function(){ce(),this.btnToggel=this.$root.find("#btnSpace_"+a.windowNo),this.spnRecordSelection=this.$root.find("#spnSelect_"+a.windowNo),this.PreviewBtn=this.$root.find("#PreviewBtn_"+a.windowNo);var i=this.$root.find("#vas_tis_dropdownMenu_"+a.windowNo),r=this.$root.find("#vas-tis-refresh_"+a.windowNo);if(null!=i&&i.on("click",function(){E?(te.remove(),E=!1):(a.setBusy(!0),z=JSON.parse(JSON.stringify(K)),H=JSON.parse(JSON.stringify(Z)),Y=JSON.parse(JSON.stringify(ee)),q=JSON.parse(JSON.stringify(X)),0==z.length&&(F=[]),0==H.length&&(W=[]),0==Y.length&&(Q=[]),0==q.length&&(j=[]),function(){var i=a.$root.find("#vas_tis_FilterPopupWrap_"+a.windowNo);te=t('  <div class="vas-filter-flyout">                                                                  <div class="vas-flyout-header">                                                                  <h1>'+e.translatedTexts.VAS_Filter+'</h1><span class="vis vis-cross"></span>     </div>                                                                                         <div class="vas-from-row">'),S=t('<div class="vas-tis-dropdown-lbl d-flex flex-wrap">'),I=t('<div class="vas-tis-dropdown-lbl">'),y=t('<div class="vas-tis-dropdown-lbl">'),O=t('<div class="vas-tis-dropdown-lbl">'),b=t('<div class="VAS-Time">'),$TimeAndExpenseDiv=t('<div class="input-group vis-input-wrap">');var s="S_TimeExpense.DocStatus IN ('CO','CL')",r=VIS.MLookupFactory.get(VIS.Env.getCtx(),a.windowNo,re.S_TimeExpense_ID,VIS.DisplayType.MultiKey,"S_TimeExpense_ID",0,!1,s);a.vSearchTimeAndExpense=new VIS.Controls.VTextBoxButton("S_TimeExpense_ID",!0,!1,!0,VIS.DisplayType.MultiKey,r);var c=t('<div class="vis-control-wrap">'),u=t('<div class="input-group-append">');$TimeAndExpenseDiv.append(c),c.append(a.vSearchTimeAndExpense.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.S_TimeExpense_ID+"</label>"),$TimeAndExpenseDiv.append(c),u.append(a.vSearchTimeAndExpense.getBtn(0)),$TimeAndExpenseDiv.append(u),b.append($TimeAndExpenseDiv),M=t('<div class="VAS-projectdiv">'),$ProjectDiv=t('<div class="input-group vis-input-wrap">'),s="C_Project.AD_Org_ID IN(0,@AD_Org_ID@) AND C_Project.IsActive='Y' AND C_Project.IsOpportunity='N' AND C_Project.IsCampaign='N'";var d=VIS.MLookupFactory.getMLookUp(VIS.Env.getCtx(),a.windowNo,re.C_ProjectRef_ID,VIS.DisplayType.MultiKey,"C_ProjectRef_ID",0,!1,s);a.vSearchProject=new VIS.Controls.VTextBoxButton("C_Project_ID",!0,!1,!0,VIS.DisplayType.MultiKey,d);var v=t('<div class="vis-control-wrap">'),_=t('<div class="input-group-append">');a.vSearchProject.setCustomInfo("Project"),$ProjectDiv.append(v),v.append(a.vSearchProject.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.C_Project_ID+"</label>"),$ProjectDiv.append(_),_.append(a.vSearchProject.getBtn(0)),$ProjectDiv.append(_),M.append($ProjectDiv),x=t('<div class="VAS-RequestDiv">'),$RequestDiv=t('<div class="input-group vis-input-wrap">');var V=VIS.MLookupFactory.getMLookUp(VIS.Env.getCtx(),a.windowNo,re.R_Request_ID,VIS.DisplayType.MultiKey);a.vSearchRequest=new VIS.Controls.VTextBoxButton("R_Request_ID",!0,!1,!0,VIS.DisplayType.MultiKey,V);var A=t('<div class="vis-control-wrap">'),m=t('<div class="input-group-append">');if($RequestDiv.append(A),A.append(a.vSearchRequest.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.R_Request_ID+"</label>"),$RequestDiv.append(m),m.append(a.vSearchRequest.getBtn(0)),$RequestDiv.append(m),x.append($RequestDiv),R.VA075_){N=t('<div class="VAS-TaskDiv">'),$TaskDiv=t('<div class="input-group vis-input-wrap">');var h=VIS.MLookupFactory.getMLookUp(VIS.Env.getCtx(),a.windowNo,re.VA075_Task_ID,VIS.DisplayType.MultiKey);a.vSearchTask=new VIS.Controls.VTextBoxButton("VA075_Task_ID",!0,!1,!0,VIS.DisplayType.MultiKey,h);var C=t('<div class="vis-control-wrap">'),T=t('<div class="input-group-append">');a.vSearchTask.setCustomInfo("VA075_TaskMaster"),$TaskDiv.append(C),C.append(a.vSearchTask.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.VA075_Task_ID+"</label>"),$TaskDiv.append(C),T.append(a.vSearchTask.getBtn(0)),$TaskDiv.append(T),N.append($TaskDiv),TaskTypeDiv=t('<div class="VAS-TaskTypeDiv">'),$TaskTypeDiv=t('<div class="input-group vis-input-wrap">'),$TaskTypeLookUp=VIS.MLookupFactory.get(VIS.Env.getCtx(),a.windowNo,0,VIS.DisplayType.List,"VAS_TaskType",re.AD_Reference_ID,!1),a.vTaskType=new VIS.Controls.VComboBox("VAS_TaskType",!1,!1,!0,$TaskTypeLookUp,100);var w=t('<div class="vis-control-wrap">'),P=t('<div class="input-group-append">');$TaskTypeDiv.append(w),w.append(a.vTaskType.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.VAS_TaskType+"</label>"),$TaskTypeDiv.append(w),P.append(a.vTaskType.getBtn(0)),$TaskTypeDiv.append(P),TaskTypeDiv.append($TaskTypeDiv),te.append(b).append(N).append(M).append(x).append(TaskTypeDiv),null!=L?a.vTaskType.setValue(L):a.vTaskType.setValue(null)}else te.append(b).append(M).append(x);var U=t('<div class="vas-flyout-footer"><button class="VIS_Pref_btn-2 w-100 mt-0" id="VAS_Apply_'+a.windowNo+'">'+e.translatedTexts.VAS_Apply+"</button></div>");te.append(U);var k=U.find("#VAS_Apply_"+a.windowNo);i.append(te),k.on("click",function(){if(null!=f.getValue()&&null!=D.getValue()){if(f.getValue()>D.getValue())return VIS.ADialog.info("VAS_PlzEnterCorrectDate"),void D.setValue(null);K=z,Z=H,X=q,ee=Y,L=p,l=a.cmbOrg.getControl().find("option:selected").val(),g=1,Ae(o=1,150,!1),te.remove()}else VIS.ADialog.info("VAS_DateFieldAreMandatory")}),a.vTaskType.fireValueChanged=function(){p=a.vTaskType.getValue()},a.vSearchTimeAndExpense.fireValueChanged=function(){for(var e=r,i="",l=a.vSearchTimeAndExpense.value.toString().split(","),s=0;s<l.length;s++)i=e.getDisplay(l[s]),-1==F.indexOf(l[s])&&null!=l[s]&&(S.append('<div class="vas-selected-lbl">'+i+'<span class="vis vis-cross" data-timeandexpenceid="'+l[s]+'"></span></div>'),b.append(S),F.push(l[s]),n={Id:l[s],Name:i},z.push(n),S.find(".vis-cross").on("click",function(){var e=t(this).attr("data-timeandexpenceid");F=jQuery.grep(F,function(t){return VIS.Utility.Util.getValueOfInt(t)!=VIS.Utility.Util.getValueOfInt(e)}),z=jQuery.grep(z,function(t){return VIS.Utility.Util.getValueOfInt(t.Id)!=VIS.Utility.Util.getValueOfInt(e)}),t(this).parent().remove(),0==S.find(".vis-cross").length&&S.remove()}));a.vSearchTimeAndExpense.setValue(null)},a.vSearchTask.fireValueChanged=function(){for(var e=h,i="",n=a.vSearchTask.value.toString().split(","),l=0;l<n.length;l++)if(i=e.getDisplay(n[l]),-1==W.indexOf(n[l])&&null!=n[l]){I.append('<div class="vas-selected-lbl">'+i+'<span class="vis vis-cross" data-taskid="'+n[l]+'"></span></div>'),N.append(I),W.push(n[l]);var s={TaskId:n[l],TaskName:i};H.push(s),I.find(".vis-cross").on("click",function(){var e=t(this).attr("data-taskid");W=jQuery.grep(W,function(t){return VIS.Utility.Util.getValueOfInt(t)!=VIS.Utility.Util.getValueOfInt(e)}),H=jQuery.grep(H,function(t){return VIS.Utility.Util.getValueOfInt(t.TaskId)!=VIS.Utility.Util.getValueOfInt(e)}),t(this).parent().remove(),0==I.find(".vis-cross").length&&I.remove()})}a.vSearchTask.setValue(null)},a.vSearchProject.fireValueChanged=function(){for(var e=d,i="",n=a.vSearchProject.value.toString().split(","),l=0;l<n.length;l++)if(i=e.getDisplay(n[l]),-1==j.indexOf(n[l])&&null!=n[l]){y.append('<div class="vas-selected-lbl">'+i+'<span class="vis vis-cross" data-projectid="'+n[l]+'"></span></div>'),M.append(y),j.push(n[l]);var s={ProjectId:n[l],ProjectName:i};q.push(s),y.find(".vis-cross").on("click",function(){var e=t(this).attr("data-projectid");j=jQuery.grep(j,function(t){return VIS.Utility.Util.getValueOfInt(t)!=VIS.Utility.Util.getValueOfInt(e)}),q=jQuery.grep(q,function(t){return VIS.Utility.Util.getValueOfInt(t.ProjectId)!=VIS.Utility.Util.getValueOfInt(e)}),t(this).parent().remove(),0==y.find(".vis-cross").length&&y.remove()})}a.vSearchProject.setValue(null)},a.vSearchRequest.fireValueChanged=function(){for(var e=V,i="",n=a.vSearchRequest.value.toString().split(","),l=0;l<n.length;l++)if(i=e.getDisplay(n[l]),-1==Q.indexOf(n[l])&&null!=n[l]){O.append('<div class="vas-selected-lbl">'+i+'<span class="vis vis-cross" data-requestid="'+n[l]+'"></span></div>'),x.append(O),Q.push(n[l]);var s={RequestId:n[l],RequestName:i};Y.push(s),O.find(".vis-cross").on("click",function(){var e=t(this).attr("data-requestid");Q=jQuery.grep(Q,function(t){return VIS.Utility.Util.getValueOfInt(t)!=VIS.Utility.Util.getValueOfInt(e)}),Y=jQuery.grep(Y,function(t){return VIS.Utility.Util.getValueOfInt(t.RequestId)!=VIS.Utility.Util.getValueOfInt(e)}),t(this).parent().remove(),0==O.find(".vis-cross").length&&O.remove()})}a.vSearchRequest.setValue(null)},te.find(".vis-cross").on("click",function(){te.remove(),E=!1})}(),function(){if(K.length>0){for(var e=0;e<K.length;e++)S.append('<div class="vas-selected-lbl">'+K[e].Name+'<span class="vis vis-cross" data-timeandexpenceid="'+K[e].Id+'"></span></div>'),b.append(S);S.find(".vis-cross").on("click",function(){var e=t(this).attr("data-timeandexpenceid");F=jQuery.grep(F,function(t){return VIS.Utility.Util.getValueOfInt(t)!=VIS.Utility.Util.getValueOfInt(e)}),z=jQuery.grep(z,function(t){return VIS.Utility.Util.getValueOfInt(t.Id)!=VIS.Utility.Util.getValueOfInt(e)}),t(this).parent().remove(),0==S.find(".vis-cross").length&&S.remove()})}if(Z.length>0){for(e=0;e<H.length;e++)I.append('<div class="vas-selected-lbl">'+Z[e].TaskName+'<span class="vis vis-cross" data-taskid="'+Z[e].TaskId+'"></span></div>'),N.append(I);I.find(".vis-cross").on("click",function(){var e=t(this).attr("data-taskid");W=jQuery.grep(W,function(t){return VIS.Utility.Util.getValueOfInt(t)!=VIS.Utility.Util.getValueOfInt(e)}),H=jQuery.grep(H,function(t){return VIS.Utility.Util.getValueOfInt(t.TaskId)!=VIS.Utility.Util.getValueOfInt(e)}),t(this).parent().remove(),0==I.find(".vis-cross").length&&I.remove()})}if(X.length>0){for(e=0;e<q.length;e++)y.append('<div class="vas-selected-lbl">'+X[e].ProjectName+'<span class="vis vis-cross" data-projectid="'+X[e].ProjectId+'"></span></div>'),M.append(y);y.find(".vis-cross").on("click",function(){var e=t(this).attr("data-projectid");j=jQuery.grep(j,function(t){return VIS.Utility.Util.getValueOfInt(t)!=VIS.Utility.Util.getValueOfInt(e)}),q=jQuery.grep(q,function(t){return VIS.Utility.Util.getValueOfInt(t.ProjectId)!=VIS.Utility.Util.getValueOfInt(e)}),t(this).parent().remove(),0==y.find(".vis-cross").length&&y.remove()})}if(ee.length>0){for(e=0;e<Y.length;e++)O.append('<div class="vas-selected-lbl">'+ee[e].RequestName+'<span class="vis vis-cross" data-requestid="'+ee[e].RequestId+'"></span></div>'),x.append(O);O.find(".vis-cross").on("click",function(){var e=t(this).attr("data-requestid");Q=jQuery.grep(Q,function(t){return VIS.Utility.Util.getValueOfInt(t)!=VIS.Utility.Util.getValueOfInt(e)}),Y=jQuery.grep(Y,function(t){return VIS.Utility.Util.getValueOfInt(t.RequestId)!=VIS.Utility.Util.getValueOfInt(e)}),t(this).parent().remove(),0==O.find(".vis-cross").length&&O.remove()})}}(),E=!0,a.setBusy(!1))}),null!=r&&r.on("click",function(){a.setBusy(!0),ue(null),he(),fe(),De(),h=t('<div class="vas-tis-dropdown-lbl">'),C=t('<div class="vas-tis-dropdown-lbl">'),null!=te&&te.remove(),a.setBusy(!1)}),null!=this.SearchBtn&&this.SearchBtn.on(VIS.Events.onTouchStartOrClick,function(){if(l=a.cmbOrg.getControl().find("option:selected").val(),0!=VIS.Utility.Util.getValueOfInt(l))if(null!=f.getValue()&&null!=D.getValue()){if(f.getValue()>D.getValue())return VIS.ADialog.info("VAS_PlzEnterCorrectDate"),void D.setValue(null);Ae(o=1,150,!1)}else VIS.ADialog.info("VAS_DateFieldAreMandatory");else VIS.ADialog.info("VAS_PlzSelectOrganization")}),null!=this.PreviewBtn&&this.PreviewBtn.on(VIS.Events.onTouchStartOrClick,function(){0!=G.length?function(i){for(var n=t('<div class="vas-tis-arInvViewer d-flex">'),l=t('<div class= "vas-tis-arInvLeftSide"><div class="vas-tis-arInvListGroup">'),o=t('<div class="vas-tis-arInvRightSide">'),r=t("<div class='vas-poptis-content vis-formouterwrpdiv'>"),c=0;c<G.length;c++)l.append('<div class="vas-tis-arInvlistItem mb-2" id="C_BpartnerListDiv_'+a.windowNo+'"><div class="vas-tis-arInvoiceDetails px-2"><span class="vas-tis-arInvDetailsDesc" id="C_BPartnerDiv_'+a.windowNo+'" data-bpid="'+G[c].C_BPartner_ID+'" data-paymethodid="'+G[c].VA009_PaymentMethod_ID+'" data-pricelistid="'+G[c].M_PriceList_ID+'"> '+VIS.Utility.decodeText(G[c].C_BPartner)+'</span > <span class="vas-tis-arInvDetailsDesc">'+e.translatedTexts.VAS_RecordCount+":"+G[c].recordCount+'</span><span class="vas-tis-arInvDetailsDesLoc" id="C_BPartnerLocationDiv_'+a.windowNo+'" data-bplocationid="'+G[c].C_BPartner_Location_ID+'">'+G[c].LocationName+"</span></div>");var u="gridSelectDiv_"+a.windowNo,d=t('<h4 id="HeadBPTag_'+a.windowNo+'">'+VIS.Utility.decodeText(G[0].C_BPartner)+"</h4>");a.PreviewGridDiv=t("<div id='"+u+"' class='vas-pointdiv'>"),o.append(d).append(a.PreviewGridDiv),n.append(l).append(o),r.append(n);var g=new VIS.ChildDialog;g.setContent(r),g.setTitle(e.translatedTexts.VAS_PreviewDialog),g.setWidth("80%"),g.setHeight(517),g.setEnableResize(!0),g.setModal(!0),g.show(),g.hideButtons();var p=l.find(".vas-tis-arInvlistItem");p.first().addClass("vas-tis-arInvActive");var v=p.find("#C_BPartnerLocationDiv_"+a.windowNo).attr("data-bplocationid"),_=p.find("#C_BPartnerDiv_"+a.windowNo).attr("data-bpid"),V=p.find("#C_BPartnerDiv_"+a.windowNo).attr("data-pricelistid"),A=p.find("#C_BPartnerDiv_"+a.windowNo).attr("data-paymethodid");me(B=jQuery.grep(i,function(e){return VIS.Utility.Util.getValueOfInt(e.C_BPartner_ID)===VIS.Utility.Util.getValueOfInt(_)&&VIS.Utility.Util.getValueOfInt(e.C_BPartner_Location_ID)===VIS.Utility.Util.getValueOfInt(v)&&VIS.Utility.Util.getValueOfInt(e.VA009_PaymentMethod_ID)===VIS.Utility.Util.getValueOfInt(A)&&VIS.Utility.Util.getValueOfInt(e.M_PriceList_ID)===VIS.Utility.Util.getValueOfInt(V)}));var f=t('<div><div class="vas-tis-subtotal" id="SubTotalSpan_'+a.windowNo+'">'+e.translatedTexts.VAS_SubTotal+": "+parseFloat(m).toLocaleString(window.navigator.language,{minimumFractionDigits:s,maximumFractionDigits:s})+"</div></div>");o.append(f),l.find(".vas-tis-arInvlistItem").on("click",function(){v=t(this).find(".vas-tis-arInvDetailsDesLoc").attr("data-bplocationid"),_=t(this).find(".vas-tis-arInvDetailsDesc").attr("data-bpid"),V=t(this).find(".vas-tis-arInvDetailsDesc").attr("data-pricelistid"),A=t(this).find(".vas-tis-arInvDetailsDesc").attr("data-paymethodid"),l.find(".vas-tis-arInvlistItem").removeClass("vas-tis-arInvActive"),t(this).addClass("vas-tis-arInvActive"),me(B=jQuery.grep(i,function(e){return VIS.Utility.Util.getValueOfInt(e.C_BPartner_ID)===VIS.Utility.Util.getValueOfInt(_)&&VIS.Utility.Util.getValueOfInt(e.C_BPartner_Location_ID)===VIS.Utility.Util.getValueOfInt(v)&&VIS.Utility.Util.getValueOfInt(e.VA009_PaymentMethod_ID)===VIS.Utility.Util.getValueOfInt(A)&&VIS.Utility.Util.getValueOfInt(e.M_PriceList_ID)===VIS.Utility.Util.getValueOfInt(V)})),o.find("#HeadBPTag_"+a.windowNo).text(VIS.Utility.decodeText(B[0].C_BPartner)),o.find("#SubTotalSpan_"+a.windowNo).text(e.translatedTexts.VAS_SubTotal+": "+parseFloat(m).toLocaleString(window.navigator.language,{minimumFractionDigits:s,maximumFractionDigits:s})),m=0}),m=0}(k):VIS.ADialog.info("VAS_PlzSelectRecord")}),null!=this.GenerateInvBtn&&this.GenerateInvBtn.on(VIS.Events.onTouchStartOrClick,function(){0!=G.length?0!=VIS.Utility.Util.getValueOfInt(a.cmbDocType.getValue())?function(i){if(0!=i.length)if(jQuery.grep(i,function(e){return 0===VIS.Utility.Util.getValueOfDecimal(e.Price)}).length>0)VIS.ADialog.info("",!1,e.translatedTexts.VAS_ZeroPriceFor);else{var n=VIS.Env.getCtx().getAD_Client_ID();a.setBusy(!0),t.ajax({url:VIS.Application.contextUrl+"VAS_TimeSheetInvoices/GenerateInvoice",type:"POST",data:{DataTobeInvoice:JSON.stringify(i),AD_Client_ID:VIS.Utility.Util.getValueOfInt(n),AD_Org_ID:VIS.Utility.Util.getValueOfInt(l),C_DocType_ID:VIS.Utility.Util.getValueOfInt(a.cmbDocType.getValue())},success:function(e){null!=e?(VIS.ADialog.info("",null,JSON.parse(e),null),ue(null),he(),fe(),De()):VIS.ADialog.info("VAS_InvoiceNotGenerated"),a.setBusy(!1)},error:function(e){VIS.ADialog.info("VAS_InvoiceNotGenerated"),a.setBusy(!1)}})}else VIS.ADialog.info("VAS_PlzSelectRecord")}(k):VIS.ADialog.info("VAS_PlzSelectDocType"):VIS.ADialog.info("VAS_PlzSelectRecord")}),null!=this.btnToggel)var c=0;this.btnToggel.on(VIS.Events.onTouchStartOrClick,function(){d?(c=VIS.Application.isRTL?180:0,a.btnToggel.animate({borderSpacing:c},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),d=!1,a.btnSpaceDiv.animate({width:ae},"slow"),a.recordDiv.animate({width:le},"slow"),a.gridSelectDiv.animate({width:le},"slow"),a.topDiv.find(".vas-RecordSelection").addClass("vas-tis-RecordArea"),U.css("display","block"),a.SearchBtn.css("display","block"),a.LeftsideDiv.animate({width:ae},"slow",null,function(){a.dGrid.resize()})):(c=VIS.Application.isRTL?0:180,a.btnToggel.animate({borderSpacing:c},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),d=!0,a.btnSpaceDiv.animate({width:ie},"slow"),a.LeftsideDiv.animate({width:ie},"slow"),a.topDiv.find(".vas-RecordSelection").removeClass("vas-tis-RecordArea"),U.css("display","none"),a.SearchBtn.css("display","none"),a.recordDiv.animate({width:se},"slow"),a.gridSelectDiv.animate({width:se},"slow",null,function(){a.dGrid.resize()}))})},this.sizeChanged=function(e,t){le=t-(ae+20),se=t-70,1==d?(a.btnSpaceDiv.animate({width:ie},"slow"),a.recordDiv.animate({width:se},"slow"),a.LeftsideDiv.animate({width:ie},"slow"),a.gridSelectDiv.animate({width:se},"slow",null,function(){a.dGrid.resize()})):(a.btnSpaceDiv.animate({width:ae},"slow"),a.gridSelectDiv.animate({width:le},"slow"),a.recordDiv.animate({width:le},"slow"),a.LeftsideDiv.animate({width:ae},"slow",null,function(){a.dGrid.resize()}))},this.display=function(){ue(null)},this.getRoot=function(){return this.$root},this.refreshUI=function(){this.dGrid.resize()},this.disposeComponent=function(){a=null,this.frame=null,this.windowNo=null,this.arrListColumns=null,this.dGrid=null,whereClause=null,l=null,C_BPartner_ID=null,toggle=null,toggleGen=null,d=null,this.lblOrg=null,this.lblBPartner=null,this.lblStatusInfo=null,this.tabSelect=null,this.tabGenrate=null,this.cmbOrg=null,this.vSearchBPartner=null,this.$root=null,this.$busyDiv=null,this.topDiv=null,this.sideDiv=null,this.gridSelectDiv=null,this.gridGenerateDiv=null,this.bottumDiv=null,this.okBtn=null,this.cancelBtn=null,this.btnRefresh=null,this.btnToggel=null,this.spnSelect=null,this.spnGenerate=null,re=null,oe=null,k=[],G=[],B=[],F=[],Q=[],$=[],W=[],J=[],j=[],m=0,f=null,D=null,h=null,C=null,S=null,I=null,y=null,O=null,ae=null,le=null,se=null,selectDivToggelWidth=null,sideDivHeight=null,this.getRoot=null,this.disposeComponent=null}}a.prototype.init=function(e,t){this.frame=t,this.windowNo=e,VIS.Env.getCtx().setContext(this.windowNo,"IsSOTrx","Y");try{this.Initialize()}catch(e){}this.frame.getContentGrid().append(this.getRoot()),this.display(),this.cmbOrg.getControl().focus()},a.prototype.refresh=function(){this.refreshUI()},a.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps=e.Apps||{},e.Apps.AForms=VIS.Apps.AForms||{},e.Apps.AForms.VAS_TimeSheetInvoice=a}(VAS,jQuery)},1109:()=>{VAS=window.VAS||{},function(e,t){e.VAS_ExpRevProfitWidget=function(){var e,a=0;this.frame,this.windowNo,this.widgetInfo;var i=this,n=null,l=null,s=t('<div class="h-100 w-100 vas-ExRePr-background">');this.initalize=function(){a=0!=VIS.Utility.Util.getValueOfInt(this.widgetInfo.AD_UserHomeWidgetID)?this.widgetInfo.AD_UserHomeWidgetID:i.windowNo,o(),(e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'))[0].style.visibility="visible",s.append(e),n=t('<div id="VAS-BarLine-ERP_'+a+'" class="vas-barline-ExRePr-container">');var r=t('<div class="d-flex justify-content-between vas-ExRePr-heading">'),c=t('<div class= "">'+VIS.Msg.getMsg("VAS_ExpRevProfitWid")+"</div>");$DifferentYearDataListDiv=t('<div class="input-group vis-input-wrap">'),$DifferentYearDataListLookUp=VIS.MLookupFactory.get(VIS.Env.getCtx(),a,0,VIS.DisplayType.List,"VAS_ExpRevProfitWidget",ColumnIds.AD_Reference_ID,!1,null),(l=new VIS.Controls.VComboBox("VAS_ExpRevProfitWidget",!0,!1,!0,$DifferentYearDataListLookUp,20)).setValue("01");var u=t('<div class="vis-control-wrap">');$DifferentYearDataListDiv.append(u),u.append(l.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")),$DifferentYearDataListDiv.append(u),r.append(c).append($DifferentYearDataListDiv),n.append(r),s.append(n),l.fireValueChanged=function(){l.setValue(l.getValue()),e[0].style.visibility="visible",n.find("#vas_norecordcont_"+a).remove(),i.getExpRevDetails()}},this.getExpRevDetails=function(){e[0].style.visibility="visible",VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetIncomeAndExpenseData",{ListValue:l.getValue()},function(i){var l=i;if(s.find("canvas").remove(),null!=l&&null!=l.ErrorMessage)n.append('<div class="vas-igwidg-notfounddiv" id="vas_norecordcont_'+a+'">'+VIS.Msg.getMsg("VAS_RecordNotFound")+"</div>"),s.append(n);else{let e=l.Precision;const i={type:"bar",data:{labels:l.lstLabel,datasets:[{label:VIS.Msg.getMsg("VAS_Expenses"),data:l.lstExpData,borderColor:"rgba(0,0,0,0)",borderWidth:0,backgroundColor:"rgb(204, 0, 0, 0.6)",order:1},{label:VIS.Msg.getMsg("VAS_Revenue"),data:l.lstRevData,borderColor:"rgba(0,0,0,0)",borderWidth:0,backgroundColor:"rgba(0, 102, 204, 0.6)",order:1},{label:VIS.Msg.getMsg("VAS_Profit"),data:l.lstProfitData,borderColor:"rgba(51, 102, 0, 0.5)",borderWidth:2,backgroundColor:"rgba(51, 102, 0, 0.5)",type:"line",tension:.4,fill:!1,order:2}]},options:{responsive:!0,layout:{padding:0},scales:{x:{grid:{display:!0}},y:{grid:{display:!1}},y1:{display:!1,beginAtZero:!1}},plugins:{title:{display:!0,text:" ",align:"start",padding:{top:0,bottom:0}},legend:{display:!0,position:"bottom",padding:{top:0,bottom:0}},tooltip:{callbacks:{label:function(t){const a=t.dataIndex,i=t.datasetIndex,n=t.chart.data.datasets[i],l=t.chart.data.labels,s=n.label,o=n.data[a];return s+" - "+l[a]+": "+o.toLocaleString(window.navigator.language,{minimumFractionDigits:e,maximumFractionDigits:e})}}},datalabels:{display:!1,color:"#000",anchor:"end",align:"end",formatter:function(e){return e},font:{weight:"bold"}}}},plugins:[{beforeInit:function(e){const t=e.legend.fit;e.legend.fit=function(){t.bind(e.legend)(),this.height+=-10}}}]},n=t('<canvas class="vas-barline-ExRePr-canvas"></canvas>');s.find("#VAS-BarLine-ERP_"+a).append(n);const o=n[0].getContext("2d");new Chart(o,i)}e[0].style.visibility="hidden"})};var o=function(){ColumnIds=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetColumnID",{refernceName:"VAS_ExpRevProfitWidget"},null)};this.getRoot=function(){return s},this.refreshWidget=function(){e[0].style.visibility="visible",n.find("#vas_norecordcont_"+a).remove(),i.getExpRevDetails()}},e.VAS_ExpRevProfitWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.getExpRevDetails()},50)},e.VAS_ExpRevProfitWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_ExpRevProfitWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_ExpRevProfitWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},1113:()=>{VAS=window.VAS||{},function(e,t){e.InvoiceLineTabPanel=function(){this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;this.ctx;$self=this;var a=0,i=null,n=t('<div class = "root h-100" style="position:relative;"></div>'),l=t("<div class ='vas-apInvWrapper h-100'></div>"),s=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>');function o(e){s[0].style.visibility=e?"visible":"hidden"}this.init=function(){!function(e){l.append('<div class="vas-apInvListGroup h-100"><div id="VAS-InvDetail_'+e+'" class= "VAS-InvDetail mb-2 h-100"></div></div>'),i=t('<iframe id="iframeinv'+e+'" src="" width="100%" height="100%" frameborder="0" scrolling="no">'),l.find("#VAS-InvDetail_"+e).append(i)}($self.windowNo),n.append(l).append(s)},this.getInvoiceLineData=function(e){o(!0),t.ajax({url:VIS.Application.contextUrl+"VAS/PoReceipt/GetInvoiceLineReport",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{InvoiceId:e,AD_WindowID:a},success:function(e){if(document.getElementById("iframeinv"+$self.windowNo).src="",""!=e){e=JSON.parse(e);if(console.log(e),""!=e&&e.length>0){var t=VIS.Application.contextFullUrl+""+e;document.getElementById("iframeinv"+$self.windowNo).src=t,o(!1)}}o(!1)},error:function(e){console.log(e),o(!1)}})},this.getRoot=function(){return n},e.InvoiceLineTabPanel.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,$self.windowNo=e,a=this.curTab.getAD_Window_ID(),this.init()},e.InvoiceLineTabPanel.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t;var a=t.c_invoice_id;this.getInvoiceLineData(a)},e.InvoiceLineTabPanel.prototype.sizeChanged=function(e){this.panelWidth=e},e.InvoiceLineTabPanel.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.panelWidth=null}}}(VAS,jQuery)},1186:()=>{VAS=window.VAS||{},function(e,t){e.VAS_DueFulfilmentWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[],r=0,c=[],u=0,d=1;function g(e){e<1&&(e=1),e>u&&(e=u);var t=6*((d=e)-1),a=Math.min(t+6,c.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s,r=c[i],g=o.includes(r.C_OrderLine_ID),p="I"!=r.ProductType||r.OnHandQty>0&&r.OnHandQty>=r.QtyOrdered,v=p?"VAS-delivery-box":"VAS-delivery-box no-stock";s="I"!=r.ProductType||r.OnHandQty>=r.QtyOrdered?"badge-green":r.OnHandQty<r.QtyOrdered&&r.OnHandQty>0?"badge-orange":"badge-red",n.find("#VAS_OrderLine_"+l).append('            <div class="'+v+'">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-orderlineid="'+r.C_OrderLine_ID+'"'+(g?" checked":"")+(p?"":" disabled")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+r.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count">                    <span title = "'+VIS.Msg.getMsg("VAS_RemianingQty")+'" class="badge badge-light '+s+'"> '+r.QtyEntered+'</span ></div >                       </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+r.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+r.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(c.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+d+VIS.Msg.getMsg("VAS_Of")+u+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}this.initalize=function(){const a='<div id="VAS_DeliveryContainer_'+(l=this.widgetInfo.AD_UserHomeWidgetID)+'" class="VAS-due-fulfilment-container">    <div class="VAS-orders-heading">        <h6>'+VIS.Msg.getMsg("VAS_DueFulfilments")+'</h6>    </div>    <div class="VAS-delivery-count">        <div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_Fulfilments")+' <span id="VAS_DeliveryCount_'+l+'">0</span></div>    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">        </div>    </div>    <div class="VAS-height-container">        <div id="VAS_DeliveryBox_'+l+'" class="VAS-deliveries-listing">        </div>        <div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing">        </div>    </div><div class="VAS-pagination-container"></div></div>';e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append(a)},this.intialLoad=function(p){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_DeliveryContainer_"+l).show(),t.ajax({url:VIS.Application.contextUrl+"Product/GetExpectedDelivery",data:{pageNo:p,pageSize:4,Type:"PD"},dataType:"json",success:function(v){v=JSON.parse(v);if(n.find("#VAS_DeliveryBox_"+l).empty(),n.find("#VAS_OrderContainer").remove,null!=v&&null!=v.Orders&&v.Orders.length>0){for(i=0;i<v.Orders.length;i++){var _='<div id="VAS_OrderContainer_'+l+'" class="VAS-delivery-box" >    <div class="VAS-box-heading">        <div class="VAS-icon-w-name">            <i class="fa fa-file-text" aria-hidden="true"></i>            <div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor"                 title="'+VIS.Msg.getMsg("Document_No")+'"                 data-doc-no="'+v.Orders[i].DocumentNo+'"                 data-customer-name="'+v.Orders[i].CustomerName+'"                 data-orderid="'+v.Orders[i].C_Order_ID+'">                '+v.Orders[i].DocumentNo+'            </div>        </div>        <div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+v.Orders[i].LineCount+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+v.Orders[i].CustomerName+'</div>    </div>    <div class="VAS-spaceBetween-col grid-2-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_DeliveryLocation")+'">'+v.Orders[i].DeliveryLocation+'</div>        <div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_ProductLocation")+'">'+v.Orders[i].ProductLocation+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+v.Orders[i].Symbol+"</span> "+v.Orders[i].GrandTotal.toLocaleString()+"</div>    </div></div>";n.find("#VAS_DeliveryBox_"+l).append(_)}s=[],v.Orders.forEach(function(e){e.OrderLines&&e.OrderLines.length>0&&(s[e.DocumentNo]=e.OrderLines)}),1==p&&(n.find("#VAS_DeliveryCount_"+l).text(v.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/4);var s=t('<div class="VAS-slider-arrows">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(v.RecordCount),r=v.AD_Window_ID),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){!function(i,p,v){n.find("#VAS_DeliveryContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var _='<div id="VAS_ProductContainer_'+l+'" class="VAS-due-fulfilment-container"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-orders-heading">        <h6>            <span id="VAS_BackTodelivery_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToFulfilment")+'        </h6><span id="VAS_GenerateDeliveryOrder_'+l+'" class="VAS-generate-delivery-btn" data-orderid="'+v+'" title="'+VIS.Msg.getMsg("VAS_GenerateDeliverOrder")+'"><i class="fa fa-truck" aria-hidden="true"></i></span>    </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text" aria-hidden="true"></i>                    <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>                <div class="VAS-expectedTxt" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+p+'</div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(_),c=s[i]||[],u=Math.ceil(c.length/6),d=1,c.length>0&&g(d);n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackTodelivery_"+l),n.off("click","#VAS_GenerateDeliveryOrder_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){g(d-1)}),n.on("click","#VAS_NextPage_"+l,function(){g(d+1)}),n.on("click","#VAS_BackTodelivery_"+l,function(){n.find("#VAS_DeliveryContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("orderlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateDeliveryOrder_"+l).show():n.find("#VAS_GenerateDeliveryOrder_"+l).hide()}),n.on("click","#VAS_GenerateDeliveryOrder_"+l,function(){!function(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateShipment",data:{C_Order_ID:i,C_OrderLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).Shipment_ID>0){if(a.currentPage=1,a.intialLoad(a.currentPage),r>0){var i=new VIS.Query;i.addRestriction("M_InOut_ID",VIS.Query.prototype.EQUAL,t.Shipment_ID),i.setRecordCount(1),VIS.viewManager.startWindow(r,i)}}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_DeliveryOrderNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})}(t(this).data("orderid"))}),n.find("#VAS_GenerateDeliveryOrder_"+l).hide()}(t(this).data("doc-no"),t(this).data("customer-name"),t(this).data("orderid"))})}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_DueFulfilmentWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_DueFulfilmentWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_DueFulfilmentWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_DueFulfilmentWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_DueFulfilmentWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_DueFulfilmentWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},1339:()=>{VAS=window.VAS||{},function(e,t){e.VAS_MonthlyAvBankBal=function(){var e,a=0;this.frame,this.windowNo,this.widgetInfo;var i=this,n=null,l=t('<div class="h-100 w-100 vas-monAvBbal-background">'),s=null,o=0,r=null;this.initalize=function(){a=0!=VIS.Utility.Util.getValueOfInt(this.widgetInfo.AD_UserHomeWidgetID)?this.widgetInfo.AD_UserHomeWidgetID:i.windowNo,(e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'))[0].style.visibility="visible",l.append(e),n=t('<div id="VAS-BarLine-MABB_'+a+'" class="vas-barline-monAvBbal-container">');var c=t('<div class="d-flex justify-content-between vas-monAvBbal-heading">'),u=t('<div class= "">'+VIS.Msg.getMsg("VAS_MonthlyAvBalWidget")+"</div>");s=t('<div class="vas-exinvd-BankAccountrDiv">');var d=t('<div class="input-group vis-input-wrap">');if(0!=VIS.Env.getCtx().getAD_Org_ID())var g="C_BankAccount.AD_Org_ID = @AD_Org_ID@ AND C_BankAccount.IsActive = 'Y'";else g="C_BankAccount.IsActive = 'Y'";var p=VIS.MLookupFactory.get(VIS.Env.getCtx(),i.windowNo,0,VIS.DisplayType.TableDir,"C_BankAccount_ID",0,!1,g);r=new VIS.Controls.VComboBox("C_BankAccount_ID",!1,!1,!0,p,50,VIS.DisplayType.TableDir);var v=t('<div class="vis-control-wrap">'),_=t('<div class="input-group-append">');d.append(v),v.append(r.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append('<label style="background: rgba(255, 236, 236)">'+VIS.Msg.getMsg("VAS_BankAccount")+"</label>"),d.append(v),_.append(r.getBtn(0)),d.append(_),s.append(d);var V=p.getData(!0,!0,!1,!1);null!=V&&null!=V&&V.length>0&&r.setValue(V[0].Key),o=VIS.Utility.Util.getValueOfInt(r.getValue()),c.append(u),n.append(c),n.append(s),l.append(n),r.fireValueChanged=function(){n.find("#vas_norecordcont_"+a).remove(),n.find("#vas_currencyrecord_"+a).remove(),o=VIS.Utility.Util.getValueOfInt(r.getValue()),e[0].style.visibility="visible",i.getMonthlyAvBankBalDetails()}},this.getMonthlyAvBankBalDetails=function(){e[0].style.visibility="visible",VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetMonthlyAvBankBalData",{C_BankAccount_ID:o},function(i){var s=i;if(l.find("canvas").remove(),null!=s&&null!=s.ErrorMessage)n.append('<div class="vas-igwidg-notfounddiv" id="vas_norecordcont_'+a+'">'+VIS.Msg.getMsg("VAS_RecordNotFound")+"</div>"),l.append(n);else{var o=s.stdPrecision,r=s.ISO_Code,c=t('<div id="vas_currencyrecord_'+a+'" class="vas-monAvbal-curr">'+VIS.Msg.getMsg("VAS_AmountIsIn")+" : "+r+"</div>");n.append(c);const e={type:"bar",data:{labels:s.labels,datasets:[{label:VIS.Msg.getMsg("VAS_Payments"),data:s.APPayAmt,borderColor:"rgba(0,0,0,0)",borderWidth:0,backgroundColor:"rgb(0, 132, 196)",order:1},{label:VIS.Msg.getMsg("VAS_Receipts"),data:s.ARPayAmt,borderColor:"rgba(0,0,0,0)",borderWidth:0,backgroundColor:"rgba(255,124,128)",order:1},{label:VIS.Msg.getMsg("VAS_Balances"),data:s.EndingBal,borderColor:"rgba(86,108,176)",borderWidth:2,backgroundColor:"rgba(86,108,176)",type:"line",tension:.4,fill:!1,order:2}]},options:{responsive:!0,layout:{padding:0},scales:{x:{grid:{display:!0}},y:{grid:{display:!1}},y1:{display:!1,beginAtZero:!1}},plugins:{title:{display:!0,text:" ",align:"start",padding:{top:0,bottom:0}},legend:{display:!0,position:"bottom",padding:{top:0,bottom:0}},tooltip:{callbacks:{label:function(e){const t=e.dataIndex,a=e.datasetIndex,i=e.chart.data.datasets[a],n=(e.chart.data.labels,i.label),l=i.data[t];return n+" - "+r+": "+l.toLocaleString(window.navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}},datalabels:{display:!1,color:"#000",anchor:"end",align:"end",formatter:function(e){return e},font:{weight:"bold"}}}},plugins:[{beforeInit:function(e){const t=e.legend.fit;e.legend.fit=function(){t.bind(e.legend)(),this.height+=-10}}}]},i=t('<canvas class="vas-barline-monAvBbal-canvas"></canvas>');l.find("#VAS-BarLine-MABB_"+a).append(i);const u=i[0].getContext("2d");new Chart(u,e)}e[0].style.visibility="hidden"})},this.getRoot=function(){return l},this.refreshWidget=function(){e[0].style.visibility="visible",n.find("#vas_norecordcont_"+a).remove(),n.find("#vas_currencyrecord_"+a).remove(),i.getMonthlyAvBankBalDetails()}},e.VAS_MonthlyAvBankBal.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.getMonthlyAvBankBalDetails()},50)},e.VAS_MonthlyAvBankBal.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_MonthlyAvBankBal.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_MonthlyAvBankBal.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},1528:()=>{VAS=window.VAS||{},function(e,t){e.VAS_OrderSummary=function(){this.windowNo,this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;this.ctx;var a=this,n=t('<div class="root"></div>'),l=null;this.init=function(){l=t('<div class ="vas-apTaxWrapper"><div id="VAS-TaxDetail_'+a.windowNo+'" class="VAS-summary-details mb-2"></div></div>'),n.append(l)},this.getOrderSummary=function(e){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetOrderSummary",{OrderId:e},function(e){if(l.find("#VAS-TaxDetail_"+a.windowNo).empty(),null!=e&&e.length>0){for(l.find("#VAS-TaxDetail_"+a.windowNo).append(t('<div class="VAS-summary-header"><span class="">'+VIS.Msg.getMsg("VAS_SubTotal")+":</span></div>")),l.find("#VAS-TaxDetail_"+a.windowNo).append(t('<div class="VAS-summary-info"><span class="VAS-summary-amount" style="font-weight: 600;">'+e[0].CurSymbol+" "+e[0].TotalLines.toLocaleString(window.navigator.language,{minimumFractionDigits:e[0].StdPrecision,maximumFractionDigits:e[0].StdPrecision})+"</span></div>")),i=0;i<e.length;i++)l.find(".VAS-summary-header").append('<span class="">'+VIS.Utility.encodeText(e[i].TaxName)+":</span>"),l.find(".VAS-summary-info").append('<span class="VAS-summary-amount">'+e[0].CurSymbol+" "+e[i].TaxAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:e[0].StdPrecision,maximumFractionDigits:e[0].StdPrecision})+"</span>");l.find(".VAS-summary-header").append('<span class="">'+VIS.Msg.getMsg("GrandTotal")+":</span>"),l.find(".VAS-summary-info").append('<span class="VAS-summary-amount" style="font-weight: 600;font-size: 1rem;border-top: 1px solid rgba(var(--v-c-on-secondary), 1);">'+e[0].CurSymbol+" "+e[0].GrandTotal.toLocaleString(window.navigator.language,{minimumFractionDigits:e[0].StdPrecision,maximumFractionDigits:e[0].StdPrecision})+"</span>")}})},this.getRoot=function(){return n},e.VAS_OrderSummary.prototype.startPanel=function(e,t){a.windowNo=e,a.curTab=t,a.init()},e.VAS_OrderSummary.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.getOrderSummary(e)},e.VAS_OrderSummary.prototype.sizeChanged=function(e){this.panelWidth=e},e.VAS_OrderSummary.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null}}}(VAS,jQuery)},1560:()=>{VIS=window.VIS||{},function(e,t){function a(){this.windowNo=e.Env.getWindowNo();var a=t("<div style='width: 100%; height: 100%; background-color: white;'>"),i=this,n=null,l=null,s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=null,_=null,V=null,A=null,m=e.Application.contextUrl+"JsonData/JDataSetWithCode";function f(e){A[0].style.visibility=e?"visible":"hidden"}function D(a){var i=null;i=a?0:l.val(),f(!0),t.ajax({url:e.Application.contextUrl+"VPayPrint/GetDetail",async:!1,datatype:"Json",type:"GET",cache:!1,data:{showPrintedPayment:g.prop("checked"),C_PaymentSelect_ID:i,isFirstTime:a},success:function(a){var i=JSON.parse(a);controlsData=i,null==i&&null==i||(!function(a){try{var i=l.val(),n=0;if(null!=a.PaymentSelection||a.PaymentSelection.length>0)for(var g in l.empty(),a.PaymentSelection)l.append(t('<Option value="'+a.PaymentSelection[g].ID+'">'+a.PaymentSelection[g].Value+"</option>"));if(i>0){l.val(i);var p="VIS_135",v=[];v[0]=new e.DB.SqlParam("@pSelectID",i),n=e.Utility.Util.getValueOfInt(I(p,v))}if(null!=a.PaymentMethod||a.PaymentMethod.length>0)for(var g in r.empty(),a.PaymentMethod)r.append(t('<Option value="'+a.PaymentMethod[g].ID+'">'+a.PaymentMethod[g].Value+"</option>"));n>0&&r.val(n),(null!=a.PSelectInfo||a.PSelectInfo.length>0)&&(s.val(a.PSelectInfo[0].BankAccount),u.val(a.PSelectInfo[0].CheckNo),o.val(parseFloat(a.PSelectInfo[0].CurrentBalance).toLocaleString()),c.val(a.PSelectInfo[0].Currency),d.val(a.PSelectInfo[0].NoOfPayments),V=a.PSelectInfo[0].BankAccount_ID)}catch(t){return e.ADialog.info("VPayPrintNoRecords"),f(!1),!1}if(null==l.val())e.ADialog.info("VPayPrintNoRecords")}(i),h(),f(!1))},error:function(e){f(!1),console.log(e)}})}function h(){t.ajax({url:e.Application.contextUrl+"VPayPrint/LoadPaymentRuleInfo",async:!1,datatype:"Json",type:"GET",cache:!1,data:{paymentMethod_ID:r.val(),C_PaySelection_ID:l.val(),m_C_BankAccount_ID:V,PaymentRule:r.text()},success:function(e){var t=JSON.parse(e);f(!1),null==t&&null==t||(u.val(t.CheckNo),d.val(t.NoOfPayments))},error:function(e){console.log(e)}})}function C(){try{if(null==l||l.val()<=-1||V<=-1||r.val()<=-1||u.val().length<=0)return e.ADialog.info("VPayPrintNoRecords"),!1}catch(t){return e.ADialog.info("VPayPrintNoRecords"),!1}return!0}function S(a){var n=JSON.parse(a);t.ajax({url:e.Application.contextUrl+"VPayPrint/VPayPrintRemittance",async:!1,datatype:"Json",type:"POST",contentType:"application/json; charset=utf-8",data:a,success:function(t){f(!1);var a=JSON.parse(t);if(null!=n||null!=n){var s=parseInt(a);sql="VIS_150";var o=I(sql);new e.APrint(s,o,parseInt(l.val()),i.windowNo).startPdf(null),i.dispose()}else e.ADialog.info("PaymentNotProcessed")},error:function(e){console.log(e)}})}this.initialize=function(){!function(){n=t("<div class='vis-mainContainer vis-formouterwrpdiv'>");var m=" <div class='vis-pPrintInfo'> <div class='vis-paymentselect-field' style='margin-top: 8px;'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <div class='vis-paymentPrintChk-field'> <input type='checkbox' id='VIS_chkShowPrintPayment_"+i.windowNo+"' data-placeholder='' placeholder=' '> <label for='VIS_chkOnlyDue_"+i.windowNo+"'>"+e.Msg.getMsg("ShowPrintedPayments")+" </label> </div> <select id='VIS_PaySelection_"+i.windowNo+"'></select> <label style='top: 11px;'>"+e.Msg.translate(e.Env.getCtx(),"C_PaySelection_ID")+" </label></div></div> </div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' name='vis-name vis-fieldreadonly' class='vis-fieldreadonly' disabled id='VIS_txtBankAccount_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+e.Msg.translate(e.Env.getCtx(),"C_BankAccount_ID")+" </label> </div></div></div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtCurrentBal_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+e.Msg.getMsg("CurrentBalance")+" </label> </div></div></div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <select name='vis-name' id='VIS_cmbPaymentMethod_"+i.windowNo+"'></select> <label>"+e.Msg.translate(e.Env.getCtx(),"PaymentRule")+" </label> </div></div></div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtCurrency_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+e.Msg.translate(e.Env.getCtx(),"C_Currency_ID")+" </label> </div></div></div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='number' name='vis-name'  id='VIS_txtCheckNo_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+e.Msg.getMsg("CheckNo")+" </label> </div></div></div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtNoOfPayments_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+e.Msg.getMsg("NoOfPayments")+" </label> </div></div></div> </div>",y=" <div class='vis-pPrintProcess'> <div class='vis-paymentPrint-field'> <input id='VIS_btnCancel_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+e.Msg.getMsg("Cancel")+"' > <input id='VIS_btnPrint_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+e.Msg.getMsg("Print")+"' ></input> </div> </div>";n.append(t(m)).append(t(y)),a.append(n),(A=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="hidden",a.append(A),l=t("#VIS_PaySelection_"+i.windowNo),s=t("#VIS_txtBankAccount_"+i.windowNo),o=t("#VIS_txtCurrentBal_"+i.windowNo),r=t("#VIS_cmbPaymentMethod_"+i.windowNo),c=t("#VIS_txtCurrency_"+i.windowNo),u=t("#VIS_txtCheckNo_"+i.windowNo),d=t("#VIS_txtNoOfPayments_"+i.windowNo),(g=t("#VIS_chkShowPrintPayment_"+i.windowNo)).attr("disabled",!0),p=t("#VIS_btnPrint_"+i.windowNo),v=t("#VIS_btnExport_"+i.windowNo),_=t("#VIS_btnCancel_"+i.windowNo),D(!0),p.on("click",function(){C()&&(f(!0),t.ajax({url:e.Application.contextUrl+"VPayPrint/Cmd_Print",async:!1,datatype:"Json",type:"GET",cache:!1,data:{paymentMethod_ID:r.val(),C_PaySelection_ID:l.val(),m_C_BankAccount_ID:V,PaymentRule:r.text(),checkNo:u.val()},success:function(a){f(!1);var n=JSON.parse(a);if(null==n&&null==n)return e.ADialog.info("VPayPrintNoRecords"),!1;e.ADialog.confirm("ContinueCheckPrint?",!0,"","Confirm",function(a){a?(f(!0),window.setTimeout(function(){!function(a){a.check_ID[0];var n=[];n.push(r.val()),n.push(l.val()),n.push(V),n.push(r.text()),n.push(u.val()),n.push(JSON.stringify(a.check_ID)),n.push(JSON.stringify(a.m_batch)),n.push(JSON.stringify(a.m_checks)),t.ajax({url:e.Application.contextUrl+"VPayPrint/ContinueCheckPrint",async:!1,datatype:"Json",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(n),success:function(a){var n="VIS_152",s=[];s[0]=new e.DB.SqlParam("@BankAcct_ID",V);var o=I(n,s),r=I(n="VIS_150");new e.APrint(o,r,parseInt(l.val()),i.windowNo).startPdf(null),f(!1);var c,u,d=JSON.parse(a);if(null!=d||null!=d){var g=d.join(),p=(c=g,u=null,t.ajax({url:e.Application.contextUrl+"VPayPrint/GetDocumentNo",async:!1,datatype:"Json",type:"GET",contentType:"application/json; charset=utf-8",data:{paymentId:c},success:function(e){u=null!=(u=JSON.parse(e))?u.join():u},error:function(e){console.log(e)}}),u);p=null!=p?e.Msg.getMsg("VIS_PaymentCreated")+p:p,e.ADialog.confirm("VPayPrintPrintRemittance?",!0,p,"Confirm",function(e){e?(f(!0),window.setTimeout(function(){S(a)},20)):i.dispose()})}},error:function(e){f(!1),console.log(e)}})}(n)},20)):i.dispose()})},error:function(e){console.log(e)}}))}),v.on("click",function(){C()&&(f(!0),t.ajax({url:e.Application.contextUrl+"VPayPrint/Cmd_Export",async:!1,datatype:"Json",type:"POST",cache:!1,data:{paymentMethod_ID:r.val(),C_PaySelection_ID:l.val(),m_C_BankAccount_ID:V,PaymentRule:r.text(),checkNo:u.val()},success:function(a){f(!1);var i=JSON.parse(a);if(null==i&&null==i)return e.ADialog.info("VPayPrintNoRecords"),!1;e.ADialog.confirm("VPayPrintSuccess?",!0,"","Confirm",function(a){if(a){f(!0),window.setTimeout(function(){!function(a){var i=[];i.push(JSON.stringify(a.check_ID)),i.push(JSON.stringify(a.m_batch)),i.push(JSON.stringify(a.m_checks)),t.ajax({url:e.Application.contextUrl+"VPayPrint/VPayPrintSuccess",async:!1,datatype:"Json",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(i),success:function(e){f(!1),JSON.parse(e)},error:function(e){console.log(e)}})}(i)},20);var n=e.Application.contextUrl+"TempDownload/"+i.filepath;window.open(n,"_blank")}})},error:function(e){console.log(e)}}))}),_.on("click",function(){i.dispose()}),l.on("change",function(){f(!0),window.setTimeout(function(){D(!1),f(!1)},20)}),r.on("change",function(){f(!0),window.setTimeout(function(){h(),f(!1)},20)}),g.on("click",function(){f(!0),window.setTimeout(function(){D(!1),f(!1)},20)})}()},this.getRoot=function(){return a};var I=function(a,i,n){var l=!!n,s={sql:a,page:1,pageSize:0},o=null;return i&&(s.param=i),function(e,a,i){var n=null;t.ajax({url:m,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:a,data:JSON.stringify(e)}).done(function(e){n=e,i&&i(e)})}(s,l,function(t){a=(new e.DB.DataSet).toJson(t);var a=(new e.DB.DataSet).toJson(t);o=a.getTable(0).getRows().length>0?a.getTable(0).getRow(0).getCell(0):null,a.dispose(),a=null,l&&n(o)}),o};this.lockUI=function(e){},this.unlockUI=function(e){},this.disposeComponent=function(){windowNo=null,a=null,i=this}}e.Apps.AForms=e.Apps.AForms||{},a.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.frame.getContentGrid().append(this.getRoot()),this.initialize()},a.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.VPayPrint=a}(VIS,jQuery)},1637:()=>{VAS=window.VAS||{},function(e,t){e.PurchaseOrderTabPanel=function(){this.windowNo,this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var a=this.ctx,n=this,l=null;e.translatedTexts=VIS.Msg.translate(a,["VAS_OrderTitleTabPanel","VAS_OrderTax","VAS_DocumentNo","VAS_OrderTaxPaybaleAmt","VAS_OrderTaxAmt","VAS_IsIncludeTax"],!0);var s=t('<div class = "root"></div>'),o=t("<div class ='vas-apTaxWrapper'></div>");l=t("<h6 class='vas-apTax-ttl'>"+e.translatedTexts.VAS_OrderTitleTabPanel+"</h6>"),this.init=function(){o.append(l),o.append('<div class="vas-aptaxListGroup"><div id="VAS-TaxDetail_'+n.windowNo+'" class= "VAS-TaxDetail mb-2" > </div></div>'),s.append(o)},this.getOrderTaxData=function(a){t.ajax({url:VIS.Application.contextUrl+"VAS/PoReceipt/GetPurchaseOrderTaxData",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{OrderId:a},complete:function(){s.closest(".vis-ad-w-p-actionpanel-b").length>0&&s.closest(".vis-ad-w-p-ap-tp-outerwrap").css("height","100%")},success:function(t){if(o.find("#VAS-TaxDetail_"+n.windowNo).empty(),null!=(t=JSON.parse(t))&&t.length>0)for(i=0;i<t.length;i++){var a='<div class="vas-apListItem mb-2"><div class="vas-ap-sglItem mb-2"><div class="vas-singleTaxElement vas-setTaxWidth1"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_DocumentNo+'</span><span class="vas-singleTaxElementValue">'+t[i].DocumentNo+'</span></div><div class="vas-singleTaxElement vas-setTaxWidth1"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_OrderTax+'</span><span class="vas-singleTaxElementValue">'+t[i].TaxName+'</span></div><div class="vas-singleTaxElement vas-setTaxAmtWidth1"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_OrderTaxAmt+'</span><span class="vas-singleTaxElementValue">'+t[i].TaxAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:t[i].stdPrecision,maximumFractionDigits:t[i].stdPrecision})+'</span></div><div class="vas-singleTaxElement vas-setTaxPaybleAmtWidth1"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_OrderTaxPaybaleAmt+'</span><span class="vas-singleTaxElementValue">'+t[i].TaxPaybleAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:t[i].stdPrecision,maximumFractionDigits:t[i].stdPrecision})+'</span></div><div class="vas-apItem-checkbox d-flex align-items-center vas-setTaxWidthCheckbox "><input type="checkbox" id="vas-includeTaxCheckbox" '+("Y"==t[i].IsTaxIncluded?"checked":"")+' disabled><label class="vas-apcheckbox-label ml-1" for="vas-includeTaxCheckbox">'+e.translatedTexts.VAS_IsIncludeTax+"</label></div></div ></div>";o.find("#VAS-TaxDetail_"+n.windowNo).append(a)}},error:function(e){console.log(e)}})},this.getRoot=function(){return s},e.PurchaseOrderTabPanel.prototype.startPanel=function(e,t){n.windowNo=e,n.curTab=t,n.init()},e.PurchaseOrderTabPanel.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.getOrderTaxData(e)},e.PurchaseOrderTabPanel.prototype.sizeChanged=function(e){this.panelWidth=e},e.PurchaseOrderTabPanel.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,l=null}}}(VAS,jQuery)},1682:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util,i=0;function n(){e.CalloutEngine.call(this,"VIS.CalloutInvoice")}function l(){e.CalloutEngine.call(this,"VIS.ProvisionalInvoice")}e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.DocType=function(i,n,l,s,o,r){if(null==o||""==o.toString())return"";if(null==o||0==o)return"";var c=o.toString(),u=e.dataContext.getJSONRecord("MDocType/GetDocTypeData",c);try{if(null!=u){i.setContext(n,"HasCharges",a.getValueOfString(u.HasCharges)),"Y"==u.IsDocNoControlled&&l.setValue("DocumentNo","<"+a.getValueOfString(u.CurrentNext)+">");var d=a.getValueOfString(u.DocBaseType);i.setContext(n,"DocBaseType",d),d.startsWith("AP")?l.setValue("PaymentRule","S"):d.endsWith("C")&&l.setValue("PaymentRule","P"),null!=l.getField("TreatAsDiscount")&&(d.equals("APC")?l.setValue("TreatAsDiscount",a.getValueOfBoolean(u.TreatAsDiscount)):l.setValue("TreatAsDiscount",!1)),null!=l.getField("IsReturnTrx")&&l.setValue("IsReturnTrx",a.getValueOfBoolean(u.IsReturnTrx))}}catch(e){return this.setCalloutActive(!1),null!=u&&u.close(),this.log.log(t.SEVERE,sql,e),e.message}return i=n=l=o=null,""},n.prototype.BPartner=function(i,n,l,s,o,r){if(null==o||""==o.toString())return"";try{var c=a.getValueOfInt(o);if(null==c||0==c)return"";var u="N",d="N",g=!1,p=e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_");null!=p&&(g=p.VA009_);var v=g.toString()+","+c.toString(),_=i.isSOTrx(n),V=null;try{if(null!=(V=e.dataContext.getJSONRecord("MBPartner/GetBPartnerData",v))){var A=a.getValueOfInt(V[_?"M_PriceList_ID":"PO_PriceList_ID"]);A>0&&l.setValue("M_PriceList_ID",A);var m=a.getValueOfInt(V[_?"C_IncoTerm_ID":"C_IncoTermPO_ID"]);m>0&&l.setValue("C_IncoTerm_ID",m);var f=a.getValueOfString(V[_?"PaymentRule":"PaymentRulePO"]);if(null!=f&&0!=f.length&&((i.getContext("DocBaseType").toString().endsWith("C")||_&&(f.toString().equals("S")||f.toString().equals("U")))&&(f="P"),l.setValue("PaymentRule",f)),e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_").VA009_){var D=a.getValueOfInt(V.VA009_PaymentMethod_ID),h=a.getValueOfString(V.VA009_PaymentBaseType),C=(u="N",e.dataContext.getJSONRecord("MBPartner/GetBPDetails",c));null!=C&&(u=a.getValueOfString(C.IsVendor),d=a.getValueOfString(C.IsCustomer),_?"Y"==u?(D=0,h=null,"Y"==d&&(D=a.getValueOfInt(C.VA009_PaymentMethod_ID),h=a.getValueOfString(C.VA009_PAYMENTBASETYPE))):"Y"==d&&(D=a.getValueOfInt(C.VA009_PaymentMethod_ID),h=a.getValueOfString(C.VA009_PAYMENTBASETYPE)):"Y"==u?(D=a.getValueOfInt(C.VA009_PO_PaymentMethod_ID),h=a.getValueOfString(C.VA009_PAYMENTBASETYPEPO)):(D=0,h=null)),0==D?l.setValue("VA009_PaymentMethod_ID",null):(l.setValue("VA009_PaymentMethod_ID",D),null!=h?(l.setValue("PaymentMethod",h),l.setValue("PaymentRule",h)):(l.setValue("PaymentMethod","T"),l.setValue("PaymentRule","T")))}var S=a.getValueOfInt(l.getValue("C_PaymentTerm_ID")),I=a.getValueOfDecimal(l.getValue("C_Order_Blanket"));S>0&&I>0||(A=a.getValueOfInt(V[_?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"]))>0&&l.setValue("C_PaymentTerm_ID",A);var y=a.getValueOfInt(V.C_BPartner_Location_ID);if(c.toString().equals(i.getWindowTabContext(n,e.EnvConstants.TAB_INFO,"C_BPARTNER_ID").toString())){var O=i.getWindowTabContext(n,e.EnvConstants.TAB_INFO,"C_BPARTNER_LOCATION_ID");O&&O.toString().length>0&&(y=parseInt(O))}0==y?l.setValue("C_BPartner_Location_ID",null):l.setValue("C_BPartner_Location_ID",y);var T=a.getValueOfInt(V.AD_User_ID);if(c.toString().equals(i.getWindowTabContext(n,e.EnvConstants.TAB_INFO,"C_BPARTNER_ID").toString())){var w=i.getWindowTabContext(n,e.EnvConstants.TAB_INFO,"AD_USER_ID");w&&w.toString().length>0&&(T=parseInt(w))}if(0==T?l.setValue("AD_User_ID",null):l.setValue("AD_User_ID",T),_){var P=V.CreditStatusSettingOn;if("CH"==P){if(0!=a.getValueOfDouble(V.SO_CreditLimit)){var b=a.getValueOfDouble(V.CreditAvailable);null!=V&&b<=0&&e.ADialog.info("CreditOver")}}else{var M=a.getValueOfInt(l.getValue("C_BPartner_Location_ID"));dr1=e.dataContext.getJSONRecord("MBPartner/GetLocationData",M.toString())}}null!=(f=a.getValueOfString(V.POReference))&&0!=f.length?l.setValue("POReference",f):l.setValue("POReference",null),null!=(f=a.getValueOfString(V.SO_Description))&&0!=f.toString().trim().length&&l.setValue("Description",f),null!=(f=a.getValueOfString(V.IsDiscountPrinted))&&0!=f.toString().trim().length?l.setValue("IsDiscountPrinted",f):l.setValue("IsDiscountPrinted","N"),V.hasOwnProperty("VA106_SupplyType")&&l.setValue("VA106_SupplyType",V.VA106_SupplyType)}}catch(e){return this.setCalloutActive(!1),this.log.log(t.SEVERE,"bPartner",e),e.message}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),i=n=l=o=null,""},n.prototype.PaymentTerm=function(t,a,i,n,l,s){if(null==l||""==l.toString())return"";try{var o,r=l,c=t.getContextAsInt(a,"C_Invoice_ID",!1);if(null==r||0==r||0==c)return"";var u=r.toString().concat(",",c.toString()),d=e.dataContext.getJSONRecord("MPaymentTerm/GetPaymentTerm",u);if(null!=d){o=d.Get_ID;var g=d.Apply;if(0==o)return"PaymentTerm not found";i.setValue("IsPayScheduleValid",!!g)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return t=a=i=l=null,""},n.prototype.Product=function(t,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString())return l.setValue("VA038_AmortizationTemplate_ID",0),"";var c=o;if(null==c||0==c)return"";this.setCalloutActive(!0);try{l.setValue("C_Charge_ID",null),l.setValue("M_AttributeSetInstance_ID",null);var u=l.getValue("QtyInvoiced"),d=t.getContextAsInt(n,"M_AttributeSetInstance_ID"),g=l.getValue("C_Invoice_ID").toString().concat(",",c.toString(),",",d.toString(),",",u.toString()),p=e.dataContext.getJSONRecord("MInvoice/GetInvoiceProductInfo",g);i=a.getValueOfInt(p.countEd011);var v=p.IsSOTrx,_=0;i>0&&((_=a.getValueOfInt(p.purchasingUom)>0&&!v?a.getValueOfInt(p.purchasingUom):a.getValueOfInt(p.VAS_PurchaseUOM_ID))>0&&0==v?l.setValue("C_UOM_ID",_):a.getValueOfInt(p.VAS_SalesUOM_ID)>0&&v?l.setValue("C_UOM_ID",a.getValueOfInt(p.VAS_SalesUOM_ID)):l.setValue("C_UOM_ID",a.getValueOfInt(p.headerUom))),l.findColumn("C_RevenueRecognition_ID")>-1&&l.setValue("C_RevenueRecognition_ID",a.getValueOfInt(p.C_RevenueRecognition_ID)),v&&l.findColumn("VA106_TaxCollectedAtSource_ID")>-1&&p.hasOwnProperty("VA106_TaxCollectedAtSource_ID")&&l.setValue("VA106_TaxCollectedAtSource_ID",a.getValueOfInt(p.VA106_TaxCollectedAtSource_ID)),l.findColumn("VAS_HSN_SACCode")>-1&&p.hasOwnProperty("VAS_HSN_SACCode")&&l.setValue("VAS_HSN_SACCode",a.getValueOfString(p.VAS_HSN_SACCode)),l.setValue("PriceList",a.getValueOfDecimal(p.PriceList)),l.setValue("PriceLimit",a.getValueOfDecimal(p.PriceLimit)),l.setValue("PriceActual",a.getValueOfDecimal(p.PriceActual)),l.setValue("PriceEntered",a.getValueOfDecimal(p.PriceEntered)),l.setValue("C_Currency_ID",a.getValueOfInt(p.C_Currency_ID)),l.setValue("PrintDescription",a.getValueOfString(p.DocumentNote)),i>0&&_>0&&0==v&&l.setValue("QtyInvoiced",a.getValueOfDecimal(p.QtyInvoiced)),t.setContext(n,"EnforcePriceLimit",a.getValueOfString(p.EnforcePriceLimit)?"Y":"N"),t.setContext(n,"DiscountSchema",a.getValueOfString(p.DiscountSchema)?"Y":"N")}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),this.Tax(t,n,l,s,o)},n.prototype.Charge=function(t,i,n,l,s,o){if(null==s||""==s.toString())return n.setValue("VA038_AmortizationTemplate_ID",0),"";var r=null;try{var c=s;if(null==c||0==c)return"";if(null!=n.getValue("M_Product_ID"))return n.setValue("C_Charge_ID",null),"ChargeExclusively";n.setValue("M_AttributeSetInstance_ID",null),n.setValue("S_ResourceAssignment_ID",null);var u=t.getContextAsInt("#C_UOM_ID");u>0?n.setValue("C_UOM_ID",u):n.setValue("C_UOM_ID",100),t.setContext(i,"DiscountSchema","N");var d=e.dataContext.getJSONRecord("MInvoice/GetPercision",n.getValue("C_Invoice_ID").toString());null!=(r=e.dataContext.getJSONRecord("MCharge/GetChargeDetails",c.toString()))&&(n.setValue("PriceEntered",a.getValueOfDecimal(r.ChargeAmt).toFixed(d)),n.setValue("PrintDescription",a.getValueOfString(r.PrintDescription)),n.setValue("PriceActual",a.getValueOfDecimal(r.ChargeAmt).toFixed(d)),n.setValue("PriceLimit",0),n.setValue("PriceList",0),n.setValue("Discount",0)),n.setValue("PriceLimit",e.Env.ZERO),n.setValue("PriceList",e.Env.ZERO),n.setValue("Discount",e.Env.ZERO)}catch(e){return this.setCalloutActive(!1),e.message}return this.Tax(t,i,n,l,s)},n.prototype.Tax=function(t,i,n,l,s,o){if(null==s||""==s.toString())return"";if(0==a.getValueOfInt(n.getValue("C_Charge_ID"))&&0==a.getValueOfInt(n.getValue("M_Product_ID")))return"";var r=l.getColumnName();try{var c="",u=a.getValueOfString(n.getValue("C_Invoice_ID")).concat(",",a.getValueOfString(n.getValue("M_Product_ID"))+","+a.getValueOfString(n.getValue("C_Charge_ID"))),d=e.dataContext.getJSONRecord("MInvoice/GetTax",u),g=a.getValueOfInt(d._CountVATAX);t.getWindowContext(i,"IsSOTrx",!0);if(g>0&&(c=a.getValueOfString(d.taxRule)),"T"==c){var p=a.getValueOfInt(d.taxId);if(p>0)n.setValue("C_Tax_ID",p);else{if(a.getValueOfInt(n.getValue("M_Product_ID"))>0)return n.setValue("M_Product_ID",""),this.setCalloutActive(!1),"Y"==d.TaxExempt?e.ADialog.info("TaxNoExemptFound"):e.ADialog.info("VATAX_DefineTax");if(a.getValueOfInt(n.getValue("C_Charge_ID"))>0)return n.setValue("C_Charge_ID",""),this.setCalloutActive(!1),"Y"==d.TaxExempt?e.ADialog.info("TaxNoExemptFound"):e.ADialog.info("VATAX_DefineChargeTax")}}else{var v=0;v="M_Product_ID"==r.toString()?s:t.getContextAsInt(i,"M_Product_ID");var _=0;if(_="C_Charge_ID"==r.toString()?s:t.getContextAsInt(i,"C_Charge_ID"),this.log.fine("Product="+v+", C_Charge_ID="+_),0==v&&0==_)return this.Amt(t,i,n,l,s);var V=t.getContextAsInt(i,"C_BPartner_Location_ID");if(0==V)return this.Amt(t,i,n,l,s);this.log.fine("Ship BP_Location="+V);var A=V;this.log.fine("Bill BP_Location="+A);var m=t.getContext("DateInvoiced");this.log.fine("Bill Date="+m);var f=m;this.log.fine("Ship Date="+f);var D=t.getContextAsInt(i,"AD_Org_ID");this.log.fine("Org="+D);var h=t.getContextAsInt("#M_Warehouse_ID");this.log.fine("Warehouse="+h);var C=_.toString().concat(",",m.toString(),f.toString(),",",D.toString(),",",h.toString(),",",A.toString(),",",V.toString(),",",t.getWindowContext(i,"IsSOTrx",!0).equals("Y")),S=a.getValueOfInt(e.dataContext.getJSONRecord("MTax/Get",C));this.log.info("Tax ID="+S),0==S||n.setValue("C_Tax_ID",S)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.Amt(t,i,n,l,s)},n.prototype.Amt=function(i,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString())return"";if(0==a.getValueOfInt(l.getValue("C_Charge_ID"))&&0==a.getValueOfInt(l.getValue("M_Product_ID")))return"";this.setCalloutActive(!0);try{this.log.log(t.WARNING,"amt - init");var c=i.getContextAsInt(n,"C_UOM_ID"),u=i.getContextAsInt(n,"M_Product_ID"),d=i.getContextAsInt(n,"M_PriceList_ID"),g="Y"==i.getWindowContext(n,"IsSOTrx",!0),p=d.toString();E=e.dataContext.getJSONRecord("MPriceList/GetPriceList",p);var v,_,V,A,m,f,D,h,C=2,S=2,I="Y",y="N";null!=E&&(S=E.StdPrecision,C=E.PriceListPrecision,I=a.getValueOfString(E.EnforcePriceLimit),y=a.getValueOfString(E.IsTaxIncluded));var O=a.getValueOfInt(l.getValue("C_OrderLine_ID"));if(DiscountApplied=a.getValueOfBoolean(l.getValue("VAS_IsDiscountApplied")),v=l.getValue("QtyEntered"),_=l.getValue("QtyInvoiced"),this.log.fine("QtyEntered="+v+", Invoiced="+_+", UOM="+c),V=l.getValue("PriceEntered"),A=l.getValue("PriceActual"),m=l.getValue("PriceLimit"),D=l.getValue("PriceList"),this.log.fine("PriceList="+D+", Limit="+m+", Precision="+C),this.log.fine("PriceEntered="+V+", Actual="+A),s.getColumnName(),"QtyInvoiced"!=s.getColumnName()&&"QtyEntered"!=s.getColumnName()&&"M_Product_ID"!=s.getColumnName()||0!=i.getContext("DiscountSchema"))"PriceActual"==s.getColumnName()?(V=A=a.getValueOfDecimal(o.toFixed(C)),this.log.fine("amt - PriceActual="+A+" -> PriceEntered="+V),l.setValue("PriceEntered",V),l.SetValue("PriceActual",A)):"PriceEntered"==s.getColumnName()&&(null==(A=V=a.getValueOfDecimal(o.toFixed(C)))&&(A=V),this.log.fine("amt - PriceEntered="+V+"-> PriceActual="+A),l.setValue("PriceActual",A),l.setValue("PriceEntered",V));else{var T=i.getContextAsInt(n,"C_BPartner_ID");if(null==_&&(_=v),0==O){U=u.toString().concat(",",l.getValue("C_Invoice_ID").toString()+","+a.getValueOfString(l.getValue("M_AttributeSetInstance_ID"))+","+c.toString()+","+i.getAD_Client_ID().toString()+","+T.toString()+","+v.toString());var w=e.dataContext.getJSONRecord("MInvoice/GetPrices",U),P="N";null!=w&&(("M_Product_ID"==s.getColumnName()||0!=a.getValueOfDecimal(w.PriceList)&&0==l.getValue("PriceList"))&&(D=w.PriceList,l.setValue("PriceList",D)),V=w.PriceEntered,h=a.getValueOfString(w.DiscountSchema),P=a.getValueOfString(w.IsDiscountApplied),("M_Product_ID"==s.getColumnName()||0!=a.getValueOfDecimal(w.PriceLimit)&&0==l.getValue("PriceLimit"))&&l.setValue("PriceLimit",w.PriceLimit)),this.log.fine("amt - QtyChanged -> PriceActual="+V+", PriceEntered="+V),A=V,("M_Product_ID"==s.getColumnName()||(P.equals("Y")||DiscountApplied)&&0!=V||0!=V&&0==l.getValue("PriceEntered"))&&(l.setValue("VAS_IsDiscountApplied",P.equals("Y")),l.setValue("PriceActual",A),l.setValue("PriceEntered",V))}i.setContext(n,"DiscountSchema",h?"Y":"N")}var b,M=g&&null!=I&&"Y"==I;b=e.MRole.getDefault().getIsOverwritePriceLimit(),M&&b&&(M=!1),M&&0!=a.getValueOfDouble(m)&&A.compareTo(m)<0&&(null==(V=A=m)&&(V=m),this.log.fine("amt =(under) PriceEntered="+V+", Actual"+m),l.setValue("PriceActual",m),l.setValue("PriceEntered",V),e.ADialog.info("UnderLimitPrice"),0!=a.getValueOfInt(D)&&(f=(D-A)/D*100,a.scale(f)>2&&(f=f.toFixed(2))));var x=v*(V=a.getValueOfDecimal(l.getValue("PriceEntered")));a.scale(x)>S&&(x=a.getValueOfDecimal(x.toFixed(S))),this.log.info("amt = LineNetAmt="+x),l.setValue("LineNetAmt",x);var N=e.Env.ZERO;if("TaxAmt"==s.getColumnName())N=l.getValue("TaxAmt");else{var L=l.getValue("C_Tax_ID");if(null!=L){var R=L,U=(y=this.IsTaxIncluded(n,i),R.toString().concat(",",x.toString(),",",y,",",S.toString())),E=null;N=e.dataContext.getJSONRecord("MTax/CalculateTax",U),l.setValue("TaxAmt",N),null!=l.getField("SurchargeAmt")&&l.setValue("SurchargeAmt",0)}}if(y?l.setValue("LineTotalAmt",a.getValueOfDecimal(x)):l.setValue("LineTotalAmt",a.getValueOfDecimal((x+N).toFixed(S))),g&&l.findColumn("VA106_TaxCollectedAtSource_ID")>-1&&a.getValueOfInt(l.getValue("VA106_TaxCollectedAtSource_ID"))>0)if(0!=a.getValueOfDecimal(l.getValue("LineTotalAmt"))){p=a.getValueOfInt(l.getValue("VA106_TaxCollectedAtSource_ID")).toString()+","+a.getValueOfDecimal(l.getValue("LineTotalAmt")).toString();var k=e.dataContext.getJSONRecord("MInvoice/VA106_CalculateTCSTax",p);null!=k&&l.setValue("VA106_TCSAmount",a.getValueOfDecimal(k.VA106_TCSTaxValue))}else l.setValue("VA106_TCSAmount",0)}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),i=n=l=s=o=null,""},n.prototype.VA106_CalculateTCSTax=function(t,i,n,l,s,o){if(this.isCalloutActive())return"";null!=s&&""!=s.toString()||n.setValue("VA106_TCSAmount",0);try{if(this.setCalloutActive(!0),0!=a.getValueOfDecimal(n.getValue("LineTotalAmt"))){var r=a.getValueOfInt(n.getValue("VA106_TaxCollectedAtSource_ID")).toString()+","+a.getValueOfDecimal(n.getValue("LineTotalAmt")).toString(),c=e.dataContext.getJSONRecord("MInvoice/VA106_CalculateTCSTax",r);null!=c&&n.setValue("VA106_TCSAmount",a.getValueOfDecimal(c.VA106_TCSTaxValue))}else n.setValue("VA106_TCSAmount",0)}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),n=s=null,""},n.prototype.IsTaxIncluded=function(t,a){var i=a.getContext("IsTaxIncluded");try{if(0==i.toString().length){var n=a.getContextAsInt(t,"M_PriceList_ID");if(0==n)return!1;null==(i=e.dataContext.getJSONRecord("MPriceList/GetTaxIncluded",n.toString()))&&(i="N"),a.setContext(t,"IsTaxIncluded",i)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return a=t=mTab=mField=value=oldValue=null,"Y"==i},n.prototype.Qty=function(n,l,s,o,r,c){if(this.isCalloutActive()||null==r||""==r.toString())return"";if(0==a.getValueOfInt(s.getValue("C_Charge_ID"))&&0==a.getValueOfInt(s.getValue("M_Product_ID")))return"";this.setCalloutActive(!0);try{var u,d,g,p,v="",_=n.getContextAsInt(l,"M_Product_ID");if(this.log.log(t.WARNING,"qty - init - M_Product_ID="+_),0==_)d=s.getValue("QtyEntered"),s.setValue("QtyInvoiced",d);else if(o.getColumnName().toString().equals("C_UOM_ID")||o.getColumnName().toString().equals("M_AttributeSetInstance_ID")||o.getColumnName().toString().equals("VAS_ContractLine_ID")){var V=a.getValueOfInt(s.getValue("C_UOM_ID"));d=s.getValue("QtyEntered");var A=n.getContextAsInt(l,"C_BPartner_ID",!1);e.dataContext.getJSONRecord("MBPartner/GetBPartner",A.toString());v=_.toString().concat(",",s.getValue("C_Invoice_ID").toString()+","+a.getValueOfString(s.getValue("M_AttributeSetInstance_ID"))+","+V.toString()+","+n.getAD_Client_ID().toString()+","+A.toString()+","+d.toString());var m=e.dataContext.getJSONRecord("MInvoice/GetPrices",v);if(null!=m){i=m.countEd011;var f=m.countVAPRC;if(i<=0&&f<=0){var D=null;if(null!=d){v=V.toString();var h=e.dataContext.getJSONRecord("MUOM/GetPrecision",v);D=d.toFixed(h)}d!=D&&(this.log.fine("Corrected QtyEntered Scale UOM="+V+"; QtyEntered="+d+"->"+D),d=D,s.setValue("QtyEntered",d)),v=_.toString().concat(",",V.toString(),",",d.toString()),null==(u=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",v))&&(u=d);var C=d!=u;g=s.getValue("PriceActual"),v=_.toString().concat(",",V.toString(),",",g.toString()),null==(p=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",v))&&(p=g),this.log.fine("qty - UOM="+V+", QtyEntered/PriceActual="+d+"/"+g+" -> "+C+" QtyInvoiced/PriceEntered="+u+"/"+p),n.setContext(l,"UOMConversion",C?"Y":"N"),s.setValue("QtyInvoiced",u),s.setValue("PriceEntered",p)}else{var S=m.PriceList;s.setValue("PriceList",S),p=m.PriceEntered,s.setValue("PriceLimit",m.PriceLimit),s.setValue("PriceActual",p),s.setValue("PriceEntered",p),v=V.toString().concat(",");var I=e.dataContext.getJSONRecord("MUOM/GetPrecision",v);D=d.toFixed(a.getValueOfInt(I));d!=D&&(this.log.fine("Corrected QtyEntered Scale UOM="+V+"; QtyEntered="+d+"->"+D),d=D,s.setValue("QtyEntered",d)),v=_.toString().concat(",",V.toString(),",",d.toString());var y=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",v);C=!1;null!=(u=y)&&(C=d!=u),null==u&&(C=!1,u=1),C?s.setValue("QtyInvoiced",u):s.setValue("QtyInvoiced",u*D)}}}else if(o.getColumnName().equals("QtyEntered")){V=n.getContextAsInt(l,"C_UOM_ID"),D=null;if(null!=(d=r)){h=e.dataContext.getJSONRecord("MUOM/GetPrecision",V.toString());D=d.toFixed(h)}d!=D&&(this.log.fine("Corrected QtyEntered Scale UOM="+V+"; QtyEntered="+d+"->"+D),d=D,s.setValue("QtyEntered",d)),O=_.toString().concat(",",V.toString(),",",d.toString()),null==(u=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",O))&&(u=d);C=d!=u;this.log.fine("qty - UOM="+V+", QtyEntered="+d+" -> "+C+" QtyInvoiced="+u),n.setContext(l,"UOMConversion",C?"Y":"N"),s.setValue("QtyInvoiced",u)}else if(o.getColumnName().equals("QtyInvoiced")){V=n.getContextAsInt(l,"C_UOM_ID");u=r;var O=_.toString(),T=(h=e.dataContext.getJSONRecord("MProduct/GetUOMPrecision",O),null);null!=u&&(T=a.getValueOfDecimal(u.toFixed(h))),u!=T&&(this.log.fine("Corrected QtyInvoiced Scale "+u+"->"+T),u=T,s.setValue("QtyInvoiced",u)),O=_.toString().concat(",",V.toString(),",",u.toString()),null==(d=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",O))&&(d=u);C=u!=d;this.log.fine("qty - UOM="+V+", QtyInvoiced="+u+" -> "+C+" QtyEntered="+d),n.setContext(l,"UOMConversion",C?"Y":"N"),s.setValue("QtyEntered",d)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}finally{this.setCalloutActive(!1)}return n=l=s=o=r=null,""},n.prototype.PriceList=function(i,n,l,s,o,r){var c=null;try{if(null==o||""==o.toString())return"";var u=a.getValueOfInt(o.toString());if(null==u||0==u)return"";if(null!=(c=e.dataContext.getJSONRecord("MPriceList/GetPriceListData",o.toString()))){l.setValue("IsTaxIncluded",Boolean("Y".equals(c.IsTaxIncluded))),i.setContext(n,"EnforcePriceLimit",c.EnforcePriceLimit);var d=a.getValueOfInt(c.C_Currency_ID);l.setValue("C_Currency_ID",d);var g=c.M_PriceList_Version_ID;i.setContext(n,"M_PriceList_Version_ID",g)}}catch(e){return this.setCalloutActive(!1),this.log.log(t.severe,null,e),e.message}return i=n=l=o=null,""},n.prototype.CheckDueDate=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";if(null==i.getValue("DateInvoiced")||""==i.getValue("DateInvoiced"))return this.setCalloutActive(!1),"";try{if(this.setCalloutActive(!0),null!=i.getValue("DateInvoiced")&&null!=i.getValue("DueDate")){var o=new Date(i.getValue("DateInvoiced"));new Date(i.getValue("DueDate"))<o&&(e.ADialog.error("DueDateLessThanInvoiceDate"),i.setValue("DueDate",""))}i=l=null,this.setCalloutActive(!1)}catch(e){return this.setCalloutActive(!1),e}return""},n.prototype.GetInvoiceLineDetail=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";try{this.setCalloutActive(!0);var o=l.toString(),r=e.dataContext.getJSONRecord("MInvoice/GetInvoiceLineDetail",o);null!=r&&(i.setValue("M_Product_ID",r.M_Product_ID),i.setValue("M_AttributeSetInstance_ID",r.M_AttributeSetInstance_ID),i.setValue("C_UOM_ID",r.C_UOM_ID),i.setValue("QtyEntered",r.QtyEntered),i.setValue("QtyInvoiced",r.QtyInvoiced)),i=l=null,this.setCalloutActive(!1)}catch(e){return this.setCalloutActive(!1),e}return""},e.Model.CalloutInvoice=n,e.Utility.inheritPrototype(l,e.CalloutEngine),l.prototype.DateAcct=function(e,t,a,i,n,l){if(null==n||""==n.toString()||this.isCalloutActive())return"";this.setCalloutActive(!0);try{a.setValue("DateAcct",n)}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),a=n=null,""},l.prototype.PriceList=function(i,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString())return"";try{var c=o.toString();if(0==a.getValueOfInt(c))return"";this.setCalloutActive(!0);var u=e.dataContext.getJSONRecord("MPriceList/GetPriceListDataForProvisionalInvoice",c);if(null!=u){l.setValue("IsTaxIncluded","Y"==u.IsTaxIncluded),i.setContext(n,"EnforcePriceLimit",u.EnforcePriceLimit);var d=a.getValueOfInt(u.C_Currency_ID);l.setValue("C_Currency_ID",d);var g=a.getValueOfInt(u.M_PriceList_Version_ID);i.setContext(n,"M_PriceList_Version_ID",g)}}catch(e){return this.setCalloutActive(!1),this.log(t.SEVERE,"",e),e}return this.setCalloutActive(!1),i=n=l=o=null,""},l.prototype.BPartner=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";try{var r=a.getValueOfInt(s);if(null==r||0==r)return"";this.setCalloutActive(!0);var c=t.isSOTrx(i),u=e.dataContext.getJSONRecord("MBPartner/GetBPDataForProvisionalInvoice",r);if(null!=u){var d=a.getValueOfInt(u[c?"M_PriceList_ID":"PO_PriceList_ID"]);if(d>0&&n.setValue("M_PriceList_ID",d),u.countVA009>0){var g=0;0==(g=c||"Y"!=a.getValueOfString(u.IsVendor)?c&&"Y"==a.getValueOfString(u.IsCustomer)?a.getValueOfInt(u.VA009_PaymentMethod_ID):0:a.getValueOfInt(u.VA009_PO_PaymentMethod_ID))?n.setValue("VA009_PaymentMethod_ID",null):n.setValue("VA009_PaymentMethod_ID",g)}(d=a.getValueOfInt(u[c?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"]))>0&&n.setValue("C_PaymentTerm_ID",d);var p=a.getValueOfInt(u.C_BPartner_Location_ID);if(r.toString().equals(t.getWindowTabContext(i,e.EnvConstants.TAB_INFO,"C_BPARTNER_ID").toString())){var v=t.getWindowTabContext(i,e.EnvConstants.TAB_INFO,"C_BPARTNER_LOCATION_ID");v&&v.toString().length>0&&(p=parseInt(v))}0==p?n.setValue("C_BPartner_Location_ID",null):n.setValue("C_BPartner_Location_ID",p);var _=a.getValueOfInt(u.AD_User_ID);if(r.toString().equals(t.getWindowTabContext(i,e.EnvConstants.TAB_INFO,"C_BPARTNER_ID").toString())){var V=t.getWindowTabContext(i,e.EnvConstants.TAB_INFO,"AD_USER_ID");V&&V.toString().length>0&&(_=parseInt(V))}0==_?n.setValue("AD_User_ID",null):n.setValue("AD_User_ID",_)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),this.PriceList(t,i,n,l,n.getValue("M_PriceList_ID"))},e.Model.ProvisionalInvoice=l}(VIS,jQuery)},1870:()=>{VAS=window.VAS||{},function(e,t){e.VAS_ExpectedFulfilmentWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[],r=0,c=[],u=0,d=1;function g(e){e<1&&(e=1),e>u&&(e=u);var t=6*((d=e)-1),a=Math.min(t+6,c.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s,r=c[i],g=o.includes(r.C_OrderLine_ID),p="I"!=r.ProductType||r.OnHandQty>0&&r.OnHandQty>=r.QtyOrdered,v=p?"VAS-delivery-box":"VAS-delivery-box no-stock";s="I"!=r.ProductType||r.OnHandQty>=r.QtyOrdered?"badge-green":r.OnHandQty<r.QtyOrdered&&r.OnHandQty>0?"badge-orange":"badge-red",n.find("#VAS_OrderLine_"+l).append('            <div class="'+v+'">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-orderlineid="'+r.C_OrderLine_ID+'"'+(g?" checked":"")+(p?"":" disabled")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+r.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count">                    <span title = "'+VIS.Msg.getMsg("VAS_RemianingQty")+'" class="badge badge-light '+s+'"> '+r.QtyEntered+'</span ></div >                       </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+r.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+r.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(c.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+d+VIS.Msg.getMsg("VAS_Of")+u+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}this.initalize=function(){const a='<div id="VAS_DeliveryContainer_'+(l=this.widgetInfo.AD_UserHomeWidgetID)+'" class="VAS-Expected-fulfilment-container">    <div class="VAS-orders-heading">        <h6>'+VIS.Msg.getMsg("VAS_ExpectedFulfilments")+'</h6>    </div>    <div class="VAS-delivery-count">        <div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_Fulfilments")+' <span id="VAS_DeliveryCount_'+l+'">0</span></div>    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">        </div>    </div>    <div class="VAS-height-container">        <div id="VAS_DeliveryBox_'+l+'" class="VAS-deliveries-listing">        </div>        <div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing">        </div>    </div><div class="VAS-pagination-container"></div></div>';e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append(a)},this.intialLoad=function(p){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_DeliveryContainer_"+l).show(),t.ajax({url:VIS.Application.contextUrl+"Product/GetExpectedDelivery",data:{pageNo:p,pageSize:4,Type:"ED"},dataType:"json",success:function(v){v=JSON.parse(v);if(n.find("#VAS_DeliveryBox_"+l).empty(),n.find("#VAS_OrderContainer").remove,null!=v&&null!=v.Orders&&v.Orders.length>0){for(i=0;i<v.Orders.length;i++){var _='<div id="VAS_OrderContainer_'+l+'" class="VAS-delivery-box" >    <div class="VAS-box-heading">        <div class="VAS-icon-w-name">            <i class="fa fa-file-text" aria-hidden="true"></i>            <div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor"                 title="'+VIS.Msg.getMsg("Document_No")+'"                 data-doc-no="'+v.Orders[i].DocumentNo+'"                 data-customer-name="'+v.Orders[i].CustomerName+'"                 data-orderid="'+v.Orders[i].C_Order_ID+'">                '+v.Orders[i].DocumentNo+'            </div>        </div>        <div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+v.Orders[i].LineCount+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+v.Orders[i].CustomerName+'</div>    </div>    <div class="VAS-spaceBetween-col grid-2-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_DeliveryLocation")+'">'+v.Orders[i].DeliveryLocation+'</div>        <div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_ProductLocation")+'">'+v.Orders[i].ProductLocation+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+v.Orders[i].Symbol+"</span> "+v.Orders[i].GrandTotal.toLocaleString()+"</div>    </div></div>";n.find("#VAS_DeliveryBox_"+l).append(_)}s=[],v.Orders.forEach(function(e){e.OrderLines&&e.OrderLines.length>0&&(s[e.DocumentNo]=e.OrderLines)}),1==p&&(n.find("#VAS_DeliveryCount_"+l).text(v.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/4);var s=t('<div class="VAS-slider-arrows">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(v.RecordCount),r=v.AD_Window_ID),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){!function(i,p,v){n.find("#VAS_DeliveryContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var _='<div id="VAS_ProductContainer_'+l+'" class="VAS-Expected-Order-container"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-orders-heading">        <h6>            <span id="VAS_BackTodelivery_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToFulfilment")+'        </h6><span id="VAS_GenerateDeliveryOrder_'+l+'" class="VAS-generate-delivery-btn" data-orderid="'+v+'" title="'+VIS.Msg.getMsg("VAS_GenerateDeliverOrder")+'"><i class="fa fa-truck" aria-hidden="true"></i></span>    </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text" aria-hidden="true"></i>                    <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>                <div class="VAS-expectedTxt" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+p+'</div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(_),c=s[i]||[],u=Math.ceil(c.length/6),d=1,c.length>0&&g(d);n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackTodelivery_"+l),n.off("click","#VAS_GenerateDeliveryOrder_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){g(d-1)}),n.on("click","#VAS_NextPage_"+l,function(){g(d+1)}),n.on("click","#VAS_BackTodelivery_"+l,function(){n.find("#VAS_DeliveryContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("orderlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateDeliveryOrder_"+l).show():n.find("#VAS_GenerateDeliveryOrder_"+l).hide()}),n.on("click","#VAS_GenerateDeliveryOrder_"+l,function(){!function(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateShipment",data:{C_Order_ID:i,C_OrderLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).Shipment_ID>0){if(a.currentPage=1,a.intialLoad(a.currentPage),r>0){var i=new VIS.Query;i.addRestriction("M_InOut_ID",VIS.Query.prototype.EQUAL,t.Shipment_ID),i.setRecordCount(1),VIS.viewManager.startWindow(r,i)}}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_DeliveryOrderNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})}(t(this).data("orderid"))}),n.find("#VAS_GenerateDeliveryOrder_"+l).hide()}(t(this).data("doc-no"),t(this).data("customer-name"),t(this).data("orderid"))})}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_ExpectedFulfilmentWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_ExpectedFulfilmentWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_ExpectedFulfilmentWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_ExpectedFulfilmentWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_ExpectedFulfilmentWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_ExpectedFulfilmentWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},1895:()=>{VAS=window.VAS||{},function(e,t){e.PoReceiptTabPanel=function(){this.record_ID=0;this.windowNo=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var a=null,i=null,n=null,l=null,s=null,o=null,r=null,c=this.ctx;e.translatedTexts=VIS.Msg.translate(c,["VAS_InvoiceLineTitleTabPanel","VAS_InvoiceLine","VAS_OrderLineNo","VAS_ReceiptLine","VAS_Product","VAS_Attribute","VAS_Qty"],!0);var u=t("<div class ='vas-apInvPoWrapper'></div>");r=t("<h6 class='vas-apInvPoTtl'>"+e.translatedTexts.VAS_InvoiceLineTitleTabPanel+"</h6>"),l=t("<span class = 'vas-apInvPoTitle'>"+e.translatedTexts.VAS_InvoiceLine+"</span>");var d=t('<span class = "vas-apInvPoValue"><label>&nbsp;</label></span>');a=t("<span class = 'vas-apInvPoTitle'>"+e.translatedTexts.VAS_OrderLineNo+"</span>");var g=t('<span class = "vas-apInvPoValue"><label>&nbsp;</label></span>');i=t("<span class = 'vas-apInvPoTitle'>"+e.translatedTexts.VAS_ReceiptLine+"</span>");var p=t('<span class = "vas-apInvPoValue"><label>&nbsp;</label></span>');s=t("<span class = 'vas-apInvPoTitle'>"+e.translatedTexts.VAS_Product+"</span>");var v=t('<span class = "vas-apInvPoValue"><label>&nbsp;</label></span>');o=t("<span class = 'vas-apInvPoTitle'>"+e.translatedTexts.VAS_Attribute+"</span>");var _=t('<span class = "vas-apInvPoValue"><label>&nbsp;</label></span>');n=t("<span class = 'vas-apInvPoTitle'>"+e.translatedTexts.VAS_Qty+"</span>");var V=t('<span class = "vas-apInvPoValue"><label>&nbsp;</label></span>'),A=t('<div class = "root"></div>');this.init=function(){InvoicePoListGroup=t('<div class = "vas-apInvPoListGroup"></div>'),InvoiceLinediv=t('<div class = "vas-apInvPoSingleItem"></div>'),OrderLinediv=t('<div class = "vas-apInvPoSingleItem"></div>'),ReceiptLinediv=t('<div class = "vas-apInvPoSingleItem"></div>'),Productdiv=t('<div class = "vas-apInvPoSingleItem"></div>'),Attributediv=t('<div class = "vas-apInvPoSingleItem"></div>'),Qtydiv=t('<div class = "vas-apInvPoSingleItem"></div>'),InvoicePoSubListGroup=t('<div class = "vas-apInvPoListItem mb-2"></div>'),InvoiceLinediv.append(l).append(d),OrderLinediv.append(a).append(g),ReceiptLinediv.append(i).append(p),Productdiv.append(s).append(v),Attributediv.append(o).append(_),Qtydiv.append(n).append(V),InvoicePoSubListGroup.append(InvoiceLinediv).append(OrderLinediv).append(ReceiptLinediv).append(Productdiv).append(Attributediv).append(Qtydiv),InvoicePoListGroup.append(InvoicePoSubListGroup),u.append(r).append(InvoicePoListGroup),A.append(u)},this.getPoReceiptData=function(e){t.ajax({url:VIS.Application.contextUrl+"VAS/PoReceipt/GetData",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{parentID:e},success:function(e){""!=JSON.parse(e)&&(e=JSON.parse(e),console.log(e),""==e[0].OrderDocumentNo&&""==e[0].GRNDocumentNo||(g.text(e[0].OrderDocumentNo),p.text(e[0].GRNDocumentNo),d.text(e[0].InvoiceDocumentNo),v.text(e[0].ProductName),_.text(e[0].AttributeSetInstance),V.text(e[0].Qty)))},error:function(e){console.log(e)}})},this.getRoot=function(){return A},e.PoReceiptTabPanel.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,this.init()},e.PoReceiptTabPanel.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.getPoReceiptData(e)},e.PoReceiptTabPanel.prototype.sizeChanged=function(e){this.panelWidth=e},e.PoReceiptTabPanel.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,a=null,i=null,n=null,l=null,s=null,o=null,r=null,d=null,g=null,p=null,v=null,_=null,V=null}}}(VAS,jQuery)},2123:()=>{VAS=window.VAS||{},function(e,t){e.VAS_CreateInventoryLines=function(){var e,a;this.frame,this.windowNo,this.Record_ID,this.Table_ID;var i,n,l,s=this,o=t('<div style="overflow:hidden;height:100%;width:100%;">'),r=null,c=null,u=null,d=null,g=null,p=null,v=null,_=null,V=null,A=[],m="",f=[],D=!1,h=0,C=0,S=null,I="",y="",O=0,T=0,w=0,P=0,b=0,M=0;function x(){s.setBusy(!0),VIS.dataContext.getJSONData(VIS.Application.contextUrl+"InventoryLines/GetIventoryCartData",{CartName:u,UserId:m,FromDate:p.getValue(),ToDate:v.getValue(),RefNo:d,windowID:h,RecordId:s.Record_ID,WindowName:I,ToWarehouse:w,DTDSrcWarehouse:P,BPartnerId:b,OrderNo:M},function(e){if(o.find("#VAS-CartLines_"+s.windowNo).css("display","none"),o.find("#VAS-CartHeader_"+s.windowNo).css("display",""),o.find("#InventoryCart_"+s.windowNo).empty(),o.find("#VAS-Availcarts_"+s.windowNo).text("(0)"),e&&e.length>0){for(var a=0;a<e.length;a++)o.find("#VAS-Availcarts_"+s.windowNo).text("("+e.length+")"),o.find("#InventoryCart_"+s.windowNo).append('<div class= "VAS-cart-box" id="VAS-CartId_'+s.windowNo+'" vas-cart-id = "'+e[a].CartId+'"  vas-cart-name = "'+e[a].CartName+'"  vas-transactiontype = "'+e[a].TransactionType+'"  vas-createdby = "'+e[a].CreatedBy+'" vas-CartRef = "'+e[a].ReferenceNo+'"><div class="VAS-cartName-w-des"><h1>'+e[a].CartName+'</h1><div class="VAS-cart-type">Type: '+e[a].TransactionType+'</div><div class="VAS-cart-created">Created by: '+e[a].CreatedBy+'</div></div><div class="VAS-linesdetail-col"><div class="VAS-total-lines"><span class="VAS-lineCount">'+e[a].CartLineCount+'</span><span class="VAS-line-lbl">Line</span></div></div></div>');o.find("#VAS-CartId_"+s.windowNo).off("click"),o.on("click","#VAS-CartId_"+s.windowNo,function(){s.setBusy(!0),o.find("#VAS-CartLines_"+s.windowNo).css("display","block"),o.find("#VAS-CartHeader_"+s.windowNo).css("display","none");var e=t(this).attr("vas-cart-id");S=t(this).attr("vas-CartRef");var a=t(this).attr("vas-cart-name"),r=t(this).attr("vas-transactiontype"),c=t(this).attr("vas-createdby");VIS.dataContext.getJSONData(VIS.Application.contextUrl+"InventoryLines/GetIventoryCartLines",{CartId:e,RefNo:S,ScreenName:I,RecordId:s.Record_ID},function(e){if(e&&e.length>0){o.find("#VAS-CartName_"+s.windowNo).text(a),o.find("#VAS-TransactionType_"+s.windowNo).text(r+" | Created by:"+c),o.find("#VAS-LineCount_"+s.windowNo).text(0),o.find("#VAS-CartLinesDetails_"+s.windowNo).empty();for(var u=0;u<e.length;u++)o.find("#VAS-LineCount_"+s.windowNo).text(e.length),o.find("#VAS-CartLinesDetails_"+s.windowNo).append('<tr cart-code="'+e[u].Code+'" product-id="'+e[u].ProductId+'" attr-id="'+e[u].AttrId+'"uom-id="'+e[u].UomId+'" inventorycount-id="'+e[u].InventoryCountId+'" qty="'+e[u].Quantity+'"><td><div><input class="lineCheckbox "type="checkbox"  value="option1" aria-label="..."></div></td><td>'+e[u].Code+"</td><td>"+e[u].ProductName+"</td><td>"+e[u].AttrName+"</td><td>"+e[u].UomName+'</td><td class="text-right">'+e[u].Quantity+"</td></tr>");if(o.find("#VAS-CartLinesDetails_"+s.windowNo).on("change",".lineCheckbox",function(){var e=o.find("#VAS-CartLinesDetails_"+s.windowNo).find(".lineCheckbox").length===o.find("#VAS-CartLinesDetails_"+s.windowNo).find(".lineCheckbox:checked").length;o.find("#selectAllCheckbox").prop("checked",e),N()}),"VAS_InventoryMove"==I){o.find(".VAS-Inventorymove").css("display","flex"),o.find("#VAS_FlocatorCtrl"+s.windowNo).empty(),o.find("#VAS_TolocatorCtrl"+s.windowNo).empty(),y=o.find("#VAS_FlocatorCtrl"+s.windowNo),_TolocatCtrl=o.find("#VAS_TolocatorCtrl"+s.windowNo);var d=" M_Locator.M_Warehouse_ID="+P;i=VIS.MLookupFactory.get(VIS.Env.getCtx(),s.windowNo,0,VIS.DisplayType.TableDir,"M_Locator_ID",0,!1,d),n=new VIS.Controls.VComboBox("M_Locator_ID",!1,!1,!0,i,50);var g=t('<div class="vis-control-wrap">'),p=t('<div class="input-group-append">');y.append(g),y.append(p),g.append(n.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append(t("<label>"+VIS.Msg.getMsg("VAS_FromLocator")+"</label>")),O=VIS.Utility.Util.getValueOfInt(n.getValue()),n.fireValueChanged=function(){O=VIS.Utility.Util.getValueOfInt(n.getValue())};d=" M_Locator.M_Warehouse_ID="+w;l=VIS.MLookupFactory.get(VIS.Env.getCtx(),s.windowNo,0,VIS.DisplayType.TableDir,"M_Locator_ID",0,!1,d),$ToLocatorControl=new VIS.Controls.VComboBox("M_Locator_ID",!1,!1,!0,l,50);var v=t('<div class="vis-control-wrap">'),_=t('<div class="input-group-append">');_TolocatCtrl.append(v),_TolocatCtrl.append(_),v.append($ToLocatorControl.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append(t("<label>"+VIS.Msg.getMsg("VAS_ToLocator")+"</label>")),T=VIS.Utility.Util.getValueOfInt($ToLocatorControl.getValue()),$ToLocatorControl.fireValueChanged=function(){T=VIS.Utility.Util.getValueOfInt($ToLocatorControl.getValue())}}else o.find(".VAS-Inventorymove").css("display","none")}s.setBusy(!1)})})}s.setBusy(!1)})}function N(){f=[],o.find("#VAS-CartLinesDetails_"+s.windowNo+" input:checked").each(function(){var e=t(this).closest("tr"),a=e.attr("cart-code"),i=e.attr("product-id"),n=e.attr("attr-id"),l=e.attr("uom-id"),s=e.attr("inventorycount-id"),o=e.attr("qty");f.push({Code:a,ProductId:i,AttrId:n,UOMId:l,InventoryCountId:s,Qty:o})})}this.initalize=function(){$bsyDiv=t('<div class="vis-busyindicatorouterwrap" style="visibility: hidden;"></div>'),$bsyDiv.append(t('<div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div>')),s.setBusy(!1),o.append($bsyDiv),e=t('<div class="VAS-filters-container" id="VAS-CartHeader_'+s.windowNo+'">'),a=t('<div class="VAS-flyout-body h-100" id="VAS-CartLines_'+s.windowNo+'" style="display:none;">'),e.append('<div class="VAS-left-filters VAS-CartDetail"><div class="VAS-field-opt-col"><div class="VAS-filters-heading">'+VIS.Msg.getMsg("VAS_Filters")+'</div><div class="VAS-form-field"><label for="">'+VIS.Msg.getMsg("VAS_CreatedBy")+'</label><div class="VAS-input-w-icon" id="VAS-UserId_'+s.windowNo+'"><i class="fa fa-search" aria-hidden="true"></i><input type="text" id="VAS_UserSearch_'+s.windowNo+'" placeholder="Search user"></div><div class="VAS-lblChip-container VAS_UserTag"></div></div><div class="VAS-input-w-icon mb-3"> <i class="fa fa-search" aria-hidden="true"></i><input type="text" id="VAS-Refnumber_'+s.windowNo+'" placeholder="Reference No."></div><div class="VAS-form-field"><label for="">'+VIS.Msg.getMsg("VAS_DateRange")+'</label><div class="VAS-Datefileter"><div class="vas-FromdateDiv w-100"></div><div class="vas-todateDiv w-100"></div></div></div></div><div class="VAS-filter-btn"><input type="button" class="btn ui-button-outline ui-widget" id= "VAS-ClearFilter_'+s.windowNo+'" value="Clear Filters"></div></div><div class= "VAS-avail-cart-col" ><div class="VAS-cartCountW-input"><label for=""> '+VIS.Msg.getMsg("VAS_AvailCarts")+'<span class="VAS-Availcarts" id= "VAS-Availcarts_'+s.windowNo+'"> 0<span></label><div class="VAS-input-w-icon"> <i class="fa fa-search" aria-hidden="true"></i><input type="text" id="VAS-CartSearch_'+s.windowNo+'" placeholder="Search Cart"></div></div><div class= "VAS-carts-results-list"><div class="VAS-carts-box-col" id="InventoryCart_'+s.windowNo+'"></div></div></div>'),a.append('<div class="VAS-carts-listing-col VAS-CartLineDetails h-100"><div class="VAS-cart-list-header"><a><span class="vis vis-back-arrow" id="VAS-BackArrow_'+s.windowNo+'"></span></a><div class="VAS-space-between"><div class="VAS-heading-w-lbl-col"><div class="VAS-createName-heading"><span class="VAS-CartName" id= "VAS-CartName_'+s.windowNo+'"><span></div><div class="VAS-cartAct-lbl"><span class="VAS-TransactionType" id= "VAS-TransactionType_'+s.windowNo+'"><span></div></div><div class="VAS-Inventorymove" style="display:flex;gap:10px;width:50%;"> <div class="input-group vis-input-wrap vis-formouterwrpdiv" id="VAS_FlocatorCtrl'+s.windowNo+'" style="width:50%" > </div >  <div class="input-group vis-input-wrap vis-formouterwrpdiv" id="VAS_TolocatorCtrl'+s.windowNo+'" style="width:50%" > </div > </div > <div class="VAS-total-lines"><span class="VAS-lineCount"><span class= "VAS-LineCount" id = "VAS-LineCount_'+s.windowNo+'"><span></span><span class="VAS-line-lbl">Line</span></div></div></div><div class="VAS-hgt-spaceBetween VAS-LineDetails"><div class="table-responsive VAS-filter-list-table-col"><table class="table"><thead><tr><th><div><input type="checkbox" id="selectAllCheckbox" value="option1" aria-label="..."></div></th><th>'+VIS.Msg.getMsg("VAS_Code")+"</th><th>"+VIS.Msg.getMsg("VAS_Product")+"</th><th>"+VIS.Msg.getMsg("VAS_Attribute")+"</th><th>"+VIS.Msg.getMsg("VAS_UOM")+'</th><th class="text-right">'+VIS.Msg.getMsg("VAS_Qty")+'</th></tr></thead><tbody  id="VAS-CartLinesDetails_'+s.windowNo+'"></tbody></table></div><div class="VAS-footerBtn-w-opt"><div class="form-check VAS-Update" style="display:none;"><input  type="checkbox" value="" id="VAS-Updatedcheckbox_'+s.windowNo+'"><label class="form-check-label" for="defaultCheck8">Update</label></div><input type="button" class="btn ui-button ui-widget" id="VAS-CreateLines_'+s.windowNo+'" value="Create Lines"></div> </div></div></div>'),o.append(e).append(a),C=VIS.context.getWindowTabContext(s.windowNo,0,"AD_Tab_ID"),h=VIS.dataContext.getJSONRecord("InfoProduct/GetWindowID",C.toString()),I=VIS.context.getContext(s.windowNo,"ScreenName"),w=VIS.context.getContextAsInt(s.windowNo,"M_Warehouse_ID"),P=VIS.context.getContextAsInt(s.windowNo,"DTD001_MWarehouseSource_ID"),b=VIS.context.getContextAsInt(s.windowNo,"C_BPartner_ID"),M=VIS.context.getContextAsInt(s.windowNo,"C_Order_ID"),"168"==h&&o.find(".VAS-Update").css("display","block")},this.intialLoad=function(){_User=o.find("#VAS_UserSearch_"+s.windowNo),g=o.find("#VAS-ClearFilter_"+s.windowNo),_=o.find(".vas-FromdateDiv"),V=o.find(".vas-todateDiv"),Userdiv=o.find("#VAS-UserId_"+s.windowNo),Userinput=o.find("#VAS_UserSearch_"+s.windowNo),r=o.find("#VAS-CartSearch_"+s.windowNo),c=o.find("#VAS-Refnumber_"+s.windowNo),t(Userinput).on("focus",function(){Userinput.autocomplete({classes:{"ui-autocomplete":"VAS-AutoComp"},minLength:0,source:function(e,a){0!=e.term.trim().length&&function(e,a){t.ajax({url:VIS.Application.contextUrl+"InventoryLines/GetUsers",type:"GET",datatype:"json",data:{SearchKey:a},success:function(a){a=JSON.parse(a);e(t.map(a,function(e){return{label:e.Name,value:e.Name,ids:e.Key}})),t(s.div).autocomplete("search",""),t(s.div).trigger("focus")}})}(a,e.term)},select:function(e,a){return tag=t('<div class="VAS-lbl-chip" item-id="'+a.item.ids+'"><span class="VAS-chipTxt">'+a.item.label+'</span><span class="vis vis-cross"></span></div>'),tag.find(".vis-cross").on("click",function(){itemId=t(this).parent().attr("item-id"),t(this).parent().remove(),A=A.filter(e=>e!==parseInt(itemId)),m=A.join(","),x()}),A.push(a.item.ids),m=A.join(","),x(),function(e){var t=o.find(".VAS_UserTag").find("[item-id='"+e+"']");if(t&&t.length>0)return!1;return!0}(a.item.ids)?9999!=a.item.ids?(itemId=t(this).parent().attr("item-id"),o.find(".VAS_UserTag").append(tag),this.value="",t(this).focus(),!1):void 0:(this.value="",!0)}})}),$FromDatewrapDiv=t('<div class="input-group vis-input-wrap">'),p=new VIS.Controls.VDate("DateReport",!0,!1,!0,VIS.DisplayType.Date,"DateReport");var e=t('<div class="vis-control-wrap">');$FromDatewrapDiv.append(e),e.append(p.getControl().attr("placeholder"," ").attr("data-placeholder","").addClass("VAS-Cursor")),_.append($FromDatewrapDiv),$toDatewrapDiv=t('<div class="input-group vis-input-wrap">'),v=new VIS.Controls.VDate("DateReport",!0,!1,!0,VIS.DisplayType.Date,"DateReport");var a=t('<div class="vis-control-wrap">');$toDatewrapDiv.append(a),a.append(v.getControl().attr("placeholder"," ").attr("data-placeholder","").addClass("VAS-Cursor")),V.append($toDatewrapDiv),x(),r.on("keyup",function(e){u=r.val(),13===e.keyCode&&x()}),c.on("keyup",function(e){d=c.val(),13===e.keyCode&&x()}),g.on("click touchstart",function(e){m="",A=[],d="",c.val(""),u="",r.val(""),p.oldValue=null,p.setValue(""),p.setValue(null),v.oldValue=null,v.setValue(""),v.setValue(null),o.find("#VAS_UserSearch_"+s.windowNo).val(""),o.find(".VAS_UserTag").find("div").length>0&&o.find(".VAS_UserTag").find("div").remove(),x()}),o.find(".VAS-CartLineDetails").find("#VAS-BackArrow_"+s.windowNo).click(function(){x()}),o.find("#selectAllCheckbox").on("change",function(){var e=t(this).is(":checked");o.find("#VAS-CartLinesDetails_"+s.windowNo+" input[type='checkbox']").prop("checked",e),N()}),o.find("#VAS-Updatedcheckbox_"+s.windowNo).on("change",function(){D=!!t(this).is(":checked")}),o.find(".VAS-CartLineDetails").find("#VAS-CreateLines_"+s.windowNo).click(function(){if(0!=f.length){if("VAS_InventoryMove"==I){if(0==O||0==T)return void VIS.ADialog.info("VAS_PleaseSelectLocator",null,"","");if(O==T)return void VIS.ADialog.info("VAS_InValidCase",null,"","")}s.setBusy(!0),t.ajax({url:VIS.Application.contextUrl+"VAS/InventoryLines/SaveTransactions",type:"POST",dataType:"json",async:!0,data:{TransactionID:s.Record_ID,lstScanDetail:JSON.stringify(f),IsUpdateTrue:D,windowID:h,RefNo:S,FromLocatorId:O,ToLocatorId:T},success:function(e){""==JSON.parse(e)?(s.frame.close(),VIS.ADialog.info("VAS_RecordSaved",null,"","")):VIS.ADialog.info(e),s.setBusy(!1)},error:function(){s.setBusy(!1)}})}else VIS.ADialog.info("VAS_PleaseSelectLines",null,"","")}),p.getControl().on("change",function(){if(p.getValue()>v.getValue())return VIS.ADialog.info("VAS_InCorrectDate",null,"",""),p.oldValue=null,p.setValue(""),void p.setValue(null);x()}),v.getControl().on("change",function(){if(p.getValue()>v.getValue())return VIS.ADialog.info("VAS_InCorrectDate",null,"",""),v.oldValue=null,v.setValue(""),void v.setValue(null);x()})},this.getRoot=function(){return o},this.setBusy=function(e){$bsyDiv[0].style.visibility=e?"visible":"hidden"}},e.VAS_CreateInventoryLines.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.Record_ID=this.frame.getRecord_ID(),this.Table_ID=this.frame.getAD_Table_ID(),this.frame.getContentGrid().append(this.getRoot()),this.initalize(),this.intialLoad()},e.VAS_CreateInventoryLines.prototype.setHeight=function(){return"575"},e.VAS_CreateInventoryLines.prototype.setWidth=function(){return"850"},e.VAS_CreateInventoryLines.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null}}(VAS,jQuery)},2425:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutKPI")}function i(){e.CalloutEngine.call(this,"VIS.CalloutDashboard")}function n(){e.CalloutEngine.call(this,"VIS.CalloutDashboardView")}function l(){e.CalloutEngine.call(this,"VIS.CalloutService")}function s(){e.CalloutEngine.call(this,"VIS.CallOutWorkflow ")}function o(){e.CalloutEngine.call(this,"VIS.CalloutDisplayButton ")}function r(){e.CalloutEngine.call(this,"VIS.CalloutModuleMgmt")}function c(){e.CalloutEngine.call(this,"VIS.CalloutAzureBlob")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.CalculationSelection=function(e,t,a,i,n,l){return this.isCalloutActive()||null==n||""==n.toString()||0==n||(this.setCalloutActive(!0),"IsSum"==i.getColumnName()?(a.setValue("IsMaximum",!1),a.setValue("IsCount",!1),a.setValue("IsMinimum",!1)):"IsMaximum"==i.getColumnName()?(a.setValue("IsSum",!1),a.setValue("IsMinimum",!1),a.setValue("IsCount",!1)):"IsCount"==i.getColumnName()?(a.setValue("IsMaximum",!1),a.setValue("IsSum",!1),a.setValue("IsMinimum",!1)):"IsMinimum"==i.getColumnName()&&(a.setValue("IsSum",!1),a.setValue("IsCount",!1),a.setValue("IsMaximum",!1)),this.setCalloutActive(!1)),""},a.prototype.UpdateKPITableInContext=function(e,t,a,i,n,l){return this.isCalloutActive()||null==n||""==n.toString()||(this.setCalloutActive(!0),1==n?(a.setValue("AD_Table_ID",-1),a.setValue("AD_Tab_ID",-1),e.setContext(t,"AD_Table_ID",-1),e.setContext(t,"AD_Tab_ID",-1)):(a.setValue("TableView_ID",-1),e.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1)),""},a.prototype.UpdateTabIDContext=function(e,t,a,i,n,l){return this.isCalloutActive()||(this.setCalloutActive(!0),n<1||null==n||""==n.toString()?(a.setValue("AD_Tab_ID",-1),e.setContext(t,"AD_Tab_ID",-1)):e.setContext(t,"AD_Tab_ID",n),this.setCalloutActive(!1)),""},e.Model.CalloutKPI=a,e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.UpdateTableInContext=function(e,t,a,i,n,l){return this.isCalloutActive()||(this.setCalloutActive(!0),1==n?(a.setValue("AD_Table_ID",-1),a.setValue("AD_Tab_ID",-1),e.setContext(t,"AD_Table_ID",-1),e.setContext(t,"AD_Tab_ID",-1)):(a.setValue("TableView_ID",-1),e.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1)),""},i.prototype.UpdateTabIDContext=function(e,t,a,i,n,l){return this.isCalloutActive()||(this.setCalloutActive(!0),n<1||null==n||""==n.toString()?(a.setValue("AD_Tab_ID",-1),e.setContext(t,"AD_Tab_ID",-1)):(e.setContext(t,"AD_Tab_ID",n),a.setValue("TableView_ID",-1),e.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1)),""},i.prototype.UpdateTableViewIDOnTableContext=function(e,t,a,i,n,l){return this.isCalloutActive()||null==n||""==n.toString()||(this.setCalloutActive(!0),n>0&&(a.setValue("TableView_ID",-1),e.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1)),""},i.prototype.SelectFunctionOnDashboard=function(e,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString()||0==l)return"";this.setCalloutActive(!0);t.getValueOfBoolean(l);return"IsSum"==n.getColumnName()?(i.setValue("IsAvg",!1),i.setValue("IsCount",!1),i.setValue("IsNone",!1)):"IsAvg"==n.getColumnName()?(i.setValue("IsSum",!1),i.setValue("IsCount",!1),i.setValue("IsNone",!1)):"IsCount"==n.getColumnName()?(i.setValue("IsSum",!1),i.setValue("IsAvg",!1),i.setValue("IsNone",!1)):"IsNone"==n.getColumnName()&&(i.setValue("IsSum",!1),i.setValue("IsCount",!1),i.setValue("IsAvg",!1)),this.setCalloutActive(!1),""},i.prototype.ValueCheck=function(e,t,a,i,n,l){return this.isCalloutActive()||(this.setCalloutActive(!0),a.getValue("LastNValue")>60&&a.setValue("LastNValue",1),this.setCalloutActive(!1),a=null),""},e.Model.CalloutDashboard=i,e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.UpdateTabIDContext=function(e,t,a,i,n,l){return this.isCalloutActive()||(this.setCalloutActive(!0),n<1||null==n||""==n.toString()?(a.setValue("AD_Tab_ID",-1),e.setContext(t,"AD_Tab_ID",-1)):e.setContext(t,"AD_Tab_ID",n),this.setCalloutActive(!1)),""},n.prototype.GroupByChecked=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l)return"";this.setCalloutActive(!0);var o=i.getValue("RC_View_ID").toString()+","+i.getValue("RC_ViewColumn_ID").toString();return e.dataContext.getJSONRecord("MFramework/UpdateGroupByChecked",o),this.setCalloutActive(!1),""},n.prototype.IsViewChecked=function(e,t,a,i,n,l){return this.isCalloutActive()||null==n||(this.setCalloutActive(!0),n?(a.setValue("AD_Tab_ID",-1),a.setValue("AD_Table_ID",-1),e.setContext(t,"AD_Tab_ID",-1),e.setContext(t,"AD_Table_ID",-1)):(a.setValue("TableView_ID",-1),e.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1)),""},e.Model.CalloutDashboardView=n,e.Utility.inheritPrototype(l,e.CalloutEngine),l.prototype.StatisticGroup=function(e,t,a,i,n,l){return null==n||""==n.toString()||a.setValue("FO_STATISTICSUBGROUP_ID",0),""},e.Model.CalloutService=l,e.Utility.inheritPrototype(s,e.CalloutEngine),s.prototype.WorkflowType=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";if(this.setCalloutActive(!0),"R"==t.getValueOfString(s.toString())){var r=e.dataContext.getJSONRecord("MFramework/GetWorkflowType",null);if(0==r)return e.ADialog.info("No_VADMS",null,"",""),e.Msg.getMsg("No_VADMS");n.setValue("AD_Table_ID",r)}return this.setCalloutActive(!1),""},s.prototype.SetSelectedColumn=function(a,i,n,l,s,o){return null==s||""==s.toString()||(this.setCalloutActive(!0),e.dataContext.getJSONRecord("MFramework/GetIsGenericAttribute",t.getValueOfInt(s)).toLower()=="C_GenAttributeSetInstance_ID".toLower()?a.setContext(i,"IsGenericAttribute","Y"):a.setContext(i,"IsGenericAttribute","N"),this.setCalloutActive(!1)),""},e.Model.CallOutWorkflow=s,e.Utility.inheritPrototype(o,e.CalloutEngine),o.prototype.DisplayButton=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";if(0==t.getValueOfInt(n.getValue("C_DocTypeTarget_ID")))return this.setCalloutActive(!1),"";var r=e.dataContext.getJSONRecord("MDocType/GetDocSubType",s.toString());return"WR"==r||"WI"==r?n.setValue("InvoicePrint","Y"):n.setValue("InvoicePrint","N"),this.setCalloutActive(!1),""},e.Model.CalloutDisplayButton=o,e.Utility.inheritPrototype(r,e.CalloutEngine),r.prototype.GenerateMenuItemExportID=function(e,t,a,i,n,l){if(null==n||""==n.toString())return"";var s=e.getContext(t,"Prefix");if(null==a.getValue("MenuItemExport_ID")&&"true"==a.getValue("IsMenuItem").toString()){var o=s+(new Date).getTime();a.setValue("MenuItemExport_ID",o)}return this.setCalloutActive(!1),""},r.prototype.GenerateVersionID=function(e,t,a,i,n,l){if(null==n||""==n.toString())return"";var s=e.getContext(t,"VersionNo").replace(".","");return a.setValue("VersionID",s),this.setCalloutActive(!1),""},r.prototype.CheckBoxValidation=function(e,a,i,n,l,s){if(null==l||""==l.toString())return"";if(1==t.getValueOfBoolean(l)){var o=n.getColumnName();"IsProfessionalFree"==o?(i.setValue("IsProfessionalPaid",!1),i.setValue("IsFree",!1),i.setValue("IsPaid",!1)):"IsProfessionalPaid"==o?(i.setValue("IsProfessionalFree",!1),i.setValue("IsFree",!1),i.setValue("IsPaid",!1)):"IsFree"==o?(i.setValue("IsProfessionalPaid",!1),i.setValue("IsProfessionalFree",!1),i.setValue("IsPaid",!1)):"IsPaid"==o&&(i.setValue("IsProfessionalPaid",!1),i.setValue("IsFree",!1),i.setValue("IsProfessionalFree",!1))}return this.setCalloutActive(!1),""},e.Model.CalloutModuleMgmt=r,e.Utility.inheritPrototype(c,e.CalloutEngine),c.prototype.CheckModule=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";if((this.setCalloutActive(!0),"AB"==t.getValueOfString(n.getValue("SaveAttachmentOn")))&&!e.dataContext.getJSONRecord("VIS/ModulePrefix/GetModulePrefix","VA090_").VA090_)return n.setValue("SaveAttachmentOn",null),this.setCalloutActive(!1),e.Msg.getMsg("VIS_VA090NotInstalled");return this.setCalloutActive(!1),""},e.Model.CalloutAzureBlob=c}(VIS,jQuery)},2468:()=>{VAS=window.VAS||{},function(e,t){e.VAS_OpenQuotationWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[],r=0;this.initalize=function(){const a='<div id="VAS_DeliveryContainer_'+(l=this.widgetInfo.AD_UserHomeWidgetID)+'" class="VAS-due-fulfilment-container">    <div class="VAS-orders-heading">        <h6>'+VIS.Msg.getMsg("VAS_OpenQuotation")+'</h6>    </div>    <div class="VAS-delivery-count">        <div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_Quotation")+' <span id="VAS_DeliveryCount_'+l+'">0</span></div>    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">        </div>    </div>    <div class="VAS-height-container">        <div id="VAS_DeliveryBox_'+l+'" class="VAS-deliveries-listing">        </div>        <div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing">        </div>    </div><div class="VAS-pagination-container"></div></div>';e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append(a)},this.intialLoad=function(c){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_DeliveryContainer_"+l).show(),t.ajax({url:VIS.Application.contextUrl+"Product/GetExpectedDelivery",data:{pageNo:c,pageSize:4,Type:"OQ"},dataType:"json",success:function(u){u=JSON.parse(u);if(n.find("#VAS_DeliveryBox_"+l).empty(),n.find("#VAS_OrderContainer").remove,null!=u&&null!=u.Orders&&u.Orders.length>0){for(i=0;i<u.Orders.length;i++){var d='<div id="VAS_OrderContainer_'+l+'" class="VAS-delivery-box" >    <div class="VAS-box-heading">        <div class="VAS-icon-w-name">            <i class="fa fa-file-text" aria-hidden="true"></i>            <div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor"                 title="'+VIS.Msg.getMsg("Document_No")+'"                 data-doc-no="'+u.Orders[i].DocumentNo+'"                 data-customer-name="'+u.Orders[i].CustomerName+'"                 data-orderid="'+u.Orders[i].C_Order_ID+'">                '+u.Orders[i].DocumentNo+'            </div>        </div>        <div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+u.Orders[i].LineCount+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+u.Orders[i].CustomerName+'</div>    </div>    <div class="VAS-spaceBetween-col grid-2-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_DeliveryLocation")+'">'+u.Orders[i].DeliveryLocation+'</div>        <div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_ProductLocation")+'">'+u.Orders[i].ProductLocation+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+u.Orders[i].Symbol+"</span> "+u.Orders[i].GrandTotal.toLocaleString()+"</div>    </div></div>";n.find("#VAS_DeliveryBox_"+l).append(d)}s=[],u.Orders.forEach(function(e){e.OrderLines&&e.OrderLines.length>0&&(s[e.DocumentNo]=e.OrderLines)}),1==c&&(n.find("#VAS_DeliveryCount_"+l).text(u.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/4);var s=t('<div class="VAS-slider-arrows">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(u.RecordCount),r=u.AD_Window_ID),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){!function(i,c,u){n.find("#VAS_DeliveryContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var d='<div id="VAS_ProductContainer_'+l+'" class="VAS-due-fulfilment-container"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-orders-heading">        <h6>            <span id="VAS_BackTodelivery_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToQuotations")+'        </h6><span id="VAS_GenerateOrder_'+l+'" class="VAS-generate-delivery-btn" data-orderid="'+u+'" title="'+VIS.Msg.getMsg("VAS_GenerateOrder")+'"><i class="vis vis-action" ></i ></span>     </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text" aria-hidden="true"></i>                    <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>                <div class="VAS-expectedTxt" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+c+'</div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(d);var g=s[i]||[],p=6,v=Math.ceil(g.length/p),_=1;function V(e){e<1&&(e=1),e>v&&(e=v);var t=((_=e)-1)*p,a=Math.min(t+p,g.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s=g[i],r=o.includes(s.C_OrderLine_ID);n.find("#VAS_OrderLine_"+l).append('            <div class="VAS-delivery-box">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-orderlineid="'+s.C_OrderLine_ID+'"'+(r?" checked":"")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+s.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count"><span title="'+VIS.Msg.getMsg("VAS_RemianingQty")+'">'+s.QtyEntered+'</span></div>                </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+s.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+s.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(g.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+_+VIS.Msg.getMsg("VAS_Of")+v+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}g.length>0&&V(_);function A(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateSalesOrder",data:{C_Order_ID:i,C_OrderLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).SalesOrder_ID>0){if(a.currentPage=1,a.intialLoad(a.currentPage),r>0){var i=new VIS.Query;i.addRestriction("C_Order_ID",VIS.Query.prototype.EQUAL,t.SalesOrder_ID),i.setRecordCount(1),VIS.viewManager.startWindow(r,i)}}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_SalesOrderNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}}),console.log("Generating delivery order for ID:",i)}n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackTodelivery_"+l),n.off("click","#VAS_GenerateOrder_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){V(_-1)}),n.on("click","#VAS_NextPage_"+l,function(){V(_+1)}),n.on("click","#VAS_BackTodelivery_"+l,function(){n.find("#VAS_DeliveryContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("orderlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateOrder_"+l).show():n.find("#VAS_GenerateOrder_"+l).hide(),console.log(o)}),n.on("click","#VAS_GenerateOrder_"+l,function(){A(t(this).data("orderid"))}),n.find("#VAS_GenerateOrder_"+l).hide()}(t(this).data("doc-no"),t(this).data("customer-name"),t(this).data("orderid"))})}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_OpenQuotationWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_OpenQuotationWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_OpenQuotationWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_OpenQuotationWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_OpenQuotationWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_OpenQuotationWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},2572:()=>{VAS=window.VAS||{},function(e,t){e.TabAlertRuleSql=function(){this.windowNo=0,this.curTab=null,this.selectedRow=null,this.panelWidth,this.ParentId=0;var e,a,i,n,l,s,o,r,c,u,d,g,p,v,_,V,A,m,f,D,h,C,S,I,y,O,T,w,P,b=this,M=null,x=1,N=0,L=0,R=null,U=[],E=[],k=0,G=0,B=null,F=0,Q=!0,$=!1,W=!0,J=null,j=[],z=[],q="",Y=t("<div>"),H=t("<div class='vas-grid-div1'>"),K=t("<div class='vas-grid-div2'>"),Z=t("<div class='vas-join-multiselect'>"),X=t("<div class='vas-sql-result-msg'>"),ee=null,te=null,ae=null,ie=null,ne=null,le=null,se=null,oe=null,re=[],ce=[],ue=-1,de=null,ge=1,pe=0;this.dGrid=null,this.dGridGen=null,this.BasedOn="";var ve,_e=t("<div class='vas-windowtab'><label>"+VIS.Msg.getMsg("VAS_WindowTab")+"</label>"),Ve=t("<div class='vas-windowtab vas-searchinput-block'><label>"+VIS.Msg.getMsg("VAS_WindowTabAddition")+"</label>"),Ae=t('<span class="vis vis-arrow-down vas-arrow-down"></span>'),me=t('<span class="vis vis-arrow-down vas-arrow-down"></span>'),fe=null,De=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vas-input-wrap'>"),he=t("<div class='vas-windowfieldcol-select vas-windowtab vis-ev-col-mandatory' style='display: none;'><label>"+VIS.Msg.getMsg("VAS_FieldColumn")+"</label></div>"),Ce=t("<div style='display: none;' class='vas-joins-select vas-common-style vas-windowtab'><label>"+VIS.Msg.getMsg("VAS_FieldColumn")+"</label>"),Se=t("<div class='vas-sqlquery-text'>"),Ie=t("<i class='vis vis-delete vas-filters-editdelete-btns'></i>"),ye=t("<div class='vas-query-input vas-sql-query-input' id='query-input' contenteditable='true'>"),Oe=t("<div class='vas-query-input' contenteditable='false'>"),Te=t("<div class='vas-multiselect'>"),we=t("<div class='vas-selectBox vas-windowtab'><select><option>"+VIS.Msg.getMsg("VAS_SelectAll")+"</option></select><div class='vas-overselect'></div></div>"),Pe=t("<div class='vas-checkboxes'>"),be=t("<div class='vas-joins'>"),Me=t("<div class='vas-add-label'><label>"+VIS.Msg.getMsg("VAS_Joins")+"</label>"),xe=t("<div class='vas-column1'>"),Ne=t("<div class='vas-add-label-content'><h4>"+VIS.Msg.getMsg("VAS_AddJoin")+"</h4>"),Le=null,Re=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vas-input-wrap'>"),Ue=null,Ee=t("<div style='display:none;'>"),ke=null,Ge=null,Be=t("<div class='vas-filters'>"),Fe=t("<div class='vas-add-label'><label>"+VIS.Msg.getMsg("VAS_Condition")+"</label>"),Qe=t("<div class='vas-select-plus-btn'>"),$e=t("<div class='vas-addfiltertext'>"+VIS.Msg.getMsg("VAS_AddFilter")+"</div>"),We=t("<div class='vas-add-label-content'>"),Je=t("<div class='vas-windowtab vas-operator'><label>"+VIS.Msg.getMsg("Operator")+"</label>"),je=t("<div class='vas-windowtab vas-columnval vas-single-input vas-showHideColumn'><label>"+VIS.Msg.getMsg("VAS_ColumnValue")+"</label>"),ze=t("<div class='vas-filter-text-input vas-single-selection-dropdown'>"),qe=t("<div class='vas-filter-val'>"),Ye=t("<select class='vas-filtercondn'><option>=</option><option><></option><option>></option><option><</option><option><=</option><option>>=</option><option>LIKE</option><option>NOT LIKE</option><option>IS NULL</option><option>IS NOT NULL</option></select>"),He=t("<input type='textbox' class='vas-filter-text-input'>"),Ke=t("<div class='vas-fielddropdown vas-windowtab'><label>"+VIS.Msg.getMsg("VAS_FieldColumn")+"</label>"),Ze=t("<div class='vas-joinfielddropdown vas-windowtab'><label>"+VIS.Msg.getMsg("VAS_FieldColumn")+"</label>"),Xe=null,et=t('<i data-info="Y" class="fa fa-exchange" title="'+VIS.Msg.getMsg("SwapColumnValue")+'"></i>'),tt=null,at=t('<span class="vis vis-arrow-down vas-arrow-down"></span>'),it=t('<span class="vis vis-arrow-down vas-arrow-down"></span>'),nt=t('<span class="vis vis-arrow-down vas-arrow-down"></span>'),lt=t('<span class="vis vis-arrow-down vas-arrow-down"></span>'),st=t('<span class="vis vis-arrow-down vas-arrow-down"></span>'),ot=t("<input class='vas-select-col' type='textbox' placeholder='"+VIS.Msg.getMsg("VAS_TypeColumn")+"'>"),rt=t("<input class='vas-select-col' type='textbox' placeholder='"+VIS.Msg.getMsg("VAS_TypeColumn")+"'>"),ct=t("<input class='vas-select-col' data-input='oldColumn' type='textbox' placeholder='"+VIS.Msg.getMsg("VAS_TypeColumn")+"'>"),ut=t("<input class='vas-select-col' type='textbox' placeholder='"+VIS.Msg.getMsg("VAS_TypeColumn")+"'>"),dt=t("<input class='vas-select-col' type='textbox' placeholder='"+VIS.Msg.getMsg("VAS_TypeColumn")+"'>"),gt=t("<input class='vas-select-col vis-ev-col-mandatory' type='textbox' placeholder='"+VIS.Msg.getMsg("VAS_TypeColumn")+"'>"),pt=t("<input class='vas-join-select-col' type='textbox' placeholder='"+VIS.Msg.getMsg("VAS_TypeColumn")+"'>"),vt=t("<div class='vas-add-label'><label>"+VIS.Msg.getMsg("VAS_Sort")+"</label>"),_t=t("<div class='vas-filterofMultipleCols'>"),Vt=t("<div class='vas-single-input vas-windowtab vas-searchinput-block vas-filterNewCol' style='display: none;'><label>"+VIS.Msg.getMsg("VAS_CompareColumn")+"</label>"),At=t("<input class='vas-select-col' data-input='newColumn' type='textbox' placeholder='"+VIS.Msg.getMsg("VAS_TypeColumn")+"'>"),mt=t('<span class="vis vis-arrow-down vas-arrow-down"></span>'),ft=t("<div class='vas-add-label-content'><h4>"+VIS.Msg.getMsg("VAS_AddSort")+"</h4>"),Dt=t("<div class='vas-sortby-dropdown'>"),ht=t("<div class='vas-single-input vas-windowtab vas-sort-block'><label>"+VIS.Msg.getMsg("VAS_FieldColumn")+"</label>"),Ct=t("<div class='vas-single-input vas-windowtab vas-searchinput-block'><label>"+VIS.Msg.getMsg("VAS_FieldColumn")+"</label>"),St=t("<div class='vas-filterValExchangeIconBlock vas-showHideColumn' style='display: none;'>"),It=t("<div class='vas-single-input vas-windowtab vas-searchinput-block vas-filterValBlock'><label>"+VIS.Msg.getMsg("VAS_FieldColumn")+"</label>"),yt=t("<div class='vas-single-input vas-windowtab vas-searchinput-block vas-filterCol2Block vas-single-selection-dropdown'>"),Ot=t("<div class='vas-single-input vas-windowtab'><label>"+VIS.Msg.getMsg("VAS_MainTable_Column")+"</label>"),Tt=t("<div class='vas-single-input vas-joiningtable-input vas-windowtab'><label>"+VIS.Msg.getMsg("VAS_JoinTable_Column")+"</label>"),wt=t("<div class='vas-select-plus-btn vas-addsort-btn'>"),Pt=t("<div class='vas-sql-btns'>"),bt=t("<div class='vas-content-area'>"),Mt=t("<div class='vas-query-message'>"),xt=t("<div class='vas-sql-content'><div class='vas-sqlquery-text'>"+VIS.Msg.getMsg("VAS_SQL")+"</div></div>"),Nt=t("<div style='display:none;' class='vas-queryresult-grid'></div>"),Lt=null,Rt=t("<div style='display:none;' class='vas-queryresult-grid'></div>"),Ut=t('<div class="vis-advanedSearch-InputsWrap vis-advancedSearchMrgin vas-dateBlock"><div id="currentDate" class= "vis-form-group vis-advancedSearchInput1" ><input type="checkbox" id="chkDynamic" name="IsDynamic" class="vis-pull-left"><label for="IsDynamic">'+VIS.Msg.getMsg("IsDynamic")+'</label></div><div class="vis-form-group vis-advancedSearchInput"><select id="drpDynamicOp" disabled><option>'+VIS.Msg.getMsg("Today")+"</option><option>"+VIS.Msg.getMsg("lastxDays")+"</option><option>"+VIS.Msg.getMsg("lastxMonth")+"</option><option>"+VIS.Msg.getMsg("lastxYears")+'</option></select></div><div class= "vis-form-group vis-advancedSearchHorigontal vis-pull-left"id = "divYear" style = "display: none;" ><input id = "txtYear" type = "number" min = "1" max = "99" > <label for="Year">'+VIS.Msg.getMsg("Year")+'</label></div><div class="vis-form-group vis-advancedSearchHorigontal vis-pull-left" id="divMonth" style="display: none;"> <input id="txtMonth" type="number" min="1" max="12"><label for="Month">'+VIS.Msg.getMsg("Month")+'</label></div><div class="vis-form-group vis-advancedSearchHorigontal vis-pull-left" id="divDay" style=""><input id="txtDay" type="number" min="0" max="31"><label for="Day">'+VIS.Msg.getMsg("Day")+"</label></div></div>"),Et=VIS.Msg.getMsg("VAS_SQLQuery"),kt=t("<div class='vas-sortCollection'>"),Gt=VIS.Msg.getMsg("VAS_TestSql"),Bt=null,Ft=[],Qt=[],$t=t("<div class='vas-root'>"),Wt=t("<div class='vas-root-main'>"),Jt=t("<div style='display:none;' class='vas-root-eventmain'>");function jt(e){Bt[0].style.visibility=e?"visible":"hidden"}function zt(e){var t;return t=" adddays(sysdate, - "+function(e){let t=parseInt(o.val()||0,10),a=parseInt(r.val()||0,10),i=parseInt(c.val()||0,10),n=new Date;if(3==e||6==e){let e=new Date(n.getFullYear()-t,n.getMonth()-a,n.getDate()-i);return Math.floor((n-e)/864e5)}if(2==e||5==e){let e=new Date(n.getFullYear(),n.getMonth()-a,n.getDate()-i);return Math.floor((n-e)/864e5)}return i}(e)+") ",t}function qt(e){var t=l[0].selectedIndex;if(e)return divYear.hide(),divMonth.hide(),void divDay.hide();divYear.show(),divMonth.show(),s.is(":checked")?divDay.show():divDay.hide(),c.prop("readonly",!1),r.prop("readonly",!1),o.prop("readonly",!1),r.prop("min",1),3==t||6==t?(r.prop("min",0),c.val(0),r.val(0),o.val(1)):2==t||5==t?(divYear.hide(),o.val(""),r.val(1),c.val(0)):1==t||4==t?(divYear.hide(),divMonth.hide(),c.val(0)):0==t&&(c.prop("readonly",!0),divYear.hide(),divMonth.hide(),c.val(0))}function Yt(){var e=t(event.target).parents(".vas-filter-item"),a=e.find(".vas-filter-andor-value").text(),i=e.find(".vas-selecttable").text(),n=e.attr("filterId");"string"==typeof n&&(n=e.find(".vas-filter-price-value").text());var l=e.find(".vas-filter-condition").text(),s=Oe.text(),o=(s=s.replace(/\s{2,}/g," ")).indexOf("ORDER BY"),r=s.indexOf("WHERE"),c=a+" "+i+" "+l+" "+n,u="";o>-1&&(u=s.slice(o),s=s.slice(0,o).trim());var d=c.indexOf("OR"),g=s.indexOf("OR"),p=c.indexOf("AND"),v=s.indexOf("AND");r>-1&&-1==v&&-1==g&&(-1!==d&&(c=c.replace("OR","").trim()),-1!==p&&(c=c.replace("AND","").trim()),s=s.replace("WHERE","").trim(),Q=!0);var _=c;if(v>-1||g>-1){p>-1&&(_=c.replace("AND","").trim()),d>-1&&(_=c.replace("OR","").trim()),_=_.replace(/\s{2,}/g," ");var V=s.indexOf(_),A=_.length;if(s.slice(V-6,V).indexOf("WHERE")>-1){var m=s.slice(V,V+A+4).trim(),f=m.indexOf("OR"),D=m.indexOf("AND");f>-1&&(_=s.slice(V,V+A+3).trim()),D>-1&&(_=s.slice(V,V+A+4).trim()),c=_}}c=c.replace(/\s{2,}/g," ");var h=s.replace(c,"").trim();h+=" "+u,Oe.text(""),h=h.replace(/\s{2,}/g," "),Oe.text(h),ea()}function Ht(e){v.empty(),w.setValue(null);var a=new VIS.MLookupFactory.get(VIS.Env.getCtx(),b.windowNo,0,VIS.DisplayType.MultiKey,"AD_Column_ID",0,!1," AD_Column.IsActive='Y' AND FD.AD_Tab_ID= "+e),i=(w=new VIS.Controls.VTextBoxButton("AD_Column_ID",!0,!1,!0,VIS.DisplayType.MultiKey,a)).getControl().attr("placeholder"," Search here").attr("id","AD_Column_ID").css("width","100%").css("height","100%"),n=t('<div class="vas-control-wrap">'),l=t('<div class="input-group-append">');v.css("width","100%"),v.append(n).append(l),n.append(i),l.append(w.getBtn(0)),l.append(w.getBtn(1)),w.setCustomInfo("VAS_AlertFieldColumn"),w.getControl().addClass("vis-ev-col-mandatory")}function Kt(){if(V.text(""),0==T.getValue())return jt(!1),VIS.ADialog.error("","",VIS.Msg.getMsg("VAS_EnterWindowTab")),isProcessing=!1,!1;var e="";if(d.getValue()){if(w.getValue()&&0==w.getValue().trim().length)return jt(!1),VIS.ADialog.error("","",VIS.Msg.getMsg("VAS_EnterFieldColumn")),isProcessing=!1,!1;e=w.getValue()}var a={alertRuleID:b.ParentId,alertID:VIS.context.getContext(b.windowNo,"AD_Alert_ID"),tableID:N,TabID:T.getValue(),ColumnID:e,IsInsert:u.getValue(),IsUpdate:d.getValue(),IsDelete:g.getValue()};t.ajax({url:VIS.Application.contextUrl+"AlertSQLGenerate/SaveAlertRule",type:"POST",data:a,async:!1,success:function(e){"Saved Successfully"==(e=JSON.parse(e))&&(jt(!1),V.text("Saved Successfully"),isProcessing=!1)},error:function(e){jt(!1),console.log(e),isProcessing=!1}})}function Zt(a,i){e=0,x=1,pe=0;var n="";Ft=[],a>0&&t.ajax({url:VIS.Application.contextUrl+"AlertSQLGenerate/GetTable",type:"POST",async:!1,data:{tabID:a,windowNo:self.windowNo},success:function(t){(t=JSON.parse(t))&&t.length>0&&(e=t[0].TableID,N=e,B=t[0].TableName,a=t[0].TabID,n=t[0].WhereClause,Ft=t[0].dr.Table)},error:function(e){console.log(e)}}),e>0?"S"==i&&(ia(e,a,n),Le.fireValueChanged=Xt,fe.getControl().removeClass("vis-ev-col-mandatory")):ua()}function Xt(){var e="",a=Le.getValue(),i=0;Qt=[],a>0&&t.ajax({url:VIS.Application.contextUrl+"AlertSQLGenerate/GetTable",type:"POST",async:!1,data:{tabID:a,windowNo:self.windowNo},success:function(t){(t=JSON.parse(t))&&t.length>0&&(i=t[0].TableID,e=t[0].WhereClause,Qt=t[0].dr.Table)},error:function(e){console.log(e)}}),null!=i&&""!=i?na(i,a,e):na(0,0,null)}function ea(){ze.val(""),He.val(""),Ye.val(""),Ye.removeClass("vas-disabled-icon"),St.hide(),Vt.hide(),ct.val(""),rt.val(""),se.val(VIS.Msg.getMsg("VAS_AddFilter")),Vt.find("input").val(""),St.find("input").val(""),n.find("input").prop("checked",!1),He.prop("checked",!1),je.show(),ta()}function ta(){s.prop("checked",!1),Ye.val(""),Ye.removeClass("vas-disabled-icon"),l.prop("disabled",!0),l.prop("selectedIndex",0),o.val(""),r.val(""),c.val(""),divYear.hide(),divMonth.hide(),divDay.hide()}function aa(e,a,i,n,l,s){var o="";return t.ajax({url:VIS.Application.contextUrl+"AlertSQLGenerate/GetLookup",type:"POST",data:{windowNo:b.windowNo,columnDatatype:e,columnID:a,columnName:i,refrenceID:n,isParent:"Y"===l,tableName:s},async:!1,success:function(e){o=JSON.parse(e)},error:function(e){console.log(e)}}),o}function ia(e,a,i){we.find("select").empty();var n=!0,l=[];Pe.empty(),Dt.empty(),ze.empty(),yt.empty(),ke.empty(),ve=[],t.ajax({url:VIS.Application.contextUrl+"AlertSQLGenerate/GetColumns",data:{tableID:e,tabID:a},type:"POST",async:!1,success:function(e){if((e=JSON.parse(e))&&e.length>0){B=e[0].TableName,ve=e;for(var s=0;s<e.length;s++)Dt.append("<div class='vas-column-list-item' title='"+B+" - "+e[s].ColumnName+" ("+e[s].DBColumn+")' value='"+B+"."+e[s].DBColumn+"' refValId='"+e[s].ReferenceValueID+"' fieldID='"+e[s].FieldID+"' WindowID='"+e[s].WindowID+"' isParent='"+e[s].IsParent+"' tabID='"+a+"' DBColumnName='"+e[s].DBColumn+"' fieldName='"+e[s].FieldName+"' TableName='"+B+"' columnID='"+e[s].ColumnID+"' datatype='"+e[s].DataType+"'>"+e[s].ColumnName+" ("+e[s].DBColumn+")</div>"),ze.append("<div class='vas-column-list-item' columnID='"+e[s].ColumnID+"' TableName='"+B+"' title='"+B+" - "+e[s].ColumnName+" ("+e[s].DBColumn+")' refValId='"+e[s].ReferenceValueID+"' fieldID='"+e[s].FieldID+"' WindowID='"+e[s].WindowID+"' isParent='"+e[s].IsParent+"' tabID='"+a+"' DBColumnName='"+e[s].DBColumn+"' fieldName='"+e[s].FieldName+"' datatype='"+e[s].DataType+"' value='"+B+"."+e[s].DBColumn+"'>"+B+" - "+e[s].ColumnName+" ("+e[s].DBColumn+")</div>"),yt.append("<div class='vas-column-list-item' title='"+B+" - "+e[s].ColumnName+" ("+e[s].DBColumn+")' refValId='"+e[s].ReferenceValueID+"' fieldID='"+e[s].FieldID+"' WindowID='"+e[s].WindowID+"' tabID='"+a+"' DBColumnName='"+e[s].DBColumn+"' TableName='"+B+"' fieldName='"+e[s].FieldName+"' columnID='"+e[s].ColumnID+"' datatype='"+e[s].DataType+"' value='"+B+"."+e[s].DBColumn+"'>"+B+" - "+e[s].ColumnName+" ("+e[s].DBColumn+")</div>"),Pe.append("<div class='vas-column-list-item' refValId='"+e[s].ReferenceValueID+"' fieldID='"+e[s].FieldID+"' WindowID='"+e[s].WindowID+"' tabID='"+a+"' DBColumnName='"+e[s].DBColumn+"' TableName='"+B+"' fieldName='"+e[s].FieldName+"' columnID='"+e[s].ColumnID+"' datatype='"+e[s].DataType+"' isParent='"+e[s].IsParent+"' title='"+e[s].FieldName+" - "+e[s].DBColumn+"'><input type='checkbox' class='vas-column-checkbox' data-oldIndex='"+s+"'>"+e[s].FieldName+" - "+e[s].DBColumn+"</div>")}l=[],t(".vas-column-list-item .vas-column-checkbox").on("click",function(e){n||(t(".vas-column-checkbox").prop("checked",!1),n=!0);var a=t(this).parent(".vas-column-list-item"),s=a.attr("datatype"),o="",r=a.attr("fieldName");r=r.replace(/[^a-zA-Z0-9\s]+/g,""),VIS.DisplayType.IsLookup(s)&&(o=aa(s,t(this).parent(".vas-column-list-item").attr("columnID"),t(this).parent(".vas-column-list-item").attr("DBColumnName"),t(this).parent(".vas-column-list-item").attr("refValId"),t(this).parent(".vas-column-list-item").attr("isParent"),t(this).parent(".vas-column-list-item").attr("TableName"))),""==o&&(o=""!=r?B+"."+a.attr("dbcolumnname").trim()+' AS "'+r+'" ':B+"."+a.attr("dbcolumnname").trim()+" "),this.checked?l.push(o):l=l.filter(function(e){return e!=o}),l.length>0&&function(e,t){var a=Oe.text(),i=a.indexOf("FROM"),n=a.indexOf("JOIN"),l=a.indexOf("WHERE");Oe.text(""),-1==i?sql="SELECT "+e+"FROM "+B:-1!=n&&E.length>0?sql="SELECT "+e+", "+E+a.slice(i):sql="SELECT "+e+a.slice(i);t.length>0&&sql.length>0&&-1==l&&(sql+=" WHERE "+t);Oe.text(""),Oe.text(sql)}(l,i),l.length>0?(Me.css("pointer-events","all"),Fe.css("pointer-events","all"),vt.css("pointer-events","all"),he.removeClass("vis-ev-col-mandatory"),X.hide()):(Me.css("pointer-events","none"),Fe.css("pointer-events","none"),vt.css("pointer-events","none"),Oe.text(""),he.addClass("vis-ev-col-mandatory"))}),Pe.on("change",".vas-column-list-item .vas-column-checkbox",function(){var e=t(this).closest(".vas-column-list-item");if(this.checked)e.prependTo(Pe),gt.removeClass("vis-ev-col-mandatory");else{var a=t(this).data("oldindex");e.insertAfter(Pe.children().eq(a))}Pe.find(".vas-column-checkbox:checked").length>0?gt.removeClass("vis-ev-col-mandatory"):gt.addClass("vis-ev-col-mandatory")})},error:function(e){console.log(e)}})}function na(e,a,i){q="",""!=i&&i&&(q=i);var n=[];ut.val(""),dt.val(""),we.find("select").empty(),Z.empty(),Ge.empty(),Ce.css("margin-bottom","10px"),t.ajax({url:VIS.Application.contextUrl+"AlertSQLGenerate/GetColumns",data:{tableID:e,tabID:a},type:"POST",async:!1,success:function(e){if(e=JSON.parse(e),R=e,e&&e.length>0){A=e[0].TableName;for(var a=null,i=null,l=0;l<e.length;l++){for(var s=0;s<ve.length;s++){var o=ve[s].TableName+"."+ve[s].DBColumn,r=ve[s].DBColumn+" ("+ve[s].TableName+")",c=A+"."+e[l].DBColumn,u=e[l].DBColumn+" ("+A+")";ve[s].DBColumn==e[l].DBColumn&&(n.includes(e[l].DBColumn)||(Ge.append("<div class='vas-column-list-item' title='"+u+"'value="+c+">"+u+"</div>"),n.push(e[l].DBColumn)),ke.append(" <div class='vas-column-list-item' title='"+r+"' value="+o+">"+r+"</div>")),"Y"==ve[s].IsKey&&!ut.val().length>0&&(ut.val(o),a=ve[s].DBColumn)}e[l].DBColumn==a&&null!=dt.val()&&dt.val(A+"."+a),"Y"==e[l].IsKey&&(i=e[l].DBColumn),Z.append("<div class='vas-column-list-item' refValId='"+e[l].ReferenceValueID+"' fieldID='"+e[l].FieldID+"' WindowID='"+e[l].WindowID+"' tabID='"+L+"' DBColumnName='"+e[l].DBColumn+"' TableName='"+A+"' fieldName='"+e[l].FieldName+"' columnID='"+e[l].ColumnID+"' datatype='"+e[l].DataType+"' isParent='"+e[l].IsParent+"' title='"+e[l].FieldName+" - "+e[l].DBColumn+"'><input type='checkbox' class='vas-column-checkbox' data-oldIndex='"+l+"'>"+e[l].FieldName+" - "+e[l].DBColumn+"</div>")}""==dt.val()&&null!=i&&dt.val(A+"."+i),filterFlag=!1,j=[],t(".vas-join-multiselect .vas-column-checkbox").on("click",function(e){var a=t(this).parent(".vas-column-list-item"),i=a.attr("datatype"),n="",l=a.attr("fieldName");l=l.replace(/[^a-zA-Z0-9\s]+/g,""),VIS.DisplayType.IsLookup(i)&&(n=aa(i,t(this).parent(".vas-column-list-item").attr("columnID"),t(this).parent(".vas-column-list-item").attr("DBColumnName"),t(this).parent(".vas-column-list-item").attr("refValId"),t(this).parent(".vas-column-list-item").attr("isParent"),t(this).parent(".vas-column-list-item").attr("TableName"))),""==n&&(n=""!=l?A+"."+a.attr("dbcolumnname").trim()+' AS "'+l+'" ':A+"."+a.attr("dbcolumnname").trim()+" "),this.checked?j.push(n):j=j.filter(function(e){return e!=n})}),Z.on("change",".vas-column-list-item .vas-column-checkbox",function(){var e=t(this).closest(".vas-column-list-item");if(this.checked)e.prependTo(Z);else{var a=t(this).data("oldindex");e.insertAfter(Z.children().eq(a))}})}},error:function(e){console.log(e)}})}function la(e,a){var i=new VIS.MLookupFactory.get(VIS.Env.getCtx(),b.windowNo,0,VIS.DisplayType.Search,"AD_Tab_ID",0,!1,"AD_Tab.AD_Window_ID IN (SELECT AD_Window_ID FROM AD_Window_Access WHERE AD_Role_ID = "+VIS.Env.getCtx().getAD_Role_ID()+") AND AD_Tab.AD_Tab_ID <> "+e+" AND AD_Tab.AD_Table_ID<>"+a),n=(Le=new VIS.Controls.VTextBoxButton("AD_Tab_ID",!1,!1,!0,VIS.DisplayType.Search,i)).getControl().attr("placeholder"," Search here").attr("id","Ad_Tab_ID"),l=t('<div class="vas-control-wrap">'),s=t('<div class="input-group-append">');Re.css("width","100%"),Re.append(l).append(s),l.append(n),s.append(Le.getBtn(0)),s.append(Le.getBtn(1)),Le.setCustomInfo("VAS_AlertSQLGenerator")}function sa(a){if(null!=a){var i={query:VIS.secureEngine.encrypt(a),tableID:e||0,alertID:k,alertRuleID:G,isEmail:D.getValue(),emailColumn:h.getValue()};G=b.ParentId,t.ajax({url:VIS.Application.contextUrl+"AlertSQLGenerate/UpdateQuery",type:"POST",data:i,async:!1,success:function(e){(e=JSON.parse(e))&&e.length>0&&(X.text(e),X.removeClass("vas-sql-result-error"),X.show(),b.curTab.dataRefreshAll()),"Saved Successfully"==e&&($sqlBtn.trigger("click"),X.text(e),X.show())},error:function(e){console.log(e)}})}}function oa(e){null!=e&&(e=e.replace(/\s{2,}/g," ").trim(),t.ajax({url:VIS.Application.contextUrl+"AlertSQLGenerate/GetResult",data:{Query:VIS.secureEngine.encrypt(e),pageNo:x,pageSize:100,tableName:B,recordCount:pe},type:"POST",async:!1,success:function(e){null!=(e=JSON.parse(e))&&e!=[]?e.RecordList.length>0?(pe=e.TotalRecord,ge=Math.ceil(pe/100),function(){if(ge>0){pagingDiv.find("select").empty();for(var e=0;e<ge;e++)pagingDiv.find("select").append(t("<option>").val(e+1).text(e+1));pagingDiv.find("select").val(x)}}(),W&&(!function(e){re=[];for(var a=0;a<Object.keys(e[0]).length;a++)"recid"!=Object.keys(e[0])[a]&&re.push({field:Object.keys(e[0])[a],caption:Object.keys(e[0])[a],size:"130px"});null!=this.dGrid&&(this.dGrid.destroy(),this.dGrid=null);this.dGrid=t(H).w2grid({name:"gridForm"+b.windowNo,recordHeight:35,multiSelect:!0,columns:re,records:w2utils.encodeTags(e)}),ye.hide(),C.hide(),Y.hide(),Nt.show()}(e.RecordList),X.hide()),a&&(!function(e){ce=[];for(var a=0;a<Object.keys(e[0]).length;a++)"recid"!=Object.keys(e[0])[a]&&ce.push({field:Object.keys(e[0])[a],caption:Object.keys(e[0])[a],size:"130px"});null!=this.dGridGen&&(this.dGridGen.destroy(),this.dGridGen=null);this.dGridGen=t(K).w2grid({name:"gridForm2"+b.windowNo,recordHeight:35,multiSelect:!0,columns:ce,records:w2utils.encodeTags(e)}),Oe.hide(),K.show(),Rt.show()}(e.RecordList),X.hide()),pagingPlusBtnDiv.removeClass("d-none"),pagingPlusBtnDiv.addClass("d-flex justify-content-between align-items-center")):(W&&(ae.val(Gt),Nt.hide(),Y.show(),ye.show(),C.show(),ie.hide()),a&&(Oe.show(),K.hide(),Rt.hide(),te.val(Gt)),X.show(),X.text(VIS.Msg.getMsg("NoRecordFound")),ne.hide(),pagingPlusBtnDiv.addClass("d-none"),pagingPlusBtnDiv.removeClass("d-flex justify-content-between align-items-center"),te.removeClass("vas-show-grid"),X.addClass("vas-sql-result-error")):(W&&(ae.val(Gt),Nt.hide(),Y.show(),ye.show(),C.show(),ie.hide()),a&&(Oe.show(),K.hide(),Rt.hide(),te.val(Gt)),ae.removeClass("vas-show-grid"),X.show(),X.text(VIS.Msg.getMsg("VAS_ValidQuery")),ne.hide(),te.removeClass("vas-show-grid"),X.addClass("vas-sql-result-error"),pagingPlusBtnDiv.addClass("d-none"),pagingPlusBtnDiv.removeClass("d-flex justify-content-between align-items-center"))},error:function(e){console.log(e)}}))}function ra(e,a){let i=e.attr("value");var o="";je.find("input").val(""),ct.val(""),e.parent(ze).prev(Ct).find(rt).val(i),a.removeClass("active"),e.addClass("active");var r=ze.children(".vas-column-list-item.active").attr("datatype");12==r||29==r||22==r||47==r?(je.show(),St.hide()):(je.hide(),St.show()),e.parent(ze).prev(Ct).find(rt).attr("datatype",r);var u=ze.children(".vas-column-list-item.active").attr("columnid");e.parent(ze).prev(Ct).find(rt).attr("columnid",u),ze.hide(),n.find("input").prop("checked",!1),Ut.hide(),qe.empty();var d=e.attr("datatype"),g=e.attr("DBColumnName"),p=e.attr("TableName"),v=e.attr("refvalid");if(!VIS.DisplayType.IsLookup(d))for(var _=0;_<Ft.length;_++){for(var V=Object.keys(Ft[_]),A=null,m=0;m<V.length;m++)if(V[m].toLowerCase()===g.toLowerCase()){A=V[m];break}if(null!=A){var f=Ft[_][A];null!=f&&""!==f&&(o+='<div class="vas-filterValItem" isNameExist="false" DBColumnName="'+g+'" tableName="'+p+'" value="'+f+'">'+f+"</div>")}}if(qe.append(o),_t.find("i").removeClass("vas-showAnotherColControl"),Vt.hide(),St.find("input").prop("disabled",!1),je.find("input").prop("disabled",!1),St.find(".vas-arrow-down").css("pointer-events","all"),yt.children(".vas-column-list-item").off(VIS.Events.onTouchStartOrClick),yt.children(".vas-column-list-item").on(VIS.Events.onTouchStartOrClick,function(){var e=t(this).attr("value");At.val(e),yt.children(".vas-column-list-item").removeClass("vas-selected-filterVal"),t(this).addClass("vas-selected-filterVal")}),It.find("input").off("keyup"),It.find("input").on("keyup",function(){var e=t(this).val(),a=qe.children(".vas-filterValItem");if(e.length>1){var i=a.attr("tablename"),n=a.attr("isNameExist"),l=ca(g,i,d,e,n,u,v);if(l&&l.length>0){var s="";qe.empty();for(var o=0;o<l.length;o++)l[o].Value&&(s+='<div class="vas-filterValItem" isNameExist="'+l[o].isNameExist+'" DBColumnName="'+g+'" tableName="'+l[o].tableName+'" value="'+l[o].Value+'">'+l[o].Name+"</div>");return qe.append(s),(a=qe.children(".vas-filterValItem")).off(VIS.Events.onTouchStartOrClick),a.on(VIS.Events.onTouchStartOrClick,function(){qe.find(".vas-filterValItem").removeClass("vas-selected-filterVal"),t(this).addClass("vas-selected-filterVal");var e=t(this).text();It.find("input").val(e)}),void qe.show()}}var r=a.length;a.removeClass("vas-selected-filterVal"),r>0?(qe.show(),a.filter(function(){t(this).toggle(t(this).text().toLowerCase().indexOf(e)>-1)})):qe.hide(),a.is(":visible")||qe.hide()}),et.css("pointer-events","all"),Ye.removeClass("vas-checkboxoption-hidden"),Ye.removeClass("vas-remove-isnulloption"),Ye.removeClass("vas-add-isnulloption"),Ye.removeClass("vas-remove-likeoption"),Ye.removeClass("vas-comparision-opeartor"),Ye.removeClass("vas-disabled-icon"),d==VIS.DisplayType.Date||d==VIS.DisplayType.DateTime)He.attr("type","date"),He.prev("label").removeClass("vas-label-space"),Ye.addClass("vas-add-isnulloption"),Ye.addClass("vas-remove-likeoption"),Ye.addClass("vas-comparision-opeartor"),St.hide(),je.show(),Ut.show(),c.prop("readonly",!0),s.prop("disabled",!1),l.prop("disabled",!0),n.on("change",'input[type="checkbox"]',function(){t(this).is(":checked")?(je.find("input").prop("disabled",!0),et.css("pointer-events","none")):(je.find("input").prop("disabled",!1),et.css("pointer-events","all"))}),je.on("change",'input[type="date"]',function(){t(this).val()?Ut.find('input[type="checkbox"]').attr("disabled",!0):Ut.find('input[type="checkbox"]').removeAttr("disabled")});else if(VIS.DisplayType.IsLookup(d)){He.attr("type","number"),He.prev("label").removeClass("vas-label-space"),Ye.addClass("vas-remove-likeoption");var D=ca(g,p,d,null,!1,u,v);if(D&&D.length>0){qe.empty(),o="";for(_=0;_<D.length;_++)D[_].Value&&(o+='<div class="vas-filterValItem" isNameExist="'+D[_].isNameExist+'" DBColumnName="'+g+'" tableName="'+D[_].tableName+'" value="'+D[_].Value+'">'+D[_].Name+"</div>");qe.append(o)}}else d==VIS.DisplayType.Integer||d==VIS.DisplayType.Amount||d==VIS.DisplayType.ID?(He.attr("type","number"),He.prev("label").removeClass("vas-label-space"),Ye.addClass("vas-remove-likeoption")):d==VIS.DisplayType.String||VIS.DisplayType.List==d||VIS.DisplayType.Text==d||VIS.DisplayType.TextLong==d?(He.attr("type","textbox"),He.prev("label").removeClass("vas-label-space"),Ye.addClass("vas-add-likeoption"),Ye.addClass("vas-add-isnulloption")):d==VIS.DisplayType.YesNo?(He.attr("type","checkbox"),He.prev("label").addClass("vas-label-space"),Ye.addClass("vas-checkboxoption-hidden"),Ye.addClass("vas-remove-isnulloption"),St.hide(),je.show()):(He.attr("type","textbox"),He.prev("label").removeClass("vas-label-space"));qe.find(".vas-filterValItem").off(VIS.Events.onTouchStartOrClick),qe.find(".vas-filterValItem").on(VIS.Events.onTouchStartOrClick,function(){qe.find(".vas-filterValItem").removeClass("vas-selected-filterVal"),t(this).addClass("vas-selected-filterVal");var e=t(this).attr("value");It.find("input").val(t(this).text()),It.find("input").attr("columnId",e)})}function ca(e,a,i,n,l,s,o){var r=null;return t.ajax({url:VIS.Application.contextUrl+"AlertSQLGenerate/GetIdsName",type:"POST",async:!1,data:{columnName:e,tableName:a,displayType:i,whereClause:n,isNameExist:l,columnID:s,refrenceValueID:o,windowNo:b.windowNo},success:function(e){(e=JSON.parse(e))&&e.length>0&&(r=e)},error:function(e){console.log(e)}}),r}function ua(){b.BasedOn="",V.text(""),e=0,N=0,B="",L=0,Oe.text(""),i=[],be.empty(),$=!0,Be.empty(),t(".vas-filter-item").remove(),M=null,J=-1,F=-1,Qt=[],Ft=[],kt.empty(),yt.empty(),he.addClass("vis-ev-col-mandatory"),ia(0,0),na(0,0),_t.find("i").removeClass("vas-showAnotherColControl"),je.show(),St.hide(),Vt.hide(),qe.hide(),qe.empty(),Me.css("pointer-events","none"),Fe.css("pointer-events","none"),vt.css("pointer-events","none"),Pe.hide(),Pe.children(".vas-column-list-item").find('input[type="checkbox"]').prop("checked",!1),t(".vas-column-checkbox").prop("checked",!1),ot.val(""),rt.val(""),fe.getControl().addClass("vis-ev-col-mandatory"),gt.addClass("vis-ev-col-mandatory"),it.css("pointer-events","all"),se.val(VIS.Msg.getMsg("VAS_AddFilter")),vt.removeClass("active"),Me.removeClass("active"),Fe.removeClass("active"),Re.empty(),la(0,0),Oe.show(),K.hide(),Rt.hide(),ne.hide(),te.val(Gt),X.hide(),Ut.hide(),Q=!0,fe.setValue(null),U=[],E=[],j=[],R=null,He.attr("type","Textbox"),He.val(""),ve=[],ut.val(""),dt.val(""),ke.empty(),Ge.empty(),It.find("input").val(""),At.val(""),q="",pagingPlusBtnDiv.addClass("d-none"),pagingPlusBtnDiv.removeClass("d-flex justify-content-between align-items-center"),z=[],ue=-1}this.init=function(){$sqlBtn=t("<input class='VIS_Pref_btn-2 vas-sql-btn' id='vas-sql-btn"+b.windowNo+"' type='button' value='"+VIS.Msg.getMsg("VAS_SQL")+"'>"),ee=t("<input class='VIS_Pref_btn-2 vas-sql-generator' id='vas-sql-generatorbtn"+b.windowNo+"' type='button' value='"+VIS.Msg.getMsg("VAS_SQLGenerator")+"'>"),te=t("<input style='display: none;' class='VIS_Pref_btn-2 vas-test-sql vas-test-sqlgenerator' id='vas-testsql-generatorbtn"+b.windowNo+"' type='button' value='"+VIS.Msg.getMsg("VAS_TestSql")+"'>"),ae=t("<input class='VIS_Pref_btn-2 vas-test-sql' id='vas-testsql-btn"+b.windowNo+"' type='button' value='"+VIS.Msg.getMsg("VAS_TestSql")+"'>"),ie=t("<input class='VIS_Pref_btn-2 vas-save-btn' type='button' id='vas-save-btn"+b.windowNo+"' value='"+VIS.Msg.getMsg("VAS_Save")+"'>"),ne=t("<input class='VIS_Pref_btn-2 vas-save-btn mt-0' id='vas-savegenerator-btn"+b.windowNo+"' type='button' value='"+VIS.Msg.getMsg("VAS_Save")+"'>"),pagingDiv=t('<div><ul class="vis-ad-w-p-s-plst"><li style="opacity: 0.6;"><div><i class="vis vis-pageup" id="VAS_pageUp'+b.windowNo+'"></i></div></li><li><select class="vis-statusbar-combo" id= "VAS_dropDownSelect'+b.windowNo+'"><option>1</option></select></li><li style="opacity: 0.6;"><div><i class="vis vis-pagedown"  id= "VAS_pageDown'+b.windowNo+'"></i></div></li></ul><div>'),pagingPlusBtnDiv=t('<div class="VAS-pagingDiv d-none">'),le=t("<input class='VIS_Pref_btn-2 vas-add-join-btn' id='vas-addjoin-btn"+b.windowNo+"' type='button' value='"+VIS.Msg.getMsg("VAS_AddJoin")+"'>"),se=t("<input class='VIS_Pref_btn-2 vas-add-btn' id='vas-addfilter-btn"+b.windowNo+"' type='button' value='"+VIS.Msg.getMsg("VAS_AddFilter")+"'>"),oe=t("<input class='VIS_Pref_btn-2 vas-add-btn' id='vas-addsort-btn"+b.windowNo+"' type='button' value='"+VIS.Msg.getMsg("VAS_AddSort")+"'>"),Lt=t("<div class='vas-sqlgenerator' id='vas-sqlgeneratorcontent"+b.windowNo+"' style='display: none;'><div class='vas-sqlgenerator-column vas-sqlgenerator-column1'></div><div class='vas-sqlgenerator-column vas-sqlgenerator-column2'></div></div>"),Ue=t("<select class='vas-joins-collection'><option>INNER JOIN</option><option>LEFT OUTER JOIN</option><option>RIGHT OUTER JOIN</option><option>FULL JOIN</option></select>"),ke=t("<div class='vas-single-selection-dropdown'>"),Ge=t("<div class='vas-single-selection-dropdown'>"),Xe=t("<select><option>AND</option><option>OR</option></select>"),tt=t("<select><option>ASC</option><option>DESC</option></select>"),n=Ut.find("#currentDate"),l=Ut.find("#drpDynamicOp"),s=Ut.find("#chkDynamic"),o=Ut.find("#txtYear"),r=Ut.find("#txtMonth"),c=Ut.find("#txtDay"),divDay=Ut.find("#divDay"),divMonth=Ut.find("#divMonth"),divYear=Ut.find("#divYear"),Pt.append(ee).append($sqlBtn).append(X).append(ae).append(te),Se.text(VIS.Msg.getMsg("VAS_SQLQuery")),Oe.attr("disabled",!0),Wt.append(Pt).append(bt).append(H).append(K),$t.append(Wt).append(Jt),bt.append(xt).append(Lt).append(Mt),Nt.append(H),Rt.append(K),Lt.find(".vas-sqlgenerator-column1").append(xe),xe.append(_e).append(Te).append(Me).append(Ne).append(Fe).append(We).append(vt).append(ft),_e.append(De),Te.append(Ke),Ke.append(gt),Ke.append(Ae),Te.append(he).append(Pe),Ne.append(Ve).append(Ze).append(Ce).append(Z).append(Ue).append(Ot).append(ke).append(Tt).append(Ge).append(le).append(be),Ve.append(Re),Ze.append(pt),Ze.append(me),Je.append(Ye),je.append(He),We.append($e).append(Ct).append(ze).append(Je).append(_t).append(yt).append(qe).append(Qe).append(Ee),Qe.append(Xe).append(se),ft.append(ht).append(Dt).append(wt).append(kt),ht.append(ot).append(at),Ct.append(rt).append(it),St.append(It),_t.append(et).append(je).append(St).append(Vt).append(Ut),Vt.append(At).append(mt),It.append(ct).append(nt),Ot.append(ut).append(lt),Tt.append(dt).append(st),wt.append(tt).append(oe),xt.append(ye).append(Nt),xt.append('<div id="emailContent_'+b.windowNo+'" class="vas-alert-emailmsg VIS_Pref_show vis-formouterwrpdiv"><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="Is_Email_'+b.windowNo+'"></div></div><div class= "VIS_Pref_dd"><div style="display:none;" class="input-group vis-input-wrap" id="EmailColName_'+b.windowNo+'"></div></div></div>'),Jt.append('<div class="vas-windowtab"><label>'+VIS.Msg.getMsg("VAS_WindowTab")+'</label><div id="WindowTab_'+b.windowNo+'"  class="VIS-AMTD-formData VIS-AMTD-InputBtns input-group vas-input-wrap"></div></div><div id="CRUDContent_'+b.windowNo+'" class="vas-alert-emailmsg VIS_Pref_show vis-formouterwrpdiv"><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="Is_Insert_'+b.windowNo+'"></div></div><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="IsUpdate_'+b.windowNo+'"></div></div><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="IsDelete_'+b.windowNo+'"></div></div></div><div style="display:none;" class="VAS-Alert-window-column" id="updateColumn_'+b.windowNo+'"><div class= "vas-windowtab"><label>'+VIS.Msg.getMsg("VAS_FieldColumn")+'</label><div id="FieldColumn_'+b.windowNo+'"  class="VIS-AMTD-formData VIS-AMTD-InputBtns input-group vas-input-wrap"></div></div></div><div class="vis-ctrfrm-btnwrp"><input id="okBtn_'+b.windowNo+'" class="VIS_Pref_btn-2" type="button" value="'+VIS.Msg.getMsg("OK")+'"><div class="vis-ad-w-p-s-main pull-left"><div class="vis-ad-w-p-s-infoline"></div><div class="vis-ad-w-p-s-msg" style="align-items:flex-end;" id="lblBottomMsg_'+b.windowNo+'"></div></div></div>'),(Bt=t('<div class="vis-busyindicatorouterwrap" style="visibility: hidden;"></div>')).append(t('<div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div>')),jt(!1),$t.append(Bt),m=xt.find("#Is_Email_"+b.windowNo),f=xt.find("#EmailColName_"+b.windowNo),C=xt.find("#emailContent_"+b.windowNo);var e=t('<div class="vis-control-wrap">'),N=t('<div class="vis-control-wrap">'),G=t('<div class="vis-control-wrap">'),re=t('<div class="vis-control-wrap">'),ce=t('<div class="vis-control-wrap">');S=Jt.find("#Is_Insert_"+b.windowNo),I=Jt.find("#IsUpdate_"+b.windowNo),y=Jt.find("#IsDelete_"+b.windowNo),Jt.find("#CRUDContent_"+b.windowNo),O=Jt.find("#updateColumn_"+b.windowNo),p=Jt.find("#WindowTab_"+b.windowNo),v=Jt.find("#FieldColumn_"+b.windowNo),_=Jt.find("#okBtn_"+b.windowNo),V=Jt.find("#lblBottomMsg_"+b.windowNo),Lt.find(".vas-sqlgenerator-column2").append(Se.append(Ie)).append(Oe).append(K),D=new VIS.Controls.VCheckBox("IsEmail",!1,!1,!0,VIS.Msg.getMsg("VAS_SendMail"),null,!1),m.append(e),e.append(D.getControl().addClass("vis-ec-col-lblchkbox")),h=new VIS.Controls.VTextBox("EMail",!0,!1,!0),f.append(N),N.append(h.getControl().attr("title",VIS.Msg.getMsg("VAS_TypeEmailColumn")).attr("placeholder"," ").attr("data-placeholder","").attr("autocomplete","off")).append("<label>"+VIS.Msg.getMsg("VAS_EmailColumn")+"</label>"),u=new VIS.Controls.VCheckBox("IsInsert",!1,!1,!0,VIS.Msg.getMsg("VAS_OnInsert"),null,!1),S.append(G),G.append(u.getControl().addClass("vis-ec-col-lblchkbox")),d=new VIS.Controls.VCheckBox("IsUpdate",!1,!1,!0,VIS.Msg.getMsg("VAS_OnUpdate"),null,!1),I.append(re),re.append(d.getControl().addClass("vis-ec-col-lblchkbox")),g=new VIS.Controls.VCheckBox("IsDeleted",!1,!1,!0,VIS.Msg.getMsg("VAS_OnDelete"),null,!1),y.append(ce),ce.append(g.getControl().addClass("vis-ec-col-lblchkbox"));var pe=new VIS.MLookupFactory.get(VIS.Env.getCtx(),b.windowNo,0,VIS.DisplayType.Search,"AD_Tab_ID",0,!1,"AD_Tab.AD_Window_ID IN (SELECT AD_Window_ID FROM AD_Window_Access WHERE AD_Role_ID = "+VIS.Env.getCtx().getAD_Role_ID()+")"),we=(T=new VIS.Controls.VTextBoxButton("AD_Tab_ID",!0,!1,!0,VIS.DisplayType.Search,pe)).getControl().attr("placeholder"," Search here").attr("id","Ad_Table_ID").css("width","100%").css("height","100%"),Xt=t('<div class="vas-control-wrap">'),ia=t('<div class="input-group-append">');p.css("width","100%"),p.append(Xt).append(ia),Xt.append(we),ia.append(T.getBtn(0)),ia.append(T.getBtn(1)),T.setCustomInfo("VAS_AlertSQLGenerator"),T.getControl().addClass("vis-ev-col-mandatory");var ca=new VIS.MLookupFactory.get(VIS.Env.getCtx(),b.windowNo,0,VIS.DisplayType.MultiKey,"AD_Column_ID",0,!1,"");we=(w=new VIS.Controls.VTextBoxButton("AD_Column_ID",!0,!1,!0,VIS.DisplayType.MultiKey,ca)).getControl().attr("placeholder"," Search here").attr("id","AD_Column_ID").css("width","100%").css("height","100%"),Xt=t('<div class="vas-control-wrap">'),ia=t('<div class="input-group-append">');v.css("width","100%"),v.append(Xt).append(ia),Xt.append(we),ia.append(w.getBtn(0)),ia.append(w.getBtn(1)),w.setCustomInfo("VAS_AlertFieldColumn"),w.getControl().addClass("vis-ev-col-mandatory"),Ye.val(""),gt.on("keyup",function(){var e=t(this).val().toLowerCase(),a=Pe.children(".vas-column-list-item");a.length>0?(Pe.show(),a.filter(function(){t(this).toggle(t(this).text().toLowerCase().indexOf(e)>-1)})):Pe.hide(),a.is(":visible")||Pe.hide()}),s.on("change",function(){var e=s.prop("checked");l.prop("disabled",!e),e?(qt(),Ye.val(">="),Ye.addClass("vas-disabled-icon")):(Ye.removeClass("vas-disabled-icon"),divYear.hide(),divMonth.hide(),divDay.hide())}),l.on("change",function(){qt()}),Vt.find("input").on("keyup",function(){var e=t(this).val().toLowerCase(),a=yt.children(".vas-column-list-item");a.length>0?(yt.show(),a.filter(function(){t(this).toggle(t(this).text().toLowerCase().indexOf(e)>-1)})):yt.hide(),a.is(":visible")||yt.hide()}),_t.find(et).off(VIS.Events.onTouchStartOrClick),_t.find(et).on(VIS.Events.onTouchStartOrClick,function(){if(yt.hide(),""!=t(this).parents(".vas-add-label-content").find('input[type="textbox"]').val())if(Vt.toggle(),"none"!=Vt.css("display"))St.hide(),je.hide(),Ye.removeClass("vas-checkboxoption-hidden"),Ye.removeClass("vas-remove-isnulloption"),Ye.removeClass("vas-add-isnulloption"),Ye.removeClass("vas-remove-likeoption"),Ye.addClass("vas-comparision-opeartor"),Ut.hide(),rt.attr("datatype",13);else{var e=Ct.find("input").attr("columnid");ze.find(".vas-column-list-item[columnid="+e+"]").trigger("click");var a=Ct.find("input").attr("datatype");a==VIS.DisplayType.Date||a==VIS.DisplayType.DateTime?(Ut.show(),ze.find(".vas-column-list-item.active").trigger("click")):Ut.hide()}}),pt.on("keyup",function(){var e=t(this).val().toLowerCase(),a=Z.children(".vas-column-list-item");a.length>0&&(Z.show(),a.filter(function(){t(this).toggle(t(this).text().toLowerCase().indexOf(e)>-1)})),a.is(":visible")||Z.hide()}),ot.on("keyup",function(){var e=t(this).val().toLowerCase(),a=Dt.children(".vas-column-list-item");a.length>0&&(Dt.show(),a.filter(function(){t(this).toggle(t(this).text().toLowerCase().indexOf(e)>-1)})),a.is(":visible")?a.on(VIS.Events.onTouchStartOrClick,function(){let e=t(this).attr("value");t(this).parent(Dt).prev(ht).find(ot).val(e),function(e,t){let a=e.attr("value");e.parent(Dt).prev(ht).find(ot).val(a),t.removeClass("active"),e.addClass("active");var i=Dt.children(".vas-column-list-item.active").attr("datatype");e.parent(Dt).prev(ht).find(ot).attr("sortdatatype",i);var n=Dt.children(".vas-column-list-item.active").attr("columnID");e.parent(Dt).prev(ht).find(ot).attr("sortcolumnID",n);var l=Dt.children(".vas-column-list-item.active").attr("DBColumnName");e.parent(Dt).prev(ht).find(ot).attr("sortDBColumnName",l);var s=Dt.children(".vas-column-list-item.active").attr("refValId");e.parent(Dt).prev(ht).find(ot).attr("sortrefValId",s);var o=Dt.children(".vas-column-list-item.active").attr("isParent");e.parent(Dt).prev(ht).find(ot).attr("sortisParent",o);var r=Dt.children(".vas-column-list-item.active").attr("TableName");e.parent(Dt).prev(ht).find(ot).attr("sortTableName",r)}(t(this),a),Dt.hide()}):Dt.hide()}),Ye.on("change",function(){"IS NULL"==Ye.val()?(St.find("input").prop("disabled",!0),je.find("input").prop("disabled",!0),St.find(".vas-arrow-down").css("pointer-events","none")):"LIKE"==Ye.val()?(je.find("input").prop("disabled",!1),je.show(),St.hide()):(St.find("input").prop("disabled",!1),je.find("input").prop("disabled",!1),St.find(".vas-arrow-down").css("pointer-events","all"))}),rt.off("keyup"),rt.on("keyup",function(){var e=t(this).val().toLowerCase(),a=ze.children(".vas-column-list-item");a.length>0&&(ze.show(),a.filter(function(){t(this).toggle(t(this).text().toLowerCase().indexOf(e)>-1)})),a.is(":visible")?(a.off(VIS.Events.onTouchStartOrClick),a.on(VIS.Events.onTouchStartOrClick,function(){ra(t(this),a)})):ze.hide()}),ut.on("keyup",function(){var e=t(this).val().toLowerCase(),a=ke.children(".vas-column-list-item");a.length>0&&(ke.show(),a.filter(function(){t(this).toggle(t(this).text().toLowerCase().indexOf(e)>-1)})),a.is(":visible")?a.on(VIS.Events.onTouchStartOrClick,function(){let e=t(this).attr("value");t(this).parent(ze).prev(Ot).find(ut).val(e),a.removeClass("active"),t(this).addClass("active");var i=ke.children(".vas-column-list-item.active").attr("datatype");t(this).parent(ke).prev(Ot).find(ut).attr("datatype",i),ke.hide()}):ke.hide()}),dt.on("keyup",function(){var e=t(this).val().toLowerCase(),a=Ge.children(".vas-column-list-item");a.length>0&&(Ge.show(),a.filter(function(){t(this).toggle(t(this).text().toLowerCase().indexOf(e)>-1)})),a.is(":visible")?a.on(VIS.Events.onTouchStartOrClick,function(){let e=t(this).attr("value");t(this).parent(Ge).prev(Tt).find(dt).val(e),a.removeClass("active"),t(this).addClass("active");var i=Ge.children(".vas-column-list-item.active").attr("datatype");t(this).parent(Ge).prev(Tt).find(dt).attr("datatype",i),Ge.hide()}):Ge.hide()}),ae.on(VIS.Events.onTouchStartOrClick,function(){if(ye&&ye.text().length>0){if($sqlBtn.hasClass("active"))if(t(this).toggleClass("vas-show-grid"),t(this).hasClass("vas-show-grid")){t(this).val(Et),xt.append(ie),xt.find(ie).show(),xt.addClass("vas-grid-height");var e=ye.text(),a=e.match(/\bFROM\b\s+([a-zA-Z0-9_."]+)/);a&&a[1]?(B=a[1].replace(/"/g,""),oa(e)):VIS.ADialog.error("","",VIS.Msg.getMsg("No table found"))}else t(this).val(Gt),Nt.hide(),Y.show(),ye.show(),C.show(),xt.find(ie).hide(),X.hide(),xt.removeClass("vas-grid-height")}else X.text(VIS.Msg.getMsg("VAS_WriteQuery")),X.addClass("vas-sql-result-error"),X.show()}),te.on(VIS.Events.onTouchStartOrClick,function(){var e=Lt.find(".vas-sqlgenerator-column2"),a=e.find(ne);""!=Oe.text()?ee.hasClass("active")&&(t(this).toggleClass("vas-show-grid"),t(this).hasClass("vas-show-grid")?(t(this).val(Et),Oe.hide(),K.show(),Rt.show(),e.append(pagingPlusBtnDiv),pagingPlusBtnDiv.append(pagingDiv).append(ne),e.find(ne).show(),oa(Oe.text()),P=$t.find("#VAS_pageUp"+b.windowNo),de=$t.find("#VAS_pageDown"+b.windowNo),P.addClass("VA107-disablePage"),P.parents("li").css("pointer-events","none"),P.off(VIS.Events.onTouchStartOrClick),P.on(VIS.Events.onTouchStartOrClick,function(){if((x=pagingDiv.find("select").val()-1)<=1){if(P.css("opacity","0.6"),de.removeClass("VA107-disablePage"),de.css("opacity","1"),x<1)return}else x>1&&(P.removeClass("VA107-disablePage"),P.parents("li").css("pointer-events","all"),de.removeClass("VA107-disablePage"),P.css("opacity","1"),de.css("opacity","1"));pagingDiv.find("select").val(x),oa(Oe.text())}),de.off(VIS.Events.onTouchStartOrClick),de.on(VIS.Events.onTouchStartOrClick,function(){(x=parseInt(pagingDiv.find("select").val())+1,P.removeClass("VA107-disablePage"),P.parents("li").css("pointer-events","all"),P.css("opacity","1"),x>=ge&&(de.addClass("VA107-disablePage"),de.css("opacity","0.6"),x>ge))||(pagingDiv.find("select").val(x),oa(Oe.text()))})):(t(this).val(Gt),Oe.show(),K.hide(),Rt.hide(),a.hide(),X.hide(),pagingPlusBtnDiv.addClass("d-none"),pagingPlusBtnDiv.removeClass("d-flex justify-content-between align-items-center"))):(X.show(),X.text(VIS.Msg.getMsg("VAS_DisplayQuery")),X.addClass("vas-sql-result-error"));gt.val(""),pt.val("")}),pagingDiv.find("select").on("change",function(){(x=parseInt(t(this).val()))>=ge?(de.css("opacity","0.6"),de.addClass("VA107-disablePage"),P.css("opacity","1"),P.removeClass("VA107-disablePage")):(de.css("opacity","1"),de.removeClass("VA107-disablePage")),x<=1?(P.css("opacity","0.6"),P.addClass("VA107-disablePage"),de.css("opacity","1"),de.removeClass("VA107-disablePage")):(P.css("opacity","1"),P.removeClass("VA107-disablePage")),oa(Oe.text())}),Ae.on(VIS.Events.onTouchStartOrClick,function(){let e=Pe.children(".vas-column-list-item").length,t=Pe.children(".vas-column-list-item");e>0&&(Pe.toggle(),Pe.toggleClass("vas-open-col"),t.show()),t.is(":visible")||(gt.val(""),Pe.hide())}),at.on(VIS.Events.onTouchStartOrClick,function(){let e=Dt.children(".vas-column-list-item").length,a=Dt.children(".vas-column-list-item");e>0&&("none"===Dt.css("display")?Dt.css({display:"flex","flex-wrap":"wrap"}):Dt.css("display","none"),a.show()),a.is(":visible")?a.on(VIS.Events.onTouchStartOrClick,function(){let e=t(this).attr("value");t(this).parent(Dt).prev(ht).find(ot).val(e),Dt.hide()}):Dt.hide()}),lt.on(VIS.Events.onTouchStartOrClick,function(){let e=ke.children(".vas-column-list-item").length,a=ke.children(".vas-column-list-item");e>0&&(ke.toggle(),a.show()),a.is(":visible")?a.on(VIS.Events.onTouchStartOrClick,function(){let e=t(this).attr("value");t(this).parent(ke).prev(Ot).find(ut).val(e),ke.hide()}):ke.hide()}),st.on(VIS.Events.onTouchStartOrClick,function(){let e=Ge.children(".vas-column-list-item").length,a=Ge.children(".vas-column-list-item");e>0&&("none"===Ge.css("display")?Ge.css({display:"flex","flex-wrap":"wrap",float:"none"}):Ge.css("display","none"),a.show()),a.is(":visible")?a.on(VIS.Events.onTouchStartOrClick,function(){let e=t(this).attr("value");t(this).parent(Ge).prev(Tt).find(dt).val(e),Ge.hide()}):Ge.hide()}),it.off(VIS.Events.onTouchStartOrClick),it.on(VIS.Events.onTouchStartOrClick,function(){var e=ze.children(".vas-column-list-item");let a=ze.children(".vas-column-list-item");e.length>0&&(ze.toggle(),a.show()),a.is(":visible")?(a.off(VIS.Events.onTouchStartOrClick),a.on(VIS.Events.onTouchStartOrClick,function(){ra(t(this),e)})):ze.hide()}),mt.on(VIS.Events.onTouchStartOrClick,function(){var e=yt.children(".vas-column-list-item");let t=yt.children(".vas-column-list-item");e.length>0&&(yt.toggle(),t.show()),t.is(":visible")||yt.hide()}),nt.on(VIS.Events.onTouchStartOrClick,function(){var e=qe.children(".vas-filterValItem");t(this).toggleClass("vas-showFilterVal"),e.length>0&&(qe.toggle(),t(this).hasClass("vas-showFilterVal")||e.removeClass("vas-selected-filterVal")),e.is(":visible")||qe.hide()}),me.on(VIS.Events.onTouchStartOrClick,function(){let e=Z.children(".vas-column-list-item").length,t=Z.children(".vas-column-list-item");e>0&&(Z.toggle(),t.show()),t.is(":visible")||(pt.val(""),Z.hide())});let da=[];function ga(){for(var e="",t=0;t<da.length;t++){var a=da[t],i=a.dataType,n=a.filterValue;e+='<div class="vas-filter-item" value="'+a.filterVal+'" colVersion="'+a.columnVersion+'" dataType="'+i+'" filterId="'+n+'" index="'+t+'">',e+='<div class="vas-filter-whitebg" style="background-color:'+va()+'">',e+='<div class="vas-filters-block">',e+='<div class="vas-filter-andor-value" style="display:none;">'+a.filterAndOrValue+"</div>",e+='<div class="vas-filter-whereExit" style="display:none;">'+a.whereExist+"</div>",e+='<div class="vas-filter-datatype" style="display:none;">'+i+"</div>",e+='<div class="vas-filter-isDynamic" style="display:none;">'+a.chkDynamic+"</div>",e+='<div class="vas-filter-day" style="display:none;">'+a.day+"</div>",e+='<div class="vas-filter-month" style="display:none;">'+a.month+"</div>",e+='<div class="vas-filter-year" style="display:none;">'+a.year+"</div>",e+='<div class="vas-filter-dynamicIndex" style="display:none;">'+a.dynamicIndex+"</div>",VIS.DisplayType.Date!=i&&VIS.DisplayType.DateTime!=i||"N"!=a.chkDynamic?e+='<div class="vas-selecttable" title="'+a.filterVal+'">'+a.filterVal+"</div>":e+='<div class="vas-selecttable" title="TO_CHAR('+a.filterVal+", 'yyyy-mm-dd')\"> TO_CHAR("+a.filterVal+", 'yyyy-mm-dd')</div>",e+='<span class="vas-filter-condition"> '+a.filterCondition+" </span>","IS NULL"==a.filterCondition||"IS NOT NULL"==a.filterCondition?e+='<span class="vas-filter-price-value"></span>':VIS.DisplayType.String==i||VIS.DisplayType.YesNo==i||VIS.DisplayType.List==i||VIS.DisplayType.Text==i||VIS.DisplayType.TextLong==i?e+='<span class="vas-filter-price-value">\''+n+"'</span>":e+='<span class="vas-filter-price-value">'+n+"</span>",e+="</div>",e+='<div class="vas-filters-editdelete-btns">',e+='<div><i class="vis vis-edit"></i></div>',e+='<div><i class="vis vis-delete"></i></div>',e+="</div>",e+="</div>",e+="</div>"}Be.append(e)}function pa(){var e=t(event.target).parents(".vas-filter-item"),a=e.find(".vas-filter-price-value").text(),i=e.find(".vas-filter-condition").text(),n=e.find(".vas-filter-andor-value").text(),l=e.find(".vas-filter-datatype").text(),s=e.find(".vas-selecttable").text();if(F=t(event.target).parents(".vas-filter-item").attr("index"),l==VIS.DisplayType.Date||l==VIS.DisplayType.DateTime?(He.attr("type","date"),He.prev("label").removeClass("vas-label-space")):l==VIS.DisplayType.Integer||l==VIS.DisplayType.ID||l==VIS.DisplayType.Amount?(He.attr("type","number"),He.prev("label").removeClass("vas-label-space")):l==VIS.DisplayType.YesNo?(He.attr("type","checkbox"),He.prev("label").addClass("vas-label-space")):(He.attr("type","textbox"),He.prev("label").removeClass("vas-label-space")),0==F)var o=s+" "+i+" "+a;else o=n+" "+s+" "+i+" "+a;o=o.replace(/\s{2,}/g," "),Ee.text(o),J=e.attr("index")}function va(){return"hsl("+Math.floor(360*Math.random())+", 100%, "+(Math.floor(16*Math.random())+75)+"%)"}function _a(){kt.empty(),z.forEach(function(e,t){kt.append('<div class="VAS-sortedItem d-flex justify-content-between" data-index='+t+' style="background-color: '+va()+'"><div>'+e.column+" "+e.direction+'</div><div class="vas-sortcolval d-none">'+e.reqSortVal+'</div><div class="vas-sortColumnName d-none">'+e.column+'</div><div class="vas-sortDirection d-none">'+e.direction+'</div><div class="vas-sort-datatype d-none">'+e.sortdatatype+'</div><div class="vas-sort-columnID d-none">'+e.sortcolumnID+'</div><div class="vas-sort-DBColumName d-none">'+e.sortDBColumnName+'</div><div class="vas-sort-refValId d-none">'+e.sortrefValId+'</div><div class="vas-sort-isParent d-none">'+e.sortisParent+'</div><div class="vas-sort-TableName d-none">'+e.sortTableName+'</div><div class="vas-sortBtns"><i class="vis vis-edit" data-index="'+t+'"></i><i class="vis vis-delete" data-index="'+t+'"></i></div></div>')}),kt.find(".vas-sortBtns i.vis-delete").off(VIS.Events.onTouchStartOrClick).on(VIS.Events.onTouchStartOrClick,function(){var e=parseInt(t(this).data("index"));z.splice(e,1),_a(),Va()}),kt.find(".vas-sortBtns i.vis-edit").off(VIS.Events.onTouchStartOrClick).on(VIS.Events.onTouchStartOrClick,function(){var e=t(this).closest(".VAS-sortedItem");ue=parseInt(e.data("index")),e.addClass("active").siblings().removeClass("active"),ot.val(e.find(".vas-sortcolval").text()),tt.val(e.find(".vas-sortDirection").text()),ot.attr("sortdatatype",e.find(".vas-sort-datatype").text()),ot.attr("sortcolumnID",e.find(".vas-sort-columnID").text()),ot.attr("sortDBColumnName",e.find(".vas-sort-DBColumName").text()),ot.attr("sortrefValId",e.find(".vas-sort-refValId").text()),ot.attr("sortisParent",e.find(".vas-sort-isParent").text()),ot.attr("sortTableName",e.find(".vas-sort-TableName").text()),oe.val(VIS.Msg.getMsg("VAS_UpdateSort")).addClass("vas-edit-sort")})}function Va(){var e=Oe.text().replace(/ORDER BY[\s\S]*$/i,"").trim();z.length>0&&(e+=" ORDER BY "+z.map(function(e){return"LOWER(TRIM("+e.column+")) "+e.direction}).join(", "));Oe.text(e)}function Aa(e){$sqlBtn.removeClass("active"),ee.removeClass("active"),t(e).addClass("active")}Be.on(VIS.Events.onTouchStartOrClick,function(e){var a=t(e.target).parents(".vas-filter-item");if(t(e.target).hasClass("vis-delete")&&(Yt(),da.splice(a.index(),1),a.remove(),t(".vas-filters .vas-filter-item").length<2&&t(".vas-filters .vas-filter-item").removeClass("vas-first-delete-icon"),Be.empty(),ga(),Be&&Be.length>0&&Be.find(".vas-filter-item").addClass("vas-filters-row"),X.hide()),t(e.target).hasClass("vis-edit")){se.val(VIS.Msg.getMsg("VAS_UpdateFilter")),pa();var i=a.find(".vas-selecttable").text(),n=a.find(".vas-filter-price-value").text(),u=n.replace(/^'|'$/g,"");if(a.siblings().find(".vas-filter-condition").removeClass("active"),a.siblings().find(".vas-filter-price-value").removeClass("active"),a.siblings().find(".vas-filter-andor-value").removeClass("active"),a.siblings().find(".vas-filter-price-name").removeClass("active"),a.siblings().find(".vas-filter-isDynamic").removeClass("active"),a.siblings().find(".vas-filter-day").removeClass("active"),a.siblings().find(".vas-filter-month").removeClass("active"),a.siblings().find(".vas-filter-year").removeClass("active"),a.siblings().find(".vas-filter-dynamicIndex").removeClass("active"),a.siblings().find(".vas-selecttable").removeClass("active"),a.find(".vas-filter-condition").addClass("active"),a.find(".vas-filter-price-value").addClass("active"),a.find(".vas-filter-andor-value").addClass("active"),a.find(".vas-filter-price-name").addClass("active"),a.find(".vas-filter-isDynamic").addClass("active"),a.find(".vas-filter-day").addClass("active"),a.find(".vas-filter-month").addClass("active"),a.find(".vas-filter-year").addClass("active"),a.find(".vas-filter-dynamicIndex").addClass("active"),a.find(".vas-selecttable").addClass("active"),a.siblings().removeClass("active"),a.addClass("active"),15!=a.attr("datatype")&&16!=a.attr("datatype"))rt.val(i);else{var d=Be.children(".vas-filter-item.active").attr("value");rt.val(d)}var g=a.find(".vas-filter-condition.active").text().trim();Ye.val(g),He.val(u),"'Y'"==n&&He.prop("checked",!0),se.addClass("vas-edit-btn"),ze.children(".vas-column-list-item").each(function(){t(this).attr("value")===i&&t(this).trigger("click")});var p=da[a.index()];"Y"==p.chkDynamic?(s.prop("checked",!0),Ye.val(">="),Ye.addClass("vas-disabled-icon"),l.prop("disabled",!1),l.prop("selectedIndex",p.dynamicIndex),qt(),o.val(p.year),r.val(p.month),c.val(p.day)):ta(),X.hide();var v=a.attr("colversion"),_=a.find(".vas-filter-price-name.active").text(),V=a.find(".vas-filter-price-value.active").text(),A=ze.children(".vas-column-list-item.active").attr("datatype");if(12!=A&&29!=A&&22!=A&&47!=A||je.find("input").val(V),a.hasClass("active")){var m=a.find(".vas-filter-datatype").text();rt.attr("datatype",m)}"newColumn"==v?(t(".vas-select-col[data-input="+v+"]").parents(".vas-filterofMultipleCols").find(et).trigger("click"),At.val(V),At.attr("columnid",V)):"oldColumn"==v&&(_?ct.val(_):ct.val(V),ct.attr("columnid",V))}}),$sqlBtn.on(VIS.Events.onTouchStartOrClick,function(){X.hide(),xt.show(),ae.show(),te.hide(),Aa(this),Lt.hide(),a=!1,W=!0}),ee.on(VIS.Events.onTouchStartOrClick,function(){let e=bt.parents(".vis-ad-w-p-ap-tp-o-b-content").height();bt.parents(".vis-ad-w-p-ap-tp-o-b-content").css({height:e,"overflow-y":"auto"}),X.hide(),Rt.hide(),xt.hide(),te.show(),ae.hide(),Aa(this),Lt.show(),a=!0,W=!1}),ee.trigger("click"),Me.on(VIS.Events.onTouchStartOrClick,function(){t(this).siblings().removeClass("active"),t(this).toggleClass("active")}),Fe.on(VIS.Events.onTouchStartOrClick,function(){t(this).siblings().removeClass("active"),t(this).toggleClass("active")}),vt.on(VIS.Events.onTouchStartOrClick,function(){t(this).siblings().removeClass("active"),t(this).toggleClass("active")}),he.on(VIS.Events.onTouchStartOrClick,function(){Pe.children(".vas-column-list-item").length>0&&t(this).next().toggle()}),ie.on(VIS.Events.onTouchStartOrClick,function(){var e=ye.text().trim();(k=VIS.context.getContext(b.windowNo,"AD_Alert_ID"))>0&&sa(e)}),ne.on(VIS.Events.onTouchStartOrClick,function(){var e=Oe.text().trim();(k=VIS.context.getContext(b.windowNo,"AD_Alert_ID"))>0&&sa(e)}),se.on(VIS.Events.onTouchStartOrClick,function(e){var a=Ye.val(),i=rt.val(),n=He.val(),u=rt.attr("datatype");if("none"!=je.css("display")?(null!=M&&(n=M),VIS.DisplayType.Date!=u&&VIS.DisplayType.DateTime!=u||(!s.is(":checked")&&n.length>0&&(i+="TO_CHAR("+i+", 'yyyy-mm-dd')",n="'"+n+"'"),s.is(":checked")&&(n=zt(l[0].selectedIndex),a=Ye.val())),u==VIS.DisplayType.YesNo&&(n=He.is(":checked")?"'Y'":"'N'"),VIS.DisplayType.String!=u&&VIS.DisplayType.List!=u&&VIS.DisplayType.Text!=u&&VIS.DisplayType.TextLong!=u||(n="'"+n+"'")):"none"!=St.css("display")&&""!=St.find("input").val()?n=St.find("input").attr("columnid"):"none"!=Vt.css("display")&&(n=Vt.find("input").val(),u=13),""!=i&&""!=a&&null!=a&&n&&n.length>0){var d="";if(d=Q&&-1==Oe.text().indexOf("WHERE")?"WHERE":Xe.val(),t(this).hasClass("vas-edit-btn")){Be.empty();var g=Ye.find("option:selected").val();Be.find(".vas-filter-price-value.active").parents(".vas-filter-item").attr("filterId",n);var p=Xe.find("option:selected").val(),v=Ee.text(),_=Oe.text();c.prop("readonly",!0),r.prop("readonly",!0),o.prop("readonly",!0),s.prop("disabled",!0),l.prop("disabled",!0);var V=s.is(":checked")?"Y":"N";s.prop("disabled",!1);var A=ct.data("input");"none"!=Vt.css("display")&&(h=Vt.find("input").val(),A=Vt.find("input").data("input"));var m=rt.attr("datatype"),f=function(e,t,a,i,n,l){var s=t.indexOf("TO_CHAR("),o="",r="";-1!==s&&(r=t.indexOf(")",s)+1,o=t.slice(s,r));var c="",u=/(.+)TO_CHAR/,d=t.match(u);function g(e,t){return 17==t?"'"+e+"'":e}0==l&&15!=e&&16!=e?c=" "+t+" "+i+" "+g(a,e):null==d||15!=e&&16!=e?null!=d||15!=e&&16!=e?c=n+" "+t+" "+i+" "+g(a,e):l<1&&(c=" "+t+" "+i+" "+g(a,e)):c=l>=1?n+" "+o+" "+i+" "+g(a,e):" "+o+" "+i+" "+g(a,e);return c.replace(/\s{2,}/g," ")}(m,i,n,g,p,F);_=_.replace(v,f),Oe.text(_);var D=rt.attr("datatype"),h=ct.val(),C=i.match(/(.+)TO_CHAR/);J>-1&&da[J]&&"object"==typeof da[J]&&(da[J].filterCondition=g,da[J].columnVal=h,da[J].filterValue=n,da[J].filterVal=null==C||15!=m&&16!=m?i:C[1],da[J].columnVersion=A,da[J].dataType=D,da[J].filterAndOrValue=p,da[J].chkDynamic=V,s.is(":checked")?(da[J].isDynamic=!0,da[J].dynamicIndex=l[0].selectedIndex,da[J].year=o.val(),da[J].month=r.val(),da[J].day=c.val()):da[J].isDynamic=!1),t(this).removeClass("vas-edit-btn"),ea(),M=null,se.val(VIS.Msg.getMsg("VAS_AddFilter")),it.css("pointer-events","all"),ga()}else We.append(Be),function(e,t,a){var i=Oe.text(),n=i.indexOf("ORDER BY"),o="",r=rt.val(),c=t,u=Ye.val();if(null!=r){var d=r.slice(r.indexOf(":")+1);""!=i&&""!=d&&""!=u&&(-1==n?(null!=M&&(c=M),i+=" "+e,"IS NULL"==u||"IS NOT NULL"==u?i+=" "+d+" "+u:VIS.DisplayType.String==a||VIS.DisplayType.List==a||VIS.DisplayType.Text==a||VIS.DisplayType.TextLong==a?i+=" "+d+" "+u+" '"+c+"'":VIS.DisplayType.Date==a||VIS.DisplayType.DateTime==a?s.is(":checked")?(Ye.val(">="),i+=" "+d+" >="+zt(l[0].selectedIndex)):i+=" TO_CHAR("+d+", 'yyyy-mm-dd') "+u+" "+c:VIS.DisplayType.YesNo==a?He.is(":checked")?i+=" "+d+" "+u+" 'Y'":i+=" "+d+" "+u+" 'N'":i+=" "+d+" "+u+" "+c):(o+=" "+e,"IS NULL"==u||"IS NOT NULL"==u?o+=" "+d+" "+u:VIS.DisplayType.Integer==a||VIS.DisplayType.ID==a||VIS.DisplayType.IsSearch==a?o+=" "+d+" "+u+" "+c:VIS.DisplayType.String==a||VIS.DisplayType.IsDate==a||VIS.DisplayType.IsText==a||VIS.DisplayType.Text==a||VIS.DisplayType.TextLong==a?o+=" "+d+" "+u+" '"+c+"'":VIS.DisplayType.Date==a||VIS.DisplayType.DateTime==a?o+=" TO_CHAR("+d+", 'yyyy-mm-dd') "+u+" '"+c+"'":VIS.DisplayType.Date==a||VIS.DisplayType.DateTime==a?s.is(":checked")?(Ye.val(">="),o+=" "+d+" >= "+zt(l[0].selectedIndex)):o+=" TO_CHAR("+d+", 'yyyy-mm-dd') "+u+" "+c:o+=" "+d+" "+u+" "+c,i=i.substring(0,n)+" "+o+" "+i.substring(n)),Oe.text(""),Oe.text(i),Q=!1)}}(d,n,u),function(e,t){var a=rt.val(),i=ct.val(),n=ct.data("input");"none"!=Vt.css("display")&&(i=Vt.find("input").val(),n=Vt.find("input").data("input"));var u="N";let d=Ye.find("option:selected").val();var g=e;null!=M&&(g=M,M=null);var p=Oe.text().indexOf(a),v=!1;Oe.text().slice(p-6,p).indexOf("WHERE")>-1&&(v=!0),VIS.DisplayType.YesNo==t&&(g=He.is(":checked")?"Y":"N"),s.is(":checked")&&(u="Y",g=zt(l[0].selectedIndex));let _=Xe.find("option:selected").val();$&&(da=[],$=!1);const V={filterVal:a,filterCondition:d,filterValue:g,filterAndOrValue:_,dataType:t,whereExist:v,chkDynamic:u,columnVal:i,columnVersion:n,dynamicIndex:l[0].selectedIndex,year:o.val(),month:r.val(),day:c.val()};da.push(V),Be.empty(),ga(),Be&&Be.length>0&&Be.find(".vas-filter-item").addClass("vas-filters-row")}(n,u),He.attr("type","text"),Ut.hide();rt.val(""),ea()}else X.text(VIS.Msg.getMsg("VAS_AddFilterValues")),X.addClass("vas-sql-result-error")}),i=[],t("body").on(VIS.Events.onTouchStartOrClick,function(e){var a=t(e.target),i=Pe.children(".vas-column-list-item"),n=Pe.children(".vas-column-list-item").children(".vas-column-checkbox");if(a.is(Ae)||a.is(gt)||a.is(Pe)||a.is(i)||a.is(n)||(Pe.hide(),gt.val("")),a.is(it)||a.is(rt)||a.is(ze)||ze.hide(),a.is(lt)||a.is(ut)||a.is(ke)||null!=ke){a.is(st)||a.is(dt)||a.is(Ge)||Ge.hide();var l=Z.children(".vas-column-list-item"),s=Z.children(".vas-column-list-item").children(".vas-column-checkbox");a.is(me)||a.is(pt)||a.is(Z)||a.is(l)||a.is(s)||(Z.hide(),pt.val(""));var o=qe.children(".vas-filterValItem"),r=It.find("input");a.is(o)||a.is(nt)||a.is(qe)||a.is(r)||qe.hide();var c=yt.children(".vas-column-list-item");a.is(c)||a.is(mt)||a.is(yt)||a.is(At)||yt.hide();var u=Dt.children(".vas-column-list-item");a.is(u)||a.is(at)||a.is(Dt)||a.is(ot)||Dt.hide()}}),le.on(VIS.Events.onTouchStartOrClick,function(){var e,t=A,a=j,n=ut.val(),l=dt.val(),s=Oe.text();Ft=Ft.concat(Qt);var o=Ue.find("option:selected").val();const r={joinsDropDown:o,joinTableName:t,keyColumn1:n,keyColumn2:l,joinSelectedColumn:a};if(o&&t&&n&&l&&a&&i.push(r),""!=s&&""!=n&&""!=l&&null!=n&&null!=l){var c=s.indexOf("FROM"),u=s.indexOf("WHERE"),d=s.indexOf("ORDER BY"),g="",p="",v="";if(-1==u&&-1==d?g=s.slice(c):-1!=u&&-1==d?(g=s.slice(c,u),p=s.slice(u)):-1==u&&-1!=d?(g=s.slice(c,d),v=s.slice(d)):-1!=u&&-1!=d&&(g=s.slice(c,u),p=s.slice(u,d),v=s.slice(d)),""!=g){e=" "+Ue.val()+" "+A+" ON ("+n+" = "+l+")";var _=Ue.val()+" "+A+" ON ("+n+" = "+l+")";Oe.text(_),j.length>0?(s=s.slice(0,c)+", "+j+g+e,E=j):s=s.slice(0,c)+g+e,""!=p&&(s+=" "+p),""!=q&&(s+=-1!=u?" AND "+q:" WHERE "+q),""!=v&&(s+=" "+v)}if(null!=R&&R&&R.length>0){t=R[0].TableName,ve=ve.concat(R);for(var V=0;V<R.length;V++){var m=t+"."+R[V].DBColumn,f=t+" - "+R[V].ColumnName+" ("+R[V].DBColumn+")";U.includes(m)||(Dt.append(" <div class='vas-column-list-item' title='"+f+"' value="+m+">"+f+"</div>"),ze.append(" <div class='vas-column-list-item' title='"+f+"' refValId="+R[V].ReferenceValueID+" fieldID="+R[V].FieldID+" WindowID="+R[V].WindowID+" tabID="+L+" DBColumnName="+R[V].DBColumn+" TableName="+t+" columnID="+R[V].ColumnID+" datatype="+R[V].DataType+" value="+m+">"+f+"</div>"),yt.append("<div class='vas-column-list-item' title='"+f+"' refValId="+R[V].ReferenceValueID+" fieldID="+R[V].FieldID+" WindowID="+R[V].WindowID+" tabID="+L+" DBColumnName="+R[V].DBColumn+" TableName="+t+" columnID="+R[V].ColumnID+" datatype="+R[V].DataType+" value="+m+">"+f+"</div>"),U.push(m))}}be.empty(),function(){for(var e="",t=0;t<i.length;t++)e+="<div class=vas-join-item>",e+='<div class="vas-joins-bg">',e+='<div class="vas-joins-block">',e+='<div class="vas-selecttable join-title" style="background-color:'+va()+'">'+i[t].joinsDropDown+"</div>",e+='<div class="vas-selecttable join-base-table" style="background-color:'+va()+'">'+i[t].keyColumn1+"</div>",e+='<div class="vas-selecttable join-tab" style="background-color:'+va()+'">'+i[t].joinTableName+"</div>",e+='<div class="vas-selecttable join-jointable" style="background-color:'+va()+'">'+i[t].keyColumn2+"</div>",i[t].joinSelectedColumn.length>0&&(e+='<div class="vas-selecttable join-joinselectedcolumn" style="background-color:'+va()+'">'+i[t].joinSelectedColumn+"</div>"),e+="</div>",e+="</div>",e+="</div>",e+="</div>";be.append(e)}(),Oe.text(""),Oe.text(s),Z.val(""),Ge.val(""),ke.val(""),filterFlag=!0,pt.val(""),ut.val(""),dt.val(""),j=[],Le.setValue(null),na(0,0)}}),M=null,He.vaautocomplete({minLength:1,source:function(e,a){var i=ze.children(".vas-column-list-item.active").attr("datatype"),n=[];if(i==VIS.DisplayType.TableDir||i==VIS.DisplayType.Table||i==VIS.DisplayType.Search){var l=ze.children(".vas-column-list-item.active").attr("value"),s=ze.children(".vas-column-list-item.active").attr("tabid"),o=ze.children(".vas-column-list-item.active").attr("refValId"),r=l.slice(l.indexOf(".")+1),c=ze.children(".vas-column-list-item.active").attr("columnID"),u=ze.children(".vas-column-list-item.active").attr("fieldID"),d=ze.children(".vas-column-list-item.active").attr("WindowID"),g={ctx:VIS.Env.getCtx(),windowNo:VIS.Env.getWindowNo(),column_ID:c,AD_Reference_ID:i,columnName:r,AD_Reference_Value_ID:o,isParent:!0,validationCode:""};M=null,t.ajax({type:"Post",url:VIS.Application.contextUrl+"Form/GetAccessSqlAutoComplete",data:{columnName:r,text:e,WindowNo:b.windowNo,AD_Window_ID:d,AD_Tab_ID:s,AD_Field_ID:u,Validation:JSON.stringify(""),LookupData:JSON.stringify(g)},success:function(e){if(n=[],null!=JSON.parse(e)){result=JSON.parse(e).Table;for(var t=0;t<result.length;t++){var i={};i[Object.keys(result[t])[0].toLowerCase()]=result[t][Object.keys(result[t])[0]],i[Object.keys(result[t])[1].toLowerCase()]=result[t][Object.keys(result[t])[1]],i[Object.keys(result[t])[2].toLowerCase()]=result[t][Object.keys(result[t])[2]],n.push({id:i.id,value:VIS.Utility.Util.getIdentifierDisplayVal(i.finalvalue)})}a(n)}}})}else{if("LIKE"!=Ye.val()&&"NOT LIKE"!=Ye.val())return;var p=He.val(),v=[p+"%","%"+p,"%"+p+"%"],_=["StartWith_"+p,"EndWith_"+p,"InBetween_"+p];n=[];for(var V=0;V<v.length;V++)n.push({id:v[V],value:VIS.Utility.Util.getIdentifierDisplayVal(_[V])});a(n)}},onSelect:function(e,t){M=t.id}}),z=[],ue=-1,oe.on(VIS.Events.onTouchStartOrClick,function(){var e=ot.val(),a=Oe.text(),i=tt.val(),n=ot.val(),l=ot.attr("sortdatatype"),s=ot.attr("sortcolumnID"),o=ot.attr("sortDBColumnName"),r=ot.attr("sortrefValId"),c=ot.attr("sortisParent"),u=ot.attr("sortTableName");if(VIS.DisplayType.IsLookup(l)){var d=aa(l,s,o,r,c,u);d.indexOf(") as")>0&&(e=d.substring(0,d.indexOf(") as")+1).trim())}var g={column:e,reqSortVal:n,direction:i,sortdatatype:l,sortcolumnID:s,sortDBColumnName:o,sortrefValId:r,sortisParent:c,sortTableName:u};t(this).hasClass("vas-edit-sort")?(t(this).removeClass("vas-edit-sort"),oe.val(VIS.Msg.getMsg("VAS_AddSort")),ot.val(""),ue>=0&&ue<z.length&&(z[ue]=g),_a(),Va()):""!==a&&""!==e&&(z.push(g),ot.val(""),_a(),Va())}),Ie.on(VIS.Events.onTouchStartOrClick,function(){ua()}),xe.on(VIS.Events.onTouchStartOrClick,function(){ne.hide(),Oe.show(),K.hide(),Rt.hide(),te.val(Gt),te.removeClass("vas-show-grid")}),function(){var e=new VIS.MLookupFactory.get(VIS.Env.getCtx(),b.windowNo,0,VIS.DisplayType.Search,"AD_Tab_ID",0,!1,"AD_Tab.AD_Window_ID IN (SELECT AD_Window_ID FROM AD_Window_Access WHERE AD_Role_ID = "+VIS.Env.getCtx().getAD_Role_ID()+")");fe=new VIS.Controls.VTextBoxButton("AD_Tab_ID",!0,!1,!0,VIS.DisplayType.Search,e);var a=fe.getControl().attr("placeholder"," Search here").attr("id","Ad_Table_ID").css("width","100%").css("height","100%"),i=t('<div class="vas-control-wrap">'),n=t('<div class="input-group-append">');De.css("width","100%"),De.append(i).append(n),i.append(a),n.append(fe.getBtn(0)),n.append(fe.getBtn(1)),fe.setCustomInfo("VAS_AlertSQLGenerator"),fe.getControl().addClass("vis-ev-col-mandatory")}(),la(0,0),function(){fe.fireValueChanged=function(e){V.text(""),Zt(e.newValue,"S")},T.fireValueChanged=function(t){e=!1,Zt(t.newValue,"E"),O.hide(),w.setValue(null),Ht(t.newValue),d.setReadOnly(!1),u.setReadOnly(!1),g.setReadOnly(!1),d.setValue(!1),u.setValue(!1),g.setValue(!1),V.text("")},u.fireValueChanged=function(t){e=!1,O.hide(),t.newValue?(g.setValue(!1),d.setValue(!1),g.setReadOnly(!0),d.setReadOnly(!0)):(g.setReadOnly(!1),d.setReadOnly(!1)),V.text("")},d.fireValueChanged=function(t){(e=!1,O.hide(),t.newValue)?(0==T.getValue()&&VIS.ADialog.error("","",VIS.Msg.getMsg("VAS_EnterWindowTab")),O.show(),u.setValue(!1),g.setValue(!1),g.setReadOnly(!0),u.setReadOnly(!0)):(g.setReadOnly(!1),u.setReadOnly(!1));V.text("")},g.fireValueChanged=function(t){V.text(""),e=!1,O.hide(),t.newValue?(u.setValue(!1),d.setValue(!1),d.setReadOnly(!0),u.setReadOnly(!0)):(d.setReadOnly(!1),u.setReadOnly(!1))};let e=!1;_.on(VIS.Events.onClick,function(){e||(jt(!0),e=!0,Kt())}),D.fireValueChanged=function(e){e.newValue?f.show():f.hide()}}(),Ut.hide()},this.SqlQuery=function(e){jt(!0);var a=VIS.context.getContext(windowNo,"BasedOn");O.hide(),X.text(""),Wt.show(),Jt.hide(),"E"==a&&(Wt.hide(),Jt.show()),C.hide(),(G=e)>0?(ee.attr("disabled",!0),ee.css("opacity",.3),t.ajax({url:VIS.Application.contextUrl+"AlertSQLGenerate/GetAlertData",type:"POST",data:{alertRuleID:G},async:!1,success:function(e){(e=JSON.parse(e))&&(b.BasedOn=e.BasedOn,e.BasedOn&&"S"==e.BasedOn&&(C.show(),h.setValue(e.EmailColumnName),D.setValue(e.IsEmail),e.IsEmail?f.show():f.hide()),ye.text(e.Query),e.Query||(fe.setValue(null),ye.text(""),ee.attr("disabled",!1),ee.css("opacity",1),ae.val(Gt),Nt.hide(),Y.show(),ye.show(),C.show()),e.BasedOn&&"E"==e.BasedOn&&(T.setValue(e.TabID),u.setValue(e.IsInsert),d.setValue(e.IsUpdate),g.setValue(e.IsDelete),e.IsUpdate&&e.TabID>0?(Ht(e.TabID),w.setValue(e.ColumnID),O.show()):O.hide(),N=e.TableID,Wt.hide(),Jt.show())),jt(!1)},error:function(e){console.log(e),jt(!1)}}),$sqlBtn.trigger("click"),X.show()):"E"==a?(Wt.hide(),Jt.show(),T.setValue(null),u.setValue(!1),d.setValue(!1),g.setValue(!1),w.setValue(null),N=0,jt(!1)):(fe.setValue(null),Zt(0,"O"),ye.text(""),ee.attr("disabled",!1),ee.css("opacity",1),ae.val(Gt),Nt.hide(),Y.show(),ye.show(),C.show(),ie.hide(),jt(!1))},this.getRoot=function(){return $t},this.disposeComponent=function(){ae&&ae.off(VIS.Events.onTouchStartOrClick),te&&te.off(VIS.Events.onTouchStartOrClick),Be&&Be.off(VIS.Events.onTouchStartOrClick),$sqlBtn&&$sqlBtn.off(VIS.Events.onTouchStartOrClick),Me&&Me.off(VIS.Events.onTouchStartOrClick),Fe&&Fe.off(VIS.Events.onTouchStartOrClick),vt&&vt.off(VIS.Events.onTouchStartOrClick),he&&he.off(VIS.Events.onTouchStartOrClick),Ce&&Ce.off(VIS.Events.onTouchStartOrClick),ie&&ie.off(VIS.Events.onTouchStartOrClick),ne&&ne.off(VIS.Events.onTouchStartOrClick),se&&se.off(VIS.Events.onTouchStartOrClick),be&&be.off(VIS.Events.onTouchStartOrClick),le&&le.off(VIS.Events.onTouchStartOrClick),oe&&oe.off(VIS.Events.onTouchStartOrClick),null!=$t&&$t.remove(),$t=null,b=null,$sqlBtn=null,ee=null,te=null,ae=null,ie=null,ne=null,le=null,se=null,oe=null,Lt=null,Ue=null,ke=null,Ge=null,Ye=null,Xe=null,He=null,tt=null,removeColumnJoins=null,oldFilterVal=null,x=1,pe=0,J=null,ue=-1,this.getRoot=null,this.dGrid=null,this.disposeComponent=null}},e.TabAlertRuleSql.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,this.init()},e.TabAlertRuleSql.prototype.refreshPanelData=function(e,t){this.ParentId=e,this.selectedRow=t,this.SqlQuery(e)},e.TabAlertRuleSql.prototype.sizeChanged=function(e){this.panelWidth=e},e.TabAlertRuleSql.prototype.dispose=function(){this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,this.disposeComponent()}}(VAS,jQuery)},2685:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutPaySelection")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.PayAmt=function(e,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l)return"";var o=t.getValueOfInt(i.getValue("C_Invoice_ID"));if(null==o)return"";if(0==o)return"";var r=t.getValueOfDecimal(i.getValue("OpenAmt")),c=t.getValueOfDecimal(i.getValue("PayAmt")),u=t.getValueOfDecimal(i.getValue("DiscountAmt"));this.setCalloutActive(!0);var d=r-c-u;return this.log.fine(" - OpenAmt="+r+" - PayAmt="+c+", Discount="+u+", Difference="+d),i.setValue("DifferenceAmt",d),this.setCalloutActive(!1),i=l=null,""},a.prototype.Invoice=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s)return"";var r=t.getValueOfInt(s);if(0==r)return"";this.setCalloutActive(!0);var c=a.getContextAsInt(i,"C_BankAccount_ID"),u=a.getContext("PayDate"),d=e.Env.ZERO,g=e.Env.ZERO,p=null;try{var v=r.toString()+", "+c.toString()+","+u.toString();null!=(p=e.dataContext.getJSONRecord("MInvoice/GetInvoiceOpenDetail",v))&&Object.keys(p).length>0&&(d=t.getValueOfDecimal(p.OpenAmt),g=t.getValueOfDecimal(p.DiscountAmt),IsSOTrx="Y"==t.getValueOfString(p.IsSOTrx))}catch(e){this.setCalloutActive(!1)}return this.log.fine(" - OpenAmt="+d+" (Invoice="+r+",BankAcct="+c+")"),n.setValue("OpenAmt",d),n.setValue("PayAmt",d-g),n.setValue("DiscountAmt",g),n.setValue("DifferenceAmt",e.Env.ZERO),n.setValue("IsSOTrx",!1),this.setCalloutActive(!1),a=i=n=s=null,""},e.Model.CalloutPaySelection=a}(VIS,jQuery)},2738:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutProduct")}function i(){e.CalloutEngine.call(this,"VIS.CalloutProdCatVal")}function n(){e.CalloutEngine.call(this,"VIS.CalloutProdTypeVal")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.ProductCategory=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r=t.getValueOfInt(s);if(null==r||0==t.getValueOfInt(r)||0==r)return"";var c=t.getValueOfInt(s),u=e.dataContext.getJSONRecord("MProductCategory/GetProductCategory",c).IsPurchasedToOrder;return n.setValue("IsPurchasedToOrder",u),pc=null,n=s=null,""},a.prototype.UOM=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";if(null==i.getValue("M_Product_id"))return"";this.setCalloutActive(!0);var o=i.getValue("M_Product_ID").toString();return e.dataContext.getJSONRecord("MProduct/GetTransactionCount",o)>0&&(e.ADialog.info("Can't change UOM due to Transactions happens based on existing UOM"),i.setValue("C_UOM_ID",s)),this.setCalloutActive(!1),i=l=s=null,""},a.prototype.ResourceGroup=function(e,a,i,n,l,s){if(null==l||""==l.toString())return"";var o=t.getValueOfString(l);return null==o||0==o.length||("O"==o?i.setValue("BasisType",null):i.setValue("BasisType","I"),i=l=null),""},a.prototype.Organization=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";if(null==t.getValueOfInt(s))return"";var r=e.dataContext.getJSONRecord("MLocator/GetLocator",paramString).Default_Locator_ID;return n.setValue("M_Locator_ID",r),n=s=null,""},e.Model.CalloutProduct=a,e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.SetProdCatValues=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);try{var r,c=!1,u=!1,d=!1,g=!1,p="VA038_,DTD001_,VA005_,VA075_";if(null!=(r=e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix",p))){c=r.VA038_,u=r.DTD001_,d=r.VA005_,g=r.VA075_;var v;p=s.toString(),null!=(v=e.dataContext.getJSONRecord("MProductCategory/GetCategoryData",p))&&(u?(n.setValue("ProductType",v.ProductType),"True"==v.DTD001_IsConsumable&&n.setValue("DTD001_IsConsumable",!0)):n.setValue("ProductType",""),d&&(null!=v.M_AttributeSet_ID||""!=v.M_AttributeSet_ID?n.setValue("M_AttributeSet_ID",t.getValueOfInt(v.M_AttributeSet_ID)):n.setValue("M_AttributeSet_ID",0),null!=v.C_TaxCategory_ID||""!=v.C_TaxCategory_ID?n.setValue("C_TaxCategory_ID",t.getValueOfInt(v.C_TaxCategory_ID)):n.setValue("C_TaxCategory_ID",0)),c>0&&(("E"==v.ProductType||"S"==v.ProductType)&&t.getvalueofint(v.A_Asset_Group_ID)>0&&(null!=v.VA038_AmortizationTemplate_ID||""!=v.VA038_AmortizationTemplate_ID)?n.setValue("VA038_AmortizationTemplate_ID",t.getvalueofint(v.VA038_AmortizationTemplate_ID)):n.setValue("VA038_AmortizationTemplate_ID",0)),g>0&&(null!=v.VA075_EquipmentCategory_ID||""!=v.VA075_EquipmentCategory_ID?n.setValue("VA075_EquipmentCategory_ID",t.getValueOfInt(v.VA075_EquipmentCategory_ID)):n.setValue("VA075_EquipmentCategory_ID",0)))}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),n=s=null,""},e.Model.CalloutProdCatVal=i,e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.SetProdTypeValues=function(e,t,a,i,n,l){if(this.isCalloutActive()||null==n||""==n.toString())return"";this.setCalloutActive(!0);try{"I"!=n&&a.setValue("IsStocked",!1)}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),a=n=null,""},e.Model.CalloutProdTypeVal=n}(VIS,jQuery)},2789:()=>{!function(e,t){function a(a){this.onClose,this.dGrid=null;this.arrListColumns=[],this.log=e.Logging.VLogger.getVLogger("VCreateFrom"),this.divPaging=null,this.ulPaging=null,this.liFirstPage=null,this.liPrevPage=null,this.liCurrPage=null,this.liNextPage=null,this.liLastPage=null,this.cmbPage=null;this.multiValues=[],this.editedItems=[],this.NonEditableRecord=[];var i=this;e.Application.contextUrl;this.$root=t("<div style='position:relative'>"),this.log=e.Logging.VLogger.getVLogger("VCreateFrom"),this.$busyDiv=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),this.topDiv=t("<div class='vis-locatormainwrap vis-formouterwrpdiv'>"),this.middelDiv=t("<div class='vis-crtfrm-datawrp'>"),this.bottomDiv=t("<div class='vis-ctrfrm-btnwrp'>"),this.divPaging=t("<div>"),this.record_ID=0,this.windowNo=a.getWindowNo(),this.mTab=a,this.initOK=!1,this.isApplied=!1;var n="btnOk_"+this.windowNo;this.Okbtn=t("<input id='"+n+"' class='VIS_Pref_btn-2' type='button' value='"+e.Msg.getMsg("OK")+"'>"),n="btnCancel_"+this.windowNo,this.cancelbtn=t("<input id='"+n+"' class='VIS_Pref_btn-2' type='button' value='"+e.Msg.getMsg("Cancel")+"'>"),n="btnDelete_"+this.windowNo;var l=e.Application.contextUrl+"Areas/VIS/Images/base/uncheck-icon.png";this.selectAllButton=t("<button type='button' id='"+n+"' style='margin-bottom:0px;margin-top:0px;display: none;float: left;padding: 0px;border: 0px;' value='Ok' role='button' aria-disabled='false'><img src='"+l+"'></button>"),n="btnRefresh_"+this.windowNo,l=e.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png",this.btnRefresh=t("<button id='"+n+"' style='margin-bottom: 1px; margin-top: 0px;display: none; float: left; margin-left: 0px;height: 38px; ' class='VIS_Pref_btn-2'><img src='"+l+"'></button>"),n="btnApply_"+this.windowNo,this.Applybtn=t("<input id='"+n+"' class='VIS_Pref_btn-2' style='display: none;' type='button' value='"+e.Msg.getMsg("Apply")+"'>"),this.lblBankAccount=new e.Controls.VLabel,this.lblBPartner=new e.Controls.VLabel,this.lblOrder=new e.Controls.VLabel,this.lblInvoice=new e.Controls.VLabel,this.lblShipment=new e.Controls.VLabel,this.lblLocator=new e.Controls.VLabel,this.lblDeliveryDate=new e.Controls.VLabel,this.lblProduct=new e.Controls.VLabel,this.lblDocumentNoRef=new e.Controls.VLabel,this.lblDocumentNo=new e.Controls.VLabel,this.lblDate=new e.Controls.VLabel,this.lblAmount=new e.Controls.VLabel,this.lblDepositSlip=new e.Controls.VLabel,this.lblAuthCode=new e.Controls.VLabel,this.lblCheckNo=new e.Controls.VLabel,this.lblContainer=null,l=e.Application.contextUrl+"Areas/VIS/Images/pallet-icon.png",this.ContainerTree=t("<button class='input-group-text VIS_Tree-Container-disabled'><i id='ContainerTree_"+this.windowNo+"' class='fa fa-cubes'></i></button>"),this.lblProvisionalInvoice=new e.Controls.VLabel,this.cmbProvisionalInvoice=new e.Controls.VComboBox("",!1,!1,!0),this.DocumentNo=null,this.Date=null,this.Amount=null,this.DepositSlip=null,this.AuthCode=null,this.CheckNo=null,this.fromInvoice=!1,this.ProvisionalInvoice=!1,this.deliveryDate=null,this.cmbOrder=new e.Controls.VComboBox("",!1,!1,!0),this.cmbInvoice=new e.Controls.VComboBox("",!1,!1,!0),this.cmbShipment=new e.Controls.VComboBox("",!1,!1,!0),this.cmbContainer=null,this.DocumentNoRef=null,this.vProduct=null,this.cmbBankAccount=null,this.vBPartner=null,this.locatorField=null,this.child=null,this.relatedToOrg=new e.Controls.VCheckBox("Related To My Organization",!1,!1,!0,"Related To My Organization",null),this.pattrLookup=new e.MPAttributeLookup(e.context,i.windowNo),this.$productAttribute=new e.Controls.VPAttribute("M_AttributeSetInstance_ID",!1,!1,!0,e.DisplayType.PAttribute,i.pattrLookup,i.windowNo,!1,!1,!1,!0),this.title="",this.vetoablechange=function(t){if("M_Product_ID"==t.propertyName){i.isApplied=!1,i.setBusy(!0),i.multiValues=[],null!=i.dGrid&&(i.dGrid.destroy(),i.dGrid=null);var a=e.Utility.Util.getValueOfInt(i.cmbOrder.getValue()),n=e.Utility.Util.getValueOfInt(i.cmbInvoice.getValue()),l=e.Utility.Util.getValueOfInt(i.cmbShipment.getValue()),s=e.Utility.Util.getValueOfInt(i.cmbProvisionalInvoice.getValue()),o=i.vProduct.getValue(),r=i.deliveryDate.getValue();a>0?null!=i.locatorField?i.loadOrders(a,o,r,!1,1):i.loadOrders(a,o,r,!0,1):n>0?e.VCreateFromShipment.prototype.loadInvoices(n,o,1):l>0?"C_ProvisionalInvoice_ID"==i.mTab.keyColumnName?e.VCreateFormProvisionalInvoice.prototype.loadShipments(l,o,1):e.VCreateFromInvoice.prototype.loadShipments(l,o,1):s>0?e.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,o,1):i.setBusy(!1)}else if("C_BPartner_ID"==t.propertyName){i.setBusy(!0),i.multiValues=[],null!=i.dGrid&&(i.dGrid.destroy(),i.dGrid=null);var c=i.cmbBankAccount.getControl().find("option:selected").val(),u=i.Date.getValue(),d=i.vBPartner.getValue(),g=i.DepositSlip.getValue(),p=i.DocumentNo.getValue(),v=i.AuthCode.getValue(),_=i.CheckNo.getValue(),V=i.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(c,d,u,p,g,v,_,V,1)}else if("M_InOut_ID"==t.propertyName){i.setBusy(!0),i.editedItems=[],i.multiValues=[],null!=i.dGrid&&(i.dGrid.destroy(),i.dGrid=null);l=e.Utility.Util.getValueOfInt(i.cmbShipment.getValue()),o=i.vProduct.getValue();i.cmbOrder.setValue(-1),i.cmbInvoice.setValue(-1),i.cmbProvisionalInvoice.setValue(-1),i.lblDeliveryDate.setVisible(!1),i.deliveryDate.setVisible(!1),"C_ProvisionalInvoice_ID"==i.mTab.keyColumnName?e.VCreateFormProvisionalInvoice.prototype.loadShipments(l,o,1):e.VCreateFromInvoice.prototype.loadShipments(l,o,1)}else if("C_Order_ID"==t.propertyName){i.isApplied=!1,i.setBusy(!0),i.editedItems=[],i.multiValues=[],null!=i.dGrid&&(i.dGrid.destroy(),i.dGrid=null);a=e.Utility.Util.getValueOfInt(i.cmbOrder.getValue());i.cmbInvoice.setValue(-1),i.cmbShipment.setValue(-1),i.cmbProvisionalInvoice.setValue(-1),i.lblDeliveryDate.setVisible(!0),i.deliveryDate.setVisible(!0);o=i.vProduct.getValue(),r=i.deliveryDate.getValue();null!=i.locatorField?i.loadOrders(a,o,r,!1,1):i.loadOrders(a,o,r,!0,1)}else if("C_ProvisionalInvoice_ID"==t.propertyName){i.isApplied=!1,i.setBusy(!0),i.editedItems=[],i.multiValues=[],null!=i.dGrid&&(i.dGrid.destroy(),i.dGrid=null);s=e.Utility.Util.getValueOfInt(i.cmbProvisionalInvoice.getValue()),o=i.vProduct.getValue();i.cmbOrder.setValue(-1),i.cmbShipment.setValue(-1),i.cmbInvoice.setValue(-1),i.lblDeliveryDate.setVisible(!1),i.deliveryDate.setVisible(!1),e.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,o,1)}else if("C_Invoice_ID"==t.propertyName){i.isApplied=!1,i.setBusy(!0),i.editedItems=[],i.multiValues=[],null!=i.dGrid&&(i.dGrid.destroy(),i.dGrid=null);n=e.Utility.Util.getValueOfInt(i.cmbInvoice.getValue()),o=i.vProduct.getValue();i.cmbOrder.setValue(-1),i.cmbShipment.setValue(-1),i.cmbProvisionalInvoice.setValue(-1),i.lblDeliveryDate.setVisible(!1),i.deliveryDate.setVisible(!1),e.VCreateFromShipment.prototype.loadInvoices(n,o,1)}else if("M_Locator_ID"==t.propertyName){if(null!=i.locatorField){i.isApplied=!1;var A=parseInt(i.locatorField.getValue());A>0&&e.VCreateFromShipment.prototype.initContainerDetails(A)}}else this.locatorField.setBackground("")},this.createPageSettings=function(){this.ulPaging=t('<ul class="vis-statusbar-ul">'),this.liFirstPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="First Page" style="opacity: 0.6;"></i></div></li>'),this.liPrevPage=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="Page Up" style="opacity: 0.6;"></i></div></li>'),this.cmbPage=t("<select>"),this.liCurrPage=t("<li>").append(this.cmbPage),this.liNextPage=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="Page Down" style="opacity: 0.6;"></i></div></li>'),this.liLastPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="Last Page" style="opacity: 0.6;"></i></div></li>'),this.ulPaging.append(this.liFirstPage).append(this.liPrevPage).append(this.liCurrPage).append(this.liNextPage).append(this.liLastPage),this.pageEvents()},this.pageEvents=function(){this.liFirstPage.on("click",function(){if("1"==t(this).css("opacity")){i.setBusy(!0);var a=e.Utility.Util.getValueOfInt(i.cmbOrder.getValue()),n=e.Utility.Util.getValueOfInt(i.cmbInvoice.getValue()),l=e.Utility.Util.getValueOfInt(i.cmbShipment.getValue()),s=e.Utility.Util.getValueOfInt(i.cmbProvisionalInvoice.getValue()),o=null;null!=i.cmbBankAccount&&(o=i.cmbBankAccount.getControl().find("option:selected").val());var r=null,c=null;if(null!=i.vProduct&&(r=i.vProduct.getValue()),null!=i.deliveryDate&&(c=i.deliveryDate.getValue()),a>0)null!=i.locatorField?i.loadOrders(a,r,c,!1,1):i.loadOrders(a,r,c,!0,1);else if(n>0)e.VCreateFromShipment.prototype.loadInvoices(n,r,1);else if(l>0)"C_ProvisionalInvoice_ID"==i.mTab.keyColumnName?e.VCreateFormProvisionalInvoice.prototype.loadShipments(l,r,1):e.VCreateFromInvoice.prototype.loadShipments(l,r,1);else if(null!=o){var u=i.Date.getValue(),d=i.vBPartner.getValue(),g=i.DepositSlip.getValue(),p=i.DocumentNo.getValue(),v=i.AuthCode.getValue(),_=i.CheckNo.getValue(),V=i.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(o,d,u,p,g,v,_,V,1)}else s>0&&e.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,r,1)}}),this.liPrevPage.on("click",function(){if("1"==t(this).css("opacity")){i.setBusy(!0);var a=e.Utility.Util.getValueOfInt(i.cmbOrder.getValue()),n=e.Utility.Util.getValueOfInt(i.cmbInvoice.getValue()),l=e.Utility.Util.getValueOfInt(i.cmbShipment.getValue()),s=e.Utility.Util.getValueOfInt(i.cmbProvisionalInvoice.getValue()),o=null;null!=i.cmbBankAccount&&(o=i.cmbBankAccount.getControl().find("option:selected").val());var r=null,c=null;if(null!=i.vProduct&&(r=i.vProduct.getValue()),null!=i.deliveryDate&&(c=i.deliveryDate.getValue()),a>0)null!=i.locatorField?i.loadOrders(a,r,c,!1,parseInt(i.cmbPage.val())-1):i.loadOrders(a,r,c,!0,parseInt(i.cmbPage.val())-1);else if(n>0)e.VCreateFromShipment.prototype.loadInvoices(n,r,parseInt(i.cmbPage.val())-1);else if(l>0)"C_ProvisionalInvoice_ID"==i.mTab.keyColumnName?e.VCreateFormProvisionalInvoice.prototype.loadShipments(l,r,parseInt(i.cmbPage.val())-1):e.VCreateFromInvoice.prototype.loadShipments(l,r,parseInt(i.cmbPage.val())-1);else if(null!=o){var u=i.Date.getValue(),d=i.vBPartner.getValue(),g=i.DepositSlip.getValue(),p=i.DocumentNo.getValue(),v=i.AuthCode.getValue(),_=i.CheckNo.getValue(),V=i.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(o,d,u,p,g,v,_,V,parseInt(i.cmbPage.val())-1)}else s>0&&e.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,r,parseInt(i.cmbPage.val())-1)}}),this.liNextPage.on("click",function(){if("1"==t(this).css("opacity")){i.setBusy(!0);var a=e.Utility.Util.getValueOfInt(i.cmbOrder.getValue()),n=e.Utility.Util.getValueOfInt(i.cmbInvoice.getValue()),l=e.Utility.Util.getValueOfInt(i.cmbShipment.getValue()),s=e.Utility.Util.getValueOfInt(i.cmbProvisionalInvoice.getValue()),o=null;null!=i.cmbBankAccount&&(o=i.cmbBankAccount.getControl().find("option:selected").val());var r=null,c=null;if(null!=i.vProduct&&(r=i.vProduct.getValue()),null!=i.deliveryDate&&(c=i.deliveryDate.getValue()),a>0)null!=i.locatorField?i.loadOrders(a,r,c,!1,parseInt(i.cmbPage.val())+1):i.loadOrders(a,r,c,!0,parseInt(i.cmbPage.val())+1);else if(n>0)e.VCreateFromShipment.prototype.loadInvoices(n,r,parseInt(i.cmbPage.val())+1);else if(l>0)"C_ProvisionalInvoice_ID"==i.mTab.keyColumnName?e.VCreateFormProvisionalInvoice.prototype.loadShipments(l,r,parseInt(i.cmbPage.val())+1):e.VCreateFromInvoice.prototype.loadShipments(l,r,parseInt(i.cmbPage.val())+1);else if(null!=o){var u=i.Date.getValue(),d=i.vBPartner.getValue(),g=i.DepositSlip.getValue(),p=i.DocumentNo.getValue(),v=i.AuthCode.getValue(),_=i.CheckNo.getValue(),V=i.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(o,d,u,p,g,v,_,V,parseInt(i.cmbPage.val())+1)}else s>0&&e.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,r,parseInt(i.cmbPage.val())+1)}}),this.liLastPage.on("click",function(){if("1"==t(this).css("opacity")){i.setBusy(!0);var a=e.Utility.Util.getValueOfInt(i.cmbOrder.getValue()),n=e.Utility.Util.getValueOfInt(i.cmbInvoice.getValue()),l=e.Utility.Util.getValueOfInt(i.cmbShipment.getValue()),s=e.Utility.Util.getValueOfInt(i.cmbProvisionalInvoice.getValue()),o=null;null!=i.cmbBankAccount&&(o=i.cmbBankAccount.getControl().find("option:selected").val());var r=null,c=null;if(null!=i.vProduct&&(r=i.vProduct.getValue()),null!=i.deliveryDate&&(c=i.deliveryDate.getValue()),a>0)null!=i.locatorField?i.loadOrders(a,r,c,!1,parseInt(i.cmbPage.find("Option:last").val())):i.loadOrders(a,r,c,!0,parseInt(i.cmbPage.find("Option:last").val()));else if(n>0)e.VCreateFromShipment.prototype.loadInvoices(n,r,parseInt(i.cmbPage.find("Option:last").val()));else if(l>0)"C_ProvisionalInvoice_ID"==i.mTab.keyColumnName?e.VCreateFormProvisionalInvoice.prototype.loadShipments(l,r,parseInt(i.cmbPage.find("Option:last").val())):e.VCreateFromInvoice.prototype.loadShipments(l,r,parseInt(i.cmbPage.find("Option:last").val()));else if(null!=o){var u=i.Date.getValue(),d=i.vBPartner.getValue(),g=i.DepositSlip.getValue(),p=i.DocumentNo.getValue(),v=i.AuthCode.getValue(),_=i.CheckNo.getValue(),V=i.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(o,d,u,p,g,v,_,V,parseInt(i.cmbPage.find("Option:last").val()))}else s>0&&e.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,r,parseInt(i.cmbPage.find("Option:last").val()))}}),this.cmbPage.on("change",function(){i.setBusy(!0);var t=e.Utility.Util.getValueOfInt(i.cmbOrder.getValue()),a=e.Utility.Util.getValueOfInt(i.cmbInvoice.getValue()),n=e.Utility.Util.getValueOfInt(i.cmbShipment.getValue()),l=e.Utility.Util.getValueOfInt(i.cmbProvisionalInvoice.getValue()),s=null;null!=i.cmbBankAccount&&(s=i.cmbBankAccount.getControl().find("option:selected").val());var o=null,r=null;if(null!=i.vProduct&&(o=i.vProduct.getValue()),null!=i.deliveryDate&&(r=i.deliveryDate.getValue()),t>0)null!=i.locatorField?i.loadOrders(t,o,r,!1,i.cmbPage.val()):i.loadOrders(t,o,r,!0,i.cmbPage.val());else if(a>0)e.VCreateFromShipment.prototype.loadInvoices(a,o,i.cmbPage.val());else if(n>0)"C_ProvisionalInvoice_ID"==i.mTab.keyColumnName?e.VCreateFormProvisionalInvoice.prototype.loadShipments(n,o,i.cmbPage.val()):e.VCreateFromInvoice.prototype.loadShipments(n,o,i.cmbPage.val());else if(null!=s){var c=i.Date.getValue(),u=i.vBPartner.getValue(),d=i.DepositSlip.getValue(),g=i.DocumentNo.getValue(),p=i.AuthCode.getValue(),v=i.CheckNo.getValue(),_=i.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(s,u,c,g,d,p,v,_,i.cmbPage.val())}else l>0&&e.VCreateFromInvoice.prototype.loadProvisionalInvoices(l,o,i.cmbPage.val())})},this.resetPageCtrls=function(e){if(this.cmbPage.empty(),e.TotalPage>0){for(var a=0;a<e.TotalPage;a++)this.cmbPage.append(t("<option value="+(a+1)+">"+(a+1)+"</option>"));this.cmbPage.val(e.CurrentPage),e.TotalPage>e.CurrentPage?(this.liNextPage.css("opacity","1"),this.liLastPage.css("opacity","1")):(this.liNextPage.css("opacity","0.6"),this.liLastPage.css("opacity","0.6")),e.CurrentPage>1?(this.liFirstPage.css("opacity","1"),this.liPrevPage.css("opacity","1")):(this.liFirstPage.css("opacity","0.6"),this.liPrevPage.css("opacity","0.6")),1==e.TotalPage&&(this.liFirstPage.css("opacity","0.6"),this.liPrevPage.css("opacity","0.6"),this.liNextPage.css("opacity","0.6"),this.liLastPage.css("opacity","0.6"))}else this.liFirstPage.css("opacity","0.6"),this.liPrevPage.css("opacity","0.6"),this.liNextPage.css("opacity","0.6"),this.liLastPage.css("opacity","0.6")},this.setBusy=function(e){this.$busyDiv.css("display",e?"block":"none")},this.MergeItemsForSave=function(){var a=e.Utility.Util.getValueOfInt(i.cmbOrder.getValue()),n=e.Utility.Util.getValueOfInt(i.cmbInvoice.getValue()),l=e.Utility.Util.getValueOfInt(i.cmbShipment.getValue());if(i.editedItems.length>0)for(var s in i.editedItems){var o=i.editedItems[s].M_Product_ID_K;t.grep(i.multiValues,function(e,t){return a>0?e.M_Product_ID_K==o&&e.C_Order_ID_K==i.editedItems[s].C_Order_ID_K:n>0?e.M_Product_ID_K==o&&e.C_Invoice_ID_K==i.editedItems[s].C_Invoice_ID_K:l>0?e.M_Product_ID_K==o&&e.M_InOut_ID_K==i.editedItems[s].M_InOut_ID_K:e.C_Payment_ID_K==i.editedItems[s].C_Payment_ID_K}).length>0||i.multiValues.push(i.editedItems[s])}},this.showDialog=function(){this.locatorField&&(this.locatorField.setBackground(!1),this.locatorField.addVetoableChangeListener(this)),this.vProduct&&this.vProduct.addVetoableChangeListener(this),this.vBPartner&&this.vBPartner.addVetoableChangeListener(this),this.cmbShipment&&this.cmbShipment.addVetoableChangeListener(this),this.cmbOrder&&this.cmbOrder.addVetoableChangeListener(this),this.cmbProvisionalInvoice&&this.cmbProvisionalInvoice.addVetoableChangeListener(this),this.cmbInvoice&&this.cmbInvoice.addVetoableChangeListener(this);var t=this;if(this.$root.append(this.$busyDiv),this.setBusy(!1),this.$root.dialog({modal:!0,title:this.title,width:900,height:600,resizable:!1,position:{at:"center top",of:window},close:function(){t.dispose(),null!=t.dGrid&&t.dGrid.destroy(),t.onClose&&t.onClose(),i=null,t.$root.dialog("destroy"),t.$root=null}}),"Y".equals(e.Env.getCtx().getWindowContext(t.windowNo,"IsSOTrx"))||"Y".equals(e.Env.getCtx().getWindowContext(t.windowNo,"IsReturnTrx"))){if(e.Env.getCtx().getContextAsInt(t.windowNo,"C_Order_ID")>0){t.cmbOrder.setValue(e.Env.getCtx().getContextAsInt(t.windowNo,"C_Order_ID"));t.vetoablechange({propertyName:"C_Order_ID"})}}else t.locatorField&&t.locatorField.setValue(e.Env.getCtx().getContextAsInt(t.windowNo,"M_Locator_ID"))},this.checkcommaordot=function(t,a){var i=!1;if(t.value_new=e.Utility.Util.getValueOfString(a),t.value_new.contains(".")){i=!0;for(var n=[],l=0;l<t.value_new.length;l++)"."===t.value_new[l]&&n.push(l);n.length>1&&(t.value_new=removeAllButLast(t.value_new,"."))}if(t.value_new.contains(","))if(i)t.value_new=removeAllButLast(t.value_new,",");else{for(n=[],l=0;l<t.value_new.length;l++)","===t.value_new[l]&&n.push(l);n.length>1?t.value_new=removeAllButLast(t.value_new,","):t.value_new=t.value_new.replace(",",".")}return""==t.value_new&&(t.value_new="0"),t.value_new},this.removeAllButLast=function(e,t){var a=e.split(t);return(e=a.slice(0,-1).join("")+"."+a.slice(-1)).indexOf(".")==e.length-1&&(e=e.replace(".","")),e},this.disposeComponent=function(){i=null,this.Okbtn&&this.Okbtn.off("click"),this.cancelbtn&&this.cancelbtn.off("click"),this.selectAllButton&&this.selectAllButton.off("click"),this.btnRefresh&&this.btnRefresh.off("click"),this.Applybtn&&this.Applybtn.off("click"),this.disposeComponent=null}}a.prototype.dispose=function(){this.disposeComponent()},a.prototype.create=function(t){var a=e.Env.getCtx().getContextAsInt(t.getWindowNo(),"BaseTable_ID"),i=null;if(392==a)i=new e.VCreateFromStatement(t);else if(318==a)i=new e.VCreateFromInvoice(t);else if(319==a)i=new e.VCreateFromShipment(t);else{if(426==a)return null;if("C_ProvisionalInvoice_ID"!=t.keyColumnName)return null;i=new e.VCreateFormProvisionalInvoice(t)}return i},a.prototype.initBPDetails=function(e){return e},a.prototype.initBPartner=function(t){var a=e.MLookupFactory.getMLookUp(e.Env.getCtx(),this.windowNo,3499,e.DisplayType.Search);this.vBPartner=new e.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,e.DisplayType.Search,a);var i=e.Env.getCtx().getContextAsInt(this.windowNo,"C_BPartner_ID");return this.vBPartner.setValue(i),this.initBPartnerOIS(i,t)},a.prototype.initBPartnerOIS=function(a,i){var n=this.cmbOrder;t(n).html("");var l=!1;if(i){var s=e.dataContext.getJSONRecord("MDocType/GetDocType",e.Env.getCtx().getContextAsInt(this.windowNo,"C_DocTypeTarget_ID").toString());l=e.Utility.Util.getValueOfBoolean(s.IsReturnTrx);var o="Y".equals(e.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx"));l||o||this.getProvisionlInvoices(e.Env.getCtx(),a,l)}else l="Y".equals(e.Env.getCtx().getWindowContext(this.windowNo,"IsReturnTrx"));return this.getOrders(e.Env.getCtx(),a,l,i),this.initBPDetails(a)},a.prototype.initBPartnerForProvisional=function(){var a=e.MLookupFactory.getMLookUp(e.Env.getCtx(),this.windowNo,3499,e.DisplayType.Search);this.vBPartner=new e.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,e.DisplayType.Search,a);var i=e.Env.getCtx().getContextAsInt(this.windowNo,"C_BPartner_ID");this.vBPartner.setValue(i);var n=this.cmbOrder;t(n).html("");var l="Y".equals(e.Env.getCtx().getWindowContext(this.windowNo,"IsReturnTrx"));return this.getOrdersForProvisional(e.Env.getCtx(),i,l),this.initBPDetails(i)},a.prototype.getOrders=function(t,a,i,n){var l="m.M_InOutLine_ID";n&&(l="m.C_InvoiceLine_ID");var s=e.Env.getCtx().getContextAsInt(this.windowNo,"AD_Org_ID"),o="Y".equals(e.Env.getCtx().getWindowContext(this.windowNo,"IsDropShip")),r="Y".equals(e.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx")),c=e.context.getWindowContextAsInt(this.windowNo,"C_Invoice_ID",!0),u=e.context.getWindowContextAsInt(this.windowNo,"VAS_ContractMaster_ID",!0),d="",g=" C_Order.IsSOTrx ='"+(r?"Y":"N")+"' AND C_Order.IsBlanketTrx='N' AND C_Order.ISSALESQUOTATION='N' AND C_Order.DocStatus IN ('CL', 'CO')";s>0&&(g+=" AND C_Order.AD_Org_ID = "+s),a>0&&(g+=n?" AND (C_Order.C_BPartner_ID = "+a+" OR C_Order.Bill_BPartner_ID = "+a+")":" AND C_Order.C_BPartner_ID = "+a),c>0&&(d=e.dataContext.getJSONData("VCreateFrom/GetConversionWhere",{columns:l,forInvoices:n,recordID:c,Table:"C_Order"},null)),null!=d&&""!=d&&(g+=d),u>0&&(g+=" AND C_Order.VAS_ContractMaster_ID="+u),n&&!r&&(g+=" AND C_Order.C_Order_ID NOT IN(SELECT DISTINCT OL.C_Order_ID FROM C_ProvisionalInvoice PI INNER JOIN C_ProvisionalInvoiceLine IL ON IL.C_ProvisionalInvoice_ID = PI.C_ProvisionalInvoice_ID INNER JOIN C_OrderLine OL ON OL.C_OrderLine_ID = IL.C_OrderLine_ID AND OL.C_Order_ID = C_Order.C_Order_ID WHERE  PI.IsActive = 'Y' AND pi.DocStatus  NOT IN('VO', 'RE'))"),g+=" AND C_Order.IsReturnTrx='"+(i?"Y":"N")+"' AND C_Order.IsDropShip='"+(o?"Y":"N")+"'  AND C_Order.C_Order_ID IN (SELECT C_Order_ID FROM (SELECT ol.C_Order_ID,ol.C_OrderLine_ID,ol.QtyOrdered, (SELECT SUM(m.qty) FROM m_matchPO m WHERE ol.C_OrderLine_ID = m.C_OrderLine_ID AND NVL("+l+", 0) != 0 AND m.ISACTIVE = 'Y') AS Qty, (SELECT SUM(IL.QtyInvoiced)  FROM C_INVOICELINE IL INNER JOIN C_Invoice I ON I.C_INVOICE_ID = IL.C_INVOICE_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyInvoiced, (SELECT SUM(IL.QtyInvoiced)  FROM C_ProvisionalInvoiceLine IL INNER JOIN C_ProvisionalInvoice I ON I.C_ProvisionalInvoice_ID = IL.C_ProvisionalInvoice_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyProvisional FROM C_OrderLine ol ",n||"N"!=e.Utility.Util.getValueOfString(e.Env.getCtx().getContext("$AllowNonItem"))||(g+=" INNER JOIN M_Product p ON ol.M_Product_ID = p.M_Product_ID AND p.ProductType = 'I'"),g+=") t GROUP BY C_Order_ID,C_OrderLine_ID,QtyOrdered  HAVING QtyOrdered > SUM(nvl(Qty,0)) AND QtyOrdered > SUM(NVL(QtyInvoiced,0)))";var p=e.MLookupFactory.get(e.Env.getCtx(),e.Env.getWindowNo(),0,e.DisplayType.Search,"C_Order_ID",0,!1,g);this.cmbOrder=new e.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,e.DisplayType.Search,p)},a.prototype.getProvisionlInvoices=function(t,a,i){e.Env.getCtx().getContextAsInt(this.windowNo,"AD_Org_ID");var n=e.context.getWindowContextAsInt(this.windowNo,"C_Invoice_ID",!0),l="",s=" C_ProvisionalInvoice.C_ProvisionalInvoice_ID IN (SELECT DISTINCT i.C_ProvisionalInvoice_ID FROM C_ProvisionalInvoice i INNER JOIN C_DocType d ON (i.C_DocType_ID = d.C_DocType_ID) INNER JOIN C_ProvisionalInvoiceLine pil ON i.C_ProvisionalInvoice_ID = pil.C_ProvisionalInvoice_ID WHERE i.C_BPartner_ID = "+a+" AND i.IsSOTrx = 'N' AND d.IsReturnTrx = '"+(i?"Y":"N")+"' AND i.DocStatus IN('CL', 'CO') AND NVL(pil.C_ProvisionalInvoiceLine_ID, 0) NOT IN (SELECT NVL(C_ProvisionalInvoiceLine_ID, 0) FROM (SELECT NVL(il.C_ProvisionalInvoiceLine_ID, 0) AS C_ProvisionalInvoiceLine_ID FROM C_InvoiceLine il INNER JOIN C_Invoice inv ON inv.C_Invoice_ID = il.C_Invoice_ID WHERE inv.IsActive = 'Y' AND inv.IsSOTrx='N' AND inv.DocStatus NOT IN ('VO', 'RE') AND inv.C_ProvisionalInvoice_ID=i.C_ProvisionalInvoice_ID) pi) ";n>0&&(l=e.dataContext.getJSONData("VCreateFrom/GetConversionWhere",{columns:"",forInvoices:!1,recordID:n,Table:"i"},null)),null!=l&&""!=l&&(s+=l),s+=")";var o=e.MLookupFactory.get(e.Env.getCtx(),this.windowNo,0,e.DisplayType.Search,"C_ProvisionalInvoice_ID",0,!1,s);this.cmbProvisionalInvoice=new e.Controls.VTextBoxButton("C_ProvisionalInvoice_ID",!0,!1,!0,e.DisplayType.Search,o)},a.prototype.getOrdersForProvisional=function(t,a,i){var n="m.C_InvoiceLine_ID",l=e.Env.getCtx().getContextAsInt(this.windowNo,"AD_Org_ID"),s="Y".equals(e.Env.getCtx().getWindowContext(this.windowNo,"IsDropShip")),o="Y".equals(e.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx")),r=e.context.getWindowContextAsInt(this.windowNo,"C_ProvisionalInvoice_ID",!0),c="",u=" C_Order.IsSOTrx ='"+(o?"Y":"N")+"' AND C_Order.IsBlanketTrx='N' AND C_Order.ISSALESQUOTATION='N' AND C_Order.DocStatus IN ('CL', 'CO')";l>0&&(u+=" AND C_Order.AD_Org_ID = "+l),a>0&&(u+=" AND (C_Order.C_BPartner_ID = "+a+" OR C_Order.Bill_BPartner_ID = "+a+")"),r>0&&(c=e.dataContext.getJSONData("VCreateFrom/GetConversionWhere",{columns:n,forInvoices:!1,recordID:r,Table:"C_Order"},null)),null!=c&&""!=c&&(u+=c),u+=" AND C_Order.IsReturnTrx='"+(i?"Y":"N")+"' AND C_Order.IsDropShip='"+(s?"Y":"N")+"'  AND C_Order.C_Order_ID IN (SELECT C_Order_ID FROM (SELECT ol.C_Order_ID,ol.C_OrderLine_ID,ol.QtyOrdered, (SELECT SUM(m.qty) FROM m_matchPO m WHERE ol.C_OrderLine_ID = m.C_OrderLine_ID AND NVL("+n+", 0) != 0 AND m.ISACTIVE = 'Y') AS Qty, (SELECT SUM(IL.QtyInvoiced)  FROM C_INVOICELINE IL INNER JOIN C_Invoice I ON I.C_INVOICE_ID = IL.C_INVOICE_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyInvoiced, (SELECT SUM(IL.QtyInvoiced)  FROM C_ProvisionalInvoiceLine IL INNER JOIN C_ProvisionalInvoice I ON I.C_ProvisionalInvoice_ID = IL.C_ProvisionalInvoice_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyProvisional FROM C_OrderLine ol ","N"==e.Utility.Util.getValueOfString(e.Env.getCtx().getContext("$AllowNonItem"))&&(u+=" INNER JOIN M_Product p ON ol.M_Product_ID = p.M_Product_ID AND p.ProductType = 'I'"),u+=") t GROUP BY C_Order_ID,C_OrderLine_ID,QtyOrdered  HAVING QtyOrdered > SUM(nvl(Qty,0)) AND QtyOrdered > SUM(NVL(QtyInvoiced,0)) AND QtyOrdered > SUM(NVL(QtyProvisional, 0)))";var d=e.MLookupFactory.get(e.Env.getCtx(),this.windowNo,0,e.DisplayType.Search,"C_Order_ID",0,!1,u);this.cmbOrder=new e.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,e.DisplayType.Search,d)},a.prototype.jbInit=function(){this.init(),this.lblBankAccount.getControl().text(e.Msg.getMsg("BankAcctCurrency")),this.lblBPartner.getControl().text(e.Msg.getMsg("BusinessPartner")),"Y".equals(e.Env.getCtx().getWindowContext(this.windowNo,"IsReturnTrx"))?this.lblOrder.getControl().text(e.Msg.getMsg("RMA")):this.lblOrder.getControl().text(e.Msg.getMsg("Order")),this.lblInvoice.getControl().text(e.Msg.getMsg("Invoice")),this.lblShipment.getControl().text(e.Msg.getMsg("Shipment/Receipt")),this.lblLocator.getControl().text(e.Msg.getMsg("M_Locator_ID")),this.lblDeliveryDate.getControl().text(e.Msg.getMsg("DeliveryDate")),this.lblProduct.getControl().text(e.Msg.getMsg("ProductName")),this.lblDocumentNoRef.getControl().text(e.Msg.getMsg("DocumentNo")),this.lblDocumentNo.getControl().text(e.Msg.getMsg("DocumentNo")),this.lblDate.getControl().text(e.Msg.getMsg("DateAcct")),this.lblAmount.getControl().text(e.Msg.getMsg("Amount")),this.lblDepositSlip.getControl().text(e.Msg.getMsg("DepositSlipNo")),this.lblAuthCode.getControl().text(e.Msg.getMsg("AuthCode")),this.lblCheckNo.getControl().text(e.Msg.getMsg("CheckNo")),this.lblProvisionalInvoice.getControl().text(e.Msg.getMsg("ProvisionalInvoice"));var a=t("<div class='VIS_Pref_show'>"),i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>"),s=t("<div class='input-group-append'>");this.topDiv.append(a),a.append(i),i.append(n),n.append(l),n.append(s),null!=this.vBPartner&&(null!=this.cmbBankAccount?(l.append(this.vBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),s.append(this.vBPartner.getBtn(0)),s.append(this.vBPartner.getBtn(1))):(l.append(this.vBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),s.append(this.vBPartner.getBtn(0))),l.append(this.lblBPartner.getControl().addClass("VIS_Pref_Label_Font"))),i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>"),s=t("<div class='input-group-append'>"),a.append(i),i.append(n),n.append(l),n.append(s),null!=this.cmbBankAccount?(l.append(this.cmbBankAccount.getControl().attr("data-placeholder","").attr("placeholder"," ")),l.append(this.lblBankAccount.getControl().addClass("VIS_Pref_Label_Font"))):null!=this.DocumentNoRef?(l.append(this.DocumentNoRef.getControl().attr("data-placeholder","").attr("placeholder"," ")),l.append(this.lblDocumentNoRef.getControl().addClass("VIS_Pref_Label_Font"))):null!=this.cmbProvisionalInvoice&&"C_Invoice_ID"==$self.mTab.keyColumnName&&"N".equals(e.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx"))&&(l.append(this.cmbProvisionalInvoice.getControl().attr("data-placeholder","").attr("placeholder"," ")),s.append(this.cmbProvisionalInvoice.getBtn(0)),s.append(this.cmbProvisionalInvoice.getBtn(1)),l.append(this.lblProvisionalInvoice.getControl().addClass("VIS_Pref_Label_Font"))),a=t("<div class='VIS_Pref_show'>"),i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>"),s=t("<div class='input-group-append'>"),this.Amount,this.topDiv.append(a),a.append(i),i.append(n),n.append(l),n.append(s),null!=this.DocumentNo&&(i.append(n),l.append(this.DocumentNo.getControl().attr("data-placeholder","").attr("placeholder"," ")),l.append(this.lblDocumentNo.getControl().addClass("VIS_Pref_Label_Font"))),null!=this.cmbOrder&&(i.append(n),l.append(this.cmbOrder.getControl()),s.append(this.cmbOrder.getBtn(0)),s.append(this.cmbOrder.getBtn(1)),l.append(this.lblOrder.getControl().addClass("VIS_Pref_Label_Font"))),null!=this.Amount&&(i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>"),a.append(i),i.append(n),n.append(l),l.append(this.Amount.getControl().attr("data-placeholder","").attr("placeholder"," ")),l.append(this.lblAmount.getControl().addClass("VIS_Pref_Label_Font"))),this.Amount,i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>"),s=t("<div class='input-group-append'>"),a.append(i),i.append(n),n.append(l),n.append(s),null!=this.cmbInvoice&&(l.append(this.cmbInvoice.getControl().attr("data-placeholder","").attr("placeholder"," ")),s.append(this.cmbInvoice.getBtn(0)),s.append(this.cmbInvoice.getBtn(1)),l.append(this.lblInvoice.getControl().addClass("VIS_Pref_Label_Font"))),null!=this.cmbShipment&&(l.append(this.cmbShipment.getControl().attr("data-placeholder","").attr("placeholder"," ")),s.append(this.cmbShipment.getBtn(0)),s.append(this.cmbShipment.getBtn(1)),l.append(this.lblShipment.getControl().addClass("VIS_Pref_Label_Font"))),null!=this.Date&&(l.append(this.Date.getControl().attr("data-placeholder","").attr("placeholder"," ")),l.append(this.lblDate.getControl().addClass("VIS_Pref_Label_Font"))),null==this.locatorField&&null==this.cmbContainer||(this.middelDiv.css("height","48.5%"),a=t("<div class='VIS_Pref_show'>"),i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>"),s=t("<div class='input-group-append'>"),this.topDiv.append(a),a.append(i),i.append(n),n.append(l),n.append(s),null!=this.locatorField&&(l.append(this.locatorField.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),s.append(this.locatorField.getBtn(0)),l.append(this.lblLocator.getControl().addClass("VIS_Pref_Label_Font"))),i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>"),s=t("<div class='input-group-append'>"),a.append(i),i.append(n),n.append(l),n.append(s),null!=this.cmbContainer&&(i.css("visibility","hidden"),null!=e.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"]&&e.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"].equals("Y",!0)&&(i.css("visibility","visible"),this.ContainerTree.removeClass("VIS_Tree-Container-disabled")),l.append(this.cmbContainer.getControl().attr("disabled",!0).attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),s.append(this.ContainerTree),l.append(this.lblContainer.getControl().addClass("VIS_Pref_Label_Font")))),a=t("<div class='VIS_Pref_show'>"),this.CheckNo,i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>"),s=t("<div class='input-group-append'>"),"C_ProvisionalInvoice_ID"==$self.mTab.keyColumnName?this.middelDiv.css("height","64%"):"C_Invoice_ID"==$self.mTab.keyColumnName?this.middelDiv.css("height","62%"):"M_InOut_ID"==$self.mTab.keyColumnName&&this.middelDiv.css("height","54%"),this.topDiv.append(a),a.append(i),i.append(n),n.append(l),n.append(s),null!=this.DepositSlip&&(l.append(this.DepositSlip.getControl().attr("data-placeholder","").attr("placeholder"," ")),l.append(this.lblDepositSlip.getControl().addClass("VIS_Pref_Label_Font"))),null!=this.deliveryDate&&(l.append(this.deliveryDate.getControl().attr("data-placeholder","").attr("placeholder"," ")),l.append(this.lblDeliveryDate.getControl().addClass("VIS_Pref_Label_Font"))),null!=this.CheckNo&&(i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>"),a.append(i),i.append(n),n.append(l),l.append(this.CheckNo.getControl().attr("data-placeholder","").attr("placeholder"," ")),l.append(this.lblCheckNo.getControl().addClass("VIS_Pref_Label_Font"))),null!=this.CheckNo?(i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>")):(i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>"),s=t("<div class='input-group-append'>")),a.append(i),i.append(n),n.append(l),n.append(s),null!=this.vProduct&&(l.append(this.vProduct.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),s.append(this.vProduct.getBtn(0)),s.append(this.vProduct.getBtn(1)),l.append(this.lblProduct.getControl().addClass("VIS_Pref_Label_Font"))),null!=this.AuthCode&&(l.append(this.AuthCode.getControl().attr("data-placeholder","").attr("placeholder"," ")),l.append(this.lblAuthCode.getControl().addClass("VIS_Pref_Label_Font"))),null!=this.relatedToOrg&&(a=t("<div class='VIS_Pref_show'>"),i=t("<div class='VIS_Pref_dd'>"),n=t("<div class='input-group vis-input-wrap'></div>"),l=t("<div class='vis-control-wrap'></div>"),this.topDiv.append(a),a.append(i),i.append(n),n.append(l),l.append(this.relatedToOrg.getControl()),a.hide())},a.prototype.init=function(){this.createPageSettings(),this.divPaging.append(this.ulPaging),this.$root.append(this.topDiv).append(this.middelDiv).append(this.divPaging).append(this.bottomDiv),this.bottomDiv.append(this.selectAllButton),this.bottomDiv.append(this.btnRefresh),this.bottomDiv.append(this.cancelbtn),this.bottomDiv.append(this.Applybtn),this.bottomDiv.append(this.Okbtn),this.bottomDiv.append(this.divPaging),this.middelDiv.append(this.dGrid),$self=this,this.Okbtn.on("click",function(){if($self.isApplied)$self.$root.dialog("close");else{$self.setBusy(!0);var a=e.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),i=e.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),n=e.Utility.Util.getValueOfInt($self.cmbShipment.getValue()),l=e.Utility.Util.getValueOfInt($self.cmbProvisionalInvoice.getValue()),s=null;if(null!=$self.dGrid&&(s=$self.dGrid.getSelection()),null==s||0==s.length)return e.ADialog.info("RecordSelectionRequired"),void $self.setBusy(!1);if(null!=$self.locatorField){if(null!=$self.dGrid&&a>0)for(item in s){t.grep($self.multiValues,function(e,t){return e.M_Product_ID_K==$self.dGrid.get(s[item]).M_Product_ID_K&&e.C_Order_ID_K==$self.dGrid.get(s[item]).C_Order_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(s[item]))}else if(null!=$self.dGrid&&i>0)for(item in s){t.grep($self.multiValues,function(e,t){return e.M_Product_ID_K==$self.dGrid.get(s[item]).M_Product_ID_K&&e.C_Invoice_ID_K==$self.dGrid.get(s[item]).C_Invoice_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(s[item]))}$self.MergeItemsForSave(),e.VCreateFromShipment.prototype.saveMInOut(!1)}else if(null!=$self.cmbBankAccount){if(null!=$self.dGrid)for(item in s){if(""==$self.dGrid.get(s[item]).Date)return e.ADialog.error("VIS_PLAccountDate"),!1;t.grep($self.multiValues,function(e,t){return e.C_Payment_ID_K==$self.dGrid.get(s[item]).C_Payment_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(s[item]))}e.VCreateFromStatement.prototype.saveStatment(),$self.middelDiv.css("height","61%")}else{if(null!=$self.dGrid&&a>0)for(item in s){t.grep($self.multiValues,function(e,t){return e.M_Product_ID_K==$self.dGrid.get(s[item]).M_Product_ID_K&&e.C_Order_ID_K==$self.dGrid.get(s[item]).C_Order_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(s[item]))}if(null!=$self.dGrid&&n>0)for(item in s){t.grep($self.multiValues,function(e,t){return e.M_Product_ID_K==$self.dGrid.get(s[item]).M_InOut_ID_K&&e.M_InOut_ID_K==$self.dGrid.get(s[item]).M_InOut_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(s[item]))}if(null!=$self.dGrid&&l>0)for(item in s){t.grep($self.multiValues,function(e,t){return e.M_Product_ID_K==$self.dGrid.get(s[item]).M_Product_ID_K&&e.C_Invoice_ID_K==$self.dGrid.get(s[item]).C_Invoice_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(s[item]))}"C_ProvisionalInvoice_ID"==$self.mTab.keyColumnName?e.VCreateFormProvisionalInvoice.prototype.saveProvisionalInvoice():e.VCreateFromInvoice.prototype.saveInvoice()}}}),this.Applybtn.on("click",function(){$self.setBusy(!0);var a=e.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),i=e.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),n=e.Utility.Util.getValueOfInt($self.cmbShipment.getValue()),l=null;if(null!=$self.dGrid&&(l=$self.dGrid.getSelection()),null==l||0==l.length)return e.ADialog.info("RecordSelectionRequired"),void $self.setBusy(!1);if(null!=$self.locatorField){if(null!=$self.dGrid&&a>0)for(item in l){t.grep($self.multiValues,function(e,t){return e.M_Product_ID_K==$self.dGrid.get(l[item]).M_Product_ID_K&&e.C_Order_ID_K==$self.dGrid.get(l[item]).C_Order_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(l[item]))}else if(null!=$self.dGrid&&i>0)for(item in l){t.grep($self.multiValues,function(e,t){return e.M_Product_ID_K==$self.dGrid.get(l[item]).M_Product_ID_K&&e.C_Invoice_ID_K==$self.dGrid.get(l[item]).C_Invoice_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(l[item]))}$self.MergeItemsForSave(),e.VCreateFromShipment.prototype.saveMInOut(!0)}else if(null!=$self.cmbBankAccount){if(null!=$self.dGrid)for(item in l){if(""==$self.dGrid.get(l[item]).Date)return e.ADialog.error("VIS_PLAccountDate"),!1;t.grep($self.multiValues,function(e,t){return e.C_Payment_ID_K==$self.dGrid.get(l[item]).C_Payment_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(l[item]))}e.VCreateFromStatement.prototype.saveStatment(),$self.middelDiv.css("height","61%")}else{if(null!=$self.dGrid&&a>0)for(item in l){t.grep($self.multiValues,function(e,t){return e.M_Product_ID_K==$self.dGrid.get(l[item]).M_Product_ID_K&&e.C_Order_ID_K==$self.dGrid.get(l[item]).C_Order_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(l[item]))}if(null!=$self.dGrid&&n>0)for(item in l){t.grep($self.multiValues,function(e,t){return e.M_Product_ID_K==$self.dGrid.get(l[item]).M_InOut_ID_K&&e.M_InOut_ID_K==$self.dGrid.get(l[item]).M_InOut_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(l[item]))}e.VCreateFromInvoice.prototype.saveInvoice()}}),a.prototype.callBackSave=function(t){if(0==t)$self.setBusy(!1);else{$self.isApplied=!0,e.ADialog.info("VIS_SuccessFullyInserted",null,null,null);var a=e.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),i=e.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),n=(e.Utility.Util.getValueOfInt($self.cmbShipment.getValue()),$self.vProduct.getValue()),l=$self.deliveryDate.getValue();(a>0||i>0)&&(null!=$self.locatorField?($self.dGrid.selectNone(),a>0&&($self.multiValues=[],$self.loadOrders(a,n,l,!1,1)),i>0&&($self.multiValues=[],e.VCreateFromShipment.prototype.loadInvoices(i,n,1)),$self.dGrid.selectNone(),$self.editedItems=[]):($self.dGrid.selectNone(),a>0&&($self.multiValues=[],$self.loadOrders(a,n,l,!0,1)),i>0&&($self.multiValues=[],e.VCreateFromShipment.prototype.loadInvoices(i,n,1)),$self.dGrid.selectNone(),$self.editedItems=[]))}},this.cancelbtn.on("click",function(){$self.setBusy(!1),$self.$root.dialog("close")});this.selectAllButton.on("click",function(){}),this.relatedToOrg&&this.relatedToOrg.getControl().on("click",function(){$self.isApplied=!1,$self.setBusy(!0),$self.multiValues=[],null!=$self.dGrid&&($self.dGrid.destroy(),$self.dGrid=null);var t=e.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),a=e.Utility.Util.getValueOfInt($self.cmbProvisionalInvoice.getValue());if(t>0){$self.cmbInvoice.setValue(-1),$self.cmbShipment.setValue(-1);var i=$self.vProduct.getValue(),n=$self.deliveryDate.getValue();$self.loadOrders(t,i,n,!1,1)}else if(a>0){$self.cmbOrder.setValue(-1),$self.cmbInvoice.setValue(-1),$self.cmbShipment.setValue(-1);i=$self.vProduct.getValue();e.VCreateFromInvoice.prototype.loadProvisionalInvoices(a,i,1)}else $self.setBusy(!1)}),this.btnRefresh&&this.btnRefresh.on("click",function(){if(null!=$self.cmbBankAccount){$self.setBusy(!0);var t=$self.cmbBankAccount.getControl().find("option:selected").val();if(t){var a=$self.Date.getValue(),i=$self.vBPartner.getValue(),n=$self.DepositSlip.getValue(),l=$self.DocumentNo.getValue(),s=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),r=$self.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(t,i,a,l,n,s,o,r,$self.cmbPage.val())}}}),this.cmbBankAccount&&this.cmbBankAccount.getControl().change(function(){$self.editedItems=[],$self.setBusy(!0);var t=$self.cmbBankAccount.getControl().find("option:selected").val();if(t){e.VCreateFromStatement.prototype.initBPartner(t),$self.Date.setValue(""),$self.DepositSlip.setValue(""),$self.DocumentNo.setValue(""),$self.AuthCode.setValue("");var a=$self.vBPartner.getValue(),i=$self.Date.getValue(),n=$self.DepositSlip.getValue(),l=$self.DocumentNo.getValue(),s=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),r=$self.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(t,a,i,l,n,s,o,r,1)}}),this.Date&&this.Date.getControl().change(function(){$self.setBusy(!0),$self.multiValues=[],$self.editedItems=[],null!=$self.dGrid&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),a=$self.cmbBankAccount.getControl().find("option:selected").val(),i=$self.vBPartner.getValue(),n=$self.DepositSlip.getValue(),l=$self.DocumentNo.getValue(),s=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),r=$self.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(a,i,t,l,n,s,o,r,1)}),this.DocumentNo&&this.DocumentNo.getControl().change(function(){$self.setBusy(!0),$self.multiValues=[],$self.editedItems=[],null!=$self.dGrid&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),a=$self.cmbBankAccount.getControl().find("option:selected").val(),i=$self.vBPartner.getValue(),n=$self.DepositSlip.getValue(),l=$self.DocumentNo.getValue(),s=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),r=$self.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(a,i,t,l,n,s,o,r,1)}),this.DepositSlip&&this.DepositSlip.getControl().change(function(){$self.setBusy(!0),$self.multiValues=[],$self.editedItems=[],null!=$self.dGrid&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),a=$self.cmbBankAccount.getControl().find("option:selected").val(),i=$self.vBPartner.getValue(),n=$self.DepositSlip.getValue(),l=$self.DocumentNo.getValue(),s=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),r=$self.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(a,i,t,l,n,s,o,r,1)}),this.AuthCode&&this.AuthCode.getControl().change(function(){$self.setBusy(!0),$self.multiValues=[],$self.editedItems=[],null!=$self.dGrid&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),a=$self.cmbBankAccount.getControl().find("option:selected").val(),i=$self.vBPartner.getValue(),n=$self.DepositSlip.getValue(),l=$self.DocumentNo.getValue(),s=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),r=$self.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(a,i,t,l,n,s,o,r,1)}),this.CheckNo&&this.CheckNo.getControl().change(function(){$self.setBusy(!0),$self.multiValues=[],$self.editedItems=[],null!=$self.dGrid&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),a=$self.cmbBankAccount.getControl().find("option:selected").val(),i=$self.vBPartner.getValue(),n=$self.DepositSlip.getValue(),l=$self.DocumentNo.getValue(),s=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),r=$self.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(a,i,t,l,n,s,o,r,1)}),this.Amount&&this.Amount.getControl().change(function(){$self.setBusy(!0),$self.multiValues=[],$self.editedItems=[],null!=$self.dGrid&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),a=$self.cmbBankAccount.getControl().find("option:selected").val(),i=$self.vBPartner.getValue(),n=$self.DepositSlip.getValue(),l=$self.DocumentNo.getValue(),s=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),r=$self.Amount.getValue();e.VCreateFromStatement.prototype.loadBankAccounts(a,i,t,l,n,s,o,r,1)}),this.deliveryDate&&this.deliveryDate.getControl().change(function(){$self.isApplied=!1,$self.setBusy(!0),$self.multiValues=[],$self.editedItems=[],null!=$self.dGrid&&($self.dGrid.destroy(),$self.dGrid=null);var t=e.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),a=$self.vProduct.getValue(),i=$self.deliveryDate.getValue();null!=$self.locatorField?$self.loadOrders(t,a,i,!1,1):$self.loadOrders(t,a,i,!0,1)}),this.ContainerTree&&this.ContainerTree.on("click",function(){if(null==e.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"]||e.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"].equals("Y",!0)){var t=$self.locatorField.getValue();if(t>0){var a=new e.productContainerTree(0,t,0);null!=a&&(a.showDialog(),a.onClosing=function(e,t){$self.cmbContainer.getControl().empty(),$self.cmbContainer.getControl().append(" <option value="+e+">"+t+"</option>")}),a=null}t=null}})},a.prototype.isInitOK=function(){return this.initOK},a.prototype.loadOrders=function(t,a,i,n,l){this.getOrdersData(e.Env.getCtx(),t,a,i,n,l)},a.prototype.getOrdersData=function(a,i,n,l,s,o){if(null!=$self.dGrid){var r=$self.dGrid.getSelection();for(item in r){t.grep($self.multiValues,function(e,t){return e.M_Product_ID_K==$self.dGrid.get(r[item]).M_Product_ID_K&&e.C_Order_ID_K==$self.dGrid.get(r[item]).C_Order_ID_K}).length>0||$self.multiValues.push($self.dGrid.get(r[item]))}}if("M_InOut_ID"==$self.mTab.keyColumnName?$self.record_ID=$self.mTab.getValue("M_InOut_ID"):"C_Invoice_ID"==$self.mTab.keyColumnName?$self.record_ID=$self.mTab.getValue("C_Invoice_ID"):"C_ProvisionalInvoice_ID"==$self.mTab.keyColumnName&&($self.record_ID=$self.mTab.getValue("C_ProvisionalInvoice_ID")),null!=$self.relatedToOrg&&$self.relatedToOrg.getValue()){var c="",u="",d="";if(o||(o=1),c=e.Env.isBaseLanguage(a,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+e.Env.getAD_Language(a).concat("')"),null!=n&&(u=" AND l.M_Product_ID="+n),null!=l)p=e.DB.to_date(l,!0),d=" AND l.DatePromised <= "+p;var g=$self.mTab.getValue("AD_Org_ID");t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetOrdersDataCommon",dataType:"json",type:"POST",data:{keyColumnName:$self.mTab.keyColumnName,tableName:"C_OrderLine",recordID:$self.record_ID,pageNo:o,forInvoicees:s,C_Ord_IDs:i,isBaseLangess:c,MProductIDss:u,DelivDates:d,adOrgIDSs:g},error:function(t){alert(e.Msg.getMsg("ErrorWhileGettingData")),$self.setBusy(!1),$self.log.info(t)},success:function(t){var a=JSON.parse(t);if(a.Error)return e.ADialog.error(a.Error),void $self.setBusy(!1);$self.resetPageCtrls(a.pSetting),$self.loadGrid(a.data),$self.setBusy(!1)}})}else{var p;c="",u="",d="";if(c=e.Env.isBaseLanguage(a,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+e.Env.getAD_Language(a)+"') INNER JOIN C_UOM uom1 ON uom1.C_UOM_ID = uom.C_UOM_ID ",n>0&&(u=" AND l.M_Product_ID="+n),null!=l)d=" AND l.DatePromised <= "+(p=e.DB.to_date(l,!0));o||(o=1),t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetOrdersDataCommonOrg",dataType:"json",type:"POST",data:{keyColumnName:$self.mTab.keyColumnName,tableName:"C_OrderLine",recordID:$self.record_ID,pageNo:o,forInvoicees:s,C_Ord_IDs:i,isBaseLangess:c,MProductIDss:u,DelivDates:d},error:function(t){alert(e.Msg.getMsg("ErrorWhileGettingData")),$self.setBusy(!1),$self.log.info(t)},success:function(t){var a=JSON.parse(t);if(a.Error)return e.ADialog.error(a.Error),void $self.setBusy(!1);$self.resetPageCtrls(a.pSetting),$self.loadGrid(a.data),$self.setBusy(!1)}})}return[]},a.prototype.loadOrder=function(t,a){var i;i=this.getOrderData(e.Env.getCtx(),t,a),this.loadGrid(i)},a.prototype.getOrderData=function(a,i,n){var l=[];if($self.relatedToOrg.getValue()){var s="";s=e.Env.isBaseLanguage(a,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+e.Env.getAD_Language(a)+"')";var o=$self.mTab.getValue($self.windowNo,"AD_Org_ID"),r=e.Env.getAD_Language(a);return t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetOrderDataCommons",dataType:"json",type:"POST",async:!1,data:{forInvoices:n,isBaseLangs:s,C_OrderID:i,orggetVals:o,langs:r},error:function(t){alert(e.Msg.getMsg("ErrorWhileGettingData")),$self.setBusy(!1),$self.log.info(t)},success:function(e){var t=JSON.parse(e);if(t&&null!=t&&t.length>0)for(var a=0;a<t.length;a++){var i={};i.Quantity=t[a].quantity,i.QuantityEntered=t[a].quantityentered,i.C_UOM_ID=t[a].c_uom_id,i.M_Product_ID=t[a].m_product_id,i.M_AttributeSetInstance_ID=t[a].m_attributesetinstance_id,i.C_Order_ID=t[a].c_order_id,i.M_InOut_ID=null,i.C_Invoice_ID=null,i.C_UOM_ID_K=t[a].c_uom_id_k,i.M_Product_ID_K=t[a].m_product_id_k,i.M_AttributeSetInstance_ID_K=t[a].m_attributesetinstance_id_k,i.C_Order_ID_K=t[a].c_order_id_k,i.M_InOut_ID_K=null,i.C_Invoice_ID_K=null,i.C_PaymentTerm_ID=t[a].C_PaymentTerm_ID,i.PaymentTermName=t[a].PaymentTermName,i.IsAdvance=t[a].IsAdvance,i.C_InvoicePaymentTerm_ID=t[a].C_InvoicePaymentTerm_ID,i.IsInvoicePTAdvance=t[a].IsInvoicePTAdvance,i.recid=1,l.push(i)}$self.setBusy(!1)}}),l}s="";s=e.Env.isBaseLanguage(a,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+e.Env.getAD_Language(a)+"')";r=e.Env.getAD_Language(a);return t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetOrderDataCommonsNotOrg",dataType:"json",type:"POST",async:!1,data:{forInvoices:n,isBaseLangs:s,C_OrderID:i,langs:r},error:function(t){alert(e.Msg.getMsg("ErrorWhileGettingData")),$self.setBusy(!1),$self.log.info(t)},success:function(e){var t=JSON.parse(e);if(t&&null!=t&&t.length>0)for(var a=0;a<t.length;a++){var i={};i.Quantity=t[a].quantity,i.QuantityEntered=t[a].quantityentered,i.C_UOM_ID=t[a].c_uom_id,i.M_Product_ID=t[a].m_product_id,i.M_AttributeSetInstance_ID=t[a].m_attributesetinstance_id,i.C_Order_ID=t[a].c_order_id,i.M_InOut_ID=null,i.C_Invoice_ID=null,i.C_UOM_ID_K=t[a].c_uom_id_k,i.M_Product_ID_K=t[a].m_product_id_k,i.M_AttributeSetInstance_ID_K=t[a].m_attributesetinstance_id_k,i.C_Order_ID_K=t[a].c_order_id_k,i.M_InOut_ID_K=null,i.C_Invoice_ID_K=null,i.C_PaymentTerm_ID=t[a].C_PaymentTerm_ID,i.PaymentTermName=t[a].PaymentTermName,i.IsAdvance=t[a].IsAdvance,i.C_InvoicePaymentTerm_ID=t[a].C_InvoicePaymentTerm_ID,i.IsInvoicePTAdvance=t[a].IsInvoicePTAdvance,"C_ProvisionalInvoice_ID"==$self.mTab.keyColumnName&&(i.POPrice=t[a].POPrice,i.ProvisionalPrice=t[a].ProvisionalPrice),i.recid=1,l.push(i)}$self.setBusy(!1)}}),l},a.prototype.loadGrid=function(a){var i=e.DisplayType.GetNumberFormat(e.DisplayType.Amount),n=e.Env.isDecimalPoint();null!=this.dGrid&&(this.dGrid.destroy(),this.dGrid=null);var l="Y".equals(e.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx"));(0==this.arrListColumns.length||"C_Invoice_ID"==$self.mTab.keyColumnName&&!l)&&(this.arrListColumns=[],this.arrListColumns.push({field:"Select",caption:e.Msg.getMsg("Select"),sortable:!1,size:"50px",hidden:!1,render:function(){return'<div><input type=checkbox disabled="true"></div>'}}),this.arrListColumns.push({field:"Quantity",caption:e.Msg.getMsg("QtyPending"),sortable:!1,size:"150px",hidden:!1,render:function(e,t,a){var i=e.Quantity;return parseFloat(i).toLocaleString(void 0,{minimumFractionDigits:4})}}),this.arrListColumns.push({field:"QuantityPending",caption:e.Msg.getMsg("Quantity"),sortable:!1,size:"150px",render:"number:4",hidden:!0}),e.Utility.Util.getValueOfInt($self.cmbProvisionalInvoice.getValue())>0&&!l?(this.arrListColumns.push({field:"QuantityEntered",caption:e.Msg.getMsg("QtyEntered"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"POPrice",caption:e.Msg.getMsg("POPrice"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"ProvisionalPrice",caption:e.Msg.getMsg("ProvisionalPrice"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"InvoicePrice",caption:e.Msg.getMsg("InvoicePrice"),editable:{type:"number",style:"background-color: #f8f8f8;"},sortable:!1,size:"150px",hidden:!1,render:function(e,t,a){var i=e.InvoicePrice;return i=$self.checkcommaordot(event,i),parseFloat(i).toLocaleString(void 0,{minimumFractionDigits:4})},style:"background-color: #d1d1d14a"})):this.arrListColumns.push({field:"QuantityEntered",caption:e.Msg.getMsg("QtyEntered"),editable:{type:"number",style:"background-color: #f8f8f8;"},sortable:!1,size:"150px",hidden:!1,render:function(e,t,a){var i=e.QuantityEntered;return i=$self.checkcommaordot(event,i),parseFloat(i).toLocaleString(void 0,{minimumFractionDigits:4})},style:"background-color: #d1d1d14a"}),this.arrListColumns.push({field:"C_UOM_ID",caption:e.Msg.getMsg("UomName"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_Product_SearchKey",caption:e.Msg.getMsg("ProductSearchKey"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_Product_ID",caption:e.Msg.getMsg("ProductName"),sortable:!0,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_AttributeSetInstance_ID",caption:e.Msg.getMsg("ASI"),sortable:!1,size:"150px",editable:{type:"custom",ctrl:$self.$productAttribute,showAll:!0,style:"background-color: #f8f8f8;"},render:function(e,t,a){var i,n=$self.pattrLookup,l=e.M_AttributeSetInstance_ID;return e.changes&&void 0!==e.changes.M_AttributeSetInstance_ID&&(l=e.changes.M_AttributeSetInstance_ID),n&&(i=n.getDisplay(l,!0)),i},style:"background-color: #d1d1d14a"}),this.arrListColumns.push({field:"C_PaymentTerm_ID",caption:e.Msg.getMsg("C_PaymentTerm_ID"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"PaymentTermName",caption:e.Msg.getMsg("PaymentTermName"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"IsAdvance",caption:e.Msg.getMsg("IsAdvance"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_InvoicePaymentTerm_ID",caption:e.Msg.getMsg("C_InvoicePaymentTerm_ID"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"IsInvoicePTAdvance",caption:e.Msg.getMsg("IsInvoicePTAdvance"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_Order_ID",caption:e.Msg.getMsg("OrderLine"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_InOut_ID",caption:e.Msg.getMsg("Shipment/Receipt"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"C_Invoice_ID",caption:e.Msg.getMsg("Invoice"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"C_UOM_ID_K",caption:e.Msg.getMsg("UomName"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"M_Product_ID_K",caption:e.Msg.getMsg("ProductName"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_Order_ID_K",caption:e.Msg.getMsg("Order"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"M_InOut_ID_K",caption:e.Msg.getMsg("Shipment/Receipt"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_Invoice_ID_K",caption:e.Msg.getMsg("Invoice"),sortable:!1,size:"150px",hidden:!0})),w2utils.encodeTags(a);var s="gridCreateForm"+this.windowNo;s=s.replace(".",""),this.dGrid=t(this.middelDiv).w2grid({name:s,recordHeight:30,show:{selectColumn:!0},multiSelect:!0,columns:this.arrListColumns,records:a,onSelect:function(e){e.onComplete=function(){d()}},onEditField:function(e){if(id=e.recid,3==e.column){$self.dGrid.records[e.index].QuantityEntered=$self.checkcommaordot(e,$self.dGrid.records[e.index].QuantityEntered);var a=i.GetFormatAmount($self.dGrid.records[e.index].QuantityEntered,"init",n);$self.dGrid.records[e.index].QuantityEntered=i.GetConvertedString(a,n),t("#grid_"+$self.dGrid.name+"_rec_"+id).keydown(function(e){return!!(n||190!=e.keyCode&&110!=e.keyCode)&&((!n||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which?!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||e.target.value.indexOf(",")>-1&&(e.target.value=e.target.value.replace(",","")):e.target.value.indexOf(".")>-1&&(e.target.value=e.target.value.replace(".","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))})}if(4==e.column&&"ProvisionalPrice"==$self.dGrid.columns[e.column].field){$self.dGrid.records[e.index].ProvisionalPrice=$self.checkcommaordot(e,$self.dGrid.records[e.index].ProvisionalPrice);a=i.GetFormatAmount($self.dGrid.records[e.index].ProvisionalPrice,"init",n);$self.dGrid.records[e.index].ProvisionalPrice=i.GetConvertedString(a,n),$self.dGrid.refreshRow(e.index+1),t("#grid_"+$self.dGrid.name+"_rec_"+id).keydown(function(e){return!!(n||190!=e.keyCode&&110!=e.keyCode)&&((!n||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which?!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||e.target.value.indexOf(",")>-1&&(e.target.value=e.target.value.replace(",","")):e.target.value.indexOf(".")>-1&&(e.target.value=e.target.value.replace(".","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))})}if(6==e.column&&"InvoicePrice"==$self.dGrid.columns[e.column].field){$self.dGrid.records[e.index].InvoicePrice=$self.checkcommaordot(e,$self.dGrid.records[e.index].InvoicePrice);a=i.GetFormatAmount($self.dGrid.records[e.index].InvoicePrice,"init",n);$self.dGrid.records[e.index].InvoicePrice=i.GetConvertedString(a,n),$self.dGrid.refreshRow(e.index+1),t("#grid_"+$self.dGrid.name+"_rec_"+id).keydown(function(e){return!!(n||190!=e.keyCode&&110!=e.keyCode)&&((!n||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which?!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||e.target.value.indexOf(",")>-1&&(e.target.value=e.target.value.replace(",","")):e.target.value.indexOf(".")>-1&&(e.target.value=e.target.value.replace(".","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))})}},onChange:function(a){window.setTimeout(function(){if(null!=$self.dGrid.getChanges(a.recid)&&0==a.column&&"Date"==$self.dGrid.columns[a.column].field){var i=e.context.getContextAsInt($self.windowNo,"AD_Org_ID"),n=$self.dGrid.records[a.index].Amount,l=$self.dGrid.records[a.index].C_Currency_ID_K,s=$self.dGrid.records[a.index].C_ConversionType_ID,o=$self.dGrid.records[a.index].Date,r=$self.dGrid.records[a.index].Type,c=$self.dGrid.records[a.index].C_Payment_ID_K;t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetConvertedAmount",dataType:"json",type:"POST",data:{_paymentId:c,amount:n,currencyId:l,convsion_Id:s,date:o,paymentType:r,_org_id:i},error:function(){e.ADialog.info("ErrorWhileGettingData",null,"",""),self.$super.setBusy(!1)},success:function(t){t=JSON.parse(t),"Success"==e.Utility.Util.getValueOfString(t._message)?(_convertedAmt=e.Utility.Util.getValueOfDecimal(t.convtAmt),$self.dGrid.records[a.index].changes.ConvertedAmount=_convertedAmt,$self.dGrid.records[a.index].ConvertedAmount=_convertedAmt,$self.dGrid.refreshRow(a.index+1)):e.ADialog.info(t._message,null,"","")}})}},100)}}),this.dGrid.selectNone();var o=e.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),r=e.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),c=e.Utility.Util.getValueOfInt($self.cmbShipment.getValue());for(itm in $self.multiValues)for(item in $self.dGrid.records){t.grep($self.multiValues,function(e,t){return o>0?e.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&e.C_Order_ID_K==$self.dGrid.records[item].C_Order_ID_K:r>0?e.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&e.C_Invoice_ID_K==$self.dGrid.records[item].C_Invoice_ID_K:c>0?e.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&e.M_InOut_ID_K==$self.dGrid.records[item].M_InOut_ID_K:e.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K}).length>0&&$self.dGrid.select(parseInt(item)+1)}if(this.dGrid.records.length>0){$self.NonEditableRecord=[];for(var u=0;u<$self.dGrid.records.length;u++)t(t("#grid_"+$self.dGrid.name+"_rec_"+(u+1)).find("input[type=checkbox]")[1]).prop("checked",a[u].Select),$self.dGrid.records[u].C_InvoicePaymentTerm_ID==$self.dGrid.records[u].C_PaymentTerm_ID||0==$self.dGrid.records[u].C_InvoicePaymentTerm_ID||$self.dGrid.records[u].C_InvoicePaymentTerm_ID!=$self.dGrid.records[u].C_PaymentTerm_ID&&0==$self.dGrid.records[u].IsAdvance&&0==$self.dGrid.records[u].IsInvoicePTAdvance||(t("#grid_"+$self.dGrid.name+"_rec_"+(u+1)+"  input").attr("disabled",!0),$self.NonEditableRecord.push(u+1))}function d(){for(var e=0;e<$self.dGrid.records.length;e++)$self.NonEditableRecord.indexOf(e+1)>=0&&($self.dGrid.unselect(e+1),t("#grid_"+$self.dGrid.name+"_rec_"+(e+1)+"  input").attr("disabled",!0))}function g(e,a,i){var n=$self.dGrid.records[a].M_Product_ID_K,l=t.grep($self.editedItems,function(e,t){return o>0?e.M_Product_ID_K==n&&e.C_Order_ID_K==$self.dGrid.records[a].C_Order_ID_K:r>0?e.M_Product_ID_K==n&&e.C_Invoice_ID_K==$self.dGrid.records[a].C_Invoice_ID_K:c>0?e.M_Product_ID_K==n&&e.M_InOut_ID_K==$self.dGrid.records[a].M_InOut_ID_K:e.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K});if(l.length>0)$self.editedItems.splice($self.editedItems.indexOf(l[0]),1),$self.editedItems.push($self.dGrid.records[a]);else{for(var s=0,u=0;u<$self.editedItems.length;u++)if($self.editedItems[u].recid==$self.dGrid.records[a].recid){s=1;break}0==s&&$self.editedItems.push($self.dGrid.records[a])}}this.dGrid.on("change",function(t){if(d(),"QuantityEntered"==$self.dGrid.columns[t.column].field){var a=i.GetConvertedNumber(t.value_new,n);if($self.fromInvoice){if($self.dGrid.records[t.index].QuantityPending<a.toFixed(4))return e.ADialog.error("InvoiceQtyGreater"),void(t.value_new=t.value_original)}else if($self.dGrid.records[t.index].QuantityPending<a.toFixed(4))return e.ADialog.error("QtyCanNotbeGreater"),void(t.value_new=t.value_original);$self.dGrid.records[t.index].QuantityEntered=a.toFixed(4),(o>0||r>0)&&g("QuantityEntered",t.index,a.toFixed(4))}if("ProvisionalPrice"==$self.dGrid.columns[t.column].field){if((a=i.GetConvertedNumber(t.value_new,n))<0)return e.ADialog.error("PriceCantNegative"),void(t.value_new=t.value_original);$self.dGrid.records[t.index].ProvisionalPrice=a.toFixed(4),g("ProvisionalPrice",t.index,a.toFixed(4))}else if("InvoicePrice"==$self.dGrid.columns[t.column].field){if((a=i.GetConvertedNumber(t.value_new,n))<0)return e.ADialog.error("PriceCantNegative"),void(t.value_new=t.value_original);$self.dGrid.records[t.index].InvoicePrice=a.toFixed(4),g("InvoicePrice",t.index,a.toFixed(4))}else"M_AttributeSetInstance_ID"==$self.dGrid.columns[t.column].field?($self.dGrid.records[t.index].M_AttributeSetInstance_ID=t.value_new,(o>0||r>0)&&g("M_AttributeSetInstance_ID",t.index,t.value_new)):"Date"==$self.dGrid.columns[t.column].field&&(""!=t.value_new?$self.dGrid.records[t.index].Date=t.value_new:""!=t.value_previous?$self.dGrid.records[t.index].Date=t.value_previous:""!=t.value_original&&($self.dGrid.records[t.index].Date=t.value_original),""!=$self.dGrid.records[t.index].Date&&g("Date",t.index,$self.dGrid.records[t.index].Date))}),this.dGrid.on("click",function(t){t.preventDefault,d(),e.Env.getCtx().setContext($self.windowNo,"M_Product_ID",e.Utility.Util.getValueOfInt($self.dGrid.records[t.recid-1].M_Product_ID_K))});e.Application.contextUrl;this.dGrid.on("unselect",function(e){if(e.all)e.onComplete=function(){for(item in $self.dGrid.records){var e=t.grep($self.multiValues,function(e,t){return o>0?e.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&e.C_Order_ID_K==$self.dGrid.records[item].C_Order_ID_K:r>0?e.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&e.C_Invoice_ID_K==$self.dGrid.records[item].C_Invoice_ID_K:c>0?e.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&e.M_InOut_ID_K==$self.dGrid.records[item].M_InOut_ID_K:e.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K});e.length>0&&$self.multiValues.splice($self.multiValues.indexOf(e[0]),1)}};else{var a=w2ui[e.target].records[e.index].M_Product_ID_K,i=t.grep($self.multiValues,function(t,i){return o>0?t.M_Product_ID_K==a&&t.C_Order_ID_K==w2ui[e.target].records[e.index].C_Order_ID_K:r>0?t.M_Product_ID_K==a&&t.C_Invoice_ID_K==w2ui[e.target].records[e.index].C_Invoice_ID_K:c>0?t.M_Product_ID_K==a&&t.M_InOut_ID_K==w2ui[e.target].records[e.index].M_InOut_ID_K:t.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K});i.length>0&&$self.multiValues.splice($self.multiValues.indexOf(i[0]),1)}})},e.VCreateFrom=a}(VIS,jQuery)},3003:()=>{VAS=window.VAS||{},function(e,t){e.VAS_CashFlowWidget=function(){var e,a=0;this.frame,this.windowNo,this.widgetInfo;var i=this,n=null,l=null,s=t('<div class="h-100 w-100 vas-cashFlow-background">');this.initalize=function(){a=0!=VIS.Utility.Util.getValueOfInt(this.widgetInfo.AD_UserHomeWidgetID)?this.widgetInfo.AD_UserHomeWidgetID:i.windowNo,o(),(e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'))[0].style.visibility="visible",s.append(e),n=t('<div id="VAS-BarLine-ERP_'+a+'" class="vas-barline-cashFlow-container">');var r=t('<div class="d-flex justify-content-between vas-cashFlow-heading">'),c=t('<div class= "vas-cf-heading">'+VIS.Msg.getMsg("VAS_CashFlowWidget")+"</div>");$DifferentYearDataListDiv=t('<div class="input-group vis-input-wrap">'),$DifferentYearDataListLookUp=VIS.MLookupFactory.get(VIS.Env.getCtx(),a,0,VIS.DisplayType.List,"VAS_CashFlowWidgetList",ColumnIds.AD_Reference_ID,!1,null),(l=new VIS.Controls.VComboBox("VAS_CashFlowWidgetList",!0,!1,!0,$DifferentYearDataListLookUp,20)).setValue("05");var u=t('<div class="vis-control-wrap">');$DifferentYearDataListDiv.append(u),u.append(l.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")),$DifferentYearDataListDiv.append(u),r.append(c).append($DifferentYearDataListDiv),n.append(r),s.append(n),l.fireValueChanged=function(){l.setValue(l.getValue()),e[0].style.visibility="visible",n.find("#vas_norecordcont_"+a).remove(),i.getCashFlowvDetails()}},this.getCashFlowvDetails=function(){e[0].style.visibility="visible",VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetCashFlowData",{ListValue:l.getValue()},function(i){var l=i;if(s.find("canvas").remove(),null!=l&&null!=l.ErrorMessage)n.append('<div class="vas-igwidg-notfounddiv" id="vas_norecordcont_'+a+'">'+VIS.Msg.getMsg("VAS_RecordNotFound")+"</div>"),s.append(n);else{const e=l.stdPrecision,i={beforeInit:function(e){const t=e.legend.fit;e.legend.fit=function(){t.bind(e.legend)(),this.height+=-5}}},n={type:"bar",data:{labels:l.labels,datasets:[{label:VIS.Msg.getMsg("VAS_CashOut"),data:l.lstCashOutData,borderColor:"rgba(0,0,0,0)",borderWidth:0,backgroundColor:"rgba(255, 99, 132, 0.7)",order:1},{label:VIS.Msg.getMsg("VAS_CashIn"),data:l.lstCashInData,borderColor:"rgba(0,0,0,0)",borderWidth:0,backgroundColor:"rgba(0, 187, 0, 0.7)",order:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{grid:{display:!0}},y:{grid:{display:!1}}},plugins:{legend:{display:!0,position:"bottom",padding:{top:0,bottom:0}},tooltip:{enabled:!0,mode:"nearest",intersect:!0,callbacks:{label:function(t){const a=t.dataIndex,i=t.datasetIndex,n=t.chart.data.datasets[i],l=t.chart.data.labels,s=n.label,o=n.data[a];return s+" - "+l[a]+": "+parseFloat(o).toLocaleString(window.navigator.language,{minimumFractionDigits:e,maximumFractionDigits:e})}}}}},plugins:[i]},o=t('<canvas class="vas-expay-barline-canvas"></canvas>').css({width:"100%",height:"100%"});s.find("#VAS-BarLine-ERP_"+a).append(o);const r=o[0].getContext("2d");new Chart(r,n)||console.error("Failed to initialize the chart.")}e[0].style.visibility="hidden"})};var o=function(){ColumnIds=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetColumnID",{refernceName:"VAS_CashFlowWidgetList"},null)};this.getRoot=function(){return s},this.refreshWidget=function(){e[0].style.visibility="visible",n.find("#vas_norecordcont_"+a).remove(),i.getCashFlowvDetails()}},e.VAS_CashFlowWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.getCashFlowvDetails()},50)},e.VAS_CashFlowWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_CashFlowWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_CashFlowWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},3208:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.CalloutTax")}function n(){e.CalloutEngine.call(this,"VIS.CalloutTaxAmt")}function l(){e.CalloutEngine.call(this,"VIS.CalloutTaxAmount")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.Tax=function(t,i,n,l,s,o){if(null==s||0==s||""==s.toString())return"";var r=0,c=e.Env.ZERO,u=e.Env.ZERO;if(r=a.getValueOfInt(n.getValue("C_Tax_ID")),null!=n.getField("SurchargeAmt")){var d=0,g=!1,p=e.dataContext.getJSONRecord("MPriceList/GetPriceListData",a.getValueOfInt(n.getValue("M_PriceList_ID")).toString());null!=p&&(d=p.StdPrecision,g="Y"==p.IsTaxIncluded);var v=a.getValueOfDecimal(n.getValue("LineNetAmt")),_=e.dataContext.getJSONRecord("MTax/CalculateSurcharge",r.toString()+","+v.toString()+","+d.toString()+","+g.toString());u=_.TaxAmt,n.setValue("TaxAmt",u),n.setValue("SurchargeAmt",_.SurchargeAmt),g?n.setValue("GrandTotal",v):n.setValue("GrandTotal",v+u+_.SurchargeAmt)}else{c=e.dataContext.getJSONRecord("MTax/GetTaxRate",r.toString());v=a.getValueOfDecimal(n.getValue("LineNetAmt"));u=a.getValueOfDecimal(v*c/100),u=a.getValueOfDecimal(u.toFixed(2)),n.setValue("GrandTotal",u+v),n.setValue("taxamt",u)}return n=s=null,""},i.prototype.SetTaxExemptReason=function(i,n,l,s,o,r){if(null==o||0==o||""==o.toString()||this.isCalloutActive())return"";try{this.setCalloutActive(!0);var c="Y"==i.getWindowContext(n,"IsSOTrx",!0),u=a.getValueOfString(l.getValue("C_Tax_ID"));"C_InvoiceLine_ID"==l.getKeyColumnName()?u=a.getValueOfString(l.getValue("C_Tax_ID"))+","+a.getValueOfString(l.getValue("AD_Org_ID"))+","+a.getValueOfString(l.getValue("C_Invoice_ID"))+","+a.getValueOfString(i.getWindowContext(n,"C_BPartner_Location_ID"))+","+a.getValueOfString(c)+", "+l.getKeyColumnName().toString():"C_OrderLine_ID"==l.getKeyColumnName()&&(u=a.getValueOfString(l.getValue("C_Tax_ID"))+","+a.getValueOfString(l.getValue("AD_Org_ID"))+","+a.getValueOfString(l.getValue("C_Order_ID"))+","+a.getValueOfString(i.getWindowContext(n,"C_BPartner_Location_ID"))+","+a.getValueOfString(c)+", "+l.getKeyColumnName().toString());var d=e.dataContext.getJSONRecord("MTax/GetTaxExempt",u);null!=d&&(l.setValue("IsTaxExempt",!!a.getValueOfString(d.IsTaxExempt).equals("Y")),l.setValue("C_TaxExemptReason_ID",a.getValueOfInt(d.C_TaxExemptReason_ID))),""!=d.errorMsg&&c&&e.ADialog.info("","",d.errorMsg)}catch(e){return this.log.log(t.SEVERE,sql,e),this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),i=n=l=o=null,""},i.prototype.SetTaxRate=function(e,t,a,i,n,l){return null==n||0==n||""==n.toString()||this.isCalloutActive()||(this.setCalloutActive(!0),a.getValue("IsTaxExempt")&&a.setValue("Rate",0),this.setCalloutActive(!1),a=n=null),""},e.Model.CalloutTax=i,e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.TaxID=function(t,i,n,l,s,o){if(null==s||""==s.toString()||0==a.getValueOfInt(s))return"";if(this.isCalloutActive())return"";try{this.setCalloutActive(!0);var r=e.dataContext.getJSONRecord("MTax/GetTaxRate",a.getValueOfInt(s));if(0!=r){var c=a.getValueOfDecimal(n.getValue("ApprovedExpenseAmt"))*r/100;c=c.toFixed(2),n.setValue("TaxAmt",c)}else n.setValue("TaxAmt",e.Env.ZERO);this.setCalloutActive(!1)}catch(e){this.setCalloutActive(!1)}return n=s=null,""},n.prototype.ExpenseAmt=function(t,i,n,l,s,o){if(null==s||""==s.toString()||0==a.getValueOfInt(s))return"";if(this.isCalloutActive())return"";try{this.setCalloutActive(!0);var r=e.dataContext.getJSONRecord("MTax/GetTaxRate",a.getValueOfInt(n.getValue("C_Tax_ID")));if(0!=r){var c=a.getValueOfDecimal(s)*r/100;c=c.toFixed(2),n.setValue("TaxAmt",c)}else n.setValue("TaxAmt",e.Env.ZERO);this.setCalloutActive(!1)}catch(e){this.setCalloutActive(!1)}return n=s=null,""},e.Model.CalloutTaxAmt=n,e.Utility.inheritPrototype(l,e.CalloutEngine),l.prototype.PaymentTaxAmount=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);try{var r=e.dataContext.getJSONRecord("MCurrency/GetCurrency",n.getValue("C_Currency_ID").toString()).StdPrecision;if("C_Tax_ID"==l.getColumnName()){var c=null;if(null!=n.getField("SurchargeAmt"))return c=e.dataContext.getJSONRecord("MTax/CalculateSurcharge",s.toString()+","+n.getValue("PayAmt").toString()+","+r.toString()),n.setValue("TaxAmount",c.TaxAmt),n.setValue("SurchargeAmt",c.SurchargeAmt),this.setCalloutActive(!1),"";if(c=e.dataContext.getJSONRecord("MTax/GetTaxRate",s.toString()),!((d=a.getValueOfDecimal(c))>0))return n.setValue("TaxAmount",0),this.setCalloutActive(!1),"";var u=a.getValueOfDecimal(a.getValueOfDecimal(n.getValue("PayAmt"))-a.getValueOfDecimal(n.getValue("PayAmt"))/(d/100+1));u=a.getValueOfDecimal(u.toFixed(r)),n.setValue("TaxAmount",u)}else{if(!(a.getValueOfInt(n.getValue("C_Tax_ID"))>0))return this.setCalloutActive(!1),"";var d;c=null;if(null!=n.getField("SurchargeAmt"))return c=e.dataContext.getJSONRecord("MTax/CalculateSurcharge",n.getValue("C_Tax_ID").toString()+","+n.getValue("PayAmt").toString()+","+r.toString()),n.setValue("TaxAmount",c.TaxAmt),n.setValue("SurchargeAmt",c.SurchargeAmt),this.setCalloutActive(!1),"";if(c=e.dataContext.getJSONRecord("MTax/GetTaxRate",n.getValue("C_Tax_ID").toString()),!((d=a.getValueOfDecimal(c))>0))return n.setValue("TaxAmount",0),this.setCalloutActive(!1),"";u=a.getValueOfDecimal(a.getValueOfDecimal(n.getValue("PayAmt"))-a.getValueOfDecimal(n.getValue("PayAmt"))/(d/100+1));u=a.getValueOfDecimal(u.toFixed(r)),n.setValue("TaxAmount",u)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),n=l=s=null,""},l.prototype.CashLineTaxAmount=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);try{var r=2;if("C_Tax_ID"==l.getColumnName()||a.getValueOfInt(n.getValue("C_Tax_ID"))>0)r=e.dataContext.getJSONRecord("MCurrency/GetCurrency",t.getContext(i,"C_Currency_ID").toString()).StdPrecision;if("C_Tax_ID"==l.getColumnName()){if(0==a.getValueOfDecimal(n.getValue("Amount")))return this.setCalloutActive(!1),"";var c=null;if(null!=n.getField("SurchargeAmt"))return c=e.dataContext.getJSONRecord("MTax/CalculateSurcharge",s.toString()+","+n.getValue("Amount").toString()+","+r.toString()),n.setValue("TaxAmt",c.TaxAmt),n.setValue("SurchargeAmt",c.SurchargeAmt),this.setCalloutActive(!1),"";if(c=e.dataContext.getJSONRecord("MTax/GetTaxRate",s.toString()),!((d=a.getValueOfDecimal(c))>0))return n.setValue("TaxAmt",0),this.setCalloutActive(!1),"";var u=a.getValueOfDecimal(a.getValueOfDecimal(n.getValue("Amount"))-a.getValueOfDecimal(n.getValue("Amount"))/(d/100+1));u=a.getValueOfDecimal(u.toFixed(r)),n.setValue("TaxAmt",u)}else{if(!(a.getValueOfInt(n.getValue("C_Tax_ID"))>0))return this.setCalloutActive(!1),"";var d;c=null;if(null!=n.getField("SurchargeAmt"))return c=e.dataContext.getJSONRecord("MTax/CalculateSurcharge",n.getValue("C_Tax_ID").toString()+","+n.getValue("Amount").toString()+","+r.toString()),n.setValue("TaxAmt",c.TaxAmt),n.setValue("SurchargeAmt",c.SurchargeAmt),this.setCalloutActive(!1),"";if(c=e.dataContext.getJSONRecord("MTax/GetTaxRate",n.getValue("C_Tax_ID").toString()),!((d=a.getValueOfDecimal(c))>0))return n.setValue("TaxAmt",0),this.setCalloutActive(!1),"";u=a.getValueOfDecimal(a.getValueOfDecimal(n.getValue("Amount"))-a.getValueOfDecimal(n.getValue("Amount"))/(d/100+1));u=a.getValueOfDecimal(u.toFixed(r)),n.setValue("TaxAmt",u)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),t=i=n=l=s=null,""},l.prototype.BankStatementLineTaxAmount=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);var r="";try{r=n.getValue("C_Currency_ID").toString();var c=e.dataContext.getJSONRecord("MCurrency/GetCurrency",r).StdPrecision;if("C_Tax_ID"==l.getColumnName()){if(0==a.getValueOfDecimal(n.getValue("ChargeAmt")))return this.setCalloutActive(!1),n=l=s=null,"";var u=null;if(null!=n.getField("SurchargeAmt"))return u=e.dataContext.getJSONRecord("MTax/CalculateSurcharge",s.toString()+","+n.getValue("ChargeAmt").toString()+","+c.toString()),n.setValue("TaxAmt",u.TaxAmt),n.setValue("SurchargeAmt",u.SurchargeAmt),this.setCalloutActive(!1),"";if(u=e.dataContext.getJSONRecord("MTax/GetTaxRate",s.toString()),!((g=a.getValueOfDecimal(u))>0))return n.setValue("TaxAmt",0),this.setCalloutActive(!1),n=l=s=null,"";var d=a.getValueOfDecimal(a.getValueOfDecimal(n.getValue("ChargeAmt"))-a.getValueOfDecimal(n.getValue("ChargeAmt"))/(g/100+1));d=a.getValueOfDecimal(d.toFixed(c)),n.setValue("TaxAmt",d)}else{if(!(a.getValueOfInt(n.getValue("C_Tax_ID"))>0))return this.setCalloutActive(!1),n=l=s=null,"";var g;u=null;if(null!=n.getField("SurchargeAmt"))return u=e.dataContext.getJSONRecord("MTax/CalculateSurcharge",n.getValue("C_Tax_ID").toString()+","+n.getValue("ChargeAmt").toString()+","+c.toString()),n.setValue("TaxAmt",u.TaxAmt),n.setValue("SurchargeAmt",u.SurchargeAmt),this.setCalloutActive(!1),"";if(u=e.dataContext.getJSONRecord("MTax/GetTaxRate",n.getValue("C_Tax_ID").toString()),!((g=a.getValueOfDecimal(u))>0))return n.setValue("TaxAmt",0),this.setCalloutActive(!1),n=l=s=null,"";d=a.getValueOfDecimal(a.getValueOfDecimal(n.getValue("ChargeAmt"))-a.getValueOfDecimal(n.getValue("ChargeAmt"))/(g/100+1));d=a.getValueOfDecimal(d.toFixed(c)),n.setValue("TaxAmt",d)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),n=l=s=null,""},e.Model.CalloutTaxAmount=l}(VIS,jQuery)},3225:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutOfferSerIncluded")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.CalculatePrice=function(e,t,a){return Decimal.Subtract(Decimal.Multiply(e,t),a)},a.prototype.CalculateRebate=function(e,t,a){return Decimal.Multiply(Decimal.Multiply(e,t),Decimal.Multiply(new Decimal(.01),a))},a.prototype.OfferServices=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r=24,c=t.getValueOfInt(s);if(null==c||0==c)return"";var u,d,g,p,v,_,V,A,m,f=0,D=new Decimal(0),h=new Decimal(0),C=new Decimal(0),S=null;try{for((I=[])[0]=new e.DB.SqlParam("@FO_SERVICE_ID",c),S=e.DB.executeReader("select uom.FO_HOTEL_UOM_ID,s.DESCRIPTION from FO_HOTEL_UOM uom inner join FO_SERVICE s ON(uom.FO_HOTEL_UOM_ID= s.FO_HOTEL_UOM_ID) where s.FO_SERVICE_ID=@FO_SERVICE_ID ",I,null);S.read();)f=t.getValueOfInt(S[0]),n.setValue("AUOM_ID",f),n.setValue("CG1UOM_ID",f),n.setValue("CG2UOM_ID",f),n.setValue("DESCRIPTION",t.getValueOfString(S[1]));S.close()}catch(e){this.setCalloutActive(!1),null!=S&&S.close(),this.log.severe(e.toString())}try{var I;for((I=[])[0]=new e.DB.SqlParam("@FO_SERVICE_ID",c),S=e.DB.executeReader("select PRICE,CHILDGROUP1,CHILDGROUP2,UOM1,UOM2 from FO_SERVICE_PRICE_PRICELINE where CREATED=(select max(CREATED) from FO_SERVICE_PRICE_PRICELINE where FO_SERVICE_ID=@FO_SERVICE_ID)",I,null);S.read();)D=t.getValueOfDecimal(S[0]),h=t.getValueOfDecimal(S[1]),C=t.getValueOfDecimal(S[2]),A=S[3].toString(),m=S[4].toString(),A.equals("Y")&&(h=Decimal.Multiply(Decimal.Multiply(D,h),new Decimal(.01))),m.equals("Y")&&(C=Decimal.Multiply(Decimal.Multiply(D,C),new Decimal(.01))),n.setValue("APRICE",D),n.setValue("CG1PRICE",h),n.setValue("CG2PRICE",C);S.close()}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}var y,O,T=n.getValue("AUOM_ID").toString(),w=t.getValueOfInt(n.getValue("ANUM")),P=t.getValueOfDecimal(n.getValue("AP0RICE")),b=t.getValueOfDecimal(n.getValue("AREBATE")),M=t.getValueOfInt(n.getValue("CG1NUM")),x=t.getValueOfInt(n.getValue("CG2NUM")),N=t.getValueOfDecimal(n.getValue("CG1P0RICE")),L=t.getValueOfDecimal(n.getValue("CG2PRICE")),R=t.getValueOfDateTime(n.getValue("ADATETO")),U=t.getValueOfDateTime(n.getValue("ADATEFROM")),E=Utility.timeUtil.getDaysBetween(U,R),k=U.Subtract(R),G=E/30,B=E/7;y=0==E%30?G:G+1,O=0==E%7?B:B+1;k.TotalMilliseconds;var F=k.TotalSeconds,Q=k.TotalMinutes;if(0==t.getValueOfInt(b))switch(v=e.Env.ZERO,int.Parse(T)){case 1000003:u=P,d=N,g=L,d=N,n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000004:u=CalculatePrice(new Decimal(w),P,v),d=CalculatePrice(new Decimal(M),N,v),g=CalculatePrice(new Decimal(x),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=Decimal.Add(Decimal.Add(u,d),g),n.setValue("GRAND_TOTAL",p);break;case 1000005:u=CalculatePrice(new Decimal(w),P,v),d=CalculatePrice(new Decimal(M),N,v),g=CalculatePrice(new Decimal(x),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000006:u=CalculatePrice(new Decimal(E),P,v),d=CalculatePrice(new Decimal(E),N,v),g=CalculatePrice(new Decimal(E),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000007:u=CalculatePrice(new Decimal(y),P,v),d=CalculatePrice(new Decimal(y),N,v),g=CalculatePrice(new Decimal(y),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000008:u=CalculatePrice(new Decimal(O),P,v),d=CalculatePrice(new Decimal(O),N,v),g=CalculatePrice(new Decimal(O),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000009:u=CalculatePrice(new Decimal(E+1),P,v),d=CalculatePrice(new Decimal(E+1),N,v),g=CalculatePrice(new Decimal(E+1),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000010:u=CalculatePrice(new Decimal(r*E),P,v),d=CalculatePrice(new Decimal(r*E),N,v),g=CalculatePrice(new Decimal(r*E),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000011:u=CalculatePrice(new Decimal(Q),P,v),d=CalculatePrice(new Decimal(Q),N,v),g=CalculatePrice(new Decimal(Q),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000012:u=CalculatePrice(new Decimal(F),P,v),d=CalculatePrice(new Decimal(F),N,v),g=CalculatePrice(new Decimal(F),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000013:u=CalculatePrice(new Decimal(E*w),P,v),d=CalculatePrice(new Decimal(E*M),N,v),g=CalculatePrice(new Decimal(E*x),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=Decimal.Add(Decimal.Add(u,d),g),n.setValue("GRAND_TOTAL",p);break;case 1000014:u=CalculatePrice(new Decimal(E*w),P,v),d=CalculatePrice(new Decimal(E*M),N,v),g=CalculatePrice(new Decimal(E*x),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000015:u=CalculatePrice(new Decimal(w*O),P,v),d=CalculatePrice(new Decimal(M*O),N,v),g=CalculatePrice(new Decimal(x*O),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=Decimal.Add(Decimal.Add(u,d),g),n.setValue("GRAND_TOTAL",p);break;case 1000016:u=CalculatePrice(new Decimal(w*O),P,v),d=CalculatePrice(new Decimal(M*O),N,v),g=CalculatePrice(new Decimal(x*O),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000017:u=CalculatePrice(new Decimal(w*(E+1)),P,v),d=CalculatePrice(new Decimal(M*(E+1)),N,v),g=CalculatePrice(new Decimal(x*(E+1)),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=Decimal.Add(Decimal.Add(u,d),g),n.setValue("GRAND_TOTAL",p);break;case 1000018:u=CalculatePrice(new Decimal((E+1)*w),P,v),d=CalculatePrice(new Decimal((E+1)*M),N,v),g=CalculatePrice(new Decimal((E+1)*x),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000019:u=CalculatePrice(new Decimal(r*E*w),P,v),d=CalculatePrice(new Decimal(r*E*M),N,v),g=CalculatePrice(new Decimal(r*E*x),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=Decimal.Add(Decimal.Add(u,d),g),n.setValue("GRAND_TOTAL",p);break;case 1000020:u=CalculatePrice(new Decimal(r*E*w),P,v),d=CalculatePrice(new Decimal(r*E*M),N,v),g=CalculatePrice(new Decimal(r*E*x),L,v),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p)}else switch(int.Parse(T)){case 1000003:u=P,d=N,g=L,n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000004:v=CalculateRebate(new Decimal(w),P,b),u=CalculatePrice(new Decimal(w),P,v),_=CalculateRebate(new Decimal(M),N,b),d=CalculatePrice(new Decimal(M),N,_),V=CalculateRebate(new Decimal(x),L,b),g=CalculatePrice(new Decimal(x),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=Decimal.Add(Decimal.Add(u,d),g),n.setValue("GRAND_TOTAL",p);break;case 1000005:v=CalculateRebate(new Decimal(w),P,b),u=CalculatePrice(new Decimal(w),P,v),_=CalculateRebate(new Decimal(M),N,b),d=CalculatePrice(new Decimal(M),N,_),V=CalculateRebate(new Decimal(x),L,b),g=CalculatePrice(new Decimal(x),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000006:v=CalculateRebate(new Decimal(E),P,b),u=CalculatePrice(new Decimal(E),P,v),_=CalculateRebate(new Decimal(E),N,b),d=CalculatePrice(new Decimal(E),N,_),V=CalculateRebate(new Decimal(E),L,b),g=CalculatePrice(new Decimal(E),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000007:v=CalculateRebate(new Decimal(y),P,b),u=CalculatePrice(new Decimal(y),P,v),_=CalculateRebate(new Decimal(y),N,b),d=CalculatePrice(new Decimal(y),N,_),V=CalculateRebate(new Decimal(y),L,b),g=CalculatePrice(new Decimal(y),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000008:v=CalculateRebate(new Decimal(O),P,b),u=CalculatePrice(new Decimal(O),P,v),_=CalculateRebate(new Decimal(O),N,b),d=CalculatePrice(new Decimal(O),N,_),V=CalculateRebate(new Decimal(O),L,b),g=CalculatePrice(new Decimal(O),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000009:v=CalculateRebate(new Decimal(E+1),P,b),u=CalculatePrice(new Decimal(E+1),P,v),_=CalculateRebate(new Decimal(E+1),N,b),d=CalculatePrice(new Decimal(E+1),N,_),V=CalculateRebate(new Decimal(E+1),L,b),g=CalculatePrice(new Decimal(E+1),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000010:v=CalculateRebate(new Decimal(r*E),P,b),u=CalculatePrice(new Decimal(r*E),P,v),_=CalculateRebate(new Decimal(r*E),N,b),d=CalculatePrice(new Decimal(r*E),N,_),V=CalculateRebate(new Decimal(r*E),L,b),g=CalculatePrice(new Decimal(r*E),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000011:v=CalculateRebate(new Decimal(Q),P,b),u=CalculatePrice(new Decimal(Q),P,v),_=CalculateRebate(new Decimal(Q),N,b),d=CalculatePrice(new Decimal(Q),N,_),V=CalculateRebate(new Decimal(Q),L,b),g=CalculatePrice(new Decimal(Q),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000012:v=CalculateRebate(new Decimal(F),P,b),u=CalculatePrice(new Decimal(F),P,v),_=CalculateRebate(new Decimal(F),N,b),d=CalculatePrice(new Decimal(F),N,_),V=CalculateRebate(new Decimal(F),L,b),g=CalculatePrice(new Decimal(F),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000013:v=CalculateRebate(new Decimal(E*w),P,b),u=CalculatePrice(new Decimal(E*w),P,v),_=CalculateRebate(new Decimal(E*M),N,b),d=CalculatePrice(new Decimal(E*M),N,_),V=CalculateRebate(new Decimal(E*x),L,b),g=CalculatePrice(new Decimal(E*x),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=Decimal.Add(Decimal.Add(u,d),g),n.setValue("GRAND_TOTAL",p);break;case 1000014:v=CalculateRebate(new Decimal(E*w),P,b),u=CalculatePrice(new Decimal(E*w),P,v),_=CalculateRebate(new Decimal(E*M),N,b),d=CalculatePrice(new Decimal(E*M),N,_),V=CalculateRebate(new Decimal(E*x),L,b),g=CalculatePrice(new Decimal(E*x),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000015:v=CalculateRebate(new Decimal(w*O),P,b),u=CalculatePrice(new Decimal(w*O),P,v),_=CalculateRebate(new Decimal(M*O),N,b),d=CalculatePrice(new Decimal(M*O),N,_),V=CalculateRebate(new Decimal(x*O),L,b),g=CalculatePrice(new Decimal(x*O),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=Decimal.Add(Decimal.Add(u,d),g),n.setValue("GRAND_TOTAL",p);break;case 1000016:v=CalculateRebate(new Decimal(w*O),P,b),u=CalculatePrice(new Decimal(w*O),P,v),_=CalculateRebate(new Decimal(M*O),N,b),d=CalculatePrice(new Decimal(M*O),N,_),V=CalculateRebate(new Decimal(x*O),L,b),g=CalculatePrice(new Decimal(x*O),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000017:v=CalculateRebate(new Decimal(w*(E+1)),P,b),u=CalculatePrice(new Decimal(w*(E+1)),P,v),_=CalculateRebate(new Decimal(M*(E+1)),N,b),d=CalculatePrice(new Decimal(M*(E+1)),N,_),V=CalculateRebate(new Decimal(x*(E+1)),L,b),g=CalculatePrice(new Decimal(x*(E+1)),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=Decimal.Add(Decimal.Add(u,d),g),n.setValue("GRAND_TOTAL",p);break;case 1000018:v=CalculateRebate(new Decimal(w*(E+1)),P,b),u=CalculatePrice(new Decimal((E+1)*w),P,v),_=CalculateRebate(new Decimal(M*(E+1)),N,b),d=CalculatePrice(new Decimal(M*(E+1)),N,_),V=CalculateRebate(new Decimal(x*(E+1)),L,b),g=CalculatePrice(new Decimal(x*(E+1)),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p);break;case 1000019:v=CalculateRebate(new Decimal(r*E*w),P,b),u=CalculatePrice(new Decimal(r*E*w),P,v),_=CalculateRebate(new Decimal(r*E*M),N,b),d=CalculatePrice(new Decimal(r*E*M),N,_),V=CalculateRebate(new Decimal(r*E*x),L,b),g=CalculatePrice(new Decimal(r*E*x),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=Decimal.Add(Decimal.Add(u,d),g),n.setValue("GRAND_TOTAL",p);break;case 1000020:v=CalculateRebate(new Decimal(r*E*w),P,b),u=CalculatePrice(new Decimal(r*E*w),P,v),_=CalculateRebate(new Decimal(r*E*M),N,b),d=CalculatePrice(new Decimal(r*E*M),N,_),V=CalculateRebate(new Decimal(r*E*x),L,b),g=CalculatePrice(new Decimal(r*E*x),L,V),n.setValue("ATOTAL_AMOUNT",u),n.setValue("CG1TOTAL_AMOUNT",d),n.setValue("CG2TOTAL_AMOUNT",g),p=u,n.setValue("GRAND_TOTAL",p)}return 0==w&&(n.setValue("ATOTAL_AMOUNT",0),n.setValue("GRAND_TOTAL",0)),0==M&&n.setValue("CG1TOTAL_AMOUNT",0),0==x&&n.setValue("CG2TOTAL_AMOUNT",0),n=s=null,""},a.prototype.tochkdate=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r,c,u,d,g,p,v,_=24,V=t.getValueOfDateTime(s);if(null==V||V.equals(0))return"";var A=t.getValueOfDateTime(s),m=t.getValueOfDateTime(n.getValue("ADATEFROM")),f=t.getValueOfInt(n.getValue("CG1NUM")),D=t.getValueOfInt(n.getValue("CG2NUM")),h=t.getValueOfDecimal(n.getValue("CG1PRICE")),C=t.getValueOfDecimal(n.getValue("CG2PRICE"));try{var S;if(A=t.getValueOfDateTime(n.getValue("ADATETO")),Utility.timeUtil.getDaysBetween(m,A)<=0)S=Utility.TimeUtil.AddDays(m,1),n.setValue("ADATETO",S);else if(A.compareTo(m)>0){var I,y,O=A.Subtract(m),T=Utility.timeUtil.getDaysBetween(m,A),w=(O.TotalMilliseconds,O.TotalMinutes),P=O.TotalMinutes,b=T/30,M=T/7;I=0==T%30?b:b+1,y=0==T%7?M:M+1;var x=t.getValueOfDateTime(n.getValue("ADATEFROM"));n.setValue("CG1DATETO",A),n.setValue("CG2DATETO",A),n.setValue("CG1DATEFROM",x),n.setValue("CG2DATEFROM",x);var N=n.getValue("AUOM_ID").toString();""!=N&&0!=N.toString().trim().length||(N="0");var L=t.getValueOfDecimal(n.getValue("APRICE")),R=t.getValueOfInt(n.getValue("ANUM")),U=t.getValueOfDecimal(n.getValue("AREBATE"));if(0==t.getValueOfInt(U))switch(d=e.Env.ZERO,int.Parse(N)){case 1000003:r=L,c=h,u=C,c=h,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:r=CalculatePrice(new Decimal(R),L,d),c=CalculatePrice(new Decimal(f),h,d),u=CalculatePrice(new Decimal(D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:r=CalculatePrice(new Decimal(R),L,d),c=CalculatePrice(new Decimal(f),h,d),u=CalculatePrice(new Decimal(D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:r=CalculatePrice(new Decimal(T),L,d),c=CalculatePrice(new Decimal(T),h,d),u=CalculatePrice(new Decimal(T),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:r=CalculatePrice(new Decimal(I),L,d),c=CalculatePrice(new Decimal(I),h,d),u=CalculatePrice(new Decimal(I),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:r=CalculatePrice(new Decimal(y),L,d),c=CalculatePrice(new Decimal(y),h,d),u=CalculatePrice(new Decimal(y),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:r=CalculatePrice(new Decimal(T+1),L,d),c=CalculatePrice(new Decimal(T+1),h,d),u=CalculatePrice(new Decimal(T+1),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:r=CalculatePrice(new Decimal(_*T),L,d),c=CalculatePrice(new Decimal(_*T),h,d),u=CalculatePrice(new Decimal(_*T),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:r=CalculatePrice(new Decimal(P),L,d),c=CalculatePrice(new Decimal(P),h,d),u=CalculatePrice(new Decimal(P),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:r=CalculatePrice(new Decimal(w),L,d),c=CalculatePrice(new Decimal(w),h,d),u=CalculatePrice(new Decimal(w),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:r=CalculatePrice(new Decimal(T*R),L,d),c=CalculatePrice(new Decimal(T*f),h,d),u=CalculatePrice(new Decimal(T*D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:r=CalculatePrice(new Decimal(T*R),L,d),c=CalculatePrice(new Decimal(T*f),h,d),u=CalculatePrice(new Decimal(T*D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:r=CalculatePrice(new Decimal(R*y),L,d),c=CalculatePrice(new Decimal(f*y),h,d),u=CalculatePrice(new Decimal(D*y),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:r=CalculatePrice(new Decimal(R*y),L,d),c=CalculatePrice(new Decimal(f*y),h,d),u=CalculatePrice(new Decimal(D*y),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:r=CalculatePrice(new Decimal(R*(T+1)),L,d),c=CalculatePrice(new Decimal(f*(T+1)),h,d),u=CalculatePrice(new Decimal(D*(T+1)),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:r=CalculatePrice(new Decimal((T+1)*R),L,d),c=CalculatePrice(new Decimal((T+1)*f),h,d),u=CalculatePrice(new Decimal((T+1)*D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:r=CalculatePrice(new Decimal(_*T*R),L,d),c=CalculatePrice(new Decimal(_*T*f),h,d),u=CalculatePrice(new Decimal(_*T*D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:r=CalculatePrice(new Decimal(_*T*R),L,d),c=CalculatePrice(new Decimal(_*T*f),h,d),u=CalculatePrice(new Decimal(_*T*D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v)}else switch(int.Parse(N)){case 1000003:r=L,c=h,u=C,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:d=CalculateRebate(new Decimal(R),L,U),r=CalculatePrice(new Decimal(R),L,d),g=CalculateRebate(new Decimal(f),h,U),c=CalculatePrice(new Decimal(f),h,g),p=CalculateRebate(new Decimal(D),C,U),u=CalculatePrice(new Decimal(D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:d=CalculateRebate(new Decimal(R),L,U),r=CalculatePrice(new Decimal(R),L,d),g=CalculateRebate(new Decimal(f),h,U),c=CalculatePrice(new Decimal(f),h,g),p=CalculateRebate(new Decimal(D),C,U),u=CalculatePrice(new Decimal(D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:d=CalculateRebate(new Decimal(T),L,U),r=CalculatePrice(new Decimal(T),L,d),g=CalculateRebate(new Decimal(T),h,U),c=CalculatePrice(new Decimal(T),h,g),p=CalculateRebate(new Decimal(T),C,U),u=CalculatePrice(new Decimal(T),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:d=CalculateRebate(new Decimal(I),L,U),r=CalculatePrice(new Decimal(I),L,d),g=CalculateRebate(new Decimal(I),h,U),c=CalculatePrice(new Decimal(I),h,g),p=CalculateRebate(new Decimal(I),C,U),u=CalculatePrice(new Decimal(I),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:d=CalculateRebate(new Decimal(y),L,U),r=CalculatePrice(new Decimal(y),L,d),g=CalculateRebate(new Decimal(y),h,U),c=CalculatePrice(new Decimal(y),h,g),p=CalculateRebate(new Decimal(y),C,U),u=CalculatePrice(new Decimal(y),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:d=CalculateRebate(new Decimal(T+1),L,U),r=CalculatePrice(new Decimal(T+1),L,d),g=CalculateRebate(new Decimal(T+1),h,U),c=CalculatePrice(new Decimal(T+1),h,g),p=CalculateRebate(new Decimal(T+1),C,U),u=CalculatePrice(new Decimal(T+1),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:d=CalculateRebate(new Decimal(_*T),L,U),r=CalculatePrice(new Decimal(_*T),L,d),g=CalculateRebate(new Decimal(_*T),h,U),c=CalculatePrice(new Decimal(_*T),h,g),p=CalculateRebate(new Decimal(_*T),C,U),u=CalculatePrice(new Decimal(_*T),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:d=CalculateRebate(new Decimal(P),L,U),r=CalculatePrice(new Decimal(P),L,d),g=CalculateRebate(new Decimal(P),h,U),c=CalculatePrice(new Decimal(P),h,g),p=CalculateRebate(new Decimal(P),C,U),u=CalculatePrice(new Decimal(P),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:d=CalculateRebate(new Decimal(w),L,U),r=CalculatePrice(new Decimal(w),L,d),g=CalculateRebate(new Decimal(w),h,U),c=CalculatePrice(new Decimal(w),h,g),p=CalculateRebate(new Decimal(w),C,U),u=CalculatePrice(new Decimal(w),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:d=CalculateRebate(new Decimal(T*R),L,U),r=CalculatePrice(new Decimal(T*R),L,d),g=CalculateRebate(new Decimal(T*f),h,U),c=CalculatePrice(new Decimal(T*f),h,g),p=CalculateRebate(new Decimal(T*D),C,U),u=CalculatePrice(new Decimal(T*D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:d=CalculateRebate(new Decimal(T*R),L,U),r=CalculatePrice(new Decimal(T*R),L,d),g=CalculateRebate(new Decimal(T*f),h,U),c=CalculatePrice(new Decimal(T*f),h,g),p=CalculateRebate(new Decimal(T*D),C,U),u=CalculatePrice(new Decimal(T*D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:d=CalculateRebate(new Decimal(R*y),L,U),r=CalculatePrice(new Decimal(R*y),L,d),g=CalculateRebate(new Decimal(f*y),h,U),c=CalculatePrice(new Decimal(f*y),h,g),p=CalculateRebate(new Decimal(D*y),C,U),u=CalculatePrice(new Decimal(D*y),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:d=CalculateRebate(new Decimal(R*y),L,U),r=CalculatePrice(new Decimal(R*y),L,d),g=CalculateRebate(new Decimal(f*y),h,U),c=CalculatePrice(new Decimal(f*y),h,g),p=CalculateRebate(new Decimal(D*y),C,U),u=CalculatePrice(new Decimal(D*y),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:d=CalculateRebate(new Decimal(R*(T+1)),L,U),r=CalculatePrice(new Decimal(R*(T+1)),L,d),g=CalculateRebate(new Decimal(f*(T+1)),h,U),c=CalculatePrice(new Decimal(f*(T+1)),h,g),p=CalculateRebate(new Decimal(D*(T+1)),C,U),u=CalculatePrice(new Decimal(D*(T+1)),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:d=CalculateRebate(new Decimal(R*(T+1)),L,U),r=CalculatePrice(new Decimal((T+1)*R),L,d),g=CalculateRebate(new Decimal(f*(T+1)),h,U),c=CalculatePrice(new Decimal(f*(T+1)),h,g),p=CalculateRebate(new Decimal(D*(T+1)),C,U),u=CalculatePrice(new Decimal(D*(T+1)),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:d=CalculateRebate(new Decimal(_*T*R),L,U),r=CalculatePrice(new Decimal(_*T*R),L,d),g=CalculateRebate(new Decimal(_*T*f),h,U),c=CalculatePrice(new Decimal(_*T*f),h,g),p=CalculateRebate(new Decimal(_*T*D),C,U),u=CalculatePrice(new Decimal(_*T*D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:d=CalculateRebate(new Decimal(_*T*R),L,U),r=CalculatePrice(new Decimal(_*T*R),L,d),g=CalculateRebate(new Decimal(_*T*f),h,U),c=CalculatePrice(new Decimal(_*T*f),h,g),p=CalculateRebate(new Decimal(_*T*D),C,U),u=CalculatePrice(new Decimal(_*T*D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v)}0==R&&(n.setValue("ATOTAL_AMOUNT",0),n.setValue("GRAND_TOTAL",0)),0==f&&n.setValue("CG1TOTAL_AMOUNT",0),0==D&&n.setValue("CG2TOTAL_AMOUNT",0)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return n=s=null,""},a.prototype.fromchkdate=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r,c,u,d,g,p,v,_=24,V=t.getValueOfDateTime(s);if(null==V||V.equals(0))return"";var A=t.getValueOfDateTime(n.getValue("ADATEFROM")),m=t.getValueOfDateTime(n.getValue("ADATETO")),f=t.getValueOfInt(n.getValue("CG1NUM")),D=t.getValueOfInt(n.getValue("CG2NUM")),h=t.getValueOfDecimal(n.getValue("CG1PRICE")),C=t.getValueOfDecimal(n.getValue("CG2PRICE"));try{var S;if((A=t.getValueOfDateTime(n.getValue("ADATEFROM"))).compareTo(m)>0)n.setValue("CG1DATEFROM",A),n.setValue("CG2DATEFROM",A),S=Utility.timeUtil.addDays(A,1),n.setValue("ADATETO",S);else if(m.compareTo(A)>0){var I,y,O=m.Subtract(A),T=Utility.timeUtil.getDaysBetween(A,m),w=(O.TotalMilliseconds,O.TotalSeconds),P=O.TotalMinutes,b=T/30,M=T/7;I=0==T%30?b:b+1,y=0==T%7?M:M+1;var x=t.getValueOfDateTime(n.getValue("ADATEFROM"));n.setValue("CG1DATETO",m),n.setValue("CG2DATETO",m),n.setValue("CG1DATEFROM",x),n.setValue("CG2DATEFROM",x);var N=n.getValue("AUOM_ID").toString();""!=N&&0!=N.toString().trim().length||(N="0");var L=t.getValueOfDecimal(n.getValue("APRICE")),R=t.getValueOfInt(n.getValue("ANUM")),U=t.getValueOfDecimal(n.getValue("AREBATE"));if(0==t.getValueOfInt(U))switch(d=e.Env.ZERO,int.Parse(N)){case 1000003:r=L,c=h,u=C,c=h,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:r=CalculatePrice(new Decimal(R),L,d),c=CalculatePrice(new Decimal(f),h,d),u=CalculatePrice(new Decimal(D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:r=CalculatePrice(new Decimal(R),L,d),c=CalculatePrice(new Decimal(f),h,d),u=CalculatePrice(new Decimal(D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:r=CalculatePrice(new Decimal(T),L,d),c=CalculatePrice(new Decimal(T),h,d),u=CalculatePrice(new Decimal(T),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:r=CalculatePrice(new Decimal(I),L,d),c=CalculatePrice(new Decimal(I),h,d),u=CalculatePrice(new Decimal(I),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:r=CalculatePrice(new Decimal(y),L,d),c=CalculatePrice(new Decimal(y),h,d),u=CalculatePrice(new Decimal(y),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:r=CalculatePrice(new Decimal(T+1),L,d),c=CalculatePrice(new Decimal(T+1),h,d),u=CalculatePrice(new Decimal(T+1),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:r=CalculatePrice(new Decimal(_*T),L,d),c=CalculatePrice(new Decimal(_*T),h,d),u=CalculatePrice(new Decimal(_*T),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:r=CalculatePrice(new Decimal(P),L,d),c=CalculatePrice(new Decimal(P),h,d),u=CalculatePrice(new Decimal(P),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:r=CalculatePrice(new Decimal(w),L,d),c=CalculatePrice(new Decimal(w),h,d),u=CalculatePrice(new Decimal(w),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:r=CalculatePrice(new Decimal(T*R),L,d),c=CalculatePrice(new Decimal(T*f),h,d),u=CalculatePrice(new Decimal(T*D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:r=CalculatePrice(new Decimal(T*R),L,d),c=CalculatePrice(new Decimal(T*f),h,d),u=CalculatePrice(new Decimal(T*D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:r=CalculatePrice(new Decimal(R*y),L,d),c=CalculatePrice(new Decimal(f*y),h,d),u=CalculatePrice(new Decimal(D*y),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:r=CalculatePrice(new Decimal(R*y),L,d),c=CalculatePrice(new Decimal(f*y),h,d),u=CalculatePrice(new Decimal(D*y),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:r=CalculatePrice(new Decimal(R*(T+1)),L,d),c=CalculatePrice(new Decimal(f*(T+1)),h,d),u=CalculatePrice(new Decimal(D*(T+1)),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:r=CalculatePrice(new Decimal((T+1)*R),L,d),c=CalculatePrice(new Decimal((T+1)*f),h,d),u=CalculatePrice(new Decimal((T+1)*D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:r=CalculatePrice(new Decimal(_*T*R),L,d),c=CalculatePrice(new Decimal(_*T*f),h,d),u=CalculatePrice(new Decimal(_*T*D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:r=CalculatePrice(new Decimal(_*T*R),L,d),c=CalculatePrice(new Decimal(_*T*f),h,d),u=CalculatePrice(new Decimal(_*T*D),C,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v)}else switch(int.Parse(N)){case 1000003:r=L,c=h,u=C,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:d=CalculateRebate(new Decimal(R),L,U),r=CalculatePrice(new Decimal(R),L,d),g=CalculateRebate(new Decimal(f),h,U),c=CalculatePrice(new Decimal(f),h,g),p=CalculateRebate(new Decimal(D),C,U),u=CalculatePrice(new Decimal(D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:d=CalculateRebate(new Decimal(R),L,U),r=CalculatePrice(new Decimal(R),L,d),g=CalculateRebate(new Decimal(f),h,U),c=CalculatePrice(new Decimal(f),h,g),p=CalculateRebate(new Decimal(D),C,U),u=CalculatePrice(new Decimal(D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:d=CalculateRebate(new Decimal(T),L,U),r=CalculatePrice(new Decimal(T),L,d),g=CalculateRebate(new Decimal(T),h,U),c=CalculatePrice(new Decimal(T),h,g),p=CalculateRebate(new Decimal(T),C,U),u=CalculatePrice(new Decimal(T),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:d=CalculateRebate(new Decimal(I),L,U),r=CalculatePrice(new Decimal(I),L,d),g=CalculateRebate(new Decimal(I),h,U),c=CalculatePrice(new Decimal(I),h,g),p=CalculateRebate(new Decimal(I),C,U),u=CalculatePrice(new Decimal(I),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:d=CalculateRebate(new Decimal(y),L,U),r=CalculatePrice(new Decimal(y),L,d),g=CalculateRebate(new Decimal(y),h,U),c=CalculatePrice(new Decimal(y),h,g),p=CalculateRebate(new Decimal(y),C,U),u=CalculatePrice(new Decimal(y),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:d=CalculateRebate(new Decimal(T+1),L,U),r=CalculatePrice(new Decimal(T+1),L,d),g=CalculateRebate(new Decimal(T+1),h,U),c=CalculatePrice(new Decimal(T+1),h,g),p=CalculateRebate(new Decimal(T+1),C,U),u=CalculatePrice(new Decimal(T+1),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:d=CalculateRebate(new Decimal(_*T),L,U),r=CalculatePrice(new Decimal(_*T),L,d),g=CalculateRebate(new Decimal(_*T),h,U),c=CalculatePrice(new Decimal(_*T),h,g),p=CalculateRebate(new Decimal(_*T),C,U),u=CalculatePrice(new Decimal(_*T),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:d=CalculateRebate(new Decimal(P),L,U),r=CalculatePrice(new Decimal(P),L,d),g=CalculateRebate(new Decimal(P),h,U),c=CalculatePrice(new Decimal(P),h,g),p=CalculateRebate(new Decimal(P),C,U),u=CalculatePrice(new Decimal(P),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:d=CalculateRebate(new Decimal(w),L,U),r=CalculatePrice(new Decimal(w),L,d),g=CalculateRebate(new Decimal(w),h,U),c=CalculatePrice(new Decimal(w),h,g),p=CalculateRebate(new Decimal(w),C,U),u=CalculatePrice(new Decimal(w),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:d=CalculateRebate(new Decimal(T*R),L,U),r=CalculatePrice(new Decimal(T*R),L,d),g=CalculateRebate(new Decimal(T*f),h,U),c=CalculatePrice(new Decimal(T*f),h,g),p=CalculateRebate(new Decimal(T*D),C,U),u=CalculatePrice(new Decimal(T*D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:d=CalculateRebate(new Decimal(T*R),L,U),r=CalculatePrice(new Decimal(T*R),L,d),g=CalculateRebate(new Decimal(T*f),h,U),c=CalculatePrice(new Decimal(T*f),h,g),p=CalculateRebate(new Decimal(T*D),C,U),u=CalculatePrice(new Decimal(T*D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:d=CalculateRebate(new Decimal(R*y),L,U),r=CalculatePrice(new Decimal(R*y),L,d),g=CalculateRebate(new Decimal(f*y),h,U),c=CalculatePrice(new Decimal(f*y),h,g),p=CalculateRebate(new Decimal(D*y),C,U),u=CalculatePrice(new Decimal(D*y),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:d=CalculateRebate(new Decimal(R*y),L,U),r=CalculatePrice(new Decimal(R*y),L,d),g=CalculateRebate(new Decimal(f*y),h,U),c=CalculatePrice(new Decimal(f*y),h,g),p=CalculateRebate(new Decimal(D*y),C,U),u=CalculatePrice(new Decimal(D*y),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:d=CalculateRebate(new Decimal(R*(T+1)),L,U),r=CalculatePrice(new Decimal(R*(T+1)),L,d),g=CalculateRebate(new Decimal(f*(T+1)),h,U),c=CalculatePrice(new Decimal(f*(T+1)),h,g),p=CalculateRebate(new Decimal(D*(T+1)),C,U),u=CalculatePrice(new Decimal(D*(T+1)),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:d=CalculateRebate(new Decimal(R*(T+1)),L,U),r=CalculatePrice(new Decimal((T+1)*R),L,d),g=CalculateRebate(new Decimal(f*(T+1)),h,U),c=CalculatePrice(new Decimal(f*(T+1)),h,g),p=CalculateRebate(new Decimal(D*(T+1)),C,U),u=CalculatePrice(new Decimal(D*(T+1)),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:d=CalculateRebate(new Decimal(_*T*R),L,U),r=CalculatePrice(new Decimal(_*T*R),L,d),g=CalculateRebate(new Decimal(_*T*f),h,U),c=CalculatePrice(new Decimal(_*T*f),h,g),p=CalculateRebate(new Decimal(_*T*D),C,U),u=CalculatePrice(new Decimal(_*T*D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:d=CalculateRebate(new Decimal(_*T*R),L,U),r=CalculatePrice(new Decimal(_*T*R),L,d),g=CalculateRebate(new Decimal(_*T*f),h,U),c=CalculatePrice(new Decimal(_*T*f),h,g),p=CalculateRebate(new Decimal(_*T*D),C,U),u=CalculatePrice(new Decimal(_*T*D),C,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v)}0==R&&(n.setValue("ATOTAL_AMOUNT",0),n.setValue("GRAND_TOTAL",0)),0==f&&n.setValue("CG1TOTAL_AMOUNT",0),0==D&&n.setValue("CG2TOTAL_AMOUNT",0)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return n=s=null,""},a.prototype.UOMSelected=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r,c,u,d,g,p,v,_=24,V=t.getValueOfInt(s);if(null==(V=t.getValueOfInt(n.getValue("AUOM_ID"))))return"";n.setValue("CG1UOM_ID",V),n.setValue("CG2UOM_ID",V);var A,m,f=n.getValue("AUOM_ID").toString(),D=t.getValueOfDecimal(n.getValue("APRICE")),h=t.getValueOfInt(n.getValue("ANUM")),C=t.getValueOfDecimal(n.getValue("AREBATE")),S=t.getValueOfInt(n.getValue("CG1NUM")),I=t.getValueOfInt(n.getValue("CG2NUM")),y=t.getValueOfDecimal(n.getValue("CG1PRICE")),O=t.getValueOfDecimal(n.getValue("CG2PRICE")),T=t.getValueOfDateTime(n.getValue("ADATETO")),w=t.getValueOfDateTime(n.getValue("ADATEFROM")),P=T.Subtract(w),b=Utility.timeUtil.getDaysBetween(w,T),M=(P.TotalMilliseconds,P.TotalSeconds),x=P.TotalMinutes,N=b/30,L=b/7;if(A=0==b%30?N:N+1,m=0==b%7?L:L+1,0==t.getValueOfInt(C))switch(d=e.Env.ZERO,int.Parse(f)){case 1000003:r=D,c=y,u=O,c=y,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:r=CalculatePrice(new Decimal(h),D,d),c=CalculatePrice(new Decimal(S),y,d),u=CalculatePrice(new Decimal(I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:r=CalculatePrice(new Decimal(h),D,d),c=CalculatePrice(new Decimal(S),y,d),u=CalculatePrice(new Decimal(I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:r=CalculatePrice(new Decimal(b),D,d),c=CalculatePrice(new Decimal(b),y,d),u=CalculatePrice(new Decimal(b),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:r=CalculatePrice(new Decimal(A),D,d),c=CalculatePrice(new Decimal(A),y,d),u=CalculatePrice(new Decimal(A),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:r=CalculatePrice(new Decimal(m),D,d),c=CalculatePrice(new Decimal(m),y,d),u=CalculatePrice(new Decimal(m),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:r=CalculatePrice(new Decimal(b+1),D,d),c=CalculatePrice(new Decimal(b+1),y,d),u=CalculatePrice(new Decimal(b+1),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:r=CalculatePrice(new Decimal(_*b),D,d),c=CalculatePrice(new Decimal(_*b),y,d),u=CalculatePrice(new Decimal(_*b),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:r=CalculatePrice(new Decimal(x),D,d),c=CalculatePrice(new Decimal(x),y,d),u=CalculatePrice(new Decimal(x),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:r=CalculatePrice(new Decimal(M),D,d),c=CalculatePrice(new Decimal(M),y,d),u=CalculatePrice(new Decimal(M),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:r=CalculatePrice(new Decimal(b*h),D,d),c=CalculatePrice(new Decimal(b*S),y,d),u=CalculatePrice(new Decimal(b*I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:r=CalculatePrice(new Decimal(b*h),D,d),c=CalculatePrice(new Decimal(b*S),y,d),u=CalculatePrice(new Decimal(b*I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:r=CalculatePrice(new Decimal(h*m),D,d),c=CalculatePrice(new Decimal(S*m),y,d),u=CalculatePrice(new Decimal(I*m),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:r=CalculatePrice(new Decimal(h*m),D,d),c=CalculatePrice(new Decimal(S*m),y,d),u=CalculatePrice(new Decimal(I*m),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:r=CalculatePrice(new Decimal(h*(b+1)),D,d),c=CalculatePrice(new Decimal(S*(b+1)),y,d),u=CalculatePrice(new Decimal(I*(b+1)),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:r=CalculatePrice(new Decimal((b+1)*h),D,d),c=CalculatePrice(new Decimal((b+1)*S),y,d),u=CalculatePrice(new Decimal((b+1)*I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:r=CalculatePrice(new Decimal(_*b*h),D,d),c=CalculatePrice(new Decimal(_*b*S),y,d),u=CalculatePrice(new Decimal(_*b*I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:r=CalculatePrice(new Decimal(_*b*h),D,d),c=CalculatePrice(new Decimal(_*b*S),y,d),u=CalculatePrice(new Decimal(_*b*I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v)}else switch(int.Parse(f)){case 1000003:r=D,c=y,u=O,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:d=CalculateRebate(new Decimal(h),D,C),r=CalculatePrice(new Decimal(h),D,d),g=CalculateRebate(new Decimal(S),y,C),c=CalculatePrice(new Decimal(S),y,g),p=CalculateRebate(new Decimal(I),O,C),u=CalculatePrice(new Decimal(I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:d=CalculateRebate(new Decimal(h),D,C),r=CalculatePrice(new Decimal(h),D,d),g=CalculateRebate(new Decimal(S),y,C),c=CalculatePrice(new Decimal(S),y,g),p=CalculateRebate(new Decimal(I),O,C),u=CalculatePrice(new Decimal(I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:d=CalculateRebate(new Decimal(b),D,C),r=CalculatePrice(new Decimal(b),D,d),g=CalculateRebate(new Decimal(b),y,C),c=CalculatePrice(new Decimal(b),y,g),p=CalculateRebate(new Decimal(b),O,C),u=CalculatePrice(new Decimal(b),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:d=CalculateRebate(new Decimal(A),D,C),r=CalculatePrice(new Decimal(A),D,d),g=CalculateRebate(new Decimal(A),y,C),c=CalculatePrice(new Decimal(A),y,g),p=CalculateRebate(new Decimal(A),O,C),u=CalculatePrice(new Decimal(A),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:d=CalculateRebate(new Decimal(m),D,C),r=CalculatePrice(new Decimal(m),D,d),g=CalculateRebate(new Decimal(m),y,C),c=CalculatePrice(new Decimal(m),y,g),p=CalculateRebate(new Decimal(m),O,C),u=CalculatePrice(new Decimal(m),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:d=CalculateRebate(new Decimal(b+1),D,C),r=CalculatePrice(new Decimal(b+1),D,d),g=CalculateRebate(new Decimal(b+1),y,C),c=CalculatePrice(new Decimal(b+1),y,g),p=CalculateRebate(new Decimal(b+1),O,C),u=CalculatePrice(new Decimal(b+1),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:d=CalculateRebate(new Decimal(_*b),D,C),r=CalculatePrice(new Decimal(_*b),D,d),g=CalculateRebate(new Decimal(_*b),y,C),c=CalculatePrice(new Decimal(_*b),y,g),p=CalculateRebate(new Decimal(_*b),O,C),u=CalculatePrice(new Decimal(_*b),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:d=CalculateRebate(new Decimal(x),D,C),r=CalculatePrice(new Decimal(x),D,d),g=CalculateRebate(new Decimal(x),y,C),c=CalculatePrice(new Decimal(x),y,g),p=CalculateRebate(new Decimal(x),O,C),u=CalculatePrice(new Decimal(x),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:d=CalculateRebate(new Decimal(M),D,C),r=CalculatePrice(new Decimal(M),D,d),g=CalculateRebate(new Decimal(M),y,C),c=CalculatePrice(new Decimal(M),y,g),p=CalculateRebate(new Decimal(M),O,C),u=CalculatePrice(new Decimal(M),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:d=CalculateRebate(new Decimal(b*h),D,C),r=CalculatePrice(new Decimal(b*h),D,d),g=CalculateRebate(new Decimal(b*S),y,C),c=CalculatePrice(new Decimal(b*S),y,g),p=CalculateRebate(new Decimal(b*I),O,C),u=CalculatePrice(new Decimal(b*I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:d=CalculateRebate(new Decimal(b*h),D,C),r=CalculatePrice(new Decimal(b*h),D,d),g=CalculateRebate(new Decimal(b*S),y,C),c=CalculatePrice(new Decimal(b*S),y,g),p=CalculateRebate(new Decimal(b*I),O,C),u=CalculatePrice(new Decimal(b*I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:d=CalculateRebate(new Decimal(h*m),D,C),r=CalculatePrice(new Decimal(h*m),D,d),g=CalculateRebate(new Decimal(S*m),y,C),c=CalculatePrice(new Decimal(S*m),y,g),p=CalculateRebate(new Decimal(I*m),O,C),u=CalculatePrice(new Decimal(I*m),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:d=CalculateRebate(new Decimal(h*m),D,C),r=CalculatePrice(new Decimal(h*m),D,d),g=CalculateRebate(new Decimal(S*m),y,C),c=CalculatePrice(new Decimal(S*m),y,g),p=CalculateRebate(new Decimal(I*m),O,C),u=CalculatePrice(new Decimal(I*m),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:d=CalculateRebate(new Decimal(h*(b+1)),D,C),r=CalculatePrice(new Decimal(h*(b+1)),D,d),g=CalculateRebate(new Decimal(S*(b+1)),y,C),c=CalculatePrice(new Decimal(S*(b+1)),y,g),p=CalculateRebate(new Decimal(I*(b+1)),O,C),u=CalculatePrice(new Decimal(I*(b+1)),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:d=CalculateRebate(new Decimal(h*(b+1)),D,C),r=CalculatePrice(new Decimal((b+1)*h),D,d),g=CalculateRebate(new Decimal(S*(b+1)),y,C),c=CalculatePrice(new Decimal(S*(b+1)),y,g),p=CalculateRebate(new Decimal(I*(b+1)),O,C),u=CalculatePrice(new Decimal(I*(b+1)),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:d=CalculateRebate(new Decimal(_*b*h),D,C),r=CalculatePrice(new Decimal(_*b*h),D,d),g=CalculateRebate(new Decimal(_*b*S),y,C),c=CalculatePrice(new Decimal(_*b*S),y,g),p=CalculateRebate(new Decimal(_*b*I),O,C),u=CalculatePrice(new Decimal(_*b*I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:d=CalculateRebate(new Decimal(_*b*h),D,C),r=CalculatePrice(new Decimal(_*b*h),D,d),g=CalculateRebate(new Decimal(_*b*S),y,C),c=CalculatePrice(new Decimal(_*b*S),y,g),p=CalculateRebate(new Decimal(_*b*I),O,C),u=CalculatePrice(new Decimal(_*b*I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v)}return 0==h&&(n.setValue("ATOTAL_AMOUNT",0),n.setValue("GRAND_TOTAL",0)),0==S&&n.setValue("CG1TOTAL_AMOUNT",0),0==I&&n.setValue("CG2TOTAL_AMOUNT",0),n=s=null,""},a.prototype.AVALSelected=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r,c,u,d,g,p,v,_=24,V=null;try{V=n.getValue("AUOM_ID").toString()}catch(e){return this.setCalloutActive(!1),""}var A,m,f=t.getValueOfDecimal(n.getValue("APRICE")),D=t.getValueOfDecimal(n.getValue("AREBATE")),h=t.getValueOfInt(n.getValue("ANUM")),C=t.getValueOfDateTime(n.getValue("ADATETO")),S=t.getValueOfInt(n.getValue("CG1NUM")),I=t.getValueOfInt(n.getValue("CG2NUM")),y=t.getValueOfDecimal(n.getValue("CG1PRICE")),O=t.getValueOfDecimal(n.getValue("CG2PRICE")),T=t.getValueOfDateTime(n.getValue("ADATEFROM")),w=C.Subtract(T),P=Utility.timeUtil.getDaysBetween(T,C),b=(w.TotalMilliseconds,w.TotalSeconds),M=w.TotalMinutes,x=P/30,N=P/7;if(A=0==P%30?x:x+1,m=0==P%7?N:N+1,0==t.getValueOfInt(D))switch(d=e.Env.ZERO,int.Parse(V)){case 1000003:r=f,c=y,u=O,c=y,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:r=CalculatePrice(new Decimal(h),f,d),c=CalculatePrice(new Decimal(S),y,d),u=CalculatePrice(new Decimal(I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:r=CalculatePrice(new Decimal(h),f,d),c=CalculatePrice(new Decimal(S),y,d),u=CalculatePrice(new Decimal(I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:r=CalculatePrice(new Decimal(P),f,d),c=CalculatePrice(new Decimal(P),y,d),u=CalculatePrice(new Decimal(P),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:r=CalculatePrice(new Decimal(A),f,d),c=CalculatePrice(new Decimal(A),y,d),u=CalculatePrice(new Decimal(A),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:r=CalculatePrice(new Decimal(m),f,d),c=CalculatePrice(new Decimal(m),y,d),u=CalculatePrice(new Decimal(m),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:r=CalculatePrice(new Decimal(P+1),f,d),c=CalculatePrice(new Decimal(P+1),y,d),u=CalculatePrice(new Decimal(P+1),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:r=CalculatePrice(new Decimal(_*P),f,d),c=CalculatePrice(new Decimal(_*P),y,d),u=CalculatePrice(new Decimal(_*P),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:r=CalculatePrice(new Decimal(M),f,d),c=CalculatePrice(new Decimal(M),y,d),u=CalculatePrice(new Decimal(M),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:r=CalculatePrice(new Decimal(b),f,d),c=CalculatePrice(new Decimal(b),y,d),u=CalculatePrice(new Decimal(b),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:r=CalculatePrice(new Decimal(P*h),f,d),c=CalculatePrice(new Decimal(P*S),y,d),u=CalculatePrice(new Decimal(P*I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:r=CalculatePrice(new Decimal(P*h),f,d),c=CalculatePrice(new Decimal(P*S),y,d),u=CalculatePrice(new Decimal(P*I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:r=CalculatePrice(new Decimal(h*m),f,d),c=CalculatePrice(new Decimal(S*m),y,d),u=CalculatePrice(new Decimal(I*m),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:r=CalculatePrice(new Decimal(h*m),f,d),c=CalculatePrice(new Decimal(S*m),y,d),u=CalculatePrice(new Decimal(I*m),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:r=CalculatePrice(new Decimal(h*(P+1)),f,d),c=CalculatePrice(new Decimal(S*(P+1)),y,d),u=CalculatePrice(new Decimal(I*(P+1)),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:r=CalculatePrice(new Decimal((P+1)*h),f,d),c=CalculatePrice(new Decimal((P+1)*S),y,d),u=CalculatePrice(new Decimal((P+1)*I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:r=CalculatePrice(new Decimal(_*P*h),f,d),c=CalculatePrice(new Decimal(_*P*S),y,d),u=CalculatePrice(new Decimal(_*P*I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:r=CalculatePrice(new Decimal(_*P*h),f,d),c=CalculatePrice(new Decimal(_*P*S),y,d),u=CalculatePrice(new Decimal(_*P*I),O,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v)}else switch(int.Parse(V)){case 1000003:r=f,c=y,u=O,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:d=CalculateRebate(new Decimal(h),f,D),r=CalculatePrice(new Decimal(h),f,d),g=CalculateRebate(new Decimal(S),y,D),c=CalculatePrice(new Decimal(S),y,g),p=CalculateRebate(new Decimal(I),O,D),u=CalculatePrice(new Decimal(I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:d=CalculateRebate(new Decimal(h),f,D),r=CalculatePrice(new Decimal(h),f,d),g=CalculateRebate(new Decimal(S),y,D),c=CalculatePrice(new Decimal(S),y,g),p=CalculateRebate(new Decimal(I),O,D),u=CalculatePrice(new Decimal(I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:d=CalculateRebate(new Decimal(P),f,D),r=CalculatePrice(new Decimal(P),f,d),g=CalculateRebate(new Decimal(P),y,D),c=CalculatePrice(new Decimal(P),y,g),p=CalculateRebate(new Decimal(P),O,D),u=CalculatePrice(new Decimal(P),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:d=CalculateRebate(new Decimal(A),f,D),r=CalculatePrice(new Decimal(A),f,d),g=CalculateRebate(new Decimal(A),y,D),c=CalculatePrice(new Decimal(A),y,g),p=CalculateRebate(new Decimal(A),O,D),u=CalculatePrice(new Decimal(A),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:d=CalculateRebate(new Decimal(m),f,D),r=CalculatePrice(new Decimal(m),f,d),g=CalculateRebate(new Decimal(m),y,D),c=CalculatePrice(new Decimal(m),y,g),p=CalculateRebate(new Decimal(m),O,D),u=CalculatePrice(new Decimal(m),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:d=CalculateRebate(new Decimal(P+1),f,D),r=CalculatePrice(new Decimal(P+1),f,d),g=CalculateRebate(new Decimal(P+1),y,D),c=CalculatePrice(new Decimal(P+1),y,g),p=CalculateRebate(new Decimal(P+1),O,D),u=CalculatePrice(new Decimal(P+1),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:d=CalculateRebate(new Decimal(_*P),f,D),r=CalculatePrice(new Decimal(_*P),f,d),g=CalculateRebate(new Decimal(_*P),y,D),c=CalculatePrice(new Decimal(_*P),y,g),p=CalculateRebate(new Decimal(_*P),O,D),u=CalculatePrice(new Decimal(_*P),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:d=CalculateRebate(new Decimal(M),f,D),r=CalculatePrice(new Decimal(M),f,d),g=CalculateRebate(new Decimal(M),y,D),c=CalculatePrice(new Decimal(M),y,g),p=CalculateRebate(new Decimal(M),O,D),u=CalculatePrice(new Decimal(M),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:d=CalculateRebate(new Decimal(b),f,D),r=CalculatePrice(new Decimal(b),f,d),g=CalculateRebate(new Decimal(b),y,D),c=CalculatePrice(new Decimal(b),y,g),p=CalculateRebate(new Decimal(b),O,D),u=CalculatePrice(new Decimal(b),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:d=CalculateRebate(new Decimal(P*h),f,D),r=CalculatePrice(new Decimal(P*h),f,d),g=CalculateRebate(new Decimal(P*S),y,D),c=CalculatePrice(new Decimal(P*S),y,g),p=CalculateRebate(new Decimal(P*I),O,D),u=CalculatePrice(new Decimal(P*I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:d=CalculateRebate(new Decimal(P*h),f,D),r=CalculatePrice(new Decimal(P*h),f,d),g=CalculateRebate(new Decimal(P*S),y,D),c=CalculatePrice(new Decimal(P*S),y,g),p=CalculateRebate(new Decimal(P*I),O,D),u=CalculatePrice(new Decimal(P*I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:d=CalculateRebate(new Decimal(h*m),f,D),r=CalculatePrice(new Decimal(h*m),f,d),g=CalculateRebate(new Decimal(S*m),y,D),c=CalculatePrice(new Decimal(S*m),y,g),p=CalculateRebate(new Decimal(I*m),O,D),u=CalculatePrice(new Decimal(I*m),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:d=CalculateRebate(new Decimal(h*m),f,D),r=CalculatePrice(new Decimal(h*m),f,d),g=CalculateRebate(new Decimal(S*m),y,D),c=CalculatePrice(new Decimal(S*m),y,g),p=CalculateRebate(new Decimal(I*m),O,D),u=CalculatePrice(new Decimal(I*m),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:d=CalculateRebate(new Decimal(h*(P+1)),f,D),r=CalculatePrice(new Decimal(h*(P+1)),f,d),g=CalculateRebate(new Decimal(S*(P+1)),y,D),c=CalculatePrice(new Decimal(S*(P+1)),y,g),p=CalculateRebate(new Decimal(I*(P+1)),O,D),u=CalculatePrice(new Decimal(I*(P+1)),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:d=CalculateRebate(new Decimal(h*(P+1)),f,D),r=CalculatePrice(new Decimal((P+1)*h),f,d),g=CalculateRebate(new Decimal(S*(P+1)),y,D),c=CalculatePrice(new Decimal(S*(P+1)),y,g),p=CalculateRebate(new Decimal(I*(P+1)),O,D),u=CalculatePrice(new Decimal(I*(P+1)),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:d=CalculateRebate(new Decimal(_*P*h),f,D),r=CalculatePrice(new Decimal(_*P*h),f,d),g=CalculateRebate(new Decimal(_*P*S),y,D),c=CalculatePrice(new Decimal(_*P*S),y,g),p=CalculateRebate(new Decimal(_*P*I),O,D),u=CalculatePrice(new Decimal(_*P*I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:d=CalculateRebate(new Decimal(_*P*h),f,D),r=CalculatePrice(new Decimal(_*P*h),f,d),g=CalculateRebate(new Decimal(_*P*S),y,D),c=CalculatePrice(new Decimal(_*P*S),y,g),p=CalculateRebate(new Decimal(_*P*I),O,D),u=CalculatePrice(new Decimal(_*P*I),O,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v)}return 0==h&&(n.setValue("ATOTAL_AMOUNT",0),n.setValue("GRAND_TOTAL",0)),0==S&&n.setValue("CG1TOTAL_AMOUNT",0),0==I&&n.setValue("CG2TOTAL_AMOUNT",0),n=s=null,""},e.Model.CalloutOfferSerIncluded=a}(VIS,jQuery)},3306:()=>{!function(e,t){e.AForms=e.AForms||{},e.AForms.createforecast=function a(){this.frame,this.windowNo;var i,n,l,s,o,r,c,u,d,g,p,v,_,V,A,m,f,D,h,C,S,I,y,O,T,w,P,b,M,x,N,L,R,U,E,k,G,B=this,F=t("<div style='height:100%;background-color:white;' class='vis-forms-container' >"),Q=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),$=e.Env.getCtx(),W=null,J=null,j=null,z=null,q=0,Y=0,H=null,K=null,Z=null,X=null,ee=null;this.ad_table_ID,this.ad_window_ID,this.record_ID;var te=e.context.getWindowContextAsInt(B.windowNo,"AD_Org_ID",!1),ae=e.context.getWindowContextAsInt(B.windowNo,"AD_Client_ID",!1),ie=!1,ne=!1;function le(a,i,n,s){t.ajax({url:e.Application.contextUrl+"ForecastForm/CreateForecastLine",type:"POST",dataType:"json",async:!0,data:{Org_ID:l.getValue(),Period_ID:r.getValue(),IncludeSO:u.getValue(),DocType:p.getValue(),IncludeOpenSO:_.getValue(),OpenOrders:m.getValue(),IncludeOpportunity:D.getValue(),Opportunity:S.getValue(),ProductCategory:x.getValue(),BudgetQunatity:E.getValue(),DeleteAndGenerateLines:G.getValue(),Forecast_ID:B.record_ID,TeamForecast_IDS:a,Table_ID:B.ad_table_ID,IsMasterForecast:ie,IsBudgetForecast:ne,MasterForecast_IDs:i,SalesPriceList_ID:n},success:function(e){s(e)},error:function(t){console.log(t),se(!1),e.ADialog.error("Error")}})}function se(e){Q[0].style.visibility=e?"visible":"hidden"}e.translatedTexts=e.Msg.translate(e.Env.getCtx(),["AD_Org_ID","C_Period_ID","C_DocType_ID","M_Product_Category_ID","TeamForecast","MasterForecast","M_PriceList_ID"],!0),this.Initialize=function(){se(!0),function(){var t=e.dataContext.getJSONData(e.Application.contextUrl+"ForecastForm/GetTableAndRecordInfo",{AD_Table_ID:B.ad_table_ID,AD_Record_ID:B.record_ID});null!=t&&(te=e.Utility.Util.getValueOfInt(t.AD_Org_ID),ie="C_MasterForecast"==e.Utility.Util.getValueOfString(t.Table_Name),ne="VA073_SalesForecast"==e.Utility.Util.getValueOfString(t.Table_Name),q=e.Utility.Util.getValueOfInt(t.TeamColumn_ID),Y=e.Utility.Util.getValueOfInt(t.BudgetColumn_ID))}(),function(){W=t('<div class="vis-budget-main-wrap vis-formouterwrpdiv">'),J=t('<div class="vis-budget-form-wrap">'),j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_Organization_'+B.windowNo+'">'),j.append(z),J.append(j),j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_Period_'+B.windowNo+'">'),j.append(z),J.append(j),j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_IncludeSO_'+B.windowNo+'">'),j.append(z),J.append(j),j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_DocumentType_'+B.windowNo+'">'),j.append(z),J.append(j),j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_IncludeOpenSalesOrder_'+B.windowNo+'">'),j.append(z),J.append(j),j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_OpenSalesOrder_'+B.windowNo+'">'),j.append(z),J.append(j),j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_IncludeOpportunity_'+B.windowNo+'">'),j.append(z),J.append(j),j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_Opportunity_'+B.windowNo+'">'),j.append(z),J.append(j),ie&&(j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_TeamForecast_'+B.windowNo+'">'),j.append(z),J.append(j));ne&&(j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_BudgetForecast_'+B.windowNo+'">'),j.append(z),J.append(j));j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_ProductCategory_'+B.windowNo+'">'),j.append(z),J.append(j),ne&&(j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_PriceList_'+B.windowNo+'">'),j.append(z),J.append(j));j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_BudgetQuantity_'+B.windowNo+'">'),j.append(z),J.append(j),j=t('<div class="vis-budget-form-row">'),z=t('<div class="input-group vis-input-wrap" id="VIS_GenerateLines_'+B.windowNo+'">'),j.append(z),J.append(j),H=t('<div class="VIS_buttons-wrap .vis-budget-buttons-wrap">'),K=t('<div class="pull-right">'),Z=t('<span class="btn vis-budget-buttons-wrap-span">'+e.Msg.translate($,"VIS_OK")+"</span>"),X=t('<span class="btn vis-budget-buttons-wrap-span">'+e.Msg.translate($,"Cancel")+"</span>"),ee=t('<span class="btn vis-budget-buttons-wrap-span">'+e.Msg.translate($,"Apply")+"</span>"),K.append(Z).append(ee).append(X),H.append(K),W.append(J).append(H),F.append(W).append(Q)}(),function(){i=F.find("#VIS_Organization_"+B.windowNo),s=F.find("#VIS_Period_"+B.windowNo),c=F.find("#VIS_IncludeSO_"+B.windowNo),d=F.find("#VIS_DocumentType_"+B.windowNo),v=F.find("#VIS_IncludeOpenSalesOrder_"+B.windowNo),V=F.find("#VIS_OpenSalesOrder_"+B.windowNo),f=F.find("#VIS_IncludeOpportunity_"+B.windowNo),h=F.find("#VIS_Opportunity_"+B.windowNo),ie&&(I=F.find("#VIS_TeamForecast_"+B.windowNo));ne&&(T=F.find("#VIS_BudgetForecast_"+B.windowNo),N=F.find("#VIS_PriceList_"+B.windowNo));b=F.find("#VIS_ProductCategory_"+B.windowNo),U=F.find("#VIS_BudgetQuantity_"+B.windowNo),k=F.find("#VIS_GenerateLines_"+B.windowNo)}(),function(){n=e.MLookupFactory.get($,B.windowNo,te,e.DisplayType.Search,"AD_Org_ID",0,!1,"AD_Org_ID.IsActive = 'Y'"),l=new e.Controls.VTextBoxButton("AD_Org_ID",!0,!1,!1,e.DisplayType.Search,n);var a=t('<div class="vis-control-wrap">'),F=t('<div class="input-group-append">');i.append(a),a.append(l.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.AD_Org_ID+"</label>"),i.append(F),F.append(l.getBtn(0));var Q="C_Period.IsActive='Y' AND C_Period.C_Year_ID  IN  (Select C_Year_ID FROM C_Year WHERE C_Calendar_ID =  ((SELECT AD_OrgInfo.C_Calendar_ID FROM AD_OrgInfo WHERE AD_OrgInfo.AD_Org_ID = "+te+"))  OR (EXISTS(SELECT 1 FROM AD_OrgInfo WHERE AD_OrgInfo.AD_Org_ID = "+te+" AND AD_OrgInfo.C_Calendar_ID IS NULL) AND  (C_Calendar_ID = (SELECT AD_ClientInfo.C_Calendar_ID FROM AD_ClientInfo WHERE AD_ClientInfo.AD_Client_ID = "+ae+")))  AND C_year.IsActive = 'Y') and C_Period.Startdate < SYSDATE ORDER BY C_Period.C_Period_ID";o=e.MLookupFactory.get($,B.windowNo,1004891,e.DisplayType.Search,"C_Period_ID",0,!1,Q),r=new e.Controls.VTextBoxButton("C_Period_ID",!0,!1,!0,e.DisplayType.Search,o);var W=t('<div class="vis-control-wrap">'),J=t('<div class="input-group-append">');s.append(W),W.append(r.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.C_Period_ID+"</label>"),s.append(J),J.append(r.getBtn(0)),J.append(r.getBtn(1)),r.getControl().prop("disabled",!0),r.getBtn(0).prop("disabled",!0),r.getBtn(1).prop("disabled",!0),u=new e.Controls.VCheckBox("IncludeSO",!1,!1,!0,e.Msg.getMsg("IncludeSO"),null);var j=t('<div class="vis-control-wrap">');c.append(j),j.append(u.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")),Q="C_DocType.IsActive = 'Y' AND C_DocType.DocBaseType IN ('SOO', 'POO', 'BOO') AND C_DocType.IsSOTrx = 'Y' AND  C_DocType.IsReturnTrx = 'N' AND  C_DocType.IsSalesQuotation = 'N' AND C_DocType.IsBlanketTrx = 'N'  AND C_DocType.AD_Org_ID IN (0, "+te+") ",g=e.MLookupFactory.get($,B.windowNo,2173,e.DisplayType.TableDir,"C_DocType_ID",0,!1,Q),(p=new e.Controls.VComboBox("C_DocType_ID",!1,!1,!0,g,50)).getControl().prop("disabled",!0);var z=t('<div class="vis-control-wrap">');d.append(z),z.append(p.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.C_DocType_ID+"</label>"),_=new e.Controls.VCheckBox("IncludeOpenSO",!1,!1,!0,e.Msg.getMsg("IncludeOpenSO"),null);var H=t('<div class="vis-control-wrap">');v.append(H),H.append(_.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")),Q="C_Order.DocStatus IN ('CO') AND C_Order.IsSOTrx = 'Y' AND  C_Order.IsReturnTrx = 'N' AND  C_Order.IsSalesQuotation = 'N' AND C_Order.IsBlanketTrx = 'N' AND C_Order.AD_Org_ID IN (0, "+te+")",A=e.MLookupFactory.get($,B.windowNo,2213,e.DisplayType.MultiKey,"C_Order_ID",0,!1,Q),(m=new e.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,e.DisplayType.MultiKey,A)).getControl().prop("disabled",!0),m.getBtn(0).prop("disabled",!0),m.getBtn(1).prop("disabled",!0),m.setCustomInfo("Budget_OpenSalesOrder");var K=t('<div class="vis-control-wrap">'),Z=t('<div class="input-group-append">');V.append(K),K.append(m.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.Msg.getMsg("OpenSO")+"</label>"),V.append(Z),Z.append(m.getBtn(0)),Z.append(m.getBtn(1)),D=new e.Controls.VCheckBox("IncludeOpportunity",!1,!1,!0,e.Msg.getMsg("IncludeOpportunity"),null);var X=t('<div class="vis-control-wrap">');f.append(X),X.append(D.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")),Q="C_Project.IsActive = 'Y' AND C_Project.IsOpportunity = 'Y' AND C_Project.AD_Org_ID IN (0, "+te+")",C=e.MLookupFactory.get($,B.windowNo,5766,e.DisplayType.MultiKey,"C_Project_ID",0,!1,Q),(S=new e.Controls.VTextBoxButton("C_Project_ID",!0,!1,!0,e.DisplayType.MultiKey,C)).getControl().prop("disabled",!0),S.getBtn(0).prop("disabled",!0),S.getBtn(1).prop("disabled",!0),S.setCustomInfo("Budget_Opportunity");var ee=t('<div class="vis-control-wrap">'),le=t('<div class="input-group-append">');if(h.append(ee),ee.append(S.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.Msg.getMsg("Opportunity")+"</label>"),h.append(le),le.append(S.getBtn(0)),le.append(S.getBtn(1)),ie){Q=" C_Forecast.AD_Org_ID IN (0, "+te+") AND C_Forecast.DocStatus IN ('CO', 'CL')",y=e.MLookupFactory.get($,B.windowNo,q,e.DisplayType.MultiKey,"C_Forecast_ID",0,!1,Q),(O=new e.Controls.VTextBoxButton("C_Forecast_ID",!0,!1,!0,e.DisplayType.MultiKey,y)).setCustomInfo("Budget_TeamForecast");var se=t('<div class="vis-control-wrap">'),oe=t('<div class="input-group-append">');I.append(se),se.append(O.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.TeamForecast+"</label>"),I.append(oe),oe.append(O.getBtn(0)),oe.append(O.getBtn(1))}if(ne){Q=" C_MasterForecast.AD_Org_ID IN (0, "+te+") AND C_MasterForecast.DocStatus IN ('CO', 'CL')",w=e.MLookupFactory.get($,B.windowNo,Y,e.DisplayType.MultiKey,"C_MasterForecast_ID",0,!1,Q),P=new e.Controls.VTextBoxButton("C_MasterForecast_ID",!0,!1,!0,e.DisplayType.MultiKey,w);var re=t('<div class="vis-control-wrap">'),ce=t('<div class="input-group-append">');T.append(re),re.append(P.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.MasterForecast+"</label>"),T.append(ce),ce.append(P.getBtn(0)),ce.append(P.getBtn(1))}Q="M_Product_Category.IsActive = 'Y' AND M_Product_Category.AD_Org_ID IN (0, "+te+")",M=e.MLookupFactory.get($,B.windowNo,2012,e.DisplayType.MultiKey,"M_Product_Category_ID",0,!1,Q),x=new e.Controls.VTextBoxButton("M_Product_Category_ID",!0,!1,!0,e.DisplayType.MultiKey,M);var ue=t('<div class="vis-control-wrap">'),de=t('<div class="input-group-append">');if(b.append(ue),ue.append(x.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.M_Product_Category_ID+"</label>"),b.append(de),de.append(x.getBtn(0)),de.append(x.getBtn(1)),x.fireValueChanged=function(){x.getControl().trigger("change")},ne){Q="M_PriceList.IsActive = 'Y' AND M_PriceList.IsSOPriceList='Y' AND M_PriceList.AD_Org_ID IN (0, "+te+")",L=e.MLookupFactory.get($,B.windowNo,2100,e.DisplayType.Search,"M_PriceList_ID",0,!1,Q),R=new e.Controls.VTextBoxButton("M_PriceList_ID",!0,!1,!0,e.DisplayType.Search,L);var ge=t('<div class="vis-control-wrap">'),pe=t('<div class="input-group-append">');N.append(ge),ge.append(R.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.M_PriceList_ID+"</label>"),N.append(pe),pe.append(R.getBtn(0)),pe.append(R.getBtn(1)),R.getControl().prop("disabled",!0)}(E=new e.Controls.VAmountTextBox("BudgetQuantity",!1,!1,!0,50,100,e.DisplayType.Quantity)).getControl().prop("disabled",!0);var ve=t('<div class="vis-control-wrap">');U.append(ve),ve.append(E.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.Msg.getMsg("BudgetQuantity")+"</label>"),G=new e.Controls.VCheckBox("GenerateLines",!1,!1,!0,e.Msg.getMsg("GenerateLines"),null);var _e=t('<div class="vis-control-wrap">');k.append(_e),_e.append(G.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," "))}(),l.setValue(te),u.getControl().on("click",function(e){p.getControl().prop("disabled",!u.getValue()),r.getControl().prop("disabled",!u.getValue()),r.getBtn(0).prop("disabled",!u.getValue()),r.getBtn(1).prop("disabled",!u.getValue()),u.getValue()||(p.setValue(),r.setValue()),x.getControl().trigger("change")}),_.getControl().on("click",function(e){m.getControl().prop("disabled",!_.getValue()),m.getBtn(0).prop("disabled",!_.getValue()),m.getBtn(1).prop("disabled",!_.getValue()),_.getValue()||m.setValue(),x.getControl().trigger("change")}),D.getControl().on("click",function(e){S.getControl().prop("disabled",!D.getValue()),S.getBtn(0).prop("disabled",!D.getValue()),S.getBtn(1).prop("disabled",!D.getValue()),D.getValue()||S.setValue(),x.getControl().trigger("change")}),x.getControl().on("change",function(t){x.getControl().prop("disabled",!!(_.getValue()||D.getValue()||u.getValue())),x.getBtn(0).prop("disabled",!!(_.getValue()||D.getValue()||u.getValue())),x.getBtn(1).prop("disabled",!!(_.getValue()||D.getValue()||u.getValue())),(_.getValue()||D.getValue()||u.getValue())&&x.setValue(),null!=x.getValue()||""!=e.Utility.Util.getValueOfString(x.getValue())?(E.getControl().prop("disabled",!1),R.getControl().prop("disabled",!1)):(E.getControl().prop("disabled",!0),E.getControl().val(0),R.getControl().prop("disabled",!0))}),Z.on("click",function(){se(!0);var t=0,a=0,i=0;if(ie&&(t=O.getValue()),ne&&(a=P.getValue(),i=R.getValue()),null!=x.getValue()||""!=e.Utility.Util.getValueOfString(x.getValue())){if(0==e.Utility.Util.getValueOfDecimal(E.getValue()))return e.ADialog.info("SelectBudgetQunatity"),se(!1),!1;if(ne&&0==e.Utility.Util.getValueOfDecimal(R.getValue()))return e.ADialog.info("SelectPriceList"),se(!1),!1}le(t,a,i,function(t){e.ADialog.info("","",JSON.parse(t)),se(!1),B.frame.close()})}),ee.on("click",function(){se(!0);var t=0,a=0,i=0;if(ie&&(t=O.getValue()),ne&&(a=P.getValue(),i=R.getValue()),null!=x.getValue()||""!=e.Utility.Util.getValueOfString(x.getValue())){if(0==e.Utility.Util.getValueOfDecimal(E.getValue()))return e.ADialog.info("SelectBudgetQunatity"),se(!1),!1;if(ne&&0==e.Utility.Util.getValueOfDecimal(R.getValue()))return e.ADialog.info("SelectPriceList"),se(!1),!1}le(t,a,i,function(t){e.ADialog.info("","",JSON.parse(t)),se(!1)})}),X.on("click",function(){B.frame.close()}),se(!1)},this.setHeight=function(){},this.setWidth=function(){return 635},this.getRoot=function(){return F},this.disposeComponent=function(){B=null,F=null,Q=null,W=null,J=null,j=null,z=null,H=null,K=null,Z=null,X=null,i=null,n=null,l=null,s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=null,_=null,V=null,A=null,m=null,f=null,D=null,h=null,C=null,S=null,I=null,y=null,O=null,b=null,M=null,x=null,U=null,E=null,k=null,G=null},a.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.ad_table_ID=this.frame.getAD_Table_ID(),this.ad_window_ID=this.frame.getAD_Window_ID(),this.record_ID=this.frame.getRecord_ID(),this.Initialize(),this.frame.getContentGrid().append(this.getRoot())},a.prototype.dispose=function(){this.disposeComponent(),this.frame=null}}}(VIS,jQuery)},3309:()=>{VAS=window.VAS||{},function(e,t){e.VAS_ProductUomSetup=function(){this.frame,this.windowNo;var a=null,i=null,n=null,l=this,s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=null,_=null,V=null,A=null,m=1;function f(e){i[0].style.visibility=e?"visible":"hidden"}this.initLoad=function(){var e=VIS.MLookupFactory.get(VIS.Env.getCtx(),l.windowNo,0,VIS.DisplayType.TableDir,"C_UOM_ID",0,!1);l.cmbUOM=new VIS.Controls.VComboBox("C_UOM_ID",!0,!0,!0,e,150,VIS.DisplayType.TableDir),l.cmbUOM.setValue(v);var i=t('<div class="vis-control-wrap ddlPadding">');$inputUOM.append(i),i.append(l.cmbUOM.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+VIS.Msg.getMsg("VAS_ddlUOM")+'</label><span class= "vis-ev-ctrlinfowrap"</span>'),$inputUOM.append(i);var D=VIS.MLookupFactory.get(VIS.Env.getCtx(),l.windowNo,0,VIS.DisplayType.TableDir,"C_UOM_ID",0,!1);l.cmbPU=new VIS.Controls.VComboBox("C_UOM_ID",!0,!1,!0,D,150,VIS.DisplayType.TableDir),l.cmbPU.setValue(v);var h=t('<div class="vis-control-wrap ddlPadding">');$inputPurUnit.append(h),h.append(l.cmbPU.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+VIS.Msg.getMsg("VAS_ddlPUUnit")+'</label><span class= "vis-ev-ctrlinfowrap"</span>'),$inputPurUnit.append(h);var C=VIS.MLookupFactory.get(VIS.Env.getCtx(),l.windowNo,0,VIS.DisplayType.TableDir,"C_UOM_ID",0,!1);l.cmbSU=new VIS.Controls.VComboBox("C_UOM_ID",!0,!1,!0,C,150,VIS.DisplayType.TableDir),l.cmbSU.setValue(v);var S=t('<div class="vis-control-wrap ddlPadding">');$inputSuUnit.prepend(S),S.append(l.cmbSU.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+VIS.Msg.getMsg("VAS_ddlSUUnit")+'</label><span class= "vis-ev-ctrlinfowrap"</span>'),$inputSuUnit.append(S);var I=VIS.MLookupFactory.get(VIS.Env.getCtx(),l.windowNo,0,VIS.DisplayType.TableDir,"C_UOM_ID",0,!1);l.cmbCU=new VIS.Controls.VComboBox("C_UOM_ID",!0,!1,!0,I,150,VIS.DisplayType.TableDir),l.cmbCU.setValue(v);var y=t('<div class="vis-control-wrap ddlPadding">');$inputCuUnit.prepend(y),y.append(l.cmbCU.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+VIS.Msg.getMsg("VAS_ddlCUUnit")+'</label><span class= "vis-ev-ctrlinfowrap"</span>'),$inputCuUnit.append(y),a.append(n),p.on("keypress",function(e){if(e.keyCode>31&&(e.keyCode<48||e.keyCode>57))return!1}),r.on("change",function(){V=r.val(),A=VIS.Env.ZERO,m=1,0!=V?(A=(m/V).toFixed(12),o.val(A)):o.val(0)}),o.on("change",function(){V=o.val(),A=VIS.Env.ZERO,m=1,0!=V?(A=(m/V).toFixed(12),r.val(A)):r.val(0)}),c.on("change",function(){V=c.val(),A=VIS.Env.ZERO,m=1,0!=V?(A=(m/V).toFixed(12),u.val(A)):u.val(0)}),u.on("change",function(){V=u.val(),A=VIS.Env.ZERO,m=1,0!=V?(A=(m/V).toFixed(12),c.val(A)):c.val(0)}),d.on("change",function(){V=d.val(),A=VIS.Env.ZERO,m=1,0!=V?(A=(m/V).toFixed(12),g.val(A)):g.val(0)}),g.on("change",function(){V=g.val(),A=VIS.Env.ZERO,m=1,0!=V?(A=(m/V).toFixed(12),d.val(A)):d.val(0)}),l.cmbPU.fireValueChanged=function(){l.cmbPU.oldValue=null,v==l.cmbPU.getValue()?(r.prop("disabled",!0),o.prop("disabled",!0),r.val(1),o.val(1)):(r.prop("disabled",!1),o.prop("disabled",!1),r.val(""),o.val(""))},l.cmbSU.fireValueChanged=function(){l.cmbSU.oldValue=null,v==l.cmbSU.getValue()?(c.prop("disabled",!0),u.prop("disabled",!0),c.val(1),u.val(1)):(c.prop("disabled",!1),u.prop("disabled",!1),c.val(""),u.val(""))},l.cmbCU.fireValueChanged=function(){l.cmbCU.oldValue=null,v==l.cmbCU.getValue()?(d.prop("disabled",!0),g.prop("disabled",!0),d.val(1),g.val(1)):(d.prop("disabled",!1),g.prop("disabled",!1),d.val(""),g.val(""))},s.on(VIS.Events.onTouchStartOrClick,function(){!function(){if(null==l.cmbPU.getValue())return VIS.ADialog.info("VAS_PuUnitMandatory"),void f(!1);if(null==l.cmbSU.getValue())return VIS.ADialog.info("VAS_SuUnitMandatory"),void f(!1);if(null==l.cmbCU.getValue())return VIS.ADialog.info("VAS_CuUnitMandatory"),void f(!1);if(""==r.val()||0==r.val()||""==o.val()||0==o.val()||""==c.val()||0==c.val()||""==u.val()||0==u.val()||""==d.val()||0==d.val()||""==g.val()||0==g.val())return VIS.ADialog.info("ProductUOMConversionRateError"),void f(!1);var e=l.cmbPU.getValue(),a=l.cmbSU.getValue(),i=l.cmbCU.getValue(),n=[],s=r.val(),p=c.val(),v=d.val();if(e===a&&a===i){if(s!==p||p!==v)return VIS.ADialog.info("VAS_AllUnitSameButDifferQty"),void f(!1);n.push({C_UOM_To_ID:e,MultiplyRate:s,DivideRate:o.val()})}else if(e===a||e===i||a===i){if(e===a){if(s!==p)return VIS.ADialog.info("VAS_AllUnitSameButDifferQty"),void f(!1);n.push({C_UOM_To_ID:e,MultiplyRate:s,DivideRate:o.val()}),n.push({C_UOM_To_ID:i,MultiplyRate:d.val(),DivideRate:g.val()})}else if(e===i){if(s!==v)return VIS.ADialog.info("VAS_AllUnitSameButDifferQty"),void f(!1);n.push({C_UOM_To_ID:e,MultiplyRate:s,DivideRate:o.val()}),n.push({C_UOM_To_ID:a,MultiplyRate:c.val(),DivideRate:u.val()})}else if(a===i){if(p!==v)return VIS.ADialog.info("VAS_AllUnitSameButDifferQty"),void f(!1);n.push({C_UOM_To_ID:e,MultiplyRate:s,DivideRate:o.val()}),n.push({C_UOM_To_ID:a,MultiplyRate:p,DivideRate:u.val()})}}else n.push({C_UOM_To_ID:e,MultiplyRate:s,DivideRate:o.val()}),n.push({C_UOM_To_ID:a,MultiplyRate:p,DivideRate:u.val()}),n.push({C_UOM_To_ID:i,MultiplyRate:v,DivideRate:g.val()});var V=n;f(!0),t.ajax({url:VIS.Application.contextUrl+"Product/SaveUOMConversion",data:{C_UOM_ID:l.cmbUOM.getValue(),multiplyRateList:JSON.stringify(V),Product_ID:_,VAS_PurchaseUOM_ID:e,VAS_SalesUOM_ID:a,VAS_ConsumableUOM_ID:i},contentType:"application/json; charset=utf-8",success:function(e){null!=(e=JSON.parse(e))&&("1"==e.Status?(VIS.ADialog.info("","",e.message),f(!1),l.frame.close()):(VIS.ADialog.info("","",e.message),f(!1)))},error:function(e){VIS.ADialog.info("","",VIS.Msg.getMsg("VAS_UOMConvNotSaved")),f(!1),console.log(e)}})}()}),inputCancel.on(VIS.Events.onTouchStartOrClick,function(){l.frame.close()}),f(!1)},this.disposeComponent=function(){a&&a.remove(),a=null,i=null,n=null,l=null,s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=null,_=null,V=null,A=null,m=null},this.initalize=function(){i=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),(a=t("<div>")).append(i),f(!0),n=t('<div class="VAS-flyout-body vis-formouterwrpdiv"><div class="firstRow"><div class="VAS-input-fields"><div class="VIS_Pref_show"><div class="VIS_Pref_dd"><div class="input-group vis-input-wrap VAS-UOM" id="VAS_ddlUOM'+l.windowNo+'"></div></div></div><div class="VAS_convertedUnit">'+VIS.Msg.getMsg("VAS_ProductConvertUnit")+'</div><div id="VAS_ControlDiv"><div class="VIS_Pref_show"><div class="VIS_Pref_dd"><div class= "input-group vis-input-wrap" id = "VAS_ddlPU'+l.windowNo+'" ></div></div> <div class="VIS_Pref_dd"><div class= "input-group vis-input-wrap vas-txtbox"><div class="vis-control-wrap"><input type="text"  class="vas-txtbox" value="1" placeholder="" data-placeholder=""  id ="VAS_txtSUQtyForPU'+l.windowNo+'" disabled><label for="VAS_txtSUQtyForPU'+l.windowNo+'">'+VIS.Msg.getMsg("VAS_txtSUQtyForPU")+'</label></div > </div> </div> <div class="VIS_Pref_dd"><div class= "input-group vis-input-wrap vas-txtbox"><div class="vis-control-wrap"><input type="text"  class="vas-txtbox" value="1" placeholder="" data-placeholder="" id="VAS_txtPUQtyForPU'+l.windowNo+'"  disabled><label for="VAS_txtPUQtyForPU'+l.windowNo+'">'+VIS.Msg.getMsg("VAS_txtPUQtyForPU")+'</label></div > </div> </div> </div> <div class="VIS_Pref_show"><div class="VIS_Pref_dd"><div class= "input-group vis-input-wrap" id = "VAS_ddlSU'+l.windowNo+'" ></div></div> <div class="VIS_Pref_dd"><div class= "input-group vis-input-wrap vas-txtbox"><div class="vis-control-wrap"><input type="text" class="vas-txtbox"  value="1" placeholder="" data-placeholder=""  id ="VAS_txtSUQtyForSU'+l.windowNo+'" disabled><label for="VAS_txtSUQtyForSU'+l.windowNo+'">'+VIS.Msg.getMsg("VAS_txtSUQtyForSU")+'</label></div > </div> </div> <div class="VIS_Pref_dd"><div class= "input-group vis-input-wrap vas-txtbox"><div class="vis-control-wrap"><input type = "text" class= "vas-txtbox"  value = "1" placeholder = "" data-placeholder="" id = "VAS_txtPUQtyForSU'+l.windowNo+'" disabled > <label for="VAS_txtPUQtyForSU'+l.windowNo+'">'+VIS.Msg.getMsg("VAS_txtPUQtyForSU")+'</label></div > </div> </div> </div> <div class="VIS_Pref_show"><div class="VIS_Pref_dd"><div class= "input-group vis-input-wrap" id = "VAS_ddlCU'+l.windowNo+'" ></div></div> <div class="VIS_Pref_dd"><div class= "input-group vis-input-wrap vas-txtbox"><div class="vis-control-wrap"><input type="text" class="vas-txtbox" value="1" placeholder="" data-placeholder=""  id ="VAS_txtSUQtyForCU'+l.windowNo+'" disabled><label for="VAS_txtSUQtyForCU'+l.windowNo+'">'+VIS.Msg.getMsg("VAS_txtSUQtyForCU")+'</label></div > </div> </div> <div class="VIS_Pref_dd"><div class= "input-group vis-input-wrap vas-txtbox"><div class="vis-control-wrap"><input type = "text" class= "vas-txtbox"  value = "1" placeholder = "" data-placeholder="" id = "VAS_txtPUQtyForCU'+l.windowNo+'" disabled> <label for="VAS_txtPUQtyForCU'+l.windowNo+'">'+VIS.Msg.getMsg("VAS_txtPUQtyForCU")+'</label></div > </div> </div> </div> <div class="VAS_SaveCancelButtons text-right"><button id="VAS_Cancel'+l.windowNo+'">'+VIS.Msg.getMsg("VAS_Cancel")+'</button><button id="VAS_Save'+l.windowNo+'">'+VIS.Msg.getMsg("VAS_Save")+"</button></div></div>"),$inputUOM=n.find("#VAS_ddlUOM"+l.windowNo),$inputPurUnit=n.find("#VAS_ddlPU"+l.windowNo),$inputSuUnit=n.find("#VAS_ddlSU"+l.windowNo),$inputCuUnit=n.find("#VAS_ddlCU"+l.windowNo),$inputTaskField=n.find(".VAS_AdhocField"),r=n.find("#VAS_txtSUQtyForPU"+l.windowNo),o=n.find("#VAS_txtPUQtyForPU"+l.windowNo),c=n.find("#VAS_txtSUQtyForSU"+l.windowNo),u=n.find("#VAS_txtPUQtyForSU"+l.windowNo),d=n.find("#VAS_txtSUQtyForCU"+l.windowNo),g=n.find("#VAS_txtPUQtyForCU"+l.windowNo),p=n.find(".vas-txtbox"),v=VIS.Env.getCtx().getWindowContext(l.windowNo,"C_UOM_ID"),_=VIS.Env.getCtx().getWindowContext(l.windowNo,"M_Product_ID"),s=n.find("#VAS_Save"+l.windowNo),inputCancel=n.find("#VAS_Cancel"+l.windowNo)},this.getRoot=function(){return a},e.VAS_ProductUomSetup.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.initLoad()},50)},e.VAS_ProductUomSetup.prototype.dispose=function(){this.disposeComponent(),this.frame=null,this.windowNo=null,v=null},e.VAS_ProductUomSetup.prototype.setWidth=function(){return 1e3},e.VAS_ProductUomSetup.prototype.setHeight=function(){return 480},e.VAS_ProductUomSetup=e.VAS_ProductUomSetup}}(VAS,jQuery)},3378:()=>{VAS=window.VAS||{},function(e,t){e.UnAllocatedPaymentTabPanel=function(){this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var a=this,i=this.ctx;e.translatedTexts=VIS.Msg.translate(i,["DateTrx","DateAcct","VAS_PayNo","VAS_Amount","C_Payment_ID","AD_Org_ID","VAS_UnaAllocatedPayTabPanel","VAS_Zoom","AD_Window_ID","C_ConversionType_ID","VAS_RecordNo"],!0);var n=t('<div class="VAS-unallocated-flyout" style="width: 100%;">'),l=t('<div class="VAS-payment-details">');this.init=function(){var e=t('<ul id="VAS-unallocated_'+a.windowNo+'"></ul></div>');l.append(e),n.append(l)},this.getUnAllocatedPayData=function(i,n,s){t.ajax({url:VIS.Application.contextUrl+"VAS/PoReceipt/GetUnAllocatedPayData",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{C_BPartner_ID:i,IsSoTrx:n,AD_Org_ID:s},success:function(i){l.find("#VAS-unallocated_"+a.windowNo).empty();for(var n=JSON.parse(i),s=0;s<n.length;s++){var o='<li><span class="VAS-search-link"><i class="glyphicon glyphicon-zoom-in" data-PaymentId="'+n[s].C_Payment_ID+'" data-windowId="'+n[s].AD_Window_ID+'" id="VAS-unAllocatedZoom_'+a.windowNo+'"></i></span><div class="VAS-payment-opt w-100"><div class="VAS-paymentDetail"><div class="VAS-payment-val"><label for="" title="'+e.translatedTexts.VAS_PayNo+'">'+e.translatedTexts.VAS_PayNo+'</label><span class="vas-ualdocno" title="'+n[s].DocumentNo+'">'+n[s].DocumentNo+'</span></div><div class="VAS-payment-val"><label for="" title="'+e.translatedTexts.DateAcct+'">'+e.translatedTexts.DateAcct+"</label><span>"+VIS.Utility.Util.getValueOfDate(n[s].DateAcct).toLocaleDateString()+'</span></div><div class="VAS-paymentDetail VAS-grid-col1"><div class="VAS-payment-val"><label for="" title="'+e.translatedTexts.VAS_Amount+'">'+e.translatedTexts.VAS_Amount+'</label><span class="VAS-totalPrice">'+n[s].PayAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:n[s].StdPrecision,maximumFractionDigits:n[s].StdPrecision})+" "+n[s].CurrencyName+"</span></div></div></div></div></li>";l.find("#VAS-unallocated_"+a.windowNo).append(o)}l.find(".glyphicon-zoom-in").on("click",function(){!function(e,t){if(t>0){var a=new VIS.Query;a.addRestriction("C_Payment_ID",VIS.Query.prototype.EQUAL,e),a.setRecordCount(1),VIS.viewManager.startWindow(t,a)}}(VIS.Utility.Util.getValueOfInt(t(this).attr("data-PaymentId")),VIS.Utility.Util.getValueOfInt(t(this).attr("data-windowId")))})},error:function(e){console.log(e)}})},this.getRoot=function(){return n},e.UnAllocatedPaymentTabPanel.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,a.windowNo=e,this.init()},e.UnAllocatedPaymentTabPanel.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.getUnAllocatedPayData(t.c_bpartner_id,t.issotrx,t.ad_org_id)},e.UnAllocatedPaymentTabPanel.prototype.sizeChanged=function(e){this.panelWidth=e},e.UnAllocatedPaymentTabPanel.prototype.dispose=function(){this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth,lblTitle=null,i=this.ctx}}}(VAS,jQuery)},3392:()=>{!function(e,t){function a(){this.frame,this.windowNo;var a=this;this.arrListColumns=[],this.vdgvInvoice=null,this.vdgvReceipt=null,this.lblMatchFrom=new e.Controls.VLabel,this.lblMatchTo=new e.Controls.VLabel,this.lblMatchMode=new e.Controls.VLabel,this.lblBPartner=new e.Controls.VLabel,this.lblProduct=new e.Controls.VLabel,this.lblDateFrom=new e.Controls.VLabel,this.lblDateTo=new e.Controls.VLabel,this.lblInvoice=new e.Controls.VLabel,this.lblReceipt=new e.Controls.VLabel,this.lblMatched=new e.Controls.VLabel,this.lblMatchedTo=new e.Controls.VLabel,this.lblDifference=new e.Controls.VLabel,this.lblStatusInfo=new e.Controls.VLabel,this.lblStatusCount=new e.Controls.VLabel,this.lblSearch=new e.Controls.VLabel,this.cmbMatchFrom=new e.Controls.VComboBox("",!1,!1,!0),this.cmbMatchTo=new e.Controls.VComboBox("",!1,!1,!0),this.cmbMatchMode=new e.Controls.VComboBox("",!1,!1,!0),this.chkIsReturnTrx=null,this.chkSameBPartner=null,this.chkSameProduct=null,this.chkSameQty=null,this.onlyVendor=null,this.onlyProduct=null,this.dtpFrom=null,this.dtpTo=null,this.btnSearch=null,this.btnProcess=null,this.btnToggel=null,this.txtMatched=new e.Controls.VTextBox("",!1,!0,!1),this.txtMatchedTo=new e.Controls.VTextBox("",!1,!0,!1),this.txtDifference=new e.Controls.VTextBox("",!1,!0,!1),this.$root=t("<div style='width: 100%; height: 100%; background-color: white;'>"),this.$busyDiv=t("<div id='testBesy' class='vis-busyindicatorouterwrap'><div class='vis-busyindicatorinnerwrap'><i class='vis-busyindicatordiv'></i></div></div>"),this.sideDiv=null,this.gridSelectDiv=null,this.gridInvoiceDiv=null,this.gridReciptDiv=null,this.processlDiv=null,this.bottumDiv=null,this.bottumButtonDiv=null,this.btnSpaceDiv=null,this.topDiv=null,this.div=null,this.divForGrid=null,this.invoicegrd=null,this.reciptgrd=null,this.invoiceTopDiv=null;var i=!1,n=260,l=50,s=t(window).width()-n,o=t(window).width()-l,r=(t(window).height(),e.Env.getCtx().getAD_Client_ID(),e.Env.getCtx().getAD_Org_ID(),e.Env.getCtx().getAD_User_ID(),0),c=1,u=2,d=0,g=1,p="",v="",_=0,V=0,A="",m=null,f=null,D=!1,h=[];h.push(e.Msg.getElement3(e.Env.getAD_Language(e.Env.getCtx()),"C_Invoice_ID",!1)),h.push(e.Msg.getElement3(e.Env.getAD_Language(e.Env.getCtx()),"M_InOut_ID",!1)),h.push(e.Msg.getElement3(e.Env.getAD_Language(e.Env.getCtx()),"C_Order_ID",!1));var C=[];function S(e){J(),I(),a.lblStatusInfo.getControl().text(""),a.lblStatusCount.getControl().text(0)}function I(){a.cmbMatchTo.getControl().empty();var e=null;a.cmbMatchFrom.getControl().find("option").length>0&&((e=a.cmbMatchFrom.getControl().find("option:selected").val()).equals(h[r])||e.equals(h[u])?a.cmbMatchTo.getControl().append(" <option value='"+h[c]+"'>"+h[c]+"</option>"):(a.cmbMatchTo.getControl().append(" <option value='"+h[r]+"'>"+h[r]+"</option>"),a.cmbMatchTo.getControl().append(" <option value='"+h[u]+"'>"+h[u]+"</option>")),a.cmbMatchTo.getControl().prop("selectedIndex",0),a.lblInvoice.getControl().text(e)),y()}function y(){selection=a.cmbMatchTo.getControl().find("option:selected").val(),a.lblReceipt.getControl().text(selection)}function O(){var t=a.cmbMatchFrom.getControl()[0].selectedIndex,i=a.cmbMatchTo.getControl().find("option:selected").val(),n=r;if(i.equals(h[c])?n=c:i.equals(h[u])&&(n=u),Q=n,$(t,n),A="",null!=a.vdgvReceipt&&a.vdgvReceipt.clear(),null!=a.onlyProduct.getValue()){var l=a.onlyProduct.getValue();B=" AND lin.M_Product_ID="+l}if(null!=a.onlyVendor.getValue()){var s=a.onlyVendor.getValue();F=" AND hdr.C_BPartner_ID="+s}var o=a.dtpFrom.val(),d=a.dtpTo.val();""!=o&&""!=d?E=" AND "+p+" BETWEEN "+e.DB.to_date(o)+" AND "+e.DB.to_date(d):""!=o?k=" AND "+p+" >= "+e.DB.to_date(o):""!=d&&(G=" AND "+p+" <= "+e.DB.to_date(d)),W(a.vdgvInvoice),a.txtMatched.getControl().val(0),a.lblStatusInfo.getControl().text(a.cmbMatchFrom.getControl().find("option:selected").val()+"# = "+a.vdgvInvoice.records.length+" -"+a.cmbMatchTo.getControl().find("option:selected").val()+"# = "+a.vdgvReceipt.records.length),a.lblStatusCount.getControl().text(0)}function T(e){L="",R="",U="";var t=-1;null!=e?t=e:a.vdgvInvoice.getSelection().length>0&&(t=Number(a.vdgvInvoice.getSelection().toString()));var i=0;if(t<0)a.$busyDiv[0].style.visibility="hidden";else{var n=a.cmbMatchTo.getControl().find("option:selected").val(),l=r;n.equals(h[c])?l=c:n.equals(h[u])&&(l=u);var s=a.cmbMatchFrom.getControl()[0].selectedIndex;Q=s,$(l,s);var o={key:a.vdgvInvoice.get(t).C_BPartner_ID_K,value:a.vdgvInvoice.get(t).C_BPartner_ID},d={key:a.vdgvInvoice.get(t).M_Product_ID_K,value:a.vdgvInvoice.get(t).M_Product_ID};a.chkSameBPartner.prop("checked")&&(L=" AND hdr.C_BPartner_ID="+o.key),a.chkSameProduct.prop("checked")&&(R=" AND lin.M_Product_ID="+d.key);var g=a.vdgvInvoice.get(t).Qty;i=g-a.vdgvInvoice.get(t).Matched,a.chkSameQty.prop("checked")&&(U=" AND "+v+"="+g),A=a.vdgvInvoice.get(t).Line_K,W(a.vdgvReceipt)}_=i,a.txtMatched.setValue(_),a.txtMatchedTo.setValue(0),a.txtDifference.setValue(_),a.lblStatusInfo.getControl().text(a.cmbMatchFrom.getControl().find("option:selected").val()+"# = "+a.vdgvInvoice.records.length+" -"+a.cmbMatchTo.getControl().find("option:selected").val()+"# = "+a.vdgvReceipt.records.length),a.lblStatusCount.getControl().text(0)}function w(){var i=-1;if(a.vdgvInvoice.getSelection().length>0&&(i=Number(a.vdgvInvoice.getSelection().toString())),i<0)return D=!1,void(a.$busyDiv[0].style.visibility="hidden");a.vdgvInvoice.get(i).C_BPartner_ID_K,a.vdgvInvoice.get(i).C_BPartner_ID;var n={key:a.vdgvInvoice.get(i).Line_K,value:a.vdgvInvoice.get(i).Line},l=a.vdgvInvoice.get(i).M_Product_ID_K,s=(a.vdgvInvoice.get(i).M_Product_ID,_),o=(a.vdgvInvoice.get(i).Matched,a.vdgvReceipt.getSelection().toString());if(null==o)return D=!1,void(a.$busyDiv[0].style.visibility="hidden");if(o.length<=0)return D=!1,void(a.$busyDiv[0].style.visibility="hidden");var r=!0;(a.cmbMatchFrom.getControl().find("option:selected").val().equals(h[u])||a.cmbMatchTo.getControl().find("option:selected").val().equals(h[u]))&&(r=!1);var c=a.cmbMatchMode.getControl()[0].selectedIndex,d=a.cmbMatchFrom.getControl()[0].selectedIndex,g=[],p=o.toString().split(",");for(i=0;i<p.length;i++){if(null!=a.vdgvReceipt.get(p[i])._ID)l=={key:a.vdgvReceipt.get(p[i]).M_Product_ID_K,value:a.vdgvReceipt.get(p[i]).M_Product_ID}.key&&g.push(a.vdgvReceipt.get(p[i]))}if(!(g.length>0))return D=!1,void(a.$busyDiv[0].style.visibility="hidden");!function(i,n,l,s,o,r){t.ajax({url:e.Application.contextUrl+"Common/CreateMatchRecord",dataType:"json",data:{invoice:i,MatchMode:n,MatchFrom:l,LineMatched:s,ToMatchQty:o,SelectedItems:JSON.stringify(r)},success:function(t){O(),a.vdgvReceipt.delete(!0);var i=JSON.parse(t);""!=i.Msg?e.ADialog.info("",null,i.Msg,null):i.MatchedPO_ID>0?e.ADialog.info("Matched",null,e.Msg.getMsg("PurchaseOrder")+" - "+i.MatchedPO_ID,null):i.MatchedInv_ID>0&&e.ADialog.info("Matched",null,e.Msg.getMsg("Invoice")+" - "+i.MatchedInv_ID,null),D=!1,a.$busyDiv[0].style.visibility="hidden"},error:function(e,t,i){console.log(t),D=!1,a.$busyDiv[0].style.visibility="hidden"}})}(r,c,d,n.key,s,g)}C.push(e.Msg.getMsg("NotMatched")),C.push(e.Msg.getMsg("Matched"));var P="",b="",M="",x=!1,N="",L="",R="",U="",E="",k="",G="",B="",F="",Q="";function $(e,t){L="",R="",U="",E="",k="",G="",B="",F="",N=a.cmbMatchMode.getControl()[0].selectedIndex==g,P="",b=a.chkIsReturnTrx.prop("checked"),M="",x=!1,matchToTypeMATCH_ORDER="matchToTypeMATCH_ORDER",e==r?(P="displayMATCH_INVOICE",p="hdr.DateInvoiced",v="lin.QtyInvoiced"):e==u?(M="displayMATCH_ORDER",p="hdr.DateOrdered",v="lin.QtyOrdered"):(p="hdr.MovementDate",v="lin.MovementQty")}function W(i){var n=[],l={displayMATCH_INVOICEs:P,chkIsReturnTrxProps:b,displayMATCH_ORDERs:M,matchToTypeMATCH_SHIPMENTs:x,matchedsss:N,chkSameBPartnerss:L,chkSameProductss:R,chkSameQtyss:U,from_ss:E,fromIfs:k,to_Dats:G,matchToTypes:Q,MATCH_SHIPMENTs:c,MATCH_ORDERs:u,onlyProduct_ss:B,onlyVendor_ss:F,MatchToID:A};t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetTableLoadVmatch",dataType:"json",data:l,success:function(e){var l=JSON.parse(e);if(l&&null!=l)for(var s=1,o=0;o<l.length;o++){var r={};r._ID=l[o]._ID,r.DocumentNo=l[o].DocNo;var c=l[o].Date,u=new Date(c);l[o].Date=u.toLocaleDateString(),r.Date=l[o].Date,r.C_BPartner_ID=l[o].CBPartnerIDK,r.C_BPartner_ID_K=l[o].CBPartnerID,r.Line=l[o].Line,r.Line_K=l[o].Line_K,r.M_Product_ID=l[o].MProductIDK,r.M_Product_ID_K=l[o].MProductID,r.MAttributeSetInstance_ID=l[o].MAttributeSetInstance_ID,r.AttributeName=l[o].AttributeName,r.Qty=l[o].Qty,r.Matched=l[o].Matched,r.recid=s,s++,n.push(r)}n.length<1?(J(i.name.contains("vdgvReceipt")),a.$busyDiv[0].style.visibility="hidden"):i.name.contains("vdgvReceipt")?(!function(e,i){null!=a.vdgvReceipt&&(a.vdgvReceipt.destroy(),a.vdgvReceipt=null);w2utils.encodeTags(i),a.vdgvReceipt=t(a.reciptgrd).w2grid({name:"vdgvReceipt"+a.windowNo,recordHeight:30,show:{selectColumn:!0},onSelect:function(e){this.multiSelect=!0,j(e.recid,!0)},onUnselect:function(e){j(e.recid,!1)},multiSelect:!1,columns:e,records:i})}(a.arrListColumns,n),a.$busyDiv[0].style.visibility="hidden"):i.name.contains("vdgvInvoice")&&(!function(e,i){null!=a.vdgvInvoice&&(a.vdgvInvoice.destroy(),a.vdgvInvoice=null);w2utils.encodeTags(i),a.vdgvInvoice=t(a.invoicegrd).w2grid({name:"vdgvInvoice"+a.windowNo,recordHeight:30,show:{selectColumn:!1},onSelect:function(e){T(e.recid)},multiSelect:!1,columns:e,records:i})}(a.arrListColumns,n),T())},error:function(e){console.log(e),a.$busyDiv[0].style.visibility="hidden"}})}function J(i){0==a.arrListColumns.length&&(a.arrListColumns.push({field:"_ID",caption:"_ID",sortable:!0,size:"11%",hidden:!0}),a.arrListColumns.push({field:"DocumentNo",caption:e.Msg.translate(e.Env.getCtx(),"DocumentNo"),sortable:!0,size:"11%",hidden:!1}),a.arrListColumns.push({field:"Date",caption:e.Msg.translate(e.Env.getCtx(),"Date"),sortable:!0,size:"11%",hidden:!1}),a.arrListColumns.push({field:"C_BPartner_ID",caption:e.Msg.translate(e.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"11%",hidden:!1}),a.arrListColumns.push({field:"C_BPartner_ID_K",caption:e.Msg.translate(e.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"11%",hidden:!0}),a.arrListColumns.push({field:"Line",caption:e.Msg.translate(e.Env.getCtx(),"Line"),sortable:!0,size:"11%",hidden:!1}),a.arrListColumns.push({field:"Line_K",caption:e.Msg.translate(e.Env.getCtx(),"Line"),sortable:!0,size:"11%",hidden:!0}),a.arrListColumns.push({field:"M_Product_ID",caption:e.Msg.translate(e.Env.getCtx(),"M_Product_ID"),sortable:!0,size:"11%",hidden:!1}),a.arrListColumns.push({field:"M_Product_ID_K",caption:e.Msg.translate(e.Env.getCtx(),"M_Product_ID"),sortable:!0,size:"11%",hidden:!0}),a.arrListColumns.push({field:"MAttributeSetInstance_ID",caption:e.Msg.translate(e.Env.getCtx(),"ASI"),sortable:!0,size:"11%",hidden:!0}),a.arrListColumns.push({field:"AttributeName",caption:e.Msg.translate(e.Env.getCtx(),"ASI"),sortable:!0,size:"11%",hidden:!1}),a.arrListColumns.push({field:"Qty",caption:e.Msg.translate(e.Env.getCtx(),"Qty"),sortable:!0,size:"11%",hidden:!1,render:function(t,a,i){return e.Utility.Util.getValueOfDecimal(t.Qty).toLocaleString()}}),a.arrListColumns.push({field:"Matched",caption:e.Msg.translate(e.Env.getCtx(),"Matched"),sortable:!0,size:"11%",hidden:!1})),null==i?(null!=a.vdgvInvoice&&(a.vdgvInvoice.destroy(),a.vdgvInvoice=null),a.vdgvInvoice=t(a.invoicegrd).w2grid({name:"vdgvInvoice"+a.windowNo,recordHeight:30,show:{selectColumn:!1},onSelect:function(e){T(e.recid)},multiSelect:!1,columns:a.arrListColumns,records:null}),null!=a.vdgvReceipt&&(a.vdgvReceipt.destroy(),a.vdgvReceipt=null),a.vdgvReceipt=t(a.reciptgrd).w2grid({name:"vdgvReceipt"+a.windowNo,recordHeight:30,show:{selectColumn:!0},onSelect:function(e){this.multiSelect=!0,j(e.recid,!0)},onUnselect:function(e){j(e.recid,!1)},multiSelect:!1,columns:a.arrListColumns,records:null})):i?i&&(null!=a.vdgvReceipt&&(a.vdgvReceipt.destroy(),a.vdgvReceipt=null),a.vdgvReceipt=t(a.reciptgrd).w2grid({name:"vdgvReceipt"+a.windowNo,recordHeight:30,show:{selectColumn:!0},onSelect:function(e){this.multiSelect=!0,j(e.recid,!0)},onUnselect:function(e){j(e.recid,!1)},multiSelect:!1,columns:a.arrListColumns,records:null})):(null!=a.vdgvInvoice&&(a.vdgvInvoice.destroy(),a.vdgvInvoice=null),a.vdgvInvoice=t(a.invoicegrd).w2grid({name:"vdgvInvoice"+a.windowNo,recordHeight:30,show:{selectColumn:!1},onSelect:function(e){T(e.recid)},multiSelect:!1,columns:a.arrListColumns,records:null}))}function j(e,t){if(!(a.vdgvInvoice.records.length<1))if(a.chkSameProduct.prop("checked")){var i=-1,n=null;a.vdgvInvoice.getSelection().length>0&&(i=Number(a.vdgvInvoice.getSelection().toString()),n={key:a.vdgvInvoice.get(i).M_Product_ID_K,value:a.vdgvInvoice.get(i).M_Product_ID});var l=0,s=0,o=e+","+a.vdgvReceipt.getSelection().toString().replace(e,"");if(t&&null!=o&&o.length>0)for(var r=(o=o.replace(/,$/,"")).toString().split(","),c=0;c<r.length;c++){if(null!=a.vdgvReceipt.get(r[0])._ID){var u={key:a.vdgvReceipt.get(r[c]).M_Product_ID_K,value:a.vdgvReceipt.get(r[c]).M_Product_ID};if(n.key!=u.key)return void setTimeout(function(){a.vdgvReceipt.unselect(Number(e))},10);a.cmbMatchMode.getControl()[0].selectedIndex==d&&(l+=Number(a.vdgvReceipt.get(r[c]).Qty)),l-=Number(a.vdgvReceipt.get(r[c]).Matched),s++}}V=l,a.txtMatchedTo.setValue(V.toString()),a.txtDifference.setValue(_-V),s<=0&&a.btnProcess.removeAttr("disabled"),a.lblStatusCount.getControl().text(s)}else setTimeout(function(){a.vdgvReceipt.unselect(Number(e))},10)}this.Initialize=function(){for(var r=0;r<h.length;r++)this.cmbMatchFrom.getControl().append(" <option value='"+h[r]+"'>"+h[r]+"</option>");for(r=0;r<C.length;r++)this.cmbMatchMode.getControl().append(" <option value='"+C[r]+"'>"+C[r]+"</option>");this.cmbMatchFrom.getControl().prop("selectedIndex",0),this.cmbMatchMode.getControl().prop("selectedIndex",0),function(){var t=e.MLookupFactory.getMLookUp(e.Env.getCtx(),a.windowNo,3499,e.DisplayType.Search);a.onlyVendor=new e.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,e.DisplayType.Search,t),t=e.MLookupFactory.getMLookUp(e.Env.getCtx(),a.windowNo,3840,e.DisplayType.Search),a.onlyProduct=new e.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,e.DisplayType.Search,t)}(),function(){e.Application.contextUrl,a.dtpFrom=t("<input id='dateFrom_"+a.windowNo+"' type='date' name='DateOrdered'>"),a.dtpTo=t("<input id='dateTo_"+a.windowNo+"' type='date' name='DateOrdered'>"),this.chkIsReturnTrxDiv=t("<div>"),a.chkIsReturnTrx=t("<input id='chkIsReturnTrx_"+a.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblIsReturnTrx_"+a.windowNo+"' class='VIS_Pref_Label_Font'>Return Transaction</label></span>"),this.chkIsReturnTrxDiv.append(a.chkIsReturnTrx),this.chkSameBPartnerDiv=t("<div class='vis-matchpoTopcheckwrap'>"),a.chkSameBPartner=t("<input id='chkSameBPartner_"+a.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblSameBPartner_"+a.windowNo+"' class='VIS_Pref_Label_Font'>Same BPartner</label></span>"),this.chkSameBPartnerDiv.append(a.chkSameBPartner),this.chkSameProductDiv=t("<div class='vis-matchpoTopcheckwrap'>"),a.chkSameProduct=t("<input id='chkSameProduct_"+a.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblSameProduct_"+a.windowNo+"' class='VIS_Pref_Label_Font'>Same Product</label></span>"),this.chkSameProductDiv.append(a.chkSameProduct),this.chkSameQtyDiv=t("<div class='vis-matchpoTopcheckwrap'>"),a.chkSameQty=t("<input id='chkSameQty_"+a.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblSameQty_"+a.windowNo+"' class='VIS_Pref_Label_Font'>Same Quantity</label></span>"),this.chkSameQtyDiv.append(a.chkSameQty),a.btnSearch=t("<input id='btnSearch_"+a.windowNo+"' class='VIS_Pref_btn-2' style='margin-top: 0px;' type='button' value='Search'>"),a.btnProcess=t("<Button id='btnProcess_"+a.windowNo+"' style='margin-top: 0px;' class='VIS_Pref_btn-2'>"+e.Msg.getMsg("Match")+"</Button>"),a.lblInvoice.getControl().text(e.Msg.translate(e.Env.getCtx(),"Invoice")),a.lblReceipt.getControl().text(e.Msg.translate(e.Env.getCtx(),"Receipt")),a.lblMatchFrom.getControl().text(e.Msg.translate(e.Env.getCtx(),"MatchFrom")),a.lblMatchTo.getControl().text(e.Msg.translate(e.Env.getCtx(),"MatchTo")),a.lblMatchMode.getControl().text(e.Msg.translate(e.Env.getCtx(),"MatchMode")),a.lblBPartner.getControl().text(e.Msg.translate(e.Env.getCtx(),"C_BPartner_ID")),a.lblProduct.getControl().text(e.Msg.translate(e.Env.getCtx(),"M_Product_ID")),a.lblDateFrom.getControl().text(e.Msg.translate(e.Env.getCtx(),"DateFrom")),a.lblDateTo.getControl().text(e.Msg.translate(e.Env.getCtx(),"DateTo")),a.lblMatched.getControl().text(e.Msg.translate(e.Env.getCtx(),"ToBeMatched")),a.lblMatchedTo.getControl().text(e.Msg.translate(e.Env.getCtx(),"Matching")),a.lblDifference.getControl().text(e.Msg.translate(e.Env.getCtx(),"Difference")),a.chkIsReturnTrx.prop("checked",!1),a.btnProcess.attr("disabled","disabled"),a.chkSameProduct.prop("checked",!0),a.chkSameBPartner.prop("checked",!0),a.chkSameQty.prop("checked",!1),a.chkIsReturnTrx.next("label").text(e.Msg.translate(e.Env.getCtx(),"isReturnTrx")),a.chkSameProduct.next("label").text(e.Msg.translate(e.Env.getCtx(),"SameProduct")),a.chkSameBPartner.next("label").text(e.Msg.translate(e.Env.getCtx(),"SameBPartner")),a.chkSameQty.next("label").text(e.Msg.translate(e.Env.getCtx(),"SameQty")),a.lblSearch.getControl().text(e.Msg.translate(e.Env.getCtx(),"Search")),a.btnSearch.text(e.Msg.translate(e.Env.getCtx(),"Search"))}(),function(){e.Application.contextUrl,m=t('<button id = "btnClearBP_'+a.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+e.Msg.getMsg("Clear",!1,!1)+'"></i></button>'),f=t('<button id = "btnClearOrd_'+a.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+e.Msg.getMsg("Clear",!1,!1)+'"></i></button>'),a.topDiv=t("<div id='topDiv_"+a.windowNo+"'  class='vis-archive-l-s-head vis-frm-ls-top' style='padding: 0;'><div id='btnSpaceDiv_"+a.windowNo+"' class='vis-l-s-headwrp'><button id='btnToggelDiv_"+a.windowNo+"' class='vis-archive-sb-t-button' ><i class='vis vis-arrow-left'></i></button></div></div>");var i=t("<div class='vis-frm-contenthead'>");i.append(a.lblInvoice.getControl().addClass("VIS_Pref_Label_Font")),i.append(chkSameBPartnerDiv),i.append(chkSameProductDiv),i.append(chkSameQtyDiv),a.topDiv.append(i),a.invoiceTopDiv=i,a.btnSpaceDiv=a.topDiv.find("#btnSpaceDiv_"+a.windowNo),a.sideDiv=t("<div id='sideDiv_"+a.windowNo+"' class='vis-archive-l-s-content vis-mi-ls-wrp vis-leftsidebarouterwrap'>"),a.sideDiv.css("width",n),a.div=t("<div class='vis-archive-l-s-content-inner' id='parameterDiv_"+a.windowNo+"'>"),a.sideDiv.append(a.div);var l=t("<table style='width: 100%;height: 100%;'>");a.div.append(l),tr=t("<tr>"),td=t("<td style='padding: 10px 10px 0px;'>");var s=t('<div class="input-group vis-input-wrap">'),o=t('<div class="vis-control-wrap">');l.append(tr),tr.append(td),td.append(s),s.append(o),o.append(a.cmbMatchFrom.getControl()),o.append(a.lblMatchFrom.getControl().addClass("VIS_Pref_Label_Font")),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px;'>"),s=t('<div class="input-group vis-input-wrap">'),o=t('<div class="vis-control-wrap">'),l.append(tr),tr.append(td),td.append(s),s.append(o),o.append(a.cmbMatchTo.getControl()),o.append(a.lblMatchTo.getControl().addClass("VIS_Pref_Label_Font")),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px;'>"),s=t('<div class="input-group vis-input-wrap">'),o=t('<div class="vis-control-wrap">'),l.append(tr),tr.append(td),td.append(s),s.append(o),o.append(a.cmbMatchMode.getControl()),o.append(a.lblMatchMode.getControl().addClass("VIS_Pref_Label_Font")),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px;'>"),s=t('<div class="input-group vis-input-wrap">'),o=t('<div class="vis-control-wrap">');var r=t('<div class="input-group-append">');l.append(tr),tr.append(td),td.append(s),s.append(o),o.append(a.onlyVendor.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),o.append(a.lblBPartner.getControl().addClass("VIS_Pref_Label_Font")),r.append(a.onlyVendor.getBtn(0)),r.append(m),s.append(r),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px;'>"),s=t('<div class="input-group vis-input-wrap">'),o=t('<div class="vis-control-wrap">'),r=t('<div class="input-group-append">'),l.append(tr),tr.append(td),td.append(s),s.append(o),o.append(a.onlyProduct.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),o.append(a.lblProduct.getControl().addClass("VIS_Pref_Label_Font")),r.append(a.onlyProduct.getBtn(0)),r.append(f),s.append(r),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px;'>"),s=t('<div class="input-group vis-input-wrap">'),o=t('<div class="vis-control-wrap">'),l.append(tr),tr.append(td),td.append(s),s.append(o),o.append(a.dtpFrom),o.append(a.lblDateFrom.getControl().addClass("VIS_Pref_Label_Font")),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px;'>"),s=t('<div class="input-group vis-input-wrap">'),o=t('<div class="vis-control-wrap">'),l.append(tr),tr.append(td),td.append(s),s.append(o),o.append(a.dtpTo),o.append(a.lblDateTo.getControl().addClass("VIS_Pref_Label_Font")),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px;'>"),l.append(tr),tr.append(td),td.append(chkIsReturnTrxDiv),a.divForGrid=t("<div id='divForGrid_"+a.windowNo+"' class='vis-mi-main-contntwrp'>"),a.gridInvoiceDiv=t("<div id='gridInvoiceDiv_"+a.windowNo+"' style='width: 100%;flex: 1; '>"),a.invoicegrd=t("<div style='float: left; width: 100%;height: 100%;'>"),a.gridInvoiceDiv.append(a.invoicegrd),a.gridReciptDiv=t("<div id='gridReciptDiv_"+a.windowNo+"' style='width: 100%;flex: 1;'>");var c=t("<div style='float: left; width: 100%; margin-top: 0px;'>");c.append(a.lblReceipt.getControl().css("display","inline-block").css("font-size","24px").css("color","rgba(var(--v-c-primary), 1)").addClass("VIS_Pref_Label_Font")),a.reciptgrd=t("<div style='float: left; width: 100%;height: 100%;'>"),a.gridReciptDiv.append(a.reciptgrd);var u=t("<div class='vis-info-btnfileds-wrap'>"),d=t("<div class='vis-info-botdatafield'>"),g=t("<div class='input-group vis-input-wrap'>"),p=t("<div class='vis-control-wrap'>");d.append(g),g.append(p),p.append(a.txtMatched.getControl()),p.append(a.lblMatched.getControl().addClass("VIS_Pref_Label_Font")),u.append(d);var v=t("<div class='vis-info-botdatafield' style='padding-left: 15px;'>"),_=t("<div class='input-group vis-input-wrap'>"),V=t("<div class='vis-control-wrap'>");v.append(_),_.append(V),V.append(a.txtMatchedTo.getControl()),V.append(a.lblMatchedTo.getControl().addClass("VIS_Pref_Label_Font")),u.append(v);var A=t("<div class='vis-info-botdatafield' style='padding-left: 15px;'>"),D=t("<div class='input-group vis-input-wrap'>"),h=t("<div class='vis-control-wrap'>");A.append(D),D.append(h),h.append(a.txtDifference.getControl()),h.append(a.lblDifference.getControl().addClass("VIS_Pref_Label_Font")),u.append(A),a.bottumButtonDiv=t("<div class='vis-info-btmcnt-wrap'>"),a.searchBtnWrap=t("<div class='vis-info-searchbtn-wrap'>"),a.bottumButtonDiv.append(a.searchBtnWrap),a.searchBtnWrap.append(a.btnSearch),a.bottumButtonDiv.append(u),a.bottumButtonDiv.append(a.btnProcess),a.bottumDiv=t("<div class='vis-mi-bot-div'>"),a.bottumDiv.append(a.lblStatusInfo.getControl().addClass("VIS_Pref_Label_Font")),a.bottumDiv.append(a.lblStatusCount.getControl().css("float","right").addClass("VIS_Pref_Label_Font")),a.divForGrid.append(a.gridInvoiceDiv).append(c).append(a.gridReciptDiv),a.$root.append(a.topDiv).append(a.sideDiv).append(a.divForGrid).append(a.bottumButtonDiv).append(a.bottumDiv),a.$root.append(a.$busyDiv)}(),this.btnToggel=this.$root.find("#btnToggelDiv_"+a.windowNo),this.gridSelectDiv=this.$root.find("#divForGrid_"+a.windowNo),null!=this.cmbMatchFrom.getControl()&&this.cmbMatchFrom.getControl().change(function(){a.$busyDiv[0].style.visibility="visible",S(),I(),a.$busyDiv[0].style.visibility="hidden"}),null!=this.cmbMatchTo.getControl()&&this.cmbMatchTo.getControl().change(function(){a.$busyDiv[0].style.visibility="visible",y(),a.$busyDiv[0].style.visibility="hidden"}),null!=this.cmbMatchMode.getControl()&&this.cmbMatchMode.getControl().change(function(){a.cmbMatchMode.getControl()[0].selectedIndex==d?a.btnProcess.text(e.Msg.getMsg("Match")):a.btnProcess.text(e.Msg.getMsg("Unmatch"))}),null!=this.btnSearch&&this.btnSearch.on(e.Events.onTouchStartOrClick,function(){a.$busyDiv[0].style.visibility="visible",O()}),null!=this.btnProcess&&this.btnProcess.on(e.Events.onTouchStartOrClick,function(e){D||(a.$busyDiv[0].style.visibility="visible",D=!0,w())}),null!=this.btnToggel&&this.btnToggel.on(e.Events.onTouchStartOrClick,function(){i?(a.btnToggel.animate({borderSpacing:0},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),i=!1,a.btnSpaceDiv.animate({width:n},"slow"),a.gridSelectDiv.animate({width:s},"slow"),a.invoiceTopDiv.animate({width:s},"slow"),a.div.css("display","block"),a.sideDiv.animate({width:n},"slow",null,function(){a.vdgvInvoice.resize(),a.vdgvReceipt.resize()})):(a.btnToggel.animate({borderSpacing:180},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),i=!0,a.btnSpaceDiv.animate({width:l},"slow"),a.sideDiv.animate({width:l},"slow"),a.div.css("display","none"),a.invoiceTopDiv.animate({width:o},"slow"),a.gridSelectDiv.animate({width:o},"slow",null,function(){a.vdgvInvoice.resize(),a.vdgvReceipt.resize()}))}),this.chkSameBPartner.change(function(){a.$busyDiv[0].style.visibility="visible",T()}),this.chkSameQty.change(function(){a.$busyDiv[0].style.visibility="visible",T()}),this.chkSameProduct.change(function(){a.$busyDiv[0].style.visibility="visible",T()}),null!=m&&m.on(e.Events.onTouchStartOrClick,function(){a.onlyVendor.isReadOnly||a.onlyVendor.setValue(null,!1,!0)}),null!=f&&f.on(e.Events.onTouchStartOrClick,function(){a.onlyProduct.isReadOnly||a.onlyProduct.setValue(null,!1,!0)}),a.$busyDiv[0].style.visibility="hidden"},this.display=function(){S()},this.getRoot=function(){return this.$root},this.refreshUI=function(){this.vdgvInvoice.refresh(),this.vdgvReceipt.refresh()},this.callConsolidate=function(){t.ajax({url:e.Application.contextUrl+"Common/Consolidate",dataType:"json",async:!0,success:function(e){}}),a.vdgvReceipt.multiSelect=!0;var i="vdgvReceipt"+a.windowNo;w2ui[i].multiSelect=!0},this.disposeComponent=function(){this.btnSearch&&this.btnSearch.off(e.Events.onTouchStartOrClick),this.btnProcess&&this.btnProcess.off(e.Events.onTouchStartOrClick),this.btnToggel&&this.btnToggel.off(e.Events.onTouchStartOrClick),this.frame=null,this.windowNo=null,this.arrListColumns=null,this.vdgvInvoice=null,this.vdgvReceipt=null,this.lblMatchFrom=null,this.lblMatchTo=null,this.lblMatchMode=null,this.lblBPartner=null,this.lblProduct=null,this.lblDateFrom=null,this.lblDateTo=null,this.lblInvoice=null,this.lblReceipt=null,this.lblMatched=null,this.lblMatchedTo=null,this.lblDifference=null,this.lblStatusInfo=null,this.lblStatusCount=null,this.lblSearch=null,this.cmbMatchFrom=null,this.cmbMatchTo=null,this.cmbMatchMode=null,this.chkIsReturnTrx=null,this.chkSameBPartner=null,this.chkSameProduct=null,this.chkSameQty=null,this.onlyVendor=null,this.onlyProduct=null,this.dtpFrom=null,this.dtpTo=null,this.btnSearch=null,this.btnProcess=null,this.btnToggel=null,this.txtMatched=null,this.txtMatchedTo=null,this.txtDifference=null,this.$root=null,this.$busyDiv=null,this.sideDiv=null,this.gridSelectDiv=null,this.gridInvoiceDiv=null,this.gridReciptDiv=null,this.processlDiv=null,this.bottumDiv=null,this.btnSpaceDiv=null,i=null,n=null,l=null,s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=null,_=null,V=null,a=null,h=null,C=null,this.disposeComponent=null}}e.Apps.AForms=e.Apps.AForms||{},a.prototype.init=function(t,a){this.frame=a,this.windowNo=t,e.Env.getCtx().setContext(this.windowNo,"IsSOTrx","Y");try{this.Initialize()}catch(e){}this.frame.getContentGrid().append(this.getRoot()),this.display(),this.callConsolidate()},a.prototype.refresh=function(){this.refreshUI()},a.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.VMatch=a}(VIS,jQuery)},3475:()=>{!function(t){var a=t.Logging.Level,i=t.Utility.Util;function n(){t.CalloutEngine.call(this,"VIS.CalloutGLJournal")}t.Utility.inheritPrototype(n,t.CalloutEngine),n.prototype.Period=function(e,a,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";var r=l.getColumnName();this.setCalloutActive(!0);var c=e.getContextAsInt(a,"AD_Client_ID",!1),u=i.getValueOfInt(n.getValue("AD_Org_ID")),d=new Date;d="DateAcct"==r?s:n.getValue("DateAcct");var g=0;if("C_Period_ID"==r&&(g=i.getValueOfInt(s)),"DateDoc"==r)n.setValue("DateAcct",s);else if("DateAcct"==r||"AD_Org_ID"==r){var p=c+","+d+","+u;0!=(g=i.getValueOfInt(t.dataContext.getJSONRecord("MPeriod/GetPeriod",p)))&&n.setValue("C_Period_ID",g)}else{var v=t.dataContext.getJSONRecord("MPeriod/GetPeriodDetail",g.toString());if(null!=v){var _=v.PeriodType,V=v.StartDate,A=v.EndDate;"S"==_&&(null==d||d<V||d>A)&&n.setValue("DateAcct",A)}}return this.setCalloutActive(!1),e=a=n=l=s=null,""},n.prototype.Rate=function(n,l,s,o,r,c){if(null==r||""==r.toString())return"";try{var u=i.getValueOfInt(s.getValue("C_Currency_ID")),d=i.getValueOfInt(u),g=i.getValueOfInt(s.getValue("C_ConversionType_ID")),p=i.getValueOfInt(g),v=s.getValue("DateAcct");if(null==v)v=(new Date).toGMTString();var _=i.getValueOfInt(n.getContextAsInt(l,"C_AcctSchema_ID",!1)),V=t.dataContext.getJSONRecord("MAcctSchema/GetAcctSchema",_),A=i.getValueOfInt(n.getContextAsInt(l,"AD_Client_ID",!1)),m=i.getValueOfInt(n.getContextAsInt(l,"AD_Org_ID",!1)),f=d+","+V.C_Currency_ID+","+v+","+p+","+A+","+m,D=t.dataContext.getJSONRecord("MConversionRate/GetRate",f);this.log.fine("rate = "+D),null==D&&(D=0),s.setValue("CurrencyRate",D)}catch(t){return this.log.log(a.SEVERE,sql,e),this.setCalloutActive(!1),e.message}return n=l=s=r=null,""},n.prototype.Amt=function(e,a,n,l,s,o){if(null==s||""==s.toString()||this.isCalloutActive())return"";this.setCalloutActive(!0);var r=i.getValueOfInt(e.getContextAsInt(a,"C_AcctSchema_ID")).toString(),c=t.dataContext.getJSONRecord("MAcctSchema/GetAcctSchema",r).StdPrecision,u=n.getValue("CurrencyRate");null==u&&(u=1,n.setValue("CurrencyRate",u));var d=n.getValue("AmtSourceDr");null==d&&(d=0);var g=n.getValue("AmtSourceCr");null==g&&(g=0);var p=d*u;p.toFixed(c),n.setValue("AmtAcctDr",p);var v=g*u;return v.toFixed(c),n.setValue("AmtAcctCr",v),this.setCalloutActive(!1),e=a=n=s=null,""},t.Model.CalloutGLJournal=n}(VIS,jQuery)},3490:()=>{!function(e,t){function a(){this.frame,this.windowNo;var a=this;this.arrListColumns=[],this.dGrid=null;var i=null,n=null,l=null,s=!1;this.lblOrg=new e.Controls.VLabel,this.lblBPartner=new e.Controls.VLabel,this.lblStatusInfo=new e.Controls.VLabel,this.tabSelect=new e.Controls.VLabel,this.tabGenrate=new e.Controls.VLabel,this.cmbOrg=new e.Controls.VComboBox("",!1,!1,!0),this.vSearchBPartner=null,this.vSearchOrderShipment=null;var o=null;this.$root=t("<div style='width: 100%; height: 100%; background-color: white;'>"),this.$busyDiv=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),this.topDiv=null,this.sideDiv=null,this.gridSelectDiv=null,this.gridGenerateDiv=null,this.bottumDiv=null,this.div=null,this.okBtn=null,this.cancelBtn=null,this.btnRefresh=null,this.btnToggel=null,this.spnSelect=null,this.spnGenerate=null,this.btnSpaceDiv=null,this.lblGenrate=null,this.lblSelect=null;var r=null,c=null,u=260,d=50,g=t(window).width()-(u+20+5),p=t(window).width()-70;t(window).height();function v(i){null!=a.dGrid&&(a.dGrid.destroy(),a.dGrid=null),0==a.arrListColumns.length&&(a.arrListColumns.push({field:"AD_Org_ID",caption:e.Msg.translate(e.Env.getCtx(),"AD_Org_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),a.arrListColumns.push({field:"C_DocType_ID",caption:e.Msg.translate(e.Env.getCtx(),"C_DocType_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),a.arrListColumns.push({field:"DocumentNo",caption:e.Msg.getElement(e.Env.getCtx(),"DocumentNo"),sortable:!0,size:"16%",min:150,hidden:!1}),a.arrListColumns.push({field:"C_BPartner_ID",caption:e.Msg.getElement(e.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),a.arrListColumns.push({field:"DateOrdered",caption:e.Msg.getElement(e.Env.getCtx(),"DateOrdered"),sortable:!0,size:"16%",min:150,hidden:!1,render:function(e,t,a){var i;return i=null==e.changes||null==e.changes.DateOrdered?e.DateOrdered:e.changes.DateOrdered,new Date(i).toLocaleDateString()}}),a.arrListColumns.push({field:"TotalLines",caption:e.Msg.getElement(e.Env.getCtx(),"TotalLines"),sortable:!0,size:"20%",min:150,hidden:!1,align:"right",render:function(e,t,a){var i=e.TotalLines;return parseFloat(i).toLocaleString()}}),a.arrListColumns.push({field:"C_Order_ID",caption:e.Msg.translate(e.Env.getCtx(),"C_UOM_ID"),sortable:!0,size:"150px",hidden:!0})),w2utils.encodeTags(i),a.dGrid=t(a.gridSelectDiv).w2grid({name:"gridGenForm"+a.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:a.arrListColumns,records:i})}function _(){var i=[],s=e.Env.getCtx().getAD_Client_ID(),r="",c="",u="";null!=n&&"-1"!=n.toString()&&(r=" AND ic.AD_Org_ID="+n),null!=l&&(c=" AND ic.C_BPartner_ID="+l),null!=o&&(u=" AND C_Order_ID="+o),t(a.$root[0]).addClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv"),a.$busyDiv[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"VCreateFrom/ExecuteQueryVInvoiceGen",type:"POST",data:{adClientID:s,adOrgIDs:r,cBPartnerIDs:c,ordShipmentids:u},success:function(n){var l=JSON.parse(n);if(l&&l.length>0)try{for(var s=1,o=0;o<l.length;o++){var r={};r.C_Order_ID=l[o].c_order_id,r.AD_Org_ID=l[o].ord,r.C_DocType_ID=l[o].doctype,r.DocumentNo=l[o].documentno,r.C_BPartner_ID=l[o].bpname,r.DateOrdered=l[o].dateordered,r.TotalLines=l[o].tLines,r.recid=s,s++,i.push(r)}}catch(e){}else e.ADialog.info("NoDataFound"),a.okBtn.attr("disabled","disabled");v(i),t(a.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv"),a.$busyDiv[0].style.visibility="hidden"},error:function(e){t(a.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv"),a.$busyDiv[0].style.visibility="hidden"}})}function V(i){var n=a;a.$busyDiv[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Common/GenerateInvoices",dataType:"json",data:{whereClause:i},success:function(i){null!=i.DocumentText&&(!function(e){e&&(a.btnRefresh.hide(),a.okBtn.hide(),a.btnToggel.animate({borderSpacing:0},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),e=!1,a.gridSelectDiv.animate({width:g},"fast"),a.sideDiv.animate({width:"toggle",height:"toggle"},"slow"));a.gridSelectDiv.css("display","none"),a.sideDiv.css("display","none"),a.gridGenerateDiv.css("display","block"),a.btnToggel.hide(),lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary),1)"),lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")}(!0),n.gridGenerateDiv.html(i.DocumentText),n.lblStatusInfo.getControl().text(i.lblStatusInfo)),null!=i.ErrorMsg&&e.ADialog.info("",null,i.ErrorMsg,null),n.$busyDiv[0].style.visibility="hidden",t(a.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")},error:function(e){n.$busyDiv[0].style.visibility="hidden",t(a.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")}})}this.vetoablechange=function(e){l=a.vSearchBPartner.getValue(),o=a.vSearchOrderShipment.getValue(),a.okBtn.removeAttr("disabled"),_()},this.sizeChanged=function(e,t){g=t-(u+20),p=t-70,1==s?(a.btnSpaceDiv.animate({width:d},"slow"),a.sideDiv.animate({width:d},"slow"),a.div.css("display","none"),a.gridSelectDiv.animate({width:p},"slow",null,function(){a.dGrid.resize()})):(a.btnSpaceDiv.animate({width:u},"slow"),a.gridSelectDiv.animate({width:g},"slow"),a.div.css("display","block"),a.sideDiv.animate({width:u},"slow",null,function(){a.dGrid.resize()}))},this.Initialize=function(){if(function(){var t=e.MLookupFactory.get(e.Env.getCtx(),a.windowNo,2163,e.DisplayType.TableDir,"AD_Org_ID",0,!1,"AD_Org.AD_Org_ID <> 0 AND AD_Org.IsSummary='N' AND AD_Org.IsActive='Y' AND AD_Org.IsCostCenter='N' AND AD_Org.IsProfitCenter='N' ");a.cmbOrg=new e.Controls.VComboBox("AD_Org_ID",!0,!1,!0,t,150,e.DisplayType.TableDir,0);var i=e.MLookupFactory.get(e.Env.getCtx(),a.windowNo,2762,e.DisplayType.Search,"C_BPartner_ID",0,!1,"C_BPartner.IsActive ='Y' And C_Bpartner.Issummary ='N'");a.vSearchBPartner=new e.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,e.DisplayType.Search,i,0);var n=e.MLookupFactory.get(e.Env.getCtx(),a.windowNo,2161,e.DisplayType.Search,"C_Order_ID",0,!1,"DocStatus='CO'");a.vSearchOrderShipment=new e.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,e.DisplayType.Search,n,0)}(),a.lblOrg.getControl().text(e.Msg.translate(e.Env.getCtx(),"AD_Org_ID")),a.lblBPartner.getControl().text(e.Msg.translate(e.Env.getCtx(),"C_BPartner_ID")),a.tabSelect.getControl().text(e.Msg.getMsg("Select",!1,!1)),a.tabGenrate.getControl().text(e.Msg.getMsg("Generate",!1,!1)),a.lblStatusInfo.getControl().text(e.Msg.getMsg("VIS_OrderGenInv",!1,!1)),function(){var i="topDiv_"+a.windowNo,n="btnSpaceDiv_"+a.windowNo,l="btnSpace_"+a.windowNo,s="spnSelect_"+a.windowNo,o="spnGenerate_"+a.windowNo,d="lblGenerate_"+a.windowNo,g="lblSelect_"+a.windowNo;r=t('<button id = "btnClearBP_'+a.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+e.Msg.getMsg("Clear",!1,!1)+'"></i></button>'),c=t('<button id = "btnClearOrd_'+a.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+e.Msg.getMsg("Clear",!1,!1)+'"></i></button>'),e.Application.contextUrl,a.topDiv=t("<div id='"+i+"' class='vis-archive-l-s-head vis-frm-ls-top' style='padding: 0;'><div id='"+n+"' class='vis-l-s-headwrp'><button id='"+l+"' class='vis-archive-sb-t-button' ><i class='vis vis-arrow-left'></i></button></div><div id='"+s+"'style='display: inline-block;  padding-left: 15px;margin-right: 15px;' ><label id='"+g+"' class='VIS_Pref_Label_Font' style='vertical-align: middle;font-size: 28px;color: rgba(var(--v-c-primary), 1);'>"+e.Msg.translate(e.Env.getCtx(),"Select")+"</label></div><div id='"+o+"' style='display: inline-block; width: 160px;'><label id='"+d+"' class='VIS_Pref_Label_Font' style='vertical-align: middle; font-size: 17px;'>"+e.Msg.translate(e.Env.getCtx(),"Generate")+"</label></div></div>");var p="sideDiv_"+a.windowNo,v="parameterDiv_"+a.windowNo;a.btnSpaceDiv=a.topDiv.find("#"+n),this.lblGenrate=a.topDiv.find("#"+d),this.lblSelect=a.topDiv.find("#"+g),a.sideDiv=t("<div id='"+p+"' class='vis-archive-l-s-content vis-leftsidebarouterwrap'>"),a.sideDiv.css("width",u),a.sideDiv.css("height","calc(100% - 103px)"),a.div=t("<div class='vis-archive-l-s-content-inner' id='"+v+"'>"),a.sideDiv.append(a.div);var _=t("<table style='width: 100%;'>");a.div.append(_),tr=t("<tr>"),td=t("<td style='padding: 10px 10px 0px;'>");var V=t('<div class="input-group vis-input-wrap">'),A=t('<div class="vis-control-wrap">');_.append(tr),tr.append(td),td.append(V),V.append(A),A.append(a.cmbOrg.getControl()),A.append(a.lblOrg.getControl().addClass("VIS_Pref_Label_Font")),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px;'>"),V=t('<div class="input-group vis-input-wrap">'),A=t('<div class="vis-control-wrap">');var m=t('<div class="input-group-append">');_.append(tr),tr.append(td),td.append(V),V.append(A),A.append(a.vSearchBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),m.append(a.vSearchBPartner.getBtn(0)),m.append(r),A.append(a.lblBPartner.getControl().addClass("VIS_Pref_Label_Font")),V.append(m);var f=e.Msg.translate(e.Env.getCtx(),"DocumentNo");tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px;'>"),V=t('<div class="input-group vis-input-wrap">'),A=t('<div class="vis-control-wrap">'),m=t('<div class="input-group-append">'),_.append(tr),tr.append(td),td.append(V),V.append(A),A.append(a.vSearchOrderShipment.getControl(0).attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),m.append(a.vSearchOrderShipment.getBtn(0)),m.append(c),A.append("<label>"+f+"</label>"),V.append(m),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px;font-size:12px;'>"),_.append(tr),tr.append(td),td.append("("+e.Msg.getMsg("SalesOrderNo",!1,!1)+")");var D="gridSelectDiv_"+a.windowNo,h="gridGenerateDiv_"+a.windowNo;a.gridSelectDiv=t("<div id='"+D+"' class='vis-frm-grid-outerwrp'>"),a.gridGenerateDiv=t("<div id='"+h+"' style='height: 85%; float: right; display: none; background-color: #F1F1F1; margin-left: 15px;;margin-right: 15px;'>"),a.gridGenerateDiv.css("width",t(window).width()-30);var C="btnOk_"+a.windowNo;a.okBtn=t("<input id='"+C+"' class='VIS_Pref_btn-2' style='margin-top: 0px; float: right;width: 70px;height: 38px;' type='button' value='Ok'>"),C="btnRefresh_"+a.windowNo,e.Application.contextUrl,a.btnRefresh=t("<button id='"+C+"' style='margin-top: 0px; float: left;height: 38px; ' class='VIS_Pref_btn-2'><i class='vis vis-refresh'></i></button>");var S="discriptionDiv_"+a.windowNo;a.bottumDiv=t("<div class='vis-info-btmcnt-wrap vis-p-t-10'>");var I=t("<div id='"+S+"' style='flex: 1;padding: 0 10px;'>");I.append(a.lblStatusInfo.getControl().addClass("VIS_Pref_Label_Font"));var y=t("<div>");y.append(a.okBtn),a.bottumDiv.append(a.btnRefresh).append(I).append(y),a.$root.append(a.$busyDiv),a.$busyDiv[0].style.visibility="hidden",a.$root.append(a.topDiv).append(a.sideDiv).append(a.gridSelectDiv).append(a.gridGenerateDiv).append(a.bottumDiv)}(),this.btnToggel=this.$root.find("#btnSpace_"+a.windowNo),this.spnSelect=this.$root.find("#spnSelect_"+a.windowNo),this.spnGenerate=this.$root.find("#spnGenerate_"+a.windowNo),null!=this.okBtn&&this.okBtn.on(e.Events.onTouchStartOrClick,function(){a.$busyDiv[0].style.visibility="visible",t(a.$root[0]).addClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv"),a.okBtn.attr("disabled","disabled"),null!=(i=function(){if(null==a.dGrid)return!1;var e=[],t=a.dGrid.getSelection();if(null!=t&&!(t.length<=0)){for(var i=t.toString().split(","),n=0;n<i.length;n++)e[n]=a.dGrid.get(i[n]).C_Order_ID;if(0==e.length)return"";var l="";for(n=0;n<e.length;n++)n>0&&(l=l.concat(",")),l=l.concat(e[n].toString());return l.toString()}}())&&i.length>0?V(i):(a.$busyDiv[0].style.visibility="hidden",e.ADialog.error("PlzSelectatLeast1Inv")),a.okBtn.removeAttr("disabled")}),null!=this.cancelBtn&&this.cancelBtn.on(e.Events.onTouchStartOrClick,function(){a.$root.dialog("close")}),null!=this.btnRefresh&&this.btnRefresh.on(e.Events.onTouchStartOrClick,function(){a.okBtn.removeAttr("disabled"),n=a.cmbOrg.getControl().find("option:selected").val(),l=a.vSearchBPartner.getValue(),_()}),null!=this.btnToggel)var o=0;this.btnToggel.on(e.Events.onTouchStartOrClick,function(){s?(o=e.Application.isRTL?180:0,a.btnToggel.animate({borderSpacing:o},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),s=!1,a.btnSpaceDiv.animate({width:u},"slow"),a.gridSelectDiv.animate({width:g},"slow"),a.div.css("display","block"),a.sideDiv.animate({width:u},"slow",null,function(){a.dGrid.resize()})):(o=e.Application.isRTL?0:180,a.btnToggel.animate({borderSpacing:o},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),s=!0,a.btnSpaceDiv.animate({width:d},"slow"),a.sideDiv.animate({width:d},"slow"),a.div.css("display","none"),a.gridSelectDiv.animate({width:p},"slow",null,function(){a.dGrid.resize()}))}),null!=this.spnGenerate&&this.spnGenerate.on(e.Events.onTouchStartOrClick,function(){a.btnRefresh.hide(),a.okBtn.hide(),s&&(a.btnToggel.animate({borderSpacing:0},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),s=!1,a.gridSelectDiv.animate({width:g},"fast"),a.sideDiv.animate({width:u},"fast"),a.btnSpaceDiv.animate({width:u},"fast")),a.gridSelectDiv.css("display","none"),a.sideDiv.css("display","none"),a.gridGenerateDiv.css("display","block"),a.btnToggel.hide(),lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary),1)"),lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")}),null!=this.spnSelect&&this.spnSelect.on(e.Events.onTouchStartOrClick,function(){s||(a.btnRefresh.show(),a.okBtn.show(),a.gridGenerateDiv.css("display","none"),a.gridSelectDiv.css("display","block"),a.sideDiv.css("display","block"),a.div.css("display","block"),a.gridSelectDiv.animate({width:g},"fast"),a.btnToggel.show(),lblSelect.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)"),lblGenrate.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary),1)"))}),null!=this.cmbOrg&&this.cmbOrg.getControl().change(function(){a.okBtn.removeAttr("disabled"),n=a.cmbOrg.getControl().find("option:selected").val(),_()}),null!=this.vSearchBPartner&&this.vSearchBPartner.addVetoableChangeListener(this),null!=this.vSearchOrderShipment&&this.vSearchOrderShipment.addVetoableChangeListener(this),null!=r&&r.on(e.Events.onTouchStartOrClick,function(){a.vSearchBPartner.isReadOnly||a.vSearchBPartner.setValue(null,!1,!0)}),null!=c&&c.on(e.Events.onTouchStartOrClick,function(){a.vSearchOrderShipment.isReadOnly||a.vSearchOrderShipment.setValue(null,!1,!0)})},this.display=function(){v(null)},this.getRoot=function(){return this.$root},this.refreshUI=function(){this.dGrid.resize()},this.disposeComponent=function(){this.okBtn&&this.okBtn.off(e.Events.onTouchStartOrClick),this.cancelBtn&&this.cancelBtn.off(e.Events.onTouchStartOrClick),r&&r.off(e.Events.onTouchStartOrClick),c&&c.off(e.Events.onTouchStartOrClick),a=null,this.frame=null,this.windowNo=null,this.arrListColumns=null,this.dGrid=null,i=null,n=null,l=null,s=null,this.lblOrg=null,this.lblBPartner=null,this.lblStatusInfo=null,this.tabSelect=null,this.tabGenrate=null,this.cmbOrg=null,this.vSearchBPartner=null,this.$root=null,this.$busyDiv=null,this.topDiv=null,this.sideDiv=null,this.gridSelectDiv=null,this.gridGenerateDiv=null,this.bottumDiv=null,this.okBtn=null,this.cancelBtn=null,this.btnRefresh=null,this.btnToggel=null,this.spnSelect=null,this.spnGenerate=null,u=null,g=null,p=null,this.getRoot=null,this.disposeComponent=null}}e.Apps.AForms=e.Apps.AForms||{},a.prototype.init=function(t,a){this.frame=a,this.windowNo=t,e.Env.getCtx().setContext(this.windowNo,"IsSOTrx","Y");try{this.Initialize()}catch(e){}this.frame.getContentGrid().append(this.getRoot()),this.display(),this.cmbOrg.getControl().focus()},a.prototype.refresh=function(){this.refreshUI()},a.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.VInvoiceGen=a}(VIS,jQuery)},3632:()=>{!function(e,t){function a(){this.frame,this.windowNo;var a=this;this.arrListColumns=[],this.dGrid=null;var i=null,n=null,l=null,s=!1,o=null;this.lblWarehouse=new e.Controls.VLabel,this.lblBPartner=new e.Controls.VLabel,this.lblStatusInfo=new e.Controls.VLabel,this.tabSelect=new e.Controls.VLabel,this.tabGenrate=new e.Controls.VLabel,this.cmbWarehouse=new e.Controls.VComboBox("",!1,!1,!0),this.vSearchBPartner=null,this.vSearchOrder=null,this.$root=t("<div style='width: 100%; height: 100%; background-color: white;'>"),this.$busyDiv=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),this.topDiv=null,this.sideDiv=null,this.gridSelectDiv=null,this.gridGenerateDiv=null,this.bottumDiv=null,this.div=null,this.okBtn=null,this.cancelBtn=null,this.btnRefresh=null,this.btnToggel=null,this.spnSelect=null,this.spnGenerate=null,this.btnSpaceDiv=null,this.lblGenrate=null,this.lblSelect=null;var r=null,c=null,u=260,d=50,g=t(window).width()-(u+20),p=t(window).width()-70;t(window).height();function v(i){null!=a.dGrid&&(a.dGrid.destroy(),a.dGrid=null),0==a.arrListColumns.length&&(a.arrListColumns.push({field:"AD_Org_ID",caption:e.Msg.translate(e.Env.getCtx(),"AD_Org_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),a.arrListColumns.push({field:"C_DocType_ID",caption:e.Msg.translate(e.Env.getCtx(),"C_DocType_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),a.arrListColumns.push({field:"DocumentNo",caption:e.Msg.getElement(e.Env.getCtx(),"DocumentNo"),sortable:!0,size:"16%",min:150,hidden:!1}),a.arrListColumns.push({field:"C_BPartner_ID",caption:e.Msg.getElement(e.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),a.arrListColumns.push({field:"DateOrdered",caption:e.Msg.getElement(e.Env.getCtx(),"DateOrdered"),sortable:!0,size:"16%",min:150,hidden:!1,render:function(e,t,a){var i;return i=null==e.changes||null==e.changes.DateOrdered?e.DateOrdered:e.changes.DateOrdered,new Date(i).toLocaleDateString()}}),a.arrListColumns.push({field:"C_Order_ID",caption:e.Msg.translate(e.Env.getCtx(),"C_UOM_ID"),sortable:!0,size:"150px",hidden:!0})),setTimeout(10),w2utils.encodeTags(i),a.dGrid=t(a.gridSelectDiv).w2grid({name:"gridGenShipForm"+a.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:a.arrListColumns,records:i})}function _(){var i=[],s=e.Env.getCtx().getAD_Client_ID(),r="",c="",u="";null!=n&&"-1"!=n.toString()&&(r=" AND ic.M_Warehouse_ID="+n),null!=l&&(c=" AND ic.C_BPartner_ID="+l),null!=o&&(u=" AND C_Order_ID="+o),t(a.$root[0]).addClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv"),a.$busyDiv[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"VCreateFrom/ExecuteQueryVinoutgen",type:"POST",data:{adClientID:s,mWarehouseIDs:r,cBPartnerIDs:c,cOrderIDSearchs:u},success:function(n){var l=JSON.parse(n);if(l&&l.length>0)try{for(var s=1,o=0;o<l.length;o++){var r={};r.C_Order_ID=l[o].c_order_id,r.AD_Org_ID=l[o].ord,r.C_DocType_ID=l[o].doctype,r.DocumentNo=e.Utility.encodeText(l[o].documentno),r.C_BPartner_ID=l[o].bpname,r.DateOrdered=l[o].dateordered,r.recid=s,s++,i.push(r)}}catch(e){}else e.ADialog.info("NoDataFound"),a.okBtn.attr("disabled","disabled");v(i),t(a.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv"),a.$busyDiv[0].style.visibility="hidden"},error:function(e){t(a.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv"),a.$busyDiv[0].style.visibility="hidden"}})}function V(i){var l=a;a.$busyDiv[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Common/GenerateShipments",dataType:"json",data:{whereClause:i,M_Warehouse_ID:n},success:function(i){null!=i.DocumentText&&(!function(e){e&&(a.btnRefresh.hide(),a.okBtn.hide(),a.btnToggel.animate({borderSpacing:0},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),e=!1,a.gridSelectDiv.animate({width:g},"fast"),a.sideDiv.animate({width:"toggle",height:"toggle"},"slow"));a.gridSelectDiv.css("display","none"),a.sideDiv.css("display","none"),a.gridGenerateDiv.css("display","block"),a.btnToggel.hide(),lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary), 1)"),lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")}(!0),l.gridGenerateDiv.html(i.DocumentText),l.lblStatusInfo.getControl().text(i.lblStatusInfo)),null!=i.ErrorMsg&&e.ADialog.info("",null,i.ErrorMsg,null),l.$busyDiv[0].style.visibility="hidden",t(a.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")},error:function(e){l.$busyDiv[0].style.visibility="hidden",t(a.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")}})}this.vetoablechange=function(e){l=a.vSearchBPartner.getValue(),o=a.vSearchOrder.getValue(),a.okBtn.removeAttr("disabled"),_()},this.sizeChanged=function(e,t){g=t-(u+20),p=t-70,1==s?(a.btnSpaceDiv.animate({width:d},"slow"),a.sideDiv.animate({width:d},"slow"),a.div.css("display","none"),a.gridSelectDiv.animate({width:p},"slow",null,function(){a.dGrid.resize()})):(a.btnSpaceDiv.animate({width:u},"slow"),a.gridSelectDiv.animate({width:g},"slow"),a.div.css("display","block"),a.sideDiv.animate({width:u},"slow",null,function(){a.dGrid.resize()}))},this.Initialize=function(){!function(){var t=e.MLookupFactory.get(e.Env.getCtx(),a.windowNo,2223,e.DisplayType.TableDir,"M_Warehouse_ID",0,!1,"M_Warehouse.IsActive='Y'");a.cmbWarehouse=new e.Controls.VComboBox("M_Warehouse_ID",!0,!1,!0,t,150,e.DisplayType.TableDir,0);var i=e.MLookupFactory.get(e.Env.getCtx(),a.windowNo,2762,e.DisplayType.Search,"C_BPartner_ID",0,!1,"C_BPartner.IsActive ='Y' And C_Bpartner.Issummary ='N'");a.vSearchBPartner=new e.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,e.DisplayType.Search,i);var n=e.MLookupFactory.get(e.Env.getCtx(),a.windowNo,2161,e.DisplayType.Search,"C_Order_ID",0,!1,"DocStatus='CO'");a.vSearchOrder=new e.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,e.DisplayType.Search,n)}(),a.lblWarehouse.getControl().text(e.Msg.translate(e.Env.getCtx(),"M_Warehouse_ID")),a.lblBPartner.getControl().text(e.Msg.translate(e.Env.getCtx(),"C_BPartner_ID")),a.tabSelect.getControl().text(e.Msg.getMsg("Select",!1,!1)),a.tabGenrate.getControl().text(e.Msg.getMsg("Generate",!1,!1)),a.lblStatusInfo.getControl().text(e.Msg.getMsg("VIS_OrderGenShip",!1,!1)),function(){var i="topDiv_"+a.windowNo,n="btnSpaceDiv_"+a.windowNo,l="btnSpace_"+a.windowNo,s="spnSelect_"+a.windowNo,o="spnGenerate_"+a.windowNo,d="lblGenerate_"+a.windowNo,g="lblSelect_"+a.windowNo;r=t('<div class="input-group-append"><button id = "btnClearBP_'+a.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" tabindex="-1" title="'+e.Msg.getMsg("Clear",!1,!1)+'"></i></button></div>'),c=t('<div class="input-group-append"><button id = "btnClearOrd_'+a.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" tabindex="-1" title="'+e.Msg.getMsg("Clear",!1,!1)+'"></i></button></div>'),a.topDiv=t("<div id='"+i+"' class='vis-archive-l-s-head vis-frm-ls-top' style='padding: 0;'><div id='"+n+"' class='vis-l-s-headwrp'><button id='"+l+"'  class='vis-archive-sb-t-button'><i class='vis vis-arrow-left'></i></button></div><div id='"+s+"'style='display: inline-block;  padding-left: 15px;margin-right: 15px;' ><label id='"+g+"' class='VIS_Pref_Label_Font' style='vertical-align: middle;font-size: 28px;color: rgba(var(--v-c-primary), 1);'>"+e.Msg.translate(e.Env.getCtx(),"Select")+"</label></div><div id='"+o+"' style='display: inline-block; width: 160px;'><label id='"+d+"' class='VIS_Pref_Label_Font' style='vertical-align: middle;font-size: 17px;'>"+e.Msg.translate(e.Env.getCtx(),"Generate")+"</label></div></div>");var p="sideDiv_"+a.windowNo,v="parameterDiv_"+a.windowNo;a.btnSpaceDiv=a.topDiv.find("#"+n),this.lblGenrate=a.topDiv.find("#"+d),this.lblSelect=a.topDiv.find("#"+g),a.sideDiv=t("<div id='"+p+"' class='vis-archive-l-s-content vis-leftsidebarouterwrap'>"),a.sideDiv.css("width",u),a.sideDiv.css("height","calc(100% - 103px)"),a.div=t("<div class='vis-archive-l-s-content-inner' id='"+v+"'>"),a.sideDiv.append(a.div);var _=t("<table style='width: 100%;'>"),V=t("<tr>"),A=t("<td style='padding: 10px 10px 0px;'>");a.div.append(_);var m=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">');_.append(V),V.append(A),A.append(m),m.append(f),f.append(a.cmbWarehouse.getControl()),f.append(a.lblWarehouse.getControl().addClass("VIS_Pref_Label_Font")),V=t("<tr>"),A=t("<td style='padding: 0px 10px 0px;'>"),m=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">');var D=t('<div class="input-group-append">');_.append(V),V.append(A),A.append(m),m.append(f),f.append(a.vSearchBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append(a.lblBPartner.getControl().addClass("VIS_Pref_Label_Font")),m.append(D),D.append(a.vSearchBPartner.getBtn(0)),m.append(r);var h=e.Msg.translate(e.Env.getCtx(),"SalesOrder_No");V=t("<tr>"),A=t("<td style='padding: 0px 10px 0px;'>"),m=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),D=t('<div class="input-group-append">'),_.append(V),V.append(A),A.append(m),m.append(f),f.append(a.vSearchOrder.getControl(0).attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append("<label>"+h+"</label>"),m.append(D),D.append(a.vSearchOrder.getBtn(0)),m.append(c);var C="gridSelectDiv_"+a.windowNo,S="gridGenerateDiv_"+a.windowNo;a.gridSelectDiv=t("<div id='"+C+"' class='vis-frm-grid-outerwrp'>"),a.gridGenerateDiv=t("<div id='"+S+"' style='height: 85%; float: right; display: none; background-color: rgba(var(--v-c-secondary), .8); margin-left: 15px;margin-right: 15px;'>"),a.gridGenerateDiv.css("width",t(window).width()-30);var I="btnOk_"+a.windowNo;a.okBtn=t("<input id='"+I+"' class='VIS_Pref_btn-2' style='margin-top: 0px;width: 70px;height: 38px;' type='button' value='Ok'>"),I="btnRefresh_"+a.windowNo,a.btnRefresh=t("<button id='"+I+"' style='margin-top: 0px;' class='VIS_Pref_btn-2'><i class='vis vis-refresh'></i></button>");var y="discriptionDiv_"+a.windowNo;a.bottumDiv=t("<div class='vis-info-btmcnt-wrap vis-p-t-10'>");var O=t("<div id='"+y+"' style='flex: 1;padding: 0 10px;'>");O.append(a.lblStatusInfo.getControl().addClass("VIS_Pref_Label_Font"));var T=t("<div>");T.append(a.okBtn),a.bottumDiv.append(a.btnRefresh).append(O).append(T),a.$root.append(a.$busyDiv),a.$busyDiv[0].style.visibility="hidden",a.$root.append(a.topDiv).append(a.sideDiv).append(a.gridSelectDiv).append(a.gridGenerateDiv).append(a.bottumDiv)}(),this.btnToggel=this.$root.find("#btnSpace_"+a.windowNo),this.spnSelect=this.$root.find("#spnSelect_"+a.windowNo),this.spnGenerate=this.$root.find("#spnGenerate_"+a.windowNo),null!=this.okBtn&&this.okBtn.on(e.Events.onTouchStartOrClick,function(){null!=a.cmbWarehouse.getControl().find("option:selected").val()?(a.$busyDiv[0].style.visibility="visible",t(a.$root[0]).addClass("vis-apanel-busyVInOutGenRoot"),t(a.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv"),a.okBtn.attr("disabled","disabled"),null!=(i=function(){if(null==a.dGrid)return!1;var e=[],t=a.dGrid.getSelection();if(null!=t&&!(t.length<=0)){for(var i=t.toString().split(","),n=0;n<i.length;n++)e[n]=a.dGrid.get(i[n]).C_Order_ID;if(0==e.length)return"";var l="C_Order_ID",s=l;for(s=e.length>1?s.concat(" IN ("):s.concat("="),n=0;n<e.length;n++)n>0&&(s=s.concat(",")),s=l.endsWith("_ID")?s.concat(e[n].toString()):s.concat("'").concat(e[n].toString());return e.length>1&&(s=s.concat(")")),s.toString()}}())&&i.length>0?V(i):(e.ADialog.error("PlzSelectatLeast1Inv"),a.$busyDiv[0].style.visibility="hidden"),a.okBtn.removeAttr("disabled")):e.ADialog.error("SelectWarehouseFirst")}),null!=this.cancelBtn&&this.cancelBtn.on(e.Events.onTouchStartOrClick,function(){a.$root.dialog("close")}),null!=this.btnRefresh&&this.btnRefresh.on(e.Events.onTouchStartOrClick,function(){a.okBtn.removeAttr("disabled"),n=a.cmbWarehouse.getControl().find("option:selected").val(),l=a.vSearchBPartner.getValue(),_()}),null!=this.btnToggel&&this.btnToggel.on(e.Events.onTouchStartOrClick,function(){var i=0;s?(i=e.Application.isRTL?180:0,a.btnToggel.animate({borderSpacing:i},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),s=!1,a.btnSpaceDiv.animate({width:u},"slow"),a.gridSelectDiv.animate({width:g},"slow"),a.div.css("display","block"),a.sideDiv.animate({width:u},"slow",null,function(){a.dGrid.resize()})):(i=e.Application.isRTL?0:180,a.btnToggel.animate({borderSpacing:i},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),s=!0,a.btnSpaceDiv.animate({width:d},"slow"),a.sideDiv.animate({width:d},"slow"),a.div.css("display","none"),a.gridSelectDiv.animate({width:p},"slow",null,function(){a.dGrid.resize()}))}),null!=this.spnGenerate&&this.spnGenerate.on(e.Events.onTouchStartOrClick,function(){a.btnRefresh.hide(),a.okBtn.hide(),s&&(a.btnToggel.animate({borderSpacing:0},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),s=!1,a.gridSelectDiv.animate({width:g},"fast"),a.sideDiv.animate({width:u},"fast"),a.btnSpaceDiv.animate({width:u},"fast")),a.gridSelectDiv.css("display","none"),a.sideDiv.css("display","none"),a.gridGenerateDiv.css("display","block"),a.btnToggel.hide(),lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary), 1)"),lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")}),null!=this.spnSelect&&this.spnSelect.on(e.Events.onTouchStartOrClick,function(){s||(a.btnRefresh.show(),a.okBtn.show(),a.gridGenerateDiv.css("display","none"),a.gridSelectDiv.css("display","block"),a.sideDiv.css("display","block"),a.div.css("display","block"),a.gridSelectDiv.animate({width:g},"fast"),a.btnToggel.show(),lblSelect.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)"),lblGenrate.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary), 1)"))}),null!=this.cmbWarehouse&&this.cmbWarehouse.getControl().change(function(){a.okBtn.removeAttr("disabled"),n=a.cmbWarehouse.getControl().find("option:selected").val(),_()}),null!=this.vSearchBPartner&&this.vSearchBPartner.addVetoableChangeListener(this),null!=this.vSearchOrder&&this.vSearchOrder.addVetoableChangeListener(this),null!=r&&r.on(e.Events.onTouchStartOrClick,function(){a.vSearchBPartner.isReadOnly||a.vSearchBPartner.setValue(null,!1,!0)}),null!=c&&c.on(e.Events.onTouchStartOrClick,function(){a.vSearchOrder.isReadOnly||a.vSearchOrder.setValue(null,!1,!0)})},this.display=function(){v(null)},this.getRoot=function(){return this.$root},this.refreshUI=function(){this.dGrid.resize()},this.disposeComponent=function(){this.okBtn&&this.okBtn.off(e.Events.onTouchStartOrClick),this.cancelBtn&&this.cancelBtn.off(e.Events.onTouchStartOrClick),r&&r.off(e.Events.onTouchStartOrClick),c&&c.off(e.Events.onTouchStartOrClick),a=null,this.frame=null,this.windowNo=null,this.arrListColumns=null,this.dGrid=null,i=null,n=null,l=null,s=null,this.lblWarehouse=null,this.lblBPartner=null,this.lblStatusInfo=null,this.tabSelect=null,this.tabGenrate=null,this.cmbWarehouse=null,this.vSearchBPartner=null,this.$root=null,this.$busyDiv=null,this.topDiv=null,this.sideDiv=null,this.gridSelectDiv=null,this.gridGenerateDiv=null,this.bottumDiv=null,this.okBtn=null,this.cancelBtn=null,this.btnRefresh=null,this.btnToggel=null,this.spnSelect=null,this.spnGenerate=null,u=null,g=null,p=null,this.getRoot=null,this.disposeComponent=null}}e.Apps.AForms=e.Apps.AForms||{},a.prototype.init=function(t,a){this.frame=a,this.windowNo=t,e.Env.getCtx().setContext(this.windowNo,"IsSOTrx","Y");try{this.Initialize()}catch(e){}this.frame.getContentGrid().append(this.getRoot()),this.display(),this.cmbWarehouse.getControl().focus()},a.prototype.refresh=function(){this.refreshUI()},a.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.VInOutGen=a}(VIS,jQuery)},3650:()=>{!function(e,t){function a(t){var a=this.$super;a.constructor(t);var i=this;!function(){a.title=e.Msg.getMsg("ProvisionalInvoice")+" .. "+e.Msg.getMsg("CreateFrom"),a.relatedToOrg=null,a.fromInvoice=!1,a.ProvisionalInvoice=!0,null!=a.lblInvoice&&a.lblInvoice.getControl().css("display","none");null!=a.cmbInvoice&&a.cmbInvoice.getControl().css("display","none");null!=a.lblLocator&&a.lblLocator.getControl().css("display","none");null!=a.locatorField&&a.locatorField.getControl().css("display","none");a.deliveryDate=new e.Controls.VDate("DeliveryDate",!1,!1,!0,e.DisplayType.Date,"DeliveryDate");var t=e.MLookupFactory.getMLookUp(e.Env.getCtx(),a.windowNo,2221,e.DisplayType.Search);a.vProduct=new e.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,e.DisplayType.Search,t);var n=a.initBPartnerForProvisional();a.vBPartner.setReadOnly(!0),function(t){!function(t,n){var l="Y".equals(e.Env.getCtx().getWindowContext(i.windowNo,"IsDropShip")),s="Y".equals(e.Env.getCtx().getWindowContext(i.windowNo,"IsSOTrx")),o=e.dataContext.getJSONRecord("MDocType/GetDocType",e.Env.getCtx().getContextAsInt(i.windowNo,"C_DocType_ID").toString()),r=e.Utility.Util.getValueOfBoolean(o.IsReturnTrx),c=" M_InOut_ID IN (SELECT s.M_InOut_ID FROM M_InOut s WHERE s.C_BPartner_ID = "+n+" AND s.IsSOTrx = '"+(s?"Y":"N")+"' AND s.DocStatus IN('CL', 'CO') AND s.IsDropShip='"+(l?"Y":"N")+"'";null!=r&&(c+=" AND S.IsReturnTrx='"+(1==r?"Y":"N")+"'");c+=" AND s.M_InOut_ID IN (SELECT t.M_InOut_ID FROM (SELECT sl.M_InOut_ID, sl.M_InOutLine_ID, sl.MovementQty,  (SELECT SUM(NVL(il.QtyInvoiced, 0)) FROM C_InvoiceLine il INNER JOIN C_Invoice I ON I.C_INVOICE_ID = il.C_INVOICE_ID WHERE i.DocStatus NOT IN ('VO', 'RE') AND sl.M_InOutLine_ID = il.M_InOutLine_ID) AS QtyInvoiced FROM M_InOutLine sl) t GROUP BY t.M_InOut_ID, t.M_InOutLine_ID, t.MovementQty HAVING t.MovementQty > SUM(NVL(t.QtyInvoiced, 0))))";var u=e.MLookupFactory.get(e.Env.getCtx(),a.windowNo,0,e.DisplayType.Search,"M_InOut_ID",0,!1,c);a.cmbShipment=new e.Controls.VTextBoxButton("M_InOut_ID",!0,!1,!0,e.DisplayType.Search,u)}(e.Env.getCtx(),t)}(n),i.getTableFieldVOs()}(),a.jbInit(),a.initOK=!0;t.getWindowNo();this.log=e.Logging.VLogger.getVLogger("VCreateFormProvisionalInvoice"),this.disposeComponent=function(){a=null,i=null,this.disposeComponent=null}}e.Utility.inheritPrototype(a,e.VCreateFrom),a.prototype.getTableFieldVOs=function(){var t=this.$super,a=this;t.arrListColumns=[],t.arrListColumns.push({field:"Quantity",caption:e.Msg.getMsg("QtyPending"),sortable:!1,size:"150px",hidden:!1,render:function(e,t,a){var i=e.Quantity;return parseFloat(i).toLocaleString(void 0,{minimumFractionDigits:4})}}),t.arrListColumns.push({field:"QuantityPending",caption:e.Msg.getMsg("Quantity"),sortable:!1,size:"150px",render:"number:4",hidden:!0}),t.arrListColumns.push({field:"QuantityEntered",caption:e.Msg.getMsg("QtyEntered"),sortable:!1,size:"150px",hidden:!1,render:function(e,a,i){var n=e.QuantityEntered;return n=t.checkcommaordot(event,n),parseFloat(n).toLocaleString(void 0,{minimumFractionDigits:4})}}),t.arrListColumns.push({field:"POPrice",caption:e.Msg.getMsg("POPrice"),sortable:!1,size:"150px",hidden:!1,render:function(e,t,a){var i=e.POPrice;return parseFloat(i).toLocaleString(void 0,{minimumFractionDigits:4})}}),t.arrListColumns.push({field:"ProvisionalPrice",caption:e.Msg.getMsg("ProvisionalPrice"),sortable:!1,size:"150px",hidden:!1,render:function(e,t,a){var i=e.ProvisionalPrice;return parseFloat(i).toLocaleString(void 0,{minimumFractionDigits:4})}}),t.arrListColumns.push({field:"C_UOM_ID",caption:e.Msg.getMsg("UomName"),sortable:!1,size:"150px",hidden:!1}),t.arrListColumns.push({field:"M_Product_SearchKey",caption:e.Msg.getMsg("ProductSearchKey"),sortable:!1,size:"150px",hidden:!1}),t.arrListColumns.push({field:"M_Product_ID",caption:e.Msg.getMsg("ProductName"),sortable:!0,size:"150px",hidden:!1}),t.arrListColumns.push({field:"M_AttributeSetInstance_ID",caption:e.Msg.getMsg("ASI"),sortable:!1,size:"150px",editable:{type:"custom",ctrl:a.$productAttribute,showAll:!0,style:"background-color: #f8f8f8;"},render:function(e,t,i){var n,l=a.pattrLookup,s=e.M_AttributeSetInstance_ID;return e.changes&&void 0!==e.changes.M_AttributeSetInstance_ID&&(s=e.changes.M_AttributeSetInstance_ID),l&&(n=l.getDisplay(s,!0)),n},style:"background-color: #d1d1d14a"}),t.arrListColumns.push({field:"C_PaymentTerm_ID",caption:e.Msg.getMsg("C_PaymentTerm_ID"),sortable:!1,size:"150px",hidden:!0}),t.arrListColumns.push({field:"PaymentTermName",caption:e.Msg.getMsg("PaymentTermName"),sortable:!1,size:"150px",hidden:!1}),t.arrListColumns.push({field:"IsAdvance",caption:e.Msg.getMsg("IsAdvance"),sortable:!1,size:"150px",hidden:!0}),t.arrListColumns.push({field:"C_InvoicePaymentTerm_ID",caption:e.Msg.getMsg("C_InvoicePaymentTerm_ID"),sortable:!1,size:"150px",hidden:!0}),t.arrListColumns.push({field:"IsInvoicePTAdvance",caption:e.Msg.getMsg("IsInvoicePTAdvance"),sortable:!1,size:"150px",hidden:!0}),t.arrListColumns.push({field:"C_Order_ID",caption:e.Msg.getMsg("OrderLine"),sortable:!1,size:"150px",hidden:!1}),t.arrListColumns.push({field:"M_InOut_ID",caption:e.Msg.getMsg("Shipment/Receipt"),sortable:!1,size:"150px",hidden:!1}),t.arrListColumns.push({field:"C_Invoice_ID",caption:e.Msg.getMsg("Invoice"),sortable:!1,size:"150px",hidden:!1}),t.arrListColumns.push({field:"C_UOM_ID_K",caption:e.Msg.getMsg("UomName"),sortable:!1,size:"150px",hidden:!0}),t.arrListColumns.push({field:"M_Product_ID_K",caption:e.Msg.getMsg("ProductName"),sortable:!1,size:"150px",hidden:!0}),t.arrListColumns.push({field:"C_Order_ID_K",caption:e.Msg.getMsg("Order"),sortable:!1,size:"150px",hidden:!0}),t.arrListColumns.push({field:"M_InOut_ID_K",caption:e.Msg.getMsg("Shipment/Receipt"),sortable:!1,size:"150px",hidden:!0}),t.arrListColumns.push({field:"C_Invoice_ID_K",caption:e.Msg.getMsg("Invoice"),sortable:!1,size:"150px",hidden:!0}),t.arrListColumns.push({field:"Select",caption:e.Msg.getMsg("Select"),sortable:!1,size:"50px",hidden:!0,render:function(){return'<div><input type=checkbox disabled="true"></div>'}})},a.prototype.saveProvisionalInvoice=function(){if(null==this.$super.dGrid)return!1;var t={},a=this.$super.multiValues;if(null==a)return!1;if(a.length<=0)return!1;for(var i=0;i<a.length;i++)t[i]=a[i];var n=this.$super.mTab.getValue("C_ProvisionalInvoice_ID"),l=e.Utility.Util.getValueOfInt(this.$super.cmbOrder.getValue()),s=e.Utility.Util.getValueOfInt(this.$super.cmbShipment.getValue());return this.saveData(t,"",l,s,n)},a.prototype.saveData=function(a,i,n,l,s){var o=this;t.ajax({type:"POST",url:e.Application.contextUrl+"Common/SaveProvisionalInvoice",dataType:"json",data:{model:a,selectedItems:i,C_Order_ID:n,C_ProvisionalInvoice_ID:s,M_inout_id:l},success:function(e){if(returnValue=e.result,returnValue)return o.dispose(),o.$super.$root.dialog("close"),void o.$super.setBusy(!1);o.$super.setBusy(!1),alert(returnValue)},error:function(e,t,a){console.log(t),o.$super.setBusy(!1),alert(a)}})},a.prototype.loadShipments=function(t,a,i){this.getShipmentsData(e.Env.getCtx(),t,a,i)},a.prototype.getShipmentsData=function(a,i,n,l){var s=this;if(this.$super.record_ID=$self.mTab.getValue("C_ProvisionalInvoice_ID"),null!=s.$super.dGrid){var o=s.$super.dGrid.getSelection();for(item in o){t.grep(s.$super.multiValues,function(e,t){return e.M_Product_ID_K==s.$super.dGrid.get(o[item]).M_Product_ID_K&&e.M_InOut_ID_K==s.$super.dGrid.get(o[item]).M_InOut_ID_K}).length>0||s.$super.multiValues.push(s.$super.dGrid.get(o[item]))}}var r="",c="";return r=e.Env.isBaseLanguage(a,"C_UOM")?"FROM C_UOM uom INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom Left join C_UOM uom1 on (uom1.C_UOM_ID=uom.C_UOM_ID)  INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+e.Env.getAD_Language(a)+"') ",null!=n&&(c=" AND l.M_Product_ID="+n),l||(l=1),t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetDataVCreateFrom",dataType:"json",type:"POST",data:{keyColumnName:s.$super.mTab.keyColumnName,tableName:"M_InOutLine",recordID:s.$super.record_ID,pageNo:l,mInOutId:i,isBaseLanguages:r,mProductIDD:c},error:function(t){alert(e.Msg.getMsg("ErrorWhileGettingData")),s.$super.setBusy(!1),selfChild.log.info(t)},success:function(t){var a=JSON.parse(t);if(a.Error)return e.ADialog.error(a.Error),void s.$super.setBusy(!1);s.$super.resetPageCtrls(a.pSetting),s.$super.loadGrid(a.data),s.$super.setBusy(!1)}}),[]},a.prototype.dispose=function(){null!=this.disposeComponent&&this.disposeComponent()},e.VCreateFormProvisionalInvoice=a}(VIS,jQuery)},3835:()=>{VIS=window.VIS||{},function(e,t){function a(){this.windowNo;var a=t("<div style='width: 100%; height: 100%; background-color: white;'>"),n=this,l=null,s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=[],_=null,V=null,A=null,m=null,f=[],D=null,h=null,C=0,S=null;function I(e){S[0].style.visibility=e?"visible":"hidden"}function y(){try{null!=_&&(_.destroy(),_=null)}catch(e){}0==v.length&&(v.push({field:"SELECT",caption:e.Msg.getMsg("SELECT"),sortable:!0,size:"100px",hidden:!0}),v.push({field:"C_INVOICE_ID",caption:e.Msg.getMsg("Invoice"),sortable:!0,size:"100px"}),v.push({field:"DUEDATE",caption:e.Msg.getMsg("DueDate"),sortable:!0,size:"100px",render:function(e,t,a){var i;return i=null==e.changes||null==e.changes.DUEDATE?e.DUEDATE:e.changes.DUEDATE,new Date(i).toLocaleDateString()}}),v.push({field:"BUSINESSPARTNER",caption:e.Msg.getMsg("BusinessPartner"),sortable:!0,size:"100px"}),v.push({field:"DOCUMENTNO",caption:e.Msg.getMsg("Document_No"),sortable:!0,size:"100px"}),v.push({field:"CURRENCY",caption:e.Msg.getMsg("Currency"),sortable:!0,size:"100px"}),v.push({field:"GRANDTOTAL",caption:e.Msg.getMsg("GrandTotal"),sortable:!0,size:"100px",render:function(e,t,a){var i=e.GRANDTOTAL;return parseFloat(i).toLocaleString()}}),v.push({field:"DISCOUNTAMOUNT",caption:e.Msg.getMsg("DiscountAmt"),sortable:!0,size:"100px",render:function(e,t,a){var i=e.DISCOUNTAMOUNT;return parseFloat(i).toLocaleString()}}),v.push({field:"DISCOUNTDATE",caption:e.Msg.getMsg("DiscountDate"),sortable:!0,size:"100px",render:function(e,t,a){var i;return i=null==e.changes||null==e.changes.DISCOUNTDATE?e.DISCOUNTDATE:e.changes.DISCOUNTDATE,new Date(i).toLocaleDateString()}}),v.push({field:"AMOUNTDUE",caption:e.Msg.getMsg("AmountDue"),sortable:!0,size:"100px",render:function(e,t,a){var i=e.AMOUNTDUE;return parseFloat(i).toLocaleString()}}),v.push({field:"PAYMENTAMOUNT",caption:e.Msg.getMsg("PaymentAmount"),sortable:!0,size:"100px",render:function(e,t,a){var i=e.PAYMENTAMOUNT;return parseFloat(i).toLocaleString()}})),(_=s.w2grid({name:"gridPaymentSelection_"+n.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:v,records:f})).on("select",function(t){C+=e.Utility.Util.getValueOfDecimal(f[t.index].PAYMENTAMOUNT),p.val(C);_.getSelection();A.removeAttr("disabled")}),_.on("unselect",function(t){C-=e.Utility.Util.getValueOfDecimal(f[t.index].PAYMENTAMOUNT),p.val(C);_.getSelection()})}function O(){var t=jQuery.grep(h.BankAccount,function(t){return t.ID==e.Utility.Util.getValueOfInt(o.val())});t.length>0&&g.val(t[0].CurrentBalance+" "+t[0].ISOCode)}this.initialize=function(){(S=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="hidden",a.append(S),I(!0),window.setTimeout(function(){!function(){t(window).height();l=t("<div class='vis-mainContainer'>");var v=" <div class='vis-pSelectInfo vis-leftsidebarouterwrap'><div class='vis-pSelectInner'> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <select id='VIS_cmbBankAccount_"+n.windowNo+"'></select> <label>"+e.Msg.translate(e.Env.getCtx(),"C_BankAccount_ID")+" </label></div></div> </div> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtCurrentBal_"+n.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+e.Msg.getMsg("CurrentBalance")+' </label></div></div>  </div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbbusinessPartner_'+n.windowNo+"'></select> <label>"+e.Msg.translate(e.Env.getCtx(),"C_BPartner_ID")+' </label></div></div>  </div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <input  id=\'VIS_cmbPayDate_'+n.windowNo+"'type='date' data-placeholder='' placeholder=' '> <label>"+e.Msg.translate(e.Env.getCtx(),"PayDate")+' </label></div></div>  </div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbPaymentMethod_'+n.windowNo+"'></select> <label>"+e.Msg.translate(e.Env.getCtx(),"PaymentRule")+" </label></div></div>  </div> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='number' id='VIS_txtPaymentAmount_"+n.windowNo+"' disabled MaxLength='50' data-placeholder='' placeholder=' '> <label>"+e.Msg.getMsg("PaymentAmount")+" </label></div></div>  </div> <div class='vis-paymentselect-field'> <input type='checkbox' id='VIS_chkOnlyDue_"+n.windowNo+"' data-placeholder='' placeholder=' '> <label for='VIS_chkOnlyDue_"+n.windowNo+"'>"+e.Msg.getMsg("OnlyDue")+" </label>  </div> <div class='vis-paymentselect-field'> <label for='VIS_lblShowDetail_"+n.windowNo+"'></label> </div> </div> <div class='vis-paymentselect-field'> <button class='VIS_Pref_btn-2' disabled id='VIS_btnRefresh_"+n.windowNo+"' style='margin-top: 0px;'><i class='vis vis-refresh'></i></button> </div> </div>";s=t("<div class='vis-pSelectIionGrid'>");var C=" <div class='vis-pSelectProcess'> <div class='vis-paymentselect-field'> <input id='VIS_btnCancel_"+n.windowNo+"' class='vis-frm-btn' type='submit' value='"+e.Msg.getMsg("Cancel")+"' ></input> <input id='VIS_btnOK_"+n.windowNo+"' disabled class='vis-frm-btn' type='submit' value='"+e.Msg.getMsg("OK")+"' ></input> </div> </div>";l.append(t(v)).append(s).append(t(C)),a.append(l),function(){o=t("#VIS_cmbBankAccount_"+n.windowNo),r=t("#VIS_cmbbusinessPartner_"+n.windowNo),c=t("#VIS_cmbPaymentMethod_"+n.windowNo),g=t("#VIS_txtCurrentBal_"+n.windowNo),d=t("#VIS_chkOnlyDue_"+n.windowNo),p=t("#VIS_txtPaymentAmount_"+n.windowNo),t("#VIS_lblShowDetail_"+n.windowNo),V=t("#VIS_btnRefresh_"+n.windowNo),u=t("#VIS_cmbPayDate_"+n.windowNo),A=t("#VIS_btnOK_"+n.windowNo),m=t("#VIS_btnCancel_"+n.windowNo);var a=new Date,l=("0"+a.getDate()).slice(-2),s=("0"+(a.getMonth()+1)).slice(-2),v=a.getFullYear()+"-"+s+"-"+l;u.val(v),y(),V.on("click",function(){I(!0),(!(null!=r&&r.val()<=0)||(e.ADialog.info("SelectBusinessPartnerFirst"),I(!1),0))&&window.setTimeout(function(){!function(){f=[];var a=0,n=[];if(n.push(o.val()),null!=h){var l=jQuery.grep(h.BankAccount,function(t){return t.ID==e.Utility.Util.getValueOfInt(o.val())});l.length>0?n.push(l[0].Currency_ID):n.push(0)}else n.push(0);n.push(r.val()),n.push(u.val()),n.push(c.val()),n.push(p.val()),n.push(d.prop("checked")),t.ajax({url:e.Application.contextUrl+"VPaySelect/GetGridRecords",async:!1,datatype:"Json",type:"POST",cache:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify(n),success:function(e){var t=JSON.parse(e);if(f=[],null!=t||null!=t)for(D=t,i=0;i<t.length;i++){var n={};n.SELECT=t[i].SELECT,n.C_INVOICE_ID=t[i].C_INVOICE_ID,n.DUEDATE=t[i].DUEDATE,n.BUSINESSPARTNER=t[i].BUSINESSPARTNER,n.DOCUMENTNO=t[i].DOCUMENTNO,n.CURRENCY=t[i].CURRENCY,n.GRANDTOTAL=t[i].GRANDTOTAL,n.DISCOUNTAMOUNT=t[i].DISCOUNTAMOUNT,n.DISCOUNTDATE=t[i].DISCOUNTDATE,n.AMOUNTDUE=t[i].AMOUNTDUE,n.PAYMENTAMOUNT=t[i].PAYMENTAMOUNT,n.recid=a,a++,f.push(n)}},error:function(e){console.log(e)}}),y()}(),I(!1)},20)}),A.on("click",function(){if(_.getSelection().length<=0)return e.ADialog.info("PleaseSelectRecord"),!1;var a=_.getSelection();if(a.length>0){for(var i=0;i<a.length;i++)D[a[i]].SELECT=!0;I(!0),window.setTimeout(function(){!function(){var a=[];if(a.push(o.val()),null!=h){var i=jQuery.grep(h.BankAccount,function(t){return t.ID==e.Utility.Util.getValueOfInt(o.val())});a.push(i[0].Currency_ID)}else a.push(0);a.push(r.val()),a.push(u.val()),a.push(c.val()),a.push(p.val()),a.push(d.prop("checked")),a.push(JSON.stringify(D)),t.ajax({url:e.Application.contextUrl+"VPaySelect/GeneratePaymentSelection",async:!1,datatype:"Json",type:"POST",cache:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify(a),success:function(t){var a=JSON.parse(t);if(null!=a||null!=a){n.dispose();var i=new e.CFrame,l=new e.Apps.AForms.VPayPrint;i.setName(e.Msg.getMsg("Payment Print/Export")),i.setTitle(e.Msg.getMsg("Payment Print/Export")),i.hideHeader(!1),i.setContent(l),i.show(),l.initialize()}},error:function(e){console.log(e)}})}()},20)}}),m.on("click",function(){n.dispose()}),o.on("change",function(){I(!0),window.setTimeout(function(){t.ajax({url:e.Application.contextUrl+"VPaySelect/GetPaymentMethod",async:!1,datatype:"Json",type:"GET",cache:!1,data:{C_BankAccount_ID:parseInt(o.val())},success:function(e){var a=JSON.parse(e);if((null!=a||null!=a)&&(null!=a||a.length>0))for(var i in c.empty(),a)c.append(t('<Option value="'+a[i].ID+'">'+a[i].Value+"</option>"))},error:function(e){console.log(e)}}),O(),I(!1)},20)}),void d.on("click",function(){V.trigger("click")}),void t.ajax({url:e.Application.contextUrl+"VPaySelect/GetDetail",async:!1,datatype:"Json",type:"GET",cache:!1,success:function(e){var a=JSON.parse(e);h=a,null==a&&null==a||a.BankAccount.length>0&&(V.removeAttr("disabled"),function(e){if(null!=e.BankAccount||e.BankAccount.length>0)for(var a in o.empty(),e.BankAccount)o.append(t('<Option value="'+e.BankAccount[a].ID+'">'+e.BankAccount[a].Value+"</option>"));if(null!=e.BusinessPartner||e.BusinessPartner.length>0)for(var a in r.empty(),r.append(t('<Option value="-1"></option>')),e.BusinessPartner)r.append(t('<Option value="'+e.BusinessPartner[a].ID+'">'+e.BusinessPartner[a].Value+"</option>"));if(null!=e.PaymentMethod||e.PaymentMethod.length>0)for(var a in c.empty(),e.PaymentMethod)c.append(t('<Option value="'+e.PaymentMethod[a].ID+'">'+e.PaymentMethod[a].Value+"</option>"));I(!1)}(a)),I(!1)},error:function(e){console.log(e),I(!1)}}),h.BankAccount.length>0&&O()}()}()},20)},this.getRoot=function(){return a},this.disposeComponent=function(){windowNo=null,a=null,n=this,l=null,s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=null,_=null,V=null,A=null,m=null,f=null}}e.Apps.AForms=e.Apps.AForms||{},a.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.frame.getContentGrid().append(this.getRoot()),this.initialize()},a.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.VPaySelect=a}(VIS,jQuery)},3970:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.CalloutBankStatement")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.BankAccount=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";try{var r,c=s.toString();r=e.dataContext.getJSONRecord("MBankStatement/GetCurrentBalance",c),n.setValue("BeginningBalance",r)}catch(e){this.setCalloutActive(!1),this.log.log(t.SEVERE,"",e)}return n=s=null,""},i.prototype.Amount=function(e,t,a,i,n,l){if(null==n||""==n.toString())return"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);var s=a.getValue("StmtAmt");null==s&&(s=0);var o=a.getValue("TrxAmt");null==o&&(o=0),null==(c=a.getValue("ChargeAmt"))&&(c=0);var r=s-o;if("ChargeAmt"==i.getColumnName()){var c;null==(c=n)&&(c=0),r-=c,a.setValue("InterestAmt",r)}else{var u=a.getValue("InterestAmt");null==u&&(u=0),r-=u,a.setValue("ChargeAmt",r)}return this.setCalloutActive(!1),a=i=n=null,""},i.prototype.Payment=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return n.setValue("StmtAmt",0),n.setValue("TrxAmt",0),n.setValue("ChargeAmt",0),n.setValue("C_BPartner_ID",0),n.setValue("C_Invoice_ID",0),n.findColumn("C_ConversionType_ID")>=0&&n.setValue("C_ConversionType_ID",0),this.setCalloutActive(!1),"";this.setCalloutActive(!0);var r=n.getValue("C_Payment_ID");if(null==r||0==r)return n.setValue("StmtAmt",0),n.setValue("TrxAmt",0),n.setValue("ChargeAmt",0),n.setValue("C_BPartner_ID",0),n.setValue("C_Invoice_ID",0),n.findColumn("C_ConversionType_ID")>=0&&n.setValue("C_ConversionType_ID",0),this.setCalloutActive(!1),"";var c=n.getValue("StmtAmt");null==c&&(c=0);var u=n.getValue("C_Currency_ID"),d=n.getValue("DateAcct"),g=n.getValue("AD_Org_ID");if(null==d)return n.setValue("C_Payment_ID",0),this.setCalloutActive(!1),"PlzSelectStmtDate";try{var p=r.toString()+","+u.toString()+","+d+","+g.toString(),v=e.dataContext.getJSONRecord("MBankStatement/GetPayment",p);if(null!=v&&v.length>0){if(""!=v[0].ConvertedAmt)return n.setValue("C_Payment_ID",0),this.setCalloutActive(!1),v[0].ConvertedAmt;n.setValue("TrxAmt",v[0].payAmt),n.setValue("StmtAmt",v[0].payAmt),n.findColumn("C_ConversionType_ID")>=0&&n.setValue("C_ConversionType_ID",v[0].C_ConversionType_ID),n.findColumn("VA009_PaymentMethod_ID")>=0&&n.getValue("VA009_PaymentMethod_ID")>0?n.setValue("VA009_PaymentMethod_ID",v[0].VA009_PaymentMethod_ID):n.findColumn("VA009_PaymentMethod_ID")>=0&&n.setValue("VA009_PaymentMethod_ID",null),null==n.getValue("EFTCheckNo")&&null!=v[0].EFTCheckNo&&n.setValue("EFTCheckNo",v[0].EFTCheckNo),null!=v[0].EFTValutaDate&&n.setValue("EFTValutaDate",v[0].EFTValutaDate),n.findColumn("TenderType")>=0&&null!=v[0].TenderType&&n.setValue("TenderType",v[0].TenderType)}}catch(e){return this.setCalloutActive(!1),this.log.log(t.SEVERE,"BankStmt_Payment",e),e.toString()}return this.setCalloutActive(!1),this.Amount(a,i,n,l,s),a=i=n=l=s=null,""},i.prototype.SetConvertedAmt=function(i,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString())return"";var c=a.getValueOfInt(l.getValue("C_Payment_ID"));if(0==c)return"";var u=l.getValue("C_Currency_ID"),d=l.getValue("DateAcct");if(null==d)return"PlzSelectStmtDate";try{var g=c.toString()+","+u.toString()+","+d.toString(),p=e.dataContext.getJSONRecord("MBankStatement/GetConvertedAmt",g);l.setValue("StmtAmt",p),l.setValue("TrxAmt",p)}catch(e){return this.setCalloutActive(!1),this.log.log(t.SEVERE,"BankStmt_DateAcct",e),e.toString()}return this.Amount(i,n,l,s,o),i=n=l=s=o=null,""},e.Model.CalloutBankStatement=i}(VIS,jQuery)},3983:()=>{VAS=window.VAS||{},function(e,t){e.VAS_HighestSellProduct=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,i=t('<div class="h-100 w-100">'),n="",l="",s="",o=[],r=(new VIS.CultureSeparator,null),c=null,u=null,d=null,g=0,p=0;function v(){n.append('<div class="VAS-orgName-col"><h1>#'+(p+1)+'</h1><div class="VAS-org-name"><span>'+o[p].Name+'</span></div></div><img src="'+(""!=o[p].ImageUrl?VIS.Application.contextUrl+o[p].ImageUrl:VIS.Application.contextUrl+"Areas/VAS/Content/Images/cube-icon.png")+'" alt="">'),s.append('<h1><span style="margin-right:0.2em;">'+o[p].Symbol+"</span>"+_(o[p].PreviousTotal,o[p].StdPrecision)+(null!=r?"<span>"+r+"</span>":"")+'<span class="VAS-sale-Qty">('+o[p].PreviousQty+" "+o[p].UOM+")</span></h1><span>"+VIS.Msg.getMsg("VAS_LastYear")+"</span>"),l.append('<h1><span style="margin-right:0.2em;">'+o[p].Symbol+"</span>"+_(o[p].CurrentTotal,o[p].StdPrecision)+(null!=r?"<span>"+r+"</span>":"")+'<span class="VAS-sale-Qty"">('+o[p].CurrentQty+" "+o[p].UOM+")</span></h1><span>"+VIS.Msg.getMsg("VAS_CurrentYear")+"</span>"),p>0?u.css("opacity","1"):u.css("opacity","0.6"),o.length-1>p?d.css("opacity","1"):d.css("opacity","0.6"),c.text(p+1+VIS.Msg.getMsg("VAS_Of")+o.length),e[0].style.visibility="hidden"}function _(e,t){return e>=1e12?(r=VIS.Msg.getMsg("VAS_Trillion"),(e/1e12).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e9?(r=VIS.Msg.getMsg("VAS_Billion"),(e/1e9).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e6?(r=VIS.Msg.getMsg("VAS_Million"),(e/1e6).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e3?(r=VIS.Msg.getMsg("VAS_Thousand"),(e/1e3).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):(r=null,e.toLocaleString(window.navigator.language,{minimumFractionDigits:t,maximumFractionDigits:t}))}this.initalize=function(){(e=t("<div class='vis-apanel-busy'>")).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),e[0].style.visibility="visible",i.append(e),g=this.widgetInfo.AD_UserHomeWidgetID,i.append('<div class="VAS-selling-container VAS-highest-selling-prod"><div class="VAS-container-heading">'+VIS.Msg.getMsg("VAS_HighestSellProduct")+'</div><div class="VAS-org-col" id="VAS_divProduct_'+g+'"></div><div class="VAS-yearly-revenue"><div class="VAS-lastRevenue" id="VAS_divLastYear_'+g+'"></div><div class="VAS-currentRevenue" id="VAS_divCurrentYear_'+g+'"></div><div class="VAS-pagination-sell"><div class= "VAS-arrow-col"><a href="javascript:void(0);"><span class="fa fa-arrow-left" id="VAS_Prev_'+g+'"></span></a><a href="javascript:void(0);"><span class="fa fa-arrow-right" id="VAS_Next_'+g+'"></span></a></div><div class="VAS-page-count" id="VAS_spnPageCount_'+g+'">1 of 10</div></div></div></div>'),n=i.find("#VAS_divProduct_"+g),s=i.find("#VAS_divLastYear_"+g),l=i.find("#VAS_divCurrentYear_"+g),c=i.find("#VAS_spnPageCount_"+g),u=i.find("#VAS_Prev_"+g),d=i.find("#VAS_Next_"+g),u.on(VIS.Events.onTouchStartOrClick,function(){p>0&&(e[0].style.visibility="visible",p--,n.empty(),s.empty(),l.empty(),v())}),d.on(VIS.Events.onTouchStartOrClick,function(){p<o.length-1&&(e[0].style.visibility="visible",p++,n.empty(),s.empty(),l.empty(),v())})},this.intialLoad=function(){n.empty(),s.empty(),l.empty(),p=0,VIS.dataContext.getJSONData(VIS.Application.contextUrl+"Product/GetTopProductData","",function(t){null!=t&&(o=t,v()),e[0].style.visibility="hidden"})},this.getRoot=function(){return i},this.refreshWidget=function(){e[0].style.visibility="visible",p=0,a.intialLoad()}},e.VAS_HighestSellProduct.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad()},50)},e.VAS_HighestSellProduct.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_HighestSellProduct.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_HighestSellProduct.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},4018:()=>{VAS=window.VAS||{},function(e,t){e.VAS_CreditUtilizationWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l,s,o,r,c,u,d,g,p,v,_,V,A,m,f,D=0,h=0;function C(){r.empty(),s.find("canvas").remove();const a={type:"doughnut",data:{labels:[VIS.Msg.getMsg("CreditLimit"),VIS.Msg.getMsg("VAS_CreditUsed")],label:VIS.Msg.getMsg("VAS_CreditUtilization"),datasets:[{backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.5)"],data:[m,f],borderColor:"rgba(0,0,0,0)",borderWidth:0,hoverOffset:4}]},options:{responsive:!0,elements:{arc:{borderWidth:1},layout:{padding:{bottom:0}}},radius:"70%",plugins:{legend:{display:!0,position:"bottom",padding:{top:0}},tooltip:{callbacks:{label:function(e){const t=e.dataIndex,a=e.datasetIndex,i=e.chart.data.datasets[a],n=e.chart.data.labels,l=i.data[t];return n[t]+": "+l}}},datalabels:{display:!1,color:"#000",anchor:"end",align:"end",formatter:function(e){return e},font:{weight:"bold"}}}}},i=t("<canvas></canvas>");r.append(i),i.css("height","100%"),i.css("width","100%");const n=i[0].getContext("2d");new Chart(n,a),d.setValue(A),e.css("visibility","hidden")}this.initalize=function(){D=this.windowNo,e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append('<div class="VAS-creditLimit-container"><div class= "VAS-LeftTabs-container" id="VAS_CustomerContainer_'+D+'"><div class="VAS-tab-heading">'+VIS.Msg.getMsg("VAS_CreditUtilization")+'</div><div class="nav" id="VAS_divCustomers_'+D+'" role="tablist" aria-orientation="vertical"> </div><div class="VAS-tiles-pagination"><i class="fa fa-arrow-circle-left VAS-page-prev" id="VAS_Prev_'+D+'" aria-hidden="true"></i><span class="VAS-total-count" id="VAS_spnPageCount_'+D+'">0 of 0</span><i class="fa fa-arrow-circle-right VAS-page-next" id="VAS_Next_'+D+'" aria-hidden="true"></i></div></div><div class="VAS-creditLimit-chart" id="VAS_ChartContainer_'+D+'" aria-controls="credit-limit"><div class="VAS-chart-container" id="VAS_divChart_'+D+'"></div><div class="VAS-inputWbtn"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+D+'"></span><div class="input-group vis-input-wrap"><div class="vis-control-wrap" id="VAS_cmbCredit_'+D+'"><label for="VAS_Phase">'+VIS.Msg.getMsg("VAS_CreditValidation")+'</label></div></div><input type="button" id="VAS_btnUpdate_'+D+'" class="btn ui-button ui-widget" value="Update"></div></div></div>'),l=n.find("#VAS_CustomerContainer_"+D),s=n.find("#VAS_ChartContainer_"+D),o=l.find("#VAS_divCustomers_"+D),r=s.find("#VAS_divChart_"+D),g=s.find("#VAS_cmbCredit_"+D),p=s.find("#VAS_btnUpdate_"+D),c=n.find("#VAS_spnPageCount_"+D),h=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"Common/GetReference",{Name:"CreditValidation"}),u=VIS.MLookupFactory.get(VIS.Env.getCtx(),a.windowNo,0,VIS.DisplayType.List,"CreditValidation",h,!1,"AD_Ref_List.IsActive = 'Y'"),d=new VIS.Controls.VComboBox("CreditValidation",!0,!1,!0,u,50),g.prepend(d.getControl()),l.find("#VAS_Prev_"+D).on("click",function(t){a.currentPage>1&&(e[0].style.visibility="visible",a.currentPage--,a.intialLoad(a.currentPage))}),l.find("#VAS_Next_"+D).on("click",function(t){a.currentPage<a.totalPages&&(e[0].style.visibility="visible",a.currentPage++,a.intialLoad(a.currentPage))}),p.on("click",function(){d.getValue()!=A&&(e.css("visibility","visible"),VIS.dataContext.getJSONData(VIS.Application.contextUrl+"Product/UpdateCreditValidation",{BP_ID:v,Loc_ID:_,CreditSetting:V,CreditValidation:d.getValue()},function(e){var t=n.find("#VAS_spnErrorMessage_"+D),i="";1==e?(A=d.getValue(),i=VIS.Msg.getMsg("VAS_CreditValUpd")):(d.setValue(A),i=VIS.Msg.getMsg("VAS_CreditValNotUpd")),t.text(i),t.fadeIn(),t.fadeOut(5e3),a.intialLoad(a.currentPage)}))})},this.intialLoad=function(n){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"Product/GetCustomerCredit",{pageNo:n,pageSize:4},function(l){o.empty();var s="";if(null!=l&&null!=l.Customers&&l.Customers.length>0){for(i=0;i<l.Customers.length;i++){s="S"==l.Customers[i].SOCreditStatus?"VAS-redStatusColor":"H"==l.Customers[i].SOCreditStatus?"VAS-orangeStatusColor":"O"==l.Customers[i].SOCreditStatus?"VAS-greenStatusColor":"W"==l.Customers[i].SOCreditStatus?"VAS-yellowStatusColor":"VAS-greyStatusColor";var r=Math.floor(360*Math.random())+0,u=Math.floor(16*Math.random())+80,d="hsl("+r+", 100%,"+u+"%)",g="hsl("+r+", 100%,"+(u-50)+"%)",p=l.Customers[i].Name,D=p.trim().split(" ");p=D[0].substring(0,1).toUpper(),D.length>1?p+=D[D.length-1].substring(0,1).toUpper():p=D[0].substring(0,2).toUpper(),o.append('<div class="VAS-credit-limit-nav '+(0==i?"active":"")+'" aria-controls="credit-limit" data-creditlimit="'+l.Customers[i].SO_CreditLimit+'" data-creditused="'+l.Customers[i].SO_CreditUsed+'" data-bpid="'+l.Customers[i].C_BPartner_ID+'" data-locid="'+l.Customers[i].Location_ID+'" data-creditsetting="'+l.Customers[i].CreditSetting+'" data-creditval="'+l.Customers[i].CreditValidation+'"><div class="VAS-credit-des"><div class="VAS-credit-img" style="background-color:'+d+"; color:"+g+'"><span>'+p+'</span></div><div class="VAS-userCredit-detail"><div class="VAS-userCredit-name">'+l.Customers[i].Name+'</div><div class="VAS-userCreditStatus">'+VIS.Msg.getMsg("VAS_Status")+'<span class="'+s+'">'+l.Customers[i].CreditStatus+'</span></div></div></div><div class="progress"><div class="progress-bar bg-danger" role="progressbar" style="width:'+l.Customers[i].CreditUtil+'%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div></div></div>'),0==i&&(v=l.Customers[i].C_BPartner_ID,_=l.Customers[i].Location_ID,V=l.Customers[i].CreditSetting,A=l.Customers[i].CreditValidation,m=l.Customers[i].SO_CreditLimit,f=l.Customers[i].SO_CreditUsed,C())}1==n&&(a.totalPages=Math.ceil(l.RecordCount/4)),c.text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),o.off("click",".VAS-credit-limit-nav"),o.on("click",".VAS-credit-limit-nav",function(){e.css("visibility","visible"),o.find(".VAS-credit-limit-nav").removeClass("active"),t(this).addClass("active"),v=t(this).data("bpid"),_=t(this).data("locid"),V=t(this).data("creditsetting"),A=t(this).data("creditval"),m=t(this).data("creditlimit"),f=t(this).data("creditused"),C()})}e.css("visibility","hidden")})},this.getRoot=function(){return n},this.refreshWidget=function(){e[0].style.visibility="visible",a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_CreditUtilizationWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_CreditUtilizationWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_CreditUtilizationWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_CreditUtilizationWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_CreditUtilizationWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_CreditUtilizationWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},4033:()=>{VAS=window.VAS||{},function(e,t){e.VAS_LeadConversation=function(){var e;this.record_ID=0,this.table_ID=0,this.windowNo=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var a,i,n=this,l="",s="asst_YzDPtqW1Fa0CX3ZAabFXdJTy",o=!1,r=!1,c="",u=!1,d="",g=[],p="",v="",_="";function V(e){$BusyIndicator[0].style.visibility=e?"visible":"hidden"}function A(){a.empty();try{t.ajax({url:"https://api.openai.com/v1/threads",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer "+l,"OpenAI-Beta":"assistants=v2"},success:function(e){c=e.id,o=!0,m(p)},error:function(e,t,a){console.error("Error:",a),V(!1)}})}catch(e){alert(e),V(!1)}}function m(e){r=!1,u=!1;try{t.ajax({url:"https://api.openai.com/v1/threads/"+c+"/messages",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer "+l,"OpenAI-Beta":"assistants=v2"},data:JSON.stringify({role:"user",content:e}),success:function(e){null!=e.id&&function(){d="";try{t.ajax({url:"https://api.openai.com/v1/threads/"+c+"/runs",type:"POST",contentType:"application/json",headers:{Authorization:"Bearer "+l,"OpenAI-Beta":"assistants=v2"},data:JSON.stringify({assistant_id:s}),success:function(e){if(null!=e){for(;!u;)f(e.id);"completed"==d?function(e){var a=e;u=!1;try{t.ajax({url:"https://api.openai.com/v1/threads/"+c+"/messages",type:"GET",contentType:"application/json",headers:{Authorization:"Bearer "+l,"OpenAI-Beta":"assistants=v2"},success:function(e){if(null!=e){var i=jQuery.grep(e.data,function(e){return e.run_id===a&&"assistant"===e.role});null!=i?(C(i[0].content[0].text.value),o?(l=n.record_ID+","+c,t.ajax({url:VIS.Application.contextUrl+"VAS_Lead/SetThreadID",type:"POST",data:{field:l},success:function(e){o=!1,V(!1)},error:function(){V(!1)}})):V(!1)):V(!1)}var l},error:function(e,t,a){console.error("Error:",a),V(!1)}})}catch(e){alert(e)}}(e.id):"failed"==d&&V(!1)}},error:function(e,t,a){console.error("Error:",a),V(!1)}})}catch(e){alert(e),V(!1)}}()},error:function(e,t,a){console.error("Error:",a),V(!1)}})}catch(e){alert(e),V(!1)}}function f(e){try{t.ajax({url:"https://api.openai.com/v1/threads/"+c+"/runs/"+e,type:"GET",contentType:"application/json",async:!1,headers:{Authorization:"Bearer "+l,"OpenAI-Beta":"assistants=v2"},success:function(a){null!=a&&("failed"!=a.status&&"completed"!=a.status&&"requires_action"!=a.status||("completed"==a.status?u=!0:"failed"==a.status&&(C("failed Message"),u=!0),"requires_action"!=(d=a.status)||r||a.required_action.submit_tool_outputs.tool_calls.length>0&&"function"==a.required_action.submit_tool_outputs.tool_calls[0].type&&(r=!0,"create_opportunitylines"==a.required_action.submit_tool_outputs.tool_calls[0].function.name?function(e){if(e.length>0){g=[],function(e){if(null!=(e=JSON.parse(e[0].function.arguments))&&null!=e.products&&e.products.length>0){console.log(e.products);for(var t=0;t<e.products.length;t++){var a={};a.M_Product_ID=e.products[t].m_product_id,a.C_UOM_ID=e.products[t].c_uom_id,a.Quantity=e.products[t].mandays,a.Price=e.products[t].price,g.push(a)}}else console.log("No Product Data received from Assistant")}(e);try{t.ajax({url:VIS.Application.contextUrl+"VAS_Lead/GenerateLines",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({Record_ID:n.record_ID,ProductData:g}),async:!1,success:function(e){v=JSON.parse(e)},error:function(e){return v=e,V(!1),!1}})}catch(e){V(!1)}}}(a.required_action.submit_tool_outputs.tool_calls):"lead_prospect"==a.required_action.submit_tool_outputs.tool_calls[0].function.name?function(e){if(e.length>0){postData=[];try{t.ajax({url:VIS.Application.contextUrl+"VAS_Lead/ConvertProspect",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({Record_ID:n.record_ID}),async:!1,success:function(e){v=JSON.parse(e)},error:function(){V(!1)}})}catch(e){alert(e),V(!1)}}}(a.required_action.submit_tool_outputs.tool_calls):function(e){if(e.length>0){postData=[];try{t.ajax({url:VIS.Application.contextUrl+"VAS_Lead/GenerateOpprtunity",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({Record_ID:n.record_ID}),async:!1,success:function(e){v=JSON.parse(e)},error:function(){V(!1)}})}catch(e){alert(e),V(!1)}}}(a.required_action.submit_tool_outputs.tool_calls),function(e,a){try{t.ajax({url:"https://api.openai.com/v1/threads/"+c+"/runs/"+e+"/submit_tool_outputs",type:"POST",contentType:"application/json",async:!1,headers:{Authorization:"Bearer "+l,"OpenAI-Beta":"assistants=v2"},data:JSON.stringify({tool_outputs:[{tool_call_id:a,output:""!=v?v:"Success"}]}),success:function(e){null!=e&&"completed"==e.status&&(v=!0)},error:function(e,t,a){console.error("Error:",a),V(!1)}})}catch(e){V(!1)}}(e,a.required_action.submit_tool_outputs.tool_calls[0].id))))},error:function(e,t,a){console.error("Error:",a),V(!1)}})}catch(e){alert(e),V(!1)}}function D(){try{t.ajax({url:"https://api.openai.com/v1/threads/"+c+"/messages",type:"GET",contentType:"application/json",headers:{Authorization:"Bearer "+l,"OpenAI-Beta":"assistants=v2"},success:function(e){!function(e){a.empty();for(var t=e.data.length-1;t>=0;t--)"user"==e.data[t].role?e.data[t].content[0].text.value.contains("RecPromptMsg")||S(e.data[t].content[0].text.value):"assistant"==e.data[t].role&&C(e.data[t].content[0].text.value);h(),V(!1)}(e)},error:function(e,t,a){console.error("Error:",a),V(!1)}})}catch(e){alert(e)}}function h(){document.querySelector(".VAS-chat-body").scrollTop=document.querySelector(".VAS-chat-body").scrollHeight,i.focus()}function C(e){a.append(' <div class= "VAS-userChat-comment" > <div class="VAS-thumbImg"><img src="Areas/VAS/Content/Images/AI.png" alt=""></div><div class="VAS-chat-comments-col VAS-chatBox-white">  <div class="VAS-chatuser-name">AURA<span></span></div> <div class="VAS-chatBox">'+e+"</div></div></div>"),h()}function S(e){a.append(' <div class= "VAS-userChat-comment VAS-row-reverse" >   <div class="VAS-thumbImg"><img src="'+VIS.Application.contextUrl+_+'" alt=""></div> <div class="VAS-chat-comments-col ">   <div class="VAS-chatuser-name VAS-row-reverse">'+VIS.context.getAD_User_Name()+'<span></span></div>  <div class="VAS-chatBox VAS-chat-radius">'+e+"</div></div> </div>"),h()}this.init=function(){e=t('<div class="VAS-chatboat-container" style="right: 0; bottom: 0;"><div class="VAS-chatbaot-header" > <div class="VAS-aura-img"> <div class="VAS-thumbImg"><img src="Areas/VAS/Content/Images/AI.png" alt=""></div> Ask AURA</div> <a href="#"></a> </div><div id="VAS_ResponseTxt'+n.windowNo+'" class="VAS-chat-body"> </div> <div class="VAS-chatTextarea-col"> <textarea id="VAS_InpTxt'+n.windowNo+'" name="" id="" placeholder="Start Conversation"></textarea> <button id="VAS_EntrBtn'+n.windowNo+'" class="VAS-sendBtn"><i class="fa fa-paper-plane" aria-hidden="true"></i></button> </div></div>'),a=e.find("#VAS_ResponseTxt"+n.windowNo),i=e.find("#VAS_InpTxt"+n.windowNo),e.find("#VAS_EntrBtn"+n.windowNo).on("click",function(){V(!0);var e=i.val();i.val(""),""!=e?(a.append(' <div class= "VAS-userChat-comment VAS-row-reverse" >   <div class="VAS-thumbImg"><img src="'+VIS.Application.contextUrl+_+'" alt=""></div> <div class="VAS-chat-comments-col ">   <div class="VAS-chatuser-name VAS-row-reverse">'+VIS.context.getAD_User_Name()+'<span></span></div>  <div class="VAS-chatBox VAS-chat-radius">'+e+"</div></div> </div>"),h(),m(e)):V(!1)}),$BusyIndicator=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),$BusyIndicator[0].style.visibility="hidden",e.append($BusyIndicator)},this.getRoot=function(){return e},this.getThreadID=function(e){V(!0),t.ajax({url:VIS.Application.contextUrl+"VAS_Lead/GetThreadID",type:"POST",data:{Table_ID:n.table_ID,rec_ID:e},success:function(e){null!=e&&(e=JSON.parse(e),l=e.APiKey,""==e.ThreadID?(V(!0),V(!0),t.ajax({url:VIS.Application.contextUrl+"VAS_Lead/GetPromptMsg",type:"POST",data:{Table_ID:n.table_ID,rec_ID:n.record_ID},success:function(e){null!=e&&(""!=JSON.parse(e)?(p=JSON.parse(e),A()):(p="RecPromptMsg Hi AI",A()))},error:function(){}})):(console.log("Thread ID -- "+e.ThreadID),c=e.ThreadID,a.empty(),D()))},error:function(){}})},this.getUserImg=function(e){V(!0),t.ajax({url:VIS.Application.contextUrl+"VAS_Lead/GetUserImg",type:"POST",async:!1,data:{rec_ID:e},success:function(e){null!=e&&""==(_=JSON.parse(e))&&(_="Areas/VAS/Content/Images/dummy.jpg")},error:function(){}})}},e.VAS_LeadConversation.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,this.table_ID=t.getAD_Table_ID(),this.init()},e.VAS_LeadConversation.prototype.refreshPanelData=function(e,t){null==t||e<=0||(this.record_ID=e,this.selectedRow=t,this.getUserImg(e),this.getThreadID(e))},e.VAS_LeadConversation.prototype.sizeChanged=function(e){this.panelWidth=25},e.VAS_LeadConversation.prototype.dispose=function(){this.record_ID=0,this.table_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null}}(VAS,jQuery)},4096:()=>{VAS=window.VAS||{},function(e,t){e.MatchPOTabPanel=function(){this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var a=null,n=this.ctx;e.translatedTexts=VIS.Msg.translate(n,["VAS_MatchPoTabPanel","VAS_TransactionDate","VAS_PurchaseOrderNo","VAS_OrderLine","VAS_ShipmentLine","VAS_InvoiceLineMatch","VAS_Product","VAS_AttributeSetInstance","VAS_QuantityReq"],!0);var l=t('<div class = "root"></div>'),s=t("<div class ='vas-apTaxWrapper'></div>");a=t("<h6 class='vas-apTax-ttl'>"+e.translatedTexts.VAS_MatchPoTabPanel+"</h6>"),this.init=function(){s.append(a),function(){s.append('<div class="vas-aptaxListGroup"><div id="VAS-TaxDetail_'+this.windowNo+'" class= "VAS-TaxDetail mb-2" > </div></div>')}(),l.append(s)},this.getMatchPoData=function(a){t.ajax({url:VIS.Application.contextUrl+"VAS/OrderLineTabPanel/GetMatchingData",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{OrderLineId:a},success:function(t){if(s.find("#VAS-TaxDetail_"+self.windowNo).empty(),null!=(t=JSON.parse(t))&&t.length>0)for(i=0;i<t.length;i++){var a='<div class="vas-apListItem mb-2"><div class="vas-ap-sglItem mb-2"><div class="vas-singleTaxElement vas-setMatchPo"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_TransactionDate+'</span><span class="vas-singleTaxElementValue">'+new Date(t[i].TransactionDate).toLocaleDateString()+'</span></div><div class="vas-singleTaxElement vas-setMatchPo"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_PurchaseOrderNo+'</span><span class="vas-singleTaxElementValue">'+t[i].MatchPoNo+'</span></div><div class="vas-singleTaxElement vas-setMatchPo"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_OrderLine+'</span><span class="vas-singleTaxElementValue">'+t[i].PoDocumentNo+'</span></div><div class="vas-singleTaxElement vas-setMatchPo"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_ShipmentLine+'</span><span class="vas-singleTaxElementValue">'+t[i].ShipmentLine+'</span></div><div class="vas-singleTaxElement vas-setMatchPo"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_InvoiceLineMatch+'</span><span class="vas-singleTaxElementValue">'+t[i].InvoiceDocNo+'</span></div><div class="vas-singleTaxElement vas-setShipWidth"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_Product+'</span><span class="vas-singleTaxElementValue">'+t[i].Product+'</span></div><div class="vas-singleTaxElement vas-setShipWidth"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_AttributeSetInstance+'</span><span class="vas-singleTaxElementValue">'+t[i].AttributeSetInstance+'</span></div><div class="vas-singleTaxElement vas-setMatchPo"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_QuantityReq+'</span><span class="vas-singleTaxElementValue">'+t[i].Quantity.toLocaleString()+"</span></div></div ></div>";s.find("#VAS-TaxDetail_"+this.windowNo).append(a)}},error:function(e){console.log(e)}})},this.getRoot=function(){return l},e.MatchPOTabPanel.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,this.init()},e.MatchPOTabPanel.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.getMatchPoData(e)},e.MatchPOTabPanel.prototype.sizeChanged=function(e){this.panelWidth=e},e.MatchPOTabPanel.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,a=null}}}(VAS,jQuery)},4099:()=>{VAS=window.VAS||{},function(e,t){e.VAS_ExpectedPaymentWidget=function(){var e;this.frame,this.windowNo;var a=null,i=this,n=(VIS.Env.getCtx(),0),l=null,s=1,o=1,r=1,c=1,u=500,d=6,g=6,p=t('<div class="h-100 w-100">'),v=null,_=null,V=null,A=[],m=null,f=null,D=null,h=null,C=null,S=null,I=null,y=null,O=null,T=!1,w=null,P=[{refernceName:"VAS_DocTypeExPayPaymentList"},{refernceName:"VAS_FinancialPeriodPaymentList"},{ColumnName:"C_BPartner_ID"}];function b(e){var t=VIS.context.getWindowContext(i.windowNo,e);return t&&""!==t.trim()?t:null}function M(){Math.floor(360*Math.random()),Math.floor(16*Math.random());h=t('<div class="vas-expay-paymentsListing" id="vas_listContainer_'+l+'">');for(var e=0;e<_.length;e++){n+=1,D=_[0].recordCount;var V=_[e].Name.trim().split(" ");V[0].substring(0,1).toUpperCase(),V.length>1?V[V.length-1].substring(0,1).toUpperCase():V[0].substring(0,2).toUpperCase();var m="";"Order"===_[e].windowType?m=1==y?VIS.Msg.getMsg("VAS_AdvSalesOrder"):VIS.Msg.getMsg("VAS_AdvPurchaseOrder"):"Invoice"===_[e].windowType&&(m=1==y?VIS.Msg.getMsg("VAS_SalesInvoice"):VIS.Msg.getMsg("VAS_PurchaseInvoice"));var f='<div class="vas-expay-payments-box"><span class="VAS-expay-searchLinkIconBlock"><i class="glyphicon glyphicon-zoom-in" data-Record_ID="'+_[e].Record_ID+'" data-windowId="'+_[e].Window_ID+'" data-Primary_ID="'+_[e].Primary_ID+'" id="VAS-unAllocatedZoom_'+i.windowNo+'" title="'+VIS.Msg.getMsg("VAS_Zoom")+'"></i></span><div class="vas-expay-payments-detail"><div class="vas-expay-payment-w-amount"><div class="vas-expay-payment-lbl vas-expay-com-name vas-expay-head-font"  title="'+VIS.Msg.getMsg("VAS_Type")+": "+m+'">'+m+'</div></div><div class="vas-expay-payment-w-amount"><div class="vas-expay-payment-lbl vas-expay-text-align vas-expay-com-name vas-expay-rtl" title="'+VIS.Msg.getMsg("VAS_DueDate")+": "+VIS.Utility.Util.getValueOfDate(_[e].OrderdDate).toLocaleDateString(window.navigator.language,{day:"2-digit",month:"2-digit",year:"numeric"})+'">'+VIS.Utility.Util.getValueOfDate(_[e].OrderdDate).toLocaleDateString(window.navigator.language,{day:"2-digit",month:"2-digit",year:"numeric"})+'</div></div><div class="vas-expay-payment-w-amount">';f+='<div class="vas-expay-payment-lbl vas-expay-com-name" title="'+(1==y?VIS.Msg.getMsg("VAS_CustomerPartner"):VIS.Msg.getMsg("VAS_VendorPartner"))+": "+_[e].Name+'">'+_[e].Name+'</div></div><div class="vas-expay-payment-w-amount"><div class="vas-expay-payment-lbl vas-expay-text-align vas-expay-com-name vas-expay-rtl" title="'+VIS.Msg.getMsg("DocumentNo")+": "+_[e].DocumentNo+'">'+_[e].DocumentNo+'</div></div><div class="vas-expay-payment-w-amount"><div class="vas-expay-payment-lbl vas-expay-com-name" title="'+VIS.Msg.getMsg("VAS_Currency")+": "+_[e].ISO_Code+'">'+_[e].ISO_Code+'</div></div><div class="vas-expay-payment-w-amount"><div class="vas-expay-payment-lbl vas-expay-text-align vas-expay-com-name vas-expay-rtl" title="'+VIS.Msg.getMsg("VAS_DueAmtExPay")+": "+_[e].TotalAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:_[e].stdPrecision,maximumFractionDigits:_[e].stdPrecision})+'">'+(3!=_[e].Symbol.length?'<span class="vas-expay-symbol">'+_[e].Symbol+" </span>":"")+_[e].TotalAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:_[e].stdPrecision,maximumFractionDigits:_[e].stdPrecision})+(3==_[e].Symbol.length?' <span class="vas-expay-symbol">'+_[e].Symbol+"</span>":"")+"</div></div></div></div>",h.append(f)}n<d&&function(e){for(var t=0;t<e;t++)h.append(a)}(d-n),c=Math.ceil(D/d);var C=t('<div class="vas-expay-pagingdiv"><div class="vas-expay-slider-arrows" id="vas_arrawcontainer_'+l+'"><i class= "fa fa-arrow-circle-left vas-expay-leftar" aria-hidden="true"></i><span class="vas-expay-pagespan"><span>'+r+" </span><span>"+VIS.Msg.getMsg("VAS_Of")+" </span><span>"+c+'</span></span > <i class="fa fa-arrow-circle-right vas-expay-rightar" aria-hidden="true"></i></div></div>');v.append(h).append(C),p.append(v),1==o&&1==s&&C.find(".fa-arrow-circle-left").addClass("vas-disableArrow"),C.find(".fa-arrow-circle-right").on("click",function(){o++,r++,v.find("#vas_listContainer_"+l).remove(),v.find("#vas_arrawcontainer_"+l).remove(),_=x(A,o,d),g>=A.length?(o=1,g=5,s++,i.intialLoad()):(g+=d,M())}),C.find(".fa-arrow-circle-left").on("click",function(){o--,r--,v.find("#vas_listContainer_"+l).remove(),v.find("#vas_arrawcontainer_"+l).remove(),_=x(A,o,d),g==d?(g=u,s--,i.intialLoad()):(g-=d,M())});var S=Math.ceil(D/u);s>=S&&g>=A.length&&C.find(".fa-arrow-circle-right").addClass("vas-disableArrow"),v.find(".glyphicon-zoom-in").on("click",function(){!function(e,t,a){if(t>0){var i=new VIS.Query;i.addRestriction(a,VIS.Query.prototype.EQUAL,e),i.setRecordCount(1),VIS.viewManager.startWindow(t,i)}}(VIS.Utility.Util.getValueOfInt(t(this).attr("data-Record_ID")),VIS.Utility.Util.getValueOfInt(t(this).attr("data-windowId")),VIS.Utility.Util.getValueOfString(t(this).attr("data-Primary_ID")))})}function x(e,t,a){var i=(t-1)*a,n=i+a;return e.slice(i,n)}this.initalize=function(){N(),a=t('<div class="vas-expay-payments-box vas-expay-emptydiv"> <h6></h6><div class="vas-expay-payments-detail"><div class="vas-expay-thumb-txt"><img src="" alt="" style="width:0px"><div class="vas-expay-company-w-date"><div class="vas-expay-com-name"></div><div class="vas-expay-paymentDate"></div></div></div><div class="vas-expay-payment-w-amount"><div class="vas-expay-payment-lbl"></div><div class="vas-expay-paymentTotalAmt"><span></span></div></div></div></div>'),(e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>')).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),e[0].style.visibility="visible",p.append(e),l=0!=VIS.Utility.Util.getValueOfInt(this.widgetInfo.AD_UserHomeWidgetID)?this.widgetInfo.AD_UserHomeWidgetID:i.windowNo;var c;"VAS_APPayment"===(c=b("ScreenName")||b("IsReceipt")||b("IsSOTrx"))||"N"===c?y=!1:"VAS_ARReceipt"!==c&&"Y"!==c||(y=!0),v=t('<div class="vas-expay-expected-payment">');var _=t('<div class="vas-expay-expected-heading">'),A=t('<div style="font-size:1.4em">'+(1==y?VIS.Msg.getMsg("VAS_ExpectedReceipt"):VIS.Msg.getMsg("VAS_ExpectedPayment"))+"</div>"),D=t("<div class='vas-expay-filter dropdown'><div class='vas-expay-icondiv'><span class='vas-expay-filterspn btn d-flex position-relative' type='button' id='vas_expay_dropdownMenu_"+i.windowNo+"'><i class='fa fa-filter vas-expay-filterIcon'></i></span></div><div class='vas-expay-filterPopupWrap' id='vas_expay_FilterPopupWrap_"+i.windowNo+"'></div></div>");_.append(A).append(D),v.append(_),D.find("#vas_expay_dropdownMenu_"+i.windowNo).on("click",function(){if(T)V.remove(),T=!1;else{D.addClass("vas-disableArrow"),T=!0;p.find("#vas_expay_FilterPopupWrap_"+i.windowNo);V=t('  <div class="vas-expay-filter-flyout">    <div class="vas-from-row">'),DocTypeExPayListDiv=t('<div class="VAS-DocTypeExPayListDiv">'),$DocTypeExPayListDiv=t('<div class="input-group vis-input-wrap">'),$DocTypeExPayListLookUp=VIS.MLookupFactory.get(VIS.Env.getCtx(),i.windowNo,0,VIS.DisplayType.List,"VAS_DocTypeExPayPaymentList",f.VAS_DocTypeExPayPaymentList,!1),i.vDocTypeExPayList=new VIS.Controls.VComboBox("VAS_DocTypeExPayPaymentList",!0,!1,!0,$DocTypeExPayListLookUp,20),i.vDocTypeExPayList.setValue("01");var e=t('<div class="vis-control-wrap">');$DocTypeExPayListDiv.append(e),e.append(i.vDocTypeExPayList.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append('<label style="top:-9px;background-color: rgb(235, 235, 235);color:black;">'+VIS.Msg.getMsg("VAS_DocTypeExPayDiv")+"</label>"),$DocTypeExPayListDiv.append(e),DocTypeExPayListDiv.append($DocTypeExPayListDiv),FinancialPeriodListDiv=t('<div class="VAS-FinancialPeriodListDiv">'),$FinancialPeriodListDiv=t('<div class="input-group vis-input-wrap">'),$FinancialPeriodListLookUp=VIS.MLookupFactory.get(VIS.Env.getCtx(),i.windowNo,0,VIS.DisplayType.List,"VAS_FinancialPeriodPaymentList",f.VAS_FinancialPeriodPaymentList,!1),i.vFinancialPeriodList=new VIS.Controls.VComboBox("VAS_FinancialPeriodPaymentList",!1,!1,!0,$FinancialPeriodListLookUp,20);var a=t('<div class="vis-control-wrap">');$FinancialPeriodListDiv.append(a),a.append(i.vFinancialPeriodList.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append('<label style="top:-9px;background-color: rgb(235, 235, 235);color:black;">'+VIS.Msg.getMsg("VAS_FinancialPeriodDiv")+"</label>"),$FinancialPeriodListDiv.append(a),FinancialPeriodListDiv.append($FinancialPeriodListDiv);var c=1==y?"C_BPartner.IsActive='Y' AND C_BPartner.IsCustomer = 'Y' AND C_BPartner.IsSummary = 'N'":"C_BPartner.IsActive='Y' AND C_BPartner.IsVendor = 'Y' AND C_BPartner.IsSummary = 'N'",_=t('<div class="vas-BPartnerDiv">');$BPartnerDiv=t('<div class="input-group vis-input-wrap">');var A=VIS.MLookupFactory.get(VIS.Env.getCtx(),i.windowNo,f.C_BPartner_ID,VIS.DisplayType.Search,"C_BPartner_ID",0,!1,c);m=new VIS.Controls.VTextBoxButton("C_BPartner_ID",!1,!1,!0,VIS.DisplayType.Search,A),1==y?m.setCustomInfo("VAS_Customer"):m.setCustomInfo("VAS_VendorEmployee");var h=t('<div class="vis-control-wrap">'),P=t('<div class="input-group-append">');$BPartnerDiv.append(h),h.append(m.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append('<label class="vas-exinvd-bpLabel" style="color:#000;">'+(1==y?VIS.Msg.getMsg("VAS_CustomerPartner"):VIS.Msg.getMsg("VAS_VendorPartner"))+"</label>"),$BPartnerDiv.append(h),P.append(m.getBtn(0)),$BPartnerDiv.append(P),_.append($BPartnerDiv);var b=t('<div class="vas-expay-dateWidth vas-FromdateDiv">');$FromDatewrapDiv=t('<div class="input-group vis-input-wrap">'),$FromDate=new VIS.Controls.VDate("DateReport",!1,!1,!0,VIS.DisplayType.Date,"DateReport");var M=t('<div class="vis-control-wrap">');$FromDatewrapDiv.append(M),M.append($FromDate.getControl().attr("placeholder"," ").attr("data-placeholder","")).append('<label class="vas-expay-lablels" style="color:black;">'+VIS.Msg.getMsg("VAS_FromDate")+"</label>"),b.append($FromDatewrapDiv);var x=t('<div class="vas-expay-dateWidth vas-todateDiv">');$toDatewrapDiv=t('<div class="input-group vis-input-wrap">'),$ToDate=new VIS.Controls.VDate("DateReport",!1,!1,!0,VIS.DisplayType.Date,"DateReport");var N=t('<div class="vis-control-wrap">');$toDatewrapDiv.append(N),N.append($ToDate.getControl().attr("placeholder"," ").attr("data-placeholder","")).append('<label class="vas-expay-lablels" style="color:black;">'+VIS.Msg.getMsg("VAS_ToDate")+"</label>"),x.append($toDatewrapDiv);var L=t('<div class="vas-expay-datefilter">');L.append(b).append(x),V.append(DocTypeExPayListDiv).append(FinancialPeriodListDiv).append(_).append(L);var R=t('<div class="vas-expay-btndiv">'),U=t('<div class="vas-flyout-footer"><button id="VAS_Apply_'+i.windowNo+'" class="VIS_Pref_btn-2 vas-expay-filtbtn">'+VIS.Msg.getMsg("VAS_Apply")+"</button></div>"),E=t('<div class="vas-flyout-footer"><button id="VAS_Close_'+i.windowNo+'" class="VIS_Pref_btn-2 vas-expay-filtbtn">'+VIS.Msg.getMsg("VAS_Clear")+"</button></div>");R.append(E).append(U),V.append(R),v.append(V),null==O&&null==C&&null==S&&null==I&&null==w||(i.vFinancialPeriodList.setValue(C),m.setValue(O),$FromDate.setValue(S),$ToDate.setValue(I),i.vDocTypeExPayList.setValue(w));var k=U.find("#VAS_Apply_"+i.windowNo);m.fireValueChanged=function(){O=m.value},k.on("click",function(){if($FromDate.getValue()>$ToDate.getValue())return VIS.ADialog.info("VAS_PlzEnterCorrectDate"),void $ToDate.setValue(null);T=!1,s=1,o=1,r=1,u=500,d=6,n=0,g=6,C=i.vFinancialPeriodList.getValue(),S=$FromDate.getValue(),I=$ToDate.getValue(),w=i.vDocTypeExPayList.getValue(),V.remove(),v.find("#vas_listContainer_"+l).remove(),v.find("#vas_arrawcontainer_"+l).remove(),v.find("#vas_norecordcont_"+l).remove(),i.intialLoad()}),E.on("click",function(){null==i.vFinancialPeriodList.oldValue&&i.vFinancialPeriodList.setValue(0),"01"==i.vDocTypeExPayList.oldValue&&i.vDocTypeExPayList.setValue(null),i.vDocTypeExPayList.setValue("01"),i.vFinancialPeriodList.setValue(null),m.setValue(null),$FromDate.setValue(null),$ToDate.setValue(null),O=null,C=null,S=null,I=null,w=null}),setTimeout(function(){D.removeClass("vas-disableArrow")},1e3)}})},this.intialLoad=function(){e[0].style.visibility="visible",VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetExpectedPaymentData",{ISOtrx:y,pageNo:s,pageSize:u,FinancialPeriodValue:C,C_BPartner_ID:O,fromDate:S,toDate:I,docTypeValue:w},function(t){null!=(A=t)&&A.length>0?(0==o&&(o=Math.ceil(A.length/d)),_=x(A,o,d),M()):(v.append('<div class="vas-igwidg-notfounddiv" id="vas_norecordcont_'+l+'">'+VIS.Msg.getMsg("VAS_RecordNotFound")+"</div>"),p.append(v)),e[0].style.visibility="hidden"})};var N=function(){f=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetColumnIDForExpPayment",{refernceName:JSON.stringify(P)},null)};this.getRoot=function(){return p},this.refreshWidget=function(){e[0].style.visibility="visible",v.find("#vas_listContainer_"+l).remove(),v.find("#vas_arrawcontainer_"+l).remove(),v.find("#vas_norecordcont_"+l).remove(),O=null,C=null,S=null,I=null,w=null,s=1,o=1,u=500,r=1,null!=V&&V.remove(),n=0,d=6,w=null,g=6,i.intialLoad()}},e.VAS_ExpectedPaymentWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad()},50)},e.VAS_ExpectedPaymentWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_ExpectedPaymentWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_ExpectedPaymentWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},4374:()=>{VAS=window.VAS||{},function(e,t){e.VAS_FinDInsights=function(){var a;this.frame,this.windowNo,this.widgetInfo;var n=this,l=t('<div class="h-100 w-100">'),s=null,o=0,r=0;function c(e){var t="",a=e.match(/@(.+?)@/);return a&&a[1]?(t=a[1],e.replace("@"+t+"@",VIS.Msg.getMsg(t))):e}this.initalize=function(){o=0!=VIS.Utility.Util.getValueOfInt(this.widgetInfo.AD_UserHomeWidgetID)?this.widgetInfo.AD_UserHomeWidgetID:n.windowNo,(a=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'))[0].style.visibility="visible",l.append(a),l.append('<div class="vas-fdi-feed-container"><div class="vas-fdi-spaceBetween"><h1 class="vas-fdi-widget-head">'+VIS.Msg.getMsg("VAS_FinDInsights")+'</h1><div class="vas-fdi-marquee" id = "VAS_divContainer_'+o+'"><p></p></div></div>'),s=l.find("#VAS_divContainer_"+o),l.find(".vas-fdi-refreshIco").hide()},this.intialLoad=function(){s.find("p").empty(),VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetFinInsightsData",null,function(n){if(InsightData=n,InsightData.length>0)for(i=0;i<InsightData.length;i++)s.find("p").append(' <div class="vas-fdi-req-generated"><div class="vas-fdi-req-count"></div><a href="#" class="vas-fdi-reqGen-Txt vas-custom-link" data-name="'+InsightData[i].Name+'" data-dataobject="'+InsightData[i].DataObject+'" data-tableview="'+InsightData[i].TabelView+'" data-ad_org_id="'+InsightData[i].AD_Org_ID+'"><span style="font-size: 1.8em;">'+InsightData[i].Result+'</span>    <span style="font-size: 1.2em;">'+c(InsightData[i].DisplayName)+"</span></a></div></div>");else s.find("p").append('<div class="vas-fdi-notfounddiv" id="vas_norecordcont_'+o+'">'+VIS.Msg.getMsg("VAS_RecordNotFound")+"</div>");a[0].style.visibility="hidden",s.find("a").on("click",function(){++r;var a=new e.VAS_FinDInsightsGridView;a.setProperties(t(this).attr("data-tableview"),t(this).attr("data-name"),t(this).attr("data-dataobject"),r,t(this).attr("data-ad_org_id")),a.Initialize()})})},this.getRoot=function(){return l},this.refreshWidget=function(){a[0].style.visibility="visible",n.intialLoad()}},e.VAS_FinDInsights.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad()},50)},e.VAS_FinDInsights.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_FinDInsights.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_FinDInsights.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},4416:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutDocumentType")}function i(){e.CalloutEngine.call(this,"VIS.CalloutRecurring")}function n(){e.CalloutEngine.call(this,"VIS.CalloutProfitLoss")}function l(){e.CalloutEngine.call(this,"VIS.CalloutProfitTax")}function s(){e.CalloutEngine.call(this,"VIS.CalloutUOMConversion")}function o(){e.CalloutEngine.call(this,"VIS.CalloutIncoTerm")}function r(){e.CalloutEngine.call(this,"VIS.CalloutLocatorPC")}function c(){e.CalloutEngine.call(this,"VIS.CalloutLandedCost")}function u(){e.CalloutEngine.call(this,"VIS.CalloutRFQ")}function d(){e.CalloutEngine.call(this,"VIS.CalloutPaymentTerm")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.SetSalesQuotation=function(e,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";try{this.setCalloutActive(!0),"OB"==t.getValueOfString(i.getValue("DocSubTypeSO"))||"ON"==t.getValueOfString(i.getValue("DocSubTypeSO"))?i.setValue("IsSalesQuotation",!0):i.setValue("IsSalesQuotation",!1)}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),""},a.prototype.Organization=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";try{this.setCalloutActive(!0);if(null!=i.getField("M_Warehouse_ID")){var o=e.dataContext.getJSONRecord("MDocType/GetWarehouse",l.toString());o>0?"M_Movement"==i.getTableName()&&null!=i.getField("DTD001_MWarehouseSource_ID")?i.setValue("DTD001_MWarehouseSource_ID",o):i.setValue("M_Warehouse_ID",o):"M_Movement"==i.getTableName()&&null!=i.getField("DTD001_MWarehouseSource_ID")?i.setValue("DTD001_MWarehouseSource_ID",0):i.setValue("M_Warehouse_ID",0)}}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),""},e.Model.CalloutDocumentType=a,e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.SetMaxRunZero=function(e,t,a,i,n,l){if(null==n||""==n.toString())return"";this.setCalloutActive(!0);var s=a.getValue("RunsMax");return""!=s&&s>0&&a.setValue("RunsRemaining",0),this.setCalloutActive(!1),a=n=null,""},e.Model.CalloutRecurring=i,e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.SetDateFromAndDateTo=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";this.setCalloutActive(!0);try{var r=s.toString()+","+a.getAD_Client_ID().toString(),c=e.dataContext.getJSONRecord("Common/GetPeriodFromYear",r);if(null!=c){var u=t.getValueOfDate(c.STARTDATE),d=t.getValueOfDate(c.ENDDATE);n.setValue("DateFrom",u),n.setValue("DateTo",d)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),a=n=s=null,""},n.prototype.SetCurrency=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";this.setCalloutActive(!0);try{var r=s.toString()+","+a.getAD_Client_ID().toString(),c=e.dataContext.getJSONRecord("Common/GetCurrencyFromAccountingSchema",r);if(null!=c){var u=t.getValueOfInt(c.CurrencyID);n.setValue("C_Currency_ID",u)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),a=n=s=null,""},e.Model.CalloutProfitLoss=n,e.Utility.inheritPrototype(l,e.CalloutEngine),l.prototype.SetProfitBeforeTax=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";if(this.isCalloutActive()||null==s)return"";this.setCalloutActive(!0);try{var r=e.dataContext.getJSONRecord("MProfitTax/GetProfitLossDetails",s.toString());Object.keys(r).length>0&&(n.setValue("ProfitBeforeTax",t.getValueOfDecimal(r.ProfitBeforeTax)),n.setValue("C_Year_ID",t.getValueOfInt(r.C_Year_ID)),n.setValue("C_ProfitAndLoss_ID",t.getValueOfInt(r.C_ProfitAndLoss_ID)))}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),n=s=null,""},e.Model.CalloutProfitTax=l,e.Utility.inheritPrototype(s,e.CalloutEngine),s.prototype.SetMultiplyRate=function(e,t,a,i,n,l){return this.isCalloutActive()||null==n||""==n.toString()?(a.setValue("MultiplyRate",0),""):(this.setCalloutActive(!0),a.getValue("C_UOM_ID")==a.getValue("C_UOM_To_ID")&&(a.setValue("DivideRate",1),a.setValue("MultiplyRate",1)),this.setCalloutActive(!1),"")},e.Model.CalloutUOMConversion=s,e.Utility.inheritPrototype(o,e.CalloutEngine),o.prototype.CheckIncoTerm=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);var r=a.isSOTrx(i),c=0,u="";try{if(n.getTableName().startsWith("C_Order")?r&&t.getValueOfInt(n.getValue("C_Order_Quotation"))>0?(u=r+","+n.getTableName()+",C_Order_Quotation,"+t.getValueOfInt(n.getValue("C_Order_Quotation")).toString(),c=e.dataContext.getJSONRecord("MOrder/GetIncoTerm",u)):!r&&t.getValueOfInt(n.getValue("Ref_Order_ID"))>0?(u=r+","+n.getTableName()+",Ref_Order_ID,"+t.getValueOfInt(n.getValue("Ref_Order_ID")).toString(),c=e.dataContext.getJSONRecord("MOrder/GetIncoTerm",u)):t.getValueOfInt(n.getValue("C_Order_Blanket"))>0&&(u=r+","+n.getTableName()+",C_Order_Blanket,"+t.getValueOfInt(n.getValue("C_Order_Blanket")).toString(),c=e.dataContext.getJSONRecord("MOrder/GetIncoTerm",u)):n.getTableName().startsWith("C_Invoice")?r&&t.getValueOfInt(n.getValue("C_Order_ID"))>0||!r&&t.getValueOfInt(n.getValue("C_Order_ID"))>0?(u=r+","+n.getTableName()+",C_Order_ID,"+t.getValueOfInt(n.getValue("C_Order_ID")).toString(),c=e.dataContext.getJSONRecord("MOrder/GetIncoTerm",u)):!r&&t.getValueOfInt(n.getValue("M_InOut_ID"))>0&&(u=r+","+n.getTableName()+",M_InOut_ID,"+t.getValueOfInt(n.getValue("M_InOut_ID")).toString(),c=e.dataContext.getJSONRecord("MOrder/GetIncoTerm",u)):n.getTableName().startsWith("M_InOut")&&(r&&t.getValueOfInt(n.getValue("C_Order_ID"))>0||!r&&t.getValueOfInt(n.getValue("C_Order_ID"))>0?(u=r+","+n.getTableName()+",C_Order_ID,"+t.getValueOfInt(n.getValue("C_Order_ID")).toString(),c=e.dataContext.getJSONRecord("MOrder/GetIncoTerm",u)):!r&&t.getValueOfInt(n.getValue("C_Invoice_ID"))>0&&(u=r+","+n.getTableName()+",C_Invoice_ID,"+t.getValueOfInt(n.getValue("C_Invoice_ID")).toString(),c=e.dataContext.getJSONRecord("MOrder/GetIncoTerm",u))),c>0&c!=s)return this.setCalloutActive(!1),e.ADialog.warn("IncoTermChanged"),""}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),""},e.Model.CalloutIncoTerm=o,e.Utility.inheritPrototype(r,e.CalloutEngine),r.prototype.SetLocatorPC=function(e,t,a,i,n,l){return this.isCalloutActive()||null==n||""==n.toString()||(this.setCalloutActive(!0),"M_Warehouse_ID"==i.getColumnName()?n!=l&&(a.setValue("M_Locator_ID",""),a.setValue("Ref_M_Container_ID","")):"M_Locator_ID"==i.getColumnName()&&n!=l&&a.setValue("Ref_M_Container_ID",""),this.setCalloutActive(!1),a=i=n=l=null),""},e.Model.CalloutLocatorPC=r,e.Utility.inheritPrototype(c,e.CalloutEngine),c.prototype.Product=function(e,t,a,i,n,l){return this.isCalloutActive()||null==n||""==n.toString()||(this.setCalloutActive(!0),null!=a.getField("M_AttributeSetInstance_ID")&&a.setValue("M_AttributeSetInstance_ID",null),this.setCalloutActive(!1)),""},e.Model.CalloutLandedCost=c,e.Utility.inheritPrototype(u,e.CalloutEngine),u.prototype.Comparedates=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";this.setCalloutActive(!0);var o=new Date(i.getValue("DateWorkStart")),r=new Date(i.getValue("DateWorkComplete"));if("DateWorkStart"==n.getColumnName()){if(o>=r&&null!=i.getValue("DateWorkComplete"))return i.setValue("DateWorkStart",""),this.setCalloutActive(!1),e.ADialog.info("DateWorkGreater")}else if(o>=r&&null!=i.getValue("DateWorkStart"))return i.setValue("DateWorkComplete",""),this.setCalloutActive(!1),e.ADialog.info("DateWorkGreater");return this.setCalloutActive(!1),""},u.prototype.RfqDateResponse=function(e,t,a,i,n,l){return this.isCalloutActive()||null==n||""==n.toString()?"":(this.setCalloutActive(!0),null!=a.getValue("DateResponse")&&new Date(a.getValue("DateResponse")).setHours(0,0,0,0)<(new Date).setHours(0,0,0,0)?(a.setValue("DateResponse",null),this.setCalloutActive(!1),"VAS_ResponseDateMustGreater"):(this.setCalloutActive(!1),""))},u.prototype.TotalLineAmt=function(e,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";this.setCalloutActive(!0);var o=t.getValueOfDecimal(i.getValue("Qty")),r=t.getValueOfDecimal(i.getValue("BenchmarkPrice"));if("Qty"==n.getColumnName())var c=o*r;if("BenchmarkPrice"==n.getColumnName())c=o*r;return i.setValue("LineNetAmt",c),this.setCalloutActive(!1),""},e.Model.CalloutRFQ=u,e.Utility.inheritPrototype(d,e.CalloutEngine),d.prototype.ClearWeekDay=function(t,a,i,n,l,s){return this.isCalloutActive()||null==l||""==l.toString()||(this.setCalloutActive(!0),1==l&&(i.setValue("NetDay",""),i.setValue("WeekOffset",e.Env.ZERO)),this.setCalloutActive(!1)),""},e.Model.CalloutPaymentTerm=d}(VIS,jQuery)},4559:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutOrderLine")}function i(){e.CalloutEngine.call(this,"VIS.CalloutOrderlineRecording")}function n(){e.CalloutEngine.call(this,"VIS.CalloutContractLine")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.EndDate=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r=new Date(n.getValue("StartDate")),c=e.dataContext.getJSONRecord("MOrderLine/GetNoOfMonths",t.getValueOfString(n.getValue("C_Frequency_ID"))),u=t.getValueOfInt(n.getValue("NoofCycle")),d=r.getDate()+"/"+(r.getMonth()+c*u)+"/"+r.getFullYear();return d=(d=d<=0?new Date:new Date(d)).toISOString(),n.setValue("EndDate",d),n=s=null,""},a.prototype.Qty=function(e,a,i,n,l,s){if(null==l||""==l.toString())return"";var o=t.getValueOfDecimal(l)*t.getValueOfDecimal(i.getValue("QtyPerCycle"));return i.setValue("QtyEntered",o),i.setValue("QtyOrdered",o),i=l=null,""},a.prototype.QtyPerCycle=function(e,a,i,n,l,s){if(null==l||""==l.toString())return"";var o=t.getValueOfDecimal(l),r=t.getValueOfDecimal(i.getValue("NoofCycle"))*o;return i.setValue("QtyEntered",r),i.setValue("QtyOrdered",r),i=l=null,""},e.Model.CalloutOrderLine=a,e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.Orderline=function(a,i,n,l,s,o){if(null==s||""==s.toString()||0==t.getValueOfInt(s))return"";if(this.isCalloutActive())return"";try{this.setCalloutActive(!0);var r=t.getValueOfInt(s),c=e.dataContext.getJSONRecord("MOrderLine/GetOrderLine",r);n.setValue("M_Product_ID",c.M_Product_ID),n.setValue("Qty",c.Qty),n.setValue("C_UOM_ID",c.C_UOM_ID),n.setValue("C_BPartner_ID",c.C_BPartner_ID),n.setValue("PlannedHours",c.PlannedHours),this.setCalloutActive(!1)}catch(e){this.setCalloutActive(!1)}return n=s=null,""},e.Model.CalloutOrderlineRecording=i,e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.Contractlines=function(a,i,n,l,s,o){if(null==s||""==s.toString()||0==t.getValueOfInt(s))return"";if(this.isCalloutActive())return"";try{this.setCalloutActive(!0);var r=t.getValueOfInt(s),c=e.dataContext.getJSONRecord("MVASContract/GetContractData",r);null!=c&&(t.getValueOfInt(c.M_Product)>0&&(n.setValue("M_Product_ID",t.getValueOfInt(c.M_Product)),n.setValue("C_Charge_ID",null)),t.getValueOfInt(c.C_Charge)>0&&(n.setValue("C_Charge_ID",t.getValueOfInt(c.C_Charge)),n.setValue("M_Product_ID",null)),n.setValue("M_AttributeSetInstance_ID",c.M_AttributeSetInstance),n.setValue("C_UOM_ID",c.C_UOM),n.setValue("QtyEntered",1))}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),n=s=null,""},e.Model.CalloutContractLine=n}(VIS,jQuery)},4864:()=>{VAS=window.VAS||{},function(e,t){e.VAS_ExpectedDeliveryWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[],r=0;this.initalize=function(){const a='<div id="VAS_DeliveryContainer_'+(l=this.widgetInfo.AD_UserHomeWidgetID)+'" class="VAS-deliveries-container">    <div class="VAS-deliveries-heading">        <h6>'+VIS.Msg.getMsg("VAS_Expecteddeliveries")+'</h6>    </div>    <div class="VAS-delivery-count">        <div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_Deliveries")+' <span id="VAS_DeliveryCount_'+l+'">0</span></div>    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">        </div>    </div>    <div class="VAS-height-container">        <div id="VAS_DeliveryBox_'+l+'" class="VAS-deliveries-listing">        </div>        <div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing">        </div>    </div><div class="VAS-pagination-container"></div></div>';e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append(a)},this.intialLoad=function(c){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_DeliveryContainer_"+l).show(),t.ajax({url:VIS.Application.contextUrl+"Product/GetExpectedDelivery",data:{pageNo:c,pageSize:4,Type:"ED"},dataType:"json",success:function(u){u=JSON.parse(u);if(n.find("#VAS_DeliveryBox_"+l).empty(),n.find("#VAS_OrderContainer").remove,null!=u&&null!=u.Orders&&u.Orders.length>0){for(i=0;i<u.Orders.length;i++){var d='<div id="VAS_OrderContainer_'+l+'" class="VAS-delivery-box" >    <div class="VAS-box-heading">        <div class="VAS-icon-w-name">            <i class="fa fa-file-text" aria-hidden="true"></i>            <div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor"                 title="'+VIS.Msg.getMsg("Document_No")+'"                 data-doc-no="'+u.Orders[i].DocumentNo+'"                 data-customer-name="'+u.Orders[i].CustomerName+'"                 data-orderid="'+u.Orders[i].C_Order_ID+'">                '+u.Orders[i].DocumentNo+'            </div>        </div>        <div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+u.Orders[i].LineCount+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+u.Orders[i].CustomerName+'</div>    </div>    <div class="VAS-spaceBetween-col grid-2-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_DeliveryLocation")+'">'+u.Orders[i].DeliveryLocation+'</div>        <div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_ProductLocation")+'">'+u.Orders[i].ProductLocation+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+u.Orders[i].Symbol+"</span> "+u.Orders[i].GrandTotal.toLocaleString()+"</div>    </div></div>";n.find("#VAS_DeliveryBox_"+l).append(d)}s=[],u.Orders.forEach(function(e){e.OrderLines&&e.OrderLines.length>0&&(s[e.DocumentNo]=e.OrderLines)}),1==c&&(n.find("#VAS_DeliveryCount_"+l).text(u.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/4);var s=t('<div class="VAS-slider-arrows VAS-orders-text-white">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(u.RecordCount),r=u.AD_Window_ID),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){!function(i,c,u){n.find("#VAS_DeliveryContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var d='<div id="VAS_ProductContainer_'+l+'" class="VAS-deliveries-container"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-deliveries-heading">        <h6>            <span id="VAS_BackTodelivery_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToDeliveries")+'        </h6><span id="VAS_GenerateDeliveryOrder_'+l+'" class="VAS-generate-delivery-btn" data-orderid="'+u+'" title="'+VIS.Msg.getMsg("VAS_GenerateDeliverOrder")+'"><i class="fa fa-truck" aria-hidden="true"></i></span>    </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading VAS-orders-text-white">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text VAS-orders-text-white" aria-hidden="true"></i>                    <div class="VAS-doc-no VAS-orders-text-white" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>                <div class="VAS-expectedTxt" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+c+'</div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count VAS-orders-text-white"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(d);var g=s[i]||[],p=6,v=Math.ceil(g.length/p),_=1;function V(e){e<1&&(e=1),e>v&&(e=v);var t=((_=e)-1)*p,a=Math.min(t+p,g.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s,r=g[i],c=o.includes(r.C_OrderLine_ID),u="I"!=r.ProductType||r.OnHandQty>0&&r.OnHandQty>=r.QtyOrdered,d=u?"VAS-delivery-box":"VAS-delivery-box no-stock";s="I"!=r.ProductType||r.OnHandQty>=r.QtyOrdered?"badge-green":r.OnHandQty<r.QtyOrdered&&r.OnHandQty>0?"badge-orange":"badge-red",n.find("#VAS_OrderLine_"+l).append('            <div class="'+d+'">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-orderlineid="'+r.C_OrderLine_ID+'"'+(c?" checked":"")+(u?"":" disabled")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+r.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count">                    <span title = "'+VIS.Msg.getMsg("VAS_RemianingQty")+'" class="badge badge-light '+s+'"> '+r.QtyEntered+'</span ></div >                       </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+r.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+r.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(g.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details VAS-orders-text-white">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+_+VIS.Msg.getMsg("VAS_Of")+v+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}g.length>0&&V(_);function A(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateShipment",data:{C_Order_ID:i,C_OrderLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).Shipment_ID>0)try{if(r>0){var i={TabWhereClause:"M_InOut.M_InOut_ID="+t.Shipment_ID,TabLayout:"Y",TabIndex:"0"};a.widgetFirevalueChanged(i),a.currentPage=1,a.intialLoad(a.currentPage)}}catch(e){console.log(e)}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_DeliveryOrderNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}}),console.log("Generating delivery order for ID:",i)}n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackTodelivery_"+l),n.off("click","#VAS_GenerateDeliveryOrder_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){V(_-1)}),n.on("click","#VAS_NextPage_"+l,function(){V(_+1)}),n.on("click","#VAS_BackTodelivery_"+l,function(){n.find("#VAS_DeliveryContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("orderlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateDeliveryOrder_"+l).show():n.find("#VAS_GenerateDeliveryOrder_"+l).hide(),console.log(o)}),n.on("click","#VAS_GenerateDeliveryOrder_"+l,function(){A(t(this).data("orderid"))}),n.find("#VAS_GenerateDeliveryOrder_"+l).hide()}(t(this).data("doc-no"),t(this).data("customer-name"),t(this).data("orderid"))})}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_ExpectedDeliveryWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_ExpectedDeliveryWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_ExpectedDeliveryWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_ExpectedDeliveryWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_ExpectedDeliveryWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_ExpectedDeliveryWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},4943:()=>{VAS=window.VAS||{},VAS.Model=window.VAS.Model||{},function(e){VIS.Logging.Level,VIS.Utility.Util;function t(){VIS.CalloutEngine.call(this,"CalloutTerm")}VIS.Utility.inheritPrototype(t,VIS.CalloutEngine),t.prototype.SetTermDescription=function(e,t,a,i,n,l){if(this.isCalloutActive()||null==n||""==n.toString())return"";try{this.setCalloutActive(!0);var s=VIS.dataContext.getJSONRecord("VAS/MTerm/GetTermDescription",n);a.setValue("VAS_TermDescription",s)}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),""},e.Model.VAS_CalloutTerm=t}(VAS,jQuery)},5024:()=>{VAS=window.VAS||{},function(e,t){e.InvoiceTaxTabPanel=function(){this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var a=null,n=this.ctx,l=this;e.translatedTexts=VIS.Msg.translate(n,["VAS_InvoiceTaxTitleTabPanel","VAS_InvoiceTax","VAS_InvoiceTaxPaybaleAmt","VAS_InvoiceTaxAmt","VAS_IsIncludeTax"],!0);var s=t('<div class = "root"></div>'),o=t("<div class ='vas-apTaxWrapper'></div>");a=t("<h6 class='vas-apTax-ttl'>"+e.translatedTexts.VAS_InvoiceTaxTitleTabPanel+"</h6>"),this.init=function(){o.append(a),o.append('<div class="vas-aptaxListGroup"><div id="VAS-TaxDetail_'+l.windowNo+'" class= "VAS-TaxDetail mb-2" > </div></div>'),s.append(o)},this.getInvoiceTaxData=function(a){t.ajax({url:VIS.Application.contextUrl+"VAS/PoReceipt/GetTaxData",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{InvoiceId:a},success:function(t){if(o.find("#VAS-TaxDetail_"+l.windowNo).empty(),""!=JSON.parse(t)&&(t=JSON.parse(t),console.log(t),null!=t&&t.length>0))for(i=0;i<t.length;i++){var a='<div class="vas-apListItem mb-2"><div class="vas-ap-sglItem mb-2"><div class="vas-singleTaxElement vas-setTaxWidth"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_InvoiceTax+'</span><span class="vas-singleTaxElementValue">'+t[i].TaxName+'</span></div><div class="vas-singleTaxElement vas-setTaxPaybleAmtWidth"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_InvoiceTaxPaybaleAmt+'</span><span class="vas-singleTaxElementValue">'+t[i].TaxPaybleAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:t[i].stdPrecision,maximumFractionDigits:t[i].stdPrecision})+'</span></div><div class="vas-singleTaxElement vas-setTaxAmtWidth"><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_InvoiceTaxAmt+'</span><span class="vas-singleTaxElementValue">'+t[i].TaxAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:t[i].stdPrecision,maximumFractionDigits:t[i].stdPrecision})+'</span></div></div ><div class="vas-apItem-checkbox d-flex align-items-center"><input type="checkbox" id="vas-includeTaxCheckbox" '+("Y"==t[i].IsTaxIncluded?"checked":"")+'><label class="vas-apcheckbox-label ml-1" for="vas-includeTaxCheckbox">'+e.translatedTexts.VAS_IsIncludeTax+"</label></div></div>";o.find("#VAS-TaxDetail_"+l.windowNo).append(a)}},error:function(e){console.log(e)}})},this.getRoot=function(){return s},e.InvoiceTaxTabPanel.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,l.windowNo=e,this.init()},e.InvoiceTaxTabPanel.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.getInvoiceTaxData(e)},e.InvoiceTaxTabPanel.prototype.sizeChanged=function(e){this.panelWidth=e},e.InvoiceTaxTabPanel.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,a=null}}}(VAS,jQuery)},5068:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutCheckInOut")}a.prototype.TypeSelection=function(e,a,i,n,l,s){if(null==l||""==l.toString())return"";var o=t.getValueOfBoolean(l);return null==o||(1==o?i.setValue("flag1",!0):i.setValue("flag1",!1),i=l=null),""},a.prototype.RecordSort=function(e,a,i,n,l,s){if(null==l||""==l.toString())return"";var o=t.getValueOfBoolean(l);return null==o||(1==o?i.setValue("flag2",!0):i.setValue("flag2",!1),i=l=null),""},a.prototype.EndDate=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r=t.getValueOfDateTime(s);if(null==r||r.equals(0))return"";t.getValueOfDateTime(s);var c=t.getValueOfDateTime(n.getValue("DATE_FROM"));try{t.getValueOfDateTime(n.getValue("TILL_DATE")).compareTo(c)<0&&(e.ADialog.info("EndAndStartDate"),n.setValue("TILL_DATE",c))}catch(e){this.setCalloutActive(!1)}return n=s=null,""},a.prototype.StartDate=function(e,a,i,n,l,s){if(null==l||""==l.toString())return"";var o=t.getValueOfDateTime(l);if(null==o||o.equals(0))return"";var r=t.getValueOfDateTime(i.getValue("DATE_FROM")),c=t.getValueOfDateTime(i.getValue("TILL_DATE"));try{(r=t.getValueOfDateTime(i.getValue("DATE_FROM"))).compareTo(c)>0&&i.setValue("TILL_DATE",r)}catch(e){this.setCalloutActive(!1)}return i=l=null,""},e.Model.CalloutCheckInOut=a}(VIS,jQuery)},5116:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.CalloutInvoiceBatch")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.Date=function(e,t,a,i,n,l){return null==n||""==n.toString()||(a.setValue("DateAcct",n),this.SetDocumentNo(e,t,a),e=t=a=n=null),""},i.prototype.BPartner=function(t,i,n,l,s,o){if(null==s||""==s.toString())return"";var r=a.getValueOfInt(s);if(null==r||0==r)return"";var c=t.isSOTrx(),u=null;try{var d=(!0).toString()+","+r.toString();if(null!=(u=e.dataContext.getJSONRecord("MBPartner/GetBPartnerData",d))){var g=a.getValueOfString(u[c?"PaymentRule":"PaymentRulePO"]);null!=g&&0!=g.length&&(t.getContext("DocBaseType").endsWith("C")||this.isSOTrx&&"S"==g||"U"==g)&&(g="P");var p=a.getValueOfInt(u[c?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"]);p>0&&n.setValue("C_PaymentTerm_ID",p);var v=a.getValueOfInt(u.C_BPartner_Location_ID);if(r.toString().equals(t.getWindowTabContext(i,e.EnvConstants.TAB_INFO,"C_BPARTNER_ID").toString())){var _=t.getWindowTabContext(i,e.EnvConstants.TAB_INFO,"C_BPARTNER_LOCATION_ID");_.toString().length>0&&(v=a.getValueOfInt(_))}0==v?n.setValue("C_BPartner_Location_ID",null):n.setValue("C_BPartner_Location_ID",a.getValueOfInt(v));var V=a.getValueOfInt(u.AD_User_ID);if(r.toString().equals(t.getContext("C_BPartner_ID"))){var A=t.getContext("AD_User_ID");A.toString().length>0&&(V=a.getValueOfInt(A))}if(0==V?n.setValue("AD_User_ID",null):n.setValue("AD_User_ID",a.getValueOfInt(V)),c)if(0!=a.getValueOfDouble(u.SO_CreditLimit)){var m=a.getValueOfDouble(u.CreditAvailable);null==u&&m<0&&e.ADialog.info("CreditLimitOver")}}}catch(e){return this.setCalloutActive(!1),e.message}return this.SetDocumentNo(t,i,n),this.Tax(t,i,n,l,s)},i.prototype.DocType=function(e,t,a,i,n,l){return this.SetDocumentNo(e,t,a),e=t=a=null,""},i.prototype.SetDocumentNo=function(t,i,n,l,s,o){var r,c=t.getContextAsInt(i,"C_InvoiceBatch_ID").toString();if(null!=(r=e.dataContext.getJSONRecord("MInvoiceBatchLine/GetInvoiceBatchLineDetail",c))){var u=t.getContextAsInt(i,"C_DocType_ID"),d=t.getContextAsInt(i,"C_BPartner_ID");if(u!=r.C_DocType_ID||d!=r.C_BPartner_ID){var g=r.DocumentNo;if(null!=g){var p;if(0!=(p=a.getValueOfInt(g))){var v=a.getValueOfString(p+1);n.setValue("DocumentNo",v),t=i=n=null}}}}},i.prototype.Charge=function(i,n,l,s,o,r){if(null==o||""==o.toString())return"";var c=a.getValueOfInt(o);if(null==c||0==a.getValueOfInt(c))return"";try{var u=e.dataContext.getJSONRecord("MCharge/GetCharge",c.toString());l.setValue("PriceEntered",a.getValueOfDecimal(u))}catch(e){return this.setCalloutActive(!1),this.log.log(t.severe,null,e),e.message}return this.Tax(i,n,l,s,o)},i.prototype.Tax=function(t,i,n,l,s,o){var r=l.getColumnName();if(null==s||""==s.toString())return"";var c=0;if(c=r.equals("C_Charge_ID")?a.getValueOfInt(s):t.getContextAsInt(i,"C_Charge_ID"),this.log.fine("C_Charge_ID="+c),0==c)return this.Amt(t,i,n,l,s);var u=t.getContextAsInt(i,"C_BPartner_Location_ID");if(0==u)return this.Amt(t,i,n,l,s);this.log.fine("BP_Location="+u);var d=a.getValueOfDate(t.getContext("DateInvoiced"));this.log.fine("Bill Date="+d);var g=d;this.log.fine("Ship Date="+g);var p=t.getContextAsInt(i,"AD_Org_ID");this.log.fine("Org="+p);var v=t.getContextAsInt("#M_Warehouse_ID");this.log.fine("Warehouse="+v);var _=c.toString().concat(",",d.toString(),g.toString(),",",p.toString(),",",v.toString(),",",u.toString(),",",u.toString(),",",t.getWindowContext(i,"IsSOTrx",!0).equals("Y")),V=e.dataContext.getJSONRecord("MTax/Get",_);return 0==V||n.setValue("C_Tax_ID",a.getValueOfInt(V)),this.Amt(t,i,n,l,s)},i.prototype.Amt=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);var r=t.getStdPrecision(),c=a.getValueOfDecimal(n.getValue("QtyEntered")),u=a.getValueOfDecimal(n.getValue("PriceEntered"));this.log.fine("QtyEntered="+c+", PriceEntered="+u),null==c&&(c=e.Env.ZERO),null==u&&(u=e.Env.ZERO);var d=c*u;a.scale(d)>r&&(d=d.toFixed(r));var g="Y"==t.getContext("IsTaxIncluded"),p=null;if(l.getColumnName().equals("TaxAmt"))p=n.getValue("TaxAmt");else{var v=n.getValue("C_Tax_ID");if(null!=v){var _=a.getValueOfInt(v).toString().concat(",",d.toString(),",",g.toString(),",",r.toString());p=e.dataContext.getJSONRecord("MTax/CalculateTax",_),n.setValue("TaxAmt",p),null!=n.getField("SurchargeAmt")&&n.setValue("SurchargeAmt",0)}}return g?(n.setValue("LineTotalAmt",d),n.setValue("LineNetAmt",a.getValueOfDecimal(d)*a.getValueOfDecimal(p))):(n.setValue("LineNetAmt",d),n.setValue("LineTotalAmt",a.getValueOfDecimal(d)+a.getValueOfDecimal(p))),this.setCalloutActive(!1),t=n=l=s=null,""},e.Model.CalloutInvoiceBatch=i}(VIS,jQuery)},5176:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutSetAttributeCode")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.FillAttribute=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";var r=a.getContext(i,"AttrCode");if((this.setCalloutActive(!0),null!=r&&""!=r)&&e.dataContext.getJSONRecord("MProduct/GetAttributeSet",s.toString())>0){var c=r.toString()+","+s.toString(),u=e.dataContext.getJSONRecord("MProduct/GetProductAttribute",c);if(u>0)n.setValue("M_AttributeSetInstance_ID",u);else if(r.indexOf("(01)")>=0){var d=r+","+t.getValueOfInt(s)+","+i,g=e.dataContext.getJSONRecord("MInOut/GetASIID",d);0!=g&&n.setValue("M_AttributeSetInstance_ID",g)}}return this.setCalloutActive(!1),""},a.prototype.FillUPC=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";var r=a.getContext(i,"AttrCode");if(this.setCalloutActive(!0),""!=t.getValueOfString(r)){if(e.dataContext.getJSONRecord("MProduct/GetManufacturer",r.toString())>0)return this.setCalloutActive(!1),e.Msg.getMsg("Attribute Code Already Exist");n.setValue("UPC",r)}return this.setCalloutActive(!1),""},e.Model.CalloutSetAttributeCode=a}(VIS,jQuery)},5209:()=>{VAS=window.VAS||{},function(e,t){e.VAS_InvoiceSummary=function(){this.windowNo,this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;this.ctx;var a=this,n=t('<div class="root"></div>'),l=null;this.init=function(){l=t('<div class ="vas-apTaxWrapper"><div id="VAS-TaxDetail_'+a.windowNo+'" class="VAS-summary-details mb-2"></div></div>'),n.append(l)},this.getInvoiceSummary=function(e){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetTaxData",{InvoiceID:e},function(e){if(l.find("#VAS-TaxDetail_"+a.windowNo).empty(),null!=e&&e.length>0){for(l.find("#VAS-TaxDetail_"+a.windowNo).append(t('<div class="VAS-summary-header"><span class="">'+VIS.Msg.getMsg("VAS_SubTotal")+":</span></div>")),l.find("#VAS-TaxDetail_"+a.windowNo).append(t('<div class="VAS-summary-info"><span class="VAS-summary-amount" style="font-weight: 600;">'+e[0].CurSymbol+" "+e[0].TotalLines.toLocaleString(window.navigator.language,{minimumFractionDigits:e[0].stdPrecision,maximumFractionDigits:e[0].stdPrecision})+"</span></div>")),i=0;i<e.length;i++)l.find(".VAS-summary-header").append('<span class="">'+VIS.Utility.encodeText(e[i].TaxName)+":</span>"),l.find(".VAS-summary-info").append('<span class="VAS-summary-amount">'+e[0].CurSymbol+" "+e[i].TaxAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:e[0].stdPrecision,maximumFractionDigits:e[0].stdPrecision})+"</span>");0!=e[0].TCSAmount&&(l.find(".VAS-summary-header").append('<span class="">'+VIS.Msg.getMsg("VAS_TCSTotal")+":</span>"),l.find(".VAS-summary-info").append('<span class="VAS-summary-amount">'+e[0].CurSymbol+" "+e[0].TCSAmount.toLocaleString(window.navigator.language,{minimumFractionDigits:e[0].stdPrecision,maximumFractionDigits:e[0].stdPrecision})+"</span>")),l.find(".VAS-summary-header").append('<span class="">'+VIS.Msg.getMsg("GrandTotal")+":</span>"),l.find(".VAS-summary-info").append('<span class="VAS-summary-amount" style="font-weight: 600;font-size: 1rem;border-top: 1px solid rgba(var(--v-c-on-secondary), 1);">'+e[0].CurSymbol+" "+e[0].GrandTotal.toLocaleString(window.navigator.language,{minimumFractionDigits:e[0].stdPrecision,maximumFractionDigits:e[0].stdPrecision})+"</span>")}})},this.getRoot=function(){return n},e.VAS_InvoiceSummary.prototype.startPanel=function(e,t){a.windowNo=e,a.curTab=t,a.init()},e.VAS_InvoiceSummary.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.getInvoiceSummary(e)},e.VAS_InvoiceSummary.prototype.sizeChanged=function(e){this.panelWidth=e},e.VAS_InvoiceSummary.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null}}}(VAS,jQuery)},5239:()=>{VIS=window.VIS||{},function(e,t){e.CreateRelatedLines=function(){var a;this.frame,this.windowNo,this.Record_ID,this.Table_ID;var i,n,l,s,o,r,c,u,d,g,p,v,_,V,A,m=this,f=t("<div>"),D=null,h=null,C=null,S=null,I=null,y=null,O=0,T="",w=0;e.translatedTexts=null;var P=e.DisplayType.GetNumberFormat(e.DisplayType.Amount),b=e.Env.isDecimalPoint();function M(e){null!=e&&v.add(e),x(O,0,0,w)}function x(t,a,i,n){e.dataContext.getJSONData(e.Application.contextUrl+"RelatedProduct/GetRelatedProduct",{M_Product_ID:t,M_AttributeSetInstance_ID:a,C_UOM_ID:i,M_PriceList_ID:n,RelatedProductType:T,Table_ID:m.Table_ID,Record_ID:m.Record_ID},N)}function N(e){if(null!=e&&V.add(e),V.records.length>0)for(var i=0;i<V.records.length;i++)"M"==V.records[i].RelatedProductType&&t(t("#grid_"+V.name+"_rec_"+(i+1)).find("input[type=checkbox]")).prop("checked",!0).attr("disabled",!0);a[0].style.visibility="hidden"}function L(){(s=[]).push({Product_ID:v.records[0].Product_ID,Product:v.records[0].Product,AttributeSetInstance_ID:v.records[0].M_AttributeSetInstance_ID,UOM_ID:v.records[0].UOM_ID,UOM:v.records[0].UOM_ID,RelatedProductType:v.records[0].RelatedProductType,RelatedType:v.records[0].RelatedType,Value:v.records[0].Value,QtyEntered:v.records[0].QtyEntered,PriceStd:v.records[0].PriceStd,PriceList:v.records[0].PriceList});for(var e=V.getSelection(),t=0;t<e.length;t++)s.push({Product_ID:V.records[e[t]-1].Product_ID,Product:V.records[e[t]-1].Product,AttributeSetInstance_ID:V.records[e[t]-1].M_AttributeSetInstance_ID,UOM_ID:V.records[e[t]-1].UOM_ID,UOM:V.records[e[t]-1].UOM_ID,RelatedProductType:V.records[e[t]-1].RelatedProductType,RelatedType:V.records[e[t]-1].RelatedType,Value:V.records[e[t]-1].Value,QtyEntered:V.records[e[t]-1].QtyEntered,PriceStd:V.records[e[t]-1].PriceStd,PriceList:V.records[e[t]-1].PriceList})}function R(t,a){var i=!1;if(t.value_new=e.Utility.Util.getValueOfString(a),t.value_new.contains(".")){i=!0;for(var n=[],l=0;l<t.value_new.length;l++)"."===t.value_new[l]&&n.push(l);n.length>1&&(t.value_new=U(t.value_new,"."))}if(t.value_new.contains(","))if(i)t.value_new=U(t.value_new,",");else{for(n=[],l=0;l<t.value_new.length;l++)","===t.value_new[l]&&n.push(l);n.length>1?t.value_new=U(t.value_new,","):t.value_new=t.value_new.replace(",",".")}return""==t.value_new&&(t.value_new="0"),t.value_new}function U(e,t){var a=e.split(t);return(e=a.slice(0,-1).join("")+"."+a.slice(-1)).indexOf(".")==e.length-1&&(e=e.replace(".","")),e}this.initalize=function(){e.translatedTexts=e.Msg.translate(e.Env.getCtx(),["RelatedProductType","M_Product_ID","SearchKeyValue","ASI","C_UOM_ID","QtyEntered","PriceActual","PriceList"],!0),f.append('<div class="VIS_Pref_show vis-formouterwrpdiv"><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="VIS_Product_'+m.windowNo+'" ></div></div><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap"><div class="vis-control-wrap" id="VIS_RelatedType_'+m.windowNo+'"><label class="VIS_Pref_Label_Font" > '+e.translatedTexts.RelatedProductType+"</label ></div></div></div></div>"),f.append('<div class="vis-crtfrm-datawrp" style="height: 15.5%;"><div id="VIS_ProductGrd_'+m.windowNo+'" style="height:80px;" ></div></div>'),f.append('<div class="vis-crtfrm-datawrp" style="height: 48.5%;"><div id="VIS_RelatedGrd_'+m.windowNo+'" style="height:250px;" ></div></div>'),f.append('<div class="vis-ctrfrm-btnwrp"><input id="VIS_CancelBtn_'+m.windowNo+'" class= "VIS_Pref_btn-2" type = "button" value = "'+e.Msg.getMsg("Cancel")+'"><input id="VIS_ApplyBtn_'+m.windowNo+'" class="VIS_Pref_btn-2" type="button" value="'+e.Msg.getMsg("Apply")+'"><input id="VIS_OKBtn_'+m.windowNo+'" class="VIS_Pref_btn-2" type="button" value="'+e.Msg.getMsg("OK")+'"></div>'),(a=t("<div class='vis-apanel-busy'>")).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),a[0].style.visibility="visible",f.append(a),a[0].style.visibility="visible"},this.intialLoad=function(){i=f.find("#VIS_OKBtn_"+m.windowNo),n=f.find("#VIS_ApplyBtn_"+m.windowNo),l=f.find("#VIS_CancelBtn_"+m.windowNo),r=f.find("#VIS_Product_"+m.windowNo),u=f.find("#VIS_RelatedType_"+m.windowNo),_=f.find("#VIS_ProductGrd_"+m.windowNo),A=f.find("#VIS_RelatedGrd_"+m.windowNo),function(){D=e.MLookupFactory.getMLookUp(e.Env.getCtx(),m.windowNo,10853,e.DisplayType.List),h=new e.Controls.VComboBox("RelatedProductType",!1,!1,!0,D,50),u.prepend(h.getControl()),o=e.MLookupFactory.getMLookUp(e.Env.getCtx(),m.windowNo,2221,e.DisplayType.Search),d=new e.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,e.DisplayType.Search,o);var a=t('<div class="vis-control-wrap">'),i=t('<div class="input-group-append">');r.append(a),a.append(d.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.M_Product_ID+"</label>"),r.append(i),i.append(d.getBtn(0)),i.append(d.getBtn(1)),e.Env.getCtx().setContext(m.windowNo,"M_Product_ID",null),c=new e.MPAttributeLookup(e.context,m.windowNo),g=new e.Controls.VPAttribute("M_AttributeSetInstance_ID",!1,!1,!0,e.DisplayType.PAttribute,c,m.windowNo,!1,!1,!1,!0),p=new e.Controls.VPAttribute("M_AttributeSetInstance_ID",!1,!1,!0,e.DisplayType.PAttribute,c,m.windowNo,!1,!1,!1,!0),C=e.MLookupFactory.getMLookUp(e.Env.getCtx(),m.windowNo,2222,e.DisplayType.TableDir),S=e.MLookupFactory.getMLookUp(e.Env.getCtx(),m.windowNo,2222,e.DisplayType.TableDir),I=new e.Controls.VComboBox("C_UOM_ID",!0,!1,!0,C,50),y=new e.Controls.VComboBox("C_UOM_ID",!0,!1,!0,S,50),e.Env.getCtx().getContextAsInt(m.windowNo,"C_BPartner_ID",!1),"Y"==e.Env.getCtx().getWindowContext(m.windowNo,"IsSOTrx",!0),w=e.Env.getCtx().getContextAsInt(m.windowNo,"M_PriceList_ID",!1)}(),d.fireValueChanged=function(){null!=d.value?(a[0].style.visibility="visible",O=d.value,v.clear(),V.clear(),function(t,a,i,n){e.dataContext.getJSONData(e.Application.contextUrl+"RelatedProduct/GetProductData",{M_Product_ID:t,M_AttributeSetInstance_ID:a,C_UOM_ID:i,M_PriceList_ID:n,Table_ID:m.Table_ID,Record_ID:m.Record_ID},M)}(O,0,0,w)):(O=0,v.clear(),V.clear())},h.fireValueChanged=function(e){a[0].style.visibility="visible",T=h.getValue(),V.clear(),x(O,0,0,w)},i.on("click touchstart",function(t){if(V.records.length>0)for(var i=0;i<V.records.length;i++)"M"==V.records[i].RelatedProductType&&V.select(i+1);v.records.length>0?(a[0].style.visibility="visible",L(),CreateLines(!1)):e.ADialog.error("VIS_PlzSelLines")}),n.on("click touchstart",function(t){if(V.records.length>0)for(var i=0;i<V.records.length;i++)"M"==V.records[i].RelatedProductType&&V.select(i+1);v.records.length>0?(a[0].style.visibility="visible",L(),CreateLines(!0)):e.ADialog.error("VIS_PlzSelLines")}),l.on("click touchstart",function(e){m.frame.close()}),a[0].style.visibility="hidden"},this.LoadProductGrid=function(){v=null,(v=_.w2grid({name:"VIS_ProductGrid_"+m.windowNo,recordHeight:25,show:{toolbar:!1,selectColumn:!1,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!0,toolbarSave:!0},multiSelect:!0,columns:[{field:"Product_ID",caption:e.translatedTexts.M_Product_ID,size:"20%",display:!1},{field:"Value",caption:e.translatedTexts.SearchKeyValue,size:"150px"},{field:"Product",caption:e.translatedTexts.M_Product_ID,size:"200px"},{field:"M_AttributeSetInstance_ID",caption:e.translatedTexts.ASI,sortable:!1,size:"150px",editable:{type:"custom",ctrl:g,showAll:!0},render:function(e,t,a){var i,n=c,l=e.M_AttributeSetInstance_ID;return e.changes&&void 0!==e.changes.M_AttributeSetInstance_ID&&(l=e.changes.M_AttributeSetInstance_ID),n&&(i=n.getDisplay(l,!0)),i}},{field:"UOM_ID",caption:e.translatedTexts.C_UOM_ID,sortable:!1,size:"120px",editable:{type:"custom",ctrl:I,showAll:!0},render:function(e,t,a){var i,n=C,l=e.UOM_ID;return e.changes&&void 0!==e.changes.UOM_ID&&(l=e.changes.UOM_ID),n&&(i=n.getDisplay(l)),i}},{field:"UOM",caption:e.translatedTexts.C_UOM_ID,size:"20%",display:!1},{field:"QtyEntered",caption:"<div ><span>"+e.translatedTexts.QtyEntered+"</span></div>",sortable:!1,size:"120px",min:80,hidden:!1,editable:{type:"number"},render:function(e,t,a){var i=e.QtyEntered;return i=R(event,i),parseFloat(i).toLocaleString()}},{field:"PriceStd",caption:"<div ><span>"+e.translatedTexts.PriceActual+"</span></div>",sortable:!1,size:"120px",min:80,hidden:!1,editable:{type:"number"},render:function(e,t,a){var i=e.PriceStd;return i=R(event,i),parseFloat(i).toLocaleString()}},{field:"PriceList",caption:"<div ><span>"+e.translatedTexts.PriceList+"</span></div>",sortable:!1,size:"120px",min:80,hidden:!1,editable:{type:"number"},render:function(e,t,a){var i=e.PriceList;return i=R(event,i),parseFloat(i).toLocaleString()}}],onEditField:function(e){if(id=e.recid,6==e.column||7==e.column||8==e.column){v.records[e.index][v.columns[e.column].field]=R(e,v.records[e.index][v.columns[e.column].field]);var a=P.GetFormatAmount(v.records[e.index][v.columns[e.column].field],"init",b);v.records[e.index][v.columns[e.column].field]=P.GetConvertedString(a,b),t("#grid_VIS_ProductGrid_"+m.windowNo+"_rec_"+id).keydown(function(e){return!!(b||190!=e.keyCode&&110!=e.keyCode)&&((!b||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which?!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||e.target.value.indexOf(",")>-1&&(e.target.value=e.target.value.replace(",","")):e.target.value.indexOf(".")>-1&&(e.target.value=e.target.value.replace(".","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))})}},onChange:function(t){if(8==t.column){var a=P.GetConvertedNumber(t.value_new,b);v.records[t.index].PriceList=a.toFixed(2)}else if(7==t.column){a=P.GetConvertedNumber(t.value_new,b);v.records[t.index].PriceStd=a.toFixed(2)}else if(6==t.column){a=P.GetConvertedNumber(t.value_new,b);v.records[t.index].QtyEntered=a.toFixed(2)}else 3==t.column?null!=t.value_new&&(v.records[t.index].M_AttributeSetInstance_ID=t.value_new,e.dataContext.getJSONData(e.Application.contextUrl+"RelatedProduct/GetProductData",{M_Product_ID:O,M_AttributeSetInstance_ID:t.value_new,C_UOM_ID:e.Utility.Util.getValueOfInt(v.records[t.index].UOM_ID),M_PriceList_ID:w,Table_ID:m.Table_ID,Record_ID:m.Record_ID},function(e){null!=e&&(v.records[t.index].PriceStd=e.PriceStd,v.records[t.index].PriceList=e.PriceList,v.refreshCell(t.recid,"PriceStd"),v.refreshCell(t.recid,"PriceList"))})):4==t.column&&null!=t.value_new&&(v.records[t.index].UOM_ID=t.value_new,e.dataContext.getJSONData(e.Application.contextUrl+"RelatedProduct/GetProductData",{M_Product_ID:O,M_AttributeSetInstance_ID:e.Utility.Util.getValueOfInt(v.records[t.index].M_AttributeSetInstance_ID),C_UOM_ID:t.value_new,M_PriceList_ID:w,Table_ID:m.Table_ID,Record_ID:m.Record_ID},function(e){null!=e&&(v.records[t.index].PriceStd=e.PriceStd,v.records[t.index].PriceList=e.PriceList,v.refreshCell(t.recid,"PriceStd"),v.refreshCell(t.recid,"PriceList"))}))},onClick:function(t){e.Env.getCtx().setContext(m.windowNo,"M_Product_ID",e.Utility.Util.getValueOfInt(v.records[t.recid-1].Product_ID))}})).hideColumn("Product_ID"),v.hideColumn("UOM")},this.LoadRelatedGrid=function(){V=null,(V=A.w2grid({name:"VIS_RelatedGrid_"+m.windowNo,recordHeight:25,show:{toolbar:!1,selectColumn:!0,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!0,toolbarSave:!0},multiSelect:!0,columns:[{field:"Product_ID",caption:e.translatedTexts.M_Product_ID,size:"20%",display:!1},{field:"Value",caption:e.translatedTexts.SearchKeyValue,size:"150px"},{field:"Product",caption:e.translatedTexts.M_Product_ID,size:"200px"},{field:"RelatedProductType",caption:e.translatedTexts.RelatedProductType,size:"150px"},{field:"RelatedType",caption:e.translatedTexts.RelatedProductType,size:"150px"},{field:"M_AttributeSetInstance_ID",caption:e.translatedTexts.ASI,sortable:!1,size:"150px",editable:{type:"custom",ctrl:p,showAll:!0},render:function(e,t,a){var i,n=c,l=e.M_AttributeSetInstance_ID;return e.changes&&void 0!==e.changes.M_AttributeSetInstance_ID&&(l=e.changes.M_AttributeSetInstance_ID),n&&(i=n.getDisplay(l,!0)),i}},{field:"UOM_ID",caption:e.translatedTexts.C_UOM_ID,sortable:!1,size:"100px",editable:{type:"custom",ctrl:y,showAll:!0},render:function(e,t,a){var i,n=S,l=e.UOM_ID;return e.changes&&void 0!==e.changes.UOM_ID&&(l=e.changes.UOM_ID),n&&(i=n.getDisplay(l)),i}},{field:"UOM",caption:e.translatedTexts.C_UOM_ID,size:"20%",display:!1},{field:"QtyEntered",caption:"<div ><span>"+e.translatedTexts.QtyEntered+"</span></div>",sortable:!1,size:"100px",min:80,hidden:!1,editable:{type:"number"},render:function(e,t,a){var i=e.QtyEntered;return i=R(event,i),parseFloat(i).toLocaleString()}},{field:"PriceStd",caption:"<div ><span>"+e.translatedTexts.PriceActual+"</span></div>",sortable:!1,size:"100px",min:80,hidden:!1,editable:{type:"number"},render:function(e,t,a){var i=e.PriceStd;return i=R(event,i),parseFloat(i).toLocaleString()}},{field:"PriceList",caption:"<div ><span>"+e.translatedTexts.PriceList+"</span></div>",sortable:!1,size:"100px",min:80,hidden:!1,editable:{type:"number"},render:function(e,t,a){var i=e.PriceList;return i=R(event,i),parseFloat(i).toLocaleString()}}],onUnselect:function(e){e.all?e.onComplete=function(){if(V.records.length>0)for(var e=0;e<V.records.length;e++)"M"==V.records[e].RelatedProductType&&t(t("#grid_"+V.name+"_rec_"+(e+1)).find("input[type=checkbox]")).prop("checked",!0).attr("disabled",!0)}:e.onComplete=function(){"M"==V.records[e.index].RelatedProductType&&t(t("#grid_"+V.name+"_rec_"+e.recid).find("input[type=checkbox]")).prop("checked",!0).attr("disabled",!0)}},onEditField:function(a){if(id=a.recid,8==a.column||9==a.column||10==a.column){V.records[a.index][V.columns[a.column].field]=R(a,V.records[a.index][V.columns[a.column].field]);var i=P.GetFormatAmount(V.records[a.index][V.columns[a.column].field],"init",b);V.records[a.index][V.columns[a.column].field]=P.GetConvertedString(i,b),t("#grid_VIS_RelatedGrid_"+m.windowNo+"_rec_"+id).keydown(function(e){return!!(b||190!=e.keyCode&&110!=e.keyCode)&&((!b||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which?!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||e.target.value.indexOf(",")>-1&&(e.target.value=e.target.value.replace(",","")):e.target.value.indexOf(".")>-1&&(e.target.value=e.target.value.replace(".","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))})}else 5==a.column&&e.Env.getCtx().setContext(m.windowNo,"M_Product_ID",e.Utility.Util.getValueOfInt(V.records[a.recid-1].Product_ID))},onChange:function(t){if(10==t.column){var a=P.GetConvertedNumber(t.value_new,b);V.records[t.index].PriceList=a.toFixed(2)}else if(9==t.column){a=P.GetConvertedNumber(t.value_new,b);V.records[t.index].PriceStd=a.toFixed(2)}else if(8==t.column){a=P.GetConvertedNumber(t.value_new,b);V.records[t.index].QtyEntered=a.toFixed(2)}else 5==t.column?null!=t.value_new&&(V.records[t.index].M_AttributeSetInstance_ID=t.value_new,e.dataContext.getJSONData(e.Application.contextUrl+"RelatedProduct/GetProductData",{M_Product_ID:V.records[t.index].Product_ID,M_AttributeSetInstance_ID:t.value_new,C_UOM_ID:e.Utility.Util.getValueOfInt(V.records[t.index].UOM_ID),M_PriceList_ID:w,Table_ID:m.Table_ID,Record_ID:m.Record_ID},function(e){null!=e&&(V.records[t.index].PriceStd=e.PriceStd,V.records[t.index].PriceList=e.PriceList,V.refreshCell(t.recid,"PriceStd"),V.refreshCell(t.recid,"PriceList"))})):6==t.column&&null!=t.value_new&&(V.records[t.index].UOM_ID=t.value_new,e.dataContext.getJSONData(e.Application.contextUrl+"RelatedProduct/GetProductData",{M_Product_ID:V.records[t.index].Product_ID,M_AttributeSetInstance_ID:e.Utility.Util.getValueOfInt(V.records[t.index].M_AttributeSetInstance_ID),C_UOM_ID:t.value_new,M_PriceList_ID:w,Table_ID:m.Table_ID,Record_ID:m.Record_ID},function(e){null!=e&&(V.records[t.index].PriceStd=e.PriceStd,V.records[t.index].PriceList=e.PriceList,V.refreshCell(t.recid,"PriceStd"),V.refreshCell(t.recid,"PriceList"))}))},onClick:function(t){e.Env.getCtx().setContext(m.windowNo,"M_Product_ID",e.Utility.Util.getValueOfInt(V.records[t.recid-1].Product_ID))}})).hideColumn("RelatedProductType"),V.hideColumn("Product_ID"),V.hideColumn("UOM")},CreateLines=function(i){t.ajax({url:e.Application.contextUrl+"RelatedProduct/SaveRelatedLines",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({Data:s,Table_ID:m.Table_ID,Record_ID:m.Record_ID}),success:function(t){""!=JSON.parse(t)&&(d.setValue(null,!1,!0),v.clear(),V.clear(),e.ADialog.info("",!0,JSON.parse(t),"")),a[0].style.visibility="hidden",i||m.frame.close()},error:function(){a[0].style.visibility="hidden"}})},this.getRoot=function(){return f}},e.CreateRelatedLines.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.Record_ID=this.frame.getRecord_ID(),this.Table_ID=this.frame.getAD_Table_ID(),this.initalize(),this.intialLoad(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.LoadProductGrid(),a.LoadRelatedGrid()},50),window.setTimeout(function(){},50)},e.CreateRelatedLines.prototype.setHeight=function(){return"575"},e.CreateRelatedLines.prototype.setWidth=function(){return"1050"},e.CreateRelatedLines.prototype.dispose=function(){w2ui["VIS_ProductGrid_"+this.windowNo].destroy(),w2ui["VIS_RelatedGrid_"+this.windowNo].destroy(),this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$OkBtn=null,$ApplyBtn=null,$root=null,_ProductLookUp=null,pattrLookup=null,puomLookup=null,pruomLookup=null,PUomCtrl=null,PRUomCtrl=null,_ProductCtrl=null,_CmbRelatedType=null,lookupRelatedType=null,ctrlRelatedType=null,PAttrCtrl=null,PRAttrCtrl=null,SelectedRecords=null}}(VIS,jQuery)},5290:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutProduction")}function i(){e.CalloutEngine.call(this,"VIS.CalloutProductionLine")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.Product=function(e,t,a,i,n,l){if(null==n||""==n.toString())return"";return null==n||0==n||(a.setValue("M_AttributeSetInstance_ID",null),a=n=null),""},a.prototype.SetAttributeSetInstance=function(t,a,i,n,l,s){if(null==l||""==l.toString()||this.isCalloutActive())return"";this.setCalloutActive(!0);try{var o=l.toString(),r=e.dataContext.getJSONRecord("MProductionLine/GetAttributeSetInstance",o);i.setValue("M_AttributeSetInstance_ID",r)}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),i=l=null,""},a.prototype.SetBOM=function(t,a,i,n,l,s){if(null==l||""==l.toString()||this.isCalloutActive())return"";this.setCalloutActive(!0);try{var o;n.getColumnName().equals("M_Product_ID")?(i.setValue("M_AttributeSetInstance_ID",0),o=l.toString().concat(",",0)):n.getColumnName().equals("M_AttributeSetInstance_ID")&&(o=i.getValue("M_Product_ID").toString().concat(",",l.toString()));var r=e.dataContext.getJSONRecord("MProductionLine/GetBOM",o);i.setValue("M_BOM_ID",r)}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),i=n=l=null,""},a.prototype.setQtyPrecision=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";if(this.setCalloutActive(!0),"BOMQty"==l.getColumnName()){var r=n.getValue("C_UOM_ID");paramStr=r.toString().concat(",");var c=e.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),u=t.getValueOfDecimal(s).toFixed(t.getValueOfInt(c));n.setValue("BOMQty",u)}else{var d=n.getValue("M_Product_ID");paramStr=d.toString().concat(",");c=e.dataContext.getJSONRecord("MProductionLine/GetPrecision",paramStr),u=t.getValueOfDecimal(s).toFixed(t.getValueOfInt(c));n.setValue("ProductionQty",u)}return this.setCalloutActive(!1),""},e.Model.CalloutProduction=a,e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.SetChargeAmount=function(t,a,i,n,l,s){if(null==l||""==l.toString())return"";this.setCalloutActive(!0);try{var o=l.toString(),r=e.dataContext.getJSONRecord("MProductionLine/GetChargeAmt",o);null!=r&&(i.setValue("Amt",r.ChargeAmt),i.setValue("M_Product_ID",null))}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),i=l=null,""},e.Model.CalloutProductionLine=i}(VIS,jQuery)},5375:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.CalloutPayment")}function n(t){var i=a.getValueOfInt(t.getValue("C_BankAccount_ID")),n=a.getValueOfInt(t.getValue("VA009_PaymentMethod_ID")),l=a.getValueOfString(t.getValue("CheckNo")),s=!1;if(i>0&&n>0&&""!=l&&"K"==a.getValueOfString(t.getValue("TenderType"))){var o=i.toString()+","+n.toString();s=a.getValueOfBoolean(e.dataContext.getJSONRecord("MPayment/GetAutoCheckControl",o.toString()))}t.setValue("IsOverrideAutoCheck",s)}function l(){e.CalloutEngine.call(this,"VIS.CalloutPaymentAllocate")}function s(){e.CalloutEngine.call(this,"VIS.CalloutPaymentTypeSO")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.BPartner=function(i,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString())return"";this.setCalloutActive(!0);try{var c=a.getValueOfString(l.getValue("C_DocType_ID")),u=o.toString()+","+c;dr=e.dataContext.getJSONRecord("MPayment/GetBPartnerDetail",u),null!=dr&&(l.setValue("C_BPartner_Location_ID",a.getValueOfInt(dr.C_BPartner_Location_ID)),dr.IsVA009ModuleInstall&&(a.getValueOfString(dr.IsSOTrx).equals("Y")?(l.setValue("VA009_PaymentMethod_ID",a.getValueOfInt(dr.VA009_PaymentMethod_ID)),l.setValue("TenderType",a.getValueOfString(dr.VA009_PaymentBaseType))):a.getValueOfString(dr.IsSOTrx).equals("N")?(l.setValue("VA009_PaymentMethod_ID",a.getValueOfInt(dr.VA009_PO_PaymentMethod_ID)),l.setValue("TenderType",a.getValueOfString(dr.PO_PaymentBaseType))):a.getValueOfInt(dr.VA009_PaymentMethod_ID)>0?(l.setValue("VA009_PaymentMethod_ID",a.getValueOfInt(dr.VA009_PaymentMethod_ID)),l.setValue("TenderType",a.getValueOfString(dr.VA009_PaymentBaseType))):a.getValueOfInt(dr.VA009_PO_PaymentMethod_ID)>0&&(l.setValue("VA009_PaymentMethod_ID",a.getValueOfInt(dr.VA009_PO_PaymentMethod_ID)),l.setValue("TenderType",a.getValueOfString(dr.PO_PaymentBaseType)))))}catch(e){return this.setCalloutActive(!1),this.log.log(t.SEVERE,"CalloutPayment.BPartner -"+o,e.message),e.toString()}return this.setCalloutActive(!1),l=o=null,""},i.prototype.Invoice=function(i,n,l,s,o,r){if(l.setValue("VAS_IsDiscountApplied",!1),null==o||""==o.toString())return"C_Invoice_ID"==s.getColumnName()&&(this.setCalloutActive(!0),l.setValue("C_InvoicePaySchedule_ID",null),l.setValue("PaymentAmount",e.Env.ZERO),l.setValue("PayAmt",e.Env.ZERO),l.setValue("DiscountAmt",e.Env.ZERO),l.setValue("WriteOffAmt",e.Env.ZERO),l.setValue("OverUnderAmt",e.Env.ZERO),this.setCalloutActive(!1)),"";var c=a.getValueOfInt(o.toString());if(this.isCalloutActive()||null==c||0==c)return"";this.setCalloutActive(!0),l.setValue("C_Order_ID",null),l.setValue("C_Charge_ID",null),l.setValue("IsPrepayment",!1),l.setValue("DiscountAmt",e.Env.ZERO),l.setValue("WriteOffAmt",e.Env.ZERO),l.setValue("IsOverUnderPayment",!1),l.setValue("OverUnderAmt",e.Env.ZERO);var u=0,d=!1,g=null!=l.getField("IsInDispute"),p=0,v=null;try{if(null!=(v=e.dataContext.getJSONRecord("MInvoice/GetInvPaySchedDetail",c.toString())))u=a.getValueOfInt(v.C_InvoicePaySchedule_ID),p=a.getValueOfDecimal(v.dueAmount),"Y"==a.getValueOfString(v.IsReturnTrx)&&(p*=-1),l.setValue("C_InvoicePaySchedule_ID",u),l.setValue("PayAmt",p),l.setValue("PaymentAmount",p),e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_").VA009_&&("B"!=a.getValueOfString(v.VA009_PaymentBaseType)&&"C"!=a.getValueOfString(v.VA009_PaymentBaseType)&&"P"!=a.getValueOfString(v.VA009_PaymentBaseType)?l.setValue("VA009_PaymentMethod_ID",a.getValueOfInt(v.VA009_PaymentMethod_ID)):l.setValue("VA009_PaymentMethod_ID",null))}catch(e){return this.setCalloutActive(!1),this.log.log(t.SEVERE,"CalloutPayment.Invoice -"+c,e.message),e.toString()}i.getContextAsInt(n,"C_Invoice_ID")==c&&0!=i.getContextAsInt(n,"C_InvoicePaySchedule_ID")&&(u=i.getContextAsInt(n,"C_InvoicePaySchedule_ID"));var _=l.getValue("DateTrx");null==_&&(_=new Date);var V=c.toString()+","+u.toString()+","+Globalize.format(a.getValueOfDate(_),"yyyy-MM-dd").toString(),A=null;try{if(null!=(A=e.dataContext.getJSONRecord("MPayment/GetInvoiceData",V))){l.setValue("C_BPartner_ID",a.getValueOfInt(A.C_BPartner_ID)),l.setValue("C_Bpartner_Location_Id",a.getValueOfInt(A.C_Bpartner_Location_Id));var m=a.getValueOfInt(A.C_Currency_ID);l.setValue("C_Currency_ID",m),l.setValue("C_ConversionType_ID",A.C_ConversionType_ID);var f=a.getValueOfDecimal(A.invoiceOpen);null==f&&(f=e.Env.ZERO);var D=a.getValueOfDecimal(A.invoiceDiscount);null==D&&(D=e.Env.ZERO),"Y"==A.IsReturnTrx&&(f>0&&(f*=-1),D>0&&(D*=-1)),l.setValue("PayAmt",f-D),l.setValue("PaymentAmount",f-D),l.setValue("C_InvoicePaySchedule_ID",u),l.setValue("DiscountAmt",D),i.setContext(n,"C_Invoice_ID",c.toString()),d="Y"==a.getValueOfString(A.IsInDispute),g&&(d?(l.setValue("IsInDispute",!0),e.ADialog.info("DiscrepancyInvoice")):l.setValue("IsInDispute",!1))}}catch(e){return this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),this.DocType(i,n,l,s,o)},i.prototype.Order=function(i,n,l,s,o,r){if(null==o||""==o.toString())return"";var c=o;if(this.isCalloutActive()||null==c||0==c)return"";this.setCalloutActive(!0),l.setValue("C_Invoice_ID",null),l.setValue("C_Charge_ID",null),l.setValue("IsPrepayment",!0),l.setValue("DiscountAmt",e.Env.ZERO),l.setValue("WriteOffAmt",e.Env.ZERO),l.setValue("IsOverUnderPayment",!1),l.setValue("OverUnderAmt",e.Env.ZERO);var u=l.getValue("DateTrx");null==u&&(u=new Date);var d=e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),g=d.VA009_+","+c.toString(),p=null;try{if(null!=(p=e.dataContext.getJSONRecord("MPayment/GetOrderData",g))){l.setValue("C_BPartner_ID",a.getValueOfInt(p.C_BPartner_ID)),l.setValue("C_Bpartner_Location_Id",a.getValueOfInt(p.C_BPartner_Location_ID)),l.setValue("C_Currency_ID",a.getValueOfInt(p.C_Currency_ID)),l.setValue("C_ConversionType_ID",a.getValueOfInt(p.C_ConversionType_ID));var v=a.getValueOfDecimal(p.GrandTotal);if(null==v&&(v=e.Env.ZERO),d.VA009_){var _=a.getValueOfInt(p.VA009_PaymentMethod_ID);l.setValue("VA009_PaymentMethod_ID",_)}l.setValue("PaymentAmount",v),l.setValue("PayAmt",v),1==p.IsPrePayOrder?l.getField("PaymentAmount").setReadOnly(!0):l.getField("PaymentAmount").setReadOnly(!1)}}catch(e){return null!=p&&(p=null),this.log.log(t.SEVERE,sql,e),this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),this.DocType(i,n,l,s,o)},i.prototype.Charge=function(e,t,a,i,n){if(null==n||""==n.toString())return""},i.prototype.DocType=function(t,i,n,l,s,o){var r=t.getContextAsInt(i,"C_Invoice_ID"),c=t.getContextAsInt(i,"C_Order_ID"),u=t.getContextAsInt(i,"C_DocType_ID");this.log.fine("Payment_DocType - C_Invoice_ID="+r+", C_DocType_ID="+u);var d=u.toString(),g=e.dataContext.getJSONRecord("MDocType/GetDocType",d),p=a.getValueOfBoolean(g.IsSOTrx);if(0!=u&&(t.setWindowContext(i,"IsSOTrx",p?"Y":"N"),n.setValue("IsReceipt",p?"Y":"N")),0!=r){d=r.toString();var v=e.dataContext.getJSONRecord("MInvoice/GetInvoice",d);if(null!=g&&a.getValueOfBoolean(v.IsSOTrx)!=p)return e.Msg.getMsg("DocTypeInvInconsistent")}if(0!=c){d=c.toString();var _=e.dataContext.getJSONRecord("MOrder/GetOrder",d);if(null!=g&&a.getValueOfBoolean(_.IsSOTrx)!=p)return e.Msg.getMsg("DocTypeOrdInconsistent")}return t=i=n=null,""},i.prototype.AmountCurrencyType=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return i.setValue("OutStandingAmount",""),"";this.setCalloutActive(!0);var o="",r=i.getValue("C_BPartner_ID"),c=i.getValue("AsOnDate");if(""==c||null==c||""==r||null==r)return i.setValue("OutStandingAmount",o),this.setCalloutActive(!1),"";var u="N,"+r.toString()+","+c.toString();try{o=e.dataContext.getJSONRecord("MPayment/GetOutStandingAmt",u),i.setValue("OutStandingAmount",o)}catch(e){this.setCalloutActive(!1)}return this.setCalloutActive(!1),""},i.prototype.Amounts=function(i,n,l,s,o,r){if(this.isCalloutActive())return"";var c=i.getContextAsInt(n,"C_Invoice_ID");if(0==i.getContextAsInt(n,"C_Payment_ID")&&0==i.getContextAsInt(n,"C_BPartner_ID")&&0==c)return"";var u=l.getValue("C_Currency_ID");if(null==u)return"";if(0!=c){this.setCalloutActive(!0);var d=s.getColumnName(),g=0;i.getContextAsInt(n,"C_Invoice_ID")==c&&null!=l.getValue("C_InvoicePaySchedule_ID")&&(g=l.getValue("C_InvoicePaySchedule_ID")),"DiscountAmt"==d&&l.setValue("VAS_IsDiscountApplied",!0);var p=e.Env.ZERO,v=e.Env.ZERO,_=0,V=0,A="N";if(0!=c){var m=l.getValue("DateTrx");null==m&&(m=new Date);var f=c.toString()+","+g.toString()+","+Globalize.format(a.getValueOfDate(m),"yyyy-MM-dd").toString(),D=e.dataContext.getJSONRecord("MPayment/GetInvoiceData",f);null!=D&&(_=a.getValueOfInt(D.C_Currency_ID),V=a.getValueOfInt(D.C_ConversionType_ID),null==(p=a.getValueOfDecimal(D.invoiceOpen))&&(p=e.Env.ZERO),v=a.getValueOfDecimal(D.invoiceDiscount),A=D.IsReturnTrx)}this.log.fine("Open="+p+" Discount= "+v+", C_Invoice_ID="+c+", C_Currency_ID="+_),"PaymentAmount"==d&&l.setValue("PayAmt",l.getValue("PaymentAmount")),l.getValue("VAS_IsDiscountApplied")||l.setValue("DiscountAmt",v);var h=a.getValueOfDecimal(null==l.getValue("PayAmt")?e.Env.ZERO:l.getValue("PayAmt")),C=a.getValueOfDecimal(null==l.getValue("WriteOffAmt")?e.Env.ZERO:l.getValue("WriteOffAmt")),S=a.getValueOfDecimal(null==l.getValue("OverUnderAmt")?e.Env.ZERO:l.getValue("OverUnderAmt")),I=a.getValueOfDecimal(null==l.getValue("DiscountAmt")?e.Env.ZERO:l.getValue("DiscountAmt"));"Y"==A?(h>0?(h*=-1,l.setValue("PayAmt",h),l.setValue("PaymentAmount",h)):l.setValue("PaymentAmount",h),I>0&&(I*=-1),v>0&&(v*=-1),C>0&&(C*=-1,l.setValue("WriteOffAmt",C)),S>0&&(S*=-1,l.setValue("OverUnderAmt",S)),p>0&&(p*=-1)):(h<0?(h*=-1,l.setValue("PayAmt",h),l.setValue("PaymentAmount",h)):l.setValue("PaymentAmount",h),I<0&&(I*=-1),v<0&&(v*=-1),C<0&&(C*=-1,l.setValue("WriteOffAmt",C)),S<0&&(S*=-1,l.setValue("OverUnderAmt",S)),p<0&&(p*=-1)),this.log.fine("Pay="+h+", Discount="+I+", WriteOff="+C+", OverUnderAmt="+S);var y=a.getValueOfInt(u),O=(f=y.toString(),(R=e.dataContext.getJSONRecord("MCurrency/GetCurrency",f)).StdPrecision),T=l.getValue("DateAcct"),w=0,P=a.getValueOfInt(l.getValue("C_ConversionType_ID"));null!=P&&(w=P);var b=i.getContextAsInt(n,"AD_Client_ID"),M=i.getContextAsInt(n,"AD_Org_ID"),x=e.Env.ONE;if(y>0&&_>0&&y!=_||"C_Currency_ID"==d||"C_ConversionType_ID"==d){this.log.fine("InvCurrency="+_+", PayCurrency="+y+", Date="+T+", Type="+w);var N=_+","+y+","+T+","+w+","+b+","+M;if(null==(x=e.dataContext.getJSONRecord("MConversionRate/GetRate",N))||0==x.toString()){if(this.setCalloutActive(!1),0==_)return"";if(l.setValue("C_Currency_ID",_),"C_ConversionType_ID"==d){if(0==V)return"";l.setValue("C_ConversionType_ID",V)}return"NoCurrencyConversion"}p=a.getValueOfDecimal((p*x).toFixed(R.StdPrecision)),0==I||(!l.getValue("VAS_IsDiscountApplied")||"C_Currency_ID"!=d&&"C_ConversionType_ID"!=d)&&l.getValue("VAS_IsDiscountApplied")||(I=a.getValueOfDecimal((I*x).toFixed(R.StdPrecision))),v=a.getValueOfDecimal((v*x).toFixed(R.StdPrecision)),this.log.fine("Rate="+x+", InvoiceOpenAmt="+p+", DiscountAmt="+v)}"C_Currency_ID"==d||"C_ConversionType_ID"==d?(l.setValue("VAS_IsDiscountApplied",!1),C=0,l.setValue("WriteOffAmt",C),S=0,l.setValue("OverUnderAmt",S),0!=(I=0)&&(v=I),l.setValue("DiscountAmt",v),h=p-v-C-S,l.setValue("PayAmt",a.getValueOfDecimal(h.toFixed(O))),l.setValue("PaymentAmount",a.getValueOfDecimal(h.toFixed(O)))):0==c?(e.Env.ZERO!=v&&l.setValue("DiscountAmt",e.Env.ZERO),e.Env.ZERO!=C&&l.setValue("WriteOffAmt",e.Env.ZERO),e.Env.ZERO!=S&&l.setValue("OverUnderAmt",e.Env.ZERO)):"PayAmt"==d||"PaymentAmount"==d?(0!=I&&(v=I),S=p-h-v-C,("N"==A&&S>0||"Y"==A&&S<0)&&e.ADialog.info("LessScheduleAmount"),("Y"==A&&S>0||"N"==A&&S<0)&&(e.ADialog.info("MoreScheduleAmount"),S=p-(h=p-v-C)-v-C,l.setValue("PayAmt",a.getValueOfDecimal(h.toFixed(O))),l.setValue("PaymentAmount",a.getValueOfDecimal(h.toFixed(O)))),l.setValue("DiscountAmt",a.getValueOfDecimal(v.toFixed(O))),l.setValue("OverUnderAmt",a.getValueOfDecimal(S.toFixed(O))),l.setValue("PayAmt",a.getValueOfDecimal(h.toFixed(O))),l.setValue("PaymentAmount",a.getValueOfDecimal(h.toFixed(O)))):(h=p-(v=I)-C-S,("Y"==A&&h>0||"N"==A&&h<0)&&(e.ADialog.info("MoreScheduleAmount"),"OverUnderAmt"==d&&(S=p-(h=p-v-C)-v-C),"DiscountAmt"==d&&(v=p-(h=p-S-C)-S-C),"WriteOffAmt"==d&&(C=p-(h=p-v-S)-v-S)),l.setValue("PayAmt",a.getValueOfDecimal(h.toFixed(O))),l.setValue("PaymentAmount",a.getValueOfDecimal(h.toFixed(O))),l.setValue("DiscountAmt",a.getValueOfDecimal(v.toFixed(O))),l.setValue("WriteOffAmt",a.getValueOfDecimal(C.toFixed(O))),l.setValue("OverUnderAmt",a.getValueOfDecimal(S.toFixed(O))),("N"==A&&S>0||"Y"==A&&S<0)&&e.ADialog.info("LessScheduleAmount")),this.setCalloutActive(!1)}else{this.setCalloutActive(!0);try{if((a.getValueOfInt(l.getValue("C_Order_ID"))>0&&0==a.getValueOfInt(l.getValue("VA009_OrderPaySchedule_ID"))||0==a.getValueOfInt(l.getValue("C_Order_ID"))&&0==a.getValueOfInt(l.getValue("VA009_OrderPaySchedule_ID"))&&0==a.getValueOfInt(l.getValue("C_Invoice_ID"))&&0==a.getValueOfInt(l.getValue("C_InvoicePaySchedule_ID")))&&l.setValue("PayAmt",a.getValueOfDecimal(l.getValue("PaymentAmount"))),e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA026_").VA026_&&"PaymentAmount"==s.getColumnName()){var L=e.dataContext.getJSONRecord("MDocType/GetDocType",l.getValue("C_DocType_ID"));if(!a.getValueOfBoolean(L.IsSOTrx)){O=(R=e.dataContext.getJSONRecord("MCurrency/GetCurrency",u)).StdPrecision;var R,U=a.getValueOfDecimal(l.getValue("PaymentAmount"))/a.getValueOfDecimal(l.getValue("VA026_Interest")/100+1).toString();l.setValue("VA026_InterestAmt",a.getValueOfDecimal(U.toFixed(O))),l.setValue("VA026_InterestAmount",a.getValueOfDecimal((l.getValue("PaymentAmount")-l.getValue("VA026_InterestAmt")).toFixed(O)))}}this.setCalloutActive(!1)}catch(e){return this.setCalloutActive(!1),this.log.log(t.SEVERE,sql,e),e}}return i=n=l=s=null,""},i.prototype.BankAccount=function(t,i,l,s,o,r){if(null==o||""==o.toString())return"";var c=o;if(this.isCalloutActive())return"";this.setCalloutActive(!0);try{var u=a.getValueOfInt(e.dataContext.getJSONRecord("MPayment/GetBankAcctCurrency",c.toString()));l.setValue("C_Currency_ID",u),n(l)}catch(e){return this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),l=o=null,""},i.prototype.SetOverrideAutoCheck=function(e,t,a,i,l,s){if(null==l||""==l.toString())return a.setValue("IsOverrideAutoCheck",!1),"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);try{n(a)}catch(e){return this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),a=l=null,""},i.prototype.ProvisionalInvoice=function(t,i,n,l,s,o){if(null==s||""==s.toString()||this.isCalloutActive())return"";this.setCalloutActive(!0);try{var r=e.dataContext.getJSONRecord("MPayment/GetProvisionalInvoiceData",a.getValueOfInt(n.getValue("C_ProvisionalInvoice_ID")));if(null!=r)n.setValue("C_BPartner_ID",r.C_BPartner_ID),n.setValue("C_BPartner_Location_ID",r.C_BPartner_Location_ID),n.setValue("PaymentAmount",r.GrandTotal),n.setValue("PayAmt",r.GrandTotal),n.setValue("C_Currency_ID",r.C_Currency_ID),n.setValue("C_ConversionType_ID",r.C_ConversionType_ID),e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_").VA009_}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),n=s=null,""},e.Model.CalloutPayment=i,e.Utility.inheritPrototype(l,e.CalloutEngine),l.prototype.Invoice=function(i,n,l,s,o,r){if(null==o||""==o.toString())return"C_Invoice_ID"==s.getColumnName()&&(this.setCalloutActive(!0),l.setValue("C_InvoicePaySchedule_ID",null),l.setValue("InvoiceAmt",e.Env.ZERO),l.setValue("Amount",e.Env.ZERO),l.setValue("DiscountAmt",e.Env.ZERO),l.setValue("WriteOffAmt",e.Env.ZERO),l.setValue("OverUnderAmt",e.Env.ZERO),this.setCalloutActive(!1)),"";var c=a.getValueOfInt(o);if(this.isCalloutActive()||null==c||0==c)return"";var u,d=i.getContextAsInt(n,"C_Payment_ID").toString();if(0!=(u=e.dataContext.getJSONRecord("MPayment/GetPayment",d)).C_Charge_ID||0!=u.C_Invoice_ID||0!=u.C_Order_ID)return e.Msg.getMsg("PaymentIsAllocated");this.setCalloutActive(!0),l.setValue("DiscountAmt",e.Env.ZERO),l.setValue("WriteOffAmt",e.Env.ZERO),l.setValue("OverUnderAmt",e.Env.ZERO);var g=0;i.getContextAsInt(n,"C_Invoice_ID")==c&&0!=i.getContextAsInt(n,"C_InvoicePaySchedule_ID")&&(g=i.getContextAsInt(n,"C_InvoicePaySchedule_ID"));var p=0,v=null;try{null!=(v=e.dataContext.getJSONRecord("MInvoice/GetInvPaySchedDetail",c))&&(g=a.getValueOfInt(v.C_InvoicePaySchedule_ID),p=a.getValueOfDecimal(v.dueAmount),IsReturnTrx=v.IsReturnTrx,"Y"==IsReturnTrx&&(p*=-1),l.setValue("C_InvoicePaySchedule_ID",g),l.setValue("Amount",p),1)}catch(e){return this.setCalloutActive(!1),this.log.log(t.SEVERE,"PaymentAllocate.Invoice -"+c,e.message),e.toString()}var _=a.getValueOfDate(i.getContextAsTime(n,"DateTrx"));null==_&&(_=new Date);d=c.toString()+","+g.toString()+","+Globalize.format(_,"yyyy-MM-dd").toString();var V=null;try{if(null!=(V=e.dataContext.getJSONRecord("MPayment/GetInvoiceData",d))){var A=a.getValueOfDecimal(V.invoiceOpen);null==A&&(A=e.Env.ZERO);var m=a.getValueOfDecimal(V.invoiceDiscount);null==m&&(m=e.Env.ZERO),"Y"==V.IsReturnTrx&&(A>0&&(A*=-1),m>0&&(m*=-1)),l.setValue("InvoiceAmt",A);var f=e.Env.ONE,D=a.getValueOfInt(V.C_Currency_ID),h=i.getContextAsInt(n,"C_Currency_ID"),C=i.getContextAsInt(n,"C_ConversionType_ID"),S=i.getContextAsInt(n,"AD_Client_ID"),I=i.getContextAsInt(n,"AD_Org_ID"),y=i.getContext(n,"DateAcct");if(h>0&&D>0&&h!=D){var O=D+","+h+","+y+","+C+","+S+","+I;if(null==(f=e.dataContext.getJSONRecord("MConversionRate/GetRate",O))||0==f)return l.setValue("Amount",0),l.setValue("DiscountAmt",0),this.setCalloutActive(!1),"NoCurrencyConversion";A=a.getValueOfDecimal(A*f),m=a.getValueOfDecimal(m*f)}l.setValue("Amount",A-m),l.setValue("DiscountAmt",m)}}catch(e){return this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),i=n=l=s=o=null,""},l.prototype.Amounts=function(t,i,n,l,s,o){if(this.isCalloutActive())return"";var r=n.getValue("C_Invoice_ID");if(0==r)return"";this.setCalloutActive(!0);var c=0;null!=n.getValue("C_InvoicePaySchedule_ID")&&(c=n.getValue("C_InvoicePaySchedule_ID"));var u=e.Env.ZERO,d="N",g=0,p=a.getValueOfDecimal(n.getValue("Amount")),v=a.getValueOfDecimal(n.getValue("DiscountAmt")),_=a.getValueOfDecimal(n.getValue("WriteOffAmt")),V=a.getValueOfDecimal(n.getValue("OverUnderAmt")),A=a.getValueOfDecimal(n.getValue("InvoiceAmt"));this.log.fine("Amt="+p+", Discount="+v+", WriteOff="+_+", OverUnder="+V+", Invoice="+A);var m=t.getContext(i,"DateTrx");null==m&&(m=new Date);var f=r.toString()+","+c.toString()+","+Globalize.format(m,"yyyy-MM-dd").toString(),D=e.dataContext.getJSONRecord("MPayment/GetInvoiceData",f);null!=D&&(g=a.getValueOfInt(D.C_Currency_ID),null==(u=a.getValueOfDecimal(D.invoiceOpen))&&(u=e.Env.ZERO),e.Env.ZERO==v&&(v=a.getValueOfDecimal(D.invoiceDiscount)),d=D.IsReturnTrx),"Y"==d?(p>0&&(p*=-1,n.setValue("Amount",p)),v>0&&(v*=-1),_>0&&(_*=-1,n.setValue("WriteOffAmt",_)),V>0&&(V*=-1,n.setValue("OverUnderAmt",V)),u>0&&(u*=-1)):(p<0&&(p*=-1,n.setValue("Amount",p)),v<0&&(v*=-1),_<0&&(_*=-1,n.setValue("WriteOffAmt",_)),V<0&&(V*=-1,n.setValue("OverUnderAmt",V)),u<0&&(u*=-1));var h=l.getColumnName(),C=(f=g.toString(),e.dataContext.getJSONRecord("MCurrency/GetCurrency",f).StdPrecision),S=t.getContextAsInt(i,"C_Currency_ID"),I=t.getContextAsInt(i,"C_ConversionType_ID"),y=t.getContextAsInt(i,"AD_Client_ID"),O=t.getContextAsInt(i,"AD_Org_ID"),T=t.getContext(i,"DateAcct");if(S>0&&g>0&&S!=g){var w=g+","+S+","+T+","+I+","+y+","+O;currencyRate=e.dataContext.getJSONRecord("MConversionRate/GetRate",w),u=a.getValueOfDecimal((u*currencyRate).toFixed(C)),"Amount"!=h&&(p=a.getValueOfDecimal((p*currencyRate).toFixed(C)))}return"Amount"==h?(V=u-p-v-_,("N"==d&&V>0||"Y"==d&&V<0)&&e.ADialog.info("LessScheduleAmount"),("Y"==d&&V>0||"N"==d&&V<0)&&(e.ADialog.info("MoreScheduleAmount"),V=u-(p=u-v-_)-v-_,n.setValue("Amount",p.toFixed(C))),n.setValue("DiscountAmt",v.toFixed(C)),n.setValue("OverUnderAmt",V.toFixed(C)),n.setValue("Amount",p.toFixed(C))):(p=u-v-_-V,("Y"==d&&p>0||"N"==d&&p<0)&&(e.ADialog.info("MoreScheduleAmount"),"OverUnderAmt"==h&&(V=u-(p=u-v-_)-v-_),"DiscountAmt"==h&&(v=u-(p=u-V-_)-V-_),"WriteOffAmt"==h&&(_=u-(p=u-v-V)-v-V)),n.setValue("Amount",p.toFixed(C)),n.setValue("DiscountAmt",v.toFixed(C)),n.setValue("WriteOffAmt",_.toFixed(C)),n.setValue("OverUnderAmt",V.toFixed(C)),("N"==d&&V>0||"Y"==d&&V<0)&&e.ADialog.info("LessScheduleAmount")),this.setCalloutActive(!1),t=i=n=l=null,""},e.Model.CalloutPaymentAllocate=l,e.Utility.inheritPrototype(s,e.CalloutEngine),s.prototype.SetPaymentType=function(e,t,a,i,n,l){if(this.isCalloutActive()||null==n||""==n.toString())return"";try{if(this.setCalloutActive(!0),"PaymentRule"==i.getColumnName())if(null==a.getValue("PaymentRule"))a.setValue("PaymentMethod",null);else{var s=a.getValue("PaymentRule");a.setValue("PaymentMethod",s)}}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),""},e.Model.CalloutPaymentTypeSO=s}(VIS,jQuery)},5390:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.CalloutMasterForecast")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.Currency=function(i,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString()||0==a.getValueOfInt(o))return null==l.getValue("M_PriceList_ID")&&l.setValue("C_Currency_ID",a.getValueOfInt(i.getContext("$C_Currency_ID"))),"";try{this.setCalloutActive(!0);var c=e.dataContext.getJSONRecord("MPriceList/GetPriceListData",a.getValueOfString(l.getValue("M_PriceList_ID")));null!=c.C_Currency_ID&&l.setValue("C_Currency_ID",c.C_Currency_ID)}catch(e){return this.log.log(t.SEVERE,sql,e),e.message}return this.setCalloutActive(!1),i=l=o=null,""},i.prototype.Product=function(i,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString()||0==a.getValueOfInt(o))return null==l.getValue("M_Product_ID")&&(l.setValue("Price",0),l.setValue("PlannedRevenue",0),l.setValue("ForcastQty",0),l.setValue("TotalQty",0)),"";try{if(this.setCalloutActive(!0),i.getContextAsInt(n,"M_PriceList_ID")>0){var c=e.dataContext.getJSONRecord("MCurrency/GetCurrency",a.getValueOfString(i.getContextAsInt(n,"C_Currency_ID"))),u=a.getValueOfString(l.getValue("M_Product_ID")).concat(",",a.getValueOfString(l.getValue("M_AttributeSetInstance_ID")),",",a.getValueOfString(i.getContextAsInt(n,"M_PriceList_ID")),",",a.getValueOfString(l.getValue("C_UOM_ID"))),d=e.dataContext.getJSONRecord("MProductPricing/GetProductdata",u);null!=d&&(l.setValue("Price",d.PriceStd),l.setValue("PlannedRevenue",(d.PriceStd*a.getValueOfDecimal(l.getValue("TotalQty"))).toFixed(a.getValueOfInt(c.StdPrecision))),0==a.getValueOfInt(l.getValue("C_UOM_ID"))&&l.setValue("C_UOM_ID",d.C_UOM_ID),l.findColumn("IsBOM")>0&&l.setValue("IsBOM",d.IsBOM));var g=e.dataContext.getJSONRecord("MTeamForcast/GetBOMdetails",a.getValueOfString(l.getValue("M_Product_ID")));null!=g&&(l.setValue("BOMUse",g.BOMUse),l.setValue("VAMFG_M_Routing_ID",g.VAMFG_M_Routing_ID),l.setValue("M_BOM_ID",g.M_BOM_ID))}}catch(e){return this.log.log(t.SEVERE,sql,e),e.message}return this.setCalloutActive(!1),i=n=l=o=null,""},i.prototype.CalculatePrice=function(i,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString()||a.getValueOfInt(o)<=0)return"";try{this.setCalloutActive(!0);var c=e.dataContext.getJSONRecord("MCurrency/GetCurrency",a.getValueOfString(i.getContextAsInt(n,"C_Currency_ID"))),u=a.getValueOfDecimal(l.getValue("ForcastQty"))+a.getValueOfDecimal(l.getValue("SalesOrderQty"))+a.getValueOfDecimal(l.getValue("OppQty"));l.setValue("TotalQty",u);var d=a.getValueOfDecimal(l.getValue("Price"))*a.getValueOfDecimal(l.getValue("TotalQty"));l.setValue("PlannedRevenue",d.toFixed(a.getValueOfInt(c.StdPrecision)))}catch(e){return this.log.log(t.SEVERE,sql,e),e.message}return this.setCalloutActive(!1),i=n=l=o=null,""},e.Model.CalloutMasterForecast=i}(VIS,jQuery)},5456:()=>{VAS=window.VAS||{},function(e,t){e.VAS_PendingGRNWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[],r=0;this.initalize=function(){const a='<div id="VAS_DeliveryContainer_'+(l=this.widgetInfo.AD_UserHomeWidgetID)+'" class="VAS-grn-container-pending">    <div class="VAS-deliveries-heading">        <h6>'+VIS.Msg.getMsg("VAS_PendingGRN")+'</h6>    </div>    <div class="VAS-delivery-count">        <div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_GRNCount")+' <span id="VAS_DeliveryCount_'+l+'">0</span></div>    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">        </div>    </div>    <div class="VAS-height-container">        <div id="VAS_DeliveryBox_'+l+'" class="VAS-deliveries-listing">        </div>        <div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing">        </div>    </div><div class="VAS-pagination-container"></div></div>';e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append(a)},this.intialLoad=function(c){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_DeliveryContainer_"+l).show(),t.ajax({url:VIS.Application.contextUrl+"Product/GetExpectedDelivery",data:{pageNo:c,pageSize:4,Type:"PG"},dataType:"json",success:function(u){u=JSON.parse(u);if(n.find("#VAS_DeliveryBox_"+l).empty(),n.find("#VAS_OrderContainer").remove,null!=u&&null!=u.Orders&&u.Orders.length>0){for(i=0;i<u.Orders.length;i++){var d='<div id="VAS_OrderContainer_'+l+'" class="VAS-delivery-box" >    <div class="VAS-box-heading">        <div class="VAS-icon-w-name">            <i class="fa fa-file-text" aria-hidden="true"></i>            <div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor"                 title="'+VIS.Msg.getMsg("Document_No")+'"                 data-doc-no="'+u.Orders[i].DocumentNo+'"                 data-customer-name="'+u.Orders[i].CustomerName+'"                 data-orderid="'+u.Orders[i].C_Order_ID+'">                '+u.Orders[i].DocumentNo+'            </div>        </div>        <div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+u.Orders[i].LineCount+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("Vendor")+'">'+u.Orders[i].CustomerName+'</div>    </div>    <div class="VAS-spaceBetween-col grid-2-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_VendorLocation")+'">'+u.Orders[i].DeliveryLocation+'</div>        <div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_ProductLocation")+'">'+u.Orders[i].ProductLocation+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+u.Orders[i].Symbol+"</span> "+u.Orders[i].GrandTotal.toLocaleString()+"</div>    </div></div>";n.find("#VAS_DeliveryBox_"+l).append(d)}s=[],u.Orders.forEach(function(e){e.OrderLines&&e.OrderLines.length>0&&(s[e.DocumentNo]=e.OrderLines)}),1==c&&(n.find("#VAS_DeliveryCount_"+l).text(u.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/4);var s=t('<div class="VAS-slider-arrows VAS-orders-text-white">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(u.RecordCount),r=u.AD_Window_ID),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){!function(i,c,u){n.find("#VAS_DeliveryContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var d='<div id="VAS_ProductContainer_'+l+'" class="VAS-grn-container-pending"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-deliveries-heading">        <h6>            <span id="VAS_BackTodelivery_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToGRN")+'        </h6><span id="VAS_GenerateGRN_'+l+'" class="VAS-generate-delivery-btn" data-orderid="'+u+'" title="'+VIS.Msg.getMsg("VAS_GenerateGRN")+'"><i class="vis vis-action" ></i ></span>     </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading VAS-orders-text-white">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text VAS-orders-text-white" aria-hidden="true"></i>                    <div class="VAS-doc-no VAS-orders-text-white" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>                <div class="VAS-expectedTxt" title="'+VIS.Msg.getMsg("Vendor")+'">'+c+'</div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count VAS-orders-text-white"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(d);var g=s[i]||[],p=6,v=Math.ceil(g.length/p),_=1;function V(e){e<1&&(e=1),e>v&&(e=v);var t=((_=e)-1)*p,a=Math.min(t+p,g.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s=g[i],r=o.includes(s.C_OrderLine_ID);n.find("#VAS_OrderLine_"+l).append('            <div class="VAS-delivery-box">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-orderlineid="'+s.C_OrderLine_ID+'"'+(r?" checked":"")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+s.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count"><span title="'+VIS.Msg.getMsg("VAS_RemianingQty")+'">'+s.QtyEntered+'</span></div>                </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+s.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+s.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(g.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details VAS-orders-text-white">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+_+VIS.Msg.getMsg("VAS_Of")+v+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}g.length>0&&V(_);function A(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateGRN",data:{C_Order_ID:i,C_OrderLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).Shipment_ID>0)try{if(r>0){var i={TabWhereClause:"M_InOut.M_InOut_ID="+t.Shipment_ID,TabLayout:"Y",TabIndex:"0"};a.widgetFirevalueChanged(i),a.currentPage=1,a.intialLoad(a.currentPage)}}catch(e){console.log(e)}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_DeliveryOrderNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}}),console.log("Generating delivery order for ID:",i)}n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackTodelivery_"+l),n.off("click","#VAS_GenerateGRN_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){V(_-1)}),n.on("click","#VAS_NextPage_"+l,function(){V(_+1)}),n.on("click","#VAS_BackTodelivery_"+l,function(){n.find("#VAS_DeliveryContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("orderlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateGRN_"+l).show():n.find("#VAS_GenerateGRN_"+l).hide(),console.log(o)}),n.on("click","#VAS_GenerateGRN_"+l,function(){A(t(this).data("orderid"))}),n.find("#VAS_GenerateGRN_"+l).hide()}(t(this).data("doc-no"),t(this).data("customer-name"),t(this).data("orderid"))})}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_PendingGRNWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_PendingGRNWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_PendingGRNWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_PendingGRNWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_PendingGRNWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_PendingGRNWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},5635:()=>{VAS=window.VAS||{},function(e,t){e.VAS_PurchaseStateDetailWidget=function(){var a;this.frame,this.windowNo;var i=this,n=t('<div class="h-100 w-100">'),l=t('<div class="vas-psdwidg-purchase-state-col">'),s=VIS.Env.getCtx(),o=null,r=null;this.initalize=function(){(a=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>')).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),a[0].style.visibility="visible",n.append(a),a[0].style.visibility="visible"};var c=['<i class="fa fa-hourglass-start"></i>','<i class="fa fa-hourglass-start"></i>','<i class="fa fa-handshake-o"></i>','<i class="fa fa-times"></i>','<i class="fa fa-check-square"></i>','<i class="vis vis-createdocumentx"></i>','<i class="vis vis-drafted"></i>'];function u(t,a){var i,n=t<0,l=Math.abs(t);return l>=1e12?(o=e.translatedTexts.VAS_Trillion,i=(l/1e12).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):l>=1e9?(o=e.translatedTexts.VAS_Billion,i=(l/1e9).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):l>=1e6?(o=e.translatedTexts.VAS_Million,i=(l/1e6).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):l>=1e3?(o=e.translatedTexts.VAS_Thousand,i=(l/1e3).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):(o="",i=l.toLocaleString(window.navigator.language,{minimumFractionDigits:a,maximumFractionDigits:a})),(n?"-":"")+i}this.intialLoad=function(){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetPurchaseStateDetail",{ISOtrx:VIS.Env.getCtx().isSOTrx(i.windowNo)},function(t){var d,g=t;if(null!=g&&g.length>0){d=["VAS_DueAmt","VAS_IPAmt","VAS_Drafted","VAS_IsHold","VAS_DueSoon","VAS_New","VAS_Disputed","VAS_Million","VAS_Trillion","VAS_UnAllocatedReceipt","VAS_Billion","VAS_Thousand","VAS_Purchase","VAS_State","VAS_Sale","VAS_SaleState"],e.translatedTexts=VIS.Msg.translate(s,d,!0),r=[e.translatedTexts.VAS_DueAmt,e.translatedTexts.VAS_DueSoon,e.translatedTexts.VAS_Disputed,1==VIS.Env.getCtx().isSOTrx(i.windowNo)?e.translatedTexts.VAS_UnAllocatedReceipt:e.translatedTexts.VAS_IsHold,e.translatedTexts.VAS_IPAmt,e.translatedTexts.VAS_New,e.translatedTexts.VAS_Drafted];var p='<div class="vas-psdwidg-whiteBoxhead vas-psdwidg-tile-heading vas-psdwidg-heading-item">';VIS.Env.getCtx().isSOTrx(i.windowNo)?p+="<h1><span>"+e.translatedTexts.VAS_Sale+"</span><span>"+e.translatedTexts.VAS_SaleState+"</span></h1>":p+='<h1 class="vas-psdwidg-stateheading"><span>'+e.translatedTexts.VAS_Purchase+"</span><span>"+e.translatedTexts.VAS_State+"</span></h1>",p+="</div>",l.append(p),l.append('<div class="vas-psdwidg-whiteBox vas-psdwidg-itme2"><div class="vas-psdwidg-totalSale">'+(3!=g[0].Symbol.length?'<span class="vas-vaswidg-Symbol">'+g[0].Symbol+"</span> ":"")+u(g[0].TotalAmt,g[0].stdPrecision)+'<span class="vas-psdwidg-unit">'+o+"</span>"+(3==g[0].Symbol.length?" "+g[0].Symbol:"")+'</div><div class="vas-psdwidg-icondiv">'+c[0]+'</div><div class="vas-psdwidg-salesYear"><span>'+r[0]+"</span></div>");for(var v=1;v<g.length;v++)"Hold"==g[v].Type||"UnAllocated"==g[v].Type?l.append('<div class="vas-psdwidg-whiteBox"><div class="vas-psdwidg-totalSale">'+(3!=g[v].Symbol.length?'<span class="vas-vaswidg-Symbol">'+g[v].Symbol+"</span> ":"")+u(g[v].TotalAmt,g[v].stdPrecision)+'<span class="vas-psdwidg-unit">'+o+"</span>"+(3==g[v].Symbol.length?" "+g[v].Symbol:"")+'</div><div class="vas-psdwidg-icondiv">'+c[v]+'</div><div class="vas-psdwidg-salesYear vas-expay-rtlHU"><span>'+r[v]+"</span></div>"):l.append('<div class="vas-psdwidg-whiteBox"><div class="vas-psdwidg-totalSale">'+(3!=g[v].Symbol.length?'<span class="vas-vaswidg-Symbol">'+g[v].Symbol+"</span> ":"")+u(g[v].TotalAmt,g[v].stdPrecision)+'<span class="vas-psdwidg-unit">'+o+"</span>"+(3==g[v].Symbol.length?" "+g[v].Symbol:"")+'</div><div class="vas-psdwidg-icondiv">'+c[v]+'</div><div class="vas-psdwidg-salesYear"><span>'+r[v]+"</span></div>");n.append(l)}a[0].style.visibility="hidden"})},this.getRoot=function(){return n},this.refreshWidget=function(){a[0].style.visibility="visible",l.empty(),i.intialLoad()}},e.VAS_PurchaseStateDetailWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad()},50)},e.VAS_PurchaseStateDetailWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_PurchaseStateDetailWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_PurchaseStateDetailWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},5648:()=>{!function(e){function t(){e.CalloutEngine.call(this,"VIS.CalloutBudget")}e.Utility.inheritPrototype(t,e.CalloutEngine),t.prototype.SetYearAndPeriodNull=function(e,t,a,i,n,l){if(this.isCalloutActive())return"";if(null==n||""==n.toString())return"";try{this.setCalloutActive(!0),"A"==a.getValue("BudgetControlBasis")?a.setValue("C_Period_ID",null):"P"==a.getValue("BudgetControlBasis")&&a.setValue("C_Year_ID",null)}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),a=n=null,""},e.Model.CalloutBudget=t}(VIS,jQuery)},5878:()=>{VAS=window.VAS||{},function(e,t){e.VAS_YearBasedExpenseData=function(){var e,a=0;this.frame,this.windowNo,this.widgetInfo;var i=this,n=null,l=null,s=t('<div class="h-100 w-100 vas-t10exp-background">'),o=[],r=[];this.initalize=function(){a=0!=VIS.Utility.Util.getValueOfInt(this.widgetInfo.AD_UserHomeWidgetID)?this.widgetInfo.AD_UserHomeWidgetID:i.windowNo,c(),(e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'))[0].style.visibility="visible",s.append(e),n=t('<div id="vas_pieChartExpense_'+a+'" class="vas-piechartexpense-container">');var u=t('<div class="d-flex justify-content-between vas-t10exp-div">'),d=t('<div class= "vas-t10exp-heading">'+VIS.Msg.getMsg("VAS_Top10Expenses")+"</div>");$DifferentYearDataListDiv=t('<div class="input-group vis-input-wrap">'),$DifferentYearDataListLookUp=VIS.MLookupFactory.get(VIS.Env.getCtx(),a,0,VIS.DisplayType.List,"VAS_DifferentYear",ColumnIds.AD_Reference_ID,!1,null),(l=new VIS.Controls.VComboBox("VAS_DifferentYear",!0,!1,!0,$DifferentYearDataListLookUp,20)).setValue("1");var g=t('<div class="vis-control-wrap">');$DifferentYearDataListDiv.append(g),g.append(l.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")),$DifferentYearDataListDiv.append(g),u.append(d).append($DifferentYearDataListDiv),n.append(u),s.append(n),l.fireValueChanged=function(){l.setValue(l.getValue()),e[0].style.visibility="visible",o=[],r=[],n.find("#vas_norecordcont_"+a).remove(),i.getExpenseDetails()}},this.getExpenseDetails=function(){e[0].style.visibility="visible",VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetTop10ExpenseAmountData",{ListValue:l.getValue()},function(i){var l=i;if(s.find("canvas").remove(),l.length>0){for(var c=l[0].stdPrecision,u=0;u<l.length;u++)0!=l[u].ExpenseAmount&&(o.push(l[u].ExpenseAmount),r.push(l[u].ExpenseName));const e=["rgba(255, 99, 132, 0.7)","rgba(54, 162, 235, 0.7)","rgba(255, 206, 86, 0.7)","rgba(75, 192, 192, 0.7)","rgba(153, 102, 255, 0.7)","rgba(255, 159, 64, 0.7)","rgba(0, 187, 0, 0.7)","rgba(255, 105, 180, 0.7)","rgba(100, 149, 237, 0.7)","rgba(124, 246, 0, 0.7)"],i={type:"doughnut",data:{labels:r,datasets:[{backgroundColor:e,data:o,borderColor:"rgba(0,0,0,0)",borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,radius:"80%",plugins:{legend:{display:!0,position:"right",labels:{generateLabels:function(t){return t.data.labels.map((t,a)=>({text:t,fillStyle:e[a]||"#000000",strokeStyle:"transparent",lineWidth:0}))},boxWidth:10}},tooltip:{enabled:!0,mode:"index",callbacks:{label:function(e){const t=e.dataIndex,a=e.datasetIndex,i=e.chart.data.datasets[a],n=e.chart.data.labels,l=i.data[t];return n[t]+": "+parseFloat(l).toLocaleString(window.navigator.language,{minimumFractionDigits:c,maximumFractionDigits:c})}}}}},plugins:[{beforeInit:function(e){const t=e.legend.fit;e.legend.fit=function(){t.bind(e.legend)(),this.height+=-10}}}]},n=t("<canvas></canvas>");n.attr("width",300),n.attr("height",300),s.find("#vas_pieChartExpense_"+a).append(n);const d=n[0].getContext("2d");new Chart(d,i),s.find("canvas").addClass("vas-t10exp-canvas")}else n.append('<div class="vas-igwidg-notfounddiv" id="vas_norecordcont_'+a+'">'+VIS.Msg.getMsg("VAS_RecordNotFound")+"</div>"),s.append(n);e[0].style.visibility="hidden"})};var c=function(){ColumnIds=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetColumnID",{refernceName:"VAS_DifferentYear"},null)};this.getRoot=function(){return s},this.refreshWidget=function(){e[0].style.visibility="visible",o=[],r=[],n.find("#vas_norecordcont_"+a).remove(),i.getExpenseDetails()}},e.VAS_YearBasedExpenseData.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.getExpenseDetails()},50)},e.VAS_YearBasedExpenseData.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_YearBasedExpenseData.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_YearBasedExpenseData.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},5924:()=>{VAS=window.VAS||{},function(e,t){e.VAS_BankBalanceWidget=function(){this.frame,this.windowNo;var e,a,i,n,l,s,o,r,c,u=this,d=0,g=4,p=[],v=null;function _(){i=e.find("#div_bankBal_widget_"+v),n=e.find("#VAS_divbankBody_"+v),e.find("#div_bankDetail_"+v),$nextArrowBank=e.find("#VAS_BankBalNextArrow_"+v),l=e.find("#VAS_BankBalPrevArrow_"+v),s=e.find("#VAS_PageInfo_"+v),o=e.find("#busyDivId_"+v),r=e.find("#div_noBankData_"+v),A(!0),t.ajax({url:VIS.Application.contextUrl+"VAS_PaymentWidget/GetBankBalance",dataType:"json",async:!0,success:function(e){var a="";null==(p=jQuery.parseJSON(e))||p.length<=0?(i.find(".VAS_noBankData").length>0&&i.find(".VAS_noBankData").remove(),a=t('<div class="VAS_noBankData" id="div_noBankData_'+v+'">'+VIS.Msg.getMsg("VAS_NoData")+"</div>"),i.append(a),i.css("height","100%"),r.show(),n.hide(),$nextArrowBank.addClass("disabled"),l.addClass("disabled")):V(),A(!1)},error:function(e){console.log(e),A(!1)}}),$nextArrowBank.on("click",function(e){A(!0),(d+1)*g<p.length&&(d++,V()),A(!1)}),l.on("click",function(e){A(!0),d>0&&(d--,V()),A(!1)}),c='<div class="VAS-bankBalDetail-box VAS-bankDummy-div"><div class="VAS-bankbal-name">-</div><div class="VAS-BankBaldata"><div class="VAS-bankbalISOCode">-</div> <div class="VAS-totalbankbal-amount">-</div></div></div>'}function V(){if(n.empty(),null!=p){var e=d*g,t=Math.min(e+g,p.length),a="<span>"+(d+1).toString()+" </span><span>"+VIS.Msg.getMsg("VAS_Of")+" </span><span>"+Math.ceil(p.length/g).toString()+"</span>";s.html(a);i.width();for(var o=e;o<t;o++)n.append('<div class="VAS-bankBalDetail-box" id="div_bankDetail_'+v+'"><div class="VAS-bankbal-name" title="'+p[o].Name+" - "+p[o].AccountNo+'">'+p[o].Name+" - "+p[o].AccountNo+'</div><div class="VAS-BankBaldata"><div class="VAS-bankbalISOCode">'+p[o].CurSymbol+'</div> <div class="VAS-totalbankbal-amount">'+p[o].EndingBalance.toLocaleString(window.navigator.language,{minimumFractionDigits:p[o].StdPrecision,maximumFractionDigits:p[o].StdPrecision})+"</div></div></div>");t-e<g&&function(e){for(var t=0;t<e;t++)n.append(c)}(g-(t-e)),0==d?(l.addClass("disabled"),$nextArrowBank.removeClass("disabled")):(l.removeClass("disabled"),t==p.length?$nextArrowBank.addClass("disabled"):$nextArrowBank.removeClass("disabled")),p.length<=4&&$nextArrowBank.addClass("disabled"),A(!1)}}function A(e){e?o.show():o.hide()}this.refreshWidget=function(){A(!0),d=0,g=4,p=[],_()},this.sizeChanged=function(e){var a=i.width();i.find(".VAS-bankbal-name").css("width",e-20+"px;");for(var n=a-20,l=i.find(".VAS-bankbal-name").length,s=0;s<l;s++)t(i.find(".VAS-bankbal-name")[s]).css("width",n+"px")},this.Initialize=function(){0==(v=this.widgetInfo.AD_UserHomeWidgetID)&&(v=u.windowNo),(e=t('<div class="VAS-bankBalroot" id="VAS_root_"></div>')).append('<div class="VAS-bankbalance-container" id="div_bankBal_widget_'+v+'"><div class="VAS-bankbalwidget-header"><h1>'+VIS.Msg.getMsg("VAS_BankBalance")+'</h1><div class="VAS-bankBalarrow-control"><a href="#"><i id="VAS_BankBalPrevArrow_'+v+'" class="fa fa-arrow-circle-left vas-bankbalwidget-leftar" aria-hidden="true"></i></a><span id="VAS_PageInfo_'+v+'" class="vas-bankbalwidget-pageInfo"></span><a href="#"><i id="VAS_BankBalNextArrow_'+v+'" class="fa fa-arrow-circle-right vas-bankbalwidget-rightar" aria-hidden="true"></i></a></div></div><div class="VAS-bankbalwidget-body" id="VAS_divbankBody_'+v+'"></div>'),a=t('<div id="busyDivId_'+v+'" class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),e.append(a),_()},this.getRoot=function(){return e}},e.VAS_BankBalanceWidget.prototype.widgetSizeChange=function(e){this.sizeChanged(e)},e.VAS_BankBalanceWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_BankBalanceWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e;this.Initialize();this.frame.getContentGrid().append(this.getRoot())},e.VAS_BankBalanceWidget.prototype.dispose=function(){this.frame&&this.frame.dispose(),this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$divBusy=null,$divnoBankData=null,$dummyBankDiv=null}}(VAS,jQuery)},6085:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutBPartner")}function i(){e.CalloutEngine.call(this,"VIS.CalloutSetBP")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.BPGroup=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);try{var r=e.dataContext.getJSONRecord("MBPartner/GetBPGroup",s.toString()),c=n.getValue("IsCustomer"),u=n.getValue("IsVendor");c&&null!=r&&Object.keys(r).length>0&&(n.setValue("M_ReturnPolicy_ID",t.getValueOfInt(r.M_ReturnPolicy_ID)),n.setValue("M_DiscountSchema_ID",t.getValueOfInt(r.M_DiscountSchema_ID)),n.setValue("M_PRICELIST_ID",t.getValueOfInt(r.M_PriceList_ID))),u&&null!=r&&Object.keys(r).length>0&&(n.setValue("PO_ReturnPolicy_ID",t.getValueOfInt(r.PO_ReturnPolicy_ID)),n.setValue("PO_DiscountSchema_ID",t.getValueOfInt(r.PO_DiscountSchema_ID)),n.setValue("PO_PriceList_ID",t.getValueOfInt(r.PO_PriceList_ID)))}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),n=s=null,""},e.Model.CalloutBPartner=a,e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.SetBP=function(e,a,i,n,l,s){if(null==l||""==l.toString()||0==t.getValueOfInt(l))return"";if(this.isCalloutActive())return"";try{this.setCalloutActive(!0),i.setValue("C_BPartner_ID",t.getValueOfInt(l)),this.setCalloutActive(!1)}catch(e){this.setCalloutActive(!1)}return i=l=null,""},e.Model.CalloutSetBP=i}(VIS,jQuery)},6351:()=>{!function(t){var a=t.Logging.Level,i=t.Utility.Util,n=!1;function l(){t.CalloutEngine.call(this,"VIS.CalloutContract")}function s(){t.CalloutEngine.call(this,"VIS.CalloutContractQty")}function o(){t.CalloutEngine.call(this,"VIS.CalloutContractProduct")}function r(){t.CalloutEngine.call(this,"VIS.CalloutOrderContract")}function c(){t.CalloutEngine.call(this,"VIS.CalloutSetContract")}function u(){t.CalloutEngine.call(this,"VIS.CalloutSetDate ")}function d(){t.CalloutEngine.call(this,"VIS.CalloutSetDates")}t.Utility.inheritPrototype(l,t.CalloutEngine),l.prototype.InvoiceCount=function(e,a,n,l,s,o){if(null==s||""==s.toString()||0==i.getValueOfInt(s))return"";var r=i.getValueOfDateTime(n.getValue("StartDate")),c=n.getValue("EndDate"),u=t.dataContext.getJSONRecord("MOrderLine/GetNoOfDays",i.getValueOfString(n.getValue("C_Frequency_ID"))),d=(c-r).Days/u;return n.setValue("TotalInvoice",d),n=s=null,""},l.prototype.EndDate=function(e,a,n,l,s,o){var r=new Date(n.getValue("StartDate")),c=new Date(n.getValue("StartDate")),u=t.dataContext.getJSONRecord("MOrderLine/GetNoOfMonths",i.getValueOfString(n.getValue("C_Frequency_ID"))),d=i.getValueOfInt(n.getValue("TotalInvoice")),g=r.setMonth(r.getMonth()+u*d);return g=new Date(r.setDate(r.getDate()-1)),n.setValue("EndDate",g),(g=(g=new Date(g)).toISOString())<(r=c.toISOString())&&n.setValue("EndDate",c),n=null,""},l.prototype.BillStartDate=function(e,a,i,n,l,s){if(null==l||""==l.toString())return"";var o=new Date(i.getValue("StartDate"));return new Date(i.getValue("BillStartDate")).toISOString()<o.toISOString()&&(t.ADialog.info("StartDateShouldBeLessThanBillStartDate"),i.setValue("BillStartDate",i.getValue("StartDate"))),i=l=null,""},l.prototype.StartDate=function(e,a,n,l,s,o){if(null==s||""==s.toString())return"";var r=new Date(n.getValue("StartDate")),c=t.dataContext.getJSONRecord("MOrderLine/GetNoOfDays",i.getValueOfString(n.getValue("C_Frequency_ID"))),u=i.getValueOfInt(n.getValue("TotalInvoice"))*c,d=new Date(r.setDate(r.getDay()+i.getValueOfDouble(u)));return d=d.toISOString(),n.setValue("EndDate",d),n=s=null,""},l.prototype.StartDateChange=function(e,a,n,l,s,o){if(null==s||""==s.toString())return"";var r=t.dataContext.getJSONRecord("MOrderLine/GetNoOfMonths",i.getValueOfString(n.getValue("C_Frequency_ID"))),c=i.getValueOfInt(n.getValue("TotalInvoice")),u=new Date(s),d=new Date(s),g=u.setMonth(u.getMonth()+r*c);return g=new Date(u.setDate(u.getDate()-1)),n.setValue("EndDate",g.toISOString()),(g=g.toISOString())<(u=d.toISOString())&&n.setValue("EndDate",u),n.setValue("BillStartDate",n.getValue("StartDate")),n=s=null,""},t.Model.CalloutContract=l,t.Utility.inheritPrototype(s,t.CalloutEngine),s.prototype.Qty=function(e,a,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";var r=i.getValueOfDecimal(n.getValue("PriceActual")),c=i.getValueOfDecimal(n.getValue("QtyEntered")),u=0,d=t.Env.ZERO,g=t.Env.ZERO;if(n.setValue("LineNetAmt",r*c),u=i.getValueOfInt(n.getValue("C_Tax_ID")),null!=n.getField("SurchargeAmt")){var p=0,v=!1,_=t.dataContext.getJSONRecord("MPriceList/GetPriceListData",n.getValue("M_PriceList_ID").toString());null!=_&&(p=_.StdPrecision,v="Y"==_.IsTaxIncluded);var V=i.getValueOfDecimal(n.getValue("LineNetAmt")),A=t.dataContext.getJSONRecord("MTax/CalculateSurcharge",u.toString()+","+V.toString()+","+p.toString()+","+v.toString());g=A.TaxAmt,n.setValue("TaxAmt",g),n.setValue("SurchargeAmt",A.SurchargeAmt),v?n.setValue("GrandTotal",V):n.setValue("GrandTotal",V+g+A.SurchargeAmt)}else{d=t.dataContext.getJSONRecord("MTax/GetTaxRate",u.toString());V=i.getValueOfDecimal(n.getValue("LineNetAmt"));g=(g=i.getValueOfDecimal(i.getValueOfDecimal(V)*i.getValueOfDecimal(d)/100)).toFixed(2),n.setValue("taxamt",g),n.setValue("GrandTotal",r*c+i.getValueOfDecimal(n.getValue("TaxAmt")))}return n=s=null,""},t.Model.CalloutContractQty=s,t.Utility.inheritPrototype(o,t.CalloutEngine),o.prototype.ContractProduct=function(e,t,a,n,l,s){return null==l||""==l.toString()||0==i.getValueOfInt(l)||(0!=i.getValueOfInt(a.getValue("M_Proudct_ID"))&&i.getValueOfBoolean(l)&&(a.setValue("PriceList",0),a.setValue("PriceLimit",0),a.setValue("PriceActual",0),a.setValue("PriceEntered",0)),a=l=null),""},t.Model.CalloutContractProduct=o,t.Utility.inheritPrototype(r,t.CalloutEngine),r.prototype.DocType=function(n,l,s,o,r,c){var u="PR",d="WR";try{if(null==r||""==r.toString())return"";var g,p=r;if(null==p||0==p)return"";var v=null==(g=s.getValue("DocumentNo"));!v&&g.toString().startsWith("<")&&g.toString().endsWith(">")&&(v=!0);var _=s.getValue("C_DocType_ID"),V=0,A=null;if(v||0==_)A=t.dataContext.getJSONRecord("MDocType/GetDocTypeData",p.toString());else{A=t.dataContext.getJSONRecord("MDocType/GetDocTypeData",_.toString());for(var m=0;m<Object.keys(A).length;m++)V=i.getValueOfInt(A[m].AD_Sequence_ID)}var f="",D=!0,h=!1;for(m=0;m<Object.keys(A).length;m++)if(null==(f=i.getValueOfString(A[m].DocSubTypeSO))&&(f="--"),n.setContext(l,"OrderType",f),f.toString().equals("SO")||s.setValue("IsDropShip","N"),"N".toString().equals(i.getValueOfString(A[m].IsSOTrx))&&(D=!1),(h="Y".toString().equals(i.getValueOfString(A[m].IsReturnTrx)))?f.toString().equals(d)?s.setValue("DeliveryRule","F"):s.setValue("DeliveryRule","M"):(f.toString().equals(d)?s.setValue("DeliveryRule","F"):f.toString().equals(u)?s.setValue("DeliveryRule","R"):s.setValue("DeliveryRule","A"),f.toString().equals(d)||f.toString().equals(u)||f.toString().equals("WI")?s.setValue("InvoiceRule","I"):s.setValue("InvoiceRule","D"),f.toString().equals(d)?s.setValue("PaymentRule",PAYMENTRULE_Cash):s.setValue("PaymentRule",PAYMENTRULE_OnCredit),n.setContext(l,"HasCharges",i.getValueOfString(A[m].HasCharges))),A[m].CurrentNext.toString().equals("Y")&&(v||V==i.getValueOfInt(A.AD_Sequence_ID)||(v=!0),v))try{s.setValue("DocumentNo","<"+i.getValueOfString(A[m].CurrentNext)+">")}catch(e){this.setCalloutActive(!1)}if(h)return"";if(f.toString().equals(d)||f.toString().equals(u));else{var C=n.getContextAsInt(l,"C_BPartner_ID");A=t.dataContext.getJSONRecord("MBPartner/GetBPDocTypeData",C.toString());for(m=0;m<Object.keys(A).length;m++){var S=i.getValueOfString(D?A[m].paymentrule:A[m].paymentrulepo);null!=S&&0!=S.toString().length&&(D&&(S.toString().equals("B")||S.toString().equals("S")||S.toString().equals("U"))&&(S="P"),!D&&S.toString().equals("B")&&(S="P"),s.setValue("PaymentRule",S));var I=i.getValueOfInt(D?A[m].c_paymentterm_id:A[m].po_paymentterm_id);null!=I&&s.setValue("C_PaymentTerm_ID",I),null!=(S=A[m].InvoiceRule.toString())&&0!=S.length&&s.setValue("InvoiceRule",S),null!=(S=A[m].DeliveryRule.toString())&&0!=S.length&&s.setValue("DeliveryRule",S),null!=(S=A[m].FreightCostRule.toString())&&0!=S.length&&s.setValue("FreightCostRule",S),null!=(S=A[m].DeliveryViaRule.toString())&&0!=S.length&&s.setValue("DeliveryViaRule",S)}}}catch(t){return this.setCalloutActive(!1),this.log.log(a.SEVERE,"",t),e.message}return n=l=s=r=null,""},r.prototype.BPartner=function(n,l,s,o,r,c){try{if(null==r||0==r||""==r.toString())return"";var u=0;if(null!=r&&(u=i.getValueOfInt(r.toString())),0==u)return"";if(s.getValue("IsReturnTrx"))return"";this.setCalloutActive(!0);var d="Y"==n.getWindowContext(l,"IsSOTrx",!0),g=t.dataContext.getJSONRecord("MBPartner/LoadBPartnerOrderData",u.toString());if(null!=g&&Object.keys(g).length>0)for(var p=0;p<Object.keys(g).length;p++){var v=i.getValueOfInt(d?g.m_pricelist_id:g.po_pricelist_id);0!=v&&s.setValue("M_PriceList_ID",v),s.setValue("Bill_BPartner_ID",u);var _=i.getValueOfInt(g.bill_location_id);0==_?s.setValue("Bill_Location_ID",null):s.setValue("Bill_Location_ID",_);var V=i.getValueOfInt(g.c_bpartner_location_id);if(u.toString().equals(n.getContext("C_BPartner_ID"))){var A=n.getContext("C_BPartner_Location_ID");A.toString().length>0&&(V=int.Parse(A))}0==V?s.setValue("C_BPartner_Location_ID",null):(s.setValue("C_BPartner_Location_ID",V),"Y".toString().equals(i.getValueOfString(g.isshipto))&&s.setValue("Bill_Location_ID",V));var m=i.getValueOfInt(g.ad_user_id.toString());if(u.toString().toString().equals(n.getContext("C_BPartner_ID"))){var f=n.getContext("AD_User_ID");f.toString().length>0&&(m=i.getValueOfInt(f))}if(0==m?s.setValue("AD_User_ID",null):(s.setValue("AD_User_ID",m),s.setValue("Bill_User_ID",m)),d)if(0!=i.getValueOfDouble(g.so_creditlimit))i.getValueOfDouble(g.creditavailable);var D=g.poreference.toString();null!=D&&0!=D.toString().length&&s.setValue("POReference",D),null!=(D=i.getValueOfString(g.so_description))&&0!=D.toString().trim().length&&s.setValue("Description",D),null!=(D=i.getValueOfString(g.isdiscountprinted))&&0!=D.toString().length?s.setValue("IsDiscountPrinted",D):s.setValue("IsDiscountPrinted","N");var h=n.getContext("OrderType");s.setValue("InvoiceRule","D"),s.setValue("DeliveryRule","A"),s.setValue("PaymentRule",PAYMENTRULE_OnCredit),h.toString().equals("PR")?(s.setValue("InvoiceRule","I"),s.setValue("DeliveryRule","R")):h.toString().equals(MOrder.DocSubTypeSO_POS)?s.setValue("PaymentRule",PAYMENTRULE_Cash):(null!=(D=d?g.PaymentRule:g.PaymentRulePO.toString())&&0!=D.length&&(D.toString().equals("B")&&(D="P"),d&&(D.toString().equals("S")||D.toString().equals("U"))&&(D="P"),s.setValue("PaymentRule",D)),0!=(v=i.getValueOfInt(d?g.c_paymentterm_id:g.po_paymentterm_id))&&s.setValue("C_PaymentTerm_ID",v),null!=(D=i.getValueOfString(g.invoicerule))&&0!=D.length&&s.setValue("InvoiceRule",D),null!=(D=i.getValueOfString(g.deliveryrule))&&0!=D.length&&s.setValue("DeliveryRule",D),null!=(D=i.getValueOfString(g.freightcostrule))&&0!=D.length&&s.setValue("FreightCostRule",D),null!=(D=i.getValueOfString(g.deliveryviarule))&&0!=D.length&&s.setValue("DeliveryViaRule",D))}}catch(t){return this.log.log(a.SEVERE,"",t),this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),n=l=s=r=null,""},r.prototype.Product=function(e,a,n,l,s,o){if(null==s||0==s||""==s.toString())return"";try{var r=s;if(null==r||0==r)return"";if("Y".toString().equals(e.getContext("IsReturnTrx")))return"";this.setCalloutActive(!0),n.setValue("C_Charge_ID",null),n.setValue("M_AttributeSetInstance_ID",null);var c=e.getContextAsInt(a,"C_BPartner_ID"),u=i.getValueOfDecimal(n.getValue("QtyEntered")),d="Y"==e.getWindowContext(a,"IsSOTrx",!0),g=e.getContextAsInt(a,"M_PriceList_ID"),p=g.toString().concat(",",i.getValueOfString(n.getValue("StartDate")),",",i.getValueOfString(n.getValue("M_Product_ID")),",",i.getValueOfInt(n.getValue("C_UOM_ID")),",",i.getValueOfInt(n.getValue("M_AttributeSetInstance_ID"))),v=t.dataContext.getJSONRecord("MPriceListVersion/GetM_PriceList_Version_ID_On_Transaction_Date",p),_=(n.getValue("DateOrdered"),t.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","ED011_")),V=0;if(_.ED011_){var A=(c=i.getValueOfInt(n.getValue("C_BPartner_ID"))).toString()+","+r.toString(),m=t.dataContext.getJSONRecord("MProduct/GetProductUOMs",A);if(null!=m)if(0==d)V=0==m.PurchaseUOM?0==m.VAS_PurchaseUOM_ID?m.C_UOM_ID:m.VAS_PurchaseUOM_ID:m.PurchaseUOM,n.setValue("C_UOM_ID",V);else{var f=0==m.VAS_SalesUOM_ID?m.C_UOM_ID:m.VAS_SalesUOM_ID;n.setValue("C_UOM_ID",f)}}var D=i.getValueOfInt(n.getValue("C_UOM_ID"));A=r.toString().concat(",",c.toString(),",",u.toString(),",",d,",",g.toString(),",",v.toString(),",",null,",",null,",",null,",",D,",",0);if(i.getValueOfInt(v)>0){var h;h=t.dataContext.getJSONRecord("MProductPricing/GetProductPricing",A),n.setValue("PriceList",h.PriceList),n.setValue("PriceLimit",h.PriceLimit),n.setValue("PriceActual",h.PriceActual),n.setValue("PriceEntered",h.PriceEntered),i.getValueOfInt(h.C_Currency_ID)>0&&n.setValue("C_Currency_ID",i.getValueOfInt(h.C_Currency_ID)),n.setValue("Discount",h.Discount),n.setValue("C_UOM_ID",i.getValueOfInt(h.C_UOM_ID)),n.setValue("QtyOrdered",n.getValue("QtyEntered")),e.setContext(a,"EnforcePriceLimit",h.IsEnforcePriceLimit?"Y":"N"),e.setContext(a,"DiscountSchema",h.IsDiscountSchema?"Y":"N")}if("Y"==e.getWindowContext(a,"IsSOTrx",!0)){A=r.toString()+",0";if(t.dataContext.getJSONRecord("MProduct/GetProduct",A)){var C=i.getValueOfDecimal(n.getValue("QtyEntered")),S=e.getContextAsInt(a,"M_Warehouse_ID"),I=e.getContextAsInt(a,"M_AttributeSetInstance_ID"),y=(A=S+","+r+","+I,t.dataContext.getJSONRecord("MStorage/GetQtyAvailable",A));if(null==y&&(y=t.Env.ZERO),0==y);else if(y.toString().compareTo(C)<0);else{var O=0;null!=n.getValue("C_OrderLine_ID")&&(O=i.getValueOfInt(n.getValue("C_OrderLine_ID"))),null==O&&(O=0),A=S.toString()+","+r.toString()+","+I.toString()+","+O.toString();var T=i.getValueOfDecimal(t.dataContext.getJSONRecord("MOrderLine/GetNotReserved",A));null==T&&(T=t.Env.ZERO),(y-T).toString().compareTo(C)}}}this.setCalloutActive(!1)}catch(e){this.setCalloutActive(!1)}return this.Tax(e,a,n,l,s)},r.prototype.Tax=function(e,a,n,l,s,o){var r=0,c=t.Env.ZERO,u=t.Env.ZERO;r=i.getValueOfInt(n.getValue("C_Tax_ID")),c=t.dataContext.getJSONRecord("MTax/GetTaxRate",r.toString()),this.Amt(e,a,n,l,s);var d=i.getValueOfDecimal(n.getValue("LineNetAmt"));return u=i.getValueOfDecimal(i.getValueOfDecimal(d)*i.getValueOfDecimal(c)/100),n.setValue("taxamt",u),this.Amt(e,a,n,l,s)},r.prototype.Amt=function(e,a,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString())return"";this.setCalloutActive(!0);try{n;var c,u,d,g,p,v,_=e.getContextAsInt(a,"C_UOM_ID"),V=e.getContextAsInt(a,"M_Product_ID"),A=e.getContextAsInt(a,"M_PriceList_ID"),m=A.toString(),f=t.dataContext.getJSONRecord("MPriceList/GetPriceList",m),D=i.getValueOfInt(f.StdPrecision);if(c=i.getValueOfDecimal(l.getValue("QtyEntered")),c=i.getValueOfDecimal(l.getValue("QtyEntered")),this.log.fine("QtyEntered="+c+", Ordered="+c+", UOM="+_),u=i.getValueOfDecimal(l.getValue("PriceEntered")),d=i.getValueOfDecimal(l.getValue("PriceActual")),p=i.getValueOfDecimal(l.getValue("Discount")),g=i.getValueOfDecimal(l.getValue("PriceLimit")),v=i.getValueOfDecimal(l.getValue("PriceList")),this.log.fine("PriceList="+v+", Limit="+g+", Precision="+D),this.log.fine("PriceEntered="+u+", Actual="+d+", Discount="+p),(s.getColumnName().toString().equals("QtyEntered")||s.getColumnName().toString().equals("QtyEntered")||s.getColumnName().toString().equals("M_Product_ID"))&&!"N".toString().equals(e.getContext("DiscountSchema"))){var h=e.getContextAsInt(a,"C_BPartner_ID");if(s.getColumnName().toString().equals("QtyEntered")){var C=V.toString()+","+_.toString()+","+c.toString();c=i.getValueOfDecimal(t.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",C))}var S="Y"==e.getWindowContext(a,"IsSOTrx",!0),I=A.toString().concat(",",i.getValueOfString(l.getValue("StartDate")),",",i.getValueOfString(l.getValue("M_Product_ID")),",",i.getValueOfInt(l.getValue("C_UOM_ID")),",",i.getValueOfInt(l.getValue("M_AttributeSetInstance_ID"))),y=t.dataContext.getJSONRecord("MPriceListVersion/GetM_PriceList_Version_ID_On_Transaction_Date",I),O=t.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","ED011_"),T=0;if(O>0){C=(h=i.getValueOfInt(l.getValue("C_BPartner_ID"))).toString()+","+V.toString();if((T=t.dataContext.getJSONRecord("MProduct/GetPOUOM",C))>0&&0==S)l.setValue("C_UOM_ID",T);else{C=V.toString();var w=t.dataContext.getJSONRecord("MProduct/GetUOMID",C);l.setValue("C_UOM_ID",w)}}var P=i.getValueOfInt(l.getValue("C_UOM_ID"));C=V.toString().concat(",",h.toString(),",",c.toString(),",",S,",",A.toString(),",",y.toString(),",",null,",",null,",",null,",",P,",",0);if(i.getValueOfInt(y)>0){f=null;f=t.dataContext.getJSONRecord("MProductPricing/GetProductPricing",C),C=V.toString()+","+_.toString()+","+f.PriceStd.toString(),null!=(u=i.getValueOfDecimal(t.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",C)))&&0!=u||(u=f.PriceStd),this.log.fine("QtyChanged -> PriceActual="+f.PriceStd+", PriceEntered="+u+", Discount="+f.Discount),d=f.PriceStd,l.setValue("PriceActual",f.PriceActual),l.setValue("Discount",f.Discount),l.setValue("PriceEntered",f.PriceEntered),e.setContext(a,"DiscountSchema",f.DiscountSchema?"Y":"N")}}else s.getColumnName().toString().equals("PriceActual")?(d=i.getValueOfDecimal(o),C=V.toString()+","+_.toString()+","+d.toString(),null!=(u=i.getValueOfDecimal(t.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",C)))&&0!=u||(u=d),this.log.fine("PriceActual="+d+" -> PriceEntered="+u),l.setValue("PriceEntered",u)):s.getColumnName().toString().equals("PriceEntered")&&(u=i.getValueOfDecimal(o),C=V.toString()+","+_.toString()+","+u.toString(),null!=(d=i.getValueOfDecimal(t.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",C)))&&0!=u||(d=u),this.log.fine("PriceEntered="+u+" -> PriceActual="+d),l.setValue("PriceActual",d));s.getColumnName().toString().equals("Discount")?(d=i.getValueOfDecimal((100-i.getValueOfDouble(p))/100*i.getValueOfDouble(v)),i.scale(d)>D&&(d=d.toFixed(D)),C=V.toString()+","+_.toString()+","+d.toString(),null!=(u=i.getValueOfDecimal(t.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",C)))&&0!=u||(u=d),l.setValue("PriceActual",d),l.setValue("PriceEntered",u)):(p=0==v?t.Env.ZERO:i.getValueOfDecimal((v-d)/v*100),i.scale(p)>2&&(p=p.toFixed(2)),l.setValue("Discount",p)),this.log.fine("PriceEntered="+u+", Actual="+d+", Discount="+p);var b=e.getContext("EnforcePriceLimit"),M="Y"==e.getWindowContext(a,"IsSOTrx",!0)&&null!=b&&b.toString().equals("Y"),x="Y".toString().equals(e.getContext("IsReturnTrx"));M&&(t.MRole.getDefault().getIsOverwritePriceLimit()||x)&&(M=!1),M&&0!=i.getValueOfDouble(g)&&d.toString().compare(g)<0&&(d=g,C=V.toString()+","+_.toString()+","+g.toString(),null!=(u=i.getValueOfDecimal(t.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",C)))&&0!=u||(u=g),this.log.fine("(under) PriceEntered="+u+", Actual"+g),l.setValue("PriceActual",g),l.setValue("PriceEntered",u),t.ADialog.info("UnderLimitPrice"),0!=v&&(p=i.getValueOfDecimal((v-d)/v*100),i.scale(p)>2&&(p=p.toFixed(2)),l.setValue("Discount",p)));var N=c*d;i.scale(N)>D&&(N=N.toFixed(D)),this.log.info("LineNetAmt="+N),l.setValue("LineNetAmt",N),l.setValue("GrandTotal",i.getValueOfDecimal(l.getValue("TaxAmt"))+N)}catch(e){}return this.setCalloutActive(!1),e=a=l=s=o=null,""},r.prototype.BPartnerContract=function(e,a,n,l,s,o){var r=null,c=null;if(this.isCalloutActive()||null==s||""==s.toString())return"";try{var u=0,d="N",g="N",p=i.getValueOfString(n.getValue("ContractType"));if(""==p)return"";if(null!=s&&(u=i.getValueOfInt(s.toString())),0==u)return"";if(i.getValueOfBoolean(n.getValue("IsReturnTrx")))return"";this.setCalloutActive(!0);var v=!1,_="VA009_",V="ASR"==p;if(null!=(c=t.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix",_))&&(v=c.VA009_),_=v.toString()+","+u,null!=(c=t.dataContext.getJSONRecord("MBPartner/GetBPartnerOrderData",_))){i.getValueOfInt(n.getValue("M_PriceList_ID"));0!=(M=i.getValueOfInt(V?c.M_PriceList_ID:c.PO_PriceList_ID))?n.setValue("M_PriceList_ID",M):n.setValue("M_PriceList_ID",null),n.setValue("Bill_BPartner_ID",u);var A=i.getValueOfInt(c.Bill_Location_ID);if(0==A){var m=i.getValueOfInt(c.Bill_BPartner_ID);m>0&&n.setValue("Bill_BPartner_ID",m)}else n.setValue("Bill_Location_ID",A);var f=i.getValueOfInt(c.C_BPartner_Location_ID);if(u.toString()==e.getContext("C_BPartner_ID")){var D=e.getContext("C_BPartner_Location_ID");D.length>0&&(f=i.getValueOfInt(D))}0==f?n.setValue("C_BPartner_Location_ID",null):(n.setValue("C_BPartner_Location_ID",f),"Y"==i.getValueOfString(c.IsShipTo)&&n.setValue("Bill_Location_ID",f));var h=i.getValueOfInt(c.SalesRep_ID);if(h>0&&n.setValue("SalesRep_ID",h),v){var C=i.getValueOfInt(c.VA009_PaymentMethod_ID);if(I<=0){var S=t.dataContext.getJSONRecord("MBPartner/GetBPDetails",u);null!=S&&(d=i.getValueOfString(S.IsVendor),g=i.getValueOfString(S.IsCustomer),V?"Y"==d?(C=0,r=null,"Y"==g&&(C=i.getValueOfInt(S.VA009_PaymentMethod_ID),r=i.getValueOfString(S.VA009_PAYMENTBASETYPE))):"Y"==g&&(C=i.getValueOfInt(S.VA009_PaymentMethod_ID),r=i.getValueOfString(S.VA009_PAYMENTBASETYPE)):"Y"==d?(C=i.getValueOfInt(S.VA009_PO_PaymentMethod_ID),r=i.getValueOfString(S.VA009_PAYMENTBASETYPEPO)):(C=0,r=null))}if(0==C){var I=i.getValueOfInt(n.getValue("C_Order_Blanket"));if(I>0){_=v.toString()+","+I.toString();if(null!=(c=t.dataContext.getJSONRecord("MOrder/GetPaymentMethod",_))){var y=i.getValueOfInt(c.VA009_PaymentMethod_ID);if(y>0)n.setValue("VA009_PaymentMethod_ID",y),"W"!=(r=i.getValueOfString(c.VA009_PaymentBaseType))&&null!=r&&(n.setValue("PaymentMethod",r),"N"==d?n.setValue("PaymentRule",r):n.setValue("PaymentRulePO",r))}}}else 0==C?n.setValue("VA009_PaymentMethod_ID",null):(n.setValue("VA009_PaymentMethod_ID",C),"W"!=r&&null!=r?(n.setValue("PaymentMethod",r),"N"==d?n.setValue("PaymentRule",r):n.setValue("PaymentRulePO",r)):(n.setValue("PaymentMethod","T"),"N"==d?n.setValue("PaymentRule","T"):n.setValue("PaymentRulePO","T")))}var O=i.getValueOfInt(c.AD_User_ID);if(u.toString()==e.getContext("C_BPartner_ID")){var T=e.getContext("AD_User_ID");T.length>0&&(O=i.getValueOfInt(T))}if(0==O?n.setValue("AD_User_ID",null):(n.setValue("AD_User_ID",O),n.setValue("Bill_User_ID",O)),V){var w=i.getValueOfString(c.CreditStatusSettingOn);if("CH"==w){if(0!=i.getValueOfDouble(c.SO_CreditLimit))i.getValueOfDouble(c.CreditAvailable)<=0&&t.ADialog.info("CreditOver")}else{var P=i.getValueOfInt(n.getValue("C_BPartner_Location_ID")),b=t.dataContext.getJSONRecord("MBPartner/GetLocationData",P.toString());if(null!=b)if("CL"==(w=i.getValueOfString(b.CreditStatusSettingOn)))if(0!=i.getValueOfDouble(b.SO_CreditLimit))i.getValueOfDouble(b.CreditAvailable)<=0&&t.ADialog.info("CreditOver")}}var M;i.getValueOfInt(n.getValue("C_PaymentTerm_ID"));0!=(M=i.getValueOfInt(V?c.C_PaymentTerm_ID:c.PO_PaymentTerm_ID))?n.setValue("C_PaymentTerm_ID",M):n.setValue("C_PaymentTerm_ID",null)}}catch(e){return this.setCalloutActive(!1),e}this.setCalloutActive(!1)},r.prototype.UpdateIsSOTrx=function(e,t,a,i,n,l){if(this.isCalloutActive()||null==n||""==n.toString()||0==n)return"";this.setCalloutActive(!0),e.setIsSOTrx(t,"ASR"==n),this.setCalloutActive(!1)},t.Model.CalloutOrderContract=r,t.Utility.inheritPrototype(c,t.CalloutEngine),c.prototype.SetContract=function(e,a,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);try{var r=e.getContextAsInt(a,"M_Product_ID").toString().concat(","),c=e.getWindowContext(a,"ProductType",!0);""==i.getValueOfString(c)&&(c=t.dataContext.getJSONRecord("MProduct/GetProductType",r)),"S"==c?n.getField("IsContract").setReadOnly(!1):(n.getValue("IsContract",!1),n.getField("IsContract").setReadOnly(!0))}catch(e){this.log.severe(e.toString())}return this.setCalloutActive(!1),""},t.Model.CalloutSetContract=c,t.Utility.inheritPrototype(u,t.CalloutEngine),u.prototype.SetDate=function(e,a,n,l,s,o){if(null==s||""==s.toString())return"";if(null==n.getValue("StartDate")||null==n.getValue("NoofCycle"))return this.setCalloutActive(!1),"";try{this.setCalloutActive(!0);var r;r=t.dataContext.getJSONRecord("MOrderLine/GetNoOfMonths",i.getValueOfString(n.getValue("C_Frequency_ID")));var c=new Date(n.getValue("StartDate")),u=c.setMonth(c.getMonth()+r*i.getValueOfInt(n.getValue("NoofCycle")));u=new Date(c.setDate(c.getDate()-1)),n.setValue("EndDate",u.toISOString()),n=s=null,this.setCalloutActive(!1)}catch(e){}return""},t.Model.CalloutSetDate=u,t.Utility.inheritPrototype(d,t.CalloutEngine),d.prototype.SetDates=function(e,t,a,i,n,l){return this.isCalloutActive()||null==n||""==n.toString()||(this.setCalloutActive(!0),"C_Frequency_ID"==i.getColumnName()&&n!=l&&(a.setValue("StartDate",""),a.setValue("EndDate","")),this.setCalloutActive(!1)),""},t.Model.CalloutSetDates=d}(VIS,jQuery)},6381:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util,i=!1;function n(){e.CalloutEngine.call(this,"VIS.CalloutOrder")}function l(){e.CalloutEngine.call(this,"VIS.CalloutSalesQuotation ")}function s(){e.CalloutEngine.call(this,"VIS.CalloutBlanketOrderRef")}function o(e){var t=new Date(e);return t.setMinutes(-t.getTimezoneOffset()+t.getMinutes()),t.toISOString()}e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.DocType=function(i,n,l,s,o,r){var c="PR",u="WR";if(this.isCalloutActive()||null==o||""==o.toString())return l.setValue("BlanketOrderType","OO"),"";var d=a.getValueOfInt(o);if(null==d||0==d)return"";this.setCalloutActive(!0);var g=a.getValueOfString(l.getValue("DocumentNo")),p=null==g;!p&&g.startsWith("<")&&g.endsWith(">")&&(p=!0);var v=a.getValueOfInt(l.getValue("C_DocType_ID")),_=null,V=[];try{var A=0;p||0==a.getValueOfInt(v)||null!=(_=e.dataContext.getJSONRecord("MDocType/GetDocTypeData",v.toString()))&&(A=a.getValueOfInt(_.CurrentNextSys)),_=e.dataContext.getJSONRecord("MDocType/GetDocTypeData",d.toString()),V.length=0,V=null;var m="",f=!0,D=!1,h="";if(null!=_&&(m=_.DocSubTypeSO,h=_.Value,null==m&&(m="--"),i.setContext(n,"OrderType",m),i.setContext(n,"DocTypeValue",h),"BO"==m?(i.setContext(n,"BlanketOrderType",m),l.setValue("BlanketOrderType",m)):a.getValueOfString(_.IsReleaseDocument).equals("Y")?l.setValue("BlanketOrderType","BO"):(i.setContext(n,"BlanketOrderType","OO"),l.setValue("BlanketOrderType","OO"),l.setValue("C_Order_Blanket",null)),"SO"==!m&&l.setValue("IsDropShip","N"),"N"==_.IsSOTrx&&(f=!1),(D="Y"==_.IsReturnTrx)?m==u?l.setValue("DeliveryRule","F"):l.setValue("DeliveryRule","M"):(m==u?l.setValue("DeliveryRule","F"):m==c?l.setValue("DeliveryRule","R"):l.setValue("DeliveryRule","A"),m==u||m==c||"WI"==m?l.setValue("InvoiceRule","I"):l.setValue("InvoiceRule","D"),m==u?l.setValue("PaymentRule","B"):l.setValue("PaymentRule","P"),i.setContext(n,"HasCharges",a.getValueOfString(_.HasCharges))),"Y"==_.IsDocNoControlled&&(p||A==a.getValueOfInt(_.AD_Sequence_ID)||(p=!0),p&&(e.Ini.getLocalStorage(e.IniConstants.P_VIENNASYS)&&i.getAD_Client_ID()<1e6?l.setValue("DocumentNo","<"+a.getValueOfInt(_.CurrentNextSys)+">"):l.setValue("DocumentNo","<"+a.getValueOfString(_.CurrentNext)+">"))),"Y"==_.VAS_IsVariationOrder?l.setValue("VAS_OrderType","VO"):l.setValue("VAS_OrderType","")),D)return this.setCalloutActive(!1),"";if(m==u||m==c);else{var C=i.getContextAsInt(n,"C_BPartner_ID"),S=null;if(0!=C&&(S=e.dataContext.getJSONRecord("MBPartner/GetBPDocTypeData",C.toString())),null!=S){var I=S[f?"PaymentRule":"PaymentRulePO"];null!=I&&0!=I.length&&((f&&"B"==I||"S"==I||"U"==I)&&(I="P"),f||"B"!=I||(I="P"),l.setValue("PaymentRule",I));var y=S[f?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"];l.setValue("C_PaymentTerm_ID",y),null!=(I=S.InvoiceRule)&&0!=I.length&&l.setValue("InvoiceRule",I),null!=(I=S.DeliveryRule)&&0!=I.length&&l.setValue("DeliveryRule",I),null!=(I=S.FreightCostRule)&&0!=I.length&&l.setValue("FreightCostRule",I),null!=(I=S.DeliveryViaRule)&&0!=I.length&&l.setValue("DeliveryViaRule",I)}}}catch(e){return this.setCalloutActive(!1),null!=_&&(_.close(),_=null),this.log.log(t.SEVERE,sql,e),e}return this.setCalloutActive(!1),i=n=l=o=null,""},n.prototype.BlanketOrderLine=function(t,i,n,l,s,o){var r=null;if(this.isCalloutActive()||null==s||""==s.toString())return"";try{var c=0;if(null!=s&&(c=a.getValueOfInt(s.toString())),0==c)return"";this.setCalloutActive(!0);var u=c.toString();if(null!=(r=e.dataContext.getJSONRecord("MOrderLine/GetOrderLine",u))){var d=a.getValueOfInt(r.M_Product_ID),g=a.getValueOfInt(r.C_Charge_ID),p=a.getValueOfDecimal(r.Qty),v=a.getValueOfDecimal(r.QtyOrdered),_=a.getValueOfDecimal(r.QtyReleased),V=a.getValueOfDecimal(r.PriceList),A=a.getValueOfDecimal(r.PriceActual),m=a.getValueOfInt(r.C_UOM_ID),f=a.getValueOfDecimal(r.Discount),D=a.getValueOfDecimal(r.PriceEntered),h=a.getValueOfInt(r.M_AttributeSetInstance_ID),C=a.getValueOfInt(r.C_Tax_ID),S=a.getValueOfInt(r.AD_OrgTrx_ID),I=a.getValueOfInt(r.VAS_ContractLine_ID);QtyEntered=a.getValueOfDecimal(p),paramStr=m.toString().concat(",");var y=e.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),O=QtyEntered.toFixed(a.getValueOfInt(y));if(QtyEntered!=O&&(this.log.fine("Corrected QtyEntered Scale UOM="+m+"; QtyEntered="+QtyEntered+"->"+O),QtyEntered=O),paramStr=d.toString().concat(",",m.toString(),",",QtyEntered.toString()),null==(v=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr))&&(v=QtyEntered),QtyEntered!=v){paramStr=d.toString().concat(",",m.toString(),",",_.toString());var T=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",paramStr);null!=T&&(_=T)}0!=d&&null!=d?(n.setValue("M_Product_ID",d),n.setValue("C_Charge_ID",null)):(n.setValue("C_Charge_ID",g),n.setValue("M_Product_ID",null)),0!=p&&null!=p&&n.setValue("QtyEntered",p),null!=V&&n.setValue("PriceList",V),null!=A&&(n.setValue("PriceActual",A),n.setValue("LineNetAmt",A*p)),null!=D&&(n.setValue("PriceEntered",D),n.setValue("PriceEntered",D)),null!=f&&n.setValue("Discount",f),0!=m&&null!=m&&n.setValue("C_UOM_ID",m),0!=v&&null!=v&&null!=_&&n.setValue("QtyBlanket",v+_-_),0!=h&&null!=h&&n.setValue("M_AttributeSetInstance_ID",h),0!=C&&null!=C&&n.setValue("C_Tax_ID",C),n.setValue("VAS_ContractLine_ID",I),n.setValue("AD_OrgTrx_ID",S)}}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),this.Qty(t,i,n,l,n.getValue("QtyEntered"))},n.prototype.BlanketOrder=function(t,i,n,l,s,o){var r=null;if(this.isCalloutActive()||null==s||""==s.toString())return"";try{var c=0;if(null!=s&&(c=a.getValueOfInt(s.toString())),0==c)return"";this.setCalloutActive(!0);t.isSOTrx(i);var u=c.toString();if(null!=(r=e.dataContext.getJSONRecord("MOrder/GetOrder",u))){var d=a.getValueOfDouble(r.C_BPartner_ID),g=a.getValueOfDouble(r.M_PriceList_ID),p=a.getValueOfDouble(r.M_Warehouse_ID),v=a.getValueOfDouble(r.C_PaymentTerm_ID),_=a.getValueOfDouble(r.PaymentRule),V=a.getValueOfDouble(r.C_Payment_ID),A=a.getValueOfDouble(r.VA009_PaymentMethod_ID),m=a.getValueOfDouble(r.C_Currency_ID),f=a.getValueOfDouble(r.C_Project_ID),D=a.getValueOfDouble(r.C_Campaign_ID),h=a.getValueOfDouble(r.C_ProjectRef_ID),C=a.getValueOfDouble(r.SalesRep_ID),S=a.getValueOfDouble(r.PriorityRule),I=a.getValueOfDouble(r.VAS_ContractMaster_ID);0!=d&&null!=d&&n.setValue("C_BPartner_ID",d),0!=g&&null!=g&&n.setValue("M_PriceList_ID",g),0!=p&&null!=p&&n.setValue("M_Warehouse_ID",p),0!=v&&null!=v&&n.setValue("C_PaymentTerm_ID",v),0!=_&&null!=_&&n.setValue("PaymentRule",_),0!=V&&null!=V&&n.setValue("C_Payment_ID",V),0!=A&&null!=A&&n.setValue("VA009_PaymentMethod_ID",A),0!=m&&null!=m&&n.setValue("C_Currency_ID",m),0!=f&&null!=f&&n.setValue("C_Project_ID",f),0!=D&&null!=D&&n.setValue("C_Campaign_ID",D),0!=h&&null!=h&&n.setValue("C_ProjectRef_ID",h),0!=C&&null!=C&&n.setValue("SalesRep_ID",C),0!=S&&null!=S&&n.setValue("PriorityRule",S),n.setValue("VAS_ContractMaster_ID",I),null!=n.getField("C_IncoTerm_ID")&&n.setValue("C_IncoTerm_ID",a.getValueOfInt(r.C_IncoTerm_ID))}}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),this.BPartner(t,i,n,l,n.getValue("C_BPartner_ID"))},n.prototype.BPartner=function(t,i,n,l,s,o){var r=null,c=null;if(this.isCalloutActive()||null==s||""==s.toString())return"";try{var u=0,d="N",g="N";if(null!=s&&(u=a.getValueOfInt(s.toString())),0==u)return"";if(a.getValueOfBoolean(n.getValue("IsReturnTrx")))return"";this.setCalloutActive(!0);var p=!1,v="VA009_",_=t.isSOTrx(i);if(null!=(c=e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix",v))&&(p=c.VA009_),v=p.toString()+","+u,null!=(c=e.dataContext.getJSONRecord("MBPartner/GetBPartnerOrderData",v))){var V=a.getValueOfInt(n.getValue("M_PriceList_ID")),A=a.getValueOfDecimal(n.getValue("C_Order_Blanket"));if(V>0&&A>0);else{var m=a.getValueOfInt(_?c.M_PriceList_ID:c.PO_PriceList_ID);0!=m&&n.setValue("M_PriceList_ID",m)}var f=a.getValueOfInt(_?c.C_IncoTerm_ID:c.C_IncoTermPO_ID);f>0&&n.setValue("C_IncoTerm_ID",f),n.setValue("Bill_BPartner_ID",u);var D=a.getValueOfInt(c.Bill_Location_ID);if(0==D){var h=a.getValueOfInt(c.Bill_BPartner_ID);h>0&&n.setValue("Bill_BPartner_ID",h)}else n.setValue("Bill_Location_ID",D);var C=a.getValueOfInt(c.C_BPartner_Location_ID);if(u.toString().equals(t.getWindowTabContext(i,e.EnvConstants.TAB_INFO,"C_BPARTNER_ID").toString())){var S=t.getWindowTabContext(i,e.EnvConstants.TAB_INFO,"C_BPARTNER_LOCATION_ID");S&&S.toString().length>0&&(C=parseInt(S))}0==C?n.setValue("C_BPartner_Location_ID",null):(n.setValue("C_BPartner_Location_ID",C),"Y"==a.getValueOfString(c.IsShipTo)&&n.setValue("Bill_Location_ID",C));var I=a.getValueOfInt(c.SalesRep_ID);if(I>0&&n.setValue("SalesRep_ID",I),p){var y=a.getValueOfInt(c.VA009_PaymentMethod_ID);if(A<=0){var O=e.dataContext.getJSONRecord("MBPartner/GetBPDetails",u);null!=O&&(d=a.getValueOfString(O.IsVendor),g=a.getValueOfString(O.IsCustomer),_?"Y"==d?(y=0,r=null,"Y"==g&&(y=a.getValueOfInt(O.VA009_PaymentMethod_ID),r=a.getValueOfString(O.VA009_PAYMENTBASETYPE))):"Y"==g&&(y=a.getValueOfInt(O.VA009_PaymentMethod_ID),r=a.getValueOfString(O.VA009_PAYMENTBASETYPE)):"Y"==d?(y=a.getValueOfInt(O.VA009_PO_PaymentMethod_ID),r=a.getValueOfString(O.VA009_PAYMENTBASETYPEPO)):(y=0,r=null))}if(0==y){if((A=a.getValueOfInt(n.getValue("C_Order_Blanket")))>0){v=p.toString()+","+A.toString();if(null!=(c=e.dataContext.getJSONRecord("MOrder/GetPaymentMethod",v))){var T=a.getValueOfInt(c.VA009_PaymentMethod_ID);if(T>0)n.setValue("VA009_PaymentMethod_ID",T),"W"!=(r=a.getValueOfString(c.VA009_PaymentBaseType))&&null!=r&&(n.setValue("PaymentMethod",r),"N"==d?n.setValue("PaymentRule",r):n.setValue("PaymentRulePO",r))}}}else 0==y?n.setValue("VA009_PaymentMethod_ID",null):(n.setValue("VA009_PaymentMethod_ID",y),"W"!=r&&null!=r?(n.setValue("PaymentMethod",r),"N"==d?n.setValue("PaymentRule",r):n.setValue("PaymentRulePO",r)):(n.setValue("PaymentMethod","T"),"N"==d?n.setValue("PaymentRule","T"):n.setValue("PaymentRulePO","T")))}var w=a.getValueOfInt(c.AD_User_ID);if(u.toString().equals(t.getWindowTabContext(i,e.EnvConstants.TAB_INFO,"C_BPARTNER_ID").toString())){var P=t.getWindowTabContext(i,e.EnvConstants.TAB_INFO,"AD_USER_ID");P&&P.toString().length>0&&(w=parseInt(P))}if(0==w?n.setValue("AD_User_ID",null):(n.setValue("AD_User_ID",w),n.setValue("Bill_User_ID",w)),_){var b=a.getValueOfString(c.CreditStatusSettingOn);if("CH"==b){if(0!=a.getValueOfDouble(c.SO_CreditLimit))a.getValueOfDouble(c.CreditAvailable)<=0&&e.ADialog.info("CreditOver")}else{var M=a.getValueOfInt(n.getValue("C_BPartner_Location_ID")),x=e.dataContext.getJSONRecord("MBPartner/GetLocationData",M.toString());if(null!=x)if("CL"==(b=a.getValueOfString(x.CreditStatusSettingOn)))if(0!=a.getValueOfDouble(x.SO_CreditLimit))a.getValueOfDouble(x.CreditAvailable)<=0&&e.ADialog.info("CreditOver")}}var N=a.getValueOfString(c.POReference);null!=N&&0!=N.length&&n.setValue("POReference",N),null!=(N=a.getValueOfString(c.SO_Description))&&0!=N.trim().length&&n.setValue("Description",N),null!=(N=a.getValueOfString(c.IsDiscountPrinted))&&0!=N.length?n.setValue("IsDiscountPrinted",N):n.setValue("IsDiscountPrinted","N");var L=t.getContext("OrderType");if(n.setValue("InvoiceRule","D"),n.setValue("DeliveryRule","A"),p?"W"!=r&&null!=r?"N"==d?n.setValue("PaymentRule",r):n.setValue("PaymentRulePO",r):("N"==d?n.setValue("PaymentRule","T"):n.setValue("PaymentRulePO","T"),n.setValue("PaymentMethod","T")):n.setValue("PaymentRule","P"),"PR"==L)n.setValue("InvoiceRule","I"),n.setValue("DeliveryRule","R");else if("WR"==L)p?"W"!=r&&null!=r?"N"==d?n.setValue("PaymentRule",r):n.setValue("PaymentRulePO",r):("N"==d?n.setValue("PaymentRule","T"):n.setValue("PaymentRulePO","T"),n.setValue("PaymentMethod","T")):n.setValue("PaymentRule","B");else{p?"W"!=r&&null!=r?"N"==d?n.setValue("PaymentRule",r):n.setValue("PaymentRulePO",r):("N"==d?n.setValue("PaymentRule","T"):n.setValue("PaymentRulePO","T"),n.setValue("PaymentMethod","T")):null!=(N=a.getValueOfString(_?c.PaymentRule:c.PaymentRulePO))&&0!=N.length&&("B"==N&&(N="P"),(_&&"S"==N||"U"==N)&&(N="P"),n.setValue("PaymentRule",N));var R=a.getValueOfInt(n.getValue("C_PaymentTerm_ID"));A=a.getValueOfDecimal(n.getValue("C_Order_Blanket"));if(R>0&&A>0);else m=a.getValueOfInt(_?c.C_PaymentTerm_ID:c.PO_PaymentTerm_ID),this.checkAdvancePaymentTerm(a.getValueOfInt(n.getValue("C_DocTypeTarget_ID")),m)?0!=m&&n.setValue("C_PaymentTerm_ID",m):n.setValue("C_PaymentTerm_ID",null);null!=(N=a.getValueOfString(c.InvoiceRule))&&0!=N.length&&n.setValue("InvoiceRule",N),null!=(N=a.getValueOfString(c.DeliveryRule))&&0!=N.length&&n.setValue("DeliveryRule",N),null!=(N=a.getValueOfString(c.FreightCostRule))&&0!=N.length&&n.setValue("FreightCostRule",N),null!=(N=a.getValueOfString(c.DeliveryViaRule))&&0!=N.length&&n.setValue("DeliveryViaRule",N)}c.hasOwnProperty("VA106_SupplyType")&&n.setValue("VA106_SupplyType",c.VA106_SupplyType)}}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),this.BPartnerBill(t,i,n,l,n.getValue("Bill_BPartner_ID"))},n.prototype.BPartnerLoc=function(i,n,l,s,o,r){var c=null;if(this.isCalloutActive()||null==o||""==o.toString())return"";try{var u=0;if(null!=o&&(u=a.getValueOfInt(o.toString())),0==u)return"";if(a.getValueOfBoolean(l.getValue("IsReturnTrx")))return"";if(this.setCalloutActive(!0),i.isSOTrx(n))if(null!=(c=e.dataContext.getJSONRecord("MBPartner/GetLocationData",u.toString())))if("CL"==a.getValueOfString(c.CreditStatusSettingOn))if(0!=a.getValueOfDouble(c.SO_CreditLimit)){var d=a.getValueOfDouble(c.CreditAvailable);null!=c&&d<=0&&e.ADialog.info("CreditOver",null,"","")}}catch(e){return null!=c&&(c.close(),c=null),this.log.log(t.SEVERE,"",e),this.setCalloutActive(!1),e}this.setCalloutActive(!1)},n.prototype.BPartnerBill=function(i,n,l,s,o,r){if(this.isCalloutActive())return"";if(null==o||""==o.toString())return"";var c=null;try{var u=a.getValueOfInt(o.toString());if(null==u||0==u)return"";if(this.setCalloutActive(!0),a.getValueOfBoolean(l.getValue("IsReturnTrx")))return this.setCalloutActive(!1),"";c=e.dataContext.getJSONRecord("MBPartner/GetBPartnerBillData",u.toString());var d="Y"==i.getWindowContext(n,"IsSOTrx",!0);if(null!=c){var g=a.getValueOfInt(c.Bill_Location_ID);if(u.toString()==i.getContext("C_BPartner_ID")){var p=i.getContext("C_BPartner_Location_ID");p.length>0&&(g=a.getValueOfInt(p))}0==g?l.setValue("Bill_Location_ID",null):l.setValue("Bill_Location_ID",a.getValueOfInt(g));var v=a.getValueOfInt(c.AD_User_ID);if(u.toString()==i.getContext("C_BPartner_ID")){var _=i.getContext("AD_User_ID");_.length>0&&(v=a.getValueOfInt(_))}if(0==v?l.setValue("Bill_User_ID",null):l.setValue("Bill_User_ID",a.getValueOfInt(v.toString())),d);var V=c.POReference;null!=(V=c.SO_Description)&&0!=V.toString().trim().length&&l.setValue("Description",V),null!=(V=c.IsDiscountPrinted)&&0!=V.toString().length?l.setValue("IsDiscountPrinted",V):l.setValue("IsDiscountPrinted","N");var A=i.getContext("OrderType");if(l.setValue("InvoiceRule","D"),l.setValue("PaymentRule","P"),"PR"==A)l.setValue("InvoiceRule","I");else if("WR"==A)l.setValue("PaymentRule","B");else{null!=(V=c[d?"PaymentRule":"PaymentRulePO"])&&0!=V.toString().length&&("B"==V&&(V="P"),!d||"S"!=V&&"U"!=V||(V="P"),l.setValue("PaymentRule",V));var m=a.getValueOfInt(l.getValue("C_PaymentTerm_ID")),f=a.getValueOfDecimal(l.getValue("C_Order_Blanket"));if(m>0&&f>0);else ii=c[d?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"],this.checkAdvancePaymentTerm(a.getValueOfInt(l.getValue("C_DocTypeTarget_ID")),ii)?null!=c&&l.setValue("C_PaymentTerm_ID",ii):l.setValue("C_PaymentTerm_ID",null);null!=(V=c.InvoiceRule)&&0!=V.toString().length&&l.setValue("InvoiceRule",V)}}}catch(e){return this.setCalloutActive(!1),null!=c&&(c.close(),c=null),this.log(t.SEVERE,"bPartnerBill",e),e}return this.setCalloutActive(!1),this.PriceList(i,n,l,s,l.getValue("M_PriceList_ID"))},n.prototype.PriceList=function(i,n,l,s,o,r){var c=null;if(this.isCalloutActive()||null==o||""==o.toString())return"";try{var u=a.getValueOfInt(o.toString());if(null==u||0==u)return"";if(this.setCalloutActive(!0),null!=(c=e.dataContext.getJSONRecord("MPriceList/GetPriceListData",o.toString()))){l.setValue("IsTaxIncluded","Y"==c.IsTaxIncluded),i.setContext(n,"EnforcePriceLimit",c.EnforcePriceLimit);var d=c.C_Currency_ID,g=a.getValueOfInt(l.getValue("C_Currency_ID")),p=a.getValueOfDecimal(l.getValue("C_Order_Blanket"));g>0&&p>0||l.setValue("C_Currency_ID",d);var v=c.M_PriceList_Version_ID;i.setContext(n,"M_PriceList_Version_ID",v)}}catch(e){return this.setCalloutActive(!1),null!=c&&c.close(),this.log(t.SEVERE,"",e),e}return this.setCalloutActive(!1),i=n=l=o=null,""},n.prototype.Product=function(t,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString())return l.setValue("ProductType",null),"";var c=a.getValueOfInt(o);if(null==c||0==c)return"";if("Y"==t.getWindowContext(n,"IsReturnTrx",!0))return"";this.setCalloutActive(!0);try{i,l.setValue("C_Charge_ID",null),l.setValue("M_AttributeSetInstance_ID",null);var u="Y"==t.getWindowContext(n,"IsSOTrx",!0),d=(t.getWindowContext(n,"IsReturnTrx",!0),t.getContextAsInt(n,"C_BPartner_ID",!1)),g=a.getValueOfDecimal(l.getValue("QtyOrdered")),p=t.getContextAsInt(n,"M_PriceList_ID",!1),v=t.getContextAsInt(n,"M_PriceList_Version_ID",!1),_=t.getContextAsInt(n,"M_AttributeSetInstance_ID",!1),V=l.getValue("DateOrdered"),A=2,m=c.toString().concat(",",d.toString(),",",g.toString(),",",u,",",p.toString(),",",v.toString(),",",V.toString(),",",null,",",_.toString());try{var f=e.dataContext.getJSONRecord("MOrderLine/GetProductInfo",m);if(null!=f){l.setValue("PrintDescription",f.DocumentNote),l.findColumn("VAS_HSN_SACCode")>-1&&f.hasOwnProperty("VAS_HSN_SACCode")&&l.setValue("VAS_HSN_SACCode",f.VAS_HSN_SACCode);var D=f.productType.toString();t.setContext(n,"ProductType",D),l.setValue("ProductType",D),"S"==D||(l.setValue("NoofCycle",null),l.setValue("QtyPerCycle",null),l.setValue("StartDate",null),l.setValue("C_Contract_ID",0),l.setValue("EndDate",null),l.setValue("C_Frequency_ID",0)),"Y"==f.IsDropShip.toString()?l.setValue("IsDropShip",!0):l.setValue("IsDropShip",!1),a.getValueOfInt(f.countEd011);var h=0;if((h=a.getValueOfInt(f.purchasingUom)>0?a.getValueOfInt(f.purchasingUom):a.getValueOfInt(f.VAS_PurchaseUOM_ID))>0&&!u?l.setValue("C_UOM_ID",h):a.getValueOfInt(f.VAS_SalesUOM_ID)>0&&u?l.setValue("C_UOM_ID",f.VAS_SalesUOM_ID):l.setValue("C_UOM_ID",a.getValueOfInt(f.headerUom)),a.getValueOfInt(f.StdPrecision),A=a.getValueOfInt(f.PriceListPrecision),h>0&&!u){var C=l.getValue("M_Product_ID").toString().concat(","+t.getAD_Client_ID().toString()+","+l.getValue("C_Order_ID").toString()+","+d.toString()+","+l.getValue("QtyEntered").toString()+","+a.getValueOfString(h)),S=e.dataContext.getJSONRecord("MOrderLine/GetPricesOnProductChange",C);PriceList=a.getValueOfDecimal(S.PriceList),l.setValue("PriceList",PriceList),PriceEntered=a.getValueOfDecimal(S.PriceEntered),l.setValue("PriceEntered",PriceEntered),PriceActual=a.getValueOfDecimal(S.PriceEntered.toFixed(A)),l.setValue("PriceActual",PriceActual),l.setValue("QtyOrdered",a.getValueOfDecimal(S.QtyOrdered.toFixed(S.UOMStdPrecision)))}else l.setValue("PriceList",f.PriceList),l.setValue("PriceLimit",f.PriceLimit),l.setValue("PriceActual",a.getValueOfDecimal(f.PriceActual.toFixed(A))),l.setValue("PriceEntered",a.getValueOfDecimal(f.PriceEntered.toFixed(A))),l.setValue("C_Currency_ID",a.getValueOfInt(f.C_Currency_ID)),l.setValue("Discount",a.getValueOfDecimal(f.Discount.toFixed(A))),l.setValue("QtyOrdered",l.getValue("QtyEntered"));if(t.setContext(n,"EnforcePriceLimit",f.EnforcePriceLimit?"Y":"N"),t.setContext(n,"DiscountSchema",f.DiscountSchema?"Y":"N"),u){var I=a.getValueOfDecimal(l.getValue("QtyOrdered")),y=t.getContextAsInt(n,"M_Warehouse_ID"),O=(_=t.getContextAsInt(n,"M_AttributeSetInstance_ID"),0);null!=l.getValue("C_OrderLine_ID")&&(O=a.getValueOfInt(l.getValue("C_OrderLine_ID"))),null==O&&(O=0);m=c.toString().concat(",",y.toString(),",",_.toString(),",",O.toString());var T=e.dataContext.getJSONRecord("MStorage/GetQtyAvailable",m);if(null==T&&(T=e.Env.ZERO),0==T);else if(T.toString().compareTo(I)<0);else{m=y.toString()+","+c.toString()+","+_.toString()+","+O.toString();var w=e.dataContext.getJSONRecord("MOrderLine/GetNotReserved",m);null==w&&(w=e.Env.ZERO);var P=T-w;if(P.compareTo(I)<0){var b=e.Msg.parseTranslation(t,"@QtyAvailable@="+T+" - @QtyNotReserved@="+w+" = "+P);e.ADialog.info("InsufficientQtyAvailable",!0,b,"")}}}}i}catch(e){return this.log.saveError("calloutorder",e.toString()),this.setCalloutActive(!1),e.message}this.setCalloutActive(!1)}catch(e){this.setCalloutActive(!1),this.log.saveError("calloutorder",e.toString())}return this.setCalloutActive(!1),this.Tax(t,n,l,s,o)},n.prototype.Charge=function(i,n,l,s,o,r){try{if(this.isCalloutActive()||null==o||""==o.toString())return"";this.setCalloutActive(!0);var c=a.getValueOfInt(o);if(null==c||0==c)return this.setCalloutActive(!1),"";if("Y"==i.getContext("IsReturnTrx"))return this.setCalloutActive(!1),"";null!=l.getValue("M_Product_ID")&&l.setValue("M_Product_ID",null),l.setValue("M_AttributeSetInstance_ID",null),l.setValue("S_ResourceAssignment_ID",null);var u=i.getContextAsInt("#C_UOM_ID");u>0?l.setValue("C_UOM_ID",u):l.setValue("C_UOM_ID",100),i.setContext(n,"DiscountSchema","N");var d=e.dataContext.getJSONRecord("MOrder/GetPrecision",l.getValue("C_Order_ID").toString()),g=e.dataContext.getJSONRecord("MCharge/GetChargeDetails",c.toString());null!=g&&(l.setValue("PriceEntered",a.getValueOfDecimal(g.ChargeAmt).toFixed(d)),l.setValue("PrintDescription",a.getValueOfString(g.PrintDescription)),l.setValue("PriceActual",a.getValueOfDecimal(g.ChargeAmt).toFixed(d)),l.setValue("PriceList",a.getValueOfDecimal(g.ChargeAmt).toFixed(d))),l.setValue("PriceLimit",e.Env.ZERO),l.setValue("Discount",e.Env.ZERO)}catch(e){return this.setCalloutActive(!1),this.log.log(t.SEVERE,e.toString()),e}return this.setCalloutActive(!1),this.Tax(i,n,l,s,o)},n.prototype.Tax=function(t,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString())return"";if(console.log("Before Charge Or Product"),0==a.getValueOfInt(l.getValue("C_Charge_ID"))&&0==a.getValueOfInt(l.getValue("M_Product_ID")))return"";this.setCalloutActive(!0);try{var c="",u="",d=a.getValueOfString(l.getValue("M_Product_ID")).concat(",",a.getValueOfString(l.getValue("C_Order_ID"))+","+a.getValueOfString(l.getValue("C_Charge_ID"))),g=e.dataContext.getJSONRecord("MOrderLine/GetTaxId",d),p=a.getValueOfInt(g._CountVATAX),v=(t.getWindowContext(n,"IsSOTrx",!0),"Y"==t.getWindowContext(n,"IsReturnTrx",!0));if(p>0&&(c=a.getValueOfString(g.taxRule)),"T"!=c||v){var _=s.getColumnName();if(null==o)return"";i;var V=0;V="M_Product_ID"==_?a.getValueOfInt(o):a.getValueOfInt(t.getContextAsInt(n,"M_Product_ID"));var A=0;if(A="C_Charge_ID"==_?a.getValueOfInt(o):a.getValueOfInt(t.getContextAsInt(n,"C_Charge_ID")),this.log.fine("Product="+V+", C_Charge_ID="+A),0==V&&0==A)return this.setCalloutActive(!1),this.Amt(t,n,l,s,o);var m=0;if(0==(m="C_BPartner_Location_ID"==_?a.getValueOfInt(o):a.getValueOfInt(t.getContextAsInt(n,"C_BPartner_Location_ID"))))return this.setCalloutActive(!1),this.Amt(t,n,l,s,o);this.log.fine("Ship BP_Location="+m);var f=t.getContext("DateOrdered");this.log.fine("Bill Date="+f);var D=t.getContext("DatePromised");this.log.fine("Ship Date="+D);var h=t.getContextAsInt(n,"AD_Org_ID");this.log.fine("Org="+h);var C=t.getContextAsInt(n,"M_Warehouse_ID");this.log.fine("Warehouse="+C);var S=t.getContextAsInt(n,"Bill_Location_ID");0==S&&(S=m),this.log.fine("Bill BP_Location="+S);var I="Y"==t.getWindowContext(n,"IsSOTrx",!0),y=(u=V.toString()+","+A.toString()+","+f.toString()+","+D.toString()+","+h.toString()+","+C.toString()+","+S.toString()+","+m.toString()+","+I.toString(),e.dataContext.getJSONRecord("MTax/Get_Tax_ID",u));if(this.log.info("Tax ID="+y),0==y);else if(l.setValue("C_Tax_ID",a.getValueOfInt(y)),l.findColumn("C_TaxExemptReason_ID")>-1&&l.findColumn("IsTaxExempt")>-1)null!=(g=e.dataContext.getJSONRecord("MTax/GetTaxExempt",y))&&(l.setValue("C_TaxExemptReason_ID",a.getValueOfInt(g.C_TaxExemptReason_ID)),l.setValue("IsTaxExempt",!!a.getValueOfString(g.IsTaxExempt).equals("Y")));i}else{var O=a.getValueOfInt(g.taxId);if(a.getValueOfInt(O)>0)l.setValue("C_Tax_ID",O),l.findColumn("C_TaxExemptReason_ID")>-1&&l.findColumn("IsTaxExempt")>-1&&(l.setValue("C_TaxExemptReason_ID",a.getValueOfInt(g.C_TaxExemptReason_ID)),l.setValue("IsTaxExempt",!!a.getValueOfString(g.IsTaxExempt).equals("Y")));else{if(a.getValueOfInt(l.getValue("M_Product_ID"))>0)return l.setValue("M_Product_ID",""),this.setCalloutActive(!1),"Y"==g.TaxExempt?e.ADialog.info("TaxNoExemptFound"):e.ADialog.info("VATAX_DefineTax");if(a.getValueOfInt(l.getValue("C_Charge_ID"))>0)return l.setValue("C_Charge_ID",""),this.setCalloutActive(!1),"Y"==g.TaxExempt?e.ADialog.info("TaxNoExemptFound"):e.ADialog.info("VATAX_DefineChargeTax")}}}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),this.Amt(t,n,l,s,o)},n.prototype.Amt=function(t,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString())return"";if(console.log("Before Charge Or Product"),0==a.getValueOfInt(l.getValue("C_Charge_ID"))&&0==a.getValueOfInt(l.getValue("M_Product_ID")))return"";console.log("After Charge Or Product"),this.setCalloutActive(!0);try{i;var c=t.getContextAsInt(n,"C_UOM_ID"),u=t.getContextAsInt(n,"M_Product_ID"),d=t.getContextAsInt(n,"M_PriceList_ID"),g="Y"==t.getWindowContext(n,"IsSOTrx",!0),p=a.getValueOfInt(l.getValue("C_OrderLine_Blanket_ID"))>0,v=a.getValueOfInt(l.getValue("C_Quotation_Line_ID"))>0;v&&(p=v);var _=a.getValueOfDecimal(l.getValue("QtyDelivered"))>0;_||(_=a.getValueOfDecimal(l.getValue("QtyInvoiced"))>0),B=e.dataContext.getJSONRecord("MPriceList/GetPriceList",d.toString());var V,A,m,f,D,h=2,C=2,S="Y",I="N";null!=B&&(h=a.getValueOfInt(B.StdPrecision),C=a.getValueOfInt(B.PriceListPrecision),S=a.getValueOfString(B.EnforcePriceLimit),I=a.getValueOfString(B.IsTaxIncluded)),V=a.getValueOfDecimal(l.getValue("QtyEntered")),A=a.getValueOfDecimal(l.getValue("QtyOrdered")),this.log.fine("QtyEntered="+V+", Ordered="+A+", UOM="+c),R=a.getValueOfDecimal(l.getValue("PriceEntered")),L=a.getValueOfDecimal(l.getValue("PriceActual")),D=a.getValueOfBoolean(l.getValue("VAS_IsDiscountApplied")),U=a.getValueOfDecimal(l.getValue("Discount")),m=a.getValueOfDecimal(l.getValue("PriceLimit")),N=a.getValueOfDecimal(l.getValue("PriceList")),this.log.fine("PriceList="+N+", Limit="+m+", Precision="+C),this.log.fine("PriceEntered="+R+", Actual="+L+", Discount="+U);var y=t.getContextAsInt(n,"C_BPartner_ID",!1);if("QtyEntered"==s.getColumnName()&&a.getValueOfInt(l.getValue("Orig_OrderLine_ID")),"QtyOrdered"!=s.getColumnName()&&"QtyEntered"!=s.getColumnName()&&"M_Product_ID"!=s.getColumnName()||"N"==t.getContext("DiscountSchema"))"PriceActual"==s.getColumnName()?(R=L=a.getValueOfDecimal(o.toFixed(C)),this.log.fine("PriceActual="+L+" -> PriceEntered="+R),l.setValue("PriceEntered",R),l.setValue("PriceActual",L),0==N&&(N=L,l.setValue("PriceList",N))):"PriceEntered"==s.getColumnName()&&(L=R=a.getValueOfDecimal(o.toFixed(C)),this.log.fine("PriceEntered="+R+" -> PriceActual="+L),l.setValue("PriceActual",L),l.setValue("PriceEntered",R));else if(null==A&&(A=V),a.getValueOfInt(l.getValue("Orig_OrderLine_ID"))<=0){y=t.getContextAsInt(n,"C_BPartner_ID",!1);if(!p&&!_){var O=u.toString().concat(",",l.getValue("C_Order_ID").toString()+","+a.getValueOfString(l.getValue("M_AttributeSetInstance_ID"))+","+a.getValueOfString(l.getValue("C_UOM_ID"))+","+t.getAD_Client_ID().toString()+","+y.toString()+","+l.getValue("QtyEntered").toString()+","+g+",1,1"),T=e.dataContext.getJSONRecord("MOrderLine/GetPricesOnChange",O);f=a.getValueOfString(T.DiscountSchema),("M_Product_ID"==s.getColumnName()||("Y"==a.getValueOfString(T.DiscountCalculate)||D)&&0!=a.getValueOfDecimal(T.PriceEntered)||0!=a.getValueOfDecimal(T.PriceEntered)&&0==l.getValue("PriceEntered"))&&(l.setValue("VAS_IsDiscountApplied",a.getValueOfString(T.DiscountCalculate).equals("Y")),N=a.getValueOfDecimal(T.PriceList),l.setValue("PriceList",a.getValueOfDecimal(T.PriceList)),R=a.getValueOfDecimal(T.PriceEntered.toFixed(C)),l.setValue("PriceActual",R),l.setValue("Discount",(a.getValueOfDecimal(l.getValue("PriceList"))-R)/a.getValueOfDecimal(l.getValue("PriceList"))*100))}this.log.fine("QtyChanged -> PriceActual="+R+", PriceEntered="+R+", Discount="+U),L=a.getValueOfDecimal(R.toFixed(C)),l.setValue("PriceEntered",R),t.setContext(n,"DiscountSchema",f)}if("Discount"==s.getColumnName())N>0&&(L=a.getValueOfDecimal((100-U)/100*N),a.scale(L)>C&&(L=L.toFixed(C)),null==(R=L)&&(R=L),l.setValue("PriceActual",L),l.setValue("PriceEntered",R));else{if(0==N)U=e.Env.ZERO;else if(U=a.getValueOfDecimal((N-L)/N*100),isNaN(U))return this.setCalloutActive(!1),"PriceListNotSelected";U=a.getValueOfDecimal(U.toFixed(C)),l.setValue("PriceList",a.getValueOfDecimal(N.toFixed(C))),p||_||l.setValue("Discount",U)}this.log.fine("PriceEntered="+R+", Actual="+L+", Discount="+U);var w,P=g&&null!=S&&"Y"==S;w=e.MRole.getDefault().getIsOverwritePriceLimit();var b="Y"==t.getWindowContext(n,"IsReturnTrx",!0);P&&(w||b)&&(P=!1),P&&0!=m&&L.compareTo(m)<0&&(null==(R=L=m)&&(R=m),this.log.fine("(under) PriceEntered="+R+", Actual"+m),p||_||(l.setValue("PriceActual",m),l.setValue("PriceEntered",R)),e.ADialog.info("UnderLimitPrice",!0,"",""),0!=N&&(U=(U=a.getValueOfDecimal((N-L)/N*100)).toFixed(2),p||_||l.setValue("Discount",U)));var M=V*(R=a.getValueOfDecimal(l.getValue("PriceEntered")));if(V>0&&0==M){var x=a.getValueOfDecimal(l.getValue("C_OrderLine_Blanket_ID"));if(x>0&&null!=(B=e.dataContext.getJSONRecord("MOrderLine/GetOrderLine",x.toString()))){var N=a.getValueOfDouble(B.PriceList),L=a.getValueOfDouble(B.PriceActual),R=a.getValueOfDouble(B.PriceEntered),U=a.getValueOfDouble(B.Discount);null!=R&&(l.setValue("PriceEntered",R),l.setValue("LineNetAmt",R*V),M=R*V),null!=N&&l.setValue("PriceList",N),null!=U&&l.setValue("Discount",U),null!=L&&l.setValue("PriceActual",L)}}a.scale(M)>h&&(M=a.getValueOfDecimal(M.toFixed(h))),this.log.info("LineNetAmt="+M),l.setValue("LineNetAmt",M);var E=e.Env.ZERO;if("TaxAmt"==s.getColumnName())E=l.getValue("TaxAmt");else{var k=l.getValue("C_Tax_ID");if(null!=k){var G=k.toString().concat(",",M.toString(),",","Y"==I,",",h.toString()),B=null;E=e.dataContext.getJSONRecord("MTax/CalculateTax",G),l.setValue("TaxAmt",E),null!=l.getField("SurchargeAmt")&&l.setValue("SurchargeAmt",0)}}"Y"==I?l.setValue("LineTotalAmt",a.getValueOfDecimal(M.toFixed(h))):l.setValue("LineTotalAmt",a.getValueOfDecimal(M.toFixed(h))+a.getValueOfDecimal(E.toFixed(h)))}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),t=n=l=s=o=null,""},n.prototype.IsTaxIncluded=function(t,a){var i=a.getContext("IsTaxIncluded");try{if(0==i.toString().length){var n=a.getContextAsInt(t,"M_PriceList_ID");if(0==n)return!1;null==(i=e.dataContext.getJSONRecord("MPriceList/GetTaxIncluded",n.toString()))&&(i="N"),a.setContext(t,"IsTaxIncluded",i)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return a=t=mTab=mField=value=oldValue=null,"Y"==i},n.prototype.Qty=function(t,n,l,s,o,r){var c="";if(this.isCalloutActive()||null==o||""==o.toString())return"";if(console.log("Before Charge Or Product"),0==a.getValueOfInt(l.getValue("C_Charge_ID"))&&0==a.getValueOfInt(l.getValue("M_Product_ID")))return"";console.log("After Charge Or Product"),this.setCalloutActive(!0);try{var u=t.getContextAsInt(n,"M_Product_ID");i;var d=e.Env.ZERO,g=e.Env.ZERO,p=(e.Env.ZERO,2),v="Y"==t.getContext("IsReturnTrx"),_="Y"==t.getWindowContext(n,"IsSOTrx",!0),V=a.getValueOfInt(l.getValue("C_OrderLine_Blanket_ID"))>0,A=a.getValueOfInt(l.getValue("C_Quotation_Line_ID"))>0;A&&(V=A);var m=t.getContextAsInt(n,"C_BPartner_ID",!1);if(0==u)d=g=a.getValueOfDecimal(l.getValue("QtyEntered")),l.setValue("QtyOrdered",d);else if("C_UOM_ID"==s.getColumnName()||"M_AttributeSetInstance_ID"==s.getColumnName()||"StartDate"==s.getColumnName()||"VAS_ContractLine_ID"==s.getColumnName()){var f=a.getValueOfInt(l.getValue("C_UOM_ID"));g=a.getValueOfDecimal(l.getValue("QtyEntered"));var D=u.toString().concat(",",a.getValueOfString(l.getValue("C_Order_ID"))+","+a.getValueOfString(l.getValue("M_AttributeSetInstance_ID"))+","+a.getValueOfString(l.getValue("C_UOM_ID"))+","+t.getAD_Client_ID().toString()+","+a.getValueOfString(m)+","+g.toString()+","+_+",1,1"),h=e.dataContext.getJSONRecord("MOrderLine/GetPricesOnChange",D);V||(p=a.getValueOfInt(h.PriceListPrecision),l.setValue("PriceList",a.getValueOfDecimal(h.PriceList.toFixed(p))),l.setValue("PriceLimit",a.getValueOfDecimal(h.PriceLimit.toFixed(p))),l.setValue("PriceActual",a.getValueOfDecimal(h.PriceEntered.toFixed(p))),l.setValue("PriceEntered",a.getValueOfDecimal(h.PriceEntered.toFixed(p))));var C=g.toFixed(a.getValueOfInt(h.UOMPrecision));g!=C&&(this.log.fine("Corrected QtyEntered Scale UOM="+f+"; QtyEntered="+g+"->"+C),g=C,l.setValue("QtyEntered",g)),null==(d=h.QtyOrdered)&&(d=g),l.setValue("QtyOrdered",d)}else if("QtyEntered"==s.getColumnName()){f=t.getContextAsInt(n,"C_UOM_ID");g=a.getValueOfDecimal(o),c=f.toString().concat(",");var S=e.dataContext.getJSONRecord("MUOM/GetPrecision",c);C=g.toFixed(a.getValueOfInt(S));g!=C&&(this.log.fine("Corrected QtyEntered Scale UOM="+f+"; QtyEntered="+g+"->"+C),g=C,l.setValue("QtyEntered",g)),c=u.toString().concat(",",f.toString(),",",g.toString()),null==(d=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",c))&&(d=g);var I=g!=d;this.log.fine("UOM="+f+", QtyEntered="+g+" -> "+I+" QtyOrdered="+d),t.setContext(n,"UOMConversion",I?"Y":"N"),l.setValue("QtyOrdered",d)}else if("QtyOrdered"==s.getColumnName()){f=t.getContextAsInt(n,"C_UOM_ID");d=a.getValueOfDecimal(o),c=u.toString().concat(",");var y=S=e.dataContext.getJSONRecord("MProduct/GetUOMPrecision",c),O=d.toFixed(y);d!=O&&(this.log.fine("Corrected QtyOrdered Scale "+d+"->"+O),d=O,l.setValue("QtyOrdered",d)),c=u.toString().concat(",",f.toString(),",",d.toString()),null==(g=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",c))&&(g=d);I=d!=g;this.log.fine("UOM="+f+", QtyOrdered="+d+" -> "+I+" QtyEntered="+g),t.setContext(n,"UOMConversion",I?"Y":"N"),l.setValue("QtyEntered",g)}else d=a.getValueOfDecimal(l.getValue("QtyOrdered"));if(0!=u&&v){var T=a.getValueOfInt(l.getValue("Orig_InOutLine_ID"));if(0!=T){c=T.toString();var w=(R=e.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",c)).MovementQty,P=a.getValueOfDecimal(w);if(P<(d=a.getValueOfDecimal(l.getValue("QtyOrdered")))){t.isSOTrx(n)?e.ADialog.info("QtyShippedAndReturned",null,P.toString(),""):e.ADialog.info("QtyRecievedAndReturnd",null,P.toString(),""),l.setValue("QtyOrdered",P),d=P;f=t.getContextAsInt(n,"C_UOM_ID");c=u.toString().concat(",",f.toString(),",",d.toString()),null==(g=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",c))&&(g=d),l.setValue("QtyEntered",g),this.log.fine("QtyEntered : "+g.toString()+"QtyOrdered : "+d.toString())}}}if(0!=u&&t.isSOTrx(n)&&d>0&&!v){var b=e.dataContext.getJSONRecord("MProduct/GetProduct",u.toString()),M=0;if(a.getValueOfBoolean(b.IsStocked)){var x=t.getContextAsInt(n,"M_Warehouse_ID"),N=t.getContextAsInt(n,"M_AttributeSetInstance_ID"),L=u.toString().concat(",",x.toString(),",",N.toString(),",",M.toString()),R=null,U=e.dataContext.getJSONRecord("MStorage/GetQtyAvailable",L);if(null==U&&(U=e.Env.ZERO),0==U);else if(U.toString().compareTo(d)<0);else{null==(M=""==l.getValue("C_OrderLine_ID")?0:a.getValueOfInt(l.getValue("C_OrderLine_ID")))&&(M=0);var E=R.notReserved;null==E&&(E=e.Env.ZERO);var k=U-E;if(k<d){var G=e.Msg.parseTranslation(t,"@QtyAvailable@="+U+"  -  @QtyNotReserved@="+E+"  =  "+k);e.ADialog.info("InsufficientQtyAvailable",null,G,"")}}}}}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),t=n=l=s=o=null,""},n.prototype.Orig_Order=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";var r=a.getValueOfInt(s);if(null==r||0==r)return"";this.setCalloutActive(!0);try{var c=e.dataContext.getJSONRecord("MOrder/GetOrder",r.toString()),u=e.dataContext.getJSONRecord("MBPartner/GetBPartner",c.C_BPartner_ID.toString());n.setValue("Orig_InOut_ID",null),n.setValue("C_BPartner_ID",a.getValueOfInt(c.C_BPartner_ID)),n.setValue("C_BPartner_Location_ID",a.getValueOfInt(c.C_BPartner_Location_ID)),n.setValue("Bill_BPartner_ID",a.getValueOfInt(c.Bill_BPartner_ID)),n.setValue("Bill_Location_ID",a.getValueOfInt(c.Bill_Location_ID)),0!=c.AD_User_ID&&n.setValue("AD_User_ID",a.getValueOfInt(c.AD_User_ID)),0!=c.Bill_User_ID&&n.setValue("Bill_User_ID",a.getValueOfInt(c.Bill_User_ID)),t.isSOTrx(i)?n.setValue("M_ReturnPolicy_ID",a.getValueOfInt(u.M_ReturnPolicy_ID)):n.setValue("M_ReturnPolicy_ID",a.getValueOfInt(u.PO_ReturnPolicy_ID)),this.setCalloutActive(!1),n.setValue("M_PriceList_ID",a.getValueOfInt(c.M_PriceList_ID)),this.setCalloutActive(!0),n.setValue("PaymentRule",c.PaymentRule),this.checkAdvancePaymentTerm(a.getValueOfInt(n.getValue("C_DocTypeTarget_ID")),a.getValueOfInt(c.C_PaymentTerm_ID))?n.setValue("C_PaymentTerm_ID",a.getValueOfInt(c.C_PaymentTerm_ID)):n.setValue("C_PaymentTerm_ID",null),n.setValue("Bill_Location_ID",a.getValueOfInt(c.Bill_Location_ID)),n.setValue("InvoiceRule",c.InvoiceRule),n.setValue("PaymentRule",c.PaymentRule),n.setValue("DeliveryViaRule",c.DeliveryViaRule),n.setValue("FreightCostRule",c.FreightCostRule);var d=e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_");if(d.VA009_){var g=d.VA009_.toString()+","+r.toString();if(dr=e.dataContext.getJSONRecord("MOrder/GetPaymentMethod",g),null!=dr){var p=a.getValueOfInt(dr.VA009_PaymentMethod_ID);if(p>0){n.setValue("VA009_PaymentMethod_ID",p);var v=a.getValueOfString(dr.VA009_PaymentBaseType);"W"!=v&&null!=v&&(n.setValue("PaymentMethod",v),n.setValue("PaymentRule",v))}}}}catch(e){this.setCalloutActive(!1)}return this.setCalloutActive(!1),t=i=n=s=null,""},n.prototype.Orig_InOut=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";try{var r=a.getValueOfInt(s);if(null==r||0==r)return"";this.setCalloutActive(!0);var c=e.dataContext.getJSONRecord("MInOut/GetInOut",r.toString());n.setValue("C_Project_ID",a.getValueOfInt(c.C_Project_ID)),n.setValue("C_Campaign_ID",a.getValueOfInt(c.C_Campaign_ID)),n.setValue("C_Activity_ID",a.getValueOfInt(c.C_Activity_ID)),n.setValue("AD_OrgTrx_ID",a.getValueOfInt(c.AD_OrgTrx_ID)),n.setValue("User1_ID",a.getValueOfInt(c.User1_ID)),n.setValue("User2_ID",a.getValueOfInt(c.User2_ID)),"Y"==a.getValueOfString(c.IsDropShip)?(n.setValue("M_Warehouse_ID",a.getValueOfInt(c.M_Warehouse_ID)),n.setValue("IsDropShip",!0)):(n.setValue("IsDropShip",!1),n.setValue("M_Warehouse_ID",null))}catch(e){this.setCalloutActive(!1)}return this.setCalloutActive(!1),n=s=null,""},n.prototype.Orig_OrderLine=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";try{var r=a.getValueOfInt(s);if(null==r||0==r)return"";this.setCalloutActive(!0);var c=e.dataContext.getJSONRecord("MOrderLine/GetOrderLine",r.toString());n.setValue("Orig_InOutLine_ID",null),n.setValue("C_Tax_ID",a.getValueOfInt(c.C_Tax_ID)),n.setValue("PriceList",a.getValueOfDecimal(c.PriceList)),n.setValue("PriceLimit",a.getValueOfDecimal(c.PriceLimit)),n.setValue("PriceActual",a.getValueOfDecimal(c.PriceActual)),n.setValue("PriceEntered",a.getValueOfDecimal(c.PriceEntered)),n.setValue("C_Currency_ID",a.getValueOfInt(c.C_Currency_ID)),n.setValue("Discount",a.getValueOfDecimal(c.Discount));var u,d=t.getContextAsInt(i,"M_PriceList_ID");u=e.dataContext.getJSONRecord("MPriceList/GetPriceList",d.toString());var g=a.getValueOfInt(u.StdPrecision),p=a.getValueOfDecimal(n.getValue("QtyOrdered"))*a.getValueOfDecimal(c.PriceActual);a.scale(p)>g&&(p=p.toFixed(g)),this.log.info("LineNetAmt="+p),n.setValue("LineNetAmt",p)}catch(e){this.setCalloutActive(!1)}return this.setCalloutActive(!1),t=i=n=s=null,""},n.prototype.RefPurchaseOrderLine=function(t,a,i,n,l,s){if(null==l||""==l.toString())return"";this.setCalloutActive(!0);var o=e.dataContext.getJSONRecord("MOrderLine/GetOrderLine",l.toString());return"0"!=o.M_Product_ID&&i.setValue("M_Product_ID",o.M_Product_ID),"0"!=o.C_Charge_ID&&i.setValue("C_Charge_ID",o.C_Charge_ID),"0"!=o.M_AttributeSetInstance_ID&&i.setValue("M_AttributeSetInstance_ID",o.M_AttributeSetInstance_ID),"0"!=o.C_UOM_ID&&i.setValue("C_UOM_ID",o.C_UOM_ID),i=l=null,this.setCalloutActive(!1),""},n.prototype.Orig_InOutLine=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";try{var r=a.getValueOfInt(s);if(null==r||0==r)return"";this.setCalloutActive(!0);var c=e.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",r.toString());if(null!=c){n.setValue("C_Project_ID",a.getValueOfInt(c.C_Project_ID)),n.setValue("C_Campaign_ID",a.getValueOfInt(c.C_Campaign_ID)),n.setValue("M_Product_ID",a.getValueOfInt(c.M_Product_ID)),n.setValue("M_AttributeSetInstance_ID",a.getValueOfInt(c.M_AttributeSetInstance_ID)),n.setValue("C_UOM_ID",a.getValueOfInt(c.C_UOM_ID));var u=a.getValueOfDecimal(c.QtyEntered);n.setValue("QtyEntered",u);var d=c.M_Product_ID.toString().concat(",",c.C_UOM_ID.toString(),",",u.toString()),g=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",d);null==g&&(g=u),n.setValue("QtyOrdered",g),"Y"==a.getValueOfString(c.IsDropShip)?(n.setValue("IsDropShip",!0),t.setContext(i,"IsDropShip",a.getValueOfString(c.IsDropShip))):n.setValue("IsDropShip",!1)}}catch(e){this.setCalloutActive(!1)}return this.setCalloutActive(!1),t=i=n=s=null,""},n.prototype.checkAdvancePaymentTerm=function(t,i){var n=!0,l=e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_");if(null!=l&&!l.VA009_)return n;if(0!=a.getValueOfInt(t)&&0!=a.getValueOfInt(i)){var s=t.toString()+","+i.toString();n=e.dataContext.getJSONRecord("MOrder/checkAdvancePaymentTerm",s)}return n},n.prototype.RefPurchaseOrder=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";try{var r=a.getValueOfInt(s);if(null==r||0==r)return"";this.setCalloutActive(!0);var c=e.dataContext.getJSONRecord("MOrder/GetOrder",r.toString());if(null!=c){var u=a.getValueOfDouble(c.C_BPartner_ID),d=a.getValueOfDouble(c.C_BPartner_Location_ID),g=a.getValueOfDouble(c.AD_User_ID),p=a.getValueOfDouble(c.Bill_BPartner_ID),v=a.getValueOfDouble(c.Bill_User_ID),_=a.getValueOfDouble(c.Bill_Location_ID),V=a.getValueOfDouble(c.VAS_ContractMaster_ID),A=a.getValueOfDouble(c.M_PriceList_ID),m=a.getValueOfDouble(c.M_Warehouse_ID),f=a.getValueOfDouble(c.C_PaymentTerm_ID),D=a.getValueOfDouble(c.PaymentRule),h=(a.getValueOfDouble(c.C_Payment_ID),a.getValueOfDouble(c.VA009_PaymentMethod_ID)),C=a.getValueOfDouble(c.C_Currency_ID),S=(a.getValueOfDouble(c.C_Project_ID),a.getValueOfDouble(c.C_Campaign_ID),a.getValueOfDouble(c.C_ProjectRef_ID),a.getValueOfDouble(c.SalesRep_ID)),I=a.getValueOfDouble(c.PriorityRule);0!=u&&null!=u&&n.setValue("C_BPartner_ID",u),0!=d&&null!=d&&n.setValue("C_BPartner_Location_ID",d),0!=g&&null!=g&&n.setValue("AD_User_ID",g),0!=p&&null!=p&&n.setValue("Bill_BPartner_ID",p),0!=v&&null!=v&&n.setValue("Bill_User_ID",v),0!=_&&null!=_&&n.setValue("Bill_Location_ID",_),0!=V&&null!=V&&n.setValue("VAS_ContractMaster_ID",V),0!=A&&null!=A&&n.setValue("M_PriceList_ID",A),0!=m&&null!=m&&n.setValue("M_Warehouse_ID",m),0!=f&&null!=f&&n.setValue("C_PaymentTerm_ID",f),0!=D&&null!=D&&n.setValue("PaymentRule",D),0!=h&&null!=h&&n.setValue("VA009_PaymentMethod_ID",h),0!=C&&null!=C&&n.setValue("C_Currency_ID",C),0!=S&&null!=S&&n.setValue("SalesRep_ID",S),0!=I&&null!=I&&n.setValue("PriorityRule",I),null!=n.getField("C_IncoTerm_ID")&&n.setValue("C_IncoTerm_ID",a.getValueOfInt(c.C_IncoTerm_ID))}}catch(e){this.setCalloutActive(!1)}return this.setCalloutActive(!1),n=s=null,""},e.Model.CalloutOrder=n,e.Utility.inheritPrototype(l,e.CalloutEngine),l.prototype.GetPaymentNote=function(t,a,i,n,l,s){if(null==l||""==l.toString()||""==l)return"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);var o=e.dataContext.getJSONRecord("MPaymentTerm/GetPaymentNote",l.toString());return null!=o&&i.setValue("description",o.DocumentNote),this.setCalloutActive(!1),""},e.Model.CalloutSalesQuotation=l,e.Utility.inheritPrototype(s,e.CalloutEngine),s.prototype.BlanketOrderRef=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";if(this.setCalloutActive(!0),"Blanket_Ref_Order_ID"==n.getColumnName()){var r=e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_");if(r.VA009_)var c=l.toString()+","+r.VA009_;else c=l.toString()+","+!1;var u=e.dataContext.getJSONRecord("MOrder/GetOrderHeader",c);null!=u&&(i.setValue("AD_Client_ID",u.AD_Client_ID),i.setValue("AD_Org_ID",u.AD_Org_ID),i.setValue("Description",u.Description),i.setValue("C_DocTypeTarget_ID",u.C_DocTypeTarget_ID),i.setValue("DateOrdered",o(u.DateOrdered)),i.setValue("DatePromised",o(u.DatePromised)),i.setValue("OrderValidFrom",o(u.OrderValidFrom)),i.setValue("OrderValidTo",o(u.OrderValidTo)),i.setValue("C_BPartner_ID",u.C_BPartner_ID),i.setValue("Bill_BPartner_ID",u.Bill_BPartner_ID),i.setValue("C_BPartner_Location_ID",u.C_BPartner_Location_ID),i.setValue("Bill_Location_ID",u.Bill_Location_ID),i.setValue("AD_User_ID",u.AD_User_ID),i.setValue("Bill_User_ID",u.Bill_User_ID),i.setValue("M_Warehouse_ID",u.M_Warehouse_ID),i.setValue("PriorityRule",u.PriorityRule),i.setValue("M_PriceList_ID",u.M_PriceList_ID),i.setValue("C_IncoTerm_ID",u.C_IncoTerm_ID),i.setValue("C_Currency_ID",u.C_Currency_ID),i.setValue("C_ConversionType_ID",u.C_ConversionType_ID),i.setValue("SalesRep_ID",u.SalesRep_ID),r.VA009_&&i.setValue("VA009_PaymentMethod_ID",u.VA009_PaymentMethod_ID),i.setValue("C_PaymentTerm_ID",u.C_PaymentTerm_ID),i.setValue("C_Campaign_ID",u.C_Campaign_ID),i.setValue("C_Activity_ID",u.C_Activity_ID),i.setValue("AD_OrgTrx_ID",u.AD_OrgTrx_ID),i.setValue("User1_ID",u.User1_ID),i.setValue("User2_ID",u.User2_ID),i.setValue("TotalLines",u.TotalLines),i.setValue("GrandTotal",u.GrandTotal))}return this.setCalloutActive(!1),""},e.Model.CalloutBlanketOrderRef=s}(VIS,jQuery)},6397:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutProductToOpportunity")}function i(){e.CalloutEngine.call(this,"VIS.CalloutPriceListOpp")}function n(){e.CalloutEngine.call(this,"VIS.CalloutMCampaign")}function l(){e.CalloutEngine.call(this,"VIS.CalloutLead")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.ProductInfo=function(a,i,n,l,s,o){if(null==s||""==s.toString())return 0==t.getValueOfInt(n.getValue("M_Product_ID"))&&(n.setValue("PriceList",0),n.setValue("PlannedPrice",0),n.setValue("Discount",0),n.setValue("PlannedMarginAmt",0),n.setValue("PlannedAmt",0),n.setValue("ProductType","")),"";if(0==t.getValueOfInt(n.getValue("M_Product_ID")))return n.setValue("PriceList",0),n.setValue("PlannedPrice",0),n.setValue("Discount",0),n.setValue("PlannedMarginAmt",0),n.setValue("PlannedAmt",0),n.setValue("ProductType",""),"";var r=t.getValueOfInt(n.getValue("C_ProjectTask_ID")),c=t.getValueOfInt(n.getValue("C_ProjectPhase_ID")),u=t.getValueOfInt(n.getValue("C_Project_ID")),d=t.getValueOfInt(n.getValue("M_Product_ID")),g=0,p=0;n.findColumn("M_AttributeSetInstance_ID")>0&&(g=t.getValueOfInt(n.getValue("M_AttributeSetInstance_ID"))),n.findColumn("C_UOM_ID")>0&&(p=t.getValueOfInt(n.getValue("C_UOM_ID")));var v=e.dataContext.getJSONRecord("MProject/GetProductType",d.toString());n.setValue("ProductType",v);var _=r.toString()+","+c.toString()+","+u.toString()+","+d.toString()+","+g.toString()+","+p.toString(),V=e.dataContext.getJSONRecord("MProject/GetProjectDetail",_);if(null!=V){var A=t.getValueOfDecimal(V.PriceList);n.setValue("PriceList",A);var m=t.getValueOfDecimal(V.PriceStd);n.setValue("PlannedPrice",m),n.setValue("PlannedQty",1);var f,D=t.getValueOfDecimal(V.PriceLimit);try{if(f=100*(A-m)/A,isNaN(f))return this.setCalloutActive(!1),e.Msg.getMsg("PriceNotDefined")}catch(e){return this.setCalloutActive(!1),"PriceListNotSelected"}n.setValue("Discount",f.toFixed(2)),n.setValue("PlannedMarginAmt",m-D),0==t.getValueOfInt(n.getValue("C_UOM_ID"))&&n.setValue("C_UOM_ID",V.C_UOM_ID)}else n.setValue("PriceList",0),n.setValue("PlannedPrice",0),n.setValue("Discount",0),n.setValue("PlannedMarginAmt",0),n.setValue("PlannedAmt",0);return n=s=null,""},a.prototype.SetQty=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString()||0==t.getValueOfInt(s))return"";this.setCalloutActive(!0);var r=t.getValueOfInt(n.getValue("C_UOM_ID")),c=n.getValue("PlannedQty");if(null!=n.getValue("M_Product_ID")){var u=t.getValueOfInt(n.getValue("M_Product_ID")).toString().concat(",",r.toString(),",",c.toString()),d=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",u);null!=d?n.setValue("BaseQty",d):n.setValue("BaseQty",c)}else n.setValue("BaseQty",c);return this.setCalloutActive(!1),n=s=null,""},e.Model.CalloutProductToOpportunity=a,e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.PriceList=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";try{var r=e.dataContext.getJSONRecord("MPriceList/GetM_PriceList",t.getValueOfInt(s));null!=r&&Object.keys(r).length>0&&0!=r.M_PriceList_ID&&(n.setValue("M_PriceList_ID",r.M_PriceList_ID),0!=r.C_Currency_id?n.setValue("C_Currency_ID",r.C_Currency_id):e.ADialog.info("CurrencyNotDefinedForThePriceList"))}catch(e){this.setCalloutActive(!1),this.log.saveError("","")}return n=s=null,""},e.Model.CalloutPriceListOpp=i,e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.DateRequired=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";this.setCalloutActive(!0);try{var o,r;o=new Date(i.getValue("DateContract")),(r=new Date(i.getValue("DateFinish"))).toISOString()<o.toISOString()&&(i.setValue("DateFinish",""),this.setCalloutActive(!1),e.ADialog.info("DateInvalid",null,"","")),this.log.fine("DateFinish="+r)}catch(t){return e.ADialog.info("DateError"+t,null,"",""),this.setCalloutActive(!1),t}return this.setCalloutActive(!1),i=l=null,""},e.Model.CalloutMCampaign=n,e.Utility.inheritPrototype(l,e.CalloutEngine),l.prototype.SetFullName=function(e,t,a,i,n,l){if((this.isCalloutActive()||null==n||""==n.toString())&&"LastName"!=i.getColumnName())return"";this.setCalloutActive(!0);var s="";return null!=a.getValue("Firstname")&&(s=a.getValue("Firstname")),null!=a.getValue("LastName")&&""!=a.getValue("LastName")&&(s=""==s?a.getValue("LastName"):s+" "+a.getValue("LastName")),""!=s&&a.setValue("ContactName",s),this.setCalloutActive(!1),a=i=n=null,""},l.prototype.FollowUpDate=function(e,t,a,i,n,l){if(this.isCalloutActive()||null==n||""==n.toString())return"";if(this.setCalloutActive(!0),null!=a.getValue("C_Followupdate")&&null!=a.getValue("C_EnquiryRdate")){var s=new Date(a.getValue("C_Followupdate"));s.setHours(0,0,0,0);var o=new Date(a.getValue("C_EnquiryRdate"));if(o.setHours(0,0,0,0),s<o)return a.setValue("C_Followupdate",""),this.setCalloutActive(!1),"VAS_InCorrectFollowUpDate"}return this.setCalloutActive(!1),a=n=null,""},l.prototype.ExpectedSalesDate=function(e,t,a,i,n,l){if(this.isCalloutActive()||null==n||""==n.toString())return"";if(this.setCalloutActive(!0),null!=a.getValue("ExpectedSalesDate")&&null!=a.getValue("C_EnquiryRdate")){var s=new Date(a.getValue("ExpectedSalesDate"));s.setHours(0,0,0,0);var o=new Date(a.getValue("C_EnquiryRdate"));if(o.setHours(0,0,0,0),s<o)return a.setValue("ExpectedSalesDate",""),this.setCalloutActive(!1),"VAS_InCorrectExpDate"}return this.setCalloutActive(!1),a=n=null,""},l.prototype.setPartnerCategory=function(a,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return n.setValue("C_BP_Group_ID",null),"";this.setCalloutActive(!0);var r=e.dataContext.getJSONRecord("MBPartner/GetPartnerCategory",t.getValueOfInt(s));return n.setValue("C_BP_Group_ID",t.getValueOfInt(r)),this.setCalloutActive(!1),n=s=null,""},e.Model.CalloutLead=l}(VIS,jQuery)},6429:()=>{!function(e){function t(){e.CalloutEngine.call(this,"VIS.CalloutChartOfAccount")}e.Utility.inheritPrototype(t,e.CalloutEngine),t.prototype.ClearBankAccountDetails=function(e,t,a,i,n,l){if(this.isCalloutActive())return"";if(null==n||""==n.toString())return"";try{this.setCalloutActive(!0),null!=a.getValue("C_BankAccount_ID")&&a.setValue("C_BankAccount_ID",null),null!=a.getValue("C_Currency_ID")&&a.setValue("C_Currency_ID",null),a.setValue("IsForeignCurrency",!1)}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),a=n=null,""},t.prototype.ClearForeignCurrencyDetails=function(e,t,a,i,n,l){if(this.isCalloutActive())return"";if(null==n||""==n.toString())return"";try{this.setCalloutActive(!0),null!=a.getValue("C_Currency_ID")&&a.setValue("C_Currency_ID",null)}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),a=n=null,""},e.Model.CalloutChartOfAccount=t}(VIS,jQuery)},6593:()=>{VAS=window.VAS||{},function(e,t){e.VAS_ExpectedInvoiceWidget=function(){var e;this.frame,this.windowNo;var a=null,i=this,n=VIS.Env.getCtx(),l=null,s=0,o=null,r=1,c=1,u=1,d=1,g=500,p=4,v=4,_=null,V=t('<div class="h-100 w-100">'),A=null,m=null,f=[],D=null,h=null,C=null,S=null,I=null,y=null,O=null,T=null,w=!1,P=!1,b=null,M=(h=null,C=null,!1),x=(S=null,null),N=null,L=null,R=[{refernceName:"VAS_ExpectedInvoiceList"},{ColumnName:"C_BPartner_ID"}];function U(){Math.floor(360*Math.random()),Math.floor(16*Math.random());S=t('<div class="vas-exinvd-invoicesListing" id="vas_listContainer_'+o+'">');for(var l=0;l<m.length;l++){s+=1,C=m[0].recordCount;var _="";"GRN"===m[l].RecordType?(P=!1,_=1==VIS.Env.getCtx().isSOTrx(i.windowNo)?VIS.Msg.getMsg("VAS_DeliveryOrder"):VIS.Msg.getMsg("VAS_GRN")):"Order"===m[l].RecordType&&(P=!0,_=1==VIS.Env.getCtx().isSOTrx(i.windowNo)?VIS.Msg.getMsg("VAS_SO"):VIS.Msg.getMsg("VAS_PO"));var D='<div class="vas-exinvd-invoices-box"><div class="vas-exinvd-amtdiv"><h6 class="vas-exinvd-trxtype vas-exinvd-ovrflow" title="'+VIS.Msg.getMsg("VAS_Type")+": "+_+'">'+_+"</h6>";P||(D+='<span id="VAS_GenerateInvoice_'+o+'" class="VAS-exinvd-generate-delivery-btn" data-grnid="'+m[l].Record_ID+'" data-windowid="'+m[l].InvWinID+'" data-totalamt="'+m[l].TotalAmt+'" data-bpname="'+m[l].Name+'" data-documentno="'+m[l].DocumentNo+'" data-stdprecision="'+m[l].stdPrecision+'" data-isfullydelivered="'+m[l].IsFullyDelivered+'" data-ad_org_id="'+m[l].AD_Org_ID+'" title="'+VIS.Msg.getMsg("VAS_GenerateInvoice")+'"><i class="vis vis-action" ></i ></span>'),D+='</div><div class="vas-exinvd-invoices-detail"><div class="vas-exinvd-thumb-w-txt">',D+='<div class="vas-exinvd-company-w-date"><div class="vas-exinvd-com-name vas-exinvd-ovrflow" title="'+(1==VIS.Env.getCtx().isSOTrx(i.windowNo)?VIS.Msg.getMsg("VAS_CustomerPartner"):VIS.Msg.getMsg("VAS_VendorPartner"))+": "+m[l].Name+'">'+m[l].Name+'</div><div class="vas-exinvd-invoiceDate vas-exinvd-ovrflow" title="'+(1==P?VIS.Msg.getMsg("DateOrdered"):VIS.Msg.getMsg("DateDelivered"))+": "+VIS.Utility.Util.getValueOfDate(m[l].OrderdDate).toLocaleDateString(window.navigator.language,{day:"2-digit",month:"2-digit",year:"numeric"})+'">'+(1==P?VIS.Msg.getMsg("DateOrdered"):VIS.Msg.getMsg("DateDelivered"))+": "+VIS.Utility.Util.getValueOfDate(m[l].OrderdDate).toLocaleDateString(window.navigator.language,{day:"2-digit",month:"2-digit",year:"numeric"})+'</div><div class="vas-exinvd-invoiceDate vas-exinvd-ovrflow" title="'+VIS.Msg.getMsg("DatePromised")+": "+VIS.Utility.Util.getValueOfDate(m[l].DatePromised).toLocaleDateString(window.navigator.language,{day:"2-digit",month:"2-digit",year:"numeric"})+'">'+VIS.Msg.getMsg("DatePromised")+": "+VIS.Utility.Util.getValueOfDate(m[l].DatePromised).toLocaleDateString(window.navigator.language,{day:"2-digit",month:"2-digit",year:"numeric"})+'</div></div></div><div class="vas-exinvd-invoice-w-amount" ><div class="vas-exinvd-invoice-lbl vas-exinvd-right-ovrflow" title="'+VIS.Msg.getMsg("DocumentNo")+": "+m[l].DocumentNo+'">'+m[l].DocumentNo+'</div><span><i class="glyphicon glyphicon-zoom-in vas-exinv-zoom" data-Record_ID="'+m[l].Record_ID+'" data-windowId="'+m[l].Window_ID+'" data-Primary_ID="'+m[l].Primary_ID+'" id="VAS-unAllocatedZoom_'+i.windowNo+'" title="'+VIS.Msg.getMsg("VAS_Zoom")+'"></i></span></div></div>',D+='<div class="vas-exinvd-bottomdiv"><div class="vas-exinvd-invoiceTotalAmt vas-exinvd-ovrflow"  title="'+VIS.Msg.getMsg("VAS_Amount")+":"+m[l].TotalAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:m[l].stdPrecision,maximumFractionDigits:m[l].stdPrecision})+'">'+(3!=m[l].Symbol.length?"<span>"+m[l].Symbol+" </span>":"")+m[l].TotalAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:m[l].stdPrecision,maximumFractionDigits:m[l].stdPrecision})+(3==m[l].Symbol.length?" <span>"+m[l].Symbol+"</span>":"")+"</div>",1==VIS.Env.getCtx().isSOTrx(i.windowNo)&&""!=m[l].InvoiceRule&&(D+='<div class="vas-exinvd-com-name vas-exinvd-right-ovrflow vas-exinvd-rulefont" title="'+VIS.Msg.getMsg("VAS_InvoiceRule")+": "+m[l].InvoiceRule+'">'+m[l].InvoiceRule+"</div>"),D+="</div></div>",S.append(D)}V.off("click","#VAS_GenerateInvoice_"+o),V.on("click","#VAS_GenerateInvoice_"+o,function(){if("Y"!=VIS.Utility.Util.getValueOfString(t(this).attr("data-isfullydelivered"))){var a=VIS.Utility.Util.getValueOfInt(t(this).attr("data-grnid")),l=VIS.Utility.Util.getValueOfInt(t(this).attr("data-windowid")),s=(VIS.Utility.Util.getValueOfString(t(this).attr("data-documentno")),parseFloat(t(this).attr("data-totalamt")),VIS.Utility.Util.getValueOfInt(t(this).attr("data-ad_org_id")));VIS.Utility.Util.getValueOfString(t(this).attr("data-bpname")),VIS.Utility.Util.getValueOfInt(t(this).attr("data-stdprecision"));!function(a,l,s,o,r,c,u){if(M||w)M=!1,O[0].remove();else{n.setContext(i.windowNo,"AD_Org_ID",u),M=!0;var d=t('<div class="vas-exinvd-createinvdiv">'+VIS.Msg.getMsg("VAS_CreateInvoice")+"</div>");O=t('<div class="vas-exinvd-filter-flyout">'),DocTypeDiv=t('<div class="vas-exinvd-DocTyperDiv">');var g=t('<div class="input-group vis-input-wrap">'),p="C_DocType.DocBaseType IN ('API','APC','ARI','ARC') AND C_DocType.IsSOTrx='@IsSOTrx@' AND C_DocType.IsReturnTrx='@IsReturnTrx@' AND C_DocType.AD_Org_ID IN(0, @AD_Org_ID@) AND C_DocType.IsExpenseInvoice = 'N' AND C_DocType.IsActive = 'Y'",v=VIS.MLookupFactory.get(VIS.Env.getCtx(),i.windowNo,0,VIS.DisplayType.TableDir,"C_DocType_ID",0,!1,p);I=new VIS.Controls.VComboBox("C_DocType_ID",!0,!1,!0,v,50,VIS.DisplayType.TableDir);var _=t('<div class="vis-control-wrap">'),V=t('<div class="input-group-append">');g.append(_),_.append(I.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append('<label style="background-color: #fff;">'+VIS.Msg.getMsg("VAS_DoctType")+"</label>"),g.append(_),V.append(I.getBtn(0)),g.append(V),DocTypeDiv.append(g),invoiceRefDiv=t('<div class="vas-invoiceRefrDiv">');var m=t('<div class="input-group vis-input-wrap">');y=new VIS.Controls.VTextBox("Name",!0,!1,!0,VIS.DisplayType.Textbox);var f=t('<div class="vis-control-wrap">'),D=t('<div class="input-group-append">');m.append(f),f.append(y.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append('<label style="background-color: transparent;">'+VIS.Msg.getMsg("VAS_InvoiceRefernce")+"</label>"),m.append(f),m.append(D),invoiceRefDiv.append(m),isGenChargesdiv=t("<div class='vis-col'>");var h=t('<div class="input-group vis-input-wrap">');new VIS.Controls.VLabel("GenerateCharges","GenerateCharges",!1,!0),$isGenChargescheckbox=new VIS.Controls.VCheckBox("GenerateCharges",!0,!1,!0,VIS.DisplayType.CheckBox,"CheckBox");var C=t('<div class="vis-control-wrap">'),S=t('<div class="input-group-append">');h.append(C),C.append($isGenChargescheckbox.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+VIS.Msg.getMsg("VAS_GenerateCharges")+"</label>"),h.append(C),h.append(S),isGenChargesdiv.append(h),1==VIS.Env.getCtx().isSOTrx(i.windowNo)?O.append(d).append(DocTypeDiv):O.append(d).append(DocTypeDiv).append(invoiceRefDiv).append(isGenChargesdiv);var T=t('<div class="vas-expay-btndiv">'),P=t('<div class="vas-flyout-footer"><button id="VAS_Apply_'+i.windowNo+'" class="VIS_Pref_btn-2 vas-expay-filtbtn">'+VIS.Msg.getMsg("VAS_CreateInvoice")+"</button></div>"),b=t('<div class="vas-flyout-footer"><button id="VAS_Close_'+i.windowNo+'" class="VIS_Pref_btn-2 vas-expay-filtbtn">'+VIS.Msg.getMsg("VAS_Close")+"</button></div>");T.append(b).append(P),O.append(T),A.append(O),P.find("#VAS_Apply_"+i.windowNo).on("click",function(){if(null!=I.getValue()||0!=VIS.Env.getCtx().isSOTrx(i.windowNo)||""!=y.getValue())if(null!=I.getValue())if(0!=VIS.Env.getCtx().isSOTrx(i.windowNo)||""!=y.getValue()){M=!1;var n=y.getValue(),s=I.getValue(),o=$isGenChargescheckbox.getValue();!function(a,i,n,l,s){e[0].style.visibility="visible",t.ajax({url:VIS.Application.contextUrl+"VAS/PoReceipt/GenerateInvoice",type:"GET",data:{grnid:a,invRef:i,docId:n,IsGenCheck:l},success:function(t){var a=JSON.parse(t);a.C_Invoice_ID>0?(G(a.C_Invoice_ID,s,"C_Invoice_ID"),O[0].remove()):VIS.ADialog.info("","",a.ExceptionMessage),e[0].style.visibility="hidden"},error:function(t,a,i){VIS.ADialog.info(i),e[0].style.visibility="hidden"}})}(a,n,s,o,l)}else VIS.ADialog.info("VAS_InvoiceReferenceIsMandatory");else VIS.ADialog.info("VAS_DoctypeIsMandatory");else VIS.ADialog.info("VAS_DoctypeAndInvRefIsMandatory")}),b.on("click",function(){M=!1,O[0].remove()})}}(a,l,0,0,0,0,s)}else VIS.ADialog.info("VAS_OrderIsNotFullyDelivered")}),s<p&&function(e){for(var t=0;t<e;t++)S.append(a)}(p-s),d=Math.ceil(C/p);var h=t('<div class="vas-exinvd-pagingdiv"><div class="vas-exinvd-slider-arrows" id="vas_arrawcontainer_'+o+'"><i class= "fa fa-arrow-circle-left vas-exinvd-leftar" aria-hidden="true"></i><span class="vas-exinvd-pagespan"><span>'+u+" </span><span>"+VIS.Msg.getMsg("VAS_Of")+" </span><span>"+d+'</span></span > <i class="fa fa-arrow-circle-right vas-exinvd-rightar" aria-hidden="true"></i></div></div>');A.append(S).append(h),V.append(A),1==c&&1==r&&h.find(".fa-arrow-circle-left").addClass("vas-disableArrow"),h.find(".fa-arrow-circle-right").on("click",function(){c++,u++,A.find("#vas_listContainer_"+o).remove(),A.find("#vas_arrawcontainer_"+o).remove(),m=E(f,c,p),v>=f.length?(c=1,v=4,r++,i.intialLoad()):(v+=p,U())}),h.find(".fa-arrow-circle-left").on("click",function(){c--,u--,A.find("#vas_listContainer_"+o).remove(),A.find("#vas_arrawcontainer_"+o).remove(),m=E(f,c,p),v==p?(v=g,r--,i.intialLoad()):(v-=p,U())});var T=Math.ceil(C/g);r>=T&&v>=f.length&&h.find(".fa-arrow-circle-right").addClass("vas-disableArrow"),A.find(".glyphicon-zoom-in").on("click",function(){G(VIS.Utility.Util.getValueOfInt(t(this).attr("data-Record_ID")),VIS.Utility.Util.getValueOfInt(t(this).attr("data-windowId")),VIS.Utility.Util.getValueOfString(t(this).attr("data-Primary_ID")))})}function E(e,t,a){var i=(t-1)*a,n=i+a;return e.slice(i,n)}this.initalize=function(){k(),a=t('<div class="vas-exinvd-invoices-box vas-exinvd-emptydiv"> <h6></h6><div class="vas-exinvd-invoices-detail"><div class="vas-exinvd-thumb-txt"><img src="" alt="" style="width:0px"><div class="vas-exinvd-company-w-date"><div class="vas-exinvd-com-name"></div><div class="vas-exinvd-invoiceDate"></div></div></div><div class="vas-exinvd-invoice-w-amount"><div class="vas-exinvd-invoice-lbl"></div><div class="vas-exinvd-invoiceTotalAmt"><span></span></div></div></div></div>'),(e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>')).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),e[0].style.visibility="visible",V.append(e),o=0!=VIS.Utility.Util.getValueOfInt(this.widgetInfo.AD_UserHomeWidgetID)?this.widgetInfo.AD_UserHomeWidgetID:i.windowNo,A=t('<div class="vas-exinvd-expected-invoice">');var n=t('<div class="vas-exinvd-expected-heading">'),d=t("<h6>"+VIS.Msg.getMsg("VAS_ExpectedInvoice")+"</h6>");l=t("<div class='vas-exinvd-filter dropdown'><div class='vas-exinvd-icondiv'><span class='vas-exinvd-filterspn btn d-flex position-relative' type='button' id='vas_exinvd_dropdownMenu_"+i.windowNo+"'><i class='fa fa-filter vas-exinvd-filterIcon'></i></span></div><div class='vas-exinvd-filterPopupWrap' id='vas_exinvd_FilterPopupWrap_"+i.windowNo+"'></div></div>"),n.append(d).append(l),l.find("#vas_exinvd_dropdownMenu_"+i.windowNo).on("click",function(){!function(){if(w||M)T[0].remove(),w=!1;else{l.addClass("vas-disableArrow"),w=!0,T=t('<div class="vas-exinvd-main-filter-flyout">');var e=1==VIS.Env.getCtx().isSOTrx(i.windowNo)?"AD_Ref_List.Value IN ('AL','SO','DO')":"AD_Ref_List.Value IN ('AL','PO','GR')";D=t('<div class="VAS-ExpectedListDiv" style="padding-bottom: 11px;">'),$ExpectedListDiv=t('<div class="input-group vis-input-wrap">'),$ExpectedListLookUp=VIS.MLookupFactory.get(VIS.Env.getCtx(),i.windowNo,0,VIS.DisplayType.List,"VAS_ExpectedInvoiceList",h.VAS_ExpectedInvoiceList,!1,e),i.vExpectedList=new VIS.Controls.VComboBox("VAS_ExpectedInvoiceList",!0,!1,!0,$ExpectedListLookUp,20),i.vExpectedList.setValue("AL");var a=t('<div class="vis-control-wrap">');$ExpectedListDiv.append(a),a.append(i.vExpectedList.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append('<label style="background-color: #fff;">'+VIS.Msg.getMsg("VAS_ExpectedList")+"</label>"),$ExpectedListDiv.append(a),D.append($ExpectedListDiv);var n=1==VIS.Env.getCtx().isSOTrx(i.windowNo)?"C_BPartner.IsActive='Y' AND C_BPartner.IsCustomer = 'Y' AND C_BPartner.IsSummary = 'N'":"C_BPartner.IsActive='Y' AND C_BPartner.IsVendor = 'Y' AND C_BPartner.IsSummary = 'N'",d=t('<div class="vas-BPartnerDiv">');$BPartnerDiv=t('<div class="input-group vis-input-wrap">');var V=VIS.MLookupFactory.get(VIS.Env.getCtx(),i.windowNo,h.C_BPartner_ID,VIS.DisplayType.Search,"C_BPartner_ID",0,!1,n);b=new VIS.Controls.VTextBoxButton("C_BPartner_ID",!1,!1,!0,VIS.DisplayType.Search,V),1==VIS.Env.getCtx().isSOTrx(i.windowNo)?b.setCustomInfo("VAS_Customer"):b.setCustomInfo("VAS_VendorEmployee");var m=t('<div class="vis-control-wrap">'),f=t('<div class="input-group-append">');$BPartnerDiv.append(m),m.append(b.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append('<label style="background-color: transparent;">'+(1==VIS.Env.getCtx().isSOTrx(i.windowNo)?VIS.Msg.getMsg("VAS_CustomerPartner"):VIS.Msg.getMsg("VAS_VendorPartner"))+"</label>"),$BPartnerDiv.append(m),f.append(b.getBtn(0)),$BPartnerDiv.append(f),d.append($BPartnerDiv);var C=t('<div class="vas-expay-dateWidth vas-FromdateDiv">');$FromDatewrapDiv=t('<div class="input-group vis-input-wrap">'),$FromDate=new VIS.Controls.VDate("DateReport",!1,!1,!0,VIS.DisplayType.Date,"DateReport");var S=t('<div class="vis-control-wrap">');$FromDatewrapDiv.append(S),S.append($FromDate.getControl().attr("placeholder"," ").attr("data-placeholder","")).append('<label class="vas-expay-lablels" style="color:black;">'+VIS.Msg.getMsg("VAS_FromDate")+"</label>"),C.append($FromDatewrapDiv);var I=t('<div class="vas-expay-dateWidth vas-todateDiv">');$toDatewrapDiv=t('<div class="input-group vis-input-wrap">'),$ToDate=new VIS.Controls.VDate("DateReport",!1,!1,!0,VIS.DisplayType.Date,"DateReport");var y=t('<div class="vis-control-wrap">');$toDatewrapDiv.append(y),y.append($ToDate.getControl().attr("placeholder"," ").attr("data-placeholder","")).append('<label class="vas-expay-lablels" style="color:black;">'+VIS.Msg.getMsg("VAS_ToDate")+"</label>"),I.append($toDatewrapDiv);var P=t('<div class="vas-expay-datefilter">');P.append(C).append(I),T.append(D).append(d).append(P);var R=t('<div class="vas-expay-btndiv">'),U=t('<div class="vas-flyout-footer"><button id="VAS_Apply_'+i.windowNo+'" class="VIS_Pref_btn-2 vas-expay-filtbtn">'+VIS.Msg.getMsg("VAS_Apply")+"</button></div>"),E=t('<div class="vas-flyout-footer"><button id="VAS_Close_'+i.windowNo+'" class="VIS_Pref_btn-2 vas-expay-filtbtn">'+VIS.Msg.getMsg("VAS_Clear")+"</button></div>");R.append(E).append(U),T.append(R),A.append(T),null==x&&null==_&&null==N&&null==L||(i.vExpectedList.setValue(x),b.setValue(_),$FromDate.setValue(N),$ToDate.setValue(L));var k=U.find("#VAS_Apply_"+i.windowNo);b.fireValueChanged=function(){_=b.value},k.on("click",function(){if($FromDate.getValue()>$ToDate.getValue())return VIS.ADialog.info("VAS_PlzEnterCorrectDate"),void $ToDate.setValue(null);A.find("#vas_listContainer_"+o).remove(),A.find("#vas_arrawcontainer_"+o).remove(),A.find("#vas_norecordcont_"+o).remove(),x=i.vExpectedList.getValue(),N=$FromDate.getValue(),L=$ToDate.getValue(),w=!1,r=1,c=1,u=1,g=500,p=4,s=0,v=4,i.intialLoad(),null!=O&&O[0].remove(),T[0].remove()}),E.on("click",function(){"AL"==i.vExpectedList.oldValue&&i.vExpectedList.setValue(null),i.vExpectedList.setValue("AL"),b.setValue(null),$FromDate.setValue(null),$ToDate.setValue(null),_=null,x=null,N=null,L=null,null!=O&&O[0].remove()}),setTimeout(function(){l.removeClass("vas-disableArrow")},2e3)}}()}),A.append(n)},this.intialLoad=function(){e[0].style.visibility="visible",VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetExpectedInvoiceData",{ISOtrx:VIS.Env.getCtx().isSOTrx(i.windowNo),pageNo:r,pageSize:g,ListValue:x,C_BPartner_ID:_,fromDate:N,toDate:L},function(t){null!=(f=t)&&f.length>0?(0==c&&(c=Math.ceil(f.length/p)),m=E(f,c,p),U()):(A.append('<div class="vas-igwidg-notfounddiv" id="vas_norecordcont_'+o+'">'+VIS.Msg.getMsg("VAS_RecordNotFound")+"</div>"),V.append(A)),e[0].style.visibility="hidden"})};var k=function(){h=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetColumnIDForExpPayment",{refernceName:JSON.stringify(R)},null)};function G(e,t,a){if(t>0){var i=new VIS.Query;i.addRestriction(a,VIS.Query.prototype.EQUAL,e),i.setRecordCount(1),VIS.viewManager.startWindow(t,i)}}this.getRoot=function(){return V},this.refreshWidget=function(){e[0].style.visibility="visible",A.find("#vas_listContainer_"+o).remove(),A.find("#vas_arrawcontainer_"+o).remove(),A.find("#vas_norecordcont_"+o).remove(),r=1,c=1,g=500,u=1,s=0,p=4,v=4,i.intialLoad()}},e.VAS_ExpectedInvoiceWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad()},50)},e.VAS_ExpectedInvoiceWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_ExpectedInvoiceWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_ExpectedInvoiceWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},6656:()=>{!function(e,t){function a(t){var a=this.$super;a.constructor(t);var i=this,n=t.getWindowNo();!function(){if(null==a.mTab.getValue("C_BankStatement_ID"))return e.ADialog.error(e.Msg.getMsg("SaveErrorRowNotFound",!0)),!1;a.title=e.Msg.getElement(e.Env.getCtx(),"C_BankStatement_ID",!1)+" .. "+e.Msg.getMsg("CreateFrom"),a.relatedToOrg=null,null!=a.lblOrder&&a.lblOrder.getControl().css("display","none");null!=a.cmbOrder&&a.cmbOrder.getControl().css("display","none");null!=a.lblShipment&&a.lblShipment.getControl().css("display","none");null!=a.cmbShipment&&a.cmbShipment.getControl().css("display","none");null!=a.lblInvoice&&a.lblInvoice.getControl().css("display","none");null!=a.cmbInvoice&&a.cmbInvoice.getControl().css("display","none");var t=e.MLookupFactory.getMLookUp(e.Env.getCtx(),n,4917,e.DisplayType.TableDir);a.cmbBankAccount=new e.Controls.VComboBox("C_BankAccount_ID",!0,!0,!0,t,150,e.DisplayType.TableDir,0),a.Date=new e.Controls.VDate("Date",!1,!1,!0,e.DisplayType.Date,"Date"),a.DocumentNo=new e.Controls.VTextBox("DocumentNo",!1,!1,!0,50,100,null,null,!1),a.Amount=new e.Controls.VAmountTextBox("Amount",!1,!1,!0,50,100,e.DisplayType.Amount,e.Msg.getMsg("Amount")),a.DepositSlip=new e.Controls.VTextBox("DepositSlip",!1,!1,!0,50,100,null,null,!1),a.AuthCode=new e.Controls.VTextBox("AuthCode",!1,!1,!0,50,100,null,null,!1),a.CheckNo=new e.Controls.VTextBox("CheckNo",!1,!1,!0,50,100,null,null,!1),a.cmbBankAccount.getControl().prop("selectedIndex",0);var l=e.Env.getCtx().getContextAsInt(n,"C_BankAccount_ID");a.cmbBankAccount.setValue(l),i.initBPartner(l),i.loadBankAccounts(l,0,"","","","","","0",1),a.btnRefresh&&a.btnRefresh.css("display","black")}(),a.jbInit(),a.initOK=!0,a.middelDiv.css("height","61%"),this.disposeComponent=function(){this.disposeComponent=null}}e.Utility.inheritPrototype(a,e.VCreateFrom),a.prototype.initBPartner=function(t){var a=this.$super,i=" C_BPartner.C_BPartner_ID IN (SELECT  p.C_BPartner_ID as C_BPartner_ID FROM C_Payment p WHERE p.Processed='Y' AND p.IsReconciled='N' AND p.DocStatus IN ('CO','CL','RE','VO') AND p.PayAmt<>0 AND p.C_BankAccount_ID = "+t+" AND NOT EXISTS (SELECT * FROM C_BankStatementLine l WHERE p.C_Payment_ID=l.C_Payment_ID AND l.StmtAmt <> 0) )",n=e.MLookupFactory.get(e.Env.getCtx(),this.windowNo,5398,e.DisplayType.Search,"C_BPartner_ID",0,!1,i);a.vBPartner=new e.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,e.DisplayType.Search,n)},a.prototype.getTableFieldVOs=function(){var t=this.$super;t.arrListColumns=[],t.arrListColumns.push({field:"Date",caption:e.Msg.getMsg("DateAcct"),sortable:!0,size:"100px",hidden:!1,editable:{type:"date"},render:function(e,t,a){var i=e.Date;return new Date(i).toLocaleDateString()}}),t.arrListColumns.push({field:"C_Payment_ID",caption:e.Msg.getMsg("Payment"),sortable:!0,size:"100px",hidden:!1}),t.arrListColumns.push({field:"C_Currency_ID",caption:e.Msg.getMsg("Currency"),sortable:!0,size:"80px",hidden:!1}),e.Utility.Util.getValueOfInt(s("VIS_145"))>0&&t.arrListColumns.push({field:"VA034_DepositSlipNo",caption:e.Msg.getMsg("DepositSlipNo"),sortable:!0,size:"100px",hidden:!1}),t.arrListColumns.push({field:"AuthCode",caption:e.Msg.getMsg("AuthCode"),sortable:!0,size:"100px",hidden:!1}),t.arrListColumns.push({field:"CheckNo",caption:e.Msg.getMsg("CheckNo"),sortable:!0,size:"80px",hidden:!1}),t.arrListColumns.push({field:"Amount",caption:e.Msg.getMsg("Amount"),sortable:!0,size:"80px",hidden:!1,render:function(t,a,i){return e.Utility.Util.getValueOfDecimal(t.Amount).toLocaleString()}}),t.arrListColumns.push({field:"ConvertedAmount",caption:e.Msg.getMsg("ConvertedAmount"),sortable:!0,size:"80px",hidden:!1,render:function(t,a,i){return e.Utility.Util.getValueOfDecimal(t.ConvertedAmount).toLocaleString()}}),t.arrListColumns.push({field:"Description",caption:e.Msg.getMsg("Description"),sortable:!0,size:"250px",hidden:!1}),t.arrListColumns.push({field:"C_BPartner_ID",caption:e.Msg.getMsg("BusinessPartner"),sortable:!0,size:"150px",hidden:!1}),t.arrListColumns.push({field:"Type",caption:e.Msg.getMsg("Type"),sortable:!0,size:"80px",hidden:!0}),t.arrListColumns.push({field:"C_Payment_ID_K",caption:e.Msg.getMsg("Payment"),sortable:!0,size:"150px",hidden:!0}),t.arrListColumns.push({field:"C_Currency_ID_K",caption:e.Msg.getMsg("Currency"),sortable:!0,size:"150px",hidden:!0})},a.prototype.loadBankAccounts=function(t,a,i,n,l,s,o,r,c){var u=this.$super.mTab.getValue("StatementDate");this.getBankAccountsData(e.Env.getCtx(),t,a,i,u,n,l,s,o,r,c);this.getTableFieldVOs()},a.prototype.getBankAccountsData=function(a,i,n,l,s,o,r,c,u,d,g){var p=this;if(null!=p.$super.dGrid){var v=p.$super.dGrid.getSelection();for(item in v){t.grep(p.$super.multiValues,function(e,t){return e.C_Payment_ID_K==p.$super.dGrid.get(v[item]).C_Payment_ID_K}).length>0||p.$super.multiValues.push(p.$super.dGrid.get(v[item]))}}null==s&&(s=DateTime.Today.Date);var _=e.DB.to_date(s,!0),V="",A="",m="0",f="",D="";(n>0&&(m=" AND p.C_BPartner_ID = "+n),""!=o&&(f=" AND p.DocumentNo LIKE '"+o+"'"),""!=l&&null!=l)&&(V=" AND p.DateAcct = "+e.DB.to_date(l,!0));(""!=o&&(D=" AND cs.DocumentNo LIKE '"+o+"'"),""!=l&&null!=l)&&(A=" AND cs.DateAcct = "+e.DB.to_date(l,!0));return g||(g=1),t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetBankAccountsData",dataType:"json",type:"POST",data:{pageNo:g,dates:_,trxDatess:V,trxDatesUnions:A,cBPartnerIDs:m,DocumentNos:f,DocumentNoUnions:D,DepositSlips:r,AuthCodes:c,CheckNos:u,Amounts:d,cBankAccountId:i},error:function(){alert(e.Msg.getMsg("ErrorWhileGettingData")),p.$super.setBusy(!1)},success:function(t){var a=JSON.parse(t);if(a.Error)return e.ADialog.error(a.Error),void p.$super.setBusy(!1);p.$super.resetPageCtrls(a.pSetting),p.$super.loadGrid(a.data),p.$super.setBusy(!1)}}),[]},a.prototype.loadBankAccount=function(t){var a=this.$super,i=a.mTab.getValue("StatementDate"),n=this.getBankAccountData(e.Env.getCtx(),t,i);this.getTableFieldVOs(),setTimeout(function(){a.loadGrid(n)},10)},a.prototype.getBankAccountData=function(a,i,n){var l=[];try{null==n&&(n=DateTime.Today.Date);var s=null;t.ajax({url:e.Application.contextUrl+"Form/GetBankAccontData",async:!1,data:{C_BankAccount_ID:i,ts:n}}).done(function(t){s=(new e.DB.DataReader).toJson(t)});for(var o=1;s.read();){var r={};r.Date=s.getString(0),r.C_Payment_ID=s.getString(2),r.C_Currency_ID=s.getString(4),r.Amount=s.getDecimal(5),r.ConvertedAmount=s.getDecimal(6),r.C_BPartner_ID=s.getString(7),r.Type=s.getString(8),r.C_Payment_ID_K=s.getString(1),r.C_Currency_ID_K=s.getInt(3),r.recid=o,o++,l.push(r)}}catch(e){}return l};var i=e.Application.contextUrl,n=i+"JsonData/JDataSetWithCode";function l(e,a,i){var l=null;return t.ajax({url:n,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:a,data:JSON.stringify(e)}).done(function(e){l=e,i&&i(e)}),l}var s=function(t,a,i){var n=!!i,s=null;return l({sql:t,page:1,pageSize:0},n,function(t){a=(new e.DB.DataSet).toJson(t);var a=(new e.DB.DataSet).toJson(t);s=a.getTable(0).getRows().length>0?a.getTable(0).getRow(0).getCell(0):null,a.dispose(),a=null,n&&i(s)}),s};a.prototype.saveStatment=function(){if(null==this.$super.dGrid)return!1;var e=this.$super.mTab.getValue("C_BankStatement_ID"),t={},a=this.$super.multiValues;if(null==a)return!1;if(a.length<=0)return!1;for(var i=0;i<a.length;i++)t[i]=a[i];return this.saveData(t,"",e)},a.prototype.saveData=function(a,i,n){var l=this;t.ajax({type:"POST",url:e.Application.contextUrl+"Common/SaveStatment",dataType:"json",data:{model:a,selectedItems:i,C_BankStatement_ID:n},success:function(e){if(returnValue=e.result,returnValue)return l.dispose(),l.$super.$root.dialog("close"),void l.$super.setBusy(!1);l.$super.setBusy(!1),alert(returnValue)},error:function(e,t,a){console.log(t),l.$super.setBusy(!1),alert(a)}})},a.prototype.dispose=function(){null!=this.disposeComponent&&this.disposeComponent()},e.VCreateFromStatement=a}(VIS,jQuery)},6943:()=>{VAS=window.VAS||{},function(e,t){e.VAS_ExpectedGRNWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[],r=0;this.initalize=function(){const a='<div id="VAS_DeliveryContainer_'+(l=this.widgetInfo.AD_UserHomeWidgetID)+'" class="VAS-grn-container">    <div class="VAS-deliveries-heading">        <h6>'+VIS.Msg.getMsg("VAS_ExpectedGRN")+'</h6>    </div>    <div class="VAS-delivery-count">        <div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_GRNCount")+' <span id="VAS_DeliveryCount_'+l+'">0</span></div>    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">        </div>    </div>    <div class="VAS-height-container">        <div id="VAS_DeliveryBox_'+l+'" class="VAS-deliveries-listing">        </div>        <div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing">        </div>    </div><div class="VAS-pagination-container"></div></div>';e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append(a)},this.intialLoad=function(c){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_DeliveryContainer_"+l).show(),t.ajax({url:VIS.Application.contextUrl+"Product/GetExpectedDelivery",data:{pageNo:c,pageSize:4,Type:"EG"},dataType:"json",success:function(u){u=JSON.parse(u);if(n.find("#VAS_DeliveryBox_"+l).empty(),n.find("#VAS_OrderContainer").remove,null!=u&&null!=u.Orders&&u.Orders.length>0){for(i=0;i<u.Orders.length;i++){var d='<div id="VAS_OrderContainer_'+l+'" class="VAS-delivery-box" >    <div class="VAS-box-heading">        <div class="VAS-icon-w-name">            <i class="fa fa-file-text" aria-hidden="true"></i>            <div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor"                 title="'+VIS.Msg.getMsg("Document_No")+'"                 data-doc-no="'+u.Orders[i].DocumentNo+'"                 data-customer-name="'+u.Orders[i].CustomerName+'"                 data-orderid="'+u.Orders[i].C_Order_ID+'">                '+u.Orders[i].DocumentNo+'            </div>        </div>        <div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+u.Orders[i].LineCount+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("Vendor")+'">'+u.Orders[i].CustomerName+'</div>    </div>    <div class="VAS-spaceBetween-col grid-2-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_VendorLocation")+'">'+u.Orders[i].DeliveryLocation+'</div>        <div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_ProductLocation")+'">'+u.Orders[i].ProductLocation+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+u.Orders[i].Symbol+"</span> "+u.Orders[i].GrandTotal.toLocaleString()+"</div>    </div></div>";n.find("#VAS_DeliveryBox_"+l).append(d)}s=[],u.Orders.forEach(function(e){e.OrderLines&&e.OrderLines.length>0&&(s[e.DocumentNo]=e.OrderLines)}),1==c&&(n.find("#VAS_DeliveryCount_"+l).text(u.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/4);var s=t('<div class="VAS-slider-arrows VAS-orders-text-white">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(u.RecordCount),r=u.AD_Window_ID),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){!function(i,c,u){n.find("#VAS_DeliveryContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var d='<div id="VAS_ProductContainer_'+l+'" class="VAS-grn-container"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-deliveries-heading">        <h6>            <span id="VAS_BackTodelivery_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToGRN")+'        </h6><span id="VAS_GenerateGRN_'+l+'" class="VAS-generate-delivery-btn" data-orderid="'+u+'" title="'+VIS.Msg.getMsg("VAS_GenerateGRN")+'"><i class="vis vis-action"></i></span>     </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading VAS-orders-text-white">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text VAS-orders-text-white" aria-hidden="true"></i>                    <div class="VAS-doc-no VAS-orders-text-white" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>                <div class="VAS-expectedTxt" title="'+VIS.Msg.getMsg("Vendor")+'">'+c+'</div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count VAS-orders-text-white"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(d);var g=s[i]||[],p=6,v=Math.ceil(g.length/p),_=1;function V(e){e<1&&(e=1),e>v&&(e=v);var t=((_=e)-1)*p,a=Math.min(t+p,g.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s=g[i],r=o.includes(s.C_OrderLine_ID);n.find("#VAS_OrderLine_"+l).append('            <div class="VAS-delivery-box">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-orderlineid="'+s.C_OrderLine_ID+'"'+(r?" checked":"")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+s.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count"><span title="'+VIS.Msg.getMsg("VAS_RemianingQty")+'">'+s.QtyEntered+'</span></div>                </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+s.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+s.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(g.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details VAS-orders-text-white">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+_+VIS.Msg.getMsg("VAS_Of")+v+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}g.length>0&&V(_);function A(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateGRN",data:{C_Order_ID:i,C_OrderLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).Shipment_ID>0)try{if(r>0){var i={TabWhereClause:"M_InOut.M_InOut_ID="+t.Shipment_ID,TabLayout:"Y",TabIndex:"0"};a.widgetFirevalueChanged(i),a.currentPage=1,a.intialLoad(a.currentPage)}}catch(e){console.log(e)}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_DeliveryOrderNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}}),console.log("Generating delivery order for ID:",i)}n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackTodelivery_"+l),n.off("click","#VAS_GenerateGRN_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){V(_-1)}),n.on("click","#VAS_NextPage_"+l,function(){V(_+1)}),n.on("click","#VAS_BackTodelivery_"+l,function(){n.find("#VAS_DeliveryContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("orderlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateGRN_"+l).show():n.find("#VAS_GenerateGRN_"+l).hide(),console.log(o)}),n.on("click","#VAS_GenerateGRN_"+l,function(){A(t(this).data("orderid"))}),n.find("#VAS_GenerateGRN_"+l).hide()}(t(this).data("doc-no"),t(this).data("customer-name"),t(this).data("orderid"))})}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_ExpectedGRNWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_ExpectedGRNWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_ExpectedGRNWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_ExpectedGRNWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_ExpectedGRNWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_ExpectedGRNWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},6997:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.CalloutTeamForcast")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.ProductInfo=function(t,i,n,l,s,o){if(null==s||""==s.toString()||0==a.getValueOfInt(s))return"";var r;if(null==(r=s)||0==r)return"";if(null==(r=t.getContextAsInt(i,"M_Product_ID"))||0==r)return"";var c=t.getContextAsInt(i,"M_PriceList_ID"),u=t.getContextAsInt(i,"M_AttributeSetInstance_ID");if(0!=c){var d=r.toString()+", "+c.toString()+","+u.toString(),g=e.dataContext.getJSONRecord("MTeamForcast/GetProductPrice",d);0!=g&&(n.setValue("PriceStd",g),n.setValue("UnitPrice",g),n.setValue("PriceStd",g*a.getValueOfDecimal(n.getValue("QtyEntered"))),n.setValue("TotalPrice",g*a.getValueOfDecimal(n.getValue("QtyEntered"))))}else e.ADialog.info("PriceLisetNotFound");return t=i=n=s=null,""},i.prototype.Charge=function(e,a,i,n,l,s){try{if(this.isCalloutActive()||null==l||""==l.toString())return"";this.setCalloutActive(!0),null!=i.getValue("M_Product_ID")&&(i.setValue("M_Product_ID",null),i.setValue("M_AttributeSetInstance_ID",null));var o=e.getContextAsInt("#C_UOM_ID");o>0?i.setValue("C_UOM_ID",o):i.setValue("C_UOM_ID",100)}catch(e){return this.setCalloutActive(!1),this.log.log(t.SEVERE,sql,e),e}this.setCalloutActive(!1)},i.prototype.CalculatePrice=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString()||a.getValueOfInt(s)<=0)return"";this.setCalloutActive(!0);var r=e.dataContext.getJSONRecord("MCurrency/GetCurrency",a.getValueOfString(t.getContextAsInt(i,"C_Currency_ID"))),c=a.getValueOfDecimal(n.getValue("UnitPrice"))*a.getValueOfDecimal(n.getValue("BaseQty"));return n.setValue("PriceStd",c.toFixed(a.getValueOfInt(r.StdPrecision))),n.setValue("TotalPrice",c.toFixed(a.getValueOfInt(r.StdPrecision))),this.setCalloutActive(!1),t=i=n=s=null,""},i.prototype.Qty=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString()||0==a.getValueOfInt(s))return"";this.setCalloutActive(!0);var r=n.getValue("C_UOM_ID");null==r&&(r=t.getContextAsInt(i,"C_UOM_ID"));var c=n.getValue("BaseQty"),u=e.dataContext.getJSONRecord("MCurrency/GetCurrency",a.getValueOfString(t.getContextAsInt(i,"C_Currency_ID")));if(null!=n.getValue("M_Product_ID")){var d=n.getValue("M_Product_ID").toString().concat(",",r.toString(),",",c.toString()),g=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",d);null!=g?n.setValue("QtyEntered",g):n.setValue("QtyEntered",c)}else n.setValue("QtyEntered",c);return 0!=a.getValueOfDecimal(n.getValue("UnitPrice"))&&0!=c&&(n.setValue("PriceStd",(c*n.getValue("UnitPrice")).toFixed(a.getValueOfInt(u.StdPrecision))),n.setValue("TotalPrice",(c*n.getValue("UnitPrice")).toFixed(a.getValueOfInt(u.StdPrecision)))),this.setCalloutActive(!1),t=i=n=s=null,""},i.prototype.Currency=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString()||0==a.getValueOfInt(s))return"";this.setCalloutActive(!0);var r=e.dataContext.getJSONRecord("MPriceList/GetPriceListData",a.getValueOfString(n.getValue("M_PriceList_ID")));return null!=r.C_Currency_ID&&n.setValue("C_Currency_ID",r.C_Currency_ID),this.setCalloutActive(!1),n=s=null,""},i.prototype.ProductPrice=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString()||0==a.getValueOfInt(s))return null==n.getValue("M_Product_ID")&&(n.setValue("PriceStd",0),n.setValue("TotalPrice",0),n.setValue("UnitPrice",0),n.setValue("QtyEntered",1),n.setValue("BaseQty",1)),"";if(this.setCalloutActive(!0),t.getContextAsInt(i,"M_PriceList_ID")>0){var r=e.dataContext.getJSONRecord("MCurrency/GetCurrency",a.getValueOfString(t.getContextAsInt(i,"C_Currency_ID"))),c=a.getValueOfString(n.getValue("M_Product_ID")).concat(",",a.getValueOfString(n.getValue("M_AttributeSetInstance_ID")),",",a.getValueOfString(t.getContextAsInt(i,"M_PriceList_ID")),",",a.getValueOfString(n.getValue("C_UOM_ID"))),u=e.dataContext.getJSONRecord("MProductPricing/GetProductdata",c);null!=u&&(n.setValue("PriceStd",u.PriceStd),n.setValue("UnitPrice",u.PriceStd),n.setValue("PriceStd",(u.PriceStd*a.getValueOfDecimal(n.getValue("BaseQty"))).toFixed(a.getValueOfInt(r.StdPrecision))),n.setValue("TotalPrice",(u.PriceStd*a.getValueOfDecimal(n.getValue("BaseQty"))).toFixed(a.getValueOfInt(r.StdPrecision))),0==a.getValueOfInt(n.getValue("C_UOM_ID"))&&n.setValue("C_UOM_ID",u.C_UOM_ID),n.findColumn("IsBOM")>0&&n.setValue("IsBOM",u.IsBOM))}var d=e.dataContext.getJSONRecord("MTeamForcast/GetBOMdetails",a.getValueOfString(n.getValue("M_Product_ID")));return null!=d&&(n.setValue("BOMUse",d.BOMUse),n.setValue("VAMFG_M_Routing_ID",d.VAMFG_M_Routing_ID),n.setValue("M_BOM_ID",d.M_BOM_ID)),this.setCalloutActive(!1),t=i=n=s=null,""},i.prototype.AccountDate=function(i,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString())return"";try{this.setCalloutActive(!0);var c=a.getValueOfString(l.getValue("AD_Client_ID")).concat(",",a.getValueOfString(l.getValue("DateAcct")),",",a.getValueOfString(l.getValue("AD_Org_ID"))),u=e.dataContext.getJSONRecord("MPeriod/GetPeriod",c);null!=u&&l.setValue("C_Period_ID",u)}catch(e){return this.log.log(t.SEVERE,sql,e),e.message}return this.setCalloutActive(!1),l=o=null,""},i.prototype.SuperVisor=function(i,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString()||0==a.getValueOfInt(o))return"";try{this.setCalloutActive(!0);var c=e.dataContext.getJSONRecord("MTeamForcast/GetSuperVisor",a.getValueOfString(o));null!=c&&l.setValue("Supervisor_ID",c)}catch(e){return this.log.log(t.SEVERE,sql,e),e.message}return this.setCalloutActive(!1),l=o=null,""},e.Model.CalloutTeamForcast=i}(VIS,jQuery)},7001:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutInventory")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.Product=function(a,i,n,l,s,o){if(this.isCalloutActive()||"M_ProductContainer_ID"!=l.getColumnName()||null!=s&&""!=s.toString()||(s=0),this.isCalloutActive()||null==s||""==s.toString())return"";var r=0,c=t.getValueOfInt(n.getValue("M_Product_ID"));if(null!=c&&(r=c),0==r)return"";var u=0,d=t.getValueOfInt(n.getValue("M_Locator_ID"));if(null!=d&&(u=d),0==u)return"";this.setCalloutActive(!0);var g=0,p=a.getContext(i,"AttrCode");if(null!=p&&""!=p&&"M_ProductContainer_ID"!=l.getColumnName()){var v=s.toString()+","+p.toString();g=e.dataContext.getJSONRecord("MInventoryLine/GetProductAttribute",v)}var _=t.getValueOfInt(n.getValue("M_InventoryLine_ID")),V=a.getContext(i,"MovementDate"),A=a.getContextAsInt(i,"AD_Org_ID");if("M_Product_ID"==l.getColumnName()){v=","+s.toString();if(n.getValue("IsInternalUse")){var m=e.dataContext.getJSONRecord("MProduct/GetProductUOMs",v);null!=m&&(m.VAS_ConsumableUOM_ID>0?n.setValue("C_UOM_ID",t.getValueOfInt(m.VAS_ConsumableUOM_ID)):n.setValue("C_UOM_ID",t.getValueOfInt(m.C_UOM_ID)))}else{var f=e.dataContext.getJSONRecord("MInventoryLine/GetProductUOM",s.toString());n.setValue("C_UOM_ID",t.getValueOfInt(f))}}var D=null;v=_.toString();if(null!=_&&0!=_){r=(h=e.dataContext.getJSONRecord("MInventoryLine/GetMInventoryLine",v)).M_Product_ID,u=h.M_Locator_ID;var h,C=t.getValueOfInt(n.getValue("M_Product_ID")),S=t.getValueOfInt(n.getValue("M_Locator_ID")),I=t.getValueOfInt(n.getValue("M_ProductContainer_ID")),y=0;if(C!=r||S!=u||"M_ProductContainer_ID"==l.getColumnName()){g>0&&n.setValue("M_AttributeSetInstance_ID",g),C==r?y=t.getValueOfInt(n.getValue("M_AttributeSetInstance_ID")):n.setValue("M_AttributeSetInstance_ID",null);try{D=this.SetQtyBook(A,y,C,S,V,I),n.setValue("QtyBook",D),n.setValue("OpeningStock",D)}catch(e){return this.setCalloutActive(!1),this.log.severe(e.toString()),n.setValue("QtyBook",D)}}return this.setCalloutActive(!1),a=i=n=l=s=null,""}g>0&&n.setValue("M_AttributeSetInstance_ID",g);var O=0,T=t.getValueOfInt(n.getValue("M_AttributeSetInstance_ID"));null!=T&&(O=T),n.setValue("M_AttributeSetInstance_ID",null);I=t.getValueOfInt(n.getValue("M_ProductContainer_ID"));try{D=this.SetQtyBook(A,O,r,u,V,I),n.setValue("QtyBook",D),n.setValue("OpeningStock",D)}catch(e){return this.setCalloutActive(!1),this.log.severe(e.toString()),n.setValue("QtyBook",D)}return this.log.info("M_Product_ID="+r+", M_Locator_ID="+u+", M_AttributeSetInstance_ID="+O+" - QtyBook="+D),this.setCalloutActive(!1),a=i=n=l=s=null,""},a.prototype.AttributeSetInstance=function(e,a,i,n,l,s){if(this.isCalloutActive())return"";var o=e.getContext(a,"MovementDate"),r=e.getContextAsInt(a,"AD_Org_ID"),c=null,u=0,d=t.getValueOfInt(i.getValue("M_Product_ID"));if(null!=d&&(u=d),0==u)return"";var g=0,p=t.getValueOfInt(i.getValue("M_Locator_ID"));if(null!=p&&(g=p),0==g)return"";this.setCalloutActive(!0);var v=0,_=t.getValueOfInt(i.getValue("M_AttributeSetInstance_ID"));null!=_&&(v=_);var V=t.getValueOfInt(i.getValue("M_ProductContainer_ID"));try{c=this.SetQtyBook(r,v,u,g,o,V),i.setValue("QtyBook",c),i.setValue("OpeningStock",c)}catch(e){return this.setCalloutActive(!1),this.log.severe(e.toString()),i.setValue("QtyBook",c)}return this.setCalloutActive(!1),e=a=i=null,""},a.prototype.SetDiff=function(e,a,i,n,l,s){if(null==l||""==l.toString())return"";var o=0,r=0,c=0,u=0;this.setCalloutActive(!0);try{r=t.getValueOfDecimal(i.getValue("OpeningStock")),u=t.getValueOfDecimal(i.getValue("QtyBook")),n.getColumnName().equals("DifferenceQty")?(o=r-(c=t.getValueOfDecimal(i.getValue("DifferenceQty"))),i.setValue("AsOnDateCount",o)):n.getColumnName().equals("AsOnDateCount")&&(c=r-(o=t.getValueOfDecimal(i.getValue("AsOnDateCount"))),i.setValue("DifferenceQty",c)),u-c>0?i.setValue("QtyCount",u-c):i.setValue("QtyCount",0)}catch(e){return this.setCalloutActive(!1),this.log.severe(e.toString()),e.message}return this.setCalloutActive(!1),i=n=l=null,""},a.prototype.SetQtyBook=function(t,a,i,n,l,s){var o=!1;null!=e.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"]&&(o=e.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"].equals("Y",!0));var r=o.toString()+","+l.toString()+","+i.toString()+","+n.toString()+","+a.toString()+","+s.toString()+","+t.toString();return e.dataContext.getJSONRecord("MInventory/GetCurrentQty",r)},a.prototype.SetUOMQty=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";if(this.isCalloutActive())return"";var r=0,c=0,u=0,d=0;this.setCalloutActive(!0);try{var g=t.getValueOfDecimal(n.getValue("M_Product_ID"));if(0==g)return this.setCalloutActive(!1),"";if(0==n.getValue("IsInternalUse")||null==n.getValue("IsInternalUse")){if("C_UOM_ID"==l.getColumnName()){var p=t.getValueOfInt(s);QtyEntered=t.getValueOfDecimal(n.getValue("QtyEntered")),g=t.getValueOfInt(n.getValue("M_Product_ID")),paramStr=p.toString().concat(",");var v=e.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),_=QtyEntered.toFixed(t.getValueOfInt(v));QtyEntered!=_&&(this.log.fine("Corrected QtyEntered Scale UOM="+p+"; QtyEntered="+QtyEntered+"->"+_),QtyEntered=_,n.setValue("QtyEntered",QtyEntered)),paramStr=g.toString().concat(",").concat(p.toString()).concat(",").concat(QtyEntered.toString()),null==(d=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr))&&(d=QtyEntered)}else{p=a.getContextAsInt(i,"C_UOM_ID");QtyEntered=t.getValueOfDecimal(n.getValue("QtyEntered")),paramStr=p.toString().concat(",");v=e.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),_=QtyEntered.toFixed(t.getValueOfInt(v));QtyEntered!=_&&(this.log.fine("Corrected QtyEntered Scale UOM="+p+"; QtyEntered="+QtyEntered+"->"+_),QtyEntered=_,n.setValue("QtyEntered",QtyEntered)),paramStr=g.toString().concat(",",p.toString(),",",QtyEntered.toString()),null==(d=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr))&&(d=QtyEntered);var V=QtyEntered!=d;this.log.fine("UOM="+p+", QtyEntered="+QtyEntered+" -> "+V+" QtyOrdered="+d),a.setContext(i,"UOMConversion",V?"Y":"N")}c=t.getValueOfDecimal(n.getValue("OpeningStock")),qtyBook=t.getValueOfDecimal(n.getValue("QtyBook")),"D"==n.getValue("AdjustmentType").toString()?(r=c-(u=d),n.setValue("DifferenceQty",d),n.setValue("AsOnDateCount",r)):"A"==n.getValue("AdjustmentType").toString()&&(u=c-(r=d),n.setValue("AsOnDateCount",d),n.setValue("DifferenceQty",u)),qtyBook-u>0?n.setValue("QtyCount",qtyBook-u):n.setValue("QtyCount",0),qtyBook>qtyBook-u&&n.setValue("PriceCost",0)}else if(1==n.getValue("IsInternalUse"))if("C_UOM_ID"==l.getColumnName()){p=t.getValueOfInt(s);QtyEntered=t.getValueOfDecimal(n.getValue("QtyEntered")),g=t.getValueOfInt(n.getValue("M_Product_ID")),paramStr=p.toString().concat(",");v=e.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),_=QtyEntered.toFixed(t.getValueOfInt(v));QtyEntered!=_&&(this.log.fine("Corrected QtyEntered Scale UOM="+p+"; QtyEntered="+QtyEntered+"->"+_),QtyEntered=_,n.setValue("QtyEntered",QtyEntered)),paramStr=g.toString().concat(",").concat(p.toString()).concat(",").concat(QtyEntered.toString()),null==(d=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr))&&(d=QtyEntered),n.setValue("QtyInternalUse",d)}else if("QtyEntered"==l.getColumnName()){p=a.getContextAsInt(i,"C_UOM_ID");QtyEntered=t.getValueOfDecimal(s),paramStr=p.toString().concat(",");v=e.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),_=QtyEntered.toFixed(t.getValueOfInt(v));QtyEntered!=_&&(this.log.fine("Corrected QtyEntered Scale UOM="+p+"; QtyEntered="+QtyEntered+"->"+_),QtyEntered=_,n.setValue("QtyEntered",QtyEntered)),paramStr=g.toString().concat(",",p.toString(),",",QtyEntered.toString()),null==(d=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr))&&(d=QtyEntered);V=QtyEntered!=d;this.log.fine("UOM="+p+", QtyEntered="+QtyEntered+" -> "+V+" QtyOrdered="+d),a.setContext(i,"UOMConversion",V?"Y":"N"),n.setValue("QtyInternalUse",d)}}catch(e){return this.setCalloutActive(!1),this.log.severe(e.toString()),e.message}return this.setCalloutActive(!1),a=i=n=l=s=null,""},e.Model.CalloutInventory=a}(VIS,jQuery)},7018:()=>{!function(t){var a=t.Logging.Level,i=t.Utility.Util;function n(){t.CalloutEngine.call(this,"VIS.CalloutUserTimeRec")}function l(){t.CalloutEngine.call(this,"VIS.CalloutTimeExpense")}t.Utility.inheritPrototype(n,t.CalloutEngine),n.prototype.IsInternal=function(e,a,n,l,s,o){if(null==s||""==s.toString())return"";if(this.isCalloutActive())return"";try{this.setCalloutActive(!0);var r=i.getValueOfInt(s).toString(),c=t.dataContext.getJSONRecord("MExpenseReport/GetProfiletype",r);""!=c&&("I"==c.toUpper()?n.setValue("IsInternal",!0):"E"==c.toUpper()&&n.setValue("IsInternal",!1)),this.setCalloutActive(!1)}catch(e){this.setCalloutActive(!1)}return n=s=null,""},t.Model.CalloutUserTimeRec=n,t.Utility.inheritPrototype(l,t.CalloutEngine),l.prototype.Product=function(n,l,s,o,r,c){var u=r;if(null==u||0==i.getValueOfInt(u))return"";this.setCalloutActive(!0);var d=null;n.getContext(l,"DateExpense");try{var g=t.dataContext.getJSONRecord("MProduct/GetProduct",u.toString());s.setValue("C_UOM_ID",i.getValueOfInt(g.C_UOM_ID)),uom=s.getValue("C_UOM_ID");var p=paramStr=u+","+s.getValue("S_TimeExpense_ID")+","+s.getValue("C_UOM_ID")+","+s.getValue("DateExpense"),v=t.dataContext.getJSONRecord("MExpenseReport/GetstandardPrice",p),_=(d=v.PriceActual,v.C_Currency_ID);s.setValue("ExpenseAmt",d),s.setValue("C_Currency_ID",_),s.setValue("ConvertedAmt",d)}catch(t){return this.log.log(a.SEVERE,null,t),this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),n=l=s=r=null,""},l.prototype.Amount=function(e,a,n,l,s,o){if(this.isCalloutActive())return"";this.setCalloutActive(!0);var r=n.getValue("ExpenseAmt"),c=0,u=n.getValue("C_Currency_ID");c=t.dataContext.getJSONRecord("MExpenseReport/GetPriceListCurrency",n.getValue("S_TimeExpense_ID"));var d=e.getContext(a,"DateExpense");this.log.fine("Amt="+r+", C_Currency_ID="+u);var g=r.toString();if(!g.equals(t.Env.ZERO)&&c!=i.getValueOfInt(u)){var p=e.getContextAsInt(a,"AD_Client_ID"),v=e.getContextAsInt(a,"AD_Org_ID"),_=g.toString()+","+u.toString()+","+c.toString()+","+d+",0,"+p.toString()+","+v.toString();g=t.dataContext.getJSONRecord("MConversionRate/CurrencyConvert",_)}return n.setValue("ConvertedAmt",g),this.log.fine("= ConvertedAmt="+g),this.setCalloutActive(!1),e=a=n=null,""},l.prototype.SetPrice=function(e,a,i,n,l,s){if(null==l||""==l.toString())return"";if(this.isCalloutActive()||null==l)return"";this.setCalloutActive(!0);try{var o;o=e.getContextAsInt(a,"M_Product_ID")+","+i.getValue("S_TimeExpense_ID")+","+i.getValue("C_UOM_ID");var r=t.dataContext.getJSONRecord("MExpenseReport/GetPrices",o);if(null!=r){var c=r.PriceStd;i.setValue("ExpenseAmt",c),i.setValue("ConvertedAmt",c)}if(i.getValue("C_Charge_ID")>0){var u=e.getContextAsInt("#C_UOM_ID");u>0?i.setValue("C_UOM_ID",u):i.setValue("C_UOM_ID",100);var d=t.Utility.Util.getValueOfInt(i.getValue("C_Charge_ID")).toString(),g=t.dataContext.getJSONRecord("MExpenseReport/GetChargeAmount",d);i.setValue("ExpenseAmt",g),i.setValue("ConvertedAmt",g)}return void this.setCalloutActive(!1)}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),""},l.prototype.SetCustomerData=function(e,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";this.setCalloutActive(!0);var o=l+","+n.getColumnName(),r=t.dataContext.getJSONRecord("MExpenseReport/LoadCustomerData",o);return null!=r&&r.Customer>0?(i.setValue("C_BPartner_ID",r.Customer),i.setValue("C_BPartner_Location_ID",r.Location)):i.setValue("C_BPartner_ID",0),this.setCalloutActive(!1),""},l.prototype.setProductData=function(e,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString()||i.getValue("C_Charge_ID")>0||0==i.getValue("IsTimeReport"))return"";this.setCalloutActive(!0);var o=l+","+n.getColumnName(),r=t.dataContext.getJSONRecord("MExpenseReport/LoadProductData",o);return null!=r&&r.M_Product_ID>0&&(i.setValue("M_Product_ID",r.M_Product_ID),i.setValue("C_UOM_ID",r.C_UOM_ID)),this.setCalloutActive(!1),""},t.Model.CalloutTimeExpense=l}(VIS,jQuery)},7096:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.CalloutMovement")}function n(){e.CalloutEngine.call(this,"VIS.CalloutInventoryMove")}function l(){e.CalloutEngine.call(this,"VIS.CalloutshipLine")}function s(){e.CalloutEngine.call(this,"VIS.CalloutMoveConfirmLine")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.Product=function(i,n,l,s,o,r){if(null==o||""==o.toString())return l.setValue("MovementQty",1),l.setValue("QtyEntered",1),"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);try{var c=o;if(null==c||0==c)return"";l.setValue("M_AttributeSetInstance_ID",null);var u=e.dataContext.getJSONRecord("MProduct/GetC_UOM_ID",c.toString());l.setValue("C_UOM_ID",u),o!=r&&(l.setValue("MovementQty",1),l.setValue("QtyEntered",1)),u=a.getValueOfDecimal(l.getValue("C_UOM_ID"));var d=a.getValueOfDecimal(l.getValue("QtyEntered")),g=(c=a.getValueOfInt(l.getValue("M_Product_ID"))).toString().concat(",").concat(u.toString()).concat(",").concat(d.toString()),p=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",g);QtyOrdered=p;var v=!1;null!=QtyOrdered&&(v=d!=QtyOrdered),null==QtyOrdered&&(v=!1,QtyOrdered=1),v?l.setValue("MovementQty",QtyOrdered):l.setValue("MovementQty",QtyOrdered*d)}catch(e){return this.setCalloutActive(!1),this.log.log(t.severe,sql,e),e.message}return this.setCalloutActive(!1),l=o=r=null,""},e.Model.CalloutMovement=i,e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.UOM=function(t,i,n,l,s,o){if(0==s||null==s||""==s.toString())return 0==s&&n.setValue("MovementQty",0),"";if(this.isCalloutActive()||null==s)return"";this.setCalloutActive(!0);try{var r=a.getValueOfDecimal(n.getValue("M_Product_ID"));if(0==r)return QtyEntered=1,QtyOrdered=QtyEntered,n.setValue("QtyOrdered",QtyOrdered),n.setValue("QtyEntered",QtyEntered),this.setCalloutActive(!1),t=i=n=l=s=null,"";if("C_UOM_ID"==l.getColumnName()){var c=a.getValueOfInt(s);QtyEntered=a.getValueOfDecimal(n.getValue("QtyEntered")),r=a.getValueOfInt(n.getValue("M_Product_ID")),paramStr=r.toString().concat(",").concat(c.toString()).concat(",").concat(QtyEntered.toString());var u=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr);QtyOrdered=u;var d=!1;null!=QtyOrdered&&(d=QtyEntered!=QtyOrdered),null==QtyOrdered&&(d=!1,QtyOrdered=1),d?n.setValue("MovementQty",QtyOrdered):n.setValue("MovementQty",QtyOrdered*QtyEntered)}else if("QtyEntered"==l.getColumnName()){c=t.getContextAsInt(i,"C_UOM_ID");QtyEntered=a.getValueOfDecimal(s),paramStr=c.toString().concat(",");var g=e.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),p=QtyEntered.toFixed(a.getValueOfInt(g));QtyEntered!=p&&(this.log.fine("Corrected QtyEntered Scale UOM="+c+"; QtyEntered="+QtyEntered+"->"+p),QtyEntered=p,n.setValue("QtyEntered",QtyEntered)),paramStr=r.toString().concat(",",c.toString(),",",QtyEntered.toString());u=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr);QtyOrdered=u,null==QtyOrdered&&(QtyOrdered=QtyEntered);d=QtyEntered!=QtyOrdered;this.log.fine("UOM="+c+", QtyEntered="+QtyEntered+" -> "+d+" QtyOrdered="+QtyOrdered),t.setContext(i,"UOMConversion",d?"Y":"N"),n.setValue("MovementQty",QtyOrdered)}}catch(e){this.setCalloutActive(!1)}return this.setCalloutActive(!1),t=i=n=l=s=null,""},e.Model.CalloutInventoryMove=n,e.Utility.inheritPrototype(l,e.CalloutEngine),l.prototype.DocType=function(t,i,n,l,s,o){if(null==s||""==s.toString())return"";if(this.isCalloutActive()||null==s)return"";this.setCalloutActive(!0);try{var r=s.toString()+","+n.getValue("M_Package_ID").toString()+","+n.getValue("M_InOutLine_ID").toString(),c=e.dataContext.getJSONRecord("MInOut/GetProductDetails",r),u=0;null!=c&&Object.keys(c).length>0&&(u=a.getValueOfDecimal(c.Movementqty),n.setValue("M_Product_ID",a.getValueOfInt(c.M_Product_ID)),n.setValue("Qty",u-a.getValueOfInt(c.totalConfirmedAndScrapped)),n.setValue("M_AttributeSetInstance_ID",a.getValueOfInt(c.M_AttributeSetInstance_ID)),n.setValue("DTD001_IsConfirm",!0))}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),n=s=null,""},e.Model.CalloutshipLine=l,e.Utility.inheritPrototype(s,e.CalloutEngine),s.prototype.SetQty=function(e,t,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";if(this.setCalloutActive(!0),a.getValueOfDecimal(i.getValue("TargetQty"))<a.getValueOfDecimal(i.getValue("ConfirmedQty")))return i.setValue("ConfirmedQty",a.getValueOfDecimal(i.getValue("TargetQty"))),i.setValue("DifferenceQty",0),i.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";if("ConfirmedQty"==n.getColumnName()){if(a.getValueOfDecimal(i.getValue("ConfirmedQty"))<0)return i.setValue("ConfirmedQty",a.getValueOfDecimal(i.getValue("TargetQty"))),i.setValue("DifferenceQty",0),i.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";i.setValue("ScrappedQty",0),i.setValue("DifferenceQty",a.getValueOfDecimal(i.getValue("TargetQty"))-(a.getValueOfDecimal(i.getValue("ConfirmedQty"))+a.getValueOfDecimal(i.getValue("ScrappedQty"))))}else if("DifferenceQty"==n.getColumnName()){if(a.getValueOfDecimal(i.getValue("TargetQty"))<a.getValueOfDecimal(i.getValue("ConfirmedQty"))+a.getValueOfDecimal(i.getValue("DifferenceQty")))return i.setValue("ConfirmedQty",a.getValueOfDecimal(i.getValue("TargetQty"))),i.setValue("DifferenceQty",0),i.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";i.setValue("ScrappedQty",a.getValueOfDecimal(i.getValue("TargetQty"))-(a.getValueOfDecimal(i.getValue("ConfirmedQty"))+a.getValueOfDecimal(i.getValue("DifferenceQty"))))}else if("ScrappedQty"==n.getColumnName()){if(a.getValueOfDecimal(i.getValue("ScrappedQty"))<0)return i.setValue("ConfirmedQty",a.getValueOfDecimal(i.getValue("TargetQty"))),i.setValue("DifferenceQty",0),i.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";if(a.getValueOfDecimal(i.getValue("TargetQty"))<a.getValueOfDecimal(i.getValue("ConfirmedQty"))+a.getValueOfDecimal(i.getValue("ScrappedQty")))return i.setValue("ConfirmedQty",a.getValueOfDecimal(i.getValue("TargetQty"))),i.setValue("DifferenceQty",0),i.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";i.setValue("DifferenceQty",a.getValueOfDecimal(i.getValue("TargetQty"))-(a.getValueOfDecimal(i.getValue("ConfirmedQty"))+a.getValueOfDecimal(i.getValue("ScrappedQty"))))}return this.setCalloutActive(!1),""},e.Model.CalloutMoveConfirmLine=s}(VIS,jQuery)},7123:()=>{!function(e,t){function a(t){var a=this.$super;a.constructor(t);var i=this;!function(){a.title=e.Msg.getElement(e.Env.getCtx(),"M_InOut_ID",!1)+" .. "+e.Msg.translate(e.Env.getCtx(),"CreateFrom"),null!=a.lblShipment&&a.lblShipment.getControl().css("display","none");null!=a.cmbShipment&&a.cmbShipment.getControl().css("display","none");a.Applybtn&&a.Applybtn.css("display","block");var t=new e.MLocatorLookup(e.Env.getCtx(),a.windowNo);a.locatorField=new e.Controls.VLocator("M_Locator_ID",!0,!1,!0,e.DisplayType.Locator,t),a.deliveryDate=new e.Controls.VDate("DeliveryDate",!1,!1,!0,e.DisplayType.Date,"DeliveryDate");var n=e.MLookupFactory.getMLookUp(e.Env.getCtx(),a.windowNo,2221,e.DisplayType.Search);a.vProduct=new e.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,e.DisplayType.Search,n),a.DocumentNoRef=new e.Controls.VTextBox("DocumentNo",!1,!0,!0,50,100,null,null,!1),a.lblContainer=new e.Controls.VLabel,a.cmbContainer=new e.Controls.VComboBox("",!1,!1,!0),a.lblContainer.getControl().text(e.Msg.getMsg("VIS_Container")),null!=a.lblContainer&&a.lblContainer.getControl().css("display","block");null!=a.cmbContainer&&a.cmbContainer.getControl().css("display","block");var l=e.Env.getCtx().getContext(a.windowNo,"DocumentNo");a.DocumentNoRef.setValue(l);var s=a.initBPartner(!1);a.vBPartner.setReadOnly(!0),function(t){var n="Y".equals(e.Env.getCtx().getWindowContext(a.windowNo,"IsReturnTrx"));!function(t,n,l){var s="Y".equals(e.Env.getCtx().getWindowContext(i.windowNo,"IsDropShip")),o="Y".equals(e.Env.getCtx().getWindowContext(i.windowNo,"IsSOTrx")),r=" C_Invoice.C_Invoice_ID IN (SELECT i.C_Invoice_ID FROM C_Invoice i INNER JOIN C_DocType d ON (i.C_DocType_ID = d.C_DocType_ID) WHERE i.C_BPartner_ID="+n+" AND i.IsSOTrx='"+(o?"Y":"N")+"' AND i.IsDropShip='"+(s?"Y":"N")+"' AND d.IsReturnTrx='"+(l?"Y":"N")+"' AND i.DocStatus IN ('CL','CO') AND i.TreatAsDiscount = 'N' AND i.C_Invoice_ID IN (SELECT C_Invoice_ID FROM (SELECT il.C_Invoice_ID,il.C_InvoiceLine_ID,il.QtyInvoiced,mi.Qty FROM C_InvoiceLine il  LEFT OUTER JOIN M_MatchInv mi ON (il.C_InvoiceLine_ID=mi.C_InvoiceLine_ID) ";"N"==e.Utility.Util.getValueOfString(e.Env.getCtx().getContext("$AllowNonItem"))?r+=" INNER JOIN M_Product Mp On Mp.M_Product_ID = il.M_Product_ID WHERE Mp.ProductType = 'I' AND":r+=" LEFT JOIN M_Product Mp On Mp.M_Product_ID = il.M_Product_ID WHERE";r+=" (il.QtyInvoiced <> nvl(mi.Qty,0) AND mi.C_InvoiceLine_ID IS NOT NULL And Mp.Iscostadjustmentonlost = 'N')  OR (NVL(Mi.Qty,0) = 0 AND Mi.C_Invoiceline_Id IS NOT NULL AND Mp.Iscostadjustmentonlost = 'Y')  OR mi.C_InvoiceLine_ID IS NULL ) t GROUP BY C_Invoice_ID,C_InvoiceLine_ID,QtyInvoiced  HAVING QtyInvoiced > SUM(nvl(Qty,0))))";var c=e.MLookupFactory.get(e.Env.getCtx(),a.windowNo,0,e.DisplayType.Search,"C_Invoice_ID",0,!1,r);a.cmbInvoice=new e.Controls.VTextBoxButton("C_Invoice_ID",!0,!1,!0,e.DisplayType.Search,c)}(e.Env.getCtx(),t,n)}(s)}(),a.jbInit(),a.initOK=!0,this.log=e.Logging.VLogger.getVLogger("VCreateFromShipment"),this.disposeComponent=function(){a=null,i=null,this.disposeComponent=null}}e.Utility.inheritPrototype(a,e.VCreateFrom),a.prototype.saveMInOut=function(t){if(null==this.$super.dGrid)return this.$super.setBusy(!1),!1;var a={},i=this.$super.multiValues;if(null==i)return this.$super.setBusy(!1),!1;if(i.length<=0)return this.$super.setBusy(!1),!1;for(var n=0;n<i.length;n++)a[n]=i[n];var l=this.$super.locatorField.getValue();if(null==l||0==l)return e.ADialog.info("Error",!0,e.Msg.translate(e.Env.getCtx(),"VIS_locfieldMandatory"),""),this.$super.setBusy(!1),!1;if(0==a.length)return this.$super.setBusy(!1),!1;var s=this.$super.cmbContainer.getValue();void 0===s&&(s=0);var o=l,r=this.$super.mTab.getValue("M_InOut_ID"),c=e.Utility.Util.getValueOfInt(this.$super.cmbInvoice.getValue()),u=e.Utility.Util.getValueOfInt(this.$super.cmbOrder.getValue());return this.saveData(a,"",u,c,o,r,s,t)},a.prototype.loadInvoices=function(t,a,i){this.getInvoicesData(e.Env.getCtx(),t,a,i)},a.prototype.getInvoicesData=function(a,i,n,l){var s=this;if(this.$super.record_ID=$self.mTab.getValue("M_InOut_ID"),null!=s.$super.dGrid){var o=s.$super.dGrid.getSelection();for(item in o){t.grep(s.$super.multiValues,function(e,t){return e.M_Product_ID_K==s.$super.dGrid.get(o[item]).M_Product_ID_K&&e.C_Invoice_ID_K==s.$super.dGrid.get(o[item]).C_Invoice_ID_K}).length>0||s.$super.multiValues.push(s.$super.dGrid.get(o[item]))}}var r="",c="";return r=e.Env.isBaseLanguage(a,"C_UOM")?"FROM C_UOM uom INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom Left join C_UOM uom1 on (uom1.C_UOM_ID=uom.C_UOM_ID) INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+e.Env.getAD_Language(a)+"') ",null!=n&&(c=" AND l.M_Product_ID = "+n),l||(l=1),t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetInvoicesDataVCreate",dataType:"json",type:"POST",data:{keyColumnName:s.$super.mTab.keyColumnName,tableName:"C_InvoiceLine",recordID:s.$super.record_ID,pageNo:l,isBaseLangss:r,cInvoiceID:i,mProductIDs:c},error:function(t){alert(e.Msg.getMsg("ErrorWhileGettingData")),selfChild.log.info(t),s.$super.setBusy(!1)},success:function(t){var a=JSON.parse(t);if(a.Error)return e.ADialog.error(a.Error),void s.$super.setBusy(!1);s.$super.resetPageCtrls(a.pSetting),s.$super.loadGrid(a.data),s.$super.setBusy(!1)}}),[]},a.prototype.initContainerDetails=function(e){this.$super.cmbContainer.getControl().html("")},a.prototype.loadInvoice=function(t){var a=this.getInvoiceData(e.Env.getCtx(),t);this.$super.loadGrid(a)},a.prototype.getInvoiceData=function(t,a){var i=[],n="SELECT round((l.QtyInvoiced-SUM(COALESCE(mi.Qty,0))) * (CASE WHEN l.QtyInvoiced=0 THEN 0 ELSE l.QtyEntered/l.QtyInvoiced END ),2) as QUANTITY,round((l.QtyInvoiced-SUM(COALESCE(mi.Qty,0))) * (CASE WHEN l.QtyInvoiced=0 THEN 0 ELSE l.QtyEntered/l.QtyInvoiced END ),2) as QTYENTER, l.C_UOM_ID,COALESCE(uom.UOMSymbol,uom.Name), l.M_Product_ID,p.Name, l.C_InvoiceLine_ID,l.Line, l.C_OrderLine_ID ";n=(n=e.Env.isBaseLanguage(t,"C_UOM")?n.concat("FROM C_UOM uom ").concat("INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID) "):n.concat("FROM C_UOM_Trl uom ").concat("INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='").concat(e.Env.getAD_Language(t)).concat("') ")).concat("INNER JOIN M_Product p ON (l.M_Product_ID=p.M_Product_ID) ").concat("LEFT OUTER JOIN M_MatchInv mi ON (l.C_InvoiceLine_ID=mi.C_InvoiceLine_ID) ").concat("WHERE l.C_Invoice_ID="+a+" GROUP BY l.QtyInvoiced,l.QtyEntered,l.C_UOM_ID,COALESCE(uom.UOMSymbol,uom.Name),l.M_Product_ID,p.Name, l.C_InvoiceLine_ID,l.Line,l.C_OrderLine_ID ORDER BY l.Line");var l=null;try{l=e.DB.executeReader(n.toString(),null,null);for(var s=1;l.read();){var o={},r=l.getDecimal(0),c=l.getDecimal(1);o.Quantity=r,o.QuantityEntered=c,o.C_UOM_ID=l.getString(3),o.M_Product_ID=l.getString(5),o.C_Order_ID=".",o.M_InOut_ID=null,o.C_Invoice_ID=l.getString(7),o.C_UOM_ID_K=l.getString(2),o.M_Product_ID_K=l.getInt(4),o.C_Order_ID_K=l.getInt(8),o.M_InOut_ID_K=null,o.C_Invoice_ID_K=l.getInt(6),o.recid=s,s++,i.push(o)}l.close()}catch(e){}return i},a.prototype.saveData=function(a,i,n,l,s,o,r,c){var u=this;console.log(s),t.ajax({type:"POST",url:e.Application.contextUrl+"Common/SaveShipment",dataType:"json",data:{model:a,selectedItems:i,C_Order_ID:n,C_Invoice_ID:l,M_Locator_ID:s,M_InOut_ID:o,Container_ID:r},success:function(e){returnValue=e.result,returnValue&&(c?u.$super.callBackSave(returnValue):(u.dispose(),u.$super.setBusy(!1),u.$super.$root.dialog("close")))},error:function(e,t,a){console.log(t),u.$super.setBusy(!1),alert(a)}})},a.prototype.dispose=function(){null!=this.disposeComponent&&this.disposeComponent()},e.VCreateFromShipment=a}(VIS,jQuery)},7162:()=>{VAS=window.VAS||{},function(e,t){e.VAS_DueOrderWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[],r=0;this.initalize=function(){const a='<div id="VAS_DeliveryContainer_'+(l=this.widgetInfo.AD_UserHomeWidgetID)+'" class="VAS-due-fulfilment-container">    <div class="VAS-orders-heading">        <h6>'+VIS.Msg.getMsg("VAS_DueOrders")+'</h6>    </div>    <div class="VAS-delivery-count">        <div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_Orders")+' <span id="VAS_DeliveryCount_'+l+'">0</span></div>    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">        </div>    </div>    <div class="VAS-height-container">        <div id="VAS_DeliveryBox_'+l+'" class="VAS-deliveries-listing">        </div>        <div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing">        </div>    </div><div class="VAS-pagination-container"></div></div>';e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append(a)},this.intialLoad=function(c){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_DeliveryContainer_"+l).show(),t.ajax({url:VIS.Application.contextUrl+"Product/GetExpectedDelivery",data:{pageNo:c,pageSize:4,Type:"PG"},dataType:"json",success:function(u){u=JSON.parse(u);if(n.find("#VAS_DeliveryBox_"+l).empty(),n.find("#VAS_OrderContainer").remove,null!=u&&null!=u.Orders&&u.Orders.length>0){for(i=0;i<u.Orders.length;i++){var d='<div id="VAS_OrderContainer_'+l+'" class="VAS-delivery-box" >    <div class="VAS-box-heading">        <div class="VAS-icon-w-name">            <i class="fa fa-file-text" aria-hidden="true"></i>            <div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor"                 title="'+VIS.Msg.getMsg("Document_No")+'"                 data-doc-no="'+u.Orders[i].DocumentNo+'"                 data-customer-name="'+u.Orders[i].CustomerName+'"                 data-orderid="'+u.Orders[i].C_Order_ID+'">                '+u.Orders[i].DocumentNo+'            </div>        </div>        <div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+u.Orders[i].LineCount+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("Vendor")+'">'+u.Orders[i].CustomerName+'</div>    </div>    <div class="VAS-spaceBetween-col grid-2-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_VendorLocation")+'">'+u.Orders[i].DeliveryLocation+'</div>        <div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_ProductLocation")+'">'+u.Orders[i].ProductLocation+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+u.Orders[i].Symbol+"</span> "+u.Orders[i].GrandTotal.toLocaleString()+"</div>    </div></div>";n.find("#VAS_DeliveryBox_"+l).append(d)}s=[],u.Orders.forEach(function(e){e.OrderLines&&e.OrderLines.length>0&&(s[e.DocumentNo]=e.OrderLines)}),1==c&&(n.find("#VAS_DeliveryCount_"+l).text(u.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/4);var s=t('<div class="VAS-slider-arrows">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(u.RecordCount),r=u.AD_Window_ID),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){!function(i,c,u){n.find("#VAS_DeliveryContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var d='<div id="VAS_ProductContainer_'+l+'" class="VAS-due-fulfilment-container"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-orders-heading">        <h6>            <span id="VAS_BackTodelivery_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToOrder")+'        </h6><span id="VAS_GenerateGRN_'+l+'" class="VAS-generate-delivery-btn" data-orderid="'+u+'" title="'+VIS.Msg.getMsg("VAS_GenerateGRN")+'"><i class="vis vis-action" ></i ></span>     </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text" aria-hidden="true"></i>                    <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>                <div class="VAS-expectedTxt" title="'+VIS.Msg.getMsg("Vendor")+'">'+c+'</div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(d);var g=s[i]||[],p=6,v=Math.ceil(g.length/p),_=1;function V(e){e<1&&(e=1),e>v&&(e=v);var t=((_=e)-1)*p,a=Math.min(t+p,g.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s=g[i],r=o.includes(s.C_OrderLine_ID);n.find("#VAS_OrderLine_"+l).append('            <div class="VAS-delivery-box">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-orderlineid="'+s.C_OrderLine_ID+'"'+(r?" checked":"")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+s.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count"><span title="'+VIS.Msg.getMsg("VAS_RemianingQty")+'">'+s.QtyEntered+'</span></div>                </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+s.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+s.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(g.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+_+VIS.Msg.getMsg("VAS_Of")+v+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}g.length>0&&V(_);function A(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateGRN",data:{C_Order_ID:i,C_OrderLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).Shipment_ID>0){if(a.currentPage=1,a.intialLoad(a.currentPage),r>0){var i=new VIS.Query;i.addRestriction("M_InOut_ID",VIS.Query.prototype.EQUAL,t.Shipment_ID),i.setRecordCount(1),VIS.viewManager.startWindow(r,i)}}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_DeliveryOrderNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}}),console.log("Generating delivery order for ID:",i)}n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackTodelivery_"+l),n.off("click","#VAS_GenerateGRN_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){V(_-1)}),n.on("click","#VAS_NextPage_"+l,function(){V(_+1)}),n.on("click","#VAS_BackTodelivery_"+l,function(){n.find("#VAS_DeliveryContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("orderlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateGRN_"+l).show():n.find("#VAS_GenerateGRN_"+l).hide(),console.log(o)}),n.on("click","#VAS_GenerateGRN_"+l,function(){A(t(this).data("orderid"))}),n.find("#VAS_GenerateGRN_"+l).hide()}(t(this).data("doc-no"),t(this).data("customer-name"),t(this).data("orderid"))})}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_DueOrderWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_DueOrderWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_DueOrderWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_DueOrderWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_DueOrderWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_DueOrderWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},7270:()=>{VAS=window.VAS||{},function(e,t){e.VAS_CustomerRMAWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[];this.initalize=function(){const a='<div id="VAS_DeliveryContainer_'+(l=this.widgetInfo.AD_UserHomeWidgetID)+'" class="VAS-customer-container-pending">    <div class="VAS-deliveries-heading">        <h6>'+VIS.Msg.getMsg("VAS_CustomerRMA")+'</h6>    </div>    <div class="VAS-delivery-count">        <div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_CustomerRMACount")+' <span id="VAS_DeliveryCount_'+l+'">0</span></div>    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">        </div>    </div>    <div class="VAS-height-container">        <div id="VAS_DeliveryBox_'+l+'" class="VAS-deliveries-listing">        </div>        <div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing">        </div>    </div><div class="VAS-pagination-container"></div></div>';e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append(a)},this.intialLoad=function(r){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_DeliveryContainer_"+l).show(),t.ajax({url:VIS.Application.contextUrl+"Product/GetExpectedDelivery",data:{pageNo:r,pageSize:4,Type:"CR"},dataType:"json",success:function(c){c=JSON.parse(c);if(n.find("#VAS_DeliveryBox_"+l).empty(),n.find("#VAS_OrderContainer").remove,null!=c&&null!=c.Orders&&c.Orders.length>0){for(i=0;i<c.Orders.length;i++){var u='<div id="VAS_OrderContainer_'+l+'" class="VAS-delivery-box" >    <div class="VAS-box-heading">        <div class="VAS-icon-w-name">            <i class="fa fa-file-text" aria-hidden="true"></i>            <div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor"                 title="'+VIS.Msg.getMsg("Document_No")+'"                 data-doc-no="'+c.Orders[i].DocumentNo+'"                 data-customer-name="'+c.Orders[i].CustomerName+'"                 data-orderid="'+c.Orders[i].C_Order_ID+'">                '+c.Orders[i].DocumentNo+'            </div>        </div>        <div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+c.Orders[i].LineCount+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+c.Orders[i].CustomerName+'</div>    </div>    <div class="VAS-spaceBetween-col grid-2-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_CustomerLocation")+'">'+c.Orders[i].DeliveryLocation+'</div>        <div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_ProductLocation")+'">'+c.Orders[i].ProductLocation+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+c.Orders[i].Symbol+"</span> "+c.Orders[i].GrandTotal.toLocaleString()+"</div>    </div></div>";n.find("#VAS_DeliveryBox_"+l).append(u)}s=[],c.Orders.forEach(function(e){e.OrderLines&&e.OrderLines.length>0&&(s[e.DocumentNo]=e.OrderLines)}),1==r&&(t("#VAS_DeliveryCount_"+l).text(c.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/4);var s=t('<div class="VAS-slider-arrows VAS-orders-text-white">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(c.RecordCount),c.AD_Window_ID),t("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){!function(i,r,c){n.find("#VAS_DeliveryContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var u='<div id="VAS_ProductContainer_'+l+'" class="VAS-customer-container-pending"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-deliveries-heading">        <h6>            <span id="VAS_BackTodelivery_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToCustomerRMA")+'        </h6><span id="VAS_GenerateGRN_'+l+'" class="VAS-generate-delivery-btn" data-orderid="'+c+'" title="'+VIS.Msg.getMsg("VAS_GenerateCustomerReturn")+'"><i class="vis vis-action" ></i></span>     </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading VAS-orders-text-white">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text VAS-orders-text-white" aria-hidden="true"></i>                    <div class="VAS-doc-no VAS-orders-text-white" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>                <div class="VAS-expectedTxt" title="'+VIS.Msg.getMsg("VAS_Customer")+'">'+r+'</div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count VAS-orders-text-white"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(u);var d=s[i]||[],g=6,p=Math.ceil(d.length/g),v=1;function _(e){e<1&&(e=1),e>p&&(e=p);var t=((v=e)-1)*g,a=Math.min(t+g,d.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s=d[i],r=o.includes(s.C_OrderLine_ID);n.find("#VAS_OrderLine_"+l).append('            <div class="VAS-delivery-box">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-orderlineid="'+s.C_OrderLine_ID+'"'+(r?" checked":"")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+s.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count"><span title="'+VIS.Msg.getMsg("VAS_RemianingQty")+'">'+s.QtyOrdered+'</span></div>                </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+s.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+s.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(d.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details VAS-orders-text-white">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+v+VIS.Msg.getMsg("VAS_Of")+p+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}d.length>0&&_(v);function V(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateGRN",data:{C_Order_ID:i,C_OrderLines_IDs:s,Type:"CR"},dataType:"json",success:function(t){if((t=JSON.parse(t)).Shipment_ID>0)try{var i={TabWhereClause:"M_InOut.M_InOut_ID="+t.Shipment_ID,TabLayout:"Y",TabIndex:"0"};a.widgetFirevalueChanged(i),a.currentPage=1,a.intialLoad(a.currentPage)}catch(e){console.log(e)}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_CustomerReturnNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})}n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackTodelivery_"+l),n.off("click","#VAS_GenerateGRN_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){_(v-1)}),n.on("click","#VAS_NextPage_"+l,function(){_(v+1)}),n.on("click","#VAS_BackTodelivery_"+l,function(){n.find("#VAS_DeliveryContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("orderlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateGRN_"+l).show():n.find("#VAS_GenerateGRN_"+l).hide(),console.log(o)}),n.on("click","#VAS_GenerateGRN_"+l,function(){V(t(this).data("orderid"))}),n.find("#VAS_GenerateGRN_"+l).hide()}(t(this).data("doc-no"),t(this).data("customer-name"),t(this).data("orderid"))})}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_CustomerRMAWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_CustomerRMAWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_CustomerRMAWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_CustomerRMAWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_CustomerRMAWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_CustomerRMAWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},7328:()=>{VAS=window.VAS||{},function(e,t){e.VAS_VendorReturnWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[],r=0;this.initalize=function(){const a='<div id="VAS_DeliveryContainer_'+(l=this.widgetInfo.AD_UserHomeWidgetID)+'" class="VAS-vendor-container-pending">    <div class="VAS-deliveries-heading">        <h6>'+VIS.Msg.getMsg("VAS_VendorRMA")+'</h6>    </div>    <div class="VAS-delivery-count">        <div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_VendorRMACount")+' <span id="VAS_DeliveryCount_'+l+'">0</span></div>    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">        </div>    </div>    <div class="VAS-height-container">        <div id="VAS_DeliveryBox_'+l+'" class="VAS-deliveries-listing">        </div>        <div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing">        </div>    </div><div class="VAS-pagination-container"></div></div>';e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append(a)},this.intialLoad=function(c){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_DeliveryContainer_"+l).show(),t.ajax({url:VIS.Application.contextUrl+"Product/GetExpectedDelivery",data:{pageNo:c,pageSize:4,Type:"VR"},dataType:"json",success:function(u){u=JSON.parse(u);if(n.find("#VAS_DeliveryBox_"+l).empty(),n.find("#VAS_OrderContainer").remove,null!=u&&null!=u.Orders&&u.Orders.length>0){for(i=0;i<u.Orders.length;i++){var d='<div id="VAS_OrderContainer_'+l+'" class="VAS-delivery-box" >    <div class="VAS-box-heading">        <div class="VAS-icon-w-name">            <i class="fa fa-file-text" aria-hidden="true"></i>            <div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor"                 title="'+VIS.Msg.getMsg("Document_No")+'"                 data-doc-no="'+u.Orders[i].DocumentNo+'"                 data-customer-name="'+u.Orders[i].CustomerName+'"                 data-orderid="'+u.Orders[i].C_Order_ID+'">                '+u.Orders[i].DocumentNo+'            </div>        </div>        <div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+u.Orders[i].LineCount+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("Vendor")+'">'+u.Orders[i].CustomerName+'</div>    </div>    <div class="VAS-spaceBetween-col grid-2-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_VendorLocation")+'">'+u.Orders[i].DeliveryLocation+'</div>        <div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_ProductLocation")+'">'+u.Orders[i].ProductLocation+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+u.Orders[i].Symbol+"</span> "+u.Orders[i].GrandTotal.toLocaleString()+"</div>    </div></div>";n.find("#VAS_DeliveryBox_"+l).append(d)}s=[],u.Orders.forEach(function(e){e.OrderLines&&e.OrderLines.length>0&&(s[e.DocumentNo]=e.OrderLines)}),1==c&&(n.find("#VAS_DeliveryCount_"+l).text(u.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/4);var s=t('<div class="VAS-slider-arrows VAS-orders-text-white">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(u.RecordCount),r=u.AD_Window_ID),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){!function(i,c,u){n.find("#VAS_DeliveryContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var d='<div id="VAS_ProductContainer_'+l+'" class="VAS-vendor-container-pending"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-deliveries-heading">        <h6>            <span id="VAS_BackTodelivery_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToVendorRMA")+'        </h6><span id="VAS_GenerateDeliveryOrder_'+l+'" class="VAS-generate-delivery-btn" data-orderid="'+u+'" title="'+VIS.Msg.getMsg("VAS_GenerateVendorReturn")+'"><i class="fa fa-truck" aria-hidden="true"></i></span>    </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading VAS-orders-text-white">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text VAS-orders-text-white" aria-hidden="true"></i>                    <div class="VAS-doc-no VAS-orders-text-white" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>                <div class="VAS-expectedTxt" title="'+VIS.Msg.getMsg("Vendor")+'">'+c+'</div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count VAS-orders-text-white"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(d);var g=s[i]||[],p=6,v=Math.ceil(g.length/p),_=1;function V(e){e<1&&(e=1),e>v&&(e=v);var t=((_=e)-1)*p,a=Math.min(t+p,g.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s,r=g[i],c=o.includes(r.C_OrderLine_ID),u=r.OnHandQty>0&&r.OnHandQty>=r.QtyOrdered,d=u?"VAS-delivery-box":"VAS-delivery-box no-stock";s=r.OnHandQty>=r.QtyOrdered?"badge-green":r.OnHandQty<r.QtyOrdered&&r.OnHandQty>0?"badge-orange":"badge-red",n.find("#VAS_OrderLine_"+l).append('            <div class="'+d+'">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-orderlineid="'+r.C_OrderLine_ID+'"'+(c?" checked":"")+(u?"":" disabled")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+r.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count">                    <span title = "'+VIS.Msg.getMsg("VAS_RemianingQty")+'" class="badge badge-light '+s+'"> '+r.QtyEntered+'</span ></div >                       </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+r.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+r.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(g.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details VAS-orders-text-white">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+_+VIS.Msg.getMsg("VAS_Of")+v+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}g.length>0&&V(_);function A(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateShipment",data:{C_Order_ID:i,C_OrderLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).Shipment_ID>0)try{if(r>0){var i={TabWhereClause:"M_InOut.M_InOut_ID="+t.Shipment_ID,TabLayout:"Y",TabIndex:"0"};a.widgetFirevalueChanged(i),a.currentPage=1,a.intialLoad(a.currentPage)}}catch(e){console.log(e)}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_VendorReturnNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})}n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackTodelivery_"+l),n.off("click","#VAS_GenerateDeliveryOrder_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){V(_-1)}),n.on("click","#VAS_NextPage_"+l,function(){V(_+1)}),n.on("click","#VAS_BackTodelivery_"+l,function(){n.find("#VAS_DeliveryContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("orderlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateDeliveryOrder_"+l).show():n.find("#VAS_GenerateDeliveryOrder_"+l).hide(),console.log(o)}),n.on("click","#VAS_GenerateDeliveryOrder_"+l,function(){A(t(this).data("orderid"))}),n.find("#VAS_GenerateDeliveryOrder_"+l).hide()}(t(this).data("doc-no"),t(this).data("customer-name"),t(this).data("orderid"))})}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_VendorReturnWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_VendorReturnWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_VendorReturnWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_VendorReturnWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_VendorReturnWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_VendorReturnWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},7483:()=>{VAS=window.VAS||{},function(e,t){e.VAS_FinDInsightsGridView=function(){var e;this.windowNo,this.log=VIS.Logging.VLogger.getVLogger("finDInsightGW_Form");var a,i=this,n=null,l=null,s=0,o=1,r=0,c=null,u=null,d=null,g=null,p=null,v=null,_=null,V=null,A=null,m=null,f=null,D=null;function h(){e=t('<div style="height:100%">'),$bsyDiv=t('<div class="vis-busyindicatorouterwrap" style="visibility: hidden;"></div>'),$bsyDiv.append(t('<div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div>')),y(!1),e.append($bsyDiv),(u=new VIS.CFrame).setName(VIS.Utility.encodeText(c)),u.setTitle(VIS.Utility.encodeText(c)),u.setContent(i),u.hideHeader(!1),u.show(),y(!0),mainContainerDiv=t('<div class="VAS-finDInsightGW-Grid-container h-100">'),a=t('<div class="VAS-finDInsightGW-gridDiv "style="height:calc(100vh - 152px); width: 100%;">'),D=t('<div class="VAS-finDInsightGW-Paging mr-3" style="display:flex;align-items: center;justify-content:end;margin-top:10px">'),mainContainerDiv.append(a).append(D),e.append(mainContainerDiv),S(o),p=t('<ul class="vis-statusbar-ul">'),v=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="First Page" style="opacity: 0.6;"></i></div></li>'),_=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="Page Up" style="opacity: 0.6;"></i></div></li>'),V=t("<select>"),A=t("<li>").append(V),m=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="Page Down" style="opacity: 0.6;"></i></div></li>'),f=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="Last Page" style="opacity: 0.6;"></i></div></li>'),p.append(v).append(_).append(A).append(m).append(f),D.append(p),v.on("click",function(){"1"==t(this).css("opacity")&&S(o=1)}),_.on("click",function(){"1"==t(this).css("opacity")&&(o--,S(parseInt(o)))}),m.on("click",function(){"1"==t(this).css("opacity")&&(o++,S(parseInt(o)))}),f.on("click",function(){"1"==t(this).css("opacity")&&S(o=parseInt(V.find("Option:last").val()))}),V.on("change",function(){S(o=V.val())}),setTimeout(function(){y(!1)},1e3)}function C(e){g=e.map(e=>({field:e,caption:VIS.Msg.getMsg(e),columnName:VIS.Msg.getMsg(e),size:"10%",sortable:!0,resizable:!0}))}function S(e){VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetFinDataInsightGrid",{tableName:d,pageNo:e,pageSize:50,AD_Org_ID:l},function(e){data=e,null!=data&&data.length>0&&(data.length>1?(g=data[0].ColName.split(","),data.shift(),C(g),r=Math.ceil(data[0].Count/50)):(g=data[0].ColName.split(","),data.shift(),C(g),VIS.ADialog.info("VAS_RecordNotFound"))),function(e,i=[]){null!=n&&(n.destroy(),n=null),n=t(a).w2grid({name:"VAS_Grid_"+s,recordHeight:25,show:{toolbar:!1,lineNumbers:!0,selectColumn:!1,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!0,toolbarSave:!0},multiSelect:!1,columns:e,records:i})}(g,data),I(r)})}function I(e){if(V.empty(),e>0){for(var a=0;a<e;a++)V.append(t("<option value="+(a+1)+">"+(a+1)+"</option>"));V.val(o),e>o?(m.css("opacity","1"),f.css("opacity","1")):(m.css("opacity","0.6"),f.css("opacity","0.6")),o>1?(v.css("opacity","1"),_.css("opacity","1")):(v.css("opacity","0.6"),_.css("opacity","0.6")),1==e&&(v.css("opacity","0.6"),_.css("opacity","0.6"),m.css("opacity","0.6"),f.css("opacity","0.6"))}else v.css("opacity","0.6"),_.css("opacity","0.6"),m.css("opacity","0.6"),f.css("opacity","0.6")}function y(e){$bsyDiv[0].style.visibility=e?"visible":"hidden"}this.setProperties=function(e,t,a,i,n){c=t,d=e,s=i,l=VIS.Utility.Util.getValueOfInt(n)},this.Initialize=function(){h()},this.getRoot=function(){return e},this.disposeComponent=function(){i=null,null!=n&&(n.destroy(),n=null),e&&e.remove(),e=null,a=null,$button1=null,$button2=null,n=null,l=null,c=null,g=null,p=null,v=null,_=null,V=null,A=null,m=null,f=null,D=null,o=null,r=null,this.getRoot=null,this.disposeComponent=null}},e.VAS_FinDInsightsGridView.prototype.init=function(e,t){this.frame=t,this.windowNo=e,t.hideHeader(!0);this.Initialize();this.frame.getContentGrid().append(this.getRoot())},e.VAS_FinDInsightsGridView.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null}}(VAS,jQuery)},7487:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.CalloutCashJournal")}function n(){e.CalloutEngine.call(this,"VIS.CalloutSetReadOnly")}function l(){e.CalloutEngine.call(this,"VIS.CalloutCashJournalLine")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.Invoice=function(i,n,l,s,o,r){if(this.isCalloutActive())return"";if(null==o||""==o.toString())return"C_Invoice_ID"==s.getColumnName()&&(this.setCalloutActive(!0),l.setValue("C_BPartner_ID",null),l.setValue("C_BPartner_Location_ID",null),l.setValue("C_InvoicePaySchedule_ID",null),i.setContext(n,"InvTotalAmt",""),i.setContext("InvTotalAmt",""),l.setValue("ConvertedAmt",e.Env.ZERO),l.setValue("DiscountAmt",e.Env.ZERO),l.setValue("WriteOffAmt",e.Env.ZERO),l.setValue("OverUnderAmt",e.Env.ZERO),l.setValue("Amount",e.Env.ZERO),this.setCalloutActive(!1)),"";this.setCalloutActive(!0);var c=a.getValueOfInt(o),u=0,d=0,g=0,p=null;try{null!=(p=e.dataContext.getJSONRecord("MInvoice/GetInvPaySchedDetail",c.toString()))&&(d=a.getValueOfInt(p.C_InvoicePaySchedule_ID),l.setValue("C_InvoicePaySchedule_ID",d),u=a.getValueOfDecimal(p.dueAmount),g=1)}catch(e){return null!=p&&(p=null),this.log.log(t.SEVERE,"CalloutCashJournal.Invoice -"+c,e.message),e.toString()}if(null==c||0==c)return l.setValue("C_Currency_ID",null),this.setCalloutActive(!1),"";var v=new Date(i.getContext(n,"DateAcct")),_="TO_DATE( '"+(Number(v.getMonth())+1)+"-"+v.getDate()+"-"+v.getFullYear()+"', 'MM-DD-YYYY')",V=c.toString()+","+_.toString()+","+d.toString(),A=null;try{if(null!=(A=e.dataContext.getJSONRecord("MInvoice/GetInvoiceDetails",V))){var m=0;l.setValue("C_BPartner_ID",a.getValueOfInt(A.C_BPartner_ID)),l.setValue("C_Currency_ID",a.getValueOfInt(A.C_Currency_ID)),l.setValue("C_ConversionType_ID",a.getValueOfInt(A.C_ConversionType_ID)),l.setValue("C_BPartner_Location_ID",a.getValueOfInt(A.C_BPartner_Location_ID)),m=0==g?a.getValueOfDecimal(A.invoiceOpen):u;var f=a.getValueOfDecimal(A.paymentTermDiscount);"Y"==A.IsSOTrx||(0==g?m*=-1:m=-1*u,f*=-1);var D=a.getValueOfString(A.docbaseType);"ARC"==D||"API"==D?l.setValue("VSS_PAYMENTTYPE","P"):l.setValue("VSS_PAYMENTTYPE","R"),l.setValue("DiscountAmt",f),i.setContext("InvTotalAmt",m.toString()),l.setValue("Amount",m-f),l.setValue("WriteOffAmt",e.Env.ZERO)}}catch(e){return null!=idr&&(idr.close(),idr=null),this.log.log(t.SEVERE,"invoice",e),this.setCalloutActive(!1),e.toString()}return this.setCalloutActive(!1),i=n=l=s=o=null,""},i.prototype.SetAmount=function(t,i,n,l,s,o){if(this.isCalloutActive())return"";if(null==s||""==s.toString())return"";if(this.setCalloutActive(!0),null==s||""==s.toString()){if(a.getValueOfInt(n.getValue("C_Invoice_ID"))>0){var r=a.getValueOfDecimal(e.dataContext.getJSONRecord("MCashBook/GetPaySheduleAmt",n.getValue("C_Invoice_ID").toString()));return t.setContext(i,"InvTotalAmt",r.toString()),n.setValue("Amount",r),this.setCalloutActive(!1),""}return""}if(n.setValue("DiscountAmt",e.Env.ZERO),n.setValue("WriteOffAmt",e.Env.ZERO),n.setValue("OverUnderAmt",e.Env.ZERO),e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_").VA009_){if(t.setContext("InvTotalAmt",""),null==(O=a.getValueOfInt(s))||0==O)return t.setContext(i,"InvTotalAmt",null),"C_Payment"==n.getTableName()?(n.setValue("PayAmt",null),n.setValue("PaymentAmount",null)):n.setValue("Amount",null),n.setValue("DiscountAmt",0),n.setValue("WriteOffAmt",e.Env.ZERO),t.setContext("InvTotalAmt",0),this.setCalloutActive(!1),"";var c=O.toString()+","+n.getValue("C_Cash_ID")+","+n.getValue("C_Invoice_ID"),u=e.dataContext.getJSONRecord("MCashBook/GetPaySheduleData",c),d=e.Utility.Util.getValueOfString(u.IsReturnTrx);if(n.setValue("C_Currency_ID",a.getValueOfInt(u.C_Currency_ID)),null!=u)if("C_Payment"==n.getTableName()){n.setValue("VAS_IsDiscountApplied",!1);var g=n.getValue("DateTrx");"Y"==d?Globalize.format(new Date(u.DiscountDate),"yyyy-MM-dd")>=Globalize.format(new Date(g),"yyyy-MM-dd")?(n.setValue("DiscountAmt",-1*a.getValueOfDecimal(u.DiscountAmt)),n.setValue("PayAmt",-1*(a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.DiscountAmt))),n.setValue("PaymentAmount",-1*(a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.DiscountAmt)))):Globalize.format(new Date(u.DiscountDays2),"yyyy-MM-dd")>=Globalize.format(new Date(g),"yyyy-MM-dd")?(n.setValue("DiscountAmt",-1*a.getValueOfDecimal(u.Discount2)),n.setValue("PayAmt",-1*(a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.Discount2))),n.setValue("PaymentAmount",-1*(a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.Discount2)))):(n.setValue("DiscountAmt",0),n.setValue("PayAmt",-1*a.getValueOfDecimal(u.DueAmt)),n.setValue("PaymentAmount",-1*a.getValueOfDecimal(u.DueAmt))):Globalize.format(new Date(u.DiscountDate),"yyyy-MM-dd")>=Globalize.format(new Date(g),"yyyy-MM-dd")?(n.setValue("DiscountAmt",a.getValueOfDecimal(u.DiscountAmt)),n.setValue("PayAmt",a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.DiscountAmt)),n.setValue("PaymentAmount",a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.DiscountAmt))):Globalize.format(new Date(u.DiscountDays2),"yyyy-MM-dd")>=Globalize.format(new Date(g),"yyyy-MM-dd")?(n.setValue("DiscountAmt",a.getValueOfDecimal(u.Discount2)),n.setValue("PayAmt",a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.Discount2)),n.setValue("PaymentAmount",a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.Discount2))):(n.setValue("DiscountAmt",0),n.setValue("PayAmt",a.getValueOfDecimal(u.DueAmt)),n.setValue("PaymentAmount",a.getValueOfDecimal(u.DueAmt)))}else if("C_PaymentAllocate"==n.getTableName()){var p=a.getValueOfDecimal(u.DueAmt),v=a.getValueOfDecimal(u.DiscountAmt),_=a.getValueOfDecimal(u.Discount2),V=a.getValueOfInt(u.C_Currency_ID),A=t.getContextAsInt(i,"C_Currency_ID"),m=t.getContextAsInt(i,"C_ConversionType_ID"),f=t.getContextAsInt(i,"AD_Client_ID"),D=t.getContextAsInt(i,"AD_Org_ID"),h=t.getContext(i,"DateAcct"),C=(g=t.getContext(i,"DateTrx"),e.dataContext.getJSONRecord("MCurrency/GetCurrency",A.toString()).StdPrecision);if(A>0&&V>0&&A!=V){var S=V+","+A+","+h+","+m+","+f+","+D;if(currencyRate=e.dataContext.getJSONRecord("MConversionRate/GetRate",S),null==currencyRate||0==currencyRate)return n.setValue("Amount",0),n.setValue("DiscountAmt",0),n.setValue("WriteOffAmt",0),n.setValue("OverUnderAmt",0),this.setCalloutActive(!1),"NoCurrencyConversion";p=a.getValueOfDecimal((p*currencyRate).toFixed(C)),v=a.getValueOfDecimal((v*currencyRate).toFixed(C)),_=a.getValueOfDecimal((_*currencyRate).toFixed(C))}n.setValue("Amount",p),t.setContext(i,"InvTotalAmt",a.getValueOfDecimal(u.DueAmt)),n.setValue("WriteOffAmt",0),n.setValue("OverUnderAmt",0),Globalize.format(new Date(u.DiscountDate),"yyyy-MM-dd")>=Globalize.format(new Date(g),"yyyy-MM-dd")?"Y"==d?(n.setValue("DiscountAmt",-1*v),n.setValue("Amount",-1*(p-v)),n.setValue("InvoiceAmt",-1*a.getValueOfDecimal(u.DueAmt))):(n.setValue("DiscountAmt",v),n.setValue("Amount",p-v),n.setValue("InvoiceAmt",a.getValueOfDecimal(u.DueAmt))):Globalize.format(new Date(u.DiscountDays2))>=Globalize.format(new Date(g),"yyyy-MM-dd")?"Y"==d?(n.setValue("DiscountAmt",-1*_),n.setValue("Amount",-1*(p-_)),n.setValue("InvoiceAmt",-1*a.getValueOfDecimal(u.DueAmt))):(n.setValue("DiscountAmt",_),n.setValue("Amount",p-_),n.setValue("InvoiceAmt",a.getValueOfDecimal(u.DueAmt))):("Y"==d?(n.setValue("Amount",-1*p),n.setValue("InvoiceAmt",-1*a.getValueOfDecimal(u.DueAmt))):(n.setValue("Amount",p),n.setValue("InvoiceAmt",a.getValueOfDecimal(u.DueAmt))),n.setValue("DiscountAmt",0))}else{n.setValue("Amount",a.getValueOfDecimal(u.DueAmt)),t.setContext(i,"InvTotalAmt",a.getValueOfDecimal(n.getValue("Amount"))),n.setValue("WriteOffAmt",0),n.setValue("OverUnderAmt",0);var I=a.getValueOfDate(u.accountDate),y=a.getValueOfString(u.isSoTrx);a.getValueOfDate(u.DiscountDate)>=I?"N"==y?(n.setValue("DiscountAmt",-1*a.getValueOfDecimal(u.DiscountAmt)),n.setValue("Amount",-1*(a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.DiscountAmt))),"C_PaymentAllocate"==n.getTableName()&&n.setValue("InvoiceAmt",-1*a.getValueOfDecimal(u.DueAmt))):(n.setValue("DiscountAmt",a.getValueOfDecimal(u.DiscountAmt)),n.setValue("Amount",a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.DiscountAmt)),"C_PaymentAllocate"==n.getTableName()&&n.setValue("InvoiceAmt",a.getValueOfDecimal(u.DueAmt))):a.getValueOfDate(u.DiscountDays2)>=I?"N"==y?(n.setValue("DiscountAmt",-1*a.getValueOfDecimal(u.Discount2)),n.setValue("Amount",-1*(a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.DiscountAmt))),"C_PaymentAllocate"==n.getTableName()&&n.setValue("InvoiceAmt",-1*a.getValueOfDecimal(u.DueAmt))):(n.setValue("DiscountAmt",a.getValueOfDecimal(u.Discount2)),n.setValue("Amount",a.getValueOfDecimal(u.DueAmt)-a.getValueOfDecimal(u.DiscountAmt)),"C_PaymentAllocate"==n.getTableName()&&n.setValue("InvoiceAmt",a.getValueOfDecimal(u.DueAmt))):("N"==y?(n.setValue("Amount",-1*a.getValueOfDecimal(u.DueAmt)),"C_PaymentAllocate"==n.getTableName()&&n.setValue("InvoiceAmt",-1*a.getValueOfDecimal(u.DueAmt))):(n.setValue("Amount",a.getValueOfDecimal(u.DueAmt)),"C_PaymentAllocate"==n.getTableName()&&n.setValue("InvoiceAmt",a.getValueOfDecimal(u.DueAmt))),n.setValue("DiscountAmt",0))}}else{var O;if(null==(O=a.getValueOfInt(s))||0==O)return t.setContext(i,"InvTotalAmt",null),"C_Payment"==n.getTableName()?(n.setValue("PayAmt",null),n.setValue("PaymentAmount",null)):n.setValue("Amount",null),this.setCalloutActive(!1),"";var T=e.dataContext.getJSONRecord("MCashBook/GetInvSchedDueAmt",O.toString());if(null!=T){var w=T.DueAmt;"C_Payment"==n.getTableName()?"Y"==T.IsReturnTrx?(n.setValue("PayAmt",-1*w),n.setValue("PaymentAmount",-1*w)):(n.setValue("PayAmt",w),n.setValue("PaymentAmount",w)):(n.setValue("Amount",w),t.setContext(i,"InvTotalAmt",a.getValueOfDecimal(n.getValue("Amount"))))}}return this.setCalloutActive(!1),""},i.prototype.Amounts=function(t,i,n,l,s,o){if(this.isCalloutActive())return"";var r=0,c=l.getColumnName(),u=a.getValueOfDecimal(n.getValue("Amount")),d=2;this.setCalloutActive(!0);var g=0;if("I"==n.getValue("CashType")){var p=a.getValueOfDecimal(n.getValue("DiscountAmt")),v=a.getValueOfDecimal(n.getValue("WriteOffAmt")),_=a.getValueOfDecimal(n.getValue("OverUnderAmt")),V=a.getValueOfInt(n.getValue("C_InvoicePaySchedule_ID")).toString()+","+a.getValueOfInt(n.getValue("C_Currency_ID")).toString(),A=e.dataContext.getJSONRecord("MCashBook/GetInvSchedDueAmt",V);null!=A&&(r=a.getValueOfDecimal(A.DueAmt),d=a.getValueOfInt(A.StdPrecision));var m=n.getValue("VSS_PaymentType");if("P"==m?(u>0&&(u*=-1,n.setValue("Amount",u)),p>0&&(p*=-1),v>0&&(v*=-1,n.setValue("WriteOffAmt",v)),_>0&&(_*=-1,n.setValue("OverUnderAmt",_)),r>0&&(r*=-1)):(u<0&&(u*=-1,n.setValue("Amount",u)),p<0&&(p*=-1),v<0&&(v*=-1,n.setValue("WriteOffAmt",v)),_<0&&(_*=-1,n.setValue("OverUnderAmt",_)),r<0&&(r*=-1)),this.log.fine(c+" - Invoice="+r+" - Amount="+u+", Discount="+p+", WriteOff="+v),"Amount"==c)_=(r-u-p-v).toFixed(d),("R"==m&&_>0||"P"==m&&_<0)&&e.ADialog.info("LessScheduleAmount"),("P"==m&&_>0||"R"==m&&_<0)&&(e.ADialog.info("MoreScheduleAmount"),_=r-(u=r-p-v)-p-v,n.setValue("Amount",u.toFixed(d))),p.toFixed(d)!=a.getValueOfDecimal(n.getValue("DiscountAmt"))&&n.setValue("DiscountAmt",p.toFixed(d)),_!=a.getValueOfDecimal(n.getValue("OverUnderAmt"))&&n.setValue("OverUnderAmt",a.getValueOfDecimal(_).toFixed(d)),v.toFixed(d)!=a.getValueOfDecimal(n.getValue("WriteOffAmt"))&&n.setValue("WriteOffAmt",v.toFixed(d)),u.toFixed(d)!=a.getValueOfDecimal(n.getValue("Amount"))&&n.setValue("Amount",u.toFixed(d));else u=(r-p-v-_).toFixed(d),("P"==m&&u>0||"R"==m&&u<0)&&(e.ADialog.info("MoreScheduleAmount"),"OverUnderAmt"==c&&(_=r-(u=r-p-v)-p-v,n.setValue("OverUnderAmt",_)),"DiscountAmt"==c&&(p=r-(u=r-_-v)-_-v,n.setValue("DiscountAmt",p.toFixed(d))),"WriteOffAmt"==c&&(v=r-(u=r-p-_)-p-_,n.setValue("WriteOffAmt",v.toFixed(d)))),p.toFixed(d)!=a.getValueOfDecimal(n.getValue("DiscountAmt"))&&n.setValue("DiscountAmt",p.toFixed(d)),v.toFixed(d)!=a.getValueOfDecimal(n.getValue("WriteOffAmt"))&&n.setValue("WriteOffAmt",v.toFixed(d)),_!=a.getValueOfDecimal(n.getValue("OverUnderAmt"))&&n.setValue("OverUnderAmt",a.getValueOfDecimal(_).toFixed(d)),u!=a.getValueOfDecimal(n.getValue("Amount"))&&n.setValue("Amount",a.getValueOfDecimal(u).toFixed(d)),("R"==m&&_>0||"P"==m&&_<0)&&e.ADialog.info("LessScheduleAmount")}var f=n.getValue("C_Cash_ID").toString(),D=e.dataContext.getJSONRecord("MCashBook/GetCashJournal",f),h=D.DateAcct,C=D.C_Currency_ID,S=D.C_Currency_ID;null!=n.getValue("C_Currency_ID")&&(C=n.getValue("C_Currency_ID").toString());var I=0;return null!=n.getField("C_ConversionType_ID")&&(I=a.getValueOfInt(n.getValue("C_ConversionType_ID"))),C!=S?(f=u.toString()+","+C+","+S+","+h+","+I.toString()+","+t.getAD_Client_ID().toString()+","+t.getAD_Org_ID().toString(),g=e.dataContext.getJSONRecord("MConversionRate/CurrencyConvert",f),0!=a.getValueOfDecimal(n.getValue("Amount"))&&0==g&&e.ADialog.info("NoCurrencyConversion")):g=u,n.setValue("convertedAmt",a.getValueOfDecimal(g).toFixed(d)),this.setCalloutActive(!1),t=n=l=null,""},i.prototype.BeginningBalCalc=function(i,n,l,s,o,r){if(null==o||""==o.toString())return"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);var c=a.getValueOfInt(o);if(null==c||0==c)return l.setValue("BeginningBalance",0),this.setCalloutActive(!1),"";var u=a.getValueOfInt(l.getValue("C_CashBook_ID")),d=a.getValueOfInt(l.getValue("AD_Client_ID")),g=a.getValueOfInt(l.getValue("AD_Org_ID")),p=(i.getContext("DateAcct"),u.toString()+","+d.toString()+","+g.toString()),v=e.dataContext.getJSONRecord("MCashJournal/GetBeginningBalCalc",p);try{v>0?l.setValue("BeginningBalance",v):l.setValue("BeginningBalance",0),idr.close()}catch(e){return null!=idr&&idr.close(),this.log.log(t.SEVERE,"Beginning balance",e),this.setCalloutActive(!1),e.toString()}return this.setCalloutActive(!1),i=l=o=null,""},i.prototype.SetCurrency=function(t,i,n,l,s,o){if((null==s||""==s.toString())&&"C_ConversionType_ID"!=l.getColumnName())return"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);var r="",c=a.getValueOfDecimal(n.getValue("Amount"));if("C_CashBook_ID"==l.getColumnName()){var u=a.getValueOfInt(s);if(null==u||0==u)return n.setValue("C_Currency_ID",0),this.setCalloutActive(!1),"";r=u.toString();var d=e.dataContext.getJSONRecord("MCashBook/GetCashBook",r);n.setValue("C_Currency_ID",d.C_Currency_ID)}else if("C_BankAccount_ID"==l.getColumnName()){var g=a.getValueOfInt(s);if(null==g||0==g)return n.setValue("C_Currency_ID",0),this.setCalloutActive(!1),"";r=g.toString();var p=a.getValueOfInt(e.dataContext.getJSONRecord("MPayment/GetBankAcctCurrency",r));n.setValue("C_Currency_ID",p)}if(0!=c){r=n.getValue("C_Cash_ID").toString();var v=0,_=e.dataContext.getJSONRecord("MCashBook/GetCashJournal",r),V=_.DateAcct,A=_.C_Currency_ID,m=_.C_Currency_ID;null!=n.getValue("C_Currency_ID")&&(A=n.getValue("C_Currency_ID").toString());var f=0;null!=n.getField("C_ConversionType_ID")&&(f=a.getValueOfInt(n.getValue("C_ConversionType_ID"))),A!=m?(r=c.toString()+","+A+","+m+","+V+","+f.toString()+","+t.getAD_Client_ID().toString()+","+t.getAD_Org_ID().toString(),0==(v=e.dataContext.getJSONRecord("MConversionRate/CurrencyConvert",r))&&e.ADialog.info("NoCurrencyConversion")):v=c,n.setValue("convertedAmt",v)}return this.setCalloutActive(!1),t=n=l=s=null,""},i.prototype.ConvertedAmt=function(t,i,n,l,s,o){if(null==s||""==s.toString())return"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);try{if(s>0){if(a.getValueOfInt(n.getValue("C_ConversionType_ID"))<=0)return n.setValue("C_CashLine_ID_1",""),e.ADialog.info("VIS_SelectConversion"),this.setCalloutActive(!1),"";var r=s.toString()+","+n.getValue("C_Cash_ID").toString()+","+n.getValue("AD_Org_ID").toString()+","+n.getValue("C_ConversionType_ID").toString(),c=e.dataContext.getJSONRecord("MCashJournal/ConvertedAmt",r);if(0==a.getValueOfInt(c.currTo))return this.setCalloutActive(!1),"";0!=a.getValueOfDecimal(c.amt)&&0==a.getValueOfDecimal(c.transferdAmt)&&e.ADialog.info("NoCurrencyConversion"),n.setValue("ConvertedAmt",a.getValueOfDecimal(c.transferdAmt)),n.setValue("Amount",a.getValueOfDecimal(c.amt))}else n.setValue("ConvertedAmt",0),n.setValue("Amount",0)}catch(e){this.setCalloutActive(!1)}return this.setCalloutActive(!1),n=s=null,""},i.prototype.GetBeginBal=function(t,a,i,n,l,s){if(null==l||""==l)return"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);var o=e.dataContext.getJSONRecord("MCashBook/GetBegiBalance",l.toString());return i.setValue("BeginningBalance",o),this.setCalloutActive(!1),""},e.Model.CalloutCashJournal=i,e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.SetReadnly=function(e,t,i,n,l,s){return null==l||""==l.toString()||"E"==l.toString()?(this.setCalloutActive(!1),null!=l&&"E"==l.toString()&&(i.getField("VSS_PAYMENTTYPE").setReadOnly(!0),i.setValue("VSS_PAYMENTTYPE","P")),""):(this.setCalloutActive(!0),"A"==a.getValueOfString(i.getValue("CashType"))||"E"==a.getValueOfString(i.getValue("CashType"))?(i.setValue("VSS_PAYMENTTYPE","P"),i.getField("VSS_PAYMENTTYPE").setReadOnly(!0)):"F"==a.getValueOfString(i.getValue("CashType"))||"R"==a.getValueOfString(i.getValue("CashType"))?(i.setValue("VSS_PAYMENTTYPE","R"),i.getField("VSS_PAYMENTTYPE").setReadOnly(!0)):"I"==a.getValueOfString(i.getValue("CashType"))||"O"==a.getValueOfString(i.getValue("CashType"))?i.getField("VSS_PAYMENTTYPE").setReadOnly(!0):i.getField("VSS_PAYMENTTYPE").setReadOnly(!1),"C"!=a.getValueOfString(i.getValue("CashType"))&&i.setValue("C_Tax_ID",null),"CashType"==n.getColumnName()&&function(e,t,i){"C"==a.getValueOfString(i.getValue("CashType"))?(0!=a.getValueOfInt(i.getValue("C_CashBook_ID"))&&i.setValue("C_CashBook_ID",null),0!=a.getValueOfInt(i.getValue("C_Invoice_ID"))&&i.setValue("C_Invoice_ID",null),0!=a.getValueOfInt(i.getValue("C_InvoicePaySchedule_ID"))&&i.setValue("C_InvoicePaySchedule_ID",null),0!=a.getValueOfInt(i.getValue("C_Order_ID"))&&i.setValue("C_Order_ID",null),0!=a.getValueOfInt(i.getValue("VA009_OrderPaySchedule_ID"))&&i.setValue("VA009_OrderPaySchedule_ID",null),0!=a.getValueOfInt(i.getValue("C_CashLine_ID_1"))&&i.setValue("C_CashLine_ID_1",null),0!=a.getValueOfDecimal(i.getValue("Amount"))&&i.setValue("Amount",null),i.setValue("TransferType",null),window.VA012&&!i.getValue("VA012_IsContra")&&(i.setValue("CheckNo",null),0!=a.getValueOfInt(i.getValue("C_BankAccount_ID"))&&i.setValue("C_BankAccount_ID",null))):"D"==a.getValueOfString(i.getValue("CashType"))?(i.setValue("CheckNo",null),0!=a.getValueOfInt(i.getValue("C_BankAccount_ID"))&&i.setValue("C_BankAccount_ID",null),0!=a.getValueOfInt(i.getValue("C_CashBook_ID"))&&i.setValue("C_CashBook_ID",null),0!=a.getValueOfInt(i.getValue("C_BPartner_ID"))&&i.setValue("C_BPartner_ID",null),0!=a.getValueOfInt(i.getValue("C_BPartner_Location_ID"))&&i.setValue("C_BPartner_Location_ID",null),0!=a.getValueOfInt(i.getValue("C_Invoice_ID"))&&i.setValue("C_Invoice_ID",null),0!=a.getValueOfInt(i.getValue("C_InvoicePaySchedule_ID"))&&i.setValue("C_InvoicePaySchedule_ID",null),0!=a.getValueOfInt(i.getValue("C_Charge_ID"))&&i.setValue("C_Charge_ID",null),0!=a.getValueOfInt(i.getValue("C_Order_ID"))&&i.setValue("C_Order_ID",null),0!=a.getValueOfInt(i.getValue("VA009_OrderPaySchedule_ID"))&&i.setValue("VA009_OrderPaySchedule_ID",null),0!=a.getValueOfDecimal(i.getValue("Amount"))&&i.setValue("Amount",null),0!=a.getValueOfInt(i.getValue("C_CashLine_ID_1"))&&i.setValue("C_CashLine_ID_1",null),i.setValue("TransferType",null),window.VA012&&i.setValue("VA012_IsContra",!1)):"B"==a.getValueOfString(i.getValue("CashType"))?(i.setValue("CheckNo",null),0!=a.getValueOfInt(i.getValue("C_BankAccount_ID"))&&i.setValue("C_BankAccount_ID",null),0!=a.getValueOfInt(i.getValue("C_CashBook_ID"))&&i.setValue("C_CashBook_ID",null),0!=a.getValueOfInt(i.getValue("C_Invoice_ID"))&&i.setValue("C_Invoice_ID",null),0!=a.getValueOfInt(i.getValue("C_InvoicePaySchedule_ID"))&&i.setValue("C_InvoicePaySchedule_ID",null),0!=a.getValueOfInt(i.getValue("C_Charge_ID"))&&i.setValue("C_Charge_ID",null),0!=a.getValueOfInt(i.getValue("C_Order_ID"))&&i.setValue("C_Order_ID",null),0!=a.getValueOfInt(i.getValue("VA009_OrderPaySchedule_ID"))&&i.setValue("VA009_OrderPaySchedule_ID",null),0!=a.getValueOfInt(i.getValue("C_CashLine_ID_1"))&&i.setValue("C_CashLine_ID_1",null),0!=a.getValueOfDecimal(i.getValue("Amount"))&&i.setValue("Amount",null),i.setValue("TransferType",null),window.VA012&&i.setValue("VA012_IsContra",!1)):"A"==a.getValueOfString(i.getValue("CashType"))?(i.setValue("CheckNo",null),0!=a.getValueOfInt(i.getValue("C_BankAccount_ID"))&&i.setValue("C_BankAccount_ID",null),0!=a.getValueOfInt(i.getValue("C_Invoice_ID"))&&i.setValue("C_Invoice_ID",null),0!=a.getValueOfInt(i.getValue("C_InvoicePaySchedule_ID"))&&i.setValue("C_InvoicePaySchedule_ID",null),0!=a.getValueOfInt(i.getValue("C_Charge_ID"))&&i.setValue("C_Charge_ID",null),0!=a.getValueOfInt(i.getValue("C_Order_ID"))&&i.setValue("C_Order_ID",null),0!=a.getValueOfInt(i.getValue("VA009_OrderPaySchedule_ID"))&&i.setValue("VA009_OrderPaySchedule_ID",null),0!=a.getValueOfInt(i.getValue("C_CashLine_ID_1"))&&i.setValue("C_CashLine_ID_1",null),0!=a.getValueOfDecimal(i.getValue("Amount"))&&i.setValue("Amount",null),i.setValue("TransferType",null),window.VA012&&i.setValue("VA012_IsContra",!1)):"E"==a.getValueOfString(i.getValue("CashType"))||"R"==a.getValueOfString(i.getValue("CashType"))?(i.setValue("CheckNo",null),0!=a.getValueOfInt(i.getValue("C_BankAccount_ID"))&&i.setValue("C_BankAccount_ID",null),0!=a.getValueOfInt(i.getValue("C_CashBook_ID"))&&i.setValue("C_CashBook_ID",null),0!=a.getValueOfInt(i.getValue("C_BPartner_ID"))&&i.setValue("C_BPartner_ID",null),0!=a.getValueOfInt(i.getValue("C_BPartner_Location_ID"))&&i.setValue("C_BPartner_Location_ID",null),0!=a.getValueOfInt(i.getValue("C_Invoice_ID"))&&i.setValue("C_Invoice_ID",null),0!=a.getValueOfInt(i.getValue("C_InvoicePaySchedule_ID"))&&i.setValue("C_InvoicePaySchedule_ID",null),0!=a.getValueOfInt(i.getValue("C_Charge_ID"))&&i.setValue("C_Charge_ID",null),0!=a.getValueOfInt(i.getValue("C_Order_ID"))&&i.setValue("C_Order_ID",null),0!=a.getValueOfInt(i.getValue("VA009_OrderPaySchedule_ID"))&&i.setValue("VA009_OrderPaySchedule_ID",null),0!=a.getValueOfDecimal(i.getValue("Amount"))&&i.setValue("Amount",null),0!=a.getValueOfInt(i.getValue("C_CashLine_ID_1"))&&i.setValue("C_CashLine_ID_1",null),i.setValue("TransferType",null),window.VA012&&i.setValue("VA012_IsContra",!1)):"I"==a.getValueOfString(i.getValue("CashType"))?(i.setValue("CheckNo",null),0!=a.getValueOfInt(i.getValue("C_BankAccount_ID"))&&i.setValue("C_BankAccount_ID",null),0!=a.getValueOfInt(i.getValue("C_CashBook_ID"))&&i.setValue("C_CashBook_ID",null),0!=a.getValueOfInt(i.getValue("C_Charge_ID"))&&i.setValue("C_Charge_ID",null),0!=a.getValueOfInt(i.getValue("C_Order_ID"))&&i.setValue("C_Order_ID",null),0!=a.getValueOfInt(i.getValue("VA009_OrderPaySchedule_ID"))&&i.setValue("VA009_OrderPaySchedule_ID",null),0!=a.getValueOfDecimal(i.getValue("Amount"))&&i.setValue("Amount",null),0!=a.getValueOfInt(i.getValue("C_CashLine_ID_1"))&&i.setValue("C_CashLine_ID_1",null),i.setValue("TransferType",null),window.VA012&&i.setValue("VA012_IsContra",!1)):"O"==a.getValueOfString(i.getValue("CashType"))?(i.setValue("CheckNo",null),0!=a.getValueOfInt(i.getValue("C_BankAccount_ID"))&&i.setValue("C_BankAccount_ID",null),0!=a.getValueOfInt(i.getValue("C_CashBook_ID"))&&i.setValue("C_CashBook_ID",null),0!=a.getValueOfInt(i.getValue("C_Charge_ID"))&&i.setValue("C_Charge_ID",null),0!=a.getValueOfInt(i.getValue("C_BPartner_ID"))&&i.setValue("C_BPartner_ID",null),0!=a.getValueOfInt(i.getValue("C_BPartner_Location_ID"))&&i.setValue("C_BPartner_Location_ID",null),0!=a.getValueOfInt(i.getValue("C_Invoice_ID"))&&i.setValue("C_Invoice_ID",null),0!=a.getValueOfInt(i.getValue("C_InvoicePaySchedule_ID"))&&i.setValue("C_InvoicePaySchedule_ID",null),0!=a.getValueOfInt(i.getValue("C_CashLine_ID_1"))&&i.setValue("C_CashLine_ID_1",null),0!=a.getValueOfDecimal(i.getValue("Amount"))&&i.setValue("Amount",null),i.setValue("TransferType",null),window.VA012&&i.setValue("VA012_IsContra",!1)):"F"==a.getValueOfString(i.getValue("CashType"))?(i.setValue("CheckNo",null),0!=a.getValueOfInt(i.getValue("C_BankAccount_ID"))&&i.setValue("C_BankAccount_ID",null),0!=a.getValueOfInt(i.getValue("C_BPartner_ID"))&&i.setValue("C_BPartner_ID",null),0!=a.getValueOfInt(i.getValue("C_BPartner_Location_ID"))&&i.setValue("C_BPartner_Location_ID",null),0!=a.getValueOfInt(i.getValue("C_Invoice_ID"))&&i.setValue("C_Invoice_ID",null),0!=a.getValueOfInt(i.getValue("C_InvoicePaySchedule_ID"))&&i.setValue("C_InvoicePaySchedule_ID",null),0!=a.getValueOfInt(i.getValue("C_Charge_ID"))&&i.setValue("C_Charge_ID",null),0!=a.getValueOfInt(i.getValue("C_Order_ID"))&&i.setValue("C_Order_ID",null),0!=a.getValueOfInt(i.getValue("VA009_OrderPaySchedule_ID"))&&i.setValue("VA009_OrderPaySchedule_ID",null),0!=a.getValueOfDecimal(i.getValue("Amount"))&&i.setValue("Amount",null),i.setValue("TransferType",null),window.VA012&&i.setValue("VA012_IsContra",!1)):"T"==a.getValueOfString(i.getValue("CashType"))&&(i.setValue("CheckNo",null),0!=a.getValueOfInt(i.getValue("C_BPartner_ID"))&&i.setValue("C_BPartner_ID",null),0!=a.getValueOfInt(i.getValue("C_BPartner_Location_ID"))&&i.setValue("C_BPartner_Location_ID",null),0!=a.getValueOfInt(i.getValue("C_Invoice_ID"))&&i.setValue("C_Invoice_ID",null),0!=a.getValueOfInt(i.getValue("C_InvoicePaySchedule_ID"))&&i.setValue("C_InvoicePaySchedule_ID",null),0!=a.getValueOfInt(i.getValue("C_Charge_ID"))&&i.setValue("C_Charge_ID",null),0!=a.getValueOfInt(i.getValue("C_Order_ID"))&&i.setValue("C_Order_ID",null),0!=a.getValueOfInt(i.getValue("VA009_OrderPaySchedule_ID"))&&i.setValue("VA009_OrderPaySchedule_ID",null),0!=a.getValueOfDecimal(i.getValue("Amount"))&&i.setValue("Amount",null),window.VA012&&i.setValue("VA012_IsContra",!1))}(0,0,i),"P"==a.getValueOfString(i.getValue("VSS_PAYMENTTYPE"))||"E"==a.getValueOfString(i.getValue("VSS_PAYMENTTYPE"))?a.getValueOfDecimal(i.getValue("amount"))>0&&i.setValue("Amount",0-a.getValueOfDecimal(i.getValue("amount"))):"R"!=a.getValueOfString(i.getValue("VSS_PAYMENTTYPE"))&&"A"!=a.getValueOfString(i.getValue("VSS_PAYMENTTYPE"))||a.getValueOfDecimal(i.getValue("amount"))<0&&i.setValue("Amount",0-a.getValueOfDecimal(i.getValue("amount"))),this.setCalloutActive(!1),"")},n.prototype.SetAmountValue=function(e,t,i,n,l,s){if(null==l||""==l.toString())return i.getField("VSS_PAYMENTTYPE").setReadOnly(!1),this.setCalloutActive(!1),"";if(this.setCalloutActive(!0),"B"!=a.getValueOfString(i.getValue("CashType")))"P"==a.getValueOfString(i.getValue("VSS_PAYMENTTYPE"))?a.getValueOfDecimal(i.getValue("amount"))>0&&i.setValue("Amount",0-a.getValueOfDecimal(i.getValue("amount"))):"R"==a.getValueOfString(i.getValue("VSS_PAYMENTTYPE"))&&a.getValueOfDecimal(i.getValue("amount"))<0&&i.setValue("Amount",0-a.getValueOfDecimal(i.getValue("amount")));else if("B"==a.getValueOfString(i.getValue("CashType"))){var o=a.getValueOfString(i.getValue("VSS_PAYMENTTYPE"));(("P"==o||"E"==o)&&a.getValueOfDecimal(i.getValue("amount"))>0||("R"==o||"A"==o)&&a.getValueOfDecimal(i.getValue("amount"))<0)&&(i.setValue("Amount",0-a.getValueOfDecimal(i.getValue("amount"))),i.setValue("ConvertedAmount",0-a.getValueOfDecimal(i.getValue("ConvertedAmount"))))}return this.setCalloutActive(!1),""},e.Model.CalloutSetReadOnly=n,e.Utility.inheritPrototype(l,e.CalloutEngine),l.prototype.SetBPLocation=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return n.setValue("C_BPartner_Location_ID",null),"";this.setCalloutActive(!0);try{if("B"==n.getValue("CashType")||"C"==n.getValue("CashType")){var r=n.getValue("C_BPartner_ID");if(null==r||""==r)return n.setValue("C_BPartner_Location_ID",null),this.setCalloutActive(!1),"";var c=r.toString()+","+t.getAD_Client_ID().toString(),u=e.dataContext.getJSONRecord("MCashJournal/GetBPLocation",c);if(null!=u){var d=a.getValueOfInt(u.CreditStatusSettingOn),g=a.getValueOfInt(u.C_BPartner_Location_ID);if("CL"==d&&0==g)return this.setCalloutActive(!1),e.Msg.getMsg("LocationNew");n.setValue("C_BPartner_Location_ID",g)}}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),""},l.prototype.setAccountNo=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);try{var r=e.dataContext.getJSONRecord("MCashJournal/GetBankAccountData",s);null!=r&&(n.setValue("RoutingNo",a.getValueOfString(r.RoutingNo)),n.setValue("AccountNo",a.getValueOfString(r.AccountNo)))}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),""},e.Model.CalloutCashJournalLine=l}(VIS,jQuery)},7520:()=>{VIS=window.VIS||{},function(e,t){e.RequestWidget=function(){this.frame,this.windowNo;var a,i,n,l,s,o=this,r=t('<div class="vis-group-assign-content" style="height:100%">'),c=1,u="",d=(c=1,e.Application.contextUrl+"JsonData/JDataSetWithCode");function g(){n.on("click",function(a){!function(a){var i=t(a.target).data("vishomercrd");if("view"===i){var n=(o=a.target.id.toString().split("|"))[0],l=o[1],s=o[2];(r=new e.Query).addRestriction(l+"_ID",e.Query.prototype.EQUAL,e.Utility.Util.getValueOfInt(n)),e.viewManager.startWindow(s,r)}else if("liview"===i){var o,r;n=(o=a.target.firstChild.id.toString().split("|"))[0],l=o[1],s=o[2];(r=new e.Query).addRestriction(l+"_ID",e.Query.prototype.EQUAL,e.Utility.Util.getValueOfInt(n)),e.viewManager.startWindow(s,r)}}(a)})}function p(e){e?r.find("#busyDivId"+o.AD_UserHomeWidgetID).show():r.find("#busyDivId"+o.AD_UserHomeWidgetID).hide()}function v(a,l){p(!0),t.ajax({url:e.Application.contextUrl+"VAS/VAS_Request/GetJSONHomeRequest",data:{pageSize:10,page:c,isTabDataRef:a},type:"GET",datatype:"json",cache:!1,success:function(t){var l=JSON.parse(t.data);if(1==a&&(i.find("#reqCountDiv"+o.AD_UserHomeWidgetID).empty(),i.find("#reqCountDiv"+o.AD_UserHomeWidgetID).append(parseInt(t.count))),l.length>0){for(var s in l)_(l,s);1==a&&g(),p(!1)}else 0==n.find(".vis-table-request").length&&(i.find("#reqCountDiv"+o.AD_UserHomeWidgetID).empty(),i.find("#reqCountDiv"+o.AD_UserHomeWidgetID).append(0),u="<p class='vis-a-pTagSetHeight vis-r-notRecordFndCls'>"+e.Msg.getMsg("NoRecordFound")+"</p>",n.append(u),p(!1))}})}function _(t,a){var i="";if(null!=t[a].StartDate||""!=t[a].StartDate){var l=new Date(t[a].StartDate);Globalize.format(l,"d",Globalize.cultureSelector)}var s="";if(null!=t[a].NextActionDate){l=new Date(t[a].NextActionDate);s=Globalize.format(l,"d",Globalize.cultureSelector)}else s="&nbsp;-----------";var o="";if(null!=t[a].CreatedDate||""!=t[a].CreatedDate){l=new Date(t[a].CreatedDate);o=Globalize.format(l,"F",Globalize.cultureSelector)}var r=t[a].Summary;r.length>80&&(r=r.substr(0,80)+"...");var c=t[a].CaseType;c.length>30&&(c=c.substr(0,30)+"..."),i+="<div class='vis-w-activityContainer "+("N"==t[a].IsRead?"VAS-ticket-highlight":"")+"'><div class='vis-w-feedTitleBar'><h3>#"+t[a].DocumentNo+"</h3>",t[a].Name&&t[a].Name.length>0&&(i+="<li class='vis-home-request-BP'>"+t[a].Name+"</li>"),i+="<div class='vis-w-feedTitleBar-buttons'><ul><li class='vis-w-zoomClrChngCls' data-vishomercrd='liview'><a href='javascript:void(0)' data-vishomercrd='view' id="+t[a].R_Request_ID+"|"+t[a].TableName+"|"+t[a].AD_Window_ID+"  title='"+e.Msg.getMsg("View")+"'  class='vis vis-find'></a></li></ul></div></div><div  class='vis-w-feedDetails vis-pt-0 vis-pl-0 vis-w-requestFlx'><div class='vis-table-request'><ul class='h-100'><li><span>"+e.Msg.getMsg("Priority")+":</span><br>"+t[a].Priority+"</li><li><span>"+e.Msg.getMsg("Status")+":</span><br>"+t[a].Status+"</li><li><span>"+e.Msg.getMsg("NextActionDate")+":</span><br>"+s+"</li></ul></div><div class='w-100'><p class='vis-maintain-customer-p'><strong>"+e.Utility.encodeText(c)+" </strong><br /><span>"+e.Msg.getMsg("Message")+":</span><br>"+e.Utility.encodeText(r)+"</p><p class='vis-w-feedDateTime vis-secondary-clr'  style=' width: 95%; margin-right: 10px;'>"+o+"</p></div></div></div>",n.append(i)}this.Initalize=function(){a=' <div id="requestwelcomeDivId'+o.AD_UserHomeWidgetID+'" class="vis-w-welcomeScreenFeeds w-100 vis-RequestwelcomeScreenCls" >   <div class="vis-w-row">       <h2 class="vis-noticeHeading vis-RequestWidth">  <div class="vis-RequestInnerDivCls">          <span id="spanWelcomeTabtopHdr" class="vis-welcomeScreenContentTittle-icon fa fa-bell-o"></span>           <strong class="vis-RequestStrongCls" id="sAlrtTxtType">'+e.Msg.getMsg("Requests")+'</strong> <div id="reqCountDiv'+o.AD_UserHomeWidgetID+'" title="'+e.Msg.getMsg("Requests")+'" class="vis-w-welcomeScreenTab-notificationBubble blank"></div> </div> <div class="vis-w-iconsCls">          <a id="hlnkTabDataRefReq'+o.AD_UserHomeWidgetID+'" href="javascript:void(0)" title="'+e.Msg.getMsg("Requery")+'" class="vis-w-feedicon vis-RequestHlnkTabDataRefReq" style="display:none;"><i class="vis vis-refresh"></i></a>           <span id="sNewNts'+o.AD_UserHomeWidgetID+'" class="vis-w-feedicon vis-RequestNewNtsCls" title="New Record"><i class="vis vis-plus"></i></span>  </div>      </h2>   </div>   <div id="welcomeScreenFeedsList'+o.AD_UserHomeWidgetID+'" class="scrollerVertical vis-RequestWelcomeScreenFeedsListCls vis-a-setHeightReqstAtcion" ></div>  </div>',r.append(a),i=r.find("#requestwelcomeDivId"+o.AD_UserHomeWidgetID),n=i.find("#welcomeScreenFeedsList"+o.AD_UserHomeWidgetID),i.find("#reqCountDiv"+o.AD_UserHomeWidgetID),s=i.find("#hlnkTabDataRefReq"+o.AD_UserHomeWidgetID),l=i.find("#sNewNts"+o.AD_UserHomeWidgetID),n.on("scroll",A),s.on("click",o.refreshWidget),l.on("click",function(){V("VIS_129",null,function(t){var a=new e.Query;a.addRestriction("R_Request_ID",e.Query.prototype.EQUAL,0),e.viewManager.startWindow(t,a)})}),$bsyDiv=t('<div id="busyDivId'+o.AD_UserHomeWidgetID+'" class="vis-busyindicatorouterwrap"><div id="busyDiv2Id'+o.AD_UserHomeWidgetID+'" class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),r.append($bsyDiv),p(!0),v(!0,!0),setInterval(function(){o.refreshWidget()},3e5)};var V=function(a,i,n){var l=!!n,s=null;return function(e,a,i){var n=null;t.ajax({url:d,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(e)}).done(function(e){n=e,i&&i(e)})}({sql:a,page:1,pageSize:0},0,function(t){a=(new e.DB.DataSet).toJson(t);var a=(new e.DB.DataSet).toJson(t);s=a.getTable(0).getRows().length>0?a.getTable(0).getRow(0).getCell(0):null,a.dispose(),a=null,l&&n(s)}),s};function A(e){if(t(this).scrollTop()+t(this).innerHeight()>=.99*this.scrollHeight){p(!0);var a=parseInt(r.find("#reqCountDiv"+o.AD_UserHomeWidgetID).html());10*c<=a&&(c+=1,v(!1)),p(!1)}}this.refreshWidget=function(){p(!0),n.empty(),c=1,v(!0),n.scrollTop(0)},this.getRoot=function(){return r},this.disposeComponent=function(){r.remove()}},e.RequestWidget.prototype.refreshWidget=function(){},e.RequestWidget.prototype.init=function(e,t){this.frame=t,this.AD_UserHomeWidgetID=t.widgetInfo.AD_UserHomeWidgetID,this.windowNo=e,this.Initalize(),this.frame.getContentGrid().append(this.getRoot())},e.RequestWidget.prototype.widgetSizeChange=function(e,t){},e.RequestWidget.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null}}(VIS,jQuery)},7522:()=>{VAS=window.VAS||{},function(e,t){e.VAS_PendingTransferWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[];this.initalize=function(){l=this.widgetInfo.AD_UserHomeWidgetID,e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e);var a='<div id="VAS_TransferContainer_'+l+'" class="VAS-deliveries-container-pending"><div class="VAS-deliveries-heading"><h6>'+VIS.Msg.getMsg("VAS_PendingTransfers")+'</h6></div><div class="VAS-delivery-count"><div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_Transfers")+' <span id="VAS_TransferCount_'+l+'">0</span></div></div><div class="VAS-delivery-detail"><div class="VAS-box-heading"></div></div><div class="VAS-height-container"><div id="VAS_TransferBox_'+l+'" class="VAS-deliveries-listing"></div><div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing"></div></div><div class="VAS-pagination-container"></div></div>';n.append(a)},this.intialLoad=function(r){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_TransferContainer_"+l).show(),VIS.dataContext.getJSONData(VIS.Application.contextUrl+"Product/GetExpectedTransfer",{pageNo:r,pageSize:5,Type:"PT"},function(c){if(n.find("#VAS_TransferBox_"+l).empty(),n.find("#VAS_ReqContainer"+l).remove,null!=c&&null!=c.Requisitions&&c.Requisitions.length>0){for(i=0;i<c.Requisitions.length;i++){var u='<div id="VAS_ReqContainer'+l+'" class="VAS-delivery-box" ><div class="VAS-box-heading"><div class="VAS-icon-w-name"><i class="fa fa-file-text" aria-hidden="true"></i><div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor" title="'+VIS.Msg.getMsg("DocumentNo")+'" data-doc-no="'+c.Requisitions[i].DocumentNo+'" data-customer-name="'+c.Requisitions[i].Employee+'" data-reqid="'+c.Requisitions[i].M_Requisition_ID+'">'+c.Requisitions[i].DocumentNo+'</div></div><div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+c.Requisitions[i].LineCount+'</div></div><div class="VAS-spaceBetween-col"></div><div class="VAS-spaceBetween-col grid-2-col"><div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Destination")+'">'+c.Requisitions[i].Destination+'</div><div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_Source")+'">'+c.Requisitions[i].Source+'</div></div><div class="VAS-spaceBetween-col"><div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+c.Requisitions[i].Symbol+"</span> "+c.Requisitions[i].GrandTotal.toLocaleString()+"</div></div></div>";n.find("#VAS_TransferBox_"+l).append(u)}s=[],c.Requisitions.forEach(function(e){e.ReqLines&&e.ReqLines.length>0&&(s[e.DocumentNo]=e.ReqLines)}),1==r&&(n.find("#VAS_TransferCount_"+l).text(c.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/5);var s=t('<div class="VAS-slider-arrows VAS-orders-text-white">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(c.RecordCount)),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){var i=t(this).data("doc-no");t(this).data("customer-name");!function(i,r,c){n.find("#VAS_TransferContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var u='<div id="VAS_ProductContainer_'+l+'" class="VAS-deliveries-container-pending"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-deliveries-heading">        <h6>            <span id="VAS_BackToTransfer_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToTransfer")+'        </h6><span id="VAS_GenerateTransfer_'+l+'" class="VAS-generate-delivery-btn" data-reqid="'+c+'" title="'+VIS.Msg.getMsg("VAS_GenMaterialTransfer")+'"><i class="fa fa-truck" aria-hidden="true"></i></span>    </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading VAS-orders-text-white">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text VAS-orders-text-white" aria-hidden="true"></i>                    <div class="VAS-doc-no VAS-orders-text-white" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count VAS-orders-text-white"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(u);var d=s[i]||[],g=6,p=Math.ceil(d.length/g),v=1;function _(e){e<1&&(e=1),e>p&&(e=p);var t=((v=e)-1)*g,a=Math.min(t+g,d.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s,r=d[i],c=o.includes(r.C_OrderLine_ID),u=r.OnHandQty>0&&r.OnHandQty>=r.QtyOrdered,_=u?"VAS-delivery-box":"VAS-delivery-box no-stock";s=r.OnHandQty>=r.QtyOrdered?"badge-green":r.OnHandQty<r.QtyOrdered&&r.OnHandQty>0?"badge-orange":"badge-red",n.find("#VAS_OrderLine_"+l).append('            <div class="'+_+'">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-reqlineid="'+r.M_RequisitionLine_ID+'"'+(c?" checked":"")+(u?"":" disabled")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+r.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count">                    <span title = "'+VIS.Msg.getMsg("VAS_RemianingQty")+'" class="badge badge-light '+s+'"> '+r.QtyEntered+'</span ></div >                       </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+r.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+r.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(d.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details VAS-orders-text-white">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+v+VIS.Msg.getMsg("VAS_Of")+p+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}d.length>0&&_(v);n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackToTransfer_"+l),n.off("click","#VAS_GenerateTransfer_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){_(v-1)}),n.on("click","#VAS_NextPage_"+l,function(){_(v+1)}),n.on("click","#VAS_BackToTransfer_"+l,function(){n.find("#VAS_TransferContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("reqlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateTransfer_"+l).show():n.find("#VAS_GenerateTransfer_"+l).hide()}),n.on("click","#VAS_GenerateTransfer_"+l,function(){!function(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateMaterialTransfer",data:{M_Requisition_ID:i,M_RequisitionLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).Movement_ID>0)try{var i={TabWhereClause:"M_Movement.M_Movement_ID="+t.Movement_ID,TabLayout:"Y",TabIndex:"0"};a.widgetFirevalueChanged(i),a.currentPage=1,a.intialLoad(a.currentPage)}catch(e){console.log(e)}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_TransferNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})}(t(this).data("reqid"))}),n.find("#VAS_GenerateTransfer_"+l).hide()}(i,0,t(this).data("reqid"))})}e.css("visibility","hidden")})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_PendingTransferWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_PendingTransferWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_PendingTransferWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_PendingTransferWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_PendingTransferWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_PendingTransferWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},7566:()=>{VAS=window.VAS||{},function(e,t){e.VAS_ExpectedOrderWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[],r=0;this.initalize=function(){const a='<div id="VAS_DeliveryContainer_'+(l=this.widgetInfo.AD_UserHomeWidgetID)+'" class="VAS-Expected-Order-container">    <div class="VAS-orders-heading">        <h6>'+VIS.Msg.getMsg("VAS_ExpectedOrders")+'</h6>    </div>    <div class="VAS-delivery-count">        <div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_Orders")+' <span id="VAS_DeliveryCount_'+l+'">0</span></div>    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">        </div>    </div>    <div class="VAS-height-container">        <div id="VAS_DeliveryBox_'+l+'" class="VAS-deliveries-listing">        </div>        <div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing">        </div>    </div><div class="VAS-pagination-container"></div></div>';e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e),n.append(a)},this.intialLoad=function(c){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_DeliveryContainer_"+l).show(),t.ajax({url:VIS.Application.contextUrl+"Product/GetExpectedDelivery",data:{pageNo:c,pageSize:4,Type:"EG"},dataType:"json",success:function(u){u=JSON.parse(u);if(n.find("#VAS_DeliveryBox_"+l).empty(),n.find("#VAS_OrderContainer").remove,null!=u&&null!=u.Orders&&u.Orders.length>0){for(i=0;i<u.Orders.length;i++){var d='<div id="VAS_OrderContainer_'+l+'" class="VAS-delivery-box" >    <div class="VAS-box-heading">        <div class="VAS-icon-w-name">            <i class="fa fa-file-text" aria-hidden="true"></i>            <div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor"                 title="'+VIS.Msg.getMsg("Document_No")+'"                 data-doc-no="'+u.Orders[i].DocumentNo+'"                 data-customer-name="'+u.Orders[i].CustomerName+'"                 data-orderid="'+u.Orders[i].C_Order_ID+'">                '+u.Orders[i].DocumentNo+'            </div>        </div>        <div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+u.Orders[i].LineCount+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("Vendor")+'">'+u.Orders[i].CustomerName+'</div>    </div>    <div class="VAS-spaceBetween-col grid-2-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_VendorLocation")+'">'+u.Orders[i].DeliveryLocation+'</div>        <div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_ProductLocation")+'">'+u.Orders[i].ProductLocation+'</div>    </div>    <div class="VAS-spaceBetween-col">        <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+u.Orders[i].Symbol+"</span> "+u.Orders[i].GrandTotal.toLocaleString()+"</div>    </div></div>";n.find("#VAS_DeliveryBox_"+l).append(d)}s=[],u.Orders.forEach(function(e){e.OrderLines&&e.OrderLines.length>0&&(s[e.DocumentNo]=e.OrderLines)}),1==c&&(n.find("#VAS_DeliveryCount_"+l).text(u.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/4);var s=t('<div class="VAS-slider-arrows">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(u.RecordCount),r=u.AD_Window_ID),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){!function(i,c,u){n.find("#VAS_DeliveryContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var d='<div id="VAS_ProductContainer_'+l+'" class="VAS-Expected-Order-container"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-orders-heading">        <h6>            <span id="VAS_BackTodelivery_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToOrder")+'        </h6><span id="VAS_GenerateGRN_'+l+'" class="VAS-generate-delivery-btn" data-orderid="'+u+'" title="'+VIS.Msg.getMsg("VAS_GenerateGRN")+'"><i class="vis vis-action"></i></span>     </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text" aria-hidden="true"></i>                    <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>                <div class="VAS-expectedTxt" title="'+VIS.Msg.getMsg("Vendor")+'">'+c+'</div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(d);var g=s[i]||[],p=6,v=Math.ceil(g.length/p),_=1;function V(e){e<1&&(e=1),e>v&&(e=v);var t=((_=e)-1)*p,a=Math.min(t+p,g.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s=g[i],r=o.includes(s.C_OrderLine_ID);n.find("#VAS_OrderLine_"+l).append('            <div class="VAS-delivery-box">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-orderlineid="'+s.C_OrderLine_ID+'"'+(r?" checked":"")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+s.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count"><span title="'+VIS.Msg.getMsg("VAS_RemianingQty")+'">'+s.QtyEntered+'</span></div>                </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+s.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+s.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(g.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+_+VIS.Msg.getMsg("VAS_Of")+v+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}g.length>0&&V(_);function A(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateGRN",data:{C_Order_ID:i,C_OrderLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).Shipment_ID>0){if(a.currentPage=1,a.intialLoad(a.currentPage),r>0){var i=new VIS.Query;i.addRestriction("M_InOut_ID",VIS.Query.prototype.EQUAL,t.Shipment_ID),i.setRecordCount(1),VIS.viewManager.startWindow(r,i)}}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_DeliveryOrderNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}}),console.log("Generating delivery order for ID:",i)}n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackTodelivery_"+l),n.off("click","#VAS_GenerateGRN_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){V(_-1)}),n.on("click","#VAS_NextPage_"+l,function(){V(_+1)}),n.on("click","#VAS_BackTodelivery_"+l,function(){n.find("#VAS_DeliveryContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("orderlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateGRN_"+l).show():n.find("#VAS_GenerateGRN_"+l).hide(),console.log(o)}),n.on("click","#VAS_GenerateGRN_"+l,function(){A(t(this).data("orderid"))}),n.find("#VAS_GenerateGRN_"+l).hide()}(t(this).data("doc-no"),t(this).data("customer-name"),t(this).data("orderid"))})}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_ExpectedOrderWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_ExpectedOrderWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_ExpectedOrderWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_ExpectedOrderWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_ExpectedOrderWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_ExpectedOrderWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},7932:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.CalloutAssignment")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.Product=function(i,n,l,s,o,r){if(null==o||""==o.toString())return"";if(this.isCalloutActive()||null==o)return"";var c=a.getValueOfInt(o);if(0==c)return"";this.setCalloutActive(!0);var u=0,d=null,g=null,p=null;try{var v=e.dataContext.getJSONRecord("MProduct/GetResourceAssignmntDet",c.toString());null!=v&&(u=a.getValueOfInt(v.M_Product_ID),d=a.getValueOfString(v.Name),g=a.getValueOfString(v.Description),p=a.getValueOfDecimal(v.Qty))}catch(e){this.setCalloutActive(!1),this.log.log(t.SEVERE,"product",e)}if(this.log.fine("S_ResourceAssignment_ID="+c+" - M_Product_ID="+u),0!=u){l.setValue("M_Product_ID",a.getValueOfInt(u)),null!=g&&(d+=" ("+g+")"),"."!=d&&l.setValue("Description",d);var _="Qty";l.getTableName().startsWith("C_Order")?_="QtyOrdered":l.getTableName().startsWith("C_Invoice")&&(_="QtyInvoiced"),null!=p&&l.setValue(_,p)}return this.setCalloutActive(!1),l=o=null,""},e.Model.CalloutAssignment=i}(VIS,jQuery)},8236:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.CalloutInOut")}function n(){e.CalloutEngine.call(this,"VIS.CalloutShipReceiptConfirmLine")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.Order=function(t,i,n,l,s,o){if(null==s||""==s.toString())return"";try{var r=a.getValueOfInt(s.toString());if(null==r||0==r)return"";if(this.isCalloutActive())return"";var c=r.toString(),u=e.dataContext.getJSONRecord("MOrder/GetOrder",c),d=e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA077_");if(0!=a.getValueOfInt(u.ID))n.setValue("DateOrdered",u.DateOrdered),n.setValue("POReference",u.POReference),n.getValue("AD_Org_ID")!=a.getValueOfInt(u.AD_Org_ID)&&n.setValue("AD_Org_ID",a.getValueOfInt(u.AD_Org_ID)),n.setValue("DeliveryRule",u.DeliveryRule),n.setValue("DeliveryViaRule",u.DeliveryViaRule),n.setValue("M_Shipper_ID",a.getValueOfInt(u.M_Shipper_ID)),n.setValue("FreightCostRule",u.FreightCostRule),n.setValue("FreightAmt",u.FreightAmt),n.setValue("C_BPartner_ID",a.getValueOfInt(u.C_BPartner_ID)),n.setValue("C_BPartner_Location_ID",a.getValueOfInt(u.C_BPartner_Location_ID)),n.setValue("AD_OrgTrx_ID",a.getValueOfInt(u.AD_OrgTrx_ID)),n.setValue("C_Activity_ID",a.getValueOfInt(u.C_Activity_ID)),n.setValue("C_Campaign_ID",a.getValueOfInt(u.C_Campaign_ID)),n.setValue("C_Project_ID",a.getValueOfInt(u.C_Project_ID)),n.setValue("User1_ID",a.getValueOfInt(u.User1_ID)),n.setValue("User2_ID",a.getValueOfInt(u.User2_ID)),null!=n.getField("C_IncoTerm_ID")&&n.setValue("C_IncoTerm_ID",a.getValueOfInt(u.C_IncoTerm_ID)),n.getValue("IsReturnTrx")&&(n.setValue("Orig_Order_ID",u.Orig_Order_ID),n.setValue("Orig_InOut_ID",u.Orig_InOut_ID),"Y"==a.getValueOfString(u.IsDropShip)?n.setValue("IsDropShip",!0):n.setValue("IsDropShip",!1)),n.setValue("M_Warehouse_ID",a.getValueOfInt(u.M_Warehouse_ID)),d.VA077_&&(""!=u.VA077_HistoricContractDate&&n.setValue("VA077_HistoricContractDate",Dateoffset(u.VA077_HistoricContractDate)),""!=u.VA077_ChangeStartDate&&n.setValue("VA077_ChangeStartDate",Dateoffset(u.VA077_ChangeStartDate)),""!=u.VA077_ContractCPStartDate&&n.setValue("VA077_ContractCPStartDate",Dateoffset(u.VA077_ContractCPStartDate)),""!=u.VA077_ContractCPEndDate&&n.setValue("VA077_ContractCPEndDate",Dateoffset(u.VA077_ContractCPEndDate)),n.setValue("VA077_PartialAmtCatchUp",a.getValueOfDecimal(u.VA077_PartialAmtCatchUp)),n.setValue("VA077_OldAnnualContractTotal",a.getValueOfDecimal(u.VA077_OldAnnualContractTotal)),n.setValue("VA077_AdditionalAnnualCharge",a.getValueOfDecimal(u.VA077_AdditionalAnnualCharge)),n.setValue("VA077_NewAnnualContractTotal",a.getValueOfDecimal(u.VA077_NewAnnualContractTotal)),n.setValue("VA077_SalesCoWorker",a.getValueOfDecimal(u.VA077_SalesCoWorker)),n.setValue("VA077_SalesCoWorkerPer",a.getValueOfDecimal(u.VA077_SalesCoWorkerPer)),n.setValue("VA077_TotalMarginAmt",a.getValueOfDecimal(u.VA077_TotalMarginAmt)),n.setValue("VA077_TotalPurchaseAmt",a.getValueOfDecimal(u.VA077_TotalPurchaseAmt)),n.setValue("VA077_TotalSalesAmt",a.getValueOfDecimal(u.VA077_TotalSalesAmt)),n.setValue("VA077_MarginPercent",a.getValueOfDecimal(u.VA077_MarginPercent)))}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return n=s=null,""},i.prototype.DocType=function(i,n,l,s,o,r){if(null==o||""==o.toString())return"";var c=a.getValueOfInt(o.toString());if(null==c||0==c)return"";var u=c.toString(),d=e.dataContext.getJSONRecord("MInOut/GetDocTypeData",u);try{if(i.setContext(n,"C_DocTypeTarget_ID",c),null!=d){var g=a.getValueOfString(d.docBaseType),p="Y"==d.IsReturnTrx;g.equals("MMS")&&!p?l.setValue("MovementType","C-"):g.equals("MMS")&&p?l.setValue("MovementType","C+"):g.equals("MMR")&&!p?l.setValue("MovementType","V+"):g.equals("MMR")&&p&&l.setValue("MovementType","V-"),"Y"==d.IsDocNoControlled&&l.setValue("DocumentNo","<"+a.getValueOfString(d.CurrentNext)+">")}}catch(e){return this.setCalloutActive(!1),null!=d&&(d.close(),d=null),this.log.log(t.SEVERE,sql,e),e.message}return i=n=l=o=null,""},i.prototype.BPartner=function(t,i,n,l,s,o){var r=null,c=null;if(null==s||""==s.toString())return"";try{var u=a.getValueOfInt(s.toString());if(null==u||0==u)return"";var d=n.getValue("IsReturnTrx"),g=n.getValue("IsSOTrx"),p=n.getValue("C_Order_ID"),v=(!0).toString()+","+u;if(null!=(r=e.dataContext.getJSONRecord("MBPartner/GetBPartnerOrderData",v))){var _=r.C_BPartner_Location_ID;null==p&&(0==_?n.setValue("C_BPartner_Location_ID",null):n.setValue("C_BPartner_Location_ID",_)),0==(_=r.AD_User_ID)?n.setValue("AD_User_ID",null):n.setValue("AD_User_ID",_);var V=g?r.C_IncoTerm_ID:r.C_IncoTermPO_ID;if(V>0&&n.setValue("C_IncoTerm_ID",V),g&!d){var A=r.CreditStatusSettingOn,m=r.CreditAvailable;if("CH"==A)null!=r.SOCreditStatus&&(r.SOCreditStatus.equals("X")||m<=0&&e.ADialog.info("CreditLimitOver"));else{var f=a.getValueOfInt(n.getValue("C_BPartner_Location_ID"));if(null!=(c=e.dataContext.getJSONRecord("MBPartner/GetLocationData",f.toString())))if("CL"==(A=a.getValueOfString(c.CreditStatusSettingOn)))if(0!=a.getValueOfDouble(c.SO_CreditLimit))(m=a.getValueOfDouble(c.CreditAvailable))<=0&&e.ADialog.info("CreditOver")}}}}catch(e){return this.setCalloutActive(!1),e}return n=s=null,""},i.prototype.Warehouse=function(i,n,l,s,o,r){if(null==o||""==o.toString())return"";if(this.isCalloutActive())return"";var c=a.getValueOfInt(o);if(null==c||0==c)return"";this.setCalloutActive(!0);var u=e.dataContext.getJSONRecord("MInOut/GetWarehouse",o.toString());try{if(null!=u){var d=a.getValueOfInt(u.AD_Org_ID);i.getContextAsInt(n,"AD_Org_ID")!=d&&l.setValue("AD_Org_ID",d),0==(d=a.getValueOfInt(u.M_Locator_ID))?i.setContext(n,0,"M_Locator_ID",null):(this.log.config("M_Locator_ID="+d),i.setContext(n,"M_Locator_ID",d))}}catch(e){return this.setCalloutActive(!1),null!=u&&(u.close(),u=null),this.log.log(t.SEVERE,sql,e),this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),i=n=l=o=null,""},i.prototype.OrderLine=function(t,i,n,l,s,o){if(null==s||""==s.toString())return"";this.setCalloutActive(!0);var r=a.getValueOfInt(s.toString());if(null==r||0==r)return this.setCalloutActive(!1),"";try{var c=r.toString(),u=e.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA077_"),d=e.dataContext.getJSONRecord("MOrderLine/GetOrderLine",c);if(0!=a.getValueOfInt(d.GetID)){a.getValueOfInt(d.M_Product_ID)>0?(n.setValue("M_Product_ID",a.getValueOfInt(d.M_Product_ID)),n.setValue("C_Charge_ID",null)):(n.setValue("C_Charge_ID",a.getValueOfInt(d.C_Charge_ID)),n.setValue("M_Product_ID",null)),n.setValue("PrintDescription",d.PrintDescription.toString()),n.setValue("M_AttributeSetInstance_ID",a.getValueOfInt(d.M_AttributeSetInstance_ID)),n.setValue("C_UOM_ID",a.getValueOfInt(d.C_UOM_ID));var g=a.getValueOfDecimal(d.QtyOrdered)-a.getValueOfDecimal(d.QtyDelivered);n.setValue("MovementQty",g);var p=g;if(a.getValueOfDecimal(d.QtyEntered).toString().compareTo(a.getValueOfDecimal(d.QtyOrdered))!=a.getValueOfDecimal(d.QtyOrdered)&&(p=p*a.getValueOfDecimal(d.QtyEntered)/a.getValueOfDecimal(d.QtyOrdered).toFixed(12)),n.setValue("QtyEntered",p),n.findColumn("VAS_HSN_SACCode")>-1&&d.hasOwnProperty("VAS_HSN_SACCode")&&n.setValue("VAS_HSN_SACCode",d.VAS_HSN_SACCode),n.setValue("C_Activity_ID",a.getValueOfInt(d.C_Activity_ID)),n.setValue("C_Campaign_ID",a.getValueOfInt(d.C_Campaign_ID)),n.setValue("C_Project_ID",a.getValueOfInt(d.C_Project_ID)),n.setValue("C_ProjectPhase_ID",a.getValueOfInt(d.C_ProjectPhase_ID)),n.setValue("C_ProjectTask_ID",a.getValueOfInt(d.C_ProjectTask_ID)),n.setValue("AD_OrgTrx_ID",a.getValueOfInt(d.AD_OrgTrx_ID)),n.setValue("User1_ID",a.getValueOfInt(d.User1_ID)),n.setValue("User2_ID",a.getValueOfInt(d.User2_ID)),a.getValueOfBoolean(d.IsReturnTrx)){n.setValue("Orig_OrderLine_ID",a.getValueOfInt(d.Orig_OrderLine_ID));c=d.Orig_InOutLine_ID,e.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",c)}"Y"==a.getValueOfString(d.IsDropShip)?n.setValue("IsDropShip",!0):n.setValue("IsDropShip",!1),u.VA077_&&(n.setValue("VA077_CNAutodesk",a.getValueOfString(d.VA077_CNAutodesk)),n.setValue("VA077_Duration",a.getValueOfString(d.VA077_Duration)),n.setValue("VA077_MarginAmt",a.getValueOfDecimal(d.VA077_MarginAmt)),n.setValue("VA077_MarginPercent",a.getValueOfDecimal(d.VA077_MarginPercent)),n.setValue("VA077_OldSN",a.getValueOfString(d.VA077_OldSN)),n.setValue("VA077_ProductInfo",a.getValueOfString(d.VA077_ProductInfo)),n.setValue("VA077_PurchasePrice",a.getValueOfDecimal(d.VA077_PurchasePrice)),n.setValue("VA077_RegEmail",a.getValueOfString(d.VA077_RegEmail)),n.setValue("VA077_SerialNo",a.getValueOfString(d.VA077_SerialNo)),n.setValue("VA077_UpdateFromVersn",a.getValueOfString(d.VA077_UpdateFromVersn)),n.setValue("VA077_UserRef_ID",a.getValueOfInt(d.VA077_UserRef_ID)),n.setValue("VA077_ServiceContract_ID",a.getValueOfInt(d.VA077_ServiceContract_ID)),""!=d.VA077_StartDate&&n.setValue("VA077_StartDate",Dateoffset(d.VA077_StartDate)),""!=d.VA077_EndDate&&n.setValue("VA077_EndDate",Dateoffset(d.VA077_EndDate)),a.getValueOfBoolean(d.VA077_LicenceTracked)?n.setValue("VA077_LicenceTracked",!0):n.setValue("VA077_LicenceTracked",!1))}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),n=s=null,""},i.prototype.Product=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";var r=a.getValueOfInt(s);if(0==r)return"";this.setCalloutActive(!0);try{if(n.setValue("M_AttributeSetInstance_ID",null),"Y"==t.getWindowContext(i,"IsSOTrx",!0))return this.setCalloutActive(!1),"";var c=a.getValueOfDecimal(n.getValue("QtyEntered"));n.setValue("MovementQty",c);var u=n.getValue("M_InOut_ID").toString()+","+r.toString()+","+c.toString()+","+t.getContextAsInt(i,"C_BPartner_ID").toString(),d=e.dataContext.getJSONRecord("MInOut/GetUOMConv",u);null!=d&&(d.C_UOM_ID!=d.uom&&0!=d.uom?(n.setValue("MovementQty",d.qtyentered),n.setValue("C_UOM_ID",d.uom)):n.setValue("C_UOM_ID",d.C_UOM_ID));var g=e.dataContext.getJSONRecord("MProduct/GetProduct",r.toString());null!=g&&n.setValue("PrintDescription",g.DocumentNote)}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),t=i=n=s=null,""},i.prototype.Qty=function(i,n,l,s,o,r){if(this.isCalloutActive()||null==o||""==o.toString())return"";this.setCalloutActive(!0);try{var c,u,d=i.getContextAsInt(n,"M_Product_ID");this.log.log(t.WARNING,"qty - init - M_Product_ID="+d);var g="",p=0;if(0==d)u=a.getValueOfDecimal(l.getValue("QtyEntered")),l.setValue("MovementQty",u);else if(s.getColumnName().toString().equals("C_UOM_ID")){var v=o;u=a.getValueOfDecimal(l.getValue("QtyEntered")),g=v.toString(),p=e.dataContext.getJSONRecord("MUOM/GetPrecision",g);var _=a.getValueOfDecimal(u.toFixed(p));0!=u.compareTo(_)&&(this.log.fine("Corrected qtyEntered Scale UOM="+v+"; qtyEntered="+u+"->"+_),u=_,l.setValue("QtyEntered",u)),g=d.toString().concat(",",v.toString(),",",u.toString()),null==(c=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",g))&&(c=u);var V=0!=u.compareTo(c);this.log.fine("UOM="+v+", qtyEntered="+u+" -> "+V+" movementQty="+c),i.setContext(n,"UOMConversion",V?"Y":"N"),l.setValue("MovementQty",c)}else if(0==i.getContextAsInt(n,"C_UOM_ID"))u=a.getValueOfDecimal(l.getValue("QtyEntered")),l.setValue("MovementQty",u);else if(s.getColumnName().toString().equals("QtyEntered")){if(a.getValueOfInt(l.getValue("M_InOutLine_ID"))>0)if(e.dataContext.getJSONRecord("MInOutLine/GetInvoiceLine",l.getValue("M_InOutLine_ID").toString())>0)return l.setValue("QtyEntered",r),this.setCalloutActive(!1),"VIS_CantChangeQty";v=i.getContextAsInt(n,"C_UOM_ID");u=a.getValueOfDecimal(o),g=d.toString(),p=e.dataContext.getJSONRecord("MProduct/GetUOMPrecision",g);_=a.getValueOfDecimal(u.toFixed(p));0!=u.compareTo(_)&&(this.log.fine("Corrected qtyEntered Scale UOM="+v+"; qtyEntered="+u+"->"+_),u=_,l.setValue("QtyEntered",u)),g=d.toString().concat(",",v.toString(),",",u.toString()),null==(c=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",g))&&(c=u);V=0!=u.compareTo(c);this.log.fine("UOM="+v+", qtyEntered="+u+" -> "+V+" movementQty="+c),i.setContext(n,"UOMConversion",V?"Y":"N"),l.setValue("MovementQty",c)}else if(s.getColumnName().toString().equals("MovementQty")){v=i.getContextAsInt(n,"C_UOM_ID");c=a.getValueOfDecimal(o),g=d.toString(),p=e.dataContext.getJSONRecord("MProduct/GetUOMPrecision",g);var A=a.getValueOfDecimal(c.toFixed(p));0!=c.compareTo(A)&&(this.log.fine("Corrected movementQty "+c+"->"+A),c=A,l.setValue("MovementQty",c)),g=d.toString().concat(",",v.toString(),",",c.toString()),null==(u=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",g))&&(u=c);V=0!=c.compareTo(u);this.log.fine("UOM="+v+", movementQty="+c+" -> "+V+" qtyEntered="+u),i.setContext(n,"UOMConversion",V?"Y":"N"),l.setValue("QtyEntered",u)}var m="Y".equals(i.getContext("IsReturnTrx"));if(0!=d&&m){g=a.getValueOfInt(l.getValue("C_OrderLine_ID")).toString();var f=e.dataContext.getJSONRecord("MOrderLine/GetOrderLine",g);if(0!=f.Get_ID()){var D=f.Orig_InOutLine_ID;if(0!=D){g=D.toString();var h=e.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",g).MovementQty;if(c=a.getValueOfDecimal(l.getValue("MovementQty")),h.toString().compareTo(c)<0){"Y"==i.getWindowContext(n,"IsSOTrx",!0)?e.ADialog.info("QtyShippedAndReturned"):e.ADialog.info("QtyRecievedAndReturnd"),l.setValue("MovementQty",h),c=h;v=i.getContextAsInt(n,"C_UOM_ID");g=d.toString().concat(",",v.toString(),",",c.toString()),null==(u=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",g))&&(u=c),l.setValue("QtyEntered",u),l.setValue("MovementQty",c),this.log.fine("qtyEntered : "+u.toString()+"movementQty : "+c.toString())}}}}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),i=n=l=s=o=r=null,""},i.prototype.Asi=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";var r=a.getValueOfInt(s);if(null==r||0==r)return"";this.setCalloutActive(!0);try{if(0==a.getValueOfInt(n.getValue("M_Locator_ID"))){var c=t.getContextAsInt(i,"M_Product_ID"),u=t.getContextAsInt(i,"M_Warehouse_ID"),d=u.toString(),g=e.dataContext.getJSONRecord("MInOut/GetDefaultLocatorID",d);if(t.setContext(i,"M_Locator_ID",g),this.log.fine("M_Product_ID="+c+", M_ASI_ID="+r+" - M_Warehouse_ID="+u+", M_Locator_ID="+g),r==t.getContextAsInt(i,"M_AttributeSetInstance_ID")){var p=t.getContextAsInt(i,"M_Locator_ID");0!=p&&(this.log.fine("Selected M_Locator_ID="+p),n.setValue("M_Locator_ID",p))}}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),t=i=n=s=null,""},i.prototype.Charge=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";var r=a.getValueOfInt(n.getValue("C_Charge_ID"));if(null==r||0==r)return"";this.setCalloutActive(!0);try{var c=e.dataContext.getJSONRecord("MCharge/GetChargeDetails",r.toString());null!=c&&n.setValue("PrintDescription",c.PrintDescription)}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),n=s=null,""},i.prototype.setFleetDetail=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return n.setValue("VAS_VehicleRegistrationNo",null),n.setValue("VAS_GrossWeight",null),n.setValue("VAS_TareWeight",null),"";this.setCalloutActive(!0);var r=e.dataContext.getJSONRecord("MInOut/GetFleetDetail",a.getValueOfInt(n.getValue("VAS_FleetDetail_ID")));return null!=r?(n.setValue("VAS_VehicleRegistrationNo",r.VAS_VehicleRegistrationNo),n.setValue("VAS_GrossWeight",r.VAS_GrossWeight),n.setValue("VAS_TareWeight",r.VAS_TareWeight)):(n.setValue("VAS_VehicleRegistrationNo",null),n.setValue("VAS_GrossWeight",null),n.setValue("VAS_TareWeight",null)),this.setCalloutActive(!1),n=s=null,""},i.prototype.setShipperDetail=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return 323==n.getAD_Table_ID()?n.setValue("C_BPartner_ID",null):n.setValue("C_RefBPartner_ID",null),n.setValue("VAS_Transportation",null),"";this.setCalloutActive(!0);var r=e.dataContext.getJSONRecord("MInOut/GetShipperDetail",a.getValueOfInt(n.getValue("M_Shipper_ID")));return null!=r?(323==n.getAD_Table_ID()?n.setValue("C_BPartner_ID",r.C_BPartner_ID):n.setValue("C_RefBPartner_ID",r.C_BPartner_ID),n.setValue("VAS_Transportation",r.TaxID)):(323==n.getAD_Table_ID()?n.setValue("C_BPartner_ID",null):n.setValue("C_RefBPartner_ID",null),n.setValue("VAS_Transportation",null)),this.setCalloutActive(!1),n=s=null,""},i.prototype.setFreightCategory=function(t,i,n,l,s,o){if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);try{var r=e.dataContext.getJSONRecord("MInOut/GetFreightCategory",a.getValueOfInt(n.getValue("M_FreightCategory_ID")));null!=r&&n.setValue("VAS_Category",r.VAS_Category)}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),n=s=null,""},e.Model.CalloutInOut=i,e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.SetQty=function(e,t,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";if(this.setCalloutActive(!0),a.getValueOfDecimal(i.getValue("TargetQty"))<a.getValueOfDecimal(i.getValue("ConfirmedQty")))return i.setValue("ConfirmedQty",a.getValueOfDecimal(i.getValue("TargetQty"))),i.setValue("DifferenceQty",0),i.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";if("ConfirmedQty"==n.getColumnName()){if(a.getValueOfDecimal(i.getValue("ConfirmedQty"))<0)return i.setValue("ConfirmedQty",a.getValueOfDecimal(i.getValue("TargetQty"))),i.setValue("DifferenceQty",0),i.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";i.setValue("ScrappedQty",0),i.setValue("DifferenceQty",a.getValueOfDecimal(i.getValue("TargetQty"))-(a.getValueOfDecimal(i.getValue("ConfirmedQty"))+a.getValueOfDecimal(i.getValue("ScrappedQty"))))}else if("ScrappedQty"==n.getColumnName()){if(a.getValueOfDecimal(i.getValue("ScrappedQty"))<0)return i.setValue("ConfirmedQty",a.getValueOfDecimal(i.getValue("TargetQty"))),i.setValue("DifferenceQty",0),i.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";if(a.getValueOfDecimal(i.getValue("TargetQty"))<a.getValueOfDecimal(i.getValue("ConfirmedQty"))+a.getValueOfDecimal(i.getValue("ScrappedQty")))return i.setValue("ConfirmedQty",a.getValueOfDecimal(i.getValue("TargetQty"))),i.setValue("DifferenceQty",0),i.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";i.setValue("DifferenceQty",a.getValueOfDecimal(i.getValue("TargetQty"))-(a.getValueOfDecimal(i.getValue("ConfirmedQty"))+a.getValueOfDecimal(i.getValue("ScrappedQty"))))}return this.setCalloutActive(!1),""},e.Model.CalloutShipReceiptConfirmLine=n}(VIS,jQuery)},8323:()=>{!function(t){t.Logging.Level;var a=t.Utility.Util;function i(){t.CalloutEngine.call(this,"VIS.CalloutObjectData")}function n(){t.CalloutEngine.call(this,"VIS.CalloutOffer")}function l(){t.CalloutEngine.call(this,"VIS.copyname")}t.Utility.inheritPrototype(i,t.CalloutEngine),i.prototype.Objectchk=function(i,n,l,s,o,r){if(null==o||""==o.toString())return"";if(null==o)return"";var c,u,d=a.getValueOfInt(l.getValue("FO_OBJECT_DATA_ID")),g=a.getValueOfDateTime(l.getValue("TODAYDATE"));if(null==d)return"";var p=null;try{var v=[];for(v[0]=new t.DB.SqlParam("@FO_OBJ_DATA_ID",d),p=t.DB.executeReader("select FO_RES_ACCOMODATION_ID,DATE_FROM,TILL_DATE from FO_RES_ACCOMODATION where FO_OBJECT_DATA_ID=@FO_OBJ_DATA_ID",v,null);p.read();){c=a.getValueOfDateTime(p[1]),u=a.getValueOfDateTime(p[2]);var _=c;if(g.compareTo(u)>0)return l.setValue("RES_STATUS",!1),"";if(g.compareTo(c)<0)return l.setValue("RES_STATUS",!1),"";if(g.compareTo(c)>0&&g.compareTo(u)<0)for(;0!=_.compareTo(u);)0==g.compareTo(_)&&l.setValue("RES_STATUS",!0),_=_.AddDays(1)}p.close()}catch(t){this.setCalloutActive(!1),null!=p&&p.close(),this.log.severe(e.toString())}finally{null!=p&&p.close()}return l=o=null,""},t.Model.CalloutObjectData=i,t.Utility.inheritPrototype(n,t.CalloutEngine),n.prototype.Datechk=function(e,i,n,l,s,o){if(null==s||""==s.toString())return"";var r=a.getValueOfDateTime(s);if(null==r||0==r)return"";var c,u,d=0,g="select  DAYSPAYABLE2 from FO_SETTINGS where AD_ORG_ID="+n.getValue("AD_ORG_ID"),p=null;try{for(p=t.DB.executeReader(g,null,null);p.read();)d=a.getValueOfInt(p[0].toString());p.close()}catch(e){this.setCalloutActive(!1),null!=p&&p.close(),this.log.severe(e.toString())}c=a.getValueOfDateTime(n.getValue("DATE1")).AddDays(d),n.setValue("DATE2",c);var v=100;try{for(p=t.DB.executeReader("select max(OFFERNO)from FO_OFFER",null,null);p.read();)v=a.getValueOfInt(p[0].toString());p.close()}catch(e){this.setCalloutActive(!1),null!=p&&p.close(),this.log.severe(e.toString())}finally{null!=p&&p.close()}return u=null==v|0==v?100:v+1,n.setValue("OFFERNO",u),n=s=null,""},n.prototype.guestpricelist=function(e,i,n,l,s,o){if(null==s)return"";var r=a.getValueOfInt(s);if(null==r||0==r)return"";var c="select FO_PRICE_LIST_ID from FO_ADDRESS_PRICE where FO_ADDRESS_ID="+r,u=0,d=null;try{for(d=t.DB.executeReader(c,null,null);d.read();)u=a.getValueOfInt(d[0]);d.close()}catch(e){this.setCalloutActive(!1),null!=d&&d.close(),this.log.severe(e.toString())}finally{null!=d&&d.close()}return n.setValue("FO_PRICE_LIST_ID",u),n=s=null,""},t.Model.CalloutOffer=n,t.Utility.inheritPrototype(l,t.CalloutEngine),l.prototype.product=function(e,t,a,i,n,l){return a.setValue("Help",a.getValue("Name")),a=null,""},l.prototype.product2=function(e,t,a,i,n,l){return a.setValue("Description",a.getValue("Help")),a=null,""},t.Model.copyname=l}(VIS,jQuery)},8435:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutOfferServices")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.CalculatePrice=function(e,t,a){return Decimal.Subtract(Decimal.Multiply(e,t),a)},a.prototype.CalculateRebate=function(e,t,a){return Decimal.Multiply(Decimal.Multiply(e,t),Decimal.Multiply(new Decimal(.01),a))},a.prototype.OfferServices=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r=t.getValueOfInt(s);if(null==r||0==r)return"";var c,u,d,g,p,v,_,V,A,m=0,f=new Decimal(0),D=new Decimal(0),h=new Decimal(0),C=null;try{for((S=[])[0]=new e.DB.SqlParam("@FO_SERVICE_ID",r),C=e.DB.executeReader("select uom.FO_HOTEL_UOM_ID,s.DESCRIPTION from FO_HOTEL_UOM uom inner join FO_SERVICE s ON(uom.FO_HOTEL_UOM_ID= s.FO_HOTEL_UOM_ID) where s.FO_SERVICE_ID=@FO_SERVICE_ID ",S,null);C.read();)m=t.getValueOfInt(C[0]),n.setValue("AUOM_ID",m),n.setValue("CG1UOM_ID",m),n.setValue("CG2UOM_ID",m),n.setValue("DESCRIPTION",t.getValueOfString(C[1]));C.close()}catch(e){this.setCalloutActive(!1),null!=C&&C.close(),this.log.severe(e.toString())}finally{null!=C&&C.close()}try{var S;for((S=[])[0]=new SqlParameter("@FO_SERVICE_ID",r),C=e.DB.executeReader("select PRICE,CHILDGROUP1,CHILDGROUP2,UOM1,UOM2 from FO_SERVICE_PRICE_PRICELINE where CREATED=(select max(CREATED) from FO_SERVICE_PRICE_PRICELINE where FO_SERVICE_ID=@FO_SERVICE_ID)",S,null);C.read();)f=t.getValueOfDecimal(C[0]),D=t.getValueOfDecimal(C[1]),h=t.getValueOfDecimal(C[2]),V=C[3].toString(),A=C[4].toString(),"Y"==V&&(D=Decimal.Multiply(Decimal.Multiply(f,D),new Decimal(.01))),"Y"==A&&(h=Decimal.Multiply(Decimal.Multiply(f,h),new Decimal(.01))),n.setValue("APRICE",f),n.setValue("CG1PRICE",D),n.setValue("CG2PRICE",h)}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}finally{null!=C&&C.close()}var I,y,O=n.getValue("AUOM_ID").toString(),T=t.getValueOfInt(n.getValue("ANUM")),w=t.getValueOfDecimal(n.getValue("APRICE")),P=t.getValueOfDecimal(n.getValue("AREBATE")),b=t.getValueOfInt(n.getValue("CG1NUM")),M=t.getValueOfInt(n.getValue("CG2NUM")),x=t.getValueOfDecimal(n.getValue("CG1PRICE")),N=t.getValueOfDecimal(n.getValue("CG2PRICE")),L=t.getValueOfDateTime(n.getValue("ADATETO")),R=t.getValueOfDateTime(n.getValue("ADATEFROM")),U=Utility.timeUtil.getDaysBetween(R,L),E=R.Subtract(L),k=U/30,G=U/7;I=0==U%30?k:k+1,y=0==U%7?G:G+1;var B=E.Seconds,F=E.Minutes;if(0==t.getValueOfInt(P))switch(p=e.Env.ZERO,int.Parse(O)){case 1000003:c=w,u=x,d=N,u=x,n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000004:c=CalculatePrice(new Decimal(T),w,p),u=CalculatePrice(new Decimal(b),x,p),d=CalculatePrice(new Decimal(M),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=Decimal.Add(Decimal.Add(c,u),d),n.setValue("GRAND_TOTAL",g);break;case 1000005:c=CalculatePrice(new Decimal(T),w,p),u=CalculatePrice(new Decimal(b),x,p),d=CalculatePrice(new Decimal(M),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000006:c=CalculatePrice(new Decimal(U),w,p),u=CalculatePrice(new Decimal(U),x,p),d=CalculatePrice(new Decimal(U),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000007:c=CalculatePrice(new Decimal(I),w,p),u=CalculatePrice(new Decimal(I),x,p),d=CalculatePrice(new Decimal(I),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000008:c=CalculatePrice(new Decimal(y),w,p),u=CalculatePrice(new Decimal(y),x,p),d=CalculatePrice(new Decimal(y),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000009:c=CalculatePrice(new Decimal(U+1),w,p),u=CalculatePrice(new Decimal(U+1),x,p),d=CalculatePrice(new Decimal(U+1),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000010:c=CalculatePrice(new Decimal(24*U),w,p),u=CalculatePrice(new Decimal(24*U),x,p),d=CalculatePrice(new Decimal(24*U),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000011:c=CalculatePrice(new Decimal(F),w,p),u=CalculatePrice(new Decimal(F),x,p),d=CalculatePrice(new Decimal(F),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000012:c=CalculatePrice(new Decimal(B),w,p),u=CalculatePrice(new Decimal(B),x,p),d=CalculatePrice(new Decimal(B),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000013:c=CalculatePrice(new Decimal(U*T),w,p),u=CalculatePrice(new Decimal(U*b),x,p),d=CalculatePrice(new Decimal(U*M),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=Decimal.Add(Decimal.Add(c,u),d),n.setValue("GRAND_TOTAL",g);break;case 1000014:c=CalculatePrice(new Decimal(U*T),w,p),u=CalculatePrice(new Decimal(U*b),x,p),d=CalculatePrice(new Decimal(U*M),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000015:c=CalculatePrice(new Decimal(T*y),w,p),u=CalculatePrice(new Decimal(b*y),x,p),d=CalculatePrice(new Decimal(M*y),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=Decimal.Add(Decimal.Add(c,u),d),n.setValue("GRAND_TOTAL",g);break;case 1000016:c=CalculatePrice(new Decimal(T*y),w,p),u=CalculatePrice(new Decimal(b*y),x,p),d=CalculatePrice(new Decimal(M*y),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000017:c=CalculatePrice(new Decimal(T*(U+1)),w,p),u=CalculatePrice(new Decimal(b*(U+1)),x,p),d=CalculatePrice(new Decimal(M*(U+1)),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=Decimal.Add(Decimal.Add(c,u),d),n.setValue("GRAND_TOTAL",g);break;case 1000018:c=CalculatePrice(new Decimal((U+1)*T),w,p),u=CalculatePrice(new Decimal((U+1)*b),x,p),d=CalculatePrice(new Decimal((U+1)*M),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000019:c=CalculatePrice(new Decimal(24*U*T),w,p),u=CalculatePrice(new Decimal(24*U*b),x,p),d=CalculatePrice(new Decimal(24*U*M),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=Decimal.Add(Decimal.Add(c,u),d),n.setValue("GRAND_TOTAL",g);break;case 1000020:c=CalculatePrice(new Decimal(24*U*T),w,p),u=CalculatePrice(new Decimal(24*U*b),x,p),d=CalculatePrice(new Decimal(24*U*M),N,p),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;default:ShowMessage.Info("false",!0,"","")}else switch(int.Parse(O)){case 1000003:c=w,u=x,d=N,n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000004:p=CalculateRebate(new Decimal(T),w,P),c=CalculatePrice(new Decimal(T),w,p),v=CalculateRebate(new Decimal(b),x,P),u=CalculatePrice(new Decimal(b),x,v),_=CalculateRebate(new Decimal(M),N,P),d=CalculatePrice(new Decimal(M),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=Decimal.Add(Decimal.Add(c,u),d),n.setValue("GRAND_TOTAL",g);break;case 1000005:p=CalculateRebate(new Decimal(T),w,P),c=CalculatePrice(new Decimal(T),w,p),v=CalculateRebate(new Decimal(b),x,P),u=CalculatePrice(new Decimal(b),x,v),_=CalculateRebate(new Decimal(M),N,P),d=CalculatePrice(new Decimal(M),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000006:p=CalculateRebate(new Decimal(U),w,P),c=CalculatePrice(new Decimal(U),w,p),v=CalculateRebate(new Decimal(U),x,P),u=CalculatePrice(new Decimal(U),x,v),_=CalculateRebate(new Decimal(U),N,P),d=CalculatePrice(new Decimal(U),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000007:p=CalculateRebate(new Decimal(I),w,P),c=CalculatePrice(new Decimal(I),w,p),v=CalculateRebate(new Decimal(I),x,P),u=CalculatePrice(new Decimal(I),x,v),_=CalculateRebate(new Decimal(I),N,P),d=CalculatePrice(new Decimal(I),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000008:p=CalculateRebate(new Decimal(y),w,P),c=CalculatePrice(new Decimal(y),w,p),v=CalculateRebate(new Decimal(y),x,P),u=CalculatePrice(new Decimal(y),x,v),_=CalculateRebate(new Decimal(y),N,P),d=CalculatePrice(new Decimal(y),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000009:p=CalculateRebate(new Decimal(U+1),w,P),c=CalculatePrice(new Decimal(U+1),w,p),v=CalculateRebate(new Decimal(U+1),x,P),u=CalculatePrice(new Decimal(U+1),x,v),_=CalculateRebate(new Decimal(U+1),N,P),d=CalculatePrice(new Decimal(U+1),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000010:p=CalculateRebate(new Decimal(24*U),w,P),c=CalculatePrice(new Decimal(24*U),w,p),v=CalculateRebate(new Decimal(24*U),x,P),u=CalculatePrice(new Decimal(24*U),x,v),_=CalculateRebate(new Decimal(24*U),N,P),d=CalculatePrice(new Decimal(24*U),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000011:p=CalculateRebate(new Decimal(F),w,P),c=CalculatePrice(new Decimal(F),w,p),v=CalculateRebate(new Decimal(F),x,P),u=CalculatePrice(new Decimal(F),x,v),_=CalculateRebate(new Decimal(F),N,P),d=CalculatePrice(new Decimal(F),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000012:p=CalculateRebate(new Decimal(B),w,P),c=CalculatePrice(new Decimal(B),w,p),v=CalculateRebate(new Decimal(B),x,P),u=CalculatePrice(new Decimal(B),x,v),_=CalculateRebate(new Decimal(B),N,P),d=CalculatePrice(new Decimal(B),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000013:p=CalculateRebate(new Decimal(U*T),w,P),c=CalculatePrice(new Decimal(U*T),w,p),v=CalculateRebate(new Decimal(U*b),x,P),u=CalculatePrice(new Decimal(U*b),x,v),_=CalculateRebate(new Decimal(U*M),N,P),d=CalculatePrice(new Decimal(U*M),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=Decimal.Add(Decimal.Add(c,u),d),n.setValue("GRAND_TOTAL",g);break;case 1000014:p=CalculateRebate(new Decimal(U*T),w,P),c=CalculatePrice(new Decimal(U*T),w,p),v=CalculateRebate(new Decimal(U*b),x,P),u=CalculatePrice(new Decimal(U*b),x,v),_=CalculateRebate(new Decimal(U*M),N,P),d=CalculatePrice(new Decimal(U*M),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000015:p=CalculateRebate(new Decimal(T*y),w,P),c=CalculatePrice(new Decimal(T*y),w,p),v=CalculateRebate(new Decimal(b*y),x,P),u=CalculatePrice(new Decimal(b*y),x,v),_=CalculateRebate(new Decimal(M*y),N,P),d=CalculatePrice(new Decimal(M*y),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=Decimal.Add(Decimal.Add(c,u),d),n.setValue("GRAND_TOTAL",g);break;case 1000016:p=CalculateRebate(new Decimal(T*y),w,P),c=CalculatePrice(new Decimal(T*y),w,p),v=CalculateRebate(new Decimal(b*y),x,P),u=CalculatePrice(new Decimal(b*y),x,v),_=CalculateRebate(new Decimal(M*y),N,P),d=CalculatePrice(new Decimal(M*y),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000017:p=CalculateRebate(new Decimal(T*(U+1)),w,P),c=CalculatePrice(new Decimal(T*(U+1)),w,p),v=CalculateRebate(new Decimal(b*(U+1)),x,P),u=CalculatePrice(new Decimal(b*(U+1)),x,v),_=CalculateRebate(new Decimal(M*(U+1)),N,P),d=CalculatePrice(new Decimal(M*(U+1)),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=Decimal.Add(Decimal.Add(c,u),d),n.setValue("GRAND_TOTAL",g);break;case 1000018:p=CalculateRebate(new Decimal(T*(U+1)),w,P),c=CalculatePrice(new Decimal((U+1)*T),w,p),v=CalculateRebate(new Decimal(b*(U+1)),x,P),u=CalculatePrice(new Decimal(b*(U+1)),x,v),_=CalculateRebate(new Decimal(M*(U+1)),N,P),d=CalculatePrice(new Decimal(M*(U+1)),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;case 1000019:p=CalculateRebate(new Decimal(24*U*T),w,P),c=CalculatePrice(new Decimal(24*U*T),w,p),v=CalculateRebate(new Decimal(24*U*b),x,P),u=CalculatePrice(new Decimal(24*U*b),x,v),_=CalculateRebate(new Decimal(24*U*M),N,P),d=CalculatePrice(new Decimal(24*U*M),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=Decimal.Add(Decimal.Add(c,u),d),n.setValue("GRAND_TOTAL",g);break;case 1000020:p=CalculateRebate(new Decimal(24*U*T),w,P),c=CalculatePrice(new Decimal(24*U*T),w,p),v=CalculateRebate(new Decimal(24*U*b),x,P),u=CalculatePrice(new Decimal(24*U*b),x,v),_=CalculateRebate(new Decimal(24*U*M),N,P),d=CalculatePrice(new Decimal(24*U*M),N,_),n.setValue("ATOTAL_AMOUNT",c),n.setValue("CG1TOTAL_AMOUNT",u),n.setValue("CG2TOTAL_AMOUNT",d),g=c,n.setValue("GRAND_TOTAL",g);break;default:ShowMessage.Info("false",!0,"","")}return 0==T&&(n.setValue("ATOTAL_AMOUNT",0),n.setValue("GRAND_TOTAL",0)),0==b&&n.setValue("CG1TOTAL_AMOUNT",0),0==M&&n.setValue("CG2TOTAL_AMOUNT",0),n=s=null,""},a.prototype.tochkdate=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r,c,u,d,g,p,v,_=t.getValueOfDateTime(s);if(null==_||_.equals(0))return"";var V=t.getValueOfDateTime(s);V=t.getValueOfDateTime(n.getValue("ADATETO"));var A=t.getValueOfDateTime(n.getValue("ADATEFROM")),m=t.getValueOfInt(n.getValue("CG1NUM")),f=t.getValueOfInt(n.getValue("CG2NUM")),D=t.getValueOfDecimal(n.getValue("CG1PRICE")),h=t.getValueOfDecimal(n.getValue("CG2PRICE"));try{var C;if(V=t.getValueOfDateTime(n.getValue("ADATETO")),Utility.TimeUtil.getDaysBetween(A,V)<=0)C=Utility.TimeUtil.AddDays(A,1),n.setValue("ADATETO",C);else if(V.compareTo(A)>0){var S,I,y=V.Subtract(A),O=Utility.TimeUtil.getDaysBetween(A,V),T=(y.Milliseconds,y.Seconds),w=y.Minutes,P=O/30,b=O/7;S=0==O%30?P:P+1,I=0==O%7?b:b+1;var M=t.getValueOfDateTime(n.getValue("ADATEFROM"));n.setValue("CG1DATETO",V),n.setValue("CG2DATETO",V),n.setValue("CG1DATEFROM",M),n.setValue("CG2DATEFROM",M);var x=n.getValue("AUOM_ID").toString();""!=x&&0!=x.Trim().Length||(x="0");var N=t.getValueOfDecimal(n.getValue("APRICE")),L=System.Convert.ToInt16(n.getValue("ANUM")),R=t.getValueOfDecimal(n.getValue("AREBATE"));if(0==t.getValueOfInt(R))switch(d=e.Env.ZERO,int.Parse(x)){case 1000003:r=N,c=D,u=h,c=D,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:r=CalculatePrice(new Decimal(L),N,d),c=CalculatePrice(new Decimal(m),D,d),u=CalculatePrice(new Decimal(f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:r=CalculatePrice(new Decimal(L),N,d),c=CalculatePrice(new Decimal(m),D,d),u=CalculatePrice(new Decimal(f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:r=CalculatePrice(new Decimal(O),N,d),c=CalculatePrice(new Decimal(O),D,d),u=CalculatePrice(new Decimal(O),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:r=CalculatePrice(new Decimal(S),N,d),c=CalculatePrice(new Decimal(S),D,d),u=CalculatePrice(new Decimal(S),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:r=CalculatePrice(new Decimal(I),N,d),c=CalculatePrice(new Decimal(I),D,d),u=CalculatePrice(new Decimal(I),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:r=CalculatePrice(new Decimal(O+1),N,d),c=CalculatePrice(new Decimal(O+1),D,d),u=CalculatePrice(new Decimal(O+1),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:r=CalculatePrice(new Decimal(24*O),N,d),c=CalculatePrice(new Decimal(24*O),D,d),u=CalculatePrice(new Decimal(24*O),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:r=CalculatePrice(new Decimal(w),N,d),c=CalculatePrice(new Decimal(w),D,d),u=CalculatePrice(new Decimal(w),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:r=CalculatePrice(new Decimal(T),N,d),c=CalculatePrice(new Decimal(T),D,d),u=CalculatePrice(new Decimal(T),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:r=CalculatePrice(new Decimal(O*L),N,d),c=CalculatePrice(new Decimal(O*m),D,d),u=CalculatePrice(new Decimal(O*f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:r=CalculatePrice(new Decimal(O*L),N,d),c=CalculatePrice(new Decimal(O*m),D,d),u=CalculatePrice(new Decimal(O*f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:r=CalculatePrice(new Decimal(L*I),N,d),c=CalculatePrice(new Decimal(m*I),D,d),u=CalculatePrice(new Decimal(f*I),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:r=CalculatePrice(new Decimal(L*I),N,d),c=CalculatePrice(new Decimal(m*I),D,d),u=CalculatePrice(new Decimal(f*I),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:r=CalculatePrice(new Decimal(L*(O+1)),N,d),c=CalculatePrice(new Decimal(m*(O+1)),D,d),u=CalculatePrice(new Decimal(f*(O+1)),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:r=CalculatePrice(new Decimal((O+1)*L),N,d),c=CalculatePrice(new Decimal((O+1)*m),D,d),u=CalculatePrice(new Decimal((O+1)*f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:r=CalculatePrice(new Decimal(24*O*L),N,d),c=CalculatePrice(new Decimal(24*O*m),D,d),u=CalculatePrice(new Decimal(24*O*f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:r=CalculatePrice(new Decimal(24*O*L),N,d),c=CalculatePrice(new Decimal(24*O*m),D,d),u=CalculatePrice(new Decimal(24*O*f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}else switch(int.Parse(x)){case 1000003:r=N,c=D,u=h,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:d=CalculateRebate(new Decimal(L),N,R),r=CalculatePrice(new Decimal(L),N,d),g=CalculateRebate(new Decimal(m),D,R),c=CalculatePrice(new Decimal(m),D,g),p=CalculateRebate(new Decimal(f),h,R),u=CalculatePrice(new Decimal(f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:d=CalculateRebate(new Decimal(L),N,R),r=CalculatePrice(new Decimal(L),N,d),g=CalculateRebate(new Decimal(m),D,R),c=CalculatePrice(new Decimal(m),D,g),p=CalculateRebate(new Decimal(f),h,R),u=CalculatePrice(new Decimal(f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:d=CalculateRebate(new Decimal(O),N,R),r=CalculatePrice(new Decimal(O),N,d),g=CalculateRebate(new Decimal(O),D,R),c=CalculatePrice(new Decimal(O),D,g),p=CalculateRebate(new Decimal(O),h,R),u=CalculatePrice(new Decimal(O),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:d=CalculateRebate(new Decimal(S),N,R),r=CalculatePrice(new Decimal(S),N,d),g=CalculateRebate(new Decimal(S),D,R),c=CalculatePrice(new Decimal(S),D,g),p=CalculateRebate(new Decimal(S),h,R),u=CalculatePrice(new Decimal(S),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:d=CalculateRebate(new Decimal(I),N,R),r=CalculatePrice(new Decimal(I),N,d),g=CalculateRebate(new Decimal(I),D,R),c=CalculatePrice(new Decimal(I),D,g),p=CalculateRebate(new Decimal(I),h,R),u=CalculatePrice(new Decimal(I),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:d=CalculateRebate(new Decimal(O+1),N,R),r=CalculatePrice(new Decimal(O+1),N,d),g=CalculateRebate(new Decimal(O+1),D,R),c=CalculatePrice(new Decimal(O+1),D,g),p=CalculateRebate(new Decimal(O+1),h,R),u=CalculatePrice(new Decimal(O+1),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:d=CalculateRebate(new Decimal(24*O),N,R),r=CalculatePrice(new Decimal(24*O),N,d),g=CalculateRebate(new Decimal(24*O),D,R),c=CalculatePrice(new Decimal(24*O),D,g),p=CalculateRebate(new Decimal(24*O),h,R),u=CalculatePrice(new Decimal(24*O),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:d=CalculateRebate(new Decimal(w),N,R),r=CalculatePrice(new Decimal(w),N,d),g=CalculateRebate(new Decimal(w),D,R),c=CalculatePrice(new Decimal(w),D,g),p=CalculateRebate(new Decimal(w),h,R),u=CalculatePrice(new Decimal(w),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:d=CalculateRebate(new Decimal(T),N,R),r=CalculatePrice(new Decimal(T),N,d),g=CalculateRebate(new Decimal(T),D,R),c=CalculatePrice(new Decimal(T),D,g),p=CalculateRebate(new Decimal(T),h,R),u=CalculatePrice(new Decimal(T),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:d=CalculateRebate(new Decimal(O*L),N,R),r=CalculatePrice(new Decimal(O*L),N,d),g=CalculateRebate(new Decimal(O*m),D,R),c=CalculatePrice(new Decimal(O*m),D,g),p=CalculateRebate(new Decimal(O*f),h,R),u=CalculatePrice(new Decimal(O*f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:d=CalculateRebate(new Decimal(O*L),N,R),r=CalculatePrice(new Decimal(O*L),N,d),g=CalculateRebate(new Decimal(O*m),D,R),c=CalculatePrice(new Decimal(O*m),D,g),p=CalculateRebate(new Decimal(O*f),h,R),u=CalculatePrice(new Decimal(O*f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:d=CalculateRebate(new Decimal(L*I),N,R),r=CalculatePrice(new Decimal(L*I),N,d),g=CalculateRebate(new Decimal(m*I),D,R),c=CalculatePrice(new Decimal(m*I),D,g),p=CalculateRebate(new Decimal(f*I),h,R),u=CalculatePrice(new Decimal(f*I),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:d=CalculateRebate(new Decimal(L*I),N,R),r=CalculatePrice(new Decimal(L*I),N,d),g=CalculateRebate(new Decimal(m*I),D,R),c=CalculatePrice(new Decimal(m*I),D,g),p=CalculateRebate(new Decimal(f*I),h,R),u=CalculatePrice(new Decimal(f*I),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:d=CalculateRebate(new Decimal(L*(O+1)),N,R),r=CalculatePrice(new Decimal(L*(O+1)),N,d),g=CalculateRebate(new Decimal(m*(O+1)),D,R),c=CalculatePrice(new Decimal(m*(O+1)),D,g),p=CalculateRebate(new Decimal(f*(O+1)),h,R),u=CalculatePrice(new Decimal(f*(O+1)),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:d=CalculateRebate(new Decimal(L*(O+1)),N,R),r=CalculatePrice(new Decimal((O+1)*L),N,d),g=CalculateRebate(new Decimal(m*(O+1)),D,R),c=CalculatePrice(new Decimal(m*(O+1)),D,g),p=CalculateRebate(new Decimal(f*(O+1)),h,R),u=CalculatePrice(new Decimal(f*(O+1)),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:d=CalculateRebate(new Decimal(24*O*L),N,R),r=CalculatePrice(new Decimal(24*O*L),N,d),g=CalculateRebate(new Decimal(24*O*m),D,R),c=CalculatePrice(new Decimal(24*O*m),D,g),p=CalculateRebate(new Decimal(24*O*f),h,R),u=CalculatePrice(new Decimal(24*O*f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:d=CalculateRebate(new Decimal(24*O*L),N,R),r=CalculatePrice(new Decimal(24*O*L),N,d),g=CalculateRebate(new Decimal(24*O*m),D,R),c=CalculatePrice(new Decimal(24*O*m),D,g),p=CalculateRebate(new Decimal(24*O*f),h,R),u=CalculatePrice(new Decimal(24*O*f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}0==L&&(n.setValue("ATOTAL_AMOUNT",0),n.setValue("GRAND_TOTAL",0)),0==m&&n.setValue("CG1TOTAL_AMOUNT",0),0==f&&n.setValue("CG2TOTAL_AMOUNT",0)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return n=s=null,""},a.prototype.fromchkdate=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r,c,u,d,g,p,v,_=t.getValueOfDateTime(s);if(null==_||_.equals(0))return"";var V=t.getValueOfDateTime(n.getValue("ADATEFROM")),A=t.getValueOfDateTime(n.getValue("ADATETO")),m=t.getValueOfInt(n.getValue("CG1NUM")),f=t.getValueOfInt(n.getValue("CG2NUM")),D=t.getValueOfDecimal(n.getValue("CG1PRICE")),h=t.getValueOfDecimal(n.getValue("CG2PRICE"));try{var C;if((V=t.getValueOfDateTime(n.getValue("ADATEFROM"))).compareTo(A)>0)n.setValue("CG1DATEFROM",V),n.setValue("CG2DATEFROM",V),C=V.addDays(1),n.setValue("ADATETO",C);else if(A.compareTo(V)>0){var S,I,y=V.subtract(A),O=Utility.TimeUtil.getDaysBetween(V,A),T=(y.Milliseconds,y.Seconds),w=y.Minutes,P=O/30,b=O/7;S=0==O%30?P:P+1,I=0==O%7?b:b+1;var M=t.getValueOfDateTime(n.getValue("ADATEFROM"));n.setValue("CG1DATETO",A),n.setValue("CG2DATETO",A),n.setValue("CG1DATEFROM",M),n.setValue("CG2DATEFROM",M);var x=n.getValue("AUOM_ID").toString();""!=x&&0!=x.Trim().Length||(x="0");var N=t.getValueOfDecimal(n.getValue("APRICE")),L=t.getValueOfInt(n.getValue("ANUM")),R=t.getValueOfDecimal(n.getValue("AREBATE"));if(0==t.getValueOfInt(R))switch(d=e.Env.ZERO,int.Parse(x)){case 1000003:r=N,c=D,u=h,c=D,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:r=CalculatePrice(new Decimal(L),N,d),c=CalculatePrice(new Decimal(m),D,d),u=CalculatePrice(new Decimal(f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:r=CalculatePrice(new Decimal(L),N,d),c=CalculatePrice(new Decimal(m),D,d),u=CalculatePrice(new Decimal(f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:r=CalculatePrice(new Decimal(O),N,d),c=CalculatePrice(new Decimal(O),D,d),u=CalculatePrice(new Decimal(O),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:r=CalculatePrice(new Decimal(S),N,d),c=CalculatePrice(new Decimal(S),D,d),u=CalculatePrice(new Decimal(S),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:r=CalculatePrice(new Decimal(I),N,d),c=CalculatePrice(new Decimal(I),D,d),u=CalculatePrice(new Decimal(I),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:r=CalculatePrice(new Decimal(O+1),N,d),c=CalculatePrice(new Decimal(O+1),D,d),u=CalculatePrice(new Decimal(O+1),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:r=CalculatePrice(new Decimal(24*O),N,d),c=CalculatePrice(new Decimal(24*O),D,d),u=CalculatePrice(new Decimal(24*O),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:r=CalculatePrice(new Decimal(w),N,d),c=CalculatePrice(new Decimal(w),D,d),u=CalculatePrice(new Decimal(w),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:r=CalculatePrice(new Decimal(T),N,d),c=CalculatePrice(new Decimal(T),D,d),u=CalculatePrice(new Decimal(T),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:r=CalculatePrice(new Decimal(O*L),N,d),c=CalculatePrice(new Decimal(O*m),D,d),u=CalculatePrice(new Decimal(O*f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:r=CalculatePrice(new Decimal(O*L),N,d),c=CalculatePrice(new Decimal(O*m),D,d),u=CalculatePrice(new Decimal(O*f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:r=CalculatePrice(new Decimal(L*I),N,d),c=CalculatePrice(new Decimal(m*I),D,d),u=CalculatePrice(new Decimal(f*I),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:r=CalculatePrice(new Decimal(L*I),N,d),c=CalculatePrice(new Decimal(m*I),D,d),u=CalculatePrice(new Decimal(f*I),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:r=CalculatePrice(new Decimal(L*(O+1)),N,d),c=CalculatePrice(new Decimal(m*(O+1)),D,d),u=CalculatePrice(new Decimal(f*(O+1)),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:r=CalculatePrice(new Decimal((O+1)*L),N,d),c=CalculatePrice(new Decimal((O+1)*m),D,d),u=CalculatePrice(new Decimal((O+1)*f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:r=CalculatePrice(new Decimal(24*O*L),N,d),c=CalculatePrice(new Decimal(24*O*m),D,d),u=CalculatePrice(new Decimal(24*O*f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:r=CalculatePrice(new Decimal(24*O*L),N,d),c=CalculatePrice(new Decimal(24*O*m),D,d),u=CalculatePrice(new Decimal(24*O*f),h,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}else switch(int.Parse(x)){case 1000003:r=N,c=D,u=h,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:d=CalculateRebate(new Decimal(L),N,R),r=CalculatePrice(new Decimal(L),N,d),g=CalculateRebate(new Decimal(m),D,R),c=CalculatePrice(new Decimal(m),D,g),p=CalculateRebate(new Decimal(f),h,R),u=CalculatePrice(new Decimal(f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:d=CalculateRebate(new Decimal(L),N,R),r=CalculatePrice(new Decimal(L),N,d),g=CalculateRebate(new Decimal(m),D,R),c=CalculatePrice(new Decimal(m),D,g),p=CalculateRebate(new Decimal(f),h,R),u=CalculatePrice(new Decimal(f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:d=CalculateRebate(new Decimal(O),N,R),r=CalculatePrice(new Decimal(O),N,d),g=CalculateRebate(new Decimal(O),D,R),c=CalculatePrice(new Decimal(O),D,g),p=CalculateRebate(new Decimal(O),h,R),u=CalculatePrice(new Decimal(O),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:d=CalculateRebate(new Decimal(S),N,R),r=CalculatePrice(new Decimal(S),N,d),g=CalculateRebate(new Decimal(S),D,R),c=CalculatePrice(new Decimal(S),D,g),p=CalculateRebate(new Decimal(S),h,R),u=CalculatePrice(new Decimal(S),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:d=CalculateRebate(new Decimal(I),N,R),r=CalculatePrice(new Decimal(I),N,d),g=CalculateRebate(new Decimal(I),D,R),c=CalculatePrice(new Decimal(I),D,g),p=CalculateRebate(new Decimal(I),h,R),u=CalculatePrice(new Decimal(I),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:d=CalculateRebate(new Decimal(O+1),N,R),r=CalculatePrice(new Decimal(O+1),N,d),g=CalculateRebate(new Decimal(O+1),D,R),c=CalculatePrice(new Decimal(O+1),D,g),p=CalculateRebate(new Decimal(O+1),h,R),u=CalculatePrice(new Decimal(O+1),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:d=CalculateRebate(new Decimal(24*O),N,R),r=CalculatePrice(new Decimal(24*O),N,d),g=CalculateRebate(new Decimal(24*O),D,R),c=CalculatePrice(new Decimal(24*O),D,g),p=CalculateRebate(new Decimal(24*O),h,R),u=CalculatePrice(new Decimal(24*O),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:d=CalculateRebate(new Decimal(w),N,R),r=CalculatePrice(new Decimal(w),N,d),g=CalculateRebate(new Decimal(w),D,R),c=CalculatePrice(new Decimal(w),D,g),p=CalculateRebate(new Decimal(w),h,R),u=CalculatePrice(new Decimal(w),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:d=CalculateRebate(new Decimal(T),N,R),r=CalculatePrice(new Decimal(T),N,d),g=CalculateRebate(new Decimal(T),D,R),c=CalculatePrice(new Decimal(T),D,g),p=CalculateRebate(new Decimal(T),h,R),u=CalculatePrice(new Decimal(T),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:d=CalculateRebate(new Decimal(O*L),N,R),r=CalculatePrice(new Decimal(O*L),N,d),g=CalculateRebate(new Decimal(O*m),D,R),c=CalculatePrice(new Decimal(O*m),D,g),p=CalculateRebate(new Decimal(O*f),h,R),u=CalculatePrice(new Decimal(O*f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:d=CalculateRebate(new Decimal(O*L),N,R),r=CalculatePrice(new Decimal(O*L),N,d),g=CalculateRebate(new Decimal(O*m),D,R),c=CalculatePrice(new Decimal(O*m),D,g),p=CalculateRebate(new Decimal(O*f),h,R),u=CalculatePrice(new Decimal(O*f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:d=CalculateRebate(new Decimal(L*I),N,R),r=CalculatePrice(new Decimal(L*I),N,d),g=CalculateRebate(new Decimal(m*I),D,R),c=CalculatePrice(new Decimal(m*I),D,g),p=CalculateRebate(new Decimal(f*I),h,R),u=CalculatePrice(new Decimal(f*I),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:d=CalculateRebate(new Decimal(L*I),N,R),r=CalculatePrice(new Decimal(L*I),N,d),g=CalculateRebate(new Decimal(m*I),D,R),c=CalculatePrice(new Decimal(m*I),D,g),p=CalculateRebate(new Decimal(f*I),h,R),u=CalculatePrice(new Decimal(f*I),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:d=CalculateRebate(new Decimal(L*(O+1)),N,R),r=CalculatePrice(new Decimal(L*(O+1)),N,d),g=CalculateRebate(new Decimal(m*(O+1)),D,R),c=CalculatePrice(new Decimal(m*(O+1)),D,g),p=CalculateRebate(new Decimal(f*(O+1)),h,R),u=CalculatePrice(new Decimal(f*(O+1)),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:d=CalculateRebate(new Decimal(L*(O+1)),N,R),r=CalculatePrice(new Decimal((O+1)*L),N,d),g=CalculateRebate(new Decimal(m*(O+1)),D,R),c=CalculatePrice(new Decimal(m*(O+1)),D,g),p=CalculateRebate(new Decimal(f*(O+1)),h,R),u=CalculatePrice(new Decimal(f*(O+1)),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:d=CalculateRebate(new Decimal(24*O*L),N,R),r=CalculatePrice(new Decimal(24*O*L),N,d),g=CalculateRebate(new Decimal(24*O*m),D,R),c=CalculatePrice(new Decimal(24*O*m),D,g),p=CalculateRebate(new Decimal(24*O*f),h,R),u=CalculatePrice(new Decimal(24*O*f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:d=CalculateRebate(new Decimal(24*O*L),N,R),r=CalculatePrice(new Decimal(24*O*L),N,d),g=CalculateRebate(new Decimal(24*O*m),D,R),c=CalculatePrice(new Decimal(24*O*m),D,g),p=CalculateRebate(new Decimal(24*O*f),h,R),u=CalculatePrice(new Decimal(24*O*f),h,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}0==L&&(n.setValue("ATOTAL_AMOUNT",0),n.setValue("GRAND_TOTAL",0)),0==m&&n.setValue("CG1TOTAL_AMOUNT",0),0==f&&n.setValue("CG2TOTAL_AMOUNT",0)}}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return n=s=null,""},a.prototype.UOMSelected=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r,c,u,d,g,p,v,_=t.getValueOfInt(s);if(null==(_=t.getValueOfInt(n.getValue("AUOM_ID"))))return"";n.setValue("CG1UOM_ID",_),n.setValue("CG2UOM_ID",_);var V,A=n.getValue("AUOM_ID").toString(),m=t.getValueOfDecimal(n.getValue("APRICE")),f=t.getValueOfInt(n.getValue("ANUM")),D=t.getValueOfDecimal(n.getValue("AREBATE")),h=t.getValueOfInt(n.getValue("CG1NUM")),C=t.getValueOfInt(n.getValue("CG2NUM")),S=t.getValueOfDecimal(n.getValue("CG1PRICE")),I=t.getValueOfDecimal(n.getValue("CG2PRICE")),y=t.getValueOfDateTime(n.getValue("ADATETO")),O=t.getValueOfDateTime(n.getValue("ADATEFROM"));V=O.compareTo(y)>0?O.Subtract(y):y.Subtract(O);var T,w,P=Utility.timeUtil.getDaysBetween(O,y),b=(V.Milliseconds,V.Seconds),M=V.Minutes,x=P/30,N=P/7;if(T=0==P%30?x:x+1,w=0==P%7?N:N+1,0==t.getValueOfInt(D))switch(d=e.Env.ZERO,int.Parse(A)){case 1000003:r=m,c=S,u=I,c=S,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:r=CalculatePrice(new Decimal(f),m,d),c=CalculatePrice(new Decimal(h),S,d),u=CalculatePrice(new Decimal(C),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:r=CalculatePrice(new Decimal(f),m,d),c=CalculatePrice(new Decimal(h),S,d),u=CalculatePrice(new Decimal(C),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:r=CalculatePrice(new Decimal(P),m,d),c=CalculatePrice(new Decimal(P),S,d),u=CalculatePrice(new Decimal(P),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:r=CalculatePrice(new Decimal(T),m,d),c=CalculatePrice(new Decimal(T),S,d),u=CalculatePrice(new Decimal(T),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:r=CalculatePrice(new Decimal(w),m,d),c=CalculatePrice(new Decimal(w),S,d),u=CalculatePrice(new Decimal(w),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:r=CalculatePrice(new Decimal(P+1),m,d),c=CalculatePrice(new Decimal(P+1),S,d),u=CalculatePrice(new Decimal(P+1),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:r=CalculatePrice(new Decimal(24*P),m,d),c=CalculatePrice(new Decimal(24*P),S,d),u=CalculatePrice(new Decimal(24*P),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:r=CalculatePrice(new Decimal(M),m,d),c=CalculatePrice(new Decimal(M),S,d),u=CalculatePrice(new Decimal(M),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:r=CalculatePrice(new Decimal(b),m,d),c=CalculatePrice(new Decimal(b),S,d),u=CalculatePrice(new Decimal(b),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:r=CalculatePrice(new Decimal(P*f),m,d),c=CalculatePrice(new Decimal(P*h),S,d),u=CalculatePrice(new Decimal(P*C),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:r=CalculatePrice(new Decimal(P*f),m,d),c=CalculatePrice(new Decimal(P*h),S,d),u=CalculatePrice(new Decimal(P*C),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:r=CalculatePrice(new Decimal(f*w),m,d),c=CalculatePrice(new Decimal(h*w),S,d),u=CalculatePrice(new Decimal(C*w),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:r=CalculatePrice(new Decimal(f*w),m,d),c=CalculatePrice(new Decimal(h*w),S,d),u=CalculatePrice(new Decimal(C*w),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:r=CalculatePrice(new Decimal(f*(P+1)),m,d),c=CalculatePrice(new Decimal(h*(P+1)),S,d),u=CalculatePrice(new Decimal(C*(P+1)),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:r=CalculatePrice(new Decimal((P+1)*f),m,d),c=CalculatePrice(new Decimal((P+1)*h),S,d),u=CalculatePrice(new Decimal((P+1)*C),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:r=CalculatePrice(new Decimal(24*P*f),m,d),c=CalculatePrice(new Decimal(24*P*h),S,d),u=CalculatePrice(new Decimal(24*P*C),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:r=CalculatePrice(new Decimal(24*P*f),m,d),c=CalculatePrice(new Decimal(24*P*h),S,d),u=CalculatePrice(new Decimal(24*P*C),I,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}else switch(int.Parse(A)){case 1000003:r=m,c=S,u=I,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:d=CalculateRebate(new Decimal(f),m,D),r=CalculatePrice(new Decimal(f),m,d),g=CalculateRebate(new Decimal(h),S,D),c=CalculatePrice(new Decimal(h),S,g),p=CalculateRebate(new Decimal(C),I,D),u=CalculatePrice(new Decimal(C),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:d=CalculateRebate(new Decimal(f),m,D),r=CalculatePrice(new Decimal(f),m,d),g=CalculateRebate(new Decimal(h),S,D),c=CalculatePrice(new Decimal(h),S,g),p=CalculateRebate(new Decimal(C),I,D),u=CalculatePrice(new Decimal(C),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:d=CalculateRebate(new Decimal(P),m,D),r=CalculatePrice(new Decimal(P),m,d),g=CalculateRebate(new Decimal(P),S,D),c=CalculatePrice(new Decimal(P),S,g),p=CalculateRebate(new Decimal(P),I,D),u=CalculatePrice(new Decimal(P),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:d=CalculateRebate(new Decimal(T),m,D),r=CalculatePrice(new Decimal(T),m,d),g=CalculateRebate(new Decimal(T),S,D),c=CalculatePrice(new Decimal(T),S,g),p=CalculateRebate(new Decimal(T),I,D),u=CalculatePrice(new Decimal(T),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:d=CalculateRebate(new Decimal(w),m,D),r=CalculatePrice(new Decimal(w),m,d),g=CalculateRebate(new Decimal(w),S,D),c=CalculatePrice(new Decimal(w),S,g),p=CalculateRebate(new Decimal(w),I,D),u=CalculatePrice(new Decimal(w),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:d=CalculateRebate(new Decimal(P+1),m,D),r=CalculatePrice(new Decimal(P+1),m,d),g=CalculateRebate(new Decimal(P+1),S,D),c=CalculatePrice(new Decimal(P+1),S,g),p=CalculateRebate(new Decimal(P+1),I,D),u=CalculatePrice(new Decimal(P+1),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:d=CalculateRebate(new Decimal(24*P),m,D),r=CalculatePrice(new Decimal(24*P),m,d),g=CalculateRebate(new Decimal(24*P),S,D),c=CalculatePrice(new Decimal(24*P),S,g),p=CalculateRebate(new Decimal(24*P),I,D),u=CalculatePrice(new Decimal(24*P),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:d=CalculateRebate(new Decimal(M),m,D),r=CalculatePrice(new Decimal(M),m,d),g=CalculateRebate(new Decimal(M),S,D),c=CalculatePrice(new Decimal(M),S,g),p=CalculateRebate(new Decimal(M),I,D),u=CalculatePrice(new Decimal(M),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:d=CalculateRebate(new Decimal(b),m,D),r=CalculatePrice(new Decimal(b),m,d),g=CalculateRebate(new Decimal(b),S,D),c=CalculatePrice(new Decimal(b),S,g),p=CalculateRebate(new Decimal(b),I,D),u=CalculatePrice(new Decimal(b),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:d=CalculateRebate(new Decimal(P*f),m,D),r=CalculatePrice(new Decimal(P*f),m,d),g=CalculateRebate(new Decimal(P*h),S,D),c=CalculatePrice(new Decimal(P*h),S,g),p=CalculateRebate(new Decimal(P*C),I,D),u=CalculatePrice(new Decimal(P*C),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:d=CalculateRebate(new Decimal(P*f),m,D),r=CalculatePrice(new Decimal(P*f),m,d),g=CalculateRebate(new Decimal(P*h),S,D),c=CalculatePrice(new Decimal(P*h),S,g),p=CalculateRebate(new Decimal(P*C),I,D),u=CalculatePrice(new Decimal(P*C),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:d=CalculateRebate(new Decimal(f*w),m,D),r=CalculatePrice(new Decimal(f*w),m,d),g=CalculateRebate(new Decimal(h*w),S,D),c=CalculatePrice(new Decimal(h*w),S,g),p=CalculateRebate(new Decimal(C*w),I,D),u=CalculatePrice(new Decimal(C*w),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:d=CalculateRebate(new Decimal(f*w),m,D),r=CalculatePrice(new Decimal(f*w),m,d),g=CalculateRebate(new Decimal(h*w),S,D),c=CalculatePrice(new Decimal(h*w),S,g),p=CalculateRebate(new Decimal(C*w),I,D),u=CalculatePrice(new Decimal(C*w),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:d=CalculateRebate(new Decimal(f*(P+1)),m,D),r=CalculatePrice(new Decimal(f*(P+1)),m,d),g=CalculateRebate(new Decimal(h*(P+1)),S,D),c=CalculatePrice(new Decimal(h*(P+1)),S,g),p=CalculateRebate(new Decimal(C*(P+1)),I,D),u=CalculatePrice(new Decimal(C*(P+1)),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:d=CalculateRebate(new Decimal(f*(P+1)),m,D),r=CalculatePrice(new Decimal((P+1)*f),m,d),g=CalculateRebate(new Decimal(h*(P+1)),S,D),c=CalculatePrice(new Decimal(h*(P+1)),S,g),p=CalculateRebate(new Decimal(C*(P+1)),I,D),u=CalculatePrice(new Decimal(C*(P+1)),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:d=CalculateRebate(new Decimal(24*P*f),m,D),r=CalculatePrice(new Decimal(24*P*f),m,d),g=CalculateRebate(new Decimal(24*P*h),S,D),c=CalculatePrice(new Decimal(24*P*h),S,g),p=CalculateRebate(new Decimal(24*P*C),I,D),u=CalculatePrice(new Decimal(24*P*C),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:d=CalculateRebate(new Decimal(24*P*f),m,D),r=CalculatePrice(new Decimal(24*P*f),m,d),g=CalculateRebate(new Decimal(24*P*h),S,D),c=CalculatePrice(new Decimal(24*P*h),S,g),p=CalculateRebate(new Decimal(24*P*C),I,D),u=CalculatePrice(new Decimal(24*P*C),I,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}return 0==f&&(n.setValue("ATOTAL_AMOUNT",0),n.setValue("GRAND_TOTAL",0)),0==h&&n.setValue("CG1TOTAL_AMOUNT",0),0==C&&n.setValue("CG2TOTAL_AMOUNT",0),n=s=null,""},a.prototype.AVALSelected=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";var r,c,u,d,g,p,v,_=null;try{_=n.getValue("AUOM_ID").toString()}catch(e){return this.setCalloutActive(!1),""}var V,A,m=t.getValueOfDecimal(n.getValue("APRICE")),f=t.getValueOfDecimal(n.getValue("AREBATE")),D=t.getValueOfInt(n.getValue("ANUM")),h=t.getValueOfDateTime(n.getValue("ADATETO")),C=t.getValueOfInt(n.getValue("CG1NUM")),S=t.getValueOfInt(n.getValue("CG2NUM")),I=t.getValueOfDecimal(n.getValue("CG1PRICE")),y=t.getValueOfDecimal(n.getValue("CG2PRICE")),O=t.getValueOfDateTime(n.getValue("ADATEFROM")),T=O.Subtract(h),w=Utility.TimeUtil.getDaysBetween(O,h),P=(T.Milliseconds,T.Seconds),b=T.Minutes,M=w/30,x=w/7;if(V=0==w%30?M:M+1,A=0==w%7?x:x+1,0==t.getValueOfInt(f))switch(d=e.Env.ZERO,int.Parse(_)){case 1000003:r=m,c=I,u=y,c=I,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:r=CalculatePrice(new Decimal(D),m,d),c=CalculatePrice(new Decimal(C),I,d),u=CalculatePrice(new Decimal(S),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:r=CalculatePrice(new Decimal(D),m,d),c=CalculatePrice(new Decimal(C),I,d),u=CalculatePrice(new Decimal(S),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:r=CalculatePrice(new Decimal(w),m,d),c=CalculatePrice(new Decimal(w),I,d),u=CalculatePrice(new Decimal(w),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:r=CalculatePrice(new Decimal(V),m,d),c=CalculatePrice(new Decimal(V),I,d),u=CalculatePrice(new Decimal(V),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:r=CalculatePrice(new Decimal(A),m,d),c=CalculatePrice(new Decimal(A),I,d),u=CalculatePrice(new Decimal(A),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:r=CalculatePrice(new Decimal(w+1),m,d),c=CalculatePrice(new Decimal(w+1),I,d),u=CalculatePrice(new Decimal(w+1),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:r=CalculatePrice(new Decimal(24*w),m,d),c=CalculatePrice(new Decimal(24*w),I,d),u=CalculatePrice(new Decimal(24*w),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:r=CalculatePrice(new Decimal(b),m,d),c=CalculatePrice(new Decimal(b),I,d),u=CalculatePrice(new Decimal(b),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:r=CalculatePrice(new Decimal(P),m,d),c=CalculatePrice(new Decimal(P),I,d),u=CalculatePrice(new Decimal(P),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:r=CalculatePrice(new Decimal(w*D),m,d),c=CalculatePrice(new Decimal(w*C),I,d),u=CalculatePrice(new Decimal(w*S),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:r=CalculatePrice(new Decimal(w*D),m,d),c=CalculatePrice(new Decimal(w*C),I,d),u=CalculatePrice(new Decimal(w*S),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:r=CalculatePrice(new Decimal(D*A),m,d),c=CalculatePrice(new Decimal(C*A),I,d),u=CalculatePrice(new Decimal(S*A),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:r=CalculatePrice(new Decimal(D*A),m,d),c=CalculatePrice(new Decimal(C*A),I,d),u=CalculatePrice(new Decimal(S*A),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:r=CalculatePrice(new Decimal(D*(w+1)),m,d),c=CalculatePrice(new Decimal(C*(w+1)),I,d),u=CalculatePrice(new Decimal(S*(w+1)),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:r=CalculatePrice(new Decimal((w+1)*D),m,d),c=CalculatePrice(new Decimal((w+1)*C),I,d),u=CalculatePrice(new Decimal((w+1)*S),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:r=CalculatePrice(new Decimal(24*w*D),m,d),c=CalculatePrice(new Decimal(24*w*C),I,d),u=CalculatePrice(new Decimal(24*w*S),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:r=CalculatePrice(new Decimal(24*w*D),m,d),c=CalculatePrice(new Decimal(24*w*C),I,d),u=CalculatePrice(new Decimal(24*w*S),y,d),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}else switch(int.Parse(_)){case 1000003:r=m,c=I,u=y,n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000004:d=CalculateRebate(new Decimal(D),m,f),r=CalculatePrice(new Decimal(D),m,d),g=CalculateRebate(new Decimal(C),I,f),c=CalculatePrice(new Decimal(C),I,g),p=CalculateRebate(new Decimal(S),y,f),u=CalculatePrice(new Decimal(S),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000005:d=CalculateRebate(new Decimal(D),m,f),r=CalculatePrice(new Decimal(D),m,d),g=CalculateRebate(new Decimal(C),I,f),c=CalculatePrice(new Decimal(C),I,g),p=CalculateRebate(new Decimal(S),y,f),u=CalculatePrice(new Decimal(S),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000006:d=CalculateRebate(new Decimal(w),m,f),r=CalculatePrice(new Decimal(w),m,d),g=CalculateRebate(new Decimal(w),I,f),c=CalculatePrice(new Decimal(w),I,g),p=CalculateRebate(new Decimal(w),y,f),u=CalculatePrice(new Decimal(w),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000007:d=CalculateRebate(new Decimal(V),m,f),r=CalculatePrice(new Decimal(V),m,d),g=CalculateRebate(new Decimal(V),I,f),c=CalculatePrice(new Decimal(V),I,g),p=CalculateRebate(new Decimal(V),y,f),u=CalculatePrice(new Decimal(V),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000008:d=CalculateRebate(new Decimal(A),m,f),r=CalculatePrice(new Decimal(A),m,d),g=CalculateRebate(new Decimal(A),I,f),c=CalculatePrice(new Decimal(A),I,g),p=CalculateRebate(new Decimal(A),y,f),u=CalculatePrice(new Decimal(A),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000009:d=CalculateRebate(new Decimal(w+1),m,f),r=CalculatePrice(new Decimal(w+1),m,d),g=CalculateRebate(new Decimal(w+1),I,f),c=CalculatePrice(new Decimal(w+1),I,g),p=CalculateRebate(new Decimal(w+1),y,f),u=CalculatePrice(new Decimal(w+1),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000010:d=CalculateRebate(new Decimal(24*w),m,f),r=CalculatePrice(new Decimal(24*w),m,d),g=CalculateRebate(new Decimal(24*w),I,f),c=CalculatePrice(new Decimal(24*w),I,g),p=CalculateRebate(new Decimal(24*w),y,f),u=CalculatePrice(new Decimal(24*w),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000011:d=CalculateRebate(new Decimal(b),m,f),r=CalculatePrice(new Decimal(b),m,d),g=CalculateRebate(new Decimal(b),I,f),c=CalculatePrice(new Decimal(b),I,g),p=CalculateRebate(new Decimal(b),y,f),u=CalculatePrice(new Decimal(b),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000012:d=CalculateRebate(new Decimal(P),m,f),r=CalculatePrice(new Decimal(P),m,d),g=CalculateRebate(new Decimal(P),I,f),c=CalculatePrice(new Decimal(P),I,g),p=CalculateRebate(new Decimal(P),y,f),u=CalculatePrice(new Decimal(P),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000013:d=CalculateRebate(new Decimal(w*D),m,f),r=CalculatePrice(new Decimal(w*D),m,d),g=CalculateRebate(new Decimal(w*C),I,f),c=CalculatePrice(new Decimal(w*C),I,g),p=CalculateRebate(new Decimal(w*S),y,f),u=CalculatePrice(new Decimal(w*S),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000014:d=CalculateRebate(new Decimal(w*D),m,f),r=CalculatePrice(new Decimal(w*D),m,d),g=CalculateRebate(new Decimal(w*C),I,f),c=CalculatePrice(new Decimal(w*C),I,g),p=CalculateRebate(new Decimal(w*S),y,f),u=CalculatePrice(new Decimal(w*S),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000015:d=CalculateRebate(new Decimal(D*A),m,f),r=CalculatePrice(new Decimal(D*A),m,d),g=CalculateRebate(new Decimal(C*A),I,f),c=CalculatePrice(new Decimal(C*A),I,g),p=CalculateRebate(new Decimal(S*A),y,f),u=CalculatePrice(new Decimal(S*A),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000016:d=CalculateRebate(new Decimal(D*A),m,f),r=CalculatePrice(new Decimal(D*A),m,d),g=CalculateRebate(new Decimal(C*A),I,f),c=CalculatePrice(new Decimal(C*A),I,g),p=CalculateRebate(new Decimal(S*A),y,f),u=CalculatePrice(new Decimal(S*A),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000017:d=CalculateRebate(new Decimal(D*(w+1)),m,f),r=CalculatePrice(new Decimal(D*(w+1)),m,d),g=CalculateRebate(new Decimal(C*(w+1)),I,f),c=CalculatePrice(new Decimal(C*(w+1)),I,g),p=CalculateRebate(new Decimal(S*(w+1)),y,f),u=CalculatePrice(new Decimal(S*(w+1)),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000018:d=CalculateRebate(new Decimal(D*(w+1)),m,f),r=CalculatePrice(new Decimal((w+1)*D),m,d),g=CalculateRebate(new Decimal(C*(w+1)),I,f),c=CalculatePrice(new Decimal(C*(w+1)),I,g),p=CalculateRebate(new Decimal(S*(w+1)),y,f),u=CalculatePrice(new Decimal(S*(w+1)),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;case 1000019:d=CalculateRebate(new Decimal(24*w*D),m,f),r=CalculatePrice(new Decimal(24*w*D),m,d),g=CalculateRebate(new Decimal(24*w*C),I,f),c=CalculatePrice(new Decimal(24*w*C),I,g),p=CalculateRebate(new Decimal(24*w*S),y,f),u=CalculatePrice(new Decimal(24*w*S),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=Decimal.Add(Decimal.Add(r,c),u),n.setValue("GRAND_TOTAL",v);break;case 1000020:d=CalculateRebate(new Decimal(24*w*D),m,f),r=CalculatePrice(new Decimal(24*w*D),m,d),g=CalculateRebate(new Decimal(24*w*C),I,f),c=CalculatePrice(new Decimal(24*w*C),I,g),p=CalculateRebate(new Decimal(24*w*S),y,f),u=CalculatePrice(new Decimal(24*w*S),y,p),n.setValue("ATOTAL_AMOUNT",r),n.setValue("CG1TOTAL_AMOUNT",c),n.setValue("CG2TOTAL_AMOUNT",u),v=r,n.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}return 0==D&&(n.setValue("ATOTAL_AMOUNT",0),n.setValue("GRAND_TOTAL",0)),0==C&&n.setValue("CG1TOTAL_AMOUNT",0),0==S&&n.setValue("CG2TOTAL_AMOUNT",0),n=s=null,""},e.Model.CalloutOfferServices=a}(VIS,jQuery)},8489:()=>{!function(e){e.Logging.Level;var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"VIS.CalloutRequisition")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.Product=function(a,i,n,l,s,o){try{if(this.isCalloutActive()||null==s||""==s.toString())return"";var r=s;if(null==r||0==r)return"";this.setCalloutActive(!0),n.setValue("M_AttributeSetInstance_ID",null);var c=a.getContextAsInt(i,"C_BPartner_ID");n.setValue("Qty",n.getValue("QtyEntered"));var u,d,g=n.getValue("Qty"),p=!1,v=a.getContextAsInt(i,"M_PriceList_ID"),_=a.getContextAsInt(i,"M_PriceList_Version_ID"),V=a.getContext(i,"DateDoc"),A=c.toString()+","+r.toString(),m=e.dataContext.getJSONRecord("MProduct/GetProductUOMs",A);m&&(d=0==m.PurchaseUOM?0==m.VAS_PurchaseUOM_ID?m.C_UOM_ID:m.VAS_PurchaseUOM_ID:m.PurchaseUOM),u=r.toString().concat(",",c,",",g,",",p,",",v,",",_,",",V,",",null,",",d,",",1);var f;f=e.dataContext.getJSONRecord("MProductPricing/GetProductPricing",u),n.setValue("PriceActual",f.PriceActual),n.setValue("PrintDescription",t.getValueOfString(f.DocumentNote)),a.setContext(i,"EnforcePriceLimit",f.EnforcePriceLimit?"Y":"N"),a.setContext(i,"DiscountSchema",f.DiscountSchema?"Y":"N"),n.setValue("C_UOM_ID",d);var D=n.getValue("M_Requisition_ID").toString()+","+a.getAD_Client_ID().toString()+","+s.toString(),h=e.dataContext.getJSONRecord("MOrderLine/GetReqOrderLine",D);h>0&&n.setValue("C_OrderLine_ID",h)}catch(e){return this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),a=i=n=s=null,""},a.prototype.Charge=function(a,i,n,l,s,o){try{if(this.isCalloutActive()||null==s||""==s.toString())return"";this.setCalloutActive(!0);var r=t.getValueOfInt(s);if(null==r||0==r)return this.setCalloutActive(!1),"";null!=n.getValue("M_Product_ID")&&n.setValue("M_Product_ID",null),n.setValue("M_AttributeSetInstance_ID",null);var c=a.getContextAsInt("#C_UOM_ID");c>0?n.setValue("C_UOM_ID",c):n.setValue("C_UOM_ID",100);var u=e.dataContext.getJSONRecord("MCharge/GetChargeDetails",r.toString());null!=u&&(n.setValue("PriceActual",t.getValueOfDecimal(u.ChargeAmt)),n.setValue("PrintDescription",t.getValueOfString(u.PrintDescription)))}catch(e){return this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),""},a.prototype.Amt=function(a,i,n,l,s,o){if(null==s||""==s.toString())return"";if(this.isCalloutActive()||null==s)return"";try{this.setCalloutActive(!0);var r=a.getStdPrecision(),c=r,u=a.getContextAsInt(i,"M_PriceList_ID");if(0!=u&&null!=(A=e.dataContext.getJSONRecord("MPriceList/GetPriceList",u.toString()))&&(r=t.getValueOfInt(A.StdPrecision),c=t.getValueOfInt(A.PriceListPrecision)),"Qty"==l.getColumnName()&&"Y"==a.getContext("DiscountSchema")){var d=a.getContextAsInt(i,"M_Product_ID"),g=a.getContextAsInt(i,"C_BPartner_ID"),p=s,v=a.getContextAsInt(i,"M_PriceList_Version_ID"),_=n.getValue("DateInvoiced"),V=d.concat(",",g,",",p,",",!1,",",u,",",v,",",_,",",null),A=null;A=e.dataContext.getJSONRecord("MProductPricing/GetProductPricing",V),n.setValue("PriceActual",t.getValueOfDecimal(A.PriceActual.toFixed(c)))}var m=n.getValue("QtyEntered"),f=n.getValue("PriceActual");this.log.fine("amt - Qty="+m+", Price="+f+", Precision="+c);var D=m*f;t.scale(D)>r&&(D=D.toFixed(r)),n.setValue("LineNetAmt",D),n.setValue("PriceActual",t.getValueOfDecimal(f.toFixed(c))),this.log.info("amt - LineNetAmt="+D)}catch(e){this.setCalloutActive(!1),this.log.saveError("CalloutRequisation",e)}return this.setCalloutActive(!1),a=i=n=l=s=null,""},a.prototype.Qty=function(a,i,n,l,s,o){var r="";if(this.isCalloutActive()||null==s||""==s.toString())return"";if(console.log("Before Charge Or Product"),0==t.getValueOfInt(n.getValue("M_Product_ID"))&&0==t.getValueOfInt(n.getValue("C_Charge_ID")))return"";console.log("After Charge Or Product"),this.setCalloutActive(!0);try{var c=a.getContextAsInt(i,"M_Product_ID");false;var u,d=e.Env.ZERO,g=e.Env.ZERO,p=a.getContextAsInt(i,"M_PriceList_ID");if(0==c)g=d=t.getValueOfDecimal(n.getValue("QtyEntered")),n.setValue("Qty",g);else if("C_UOM_ID"==l.getColumnName()||"M_AttributeSetInstance_ID"==l.getColumnName()){var v=t.getValueOfInt(n.getValue("C_UOM_ID"));d=t.getValueOfDecimal(n.getValue("QtyEntered"));var _=a.getContextAsInt(i,"C_BPartner_ID");"M_AttributeSetInstance_ID"==l.getColumnName()?t.getValueOfInt(n.getValue("M_AttributeSetInstance_ID")):a.getContextAsInt(i,"M_AttributeSetInstance_ID");a.getContext(i,"DateDoc");var V=2,A=c.toString().concat(",",n.getValue("M_Requisition_ID").toString()+","+t.getValueOfString(n.getValue("M_AttributeSetInstance_ID"))+","+t.getValueOfString(n.getValue("C_UOM_ID"))+","+a.getAD_Client_ID().toString()+","+t.getValueOfString(_)+","+d.toString()+","+p.toString()),m=e.dataContext.getJSONRecord("MProductPricing/GetPricesOnChange",A);null!=m&&(n.setValue("PriceActual",t.getValueOfDecimal(m.PriceEntered)),V=t.getValueOfInt(m.UOMPrecision),g=m.QtyOrdered);var f=d.toFixed(t.getValueOfInt(V));d!=f&&(this.log.fine("Corrected QtyEntered Scale UOM="+v+"; QtyEntered="+d+"->"+f),d=f,n.setValue("QtyEntered",d)),null==g&&(g=d),n.setValue("Qty",g)}else if("QtyEntered"==l.getColumnName()){v=a.getContextAsInt(i,"C_UOM_ID");d=t.getValueOfDecimal(s),r=v.toString().concat(",");V=e.dataContext.getJSONRecord("MUOM/GetPrecision",r),f=d.toFixed(t.getValueOfInt(V));d!=f&&(this.log.fine("Corrected QtyEntered Scale UOM="+v+"; QtyEntered="+d+"->"+f),d=f,n.setValue("QtyEntered",d)),r=c.toString().concat(",",v.toString(),",",d.toString()),null==(g=e.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",r))&&(g=d);var D=d!=g;this.log.fine("UOM="+v+", QtyEntered="+d+" -> "+D+" Qty="+g),a.setContext(i,"UOMConversion",D?"Y":"N"),n.setValue("Qty",g)}u=t.getValueOfDecimal(n.getValue("PriceActual"));var h=a.getStdPrecision();if(p>0){var C=e.dataContext.getJSONRecord("MPriceList/GetPriceList",p.toString());null!=C&&(h=t.getValueOfInt(C.StdPrecision)),C=null}var S=d*u;t.scale(S)>h&&(S=S.toFixed(h)),n.setValue("LineNetAmt",S),this.log.info("amt - LineNetAmt="+S)}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),a=i=n=l=s=null,""},a.prototype.ProjectLine=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l)return"";if(null!=i.getValue("C_ProjectLine_ID")){var o=i.getValue("C_ProjectLine_ID"),r=e.dataContext.getJSONRecord("MProject/GetReqLinesProjectDetail",o);null!=r&&(i.setValue("M_Product_ID",r.ProductID),i.setValue("M_AttributeSetInstance_ID",r.AtrrInstance),i.setValue("C_Charge_ID",r.ChargeID),i.setValue("C_UOM_ID",r.UOM),i.setValue("PriceActual",r.PriceActual),i.setValue("QtyEntered",r.QtyEntered))}return this.setCalloutActive(!1),""},e.Model.CalloutRequisition=a}(VIS,jQuery)},8648:()=>{VAS=window.VAS||{},function(e,t){e.VAS_PurchaseOrderTabPanel=function(){this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var a=null,n=this.ctx,l=this;e.translatedTexts=VIS.Msg.translate(n,["VAS_QtyOrderedPO","VAS_QtyDeliveredPO","VAS_QtyInvoicedPO","VAS_ProductsPO"],!0);var s=t('<div class = "VAS-PO-summary h-100"></div>'),o=t('<div class="VAS-polist-heading">'+e.translatedTexts.VAS_ProductsPO+"</div>"),r=t("<div class ='VAS-PO-list-col'></div>");this.getProductPanel=function(n){t.ajax({url:VIS.Application.contextUrl+"VAS/PoReceipt/GetPOLineData",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{OrderID:n},complete:function(){s.closest(".vis-ad-w-p-actionpanel-b").length>0&&s.closest(".vis-ad-w-p-ap-tp-outerwrap").css("height","100%")},success:function(n){if(r.empty(),null!=a&&a.remove(),null!=(n=JSON.parse(n))&&n.length>0)for(a="DE"==n[0].OrderStatusValue||"DI"==n[0].OrderStatusValue?t('<div class="VAS-delivered-msg"><i class="fa fa-check-circle" aria-hidden="true"></i><span class="">'+n[0].OrderStatus+"</span> </div>"):"OP"===n[0].OrderStatusValue||""===n[0].OrderStatusValue?t('<div class="VAS-Open-msg"><span class="vis vis-info"></span>'+n[0].OrderStatus+"</div>"):t('<div class="VAS-partially-msg"><span class="vis vis-info"></span>'+n[0].OrderStatus+"</div>"),s.append(a).append(o),i=0;i<n.length;i++){var l='<div class="VAS-polist-box">';"OP"===n[i].OrderLineStatusValue||""===n[i].OrderLineStatusValue?l+='<div class="VAS-po-info-icon"><span class="vis vis-info vas-openItem"></span></div>':n[i].OrderLineStatusValue&&n[i].OrderLineStatusValue.contains("P")?l+='<div class="VAS-po-info-icon"><span class="vis vis-info"></span></div>':l+='<div class="VAS-po-approve-icon"><i class="fa fa-check-circle" aria-hidden="true"></i></div>';var c=n[i].ImageUrl;if(""!=c){c=c.substring(c.lastIndexOf("/")+1,c.length);var u=new Date;l+='<div class="VAS-product-thumbnail"><img alt="" title="" style="opacity:1;" src="'+VIS.Application.contextUrl+"Images/Thumb46x46/"+c+"?"+u.getTime()+'"></div>'}else l+='<div class="VAS-product-thumbnail"><i class="vis vis-image"></i></div>';l+='<div class="VAS-PO-details"><h1>'+n[i].ProductName+'</h1><div class="VAS-Attrbiute">'+(null==n[i].AttributeName?"":n[i].AttributeName)+'</div><div class="VAS-UPC-num">'+(null==n[i].UPC||""==n[i].UPC?"":n[i].UPC+" | ")+"<span>"+n[i].UOM+'</span></div><div class="VAS-order-description"><div class="VAS-order-values"><h6>'+e.translatedTexts.VAS_QtyOrderedPO+"</h6><span>"+n[i].QtyOrdered+'</span></div><div class="VAS-order-values"><h6>'+e.translatedTexts.VAS_QtyDeliveredPO+"</h6><span>"+n[i].QtyDelivered+"</span></div></div></div></div>",r.append(l)}s.append(r)},error:function(e){console.log(e)}})},this.getRoot=function(){return s},e.VAS_PurchaseOrderTabPanel.prototype.startPanel=function(e,t){l.windowNo=e,l.curTab=t},e.VAS_PurchaseOrderTabPanel.prototype.refreshPanelData=function(e,t,a){this.record_ID=e,this.selectedRow=t,this.getProductPanel(e)},e.VAS_PurchaseOrderTabPanel.prototype.sizeChanged=function(e){this.panelWidth=e},e.VAS_PurchaseOrderTabPanel.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,a=null}}}(VAS,jQuery)},8692:()=>{!function(e){var t=e.Logging.Level,a=e.Utility.Util;function i(){e.CalloutEngine.call(this,"VIS.CalloutRequest")}function n(){e.CalloutEngine.call(this,"VIS.CalloutMRequest")}e.Utility.inheritPrototype(i,e.CalloutEngine),i.prototype.CopyMail=function(a,i,n,l,s,o){var r=l.getColumnName();if(this.log.info(r+"="+s),null==s||""==s.toString())return"";try{var c=e.dataContext.getJSONRecord("MRequestType/GetMailText",s.toString());c=e.Env.parseContext(a,i,c,!1,!0),n.setValue("Result",c)}catch(e){this.setCalloutActive(!1),this.log.log(t.SEVERE,sql,e)}return a=i=n=l=s=null,""},i.prototype.CopyResponse=function(a,i,n,l,s,o){var r=l.getColumnName();if(this.log.info(r+"="+s),null==s||""==s.toString())return"";try{var c=e.dataContext.getJSONRecord("MRequestType/GetResponseText",s.toString());c=e.Env.parseContext(a,i,c,!1,!0),n.setValue("Result",c)}catch(e){this.setCalloutActive(!1),this.log.log(t.SEVERE,sql,e)}return a=i=n=l=s=null,""},i.prototype.Type=function(t,i,n,l,s,o){var r=l.getColumnName();if(this.log.info(r+"="+s),n.setValue("R_Status_ID",null),null==s||""==s.toString())return"";var c=a.getValueOfInt(s);if(0==c)return"";var u=c.toString(),d=e.dataContext.getJSONRecord("MRequestType/GetDefaultR_Status_ID",u);return 0!=d&&n.setValue("R_Status_ID",a.getValueOfInt(d)),n=l=s=null,""},i.prototype.CopyResolution=function(a,i,n,l,s,o){var r=l.getColumnName();if(this.log.info(r+"="+s),null==s||""==s.toString())return"";try{var c=e.dataContext.getJSONRecord("MRequestType/GetResolutionText",s.toString());c=e.Env.parseContext(a,i,c,!1,!0),n.setValue("Result",c)}catch(e){this.setCalloutActive(!1),this.log.log(t.SEVERE,sql,e)}return a=i=n=l=s=null,""},e.Model.CalloutRequest=i,e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.DateRequired=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";this.setCalloutActive(!0);try{var o,r;o=new Date(i.getValue("StartDate")),(r=new Date(i.getValue("CloseDate"))).toISOString()<o.toISOString()&&(i.setValue("CloseDate",""),this.setCalloutActive(!1),e.ADialog.info("CloseDateInvalid",null,"","")),this.log.fine("CloseDate="+r)}catch(t){return e.ADialog.info("error in Date"+t,null,"",""),this.setCalloutActive(!1),t}return this.setCalloutActive(!1),i=l=null,""},n.prototype.PlanDateRequired=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";this.setCalloutActive(!0);try{var o,r;o=new Date(i.getValue("DateStartPlan")),(r=new Date(i.getValue("DateCompletePlan"))).toISOString()<o.toISOString()&&(i.setValue("DateCompletePlan",""),this.setCalloutActive(!1),e.ADialog.info("CmpDateInvalid",null,"","")),this.log.fine("DateCompletePlan="+r)}catch(t){return e.ADialog.info("error in Date"+t,null,"",""),this.setCalloutActive(!1),t}return this.setCalloutActive(!1),i=l=null,""},e.Model.CalloutMRequest=n}(VIS,jQuery)},8722:()=>{VAS=window.VAS||{},function(e,t){e.LineHistoryTabPanel=function(){this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var a=null,n=this.ctx,l=this;e.translatedTexts=VIS.Msg.translate(n,["VAS_HistoryTitleTabPanel","VAS_LineHistory","VAS_LineNo","VAS_DateOrdered","VAS_DatePromised","VAS_Product","VAS_Charge","VAS_Quantity","VAS_UOM","VAS_QuantityOrdered","VAS_Price","VAS_ListPrice","VAS_UnitPrice","VAS_Tax","VAS_Discount","VAS_LineAmount","VAS_Description"],!0);var s=t('<div class = "root"></div>'),o=t("<div class ='vas-apTaxWrapper'></div>");a=t("<h6 class='vas-apTax-ttl'>"+e.translatedTexts.VAS_LineHistory+"</h6>"),this.init=function(){o.append(a),o.append('<div class="vas-aptaxListGroup"><div id= "VAS-TaxDetail_'+l.windowNo+'" class= "VAS-TaxDetail mb-2" > </div></div>'),s.append(o)},this.getLineHistoryPanel=function(a){t.ajax({url:VIS.Application.contextUrl+"VAS/PoReceipt/GetLineHistoryData",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{OrderLineID:a},complete:function(){s.closest(".vis-ad-w-p-actionpanel-b").length>0&&s.closest(".vis-ad-w-p-ap-tp-outerwrap").css("height","100%")},success:function(t){if(o.find("#VAS-TaxDetail_"+l.windowNo).empty(),null!=(t=JSON.parse(t))&&t.length>0)for(i=0;i<t.length;i++){var a='<div class="vas-apListItem mb-2"><div class="vas-ap-sgl1Item1_First mb-2"><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_LineNo+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].LineNo+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_DateOrdered+'</span><span class="vas-singleTaxElementValue1_first">'+new Date(t[i].DateOrdered).toLocaleDateString()+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_DatePromised+'</span><span class="vas-singleTaxElementValue1_first">'+new Date(t[i].DatePromised).toLocaleDateString()+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_Product+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].Product+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_Charge+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].Charge+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_Quantity+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].Quantity+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_UOM+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].UOM+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_QuantityOrdered+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].QuantityOrdered+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_Price+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].Price.toLocaleString(window.navigator.language,{minimumFractionDigits:t[i].stdPrecision,maximumFractionDigits:t[i].stdPrecision})+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_ListPrice+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].ListPrice.toLocaleString(window.navigator.language,{minimumFractionDigits:t[i].stdPrecision,maximumFractionDigits:t[i].stdPrecision})+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_UnitPrice+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].UnitPrice.toLocaleString(window.navigator.language,{minimumFractionDigits:t[i].stdPrecision,maximumFractionDigits:t[i].stdPrecision})+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_Tax+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].Tax+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_Discount+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].Discount.toLocaleString(window.navigator.language,{minimumFractionDigits:t[i].stdPrecision,maximumFractionDigits:t[i].stdPrecision})+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_LineAmount+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].LineAmount.toLocaleString(window.navigator.language,{minimumFractionDigits:t[i].stdPrecision,maximumFractionDigits:t[i].stdPrecision})+'</span></div><div class="vas-singleTaxElement "><span class="vas-singleTaxElementTTl font-weight-bold">'+e.translatedTexts.VAS_Description+'</span><span class="vas-singleTaxElementValue1_first">'+t[i].Description+"</span></div></div>";o.find("#VAS-TaxDetail_"+l.windowNo).append(a)}},error:function(e){console.log(e)}})},this.getRoot=function(){return s},e.LineHistoryTabPanel.prototype.startPanel=function(e,t){l.windowNo=e,l.curTab=t,l.init()},e.LineHistoryTabPanel.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.getLineHistoryPanel(e)},e.LineHistoryTabPanel.prototype.sizeChanged=function(e){this.panelWidth=e},e.LineHistoryTabPanel.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,a=null}}}(VAS,jQuery)},8806:()=>{VIS=window.VIS||{},function(e,t){function a(){this.windowNo=null;var a=t("<div style='width: 100%; height: 100%; background-color: white;'>"),i=this,n=null,l=null,s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=[],_=null;function V(e){p[0].style.visibility=e?"visible":"hidden"}function A(){t.ajax({url:e.Application.contextUrl+"VBOMDrop/GetDetail",async:!1,datatype:"Json",type:"GET",cache:!1,success:function(e){var a=JSON.parse(e);controlsData=a,null==a&&null==a||function(e){if(null!=e.Product||e.Product.length>0)for(var a in s.empty(),s.append(t('<Option value="-1"></option>')),e.Product)s.append(t('<Option value="'+e.Product[a].ID+'">'+e.Product[a].Value+"</option>"));if(null!=e.Invoice||e.Invoice.length>0)for(var a in o.empty(),o.append(t('<Option value="-1"></option>')),e.Invoice)o.append(t('<Option value="'+e.Invoice[a].ID+'">'+e.Invoice[a].Value+"</option>"));if(null!=e.Order||e.Order.length>0)for(var a in r.empty(),r.append(t('<Option value="-1"></option>')),e.Order)r.append(t('<Option value="'+e.Order[a].ID+'">'+e.Order[a].Value+"</option>"));if(null!=e.Opportunity||e.Opportunity.length>0)for(var a in c.empty(),c.append(t('<Option value="-1"></option>')),e.Opportunity)c.append(t('<Option value="'+e.Opportunity[a].ID+'">'+e.Opportunity[a].Value+"</option>"));V(!1)}(a),V(!1)},error:function(e){console.log(e),V(!1)}})}this.initialize=function(){(p=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="hidden",a.append(p),V(!0),window.setTimeout(function(){!function(){t(window).height();n=t("<div class='vis-mainContainer'>");var p=" <div class='vis-pSelectInfo vis-leftsidebarouterwrap'><div class='vis-pSelectInner'> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <select id='VIS_cmbProduct_"+i.windowNo+"'></select> <label>"+e.Msg.translate(e.Env.getCtx(),"M_Product_ID")+' </label></div></div> </div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbinvoice_'+i.windowNo+"'></select> <label>"+e.Msg.translate(e.Env.getCtx(),"C_Invoice_ID")+' </label></div></div> </div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbOrder_'+i.windowNo+"'></select> <label>"+e.Msg.translate(e.Env.getCtx(),"C_Order_ID")+' </label></div></div> </div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbOpportunity_'+i.windowNo+"'></select> <label>"+e.Msg.translate(e.Env.getCtx(),"C_Project_ID")+" </label></div></div> </div> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input data-placeholder='' placeholder=' ' type='number' id='VIS_txtQuantity_"+i.windowNo+"' min='0' MaxLength='50'> <label>"+e.Msg.translate(e.Env.getCtx(),"Qty")+"</label></div></div> </div> </div> <div class='vis-paymentselect-field'> <button class='VIS_Pref_btn-2'  id='VIS_btnRefresh_"+i.windowNo+"' style='margin-top: 0px;'><i class='vis vis-refresh'></i></button> </div> </div>";l=t("<div class='vis-pSelectIionGrid'>");var m=" <div class='vis-pSelectProcess'> <div class='vis-paymentselect-field'> <input id='VIS_btnCancel_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+e.Msg.getMsg("Cancel")+"' ></input> <input id='VIS_btnOK_"+i.windowNo+"' disabled class='vis-frm-btn' type='submit' value='"+e.Msg.getMsg("OK")+"' ></input> </div> </div>";n.append(t(p)).append(l).append(t(m)),a.append(n),s=t("#VIS_cmbProduct_"+i.windowNo),o=t("#VIS_cmbinvoice_"+i.windowNo),r=t("#VIS_cmbOrder_"+i.windowNo),c=t("#VIS_cmbOpportunity_"+i.windowNo),u=t("#VIS_txtQuantity_"+i.windowNo),g=t("#VIS_btnCancel_"+i.windowNo),d=t("#VIS_btnOK_"+i.windowNo),_=t("#VIS_btnRefresh_"+i.windowNo),A(),_.on("click",function(){V(!0),l.empty(),window.setTimeout(function(){A(),V(!1)},20)}),d.on("click",function(){!function(){var a=[];a.push(s.val()),a.push(o.val()),a.push(r.val()),a.push(c.val());for(var n=0;n<t(l[0]).children().length;n++)t(t(t(t(l[0]).children()[n]).children()[1]).children()[0]).prop("checked")?(v[n].IsSelected=!0,v[n].BOMQty=t(t(t(t(l[0]).children()[n]).children()[0]).children()[1]).val()):v[n].IsSelected=!1;a.push(JSON.stringify(v)),t.ajax({url:e.Application.contextUrl+"VBOMDrop/SaveRecord",async:!1,datatype:"Json",type:"POST",cache:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify(a),success:function(t){JSON.parse(t)?i.dispose():e.ADialog.info("RecordNotSaved")},error:function(e){console.log(e),V(!1)}})}()}),g.on("click",function(){i.dispose()}),s.on("change",function(){s.val()>0?d.removeAttr("disabled"):d.attr("disabled",!0),V(!0),window.setTimeout(function(){u.val(""),t.ajax({url:e.Application.contextUrl+"VBOMDrop/GetBOMLines",async:!1,datatype:"Json",type:"GET",cache:!1,data:{productID:parseInt(s.val())},success:function(e){var a=JSON.parse(e);controlsData=a,null!=a||null!=a?function(e){var a="";l.empty();var i="",n="",s=!1;v=e;for(var o=0;o<e.length;o++)a="","P"==e[o].BOMType?(i="<input type='checkbox' checked disabled id='VIS_chkBOMLine_"+o+"' style='height: 15px;width: auto;'></input>",n="<input type='number' id='VIS_qtyBOMLine_"+o+"' style='background: pink;width:200%;' min='0' value='"+e[o].BOMQty+"'></input>"):"O"==e[o].BOMType?(i="<input type='checkbox' id='VIS_chkBOMLine_"+o+"' style='height: 15px;width: auto;'></input>",n="<input type='number' disabled id='VIS_qtyBOMLine_"+o+"' style='background: #FFF5FF;width:200%;'  min='0' value='"+e[o].BOMQty+"'></input>"):s?(i=" <input type='radio' name='vis-radiolist' id='VIS_chkBOMLine_"+o+"' style='height: 15px;width: auto;'></input>",n="<input type='number' disabled id='VIS_qtyBOMLine_"+o+"' style='background: #FFF5FF;width:200%;' min='0' value='"+e[o].BOMQty+"'></input>"):(i=" <input type='radio' name='vis-radiolist' checked id='VIS_chkBOMLine_"+o+"' style='height: 15px;width: auto;'></input>",n="<input type='number' id='VIS_qtyBOMLine_"+o+"' style='background: pink;width:200%;' min='0' value='"+e[o].BOMQty+"'></input>"),a+="<div class='vis-bomlinesdata'> <div style='float:left;width: 50%;'> <label style='margin: 5px;width:100%;'>"+e[o].ProductName+"</label>"+n+" </div> <div style='float:right;'>"+i+" <label style='margin-right:5px;'>"+e[o].BOMTypeName+"</label> </div> </div>",l.append(t(a)),t("#VIS_chkBOMLine_"+o).on("click",function(e){var a=t(t(t(t(this).parent()).parent().children()[0]).children()[1]);t(this).prop("checked")?(a.css("background","pink"),a.removeAttr("disabled")):(a.css("background","#FFF5FF"),a.attr("disabled",!0))})}(a):l.empty(),V(!1)},error:function(e){console.log(e),V(!1)}})},20)}),o.on("change",function(){o.val()>0?(s.val()>0&&d.removeAttr("disabled"),r.attr("disabled",!0),c.attr("disabled",!0)):(d.attr("disabled",!0),r.removeAttr("disabled"),c.removeAttr("disabled"))}),r.on("change",function(){r.val()>0?(s.val()>0&&d.removeAttr("disabled"),o.attr("disabled",!0),c.attr("disabled",!0)):(d.attr("disabled",!0),o.removeAttr("disabled"),c.removeAttr("disabled"))}),c.on("change",function(){c.val()>0?(s.val()>0&&d.removeAttr("disabled"),r.attr("disabled",!0),o.attr("disabled",!0)):(d.attr("disabled",!0),r.removeAttr("disabled"),o.removeAttr("disabled"))}),u.on("change",function(){for(var e=0;e<t(l[0]).children().length;e++){var a=v[e].BOMQty;t(t(t(t(l[0]).children()[e]).children()[0]).children()[1]).attr("Value",a*u.val())}})}()},20)},this.getRoot=function(){return a},this.disposeComponent=function(){a=null,i=null,n=null,l=null,s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=null}}e.Apps.AForms=e.Apps.AForms||{},a.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.frame.getContentGrid().append(this.getRoot()),this.initialize()},a.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.VBOMDrop=a}(VIS,jQuery)},8818:()=>{!function(e,t){function a(t){var a=this.$super;a.constructor(t);var i=this;!function(){a.title=e.Msg.getMsg("Invoice")+" .. "+e.Msg.getMsg("CreateFrom"),null!=a.lblInvoice&&a.lblInvoice.getControl().css("display","none");null!=a.cmbInvoice&&a.cmbInvoice.getControl().css("display","none");null!=a.lblLocator&&a.lblLocator.getControl().css("display","none");null!=a.locatorField&&a.locatorField.getControl().css("display","none");a.deliveryDate=new e.Controls.VDate("DeliveryDate",!1,!1,!0,e.DisplayType.Date,"DeliveryDate");var t=e.MLookupFactory.getMLookUp(e.Env.getCtx(),a.windowNo,2221,e.DisplayType.Search);a.vProduct=new e.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,e.DisplayType.Search,t);var n=a.initBPartner(!0);a.vBPartner.setReadOnly(!0),function(t){!function(t,n){var l="Y".equals(e.Env.getCtx().getWindowContext(i.windowNo,"IsDropShip")),s="Y".equals(e.Env.getCtx().getWindowContext(i.windowNo,"IsSOTrx")),o=e.dataContext.getJSONRecord("MDocType/GetDocType",e.Env.getCtx().getContextAsInt(i.windowNo,"C_DocTypeTarget_ID").toString()),r=e.Utility.Util.getValueOfBoolean(o.IsReturnTrx),c=" M_InOut_ID IN (SELECT s.M_InOut_ID FROM M_InOut s WHERE s.C_BPartner_ID = "+n+" AND s.IsSOTrx = '"+(s?"Y":"N")+"' AND s.DocStatus IN('CL', 'CO') AND s.IsDropShip='"+(l?"Y":"N")+"'";null!=r&&(c+=" AND S.IsReturnTrx='"+(1==r?"Y":"N")+"'");s||(c+=" AND s.M_InOut_ID NOT IN (SELECT DISTINCT OL.M_InOut_ID FROM C_ProvisionalInvoice PI INNER JOIN C_ProvisionalInvoiceLine IL ON IL.C_ProvisionalInvoice_ID = PI.C_ProvisionalInvoice_ID INNER JOIN M_InOutLine OL ON OL.M_InOutLine_ID = IL.M_InOutLine_ID AND S.M_InOut_ID = OL.M_InOut_ID WHERE  PI.IsActive = 'Y' AND pi.DocStatus NOT IN('VO', 'RE')) ");c+=" AND s.M_InOut_ID IN (SELECT t.M_InOut_ID FROM (SELECT sl.M_InOut_ID, sl.M_InOutLine_ID, sl.MovementQty,  (SELECT SUM(NVL(il.QtyInvoiced, 0)) FROM C_InvoiceLine il INNER JOIN C_Invoice I ON I.C_INVOICE_ID = il.C_INVOICE_ID WHERE i.DocStatus NOT IN ('VO', 'RE') AND sl.M_InOutLine_ID = il.M_InOutLine_ID) AS QtyInvoiced FROM M_InOutLine sl) t GROUP BY t.M_InOut_ID, t.M_InOutLine_ID, t.MovementQty HAVING t.MovementQty > SUM(NVL(t.QtyInvoiced, 0))))";var u=e.MLookupFactory.get(e.Env.getCtx(),a.windowNo,0,e.DisplayType.Search,"M_InOut_ID",0,!1,c);a.cmbShipment=new e.Controls.VTextBoxButton("M_InOut_ID",!0,!1,!0,e.DisplayType.Search,u)}(e.Env.getCtx(),t)}(n),a.fromInvoice=!0}(),a.jbInit(),a.initOK=!0;t.getWindowNo();this.log=e.Logging.VLogger.getVLogger("VCreateFromInvoice"),this.disposeComponent=function(){a=null,i=null,this.disposeComponent=null}}e.Utility.inheritPrototype(a,e.VCreateFrom),a.prototype.saveInvoice=function(){if(null==this.$super.dGrid)return!1;var t={},a=this.$super.multiValues;if(null==a)return!1;if(a.length<=0)return!1;for(var i=0;i<a.length;i++)t[i]=a[i];var n=this.$super.mTab.getValue("C_Invoice_ID"),l=e.Utility.Util.getValueOfInt(this.$super.cmbOrder.getValue()),s=e.Utility.Util.getValueOfInt(this.$super.cmbShipment.getValue()),o=e.Utility.Util.getValueOfInt(this.$super.cmbProvisionalInvoice.getValue());return null!=o&&""!=o||(o=0),this.saveData(t,"",l,s,n,o)},a.prototype.loadShipments=function(t,a,i){this.getShipmentsData(e.Env.getCtx(),t,a,i)},a.prototype.getShipmentsData=function(a,i,n,l){var s=this;if(this.$super.record_ID=$self.mTab.getValue("C_Invoice_ID"),null!=s.$super.dGrid){var o=s.$super.dGrid.getSelection();for(item in o){t.grep(s.$super.multiValues,function(e,t){return e.M_Product_ID_K==s.$super.dGrid.get(o[item]).M_Product_ID_K&&e.M_InOut_ID_K==s.$super.dGrid.get(o[item]).M_InOut_ID_K}).length>0||s.$super.multiValues.push(s.$super.dGrid.get(o[item]))}}var r="",c="";return r=e.Env.isBaseLanguage(a,"C_UOM")?"FROM C_UOM uom INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom Left join C_UOM uom1 on (uom1.C_UOM_ID=uom.C_UOM_ID)  INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+e.Env.getAD_Language(a)+"') ",null!=n&&(c=" AND l.M_Product_ID="+n),l||(l=1),t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetDataVCreateFrom",dataType:"json",type:"POST",data:{keyColumnName:s.$super.mTab.keyColumnName,tableName:"M_InOutLine",recordID:s.$super.record_ID,pageNo:l,mInOutId:i,isBaseLanguages:r,mProductIDD:c},error:function(t){alert(e.Msg.getMsg("ErrorWhileGettingData")),s.$super.setBusy(!1),selfChild.log.info(t)},success:function(t){var a=JSON.parse(t);if(a.Error)return e.ADialog.error(a.Error),void s.$super.setBusy(!1);s.$super.resetPageCtrls(a.pSetting),s.$super.loadGrid(a.data),s.$super.setBusy(!1)}}),[]},a.prototype.loadShipment=function(t){var a=this.getShipmentData(e.Env.getCtx(),t);this.$super.loadGrid(a)},a.prototype.getShipmentData=function(a,i){var n="";return n=e.Env.isBaseLanguage(a,"C_UOM")?"FROM C_UOM uom INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+e.Env.getAD_Language(a)+"') ",t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetShipmentDatas",type:"POST",async:!1,data:{MInOutIDs:i,isBaseLanguageUmos:n},success:function(e){var t=JSON.parse(e);if(t&&t.length>0)for(var a=1,i=0;i<t.length;i++){var n={},l=dr.getDecimal(0),s=dr.getDecimal(1);n.Quantity=l,n.QuantityEntered=s,n.C_UOM_ID=dr.getString(3),n.M_Product_ID=dr.getString(5),n.C_Order_ID=".",n.M_InOut_ID=dr.getString(7),n.C_Invoice_ID=null,n.C_UOM_ID_K=dr.getString(2),n.M_Product_ID_K=dr.getInt(4),n.C_Order_ID_K=dr.getInt(8),n.M_InOut_ID_K=dr.getInt(6),n.C_Invoice_ID_K=null,n.recid=a,a++,e.push(n)}},error:function(e){}}),[]},a.prototype.loadProvisionalInvoices=function(t,a,i){this.getProvisionalInvoicesData(e.Env.getCtx(),t,a,i)},a.prototype.getProvisionalInvoicesData=function(a,i,n,l){var s=this;if(this.$super.record_ID=$self.mTab.getValue("C_Invoice_ID"),null!=s.$super.dGrid){var o=s.$super.dGrid.getSelection();for(item in o){t.grep(s.$super.multiValues,function(e,t){return e.M_Product_ID_K==s.$super.dGrid.get(o[item]).M_Product_ID_K&&e.C_Invoice_ID_K==s.$super.dGrid.get(o[item]).C_Invoice_ID_K}).length>0||s.$super.multiValues.push(s.$super.dGrid.get(o[item]))}}var r="",c="";r=e.Env.isBaseLanguage(a,"C_UOM")?"FROM C_UOM uom INNER JOIN C_ProvisionalInvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom Left join C_UOM uom1 on (uom1.C_UOM_ID=uom.C_UOM_ID) INNER JOIN C_ProvisionalInvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+e.Env.getAD_Language(a)+"') ",null!=n&&(c=" AND l.M_Product_ID = "+n),l||(l=1);var u=null;return null!=s.$super.relatedToOrg&&s.$super.relatedToOrg.getValue()&&(u=s.$super.mTab.getValue("AD_Org_ID")),t.ajax({url:e.Application.contextUrl+"VCreateFrom/GetProvisionalInvoicesDataVCreate",dataType:"json",type:"POST",data:{keyColumnName:s.$super.mTab.keyColumnName,tableName:"C_ProvisionalInvoiceLine",recordID:s.$super.record_ID,pageNo:l,isBaseLangss:r,cInvoiceID:i,mProductIDs:c,orgId:u},error:function(t){alert(e.Msg.getMsg("ErrorWhileGettingData")),selfChild.log.info(t),s.$super.setBusy(!1)},success:function(t){var a=JSON.parse(t);if(a.Error)return e.ADialog.error(a.Error),void s.$super.setBusy(!1);s.$super.resetPageCtrls(a.pSetting),s.$super.loadGrid(a.data),s.$super.setBusy(!1)}}),[]},a.prototype.saveData=function(a,i,n,l,s,o){var r=this;t.ajax({type:"POST",url:e.Application.contextUrl+"Common/SaveInvoice",dataType:"json",data:{model:a,selectedItems:i,C_Order_ID:n,C_Invoice_ID:s,M_inout_id:l,C_ProvisionalInvoice_ID:o},success:function(e){if(returnValue=e.result,returnValue)return r.dispose(),r.$super.$root.dialog("close"),void r.$super.setBusy(!1);r.$super.setBusy(!1),alert(returnValue)},error:function(e,t,a){console.log(t),r.$super.setBusy(!1),alert(a)}})},a.prototype.dispose=function(){null!=this.disposeComponent&&this.disposeComponent()},e.VCreateFromInvoice=a}(VIS,jQuery)},8949:()=>{!function(e,t){function a(){this.frame,this.windowNo;var a=this,i=[],n=null;this.log=e.Logging.VLogger.getVLogger("VCharge");var l=!1,s=new e.Controls.VLabel(e.Msg.getMsg("SearchKey",!1,!1),"SearchKey",!1,!0),o=new e.Controls.VLabel(e.Msg.getMsg("Name",!1,!1),"Name",!1,!0),r=new e.Controls.VTextBox("SearchKey",!0,!1,!0,50,100,null,null,!1),c=new e.Controls.VTextBox("Name",!1,!1,!0,50,100,null,null,!1),u=new e.Controls.VCheckBox("Expense",!1,!1,!0,e.Msg.getMsg("Expense",!1,!1),null),d=(new e.Controls.VCheckBox("SelectAll",!1,!1,!0,e.Msg.getMsg("SelectAll",!1,!1),null),null),g=null;new e.Controls.VLabel;this.log=e.Logging.VLogger.getVLogger("VCharge");var p=t("<div style='width: 100%; height: 100%; background-color: white; '>"),v=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),_=null,V=null,A=null,m=null,f=null,D=null,h=null,C=null,S=null,I=260,y=50,O=t(window).width()-(I+20+5),T=t(window).width()-(20+y),w=(t(window).height(),0),P=0,b=0,M=0,x=0;function N(){var l=[];P=e.Env.getCtx().getContextAsInt("$C_AcctSchema_ID"),M=e.Env.getCtx().getAD_Client_ID(),x=e.Env.getCtx().getAD_Org_ID(),t.ajax({url:e.Application.contextUrl+"VCharge/VChargeLodGrideData",dataType:"json",data:{mcAcctSchemaID:P,mADClientId:M},success:function(s){if(0!=s.result.meID){if(s.result&&s.result.VchargeMCElemTaxCatID){s.result.VchargeMCElemTaxCatID;if(0==(w=s.result.VchargeMCElemTaxCatID[0].mCElementID))return;b=s.result.VchargeMCElemTaxCatID[0].mCTaxCategoryID}if(s.result&&s.result.VchargeCElementValue){for(var o=s.result.VchargeCElementValue,r=1,c=0;c<o.length;c++){var u={};u.C_ElementValue_ID=o[c].C_ElementValue_ID,u.Value=o[c].Value,u.Name=o[c].Name,u.Expense="false"!=o[c].Expense,u.recid=r,r++,l.push(u)}!function(l){null!=n&&(n.destroy(),n=null),0==i.length&&(i.push({field:"C_ElementValue_ID",caption:e.Msg.getMsg("C_ELEMENTVALUE_ID"),sortable:!0,size:"16%",min:150,hidden:!0}),i.push({field:"Value",caption:e.Msg.getMsg("SearchKey"),sortable:!0,size:"25%",min:150,hidden:!1}),i.push({field:"Name",caption:e.Msg.getMsg("Name"),sortable:!0,size:"25%",min:150,hidden:!1}),i.push({field:"Expense",caption:e.Msg.getMsg("Expense"),sortable:!0,size:"25%",min:150,hidden:!1,editable:{type:"checkbox"}})),w2utils.encodeTags(l),n=t(f).w2grid({name:"gridAccountElement"+a.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:i,records:l})}(l),setBusy(!1)}}},error:function(e){setBusy(!1),a.log.info(e)}})}setBusy=function(e){v.css("display",e?"block":"none")},this.Initialize=function(){!function(){setBusy(!0),u.setValue(!0),e.Application.contextUrl,_=t("<div id='sideDiv_"+a.windowNo+"' class='vis-archive-left-sidebar vis-leftsidebarouterwrap'>"),A=t("<div id='btnSpaceDiv_"+a.windowNo+"' class='vis-archive-l-s-head'><button id='btnSpace_"+a.windowNo+"' class='vis-archive-sb-t-button'><i class='vis vis-arrow-left'></i></button></div></div>"),m=t("<div class='vis-archive-l-s-content' id='parameterDiv_"+a.windowNo+"'>"),_.append(A).append(m),e.Application.contextUrl,C=t("<button id='btnRefresh_"+a.windowNo+"' style='margin-left: 12px;' class='VIS_Pref_btn-2 vis-frm-button vis-pull-left'><i class='vis vis-refresh'></i></button>"),d=t("<input id='btnCreateCharge_"+a.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' type='button' value='"+e.Msg.getMsg("CreateNew",!1,!1)+"'>"),h=t("<input id='btnCancel_"+a.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' type='button' value='"+e.Msg.getMsg("Cancel",!1,!1)+"'>"),g=t("<input id='btnAccount_"+a.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' type='button' value='"+e.Msg.getMsg("ChargeFromAccount",!1,!1)+"'>");var i=t("<table style='width: 100%;'>"),n=t("<tr>"),l=t("<td style='padding: 0px 10px 0px;'>");m.append(i),n=t("<tr>"),l=t("<td style='padding: 0px 10px 0px;'>");var S=t('<div class="input-group vis-input-wrap">'),I=t('<div class="vis-control-wrap">');i.append(n),n.append(l),l.append(S),S.append(I),I.append(r.getControl().attr("data-placeholder","").attr("placeholder"," ")),I.append(s.getControl().addClass("VIS_Pref_Label_Font")),n=t("<tr>"),l=t("<td style='padding: 0px 10px 0px;'>"),S=t('<div class="input-group vis-input-wrap">'),I=t('<div class="vis-control-wrap">'),i.append(n),n.append(l),l.append(S),S.append(I),I.append(c.getControl().attr("data-placeholder","").attr("placeholder"," ")),I.append(o.getControl().addClass("VIS_Pref_Label_Font")),n=t("<tr>"),l=t("<td style='padding: 0px 10px 0px;'>"),i.append(n),n.append(l),l.append(u.getControl()),D=t("<div class='vis-frm-bot-btn-wrp'>");var y=t("<div class='vis-frm-bttsec'>");y.append(g).append(h),D.append(d).append(C),V=t("<div id='rightSideGridDiv_"+a.windowNo+"' class='vis-frm-grid-wrap'>"),f=t("<div id='gridDiv_"+a.windowNo+"' class='vis-frm-grid-inn'>"),V.append(f),V.append(y),_.append(D),p.append(v),p.append(_).append(V)}(),S=p.find("#btnSpace_"+a.windowNo),null!=h&&h.on(e.Events.onTouchStartOrClick,function(){a.dispose()}),null!=C&&C.on(e.Events.onTouchStartOrClick,function(){r.ctrl.val(""),c.ctrl.val(""),setBusy(!0),N()}),null!=S&&S.on(e.Events.onTouchStartOrClick,function(){var a=0;l?(a=e.Application.isRTL?180:0,d.show(),C.show(),s.getControl().show(),o.getControl().show(),r.getControl().show(),c.getControl().show(),u.getControl().show(),S.animate({borderSpacing:a},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),l=!1,V.animate({width:O},"slow"),m.css("display","block"),_.animate({width:I},"slow",null,function(){n.resize()})):(a=e.Application.isRTL?0:180,d.hide(),C.hide(),s.getControl().hide(),o.getControl().hide(),r.getControl().hide(),c.getControl().hide(),u.getControl().hide(),S.animate({borderSpacing:a},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),l=!0,_.animate({width:y},"slow"),m.css("display","none"),V.animate({width:T},"slow",null,function(){n.resize()}))}),this.sizeChanged=function(e,t){O=t-(I+1),T=t-(y+1),1==l?(_.animate({width:y},"slow"),V.animate({width:T},"slow",null,function(){n.resize()})):(V.animate({width:O},"slow"),_.animate({width:I},"slow",null,function(){n.resize()}))},null!=g&&g.on(e.Events.onTouchStartOrClick,function(){setBusy(!0);var a=[],i=[],l=[];if(n){var s=n.getSelection();if(s)if(s.length<=0)setBusy(!1);else{for(var o=s.toString().split(","),r=0;r<o.length;r++)a[r]=n.get(o[r]).C_ElementValue_ID,i[r]=n.get(o[r]).Name,l[r]=n.get(o[r]).Expense;if(0==a.length)return setBusy(!1),"";!function(a,i,n,l,s){t.ajax({url:e.Application.contextUrl+"VCharge/CreateChargeByList",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({AcctSchemaID:a,TaxCategoryID:i,namepara:n,ElementValuID:l,expense:s}),success:function(t){t.listCreatedP&&e.ADialog.info("ChargeCreated",!0,null),t.listRejectedP&&e.ADialog.info("ChargeNotCreated",!0,null),setBusy(!1)}})}(P,b,i,a,l)}else setBusy(!1)}}),null!=d&&d.on(e.Events.onTouchStartOrClick,function(){setBusy(!0);var i=u.getValue(),n=r.getValue().trim();if(0==n.length)return e.ADialog.warn("SearchKeyMandatory",!0,null),void setBusy(!1);var l=c.getValue().trim();if(0==l.length)return e.ADialog.warn("NameMandatory",!0,null),void setBusy(!1);t.ajax({url:e.Application.contextUrl+"VCharge/CreateElementValue",dataType:"json",data:{m_AD_Org_ID:x,value:n,name:l,expense:i,m_C_Element_ID:w},success:function(n){if(0==n.ID)return a.log.saveError("ChargeNotCreated",n.Msg),e.ADialog.warn(n.Msg,!0,null),void setBusy(!1);!function(a,i,n,l,s){t.ajax({url:e.Application.contextUrl+"VCharge/CreateCharge",dataType:"json",data:{m_C_AcctSchema_ID:a,m_C_TaxCategory_ID:i,name:n,C_ElementValue_ID:l,expense:s},success:function(t){if(0==t.ID)return e.ADialog.info("ChargeNotCreated",!0,null),void setBusy(!1);r.ctrl.val(""),c.ctrl.val(""),t.ID,e.ADialog.info("ChargeCreated",!0,null),N()}})}(P,b,l,n.ID,i)}})})},this.display=function(){setTimeout(N(),5)},this.getRoot=function(){return p},this.refreshUI=function(){n&&n.resize()},this.disposeComponent=function(){h&&h.off(e.Events.onTouchStartOrClick),C&&C.off(e.Events.onTouchStartOrClick),S&&S.off(e.Events.onTouchStartOrClick),g&&g.off(e.Events.onTouchStartOrClick),a.windowNo=null,i=null,n=null,l=null,s=null,o=null,r=null,c=null,u=null,btnCreateCharg=null,g=null,a.log=null,p=null,v=null,_=null,V=null,A=null,m=null,f=null,D=null,h=null,C=null,S=null,I=null,y=null,O=null,T=null,w=null,P=null,b=null,M=null,x=null,a=null,this.getRoot=null,this.disposeComponent=null}}e.Apps.AForms=e.Apps.AForms||{},a.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.Initialize(),this.frame.getContentGrid().append(this.getRoot()),this.display()},a.prototype.refresh=function(){this.refreshUI()},a.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.VCharge=a}(VIS,jQuery)},9192:()=>{VIS=window.VIS||{},function(e){var t=e.Utility.Util;function a(){e.CalloutEngine.call(this,"calloutInvRevaluation")}e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.setAcctDate=function(e,t,a,i,n,l){if(!this.isCalloutActive()&&null!=n&&0!=n)return this.setCalloutActive(!0),"DateDoc"==i.getColumnName()&&a.setValue("DateAcct",a.getValue("DateDoc")),this.setCalloutActive(!1),a=i=n=null,""},a.prototype.AccountingSchema=function(t,a,i,n,l,s){if(!this.isCalloutActive()&&null!=l&&0!=l){this.setCalloutActive(!0);try{var o=e.dataContext.getJSONRecord("MInvRevaluation/GetAccountingSchemaCurrency",i.getValue("C_AcctSchema_ID").toString());i.setValue("C_Currency_ID",o)}catch(e){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=l=null,""}},a.prototype.clearFields=function(e,t,a,i,n,l){if(!this.isCalloutActive()&&null!=n&&0!=n){this.setCalloutActive(!0);try{"CostingLevel"==i.getColumnName()&&"D"!=a.getValue("CostingLevel")&&"W"!=a.getValue("CostingLevel")&&a.setValue("M_Warehouse_ID",null),"RevaluationType"==i.getColumnName()&&"A"==a.getValue("RevaluationType")&&a.setValue("C_Period_ID",null)}catch(e){this.setCalloutActive(!1)}return this.setCalloutActive(!1),a=i=n=null,""}},a.prototype.updateCostAndDiffrences=function(a,i,n,l,s,o){if(!this.isCalloutActive()&&null!=s){this.setCalloutActive(!0);try{var r=e.dataContext.getJSONRecord("MInvRevaluation/GetInvRevaluationDetails",n.getValue("M_InventoryRevaluation_ID").toString());if(null!=r){var c=t.getValueOfInt(r.CostingPrecision);"NewCostPrice"==l.getColumnName()&&(n.setValue("DifferenceValue",(n.getValue("NewCostPrice")-n.getValue("CurrentCostPrice")).toFixed(c)),n.setValue("TotalDifference",(n.getValue("DifferenceValue")*n.getValue("QtyOnHand")).toFixed(c)),n.setValue("CurrentTotalValue",(n.getValue("CurrentCostPrice")*n.getValue("QtyOnHand")).toFixed(c)),n.setValue("RevaluedTotalValue",(n.getValue("NewCostPrice")*n.getValue("QtyOnHand")).toFixed(c)))}}catch(e){this.setCalloutActive(!1)}return this.setCalloutActive(!1),n=l=s=null,""}},e.calloutInvRevaluation=a}(VIS,jQuery)},9383:()=>{VAS=window.VAS||{},function(e,t){e.VAS_LowestPrMonthlySalesWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a,i,n=this,l=(this.ctx,t('<div class="h-100 w-100">')),s=null,o="",r=0,c=0,u="";var d,g=[];this.currentPage=1,this.totalPages=0;var p=0;function v(){l.find("#VAS_PageCount_"+p).text(n.currentPage+VIS.Msg.getMsg("VAS_Of")+n.totalPages);var e=g[n.currentPage-1],t=parseFloat(e.PreviousTotal),a=parseFloat(e.CurrentTotal),o=function(e,t){if(0===t)return e>0?"100%":"0%";var a=e-t,i=a/t*100;return i.toFixed(2)+"%"}(a,t);l.find("#VAS_ProductRank_"+p).text("#"+n.currentPage),l.find("#VAS_ProductName_"+p).text(e.ProductName),l.find("#VAS_LastYearSales_"+p).text(u+" "+V(t)+" "+s),l.find("#VAS_CurrentSales_"+p).text(u+" "+ +V(a)+" "+s),l.find(".repfix-resultTxt").text(o);var c=l.find(".VAS-graph-result .vis");o.startsWith("-")?c.removeClass("vis-trending-up").addClass("vis-trending-down"):c.removeClass("vis-trending-down").addClass("vis-trending-up"),r>0&&i.setValue(r)}function _(e){t.ajax({url:VIS.Application.contextUrl+"Product/GetProductMonthlySalesData",data:{ProductID:e,OrganizationUnit:r},dataType:"json",success:function(e){A(JSON.parse(e)),v()},error:function(e,t,a){console.error("Failed to fetch product data:",t,a)}})}function V(e){return e>=1e12?(s=VIS.Msg.getMsg("VAS_Trillion"),(e/1e12).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e9?(s=VIS.Msg.getMsg("VAS_Billion"),(e/1e9).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e6?(s=VIS.Msg.getMsg("VAS_Million"),(e/1e6).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e3?(s=VIS.Msg.getMsg("VAS_Thousand"),(e/1e3).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):(s="",e.toLocaleString(window.navigator.language,{minimumFractionDigits:c,maximumFractionDigits:c}))}function A(e){const a=e.map(e=>e.month),i=e.map(e=>e.cy_month_sales),n=e.map(e=>e.ly_month_sales),s={labels:a,datasets:[{label:VIS.Msg.getMsg("VAS_CurrentYearSales"),data:i,fill:!1,borderColor:"rgb(75, 192, 192)",tension:.1,datalabels:{backgroundColor:"rgba(75, 192, 192, 0.2)",borderRadius:3,padding:6,font:{weight:"bold",size:12},align:"center",anchor:"end"}},{label:VIS.Msg.getMsg("VAS_LastYearSales"),data:n,fill:!1,borderColor:"rgb(255, 99, 132)",tension:.1,datalabels:{backgroundColor:"rgba(255, 99, 132, 0.2)",borderRadius:3,padding:6,font:{weight:"bold",size:12},align:"center",anchor:"end"}}]},o={type:"line",data:s,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},datalabels:{display:!0}}},plugins:[ChartDataLabels]};if(d)d.data=s,d.update();else{l.find("canvas").remove();const e=t("<canvas></canvas>");l.find(".VAS-chart-container").append(e);const a=e[0].getContext("2d");d=new Chart(a,o)}}this.initalize=function(){p=this.widgetInfo.AD_UserHomeWidgetID,e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),l.append(e);var i=function(e){var i=(new Date).getFullYear(),n=i-1,l=t('<div class="VAS-org-lowest-unitsales-col VAS-content-container vis-formouterwrpdiv"><div class="VAS-sales-heading">'+VIS.Msg.getMsg("VAS_LowestSellingProduct")+'</div><div class="VAS-organization-block"><div id="VAS_Org_'+e+'" class="VAS_OrgUnitControl"></div><div class="VAS-pagination-container"></div></div><div class="VAS-graph-details"><div class="VAS-salesGraph-heading"><span id="VAS_ProductRank_'+e+'">#1</span>&nbsp<span id="VAS_ProductName_'+e+'"> Product Name</span></div><div class="VAS-totalSales-col"><div class="VAS-startSale-box"><div class="VAS-yearTxt"><span>'+n+'<span></div><div class="VAS-totalSale"><span id="VAS_LastYearSales_'+e+'">520 €</span></div></div><div class="VAS-endSale-box"><div class="VAS-yearSale-col"><div class="VAS-yearTxt"><span>'+i+'<span></div><div class="VAS-totalSale"><span id="VAS_CurrentSales_'+e+'">520 €</span></div></div><div class="VAS-graph-result"><span class="vis vis-trending-down"></span><div class="repfix-resultTxt">-10.32%</div></div></div></div><div class="VAS-graph-col VAS-chart-container" style="display: flex; align-items: center; justify-content: center;"></div></div>');return a=l.find("#VAS_Org_"+e),l}(p);l.append(i)},this.intialLoad=function(){t.ajax({url:VIS.Application.contextUrl+"Product/GetProductSalesAndDetails",data:{OrganizationUnit:r,Type:"ASC"},dataType:"json",success:function(s){if(s=JSON.parse(s)){if(g=s.products,n.totalPages=g.length,u=s.Symbol,c=s.StdPrecision,function(){var e=l.find(".VAS-pagination-container");if(e.empty(),g.length>0){n.totalPages=g.length;var a=t('<div class="VAS-pagination-col"><div class="VAS-arrow-col"><a href="#" id="VAS_Prev_Page_'+p+'"><span class="fa fa-arrow-left"></span></a><a href="#" id="VAS_Next_Page_'+p+'"><span class="fa fa-arrow-right"></span></a></div><div class="VAS-page-count"><span id="VAS_PageCount_'+p+'">1 of '+n.totalPages+"</span></div></div>");a.find("#VAS_Prev_Page_"+p).on("click",function(e){e.preventDefault(),n.currentPage>1&&(n.currentPage--,_(g[n.currentPage-1].Product_ID))}),a.find("#VAS_Next_Page_"+p).on("click",function(e){e.preventDefault(),n.currentPage<n.totalPages&&(n.currentPage++,_(g[n.currentPage-1].Product_ID))}),e.append(a)}}(),g.length>0){g[0];A(s.product_monthly_sales)}o=s.sqlWhereForLookup,a.empty(),orgDivInputWrap=t('<div class="input-group vis-input-wrap">'),$lookupOrg=VIS.MLookupFactory.get(VIS.Env.getCtx(),n.windowNo,0,VIS.DisplayType.Search,"AD_Org_ID",0,!1,o),i=new VIS.Controls.VTextBoxButton("AD_Org_ID",!1,!1,!0,VIS.DisplayType.Search,$lookupOrg),$orgControlWrap=t('<div class="vis-control-wrap">'),orgDivInputWrap.append($orgControlWrap),$orgControlWrap.append(i.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+VIS.Msg.getMsg("VAS_OrgUnit")+'</label><span class= "vis-ev-ctrlinfowrap"</span>'),a.append(orgDivInputWrap),i.fireValueChanged=function(){r=null==i.getValue()?0:i.getValue(),n.intialLoad()},v(),l.find(".VAS-graph-details").show(),l.find(".VAS-pagination-container").show(),e[0].style.visibility="hidden"}else g=[],l.find(".VAS-graph-details").hide(),l.find(".VAS-pagination-container").hide(),e[0].style.visibility="hidden"},error:function(t,a,i){console.error("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})},this.getRoot=function(){return l},this.refreshWidget=function(){d=null,n.currentPage=1,n.totalPages=0,n.intialLoad()}},e.VAS_LowestPrMonthlySalesWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad()},50)},e.VAS_LowestPrMonthlySalesWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_LowestPrMonthlySalesWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_LowestPrMonthlySalesWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$contentContainer=null}}(VAS,jQuery)},9397:()=>{!function(e,t){function a(){this.frame,this.windowNo;var a=this,i=t("<div style='height:100%;background-color:white;' class='vis-forms-container' >"),n=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),l=e.Env.getCtx(),s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=null,_=null;function V(e){n[0].style.visibility=e?"visible":"hidden"}this.Initialize=function(){V(!0),function(){s=t('<div class="vis-gl-main-wrap">');var V=e.context.getWindowContext(a.windowNo,"AD_Column_ID",!0);if(""==V)return e.ADialog.error("VIS_DimensionColNotSelected",!0,"",""),!1;var A=e.dataContext.getJSONRecord("GlJournall/ColumnName",V);o=t('<div class="vis-gl-form-wrap">'),r=t('<div class="vis-gl-form-row">'),c=t('<div class="vis-gl-form-col">'),u=t("<label>"+e.Msg.translate(l,A)+"</label>"),c.append(u),$formDataR=t('<div class="vis-gl-form-col2">');var m=e.MLookupFactory.getMLookUp(l,a.windowNo,e.Utility.Util.getValueOfString(V),e.DisplayType.Search);d=new e.Controls.VTextBoxButton(A,!1,!1,!0,e.DisplayType.Search,m),$formDataR.append(t("<div>").append(d).append(d.getControl()).append(d.getBtn(0))),r.append(c).append($formDataR),o.append(r),g=t('<div class="VIS_buttons-wrap .vis-gl-buttons-wrap">'),p=t('<div class="pull-right">'),v=t('<span class="btn vis-gl-buttons-wrap-span">'+e.Msg.translate(l,"VIS_OK")+"</span>"),_=t('<span class="btn vis-gl-buttons-wrap-span">'+e.Msg.translate(l,"Cancel")+"</span>"),p.append(v).append(_),g.append(p),s.append(o).append(g),i.append(s).append(n)}(),function(){var t=e.context.getWindowContextAsInt(a.windowNo,"DimensionValue",!0);t>0&&d.setValue(t);v.on("click",function(){if(V(!0),null==d.getValue())return V(!1),e.ADialog.error("VIS_DimensionNotSelected",!0,"",""),!1;var t=e.context.getWindowContext(a.windowNo,"GL_LineDimension_ID",!0).toString().concat(",",d.getValue().toString());if(e.dataContext.getJSONRecord("GlJournall/SaveDimensionReference",t)<=0)return V(!1),e.ADialog.error("VIS_NotSaved",!0,"",""),!1;e.ADialog.info("VIS_Saved",!0,"",""),V(!1),a.frame.close()}),_.on("click",function(){a.frame.close()})}(),V(!1)},this.setHeight=function(){return 235},this.setWidth=function(){return 368},this.getRoot=function(){return i},this.disposeComponent=function(){a=null,i=null,n=null,s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=null,_=null}}e.AForms=e.AForms||{},a.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.Initialize(),this.frame.getContentGrid().append(this.getRoot())},a.prototype.dispose=function(){this.disposeComponent(),this.frame=null},e.AForms.glDimensionValue=a}(VIS,jQuery)},9459:()=>{VAS=window.VAS||{},function(e,t){e.VAS_ExpectedTransferWidget=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,n=t('<div class="h-100 w-100">');this.currentPage=1,this.totalPages=0;var l=0,s={},o=[];this.initalize=function(){l=this.widgetInfo.AD_UserHomeWidgetID,e=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),n.append(e);var a='<div id="VAS_TransferContainer_'+l+'" class="VAS-deliveries-container"><div class="VAS-deliveries-heading"><h6>'+VIS.Msg.getMsg("VAS_ExpectedTransfers")+'</h6></div><div class="VAS-delivery-count"><div class="VAS-count-lbl">'+VIS.Msg.getMsg("VAS_Transfers")+' <span id="VAS_TransferCount_'+l+'">0</span></div></div><div class="VAS-delivery-detail"><div class="VAS-box-heading"></div></div><div class="VAS-height-container"><div id="VAS_TransferBox_'+l+'" class="VAS-deliveries-listing"></div><div id="VAS_ProductDetail_'+l+'" class="VAS-deliveries-listing"></div></div><div class="VAS-pagination-container"></div></div>';n.append(a)},this.intialLoad=function(r){e.css("visibility","visible"),n.find("#VAS_ProductContainer_"+l).remove(),n.find("#VAS_TransferContainer_"+l).show(),VIS.dataContext.getJSONData(VIS.Application.contextUrl+"Product/GetExpectedTransfer",{pageNo:r,pageSize:5,Type:"ET"},function(c){if(n.find("#VAS_TransferBox_"+l).empty(),n.find("#VAS_ReqContainer"+l).remove,null!=c&&null!=c.Requisitions&&c.Requisitions.length>0){for(i=0;i<c.Requisitions.length;i++){var u='<div id="VAS_ReqContainer'+l+'" class="VAS-delivery-box" ><div class="VAS-box-heading"><div class="VAS-icon-w-name"><i class="fa fa-file-text" aria-hidden="true"></i><div id="VAS_DocumentNo_'+l+'" class="VAS-doc-no VAS-pointer-cursor" title="'+VIS.Msg.getMsg("DocumentNo")+'" data-doc-no="'+c.Requisitions[i].DocumentNo+'" data-customer-name="'+c.Requisitions[i].Employee+'" data-reqid="'+c.Requisitions[i].M_Requisition_ID+'">'+c.Requisitions[i].DocumentNo+'</div></div><div class="VAS-total-items-count" title="'+VIS.Msg.getMsg("VAS_NoOfLines")+'">'+c.Requisitions[i].LineCount+'</div></div><div class="VAS-spaceBetween-col"></div><div class="VAS-spaceBetween-col grid-2-col"><div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Destination")+'">'+c.Requisitions[i].Destination+'</div><div class="VAS-lbl-text text-right" title="'+VIS.Msg.getMsg("VAS_Source")+'">'+c.Requisitions[i].Source+'</div></div><div class="VAS-spaceBetween-col"><div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("TotalAmount")+'"><span>'+c.Requisitions[i].Symbol+"</span> "+c.Requisitions[i].GrandTotal.toLocaleString()+"</div></div></div>";n.find("#VAS_TransferBox_"+l).append(u)}s=[],c.Requisitions.forEach(function(e){e.ReqLines&&e.ReqLines.length>0&&(s[e.DocumentNo]=e.ReqLines)}),1==r&&(n.find("#VAS_TransferCount_"+l).text(c.RecordCount),function(e){var i=n.find(".VAS-pagination-container");i.empty(),a.totalPages=Math.ceil(e/5);var s=t('<div class="VAS-slider-arrows VAS-orders-text-white">        <i id="VAS_Prev_Page_'+l+'" class="fa fa-arrow-circle-left" aria-hidden="true"></i>        <span id="VAS_PaginationText_'+l+'">'+a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages+'</span>        <i id="VAS_Next_Page_'+l+'" class="fa fa-arrow-circle-right" aria-hidden="true"></i>    </div>');s.find("#VAS_Prev_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage>1&&(a.currentPage--,a.intialLoad(a.currentPage))}),s.find("#VAS_Next_Page_"+l).on("click",function(e){e.preventDefault(),a.currentPage<a.totalPages&&(a.currentPage++,a.intialLoad(a.currentPage))}),i.append(s)}(c.RecordCount)),n.find("#VAS_PaginationText_"+l).text(a.currentPage+VIS.Msg.getMsg("VAS_Of")+a.totalPages),n.off("click","#VAS_DocumentNo_"+l),n.on("click","#VAS_DocumentNo_"+l,function(){var i=t(this).data("doc-no");t(this).data("customer-name");!function(i,r,c){n.find("#VAS_TransferContainer_"+l).hide(),n.find("#VAS_ProductContainer_"+l).remove(),o=[];var u='<div id="VAS_ProductContainer_'+l+'" class="VAS-deliveries-container"><span class="VAS-info-span" style="display:none;" id="VAS_spnErrorMessage_'+l+'"></span>    <div class="VAS-deliveries-heading">        <h6>            <span id="VAS_BackToTransfer_'+l+'" class="vis vis-arrow-left VAS-pointer-cursor"></span>            '+VIS.Msg.getMsg("VAS_BackToTransfer")+'        </h6><span id="VAS_GenerateTransfer_'+l+'" class="VAS-generate-delivery-btn" data-reqid="'+c+'" title="'+VIS.Msg.getMsg("VAS_GenMaterialTransfer")+'"><i class="fa fa-truck" aria-hidden="true"></i></span>    </div>    <div class="VAS-delivery-count">    </div>    <div class="VAS-delivery-detail">        <div class="VAS-box-heading VAS-orders-text-white">            <div class="VAS-expected-col">                <div class="VAS-icon-w-name">                    <i class="fa fa-file-text VAS-orders-text-white" aria-hidden="true"></i>                    <div class="VAS-doc-no VAS-orders-text-white" title="'+VIS.Msg.getMsg("Document_No")+'">'+i+'</div>                </div>            </div>            <div class="VAS-dty-prod">                <div class="VAS-qtyProd-text">'+VIS.Msg.getMsg("VAS_NoOfLines")+'</div>                <div class="VAS-total-items-count VAS-orders-text-white"><span id="VAS_TotalQty_'+l+'"></span></div>            </div>        </div>    </div>    <div id="VAS_ProductDiv_'+l+'" class="VAS-height-container">        <div id="VAS_OrderLine_'+l+'" class="VAS-deliveries-listing"></div></div><div id="VAS_OrderLinePagination_'+l+'" class="VAS-pagination-container"></div>';n.append(u);var d=s[i]||[],g=6,p=Math.ceil(d.length/g),v=1;function _(e){e<1&&(e=1),e>p&&(e=p);var t=((v=e)-1)*g,a=Math.min(t+g,d.length);n.find("#VAS_OrderLine_"+l).empty();for(var i=t;i<a;i++){var s,r=d[i],c=o.includes(r.C_OrderLine_ID),u=r.OnHandQty>0&&r.OnHandQty>=r.QtyOrdered,_=u?"VAS-delivery-box":"VAS-delivery-box no-stock";s=r.OnHandQty>=r.QtyOrdered?"badge-green":r.OnHandQty<r.QtyOrdered&&r.OnHandQty>0?"badge-orange":"badge-red",n.find("#VAS_OrderLine_"+l).append('            <div class="'+_+'">                <div class="VAS-box-heading">                    <div class="VAS-icon-w-name">                        <input type="checkbox" class="VAS-selection-checkbox" data-reqlineid="'+r.M_RequisitionLine_ID+'"'+(c?" checked":"")+(u?"":" disabled")+'/>                         <i class="fa fa-file-text" aria-hidden="true"></i>                        <div class="VAS-doc-no" title="'+VIS.Msg.getMsg("VAS_Product")+'">'+r.ProductName+'</div>                    </div>                    <div class="VAS-total-items-count">                    <span title = "'+VIS.Msg.getMsg("VAS_RemianingQty")+'" class="badge badge-light '+s+'"> '+r.QtyEntered+'</span ></div >                       </div>                <div class="VAS-spaceBetween-col">                    <div class="VAS-lbl-text" title="'+VIS.Msg.getMsg("VAS_Attribute")+'">'+r.AttributeName+'</div>                    <div class="vas-lbl-text" title="'+VIS.Msg.getMsg("VAS_Uom")+'"> '+r.UOM+"</div>                </div>            </div>")}n.find("#VAS_TotalQty_"+l).text(d.length),n.find("#VAS_OrderLinePagination_"+l).empty(),n.find("#VAS_OrderLinePagination_"+l).append('        <div class="VAS-slider-arrows-order-details VAS-orders-text-white">            <i class="fa fa-arrow-circle-left" aria-hidden="true" id="VAS_PreviousPage_'+l+'"></i>            <span>'+v+VIS.Msg.getMsg("VAS_Of")+p+'</span>            <i class="fa fa-arrow-circle-right" aria-hidden="true" id="VAS_NextPage_'+l+'"></i>        </div>')}d.length>0&&_(v);n.off("change",".VAS-selection-checkbox"),n.off("click","#VAS_PreviousPage_"+l),n.off("click","#VAS_NextPage_"+l),n.off("click","#VAS_BackToTransfer_"+l),n.off("click","#VAS_GenerateTransfer_"+l),n.on("click","#VAS_PreviousPage_"+l,function(){_(v-1)}),n.on("click","#VAS_NextPage_"+l,function(){_(v+1)}),n.on("click","#VAS_BackToTransfer_"+l,function(){n.find("#VAS_TransferContainer_"+l).show(),n.find("#VAS_ProductContainer_"+l).remove(),n.find(".VAS-error-message").remove()}),n.on("change",".VAS-selection-checkbox",function(){var e=t(this).data("reqlineid");t(this).is(":checked")?o.includes(e)||o.push(e):o=o.filter(t=>t!==e),o.length>0?n.find("#VAS_GenerateTransfer_"+l).show():n.find("#VAS_GenerateTransfer_"+l).hide()}),n.on("click","#VAS_GenerateTransfer_"+l,function(){!function(i){e.css("visibility","visible");var s=o.join(",");t.ajax({url:VIS.Application.contextUrl+"Product/CreateMaterialTransfer",data:{M_Requisition_ID:i,M_RequisitionLines_IDs:s},dataType:"json",success:function(t){if((t=JSON.parse(t)).Movement_ID>0)try{var i={TabWhereClause:"M_Movement.M_Movement_ID="+t.Movement_ID,TabLayout:"Y",TabIndex:"0"};a.widgetFirevalueChanged(i),a.currentPage=1,a.intialLoad(a.currentPage)}catch(e){console.log(e)}else{var s=n.find("#VAS_spnErrorMessage_"+l),o="";o=null!=t.message&&""!=t.message?t.message:VIS.Msg.getMsg("VAS_TransferNotGenerated"),s.text(o),s.fadeIn(),s.fadeOut(5e3)}e.css("visibility","hidden")},error:function(t,a,i){console.log("Failed to fetch data:",a,i),e[0].style.visibility="hidden"}})}(t(this).data("reqid"))}),n.find("#VAS_GenerateTransfer_"+l).hide()}(i,0,t(this).data("reqid"))})}e.css("visibility","hidden")})},this.getRoot=function(){return n},this.refreshWidget=function(){chartInstance=null,a.currentPage=1,a.totalPages=0,a.intialLoad(a.currentPage)}},e.VAS_ExpectedTransferWidget.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.VAS_ExpectedTransferWidget.prototype.addChangeListener=function(e){this.listener=e},e.VAS_ExpectedTransferWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad(1)},50)},e.VAS_ExpectedTransferWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_ExpectedTransferWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_ExpectedTransferWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},9463:()=>{!function(e,t){function a(){this.frame=null,this.windowNo=0;var a,i,n,l,s,o,r=e.Env.getCtx(),c=this,u=t('<div class="vis-allocate-root vis-forms-container">'),d=t('<div class="vis-leftpanel-wrapper vis-pad-0 vis-leftsidebarouterwrap">'),g=t('<div class="vis-leftpanel-inn-wrap">'),p=t('<div class="vis-allocation-rightContainer vis-formouterwrpdiv">'),v=t('<div class="vis-allocate-paymentdiv" >'),_=t('<div class="vis-allocate-cashdiv" >'),V=t('<div class="vis-allocate-invoicediv" >'),A=t('<div class="vis-allocate-gldiv" style = "height:49%" >'),m=t("<div >"),f=null,D=null,h=null,C=null,S=null,I=t('<select class="vis-allocation-currencycmb" ></select>'),y=null,O=t('<select class="sel-allocation"></select>'),T=t('<select class="sel-allocation"></select>'),w=t('<select class="sel-allocation"></select>'),P=t('<select class="sel-allocation"></select>'),b=t('<select class="sel-allocation"></select>'),M=null,x=t('<input class="date-allocation" type="date" max="9999-12-31"></input>'),N=t('<input class="date-allocation" type="date" max="9999-12-31"></input>'),L=t('<input class="date-allocation" type="date" max="9999-12-31"></input>'),R=t('<input class="date-allocation" type="date" max="9999-12-31"></input>'),U=t('<input class="date-allocation" type="date" max="9999-12-31"></input>'),E=t('<input class="date-allocation" type="date" max="9999-12-31"></input>'),k=t('<input class="date-allocation" type="date" max="9999-12-31"></input>'),G=t('<input class="date-allocation" type="date" max="9999-12-31"></input>'),B=(t('<input value = "" placeholder = "Search..." type = "text" id = _SrchTxtbx_"'+c.windowNo+">"),null),F=null,Q=null,$=null,W=null,J=t('<select class="vis-allocation-currencycmb" ></select>'),j=t('<select class="vis-allocation-currencycmb" ></select>'),z=null,q=null,Y=null,H=null,K=0,Z=null,X=!0,ee=!1,te=0,ae=0,ie=[],ne=null,le=null,se=null,oe=null,re=null,ce=null,ue=null,de=null,ge=null,pe=null,ve=null,_e=!1,Ve=!1,Ae=null,me=null,fe="",De=null,he=null,Ce=0,Se=0,Ie=10,ye=8,Oe=null,Te=7,we=8,Pe=9,be=8,Me=12,xe=null,Ne=null,Le=null,Re=0,Ue=0,Ee=0,ke=null,Ge=null,Be=null,Fe=null,Qe=null,$e=null,We=null,Je=null,je=[],ze=0,qe=null,Ye=[],He=0,Ke=null,Ze=[],Xe=0,et=null,tt=[],at=0,it=null,nt=!1,lt=!1,st=!1,ot=!1,rt=null,ct=null,ut=null,dt=null,gt=null,pt=this,vt=!0,_t=!1,Vt=0,At=0,mt=e.DisplayType.GetNumberFormat(e.DisplayType.Amount),ft=e.Env.isDecimalPoint(),Dt=50,ht=1,Ct=1,St=0,It=1,yt=1,Ot=0,Tt=1,wt=1,Pt=0,bt=1,Mt=1,xt=0,Nt=!1,Lt=!1,Rt=!1,Ut=!1,Et=0,kt=[],Gt=!0,Bt=new e.CultureSeparator,Ft=e.Application.contextUrl+"JsonData/JDataSetWithCode",Qt=function(a,i,n){var l=!!n,s=null;return function(e,a,i){var n=null;t.ajax({url:Ft,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:a,data:JSON.stringify(e)}).done(function(e){n=e,i&&i(e)})}({sql:a,page:1,pageSize:0},l,function(t){a=(new e.DB.DataSet).toJson(t);var a=(new e.DB.DataSet).toJson(t);s=a.getTable(0).getRows().length>0?a.getTable(0).getRow(0).getCell(0):null,a.dispose(),a=null,l&&n(s)}),s};function $t(){w.val(0),P.val(0),b.val(0),T.val(0),O.val(0),C.setValue(null),S.setValue(null),x.val(""),N.val(""),L.val(""),R.val(""),U.val(""),E.val(""),k.val(""),G.val(""),ke.val(""),Ge.val(""),Fe.val(""),Be.val(""),Ye=[],tt=[],Ze=[],je=[],Ae.val(Globalize.format(new Date,"yyyy-MM-dd")),ya()}function Wt(e){"P"==e?ne&&ne.refresh():"C"==e?le&&le.refresh():"I"==e?se&&se.refresh():"G"==e&&Z&&Z.refresh()}function Jt(e,t){v.css("display","none"),_.css("display","none"),V.css("display","none"),A.css("display","none"),vt=!0,_t=!0,X=!0,"P"==e?(_t=!1,v.css("display","block"),ne&&ne.clear()):"C"==e?(vt=!1,_.css("display","block"),le&&le.clear()):"I"==e?(V.css("display","block"),se&&se.clear()):"G"==e&&(A.css("display","block"),X=!1,Z&&Z.clear()),"P"==t?(_t=!1,v.css("display","block"),ne&&ne.clear()):"C"==t?(vt=!1,_.css("display","block"),le&&le.clear()):"I"==t?(V.css("display","block"),se&&se.clear()):"G"==t&&(A.css("display","block"),X=!1,Z&&Z.clear())}function jt(e){if(null!=se){for(var a=t("#grid_"+se.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<a.length;i++){t(a[i]).prop("checked",!1),se.editChange.call(se,a[i],i,0,e);var n={type:"click",phase:"before",target:"grid",recid:i,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};se.trigger(n)}tt=[]}}function zt(e){return e?"#FFB6C1":"White"}function qt(){if(Ce>0){if(AD_Org_ID=f.val(),0==(Se=I.val()))return e.ADialog.info("Message",!0,"select currency","");if(i=x.val(),""!=(n=N.val())&&i>n)return N.val(""),e.ADialog.info("Message",!0,e.Msg.getMsg("VIS_FromDateGreater"),"");gt[0].style.visibility="visible",ht=1,Ct=1,St=0,Rt=!1,Et=0;var o=de.is(":checked"),r=null;r=null!=(Oe=me.val())&&null!=Oe&&""!=Oe?e.DB.to_date(Oe):e.DB.to_date(new Date),l=a.val(),s=O.val(),docBaseType=P.val(),M=e.Utility.Util.getValueOfInt(C.getValue()),srchText=Ge.val(),null!=i&&null!=i&&""!=i&&e.DB.to_date(i),null!=n&&null!=n&&""!=n&&e.DB.to_date(n),t.ajax({url:e.Application.contextUrl+"PaymentAllocation/GetInvoice",data:{AD_Org_ID,_C_Currency_ID:Se,_C_BPartner_ID:Ce,isInterBPartner:_e,chk:o,date:r,page:ht,size:Dt,docNo:l,c_docType_ID:s,docBaseType,PaymentMethod_ID:M,fromDate:i,toDate:n,conversionDate:fe,srchText,isInterComp:Ve,conversionType_ID:h.getValue()},async:!0,success:function(e){var t=JSON.parse(e);if(t){if(1==ht&&t.length>0&&(St=t[0].InvoiceRecord,Ct=Math.ceil(St/Dt)),tt.length>0){at=tt.length;for(var a=0;a<t.length;a++){0==tt.filter(function(e){return e.C_InvoicePaySchedule_ID==t[a].C_InvoicePaySchedule_ID}).length&&(t[a].recid=tt.length+a,tt.push(t[a]))}t=tt,tt=[]}ca(t,o),Pe=9,be=10,Me=14,$.find("#grid_openformatgridinvoice_"+c.windowNo+"_records").on("scroll",ia),Rt=!0,Xt()}},error:function(e){gt[0].style.visibility="hidden"}})}}function Yt(){if(0!=Ce&&0!=Se){D.getControl().removeClass("vis-ev-col-mandatory"),gt[0].style.visibility="visible",ht=1,Ct=1,St=0,It=1,yt=1,Ot=0,Tt=1,wt=1,Pt=0,bt=1,Mt=1,xt=0,1==ot?ot=!1:(Nt=!1,Lt=!1,Rt=!1,Ut=!1),Et=0;null!=(Oe=me.val())&&null!=Oe&&""!=Oe?e.DB.to_date(Oe):e.DB.to_date(new Date);de.is(":checked"),r.getAD_Role_ID(),r.getAD_User_ID(),e.MRole.getDefault();Ht(),Kt(),qt(),ya(),J.val("P"),J.trigger("change"),j.val("P"),j.trigger("change"),0==J.val()&&0==J.val()?ba():Jt(J.val(),j.val())}}function Ht(){if(AD_Org_ID=f.val(),Se=I.val(),0!=Ce&&0!=Se){if(i=L.val(),""!=(n=R.val())&&i>n)return R.val(""),e.ADialog.info("Message",!0,e.Msg.getMsg("VIS_FromDateGreater"),"");Tt=1,wt=1,Pt=0,Nt=!1;var a=de.is(":checked");s=T.val(),docBaseType=b.val(),M=e.Utility.Util.getValueOfInt(S.getValue()),srchText=ke.val(),gt[0].style.visibility="visible",null!=i&&null!=i&&""!=i&&e.DB.to_date(i),null!=n&&null!=n&&""!=n&&e.DB.to_date(n),t.ajax({url:e.Application.contextUrl+"PaymentAllocation/GetPayments",data:{AD_Org_ID,_C_Currency_ID:Se,_C_BPartner_ID:Ce,isInterBPartner:_e,chk:a,page:Tt,size:Dt,c_docType_ID:s,docBaseType,PaymentMethod_ID:M,fromDate:i,toDate:n,srchText,isInterComp:Ve},async:!0,success:function(e){var t=JSON.parse(e);if(t){if(1==Tt&&t.length>0&&(Pt=t[0].PaymentRecord,wt=Math.ceil(Pt/Dt)),Ze.length>0){Xe=Ze.length;for(var i=0;i<t.length;i++){0==Ze.filter(function(e){return e.CpaymentID==t[i].CpaymentID}).length&&(t[i].recid=Ze.length+i,Ze.push(t[i]))}t=Ze,Ze=[]}la(t,a),F.find("#grid_openformatgrid_"+c.windowNo+"_records").on("scroll",ta),Nt=!0,Xt()}},error:function(e){gt[0].style.visibility="hidden"}})}}function Kt(){if(Se=I.val(),0!=Ce&&0!=Se){if(It=1,yt=1,Ot=0,Lt=!1,AD_Org_ID=f.val(),i=U.val(),n=E.val(),paymentType=w.val(),srchText=Be.val(),""!=n&&i>n)return E.val(""),e.ADialog.info("Message",!0,e.Msg.getMsg("VIS_FromDateGreater"),"");var a=de.is(":checked");null!=i&&null!=i&&""!=i&&e.DB.to_date(i),null!=n&&null!=n&&""!=n&&e.DB.to_date(n),gt[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"PaymentAllocation/GetCashJounral",data:{AD_Org_ID,_C_Currency_ID:Se,_C_BPartner_ID:Ce,isInterBPartner:_e,chk:a,page:It,size:Dt,fromDate:i,toDate:n,paymentType_ID:paymentType,srchText,isInterComp:Ve},async:!0,success:function(e){var t=JSON.parse(e);if(t){if(1==It&&t.length>0&&(Ot=t[0].CashRecord,yt=Math.ceil(Ot/Dt)),Ye.length>0){He=Ye.length;for(var i=0;i<t.length;i++){0==Ye.filter(function(e){return e.CcashlineiID==t[i].CcashlineiID}).length&&(t[i].recid=Ye.length+i,Ye.push(t[i]))}t=Ye,Ye=[]}sa(t,a),Q.find("#grid_openformatgridcash_"+c.windowNo+"_records").on("scroll",aa),Lt=!0,Xt()}},error:function(e){gt[0].style.visibility="hidden"}})}}function Zt(){t.ajax({url:e.Application.contextUrl+"PaymentAllocation/GetCurrencyPrecision",data:{_C_Currency_ID:Se},async:!0,success:function(e){var t=JSON.parse(e);t&&(At=t)},error:function(e){}})}function Xt(){gt[0].style.visibility=1==Nt&&1==Lt&&1==Rt&&1==Ut?"hidden":"visible"}function ea(){t(this).scrollTop()>0&&(gt[0].style.visibility="visible",t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&bt<Mt&&function(a,l){var s=de.is(":checked");if(0==(Se=I.val()))return e.ADialog.info("Message",!0,"select currency","");null!=(Oe=me.val())&&null!=Oe&&""!=Oe?e.DB.to_date(Oe):e.DB.to_date(new Date);null!=i&&null!=i&&""!=i&&e.DB.to_date(i);null!=n&&null!=n&&""!=n&&e.DB.to_date(n);t.ajax({url:e.Application.contextUrl+"VIS/PaymentAllocation/GetGLData",dataType:"json",data:{AD_Org_ID,_C_Currency_ID:Se,_C_BPartner_ID:Ce,page:a,size:l,fromDate:i,toDate:n,srchText,chk:s,isInterComp:Ve},async:!0,success:function(a){var i=JSON.parse(a);if(i){if(je.length>0){ze=je.length;for(var n=0;n<i.length;n++){0==je.filter(function(e){return e.GL_JOURNALLINE_ID==i[n].GL_JOURNALLINE_ID}).length&&(i[n].recid=je.length+n,je.push(i[n]))}i=je,je=[]}!function(a){var i=[],n=[];a.length>0&&(n=Object.keys(a[0]));var l=0;Z.records.length>0&&(l=Z.records.length);for(var s=0;s<a.length;s++){var o={};o.recid=l+s;for(var r=0;r<n.length;r++){var u=n[r];o[u]="SelectRow"!=u&&e.Utility.encodeText(a[s][u])}i.push(o)}if(w2utils.encodeTags(i),Z.add(i),ze>0)for(var d=0;d<ze;d++){var g=t("#grid_"+Z.name+'_records td[col="0"]').find('input[type="checkbox"]');t(g[d]).prop("checked",!0),Z.editChange.call(Z,g[d],d,0,event);var p={type:"click",phase:"before",target:"grid",recid:d,index:d,isStopped:!1,"isCan//celled":!1,onComplete:null};Z.trigger(p)}ze=0,i=[],n=[],W.find("#grid_openformatglgrid_"+c.windowNo+"_records").on("scroll",ea)}(i)}},error:function(e){}})}(++bt,Dt),gt[0].style.visibility="hidden")}function ta(){t(this).scrollTop()>0&&(gt[0].style.visibility="visible",t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&Tt<wt&&function(a,l){if(0==(Se=I.val()))return e.ADialog.info("Message",!0,"select currency","");var o=de.is(":checked");null!=(Oe=me.val())&&null!=Oe&&""!=Oe?e.DB.to_date(Oe):e.DB.to_date(new Date);s=T.val(),docBaseType=b.val(),M=e.Utility.Util.getValueOfInt(S.getValue()),srchText=ke.val(),null!=i&&null!=i&&""!=i&&e.DB.to_date(i);null!=n&&null!=n&&""!=n&&e.DB.to_date(n);t.ajax({url:e.Application.contextUrl+"PaymentAllocation/GetPayments",data:{AD_Org_ID,_C_Currency_ID:Se,_C_BPartner_ID:Ce,isInterBPartner:_e,chk:o,page:a,size:l,c_docType_ID:s,docBaseType,PaymentMethod_ID:M,fromDate:i,toDate:n,srchText,isInterComp:Ve},async:!0,success:function(a){var i=JSON.parse(a);if(i){var n=ne.records.length,l=[];if(Ze.length>0){Xe=Ze.length;for(var s=0;s<i.length;s++){0==Ze.filter(function(e){return e.CpaymentID==i[s].CpaymentID}).length&&(i[s].recid=n+s,l.push(i[s]))}i=l,Ze=[],l=[]}!function(a){var i=[],n=[];a.length>0&&(n=Object.keys(a[0]));var l=0;ne.records.length>0&&(l=ne.records.length);for(var s=0;s<a.length;s++){var o={};o.recid=l+s;for(var r=0;r<n.length;r++){var u=n[r];o[u]="SelectRow"!=u&&e.Utility.encodeText(a[s][u])}i.push(o)}if(w2utils.encodeTags(i),ne.add(i),Xe>0)for(var d=0;d<Xe;d++){var g=t("#grid_"+ne.name+'_records td[col="0"]').find('input[type="checkbox"]');t(g[d]).prop("checked",!0),ne.editChange.call(ne,g[d],d,0,event);var p={type:"click",phase:"before",target:"grid",recid:d,index:d,isStopped:!1,"isCan//celled":!1,onComplete:null};ne.trigger(p)}Xe=0,i=[],n=[],F.find("#grid_openformatgrid_"+c.windowNo+"_records").on("scroll",ta)}(i)}},error:function(e){}})}(++Tt,Dt),gt[0].style.visibility="hidden")}function aa(){t(this).scrollTop()>0&&(gt[0].style.visibility="visible",t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&It<yt&&function(a,l){if(0==(Se=I.val()))return e.ADialog.info("Message",!0,"select currency","");var s=de.is(":checked");Oe=me.val(),paymentType=w.val(),srchText=Be.val(),null!=Oe&&null!=Oe&&""!=Oe?e.DB.to_date(Oe):e.DB.to_date(new Date);null!=i&&null!=i&&""!=i&&e.DB.to_date(i);null!=n&&null!=n&&""!=n&&e.DB.to_date(n);t.ajax({url:e.Application.contextUrl+"PaymentAllocation/GetCashJounral",data:{AD_Org_ID,_C_Currency_ID:Se,_C_BPartner_ID:Ce,isInterBPartner:_e,chk:s,page:a,size:l,fromDate:i,toDate:n,paymentType_ID:paymentType,srchText,isInterComp:Ve},async:!0,success:function(t){var a=JSON.parse(t);if(a){var i=le.records.length,n=[];if(Ye.length>0){He=Ye.length;for(var l=0;l<a.length;l++){0==Ye.filter(function(e){return e.CcashlineiID==a[l].CcashlineiID}).length&&(a[l].recid=i+l,n.push(a[l]))}a=n,Ye=[],n=[]}!function(t){var a=[],i=[];t.length>0&&(i=Object.keys(t[0]));var n=0;le.records.length>0&&(n=le.records.length);for(var l=0;l<t.length;l++){var s={};s.recid=n+l;for(var o=0;o<i.length;o++){var r=i[o];"selectrow"==r.toLower()?s[r]=!1:s[r]=e.Utility.encodeText(t[l][r])}a.push(s)}w2utils.encodeTags(a),le.add(a),a=[],i=[],Q.find("#grid_openformatgridcash_"+c.windowNo+"_records").on("scroll",aa)}(a)}},error:function(e){}})}(++It,Dt),gt[0].style.visibility="hidden")}function ia(){t(this).scrollTop()>0&&(gt[0].style.visibility="visible",t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&ht<Ct&&function(o,r){var u=de.is(":checked"),d=null;d=null!=(Oe=me.val())&&null!=Oe&&""!=Oe?e.DB.to_date(Oe):e.DB.to_date(new Date);if(l=a.val(),0==(Se=I.val()))return e.ADialog.info("Message",!0,"select currency","");s=O.val(),docBaseType=P.val(),M=e.Utility.Util.getValueOfInt(C.getValue()),srchText=Ge.val(),null!=i&&null!=i&&""!=i&&e.DB.to_date(i);null!=n&&null!=n&&""!=n&&e.DB.to_date(n);t.ajax({url:e.Application.contextUrl+"PaymentAllocation/GetInvoice",data:{AD_Org_ID,_C_Currency_ID:Se,_C_BPartner_ID:Ce,isInterBPartner:_e,chk:u,date:d,page:o,size:r,docNo:l,c_docType_ID:s,docBaseType,PaymentMethod_ID:M,fromDate:i,toDate:n,conversionDate:fe,srchText,isInterComp:Ve,conversionType_ID:h.getValue()},async:!0,success:function(a){var i=JSON.parse(a);if(i){var n=[],l=se.records.length;if(tt.length>0){at=tt.length;for(var s=0;s<i.length;s++){0==tt.filter(function(e){return e.C_InvoicePaySchedule_ID==i[s].C_InvoicePaySchedule_ID}).length&&(i[s].recid=l+s,n.push(i[s]))}i=n,tt=[],n=[]}!function(a){var i=[],n=[];a.length>0&&(n=Object.keys(a[0]));var l=0;se.records.length>0&&(l=se.records.length);for(var s=0;s<a.length;s++){var o={};o.recid=l+s;for(var r=0;r<n.length;r++){var u=n[r];"selectrow"==u.toLower()?o[u]=!1:o[u]=e.Utility.encodeText(a[s][u])}i.push(o)}if(w2utils.encodeTags(i),se.add(i),at>0)for(var d=0;d<at;d++){var g=t("#grid_"+se.name+'_records td[col="0"]').find('input[type="checkbox"]');t(g[d]).prop("checked",!0),se.editChange.call(se,g[d],d,0,event);var p={type:"click",phase:"before",target:"grid",recid:d,index:d,isStopped:!1,"isCan//celled":!1,onComplete:null};se.trigger(p)}at=0,i=[],n=[],$.find("#grid_openformatgridinvoice_"+c.windowNo+"_records").on("scroll",ia)}(i),Pe=9,be=10,Me=14}},error:function(e){}})}(++ht,Dt),gt[0].style.visibility="hidden")}function na(a,i){var n=[];n.push({field:"SelectRow",columnName:"SelectRow",caption:e.translatedTexts.VIS_Check,size:"50px",editable:{type:"checkbox"},sortable:!0}),n.push({field:"AD_Org_ID",columnName:"AD_Org_ID",caption:e.translatedTexts.AD_Org_ID,size:"85px",hidden:!0}),n.push({field:"OrgName",columnName:"OrgName",caption:e.translatedTexts.AD_Org_ID,size:"105px",hidden:!1,sortable:!0}),n.push({field:"DATEACCT",columnName:"DATEACCT",caption:e.translatedTexts.DateAcct,render:function(e,t,a){var i=e.DATEACCT;return new Date(i).toLocaleDateString()},size:"105px",hidden:!1,sortable:!0}),n.push({field:"DOCUMENTNO",columnName:"DOCUMENTNO",caption:e.translatedTexts.DocumentNo,size:"120px",hidden:!1,sortable:!0}),n.push({field:"Account",columnName:"Account",caption:e.translatedTexts.Account,size:"150px",hidden:!1,sortable:!0}),n.push({field:"Isocode",columnName:"Isocode",caption:e.translatedTexts.TrxCurrency,size:"105px",hidden:!1,sortable:!0}),n.push({field:"ConversionName",columnName:"ConversionName",caption:e.translatedTexts.C_ConversionType_ID,size:"105px",hidden:!1,sortable:!0}),n.push({field:"ConvertedAmount",columnName:"ConvertedAmount",caption:e.Msg.getMsg("Amount"),attr:"align=right",size:"150px",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.ConvertedAmount;return parseFloat(i).toLocaleString(navigator.language,{maximumFractionDigits:At,minimumFractionDigits:At})}}),n.push({field:"OpenAmount",columnName:"OpenAmount",caption:e.translatedTexts.OpenAmount,attr:"align=right",size:"150px",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.OpenAmount;return parseFloat(i).toLocaleString(navigator.language,{maximumFractionDigits:At,minimumFractionDigits:At})}}),n.push({field:"AppliedAmt",columnName:"AppliedAmt",caption:e.translatedTexts.AppliedAmount,size:"150px",attr:"align=right",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.AppliedAmt;return parseFloat(i).toLocaleString(navigator.language,{maximumFractionDigits:At,minimumFractionDigits:At})}}),n.push({field:"DATEDOC",columnName:"DATEDOC",caption:e.translatedTexts.Date,render:function(e,t,a){var i=e.DATEDOC;return new Date(i).toLocaleDateString()},size:"80px",hidden:!0}),n.push({field:"GL_JOURNALLINE_ID",columnName:"GL_JOURNALLINE_ID",caption:e.translatedTexts.GL_JOURNALLINE_ID,size:"150px",hidden:!0}),n.push({field:"C_ConversionType_ID",columnName:"C_ConversionType_ID",caption:e.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!0}),n.push({field:"GL_Journal_ID",columnName:"GL_Journal_ID",caption:e.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!0});var l=[],s=[];a.length>0&&(s=Object.keys(a[0]));for(var o=0;o<a.length;o++){var r={};r.recid=o;for(var u=0;u<s.length;u++){var d=s[u];r[d]="SelectRow"!=d&&e.Utility.encodeText(a[o][d])}l.push(r)}if(null!=Z&&null!=Z&&(Z.destroy(),Z=null),Z=W.w2grid({name:"openformatglgrid_"+c.windowNo,multiSelect:!0,columns:n,records:l,onChange:function(t){ra(t,!1,!1,!1,!0)&&function(t){if(X)return void t.preventDefault();var a=Z.getColumn("AppliedAmt",!0);if(null==Z.columns[a].editable)return;if(null!=Z.getChanges(t.recid)&&Z.getChanges(t.recid).length>0&&Z.get(t.recid).changes){if(e.Utility.Util.getValueOfDecimal(t.value_new)>0&&e.Utility.Util.getValueOfDecimal(t.value_new)>e.Utility.Util.getValueOfDecimal(Z.get(t.recid).OpenAmount))return Z.set(0,{AppliedAmt:e.Utility.Util.getValueOfDecimal(Z.get(t.recid).OpenAmount)}),e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(Z.get(t.recid).OpenAmount)<0&&e.Utility.Util.getValueOfDecimal(t.value_new)<e.Utility.Util.getValueOfDecimal(Z.get(t.recid).OpenAmount))return Z.set(0,{AppliedAmt:e.Utility.Util.getValueOfDecimal(Z.get(t.recid).OpenAmount)}),e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();a==t.column&&(Z.get(t.recid).changes.AppliedAmt=t.value_new),Z.refreshCell(t.recid,"AppliedAmt")}else t.column>0&&Z.set(t.recid,{AppliedAmt:t.value_new});t.column==a&&(parseFloat(Z.get(t.recid).OpenAmount)>parseFloat(Z.get(t.recid).AppliedAmt)||Z.set(0,{AppliedAmt:Z.get(t.recid).OpenAmount}),Va(t.recid,t.column))}(t)},onClick:function(a){!function(a){if(X)return void a.preventDefault();var i=Z.getColumn("AppliedAmt",!0),n=Z.getColumn("SelectRow",!0);if(0==a.column||null==a.column){var l=Z.getChanges(),s=t.grep(l,function(e,t){return parseInt(e.recid)==parseInt(a.recid)});if(null==s||null==s[0]||0==s.length||null==s[0].SelectRow){Z.get(a.recid).AppliedAmt=0,Z.refreshCell(a.recid,"AppliedAmt"),Da();for(var o=0;o<ie.length;o++)ie[o].recid==a.recid&&ie.splice(o,1)}else if(1==s[0].SelectRow){if(0==e.Utility.Util.getValueOfInt(Et))Et=Z.get(a.recid).C_ConversionType_ID;else if(Et!=Z.get(a.recid).C_ConversionType_ID){var r=document.getElementsByName(a.target);r.length>0&&(r=r[0]);var c=t(r).find("#grid_openformatglgrid_rec_"+a.recid);c.length>0&&(c=c[0]),t(c).find("input:checked").prop("checked")&&t(c).find("input:checked").prop("checked",!1),Z.get(a.recid).changes=!1,Z.unselect(a.recid),Z.columns[i].editable=!1,Z.get(a.recid).changes.AppliedAmt="0",Z.refreshCell(a.recid,"AppliedAmt"),e.ADialog.warn("VIS_ConversionNotMatched")}if(de.is(":checked")){if(""==De.val()){e.ADialog.warn("VIS_SlctcnvrsnDate"),Z.get(a.recid).changes=!1,Z.unselect(a.recid),Z.columns[i].editable=!1,Z.get(a.recid).changes.AppliedAmt="0",Z.refreshCell(a.recid,"AppliedAmt");var u=t("#grid_"+Z.name+'_records td[col="0"]').find('input[type="checkbox"]');t(u[a.index]).prop("checked",!1),Z.editChange.call(Z,u[a.index],a.index,0,a);var d={type:"click",phase:"before",target:"grid",recid:a.recid,index:a.index,isStopped:!1,"isCan//celled":!1,onComplete:null};return Z.trigger(d),!1}var g=Z.get(a.recid).DATEACCT;if(Globalize.format(new Date(De.val()),"yyyy-MM-dd")!=(g=Globalize.format(new Date(g),"yyyy-MM-dd"))){e.ADialog.warn("VIS_SelectSameDate");i=Z.getColumn("DATEACCT",!0);Z.get(a.recid).changes=!1,Z.unselect(a.recid),Z.columns[i].editable=!1,Z.get(a.recid).changes.AppliedAmt="0",Z.refreshCell(a.recid,"AppliedAmt");u=t("#grid_"+Z.name+'_records td[col="0"]').find('input[type="checkbox"]');t(u[a.index]).prop("checked",!1),Z.editChange.call(Z,u[a.index],a.index,0,a);d={type:"click",phase:"before",target:"grid",recid:a.recid,index:a.index,isStopped:!1,"isCan//celled":!1,onComplete:null};return Z.trigger(d),!1}}if(ie.push(s[0]),1==ie.length)te=Z.get(a.recid).OpenAmount;else if(ie.length>1&&(ae=Z.get(a.recid).OpenAmount,!(parseFloat(te)>0&&parseFloat(ae)>0||parseFloat(te)<0&&parseFloat(ae)<0))){H.is(":checked")||e.ADialog.info("",!0,e.translatedTexts.CreditOrDebit),Z.get(a.recid).changes=!1,Z.unselect(a.recid),Z.columns[i].editable=!1,Z.get(a.recid).changes.AppliedAmt="0",Z.refreshCell(a.recid,"AppliedAmt");u=t("#grid_"+Z.name+'_records td[col="0"]').find('input[type="checkbox"]');t(u[a.index]).prop("checked",!1),Z.editChange.call(Z,u[a.index],a.index,0,a);d={type:"click",phase:"before",target:"grid",recid:a.recid,index:a.index,isStopped:!1,"isCan//celled":!1,onComplete:null};Z.trigger(d);for(o=0;o<ie.length;o++)ie[o].recid==a.recid&&ie.splice(o,1);if(!H.is(":checked"))return!1}}else Z.unselect(a.recid),Z.columns[i].editable=!1,Z.get(a.recid).changes.AppliedAmt="0",Z.refreshCell(a.recid,"AppliedAmt");n!=a.column&&null!=a.column||null==s[0]||null==s[0].SelectRow||(Z.get(a.recid).AppliedAmt=e.Utility.Util.getValueOfDecimal(Z.get(a.recid).OpenAmount)),Va(a.recid,a.column)}}(a),Da()},onDblClick:function(e){e.preventDefault()},onSelect:function(e){e.all&&(e.onComplete=function(){W.find("#grid_openformatglgrid_"+c.windowNo+"_records").on("scroll",ea)})},onEditField:function(e){e.onComplete=function(e){id=e.recid,t("#grid_openformatglgrid_"+c.windowNo+"_edit_"+id+"_10").keydown(function(e){var t=Bt.isDecimalSeparatorDot(window.navigator.language);return!!(t||190!=e.keyCode&&110!=e.keyCode)&&((!t||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which||(this.value=this.value.replace(".","")),!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||(this.value=this.value.replace(",","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))})}}}),ze>0)for(var g=0;g<ze;g++){i=t("#grid_"+Z.name+'_records td[col="0"]').find('input[type="checkbox"]');t(i[g]).prop("checked",!0),Z.editChange.call(Z,i[g],g,0,event);var p={type:"click",phase:"before",target:"grid",recid:g,index:g,isStopped:!1,"isCan//celled":!1,onComplete:null};Z.trigger(p)}ze=0,Z.autoLoad=!0,t(t(Z.box)[0]).find(".w2ui-search-down").css("margin-top","4px"),t(t(Z.box)[0]).find(".w2ui-search-clear").css("margin-top","4px")}function la(a,i){var n=[];n.push({field:"SelectRow",columnName:"SelectRow",caption:e.translatedTexts.VIS_Check,size:"50px",editable:{type:"checkbox"},sortable:!0}),n.push({field:"AD_Org_ID",columnName:"AD_Org_ID",caption:e.translatedTexts.AD_Org_ID,size:"85px",hidden:!0}),n.push({field:"OrgName",columnName:"OrgName",caption:e.translatedTexts.AD_Org_ID,size:"85px",hidden:!1,sortable:!0}),n.push({field:"DATEACCT",columnName:"DATEACCT",caption:e.translatedTexts.DateAcct,size:"85px",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.DATEACCT;return new Date(i).toLocaleDateString()}}),n.push({field:"Documentno",columnName:"Documentno",caption:e.translatedTexts.DocumentNo,size:"120px",hidden:!1,sortable:!0}),n.push({field:"DocBaseType",columnName:"DocBaseType",caption:e.translatedTexts.DocBaseType,size:"120px",hidden:!1,sortable:!0}),n.push({field:"PayName",columnName:"PayName",caption:e.translatedTexts.PaymentMethod,size:"120px",hidden:!1,sortable:!0}),n.push({field:"Isocode",columnName:"Isocode",caption:e.translatedTexts.TrxCurrency,size:"85px",hidden:!1,sortable:!0}),n.push({field:"ConversionName",columnName:"ConversionName",caption:e.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!1,sortable:!0}),i?n.push({field:"Payment",columnName:"Payment",caption:e.translatedTexts.Amount,size:"150px",attr:"align=right",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.Payment;return parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}):n.push({field:"Payment",columnName:"Payment",caption:e.translatedTexts.Amount,size:"150px",hidden:!0}),n.push({field:"ConvertedAmount",columnName:"ConvertedAmount",caption:e.translatedTexts.ConvertedAmount,size:"150px",attr:"align=right",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.ConvertedAmount;return parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}),n.push({field:"OpenAmt",columnName:"OpenAmt",caption:e.translatedTexts.OpenAmount,size:"150px",attr:"align=right",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.OpenAmt;return parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}),n.push({field:"Multiplierap",columnName:"Multiplierap",caption:e.translatedTexts.multiplierap,size:"150px",hidden:!0}),n.push({field:"AppliedAmt",columnName:"AppliedAmt",caption:e.translatedTexts.AppliedAmount,size:"150px",attr:"align=right",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.AppliedAmt;return i=da(event,i,i),parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})},editable:{type:"number"}}),n.push({field:"Date1",columnName:"Date1",caption:e.translatedTexts.Date,size:"80px",hidden:!0,render:function(e,t,a){var i=e.Date1;return new Date(i).toLocaleDateString()}}),n.push({field:"CpaymentID",columnName:"CpaymentID",caption:e.translatedTexts.c_payment_id,size:"150px",hidden:!0}),n.push({field:"C_ConversionType_ID",columnName:"C_ConversionType_ID",caption:e.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!0});var l=[],s=[];a.length>0&&(s=Object.keys(a[0]));for(var o=0;o<a.length;o++){var r={};r.recid=o;for(var u=0;u<s.length;u++){var d=s[u];r[d]="SelectRow"!=d&&e.Utility.encodeText(a[o][d])}l.push(r)}if(null!=ne&&null!=ne&&(ne.destroy(),ne=null),ne=F.w2grid({name:"openformatgrid_"+c.windowNo,multiSelect:!0,columns:n,records:l,onClick:function(a){!function(a){if(_t)return void a.preventDefault();var i=ne.getColumn("AppliedAmt",!0),n=ne.getColumn("SelectRow",!0);if(0==a.column||null==a.column){var l=ne.getChanges(),s=t.grep(l,function(e,t){return parseInt(e.recid)==parseInt(a.recid)});if(null==s||null==s[0]||0==s.length||null==s[0].SelectRow)ne.get(a.recid).AppliedAmt=0,ne.refreshCell(a.recid,"AppliedAmt"),Da();else if(1==s[0].SelectRow){let n=t.grep(l,function(e,t){return 1==e.SelectRow});if(de.is(":checked")?Et=h.getValue():X&&null!=n&&n.length>0&&(Et=ne.get(n[0].recid).C_ConversionType_ID),0==e.Utility.Util.getValueOfInt(Et))Et=ne.get(a.recid).C_ConversionType_ID;else if(Et!=ne.get(a.recid).C_ConversionType_ID){var o=document.getElementsByName(a.target);o.length>0&&(o=o[0]);var r=t(o).find("#grid_openformatgrid_rec_"+a.recid);r.length>0&&(r=r[0]),t(r).find("input:checked").prop("checked")&&t(r).find("input:checked").prop("checked",!1),ne.get(a.recid).changes=!1,ne.unselect(a.recid),ne.columns[i].editable=!1,ne.get(a.recid).changes.AppliedAmt="0",ne.refreshCell(a.recid,"AppliedAmt"),e.ADialog.warn("VIS_ConversionNotMatched")}if(de.is(":checked")){if(""==De.val()){e.ADialog.warn("VIS_SlctcnvrsnDate"),ne.get(a.recid).changes=!1,ne.unselect(a.recid),ne.columns[i].editable=!1,ne.get(a.recid).changes.AppliedAmt="0",ne.refreshCell(a.recid,"AppliedAmt");var c=t("#grid_"+ne.name+'_records td[col="0"]').find('input[type="checkbox"]');t(c[a.index]).prop("checked",!1),ne.editChange.call(ne,c[a.index],a.index,0,a);var u={type:"click",phase:"before",target:"grid",recid:a.index,index:a.recid,isStopped:!1,"isCan//celled":!1,onComplete:null};return ne.trigger(u),!1}var d=ne.get(a.recid).DATEACCT;if(Globalize.format(new Date(De.val()),"yyyy-MM-dd")!=(d=Globalize.format(new Date(d),"yyyy-MM-dd"))){e.ADialog.warn("VIS_SelectSameDate");i=ne.getColumn("DATEACCT",!0);ne.get(a.recid).changes=!1,ne.unselect(a.recid),ne.columns[i].editable=!1,ne.get(a.recid).changes.AppliedAmt="0",ne.refreshCell(a.recid,"AppliedAmt");c=t("#grid_"+ne.name+'_records td[col="0"]').find('input[type="checkbox"]');t(c[a.index]).prop("checked",!1),ne.editChange.call(ne,c[a.index],a.index,0,a);u={type:"click",phase:"before",target:"grid",recid:a.recid,index:a.index,isStopped:!1,"isCan//celled":!1,onComplete:null};return ne.trigger(u),!1}}}else ne.unselect(a.recid),ne.columns[i].editable=!1,ne.get(a.recid).changes.AppliedAmt="0",ne.refreshCell(a.recid,"AppliedAmt");n!=a.column&&null!=a.column||null==s[0]||null==s[0].SelectRow||(ne.get(a.recid).AppliedAmt=e.Utility.Util.getValueOfDecimal(ne.get(a.recid).OpenAmt)),va(a.recid,a.column,!1,!1)}}(a),Da()},onChange:function(t){ra(t,!1,!0,!1,!1)&&function(t){if(_t)return void t.preventDefault();var a=ne.getColumn("AppliedAmt",!0),i=ne.getColumn("SelectRow",!0),n=0;if(null==ne.columns[a].editable)return;if(n=""!=t.value_new?t.value_new:n,t.column==a&&(ft?n.toString().contains("−")&&(n=(-1*mt.GetConvertedNumber(n,ft)).toString()):n.toString().contains("−")||n.toString().contains(",")?n=n.toString().contains("−")?(-1*mt.GetConvertedNumber(n,ft)).toString():mt.GetConvertedNumber(n,ft).toString():isNaN(n)||(n=mt.GetFormatedValue(n,"init",ft).toString()),isNaN(n)))return e.ADialog.warn("VIS_ValidAmount"),void t.preventDefault();if(null!=ne.getChanges(t.recid)&&ne.getChanges(t.recid).length>0&&ne.get(t.recid).changes){if(e.Utility.Util.getValueOfDecimal(n)>0&&e.Utility.Util.getValueOfDecimal(n)>e.Utility.Util.getValueOfDecimal(ne.get(t.recid).OpenAmt))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(ne.get(t.recid).OpenAmt)<0&&e.Utility.Util.getValueOfDecimal(n)<e.Utility.Util.getValueOfDecimal(ne.get(t.recid).OpenAmt))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(ne.get(t.recid).OpenAmt)>0&&e.Utility.Util.getValueOfDecimal(n)<0)return ne.set(0,{AppliedAmt:e.Utility.Util.getValueOfDecimal(ne.get(t.recid).OpenAmt)}),e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();ne.get(t.recid).changes.AppliedAmt=""!=t.value_new?t.value_new:n,ne.refreshCell(t.recid,"AppliedAmt")}else t.column>0&&ne.set(t.recid,{AppliedAmt:""!=t.value_new?t.value_new:n});if((t.column==i||null==t.column)&&de.is(":checked")&&0==e.Utility.Util.getValueOfDecimal(ne.get(t.recid).OpenAmt))return e.ADialog.warn("NotFoundCurrencyRate"),void t.preventDefault();a==t.column&&va(t.recid,t.column,!1,!1)}(t)},onDblClick:function(a){!function(a){if(null==ne.columns[a.column])return void a.preventDefault();if("AppliedAmt"==ne.columns[a.column].field){var i=ne.getChanges();if(null==i||0==i.length)return void(ne.columns[a.column].editable=!1);var n=t.grep(i,function(e,t){return parseInt(e.recid)==parseInt(a.recid)});if(null==n||null==n[0]||null==n[0].SelectRow)return void(ne.columns[a.column].editable=!1);ne.columns[a.column].editable={type:"number"},ne.columns[a.column].render=function(t,i,n){var l=0;return"AppliedAmt"==ne.columns[a.column].field&&(null==t.changes||null==t.changes.AppliedAmt||null==t.changes.SelectRow?null!=t.changes&&null!=t.changes.SelectRow&&1==t.changes.SelectRow&&null==t.changes.AppliedAmt?(t.changes.AppliedAmt=t.OpenAmt,l=ua(t.changes.AppliedAmt.toString(),ft)):l=0:null!=t.changes&&null!=t.changes.SelectRow&&1==t.changes.SelectRow&&null==t.changes.AppliedAmt?(t.changes.AppliedAmt=t.OpenAmt,l=ua(t.changes.AppliedAmt.toString(),ft)):l=ua(t.changes.AppliedAmt.toString(),ft)),parseFloat(l)>0&&parseFloat(l)>parseFloat(t.OpenAmt)||parseFloat(t.OpenAmt)<0&&parseFloat(l)<parseFloat(t.OpenAmt)?(e.ADialog.warn("AppliedAmtgrtr"),l=parseFloat(t.OpenAmt)):parseFloat(t.OpenAmt)>0&&parseFloat(l)<0&&(e.ADialog.warn("VIS_AppliedAmtleszero"),l=parseFloat(t.OpenAmt)),0!=t.OpenAmt&&0!=t.AppliedAmt&&""!=t.OpenAmt&&""!=t.AppliedAmt&&null!=t.changes&&1==t.changes.SelectRow&&t.OpenAmt==t.AppliedAmt&&parseFloat(t.changes.AppliedAmt)==t.AppliedAmt&&Ia(),parseFloat(l).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}}(a)},onSelect:function(e){e.all&&(e.onComplete=function(){F.find("#grid_openformatgrid_"+c.windowNo+"_records").on("scroll",ta)})},onEditField:function(e){e.onComplete=function(e){id=e.recid,t("#grid_openformatgrid_"+c.windowNo+"_edit_"+id+"_"+e.column).keydown(function(e){var t=Bt.isDecimalSeparatorDot(window.navigator.language);return!!(t||190!=e.keyCode&&110!=e.keyCode)&&((!t||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which||(this.value=this.value.replace(".","")),!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||(this.value=this.value.replace(",","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))})}}}),Xe>0)for(var g=0;g<Xe;g++){i=t("#grid_"+ne.name+'_records td[col="0"]').find('input[type="checkbox"]');t(i[g]).prop("checked",!0),ne.editChange.call(ne,i[g],g,0,event);var p={type:"click",phase:"before",target:"grid",recid:g,index:g,isStopped:!1,"isCan//celled":!1,onComplete:null};ne.trigger(p)}Xe=0,ne.autoLoad=!0,t(t(ne.box)[0]).find(".w2ui-search-down").css("margin-top","4px"),t(t(ne.box)[0]).find(".w2ui-search-clear").css("margin-top","4px")}function sa(a,i){var n=[];n.push({field:"SelectRow",columnName:"SelectRow",caption:e.translatedTexts.VIS_Check,size:"50px",editable:{type:"checkbox"},sortable:!0}),n.push({field:"AD_Org_ID",columnName:"AD_Org_ID",caption:e.translatedTexts.AD_Org_ID,size:"85px",hidden:!0,sortable:!0}),n.push({field:"OrgName",columnName:"OrgName",caption:e.translatedTexts.AD_Org_ID,size:"105px",hidden:!1,sortable:!0}),n.push({field:"DATEACCT",columnName:"DATEACCT",caption:e.translatedTexts.DateAcct,size:"105px",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.DATEACCT;return new Date(i).toLocaleDateString()}}),n.push({field:"ReceiptNo",columnName:"ReceiptNo",caption:e.translatedTexts.RECEIPTNO,size:"120px",hidden:!1,sortable:!0}),n.push({field:"VSS_paymenttype",columnName:"VSS_paymenttype",caption:"Payment ID",size:"120px",hidden:!0}),n.push({field:"Payment",columnName:"Payment",caption:"Payment Type",size:"120px",hidden:!1,sortable:!0}),n.push({field:"Isocode",columnName:"Isocode",caption:e.Msg.getMsg("TrxCurrency"),size:"105px",hidden:!1,sortable:!0}),n.push({field:"ConversionName",columnName:"ConversionName",caption:e.translatedTexts.C_ConversionType_ID,size:"105px",hidden:!1,sortable:!0}),i?n.push({field:"Amount",columnName:"Amount",caption:e.translatedTexts.Amount,size:"150px",attr:"align=right",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.Amount;return parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}):n.push({field:"Amount",columnName:"Amount",caption:e.translatedTexts.Amount,size:"150px",hidden:!0}),n.push({field:"ConvertedAmount",columnName:"ConvertedAmount",caption:e.Msg.getMsg("ConvertedAmount"),size:"150px",attr:"align=right",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.ConvertedAmount;return parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}),n.push({field:"OpenAmt",columnName:"OpenAmt",caption:e.translatedTexts.OpenAmount,size:"150px",hidden:!1,attr:"align=right",sortable:!0,render:function(e,t,a){var i=e.OpenAmt;return parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}),n.push({field:"AppliedAmt",columnName:"AppliedAmt",caption:e.translatedTexts.AppliedAmount,size:"150px",attr:"align=right",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.AppliedAmt;return i=da(event,i,i),parseFloat(i).toLocaleString(navigator.language,{maximumFractionDigits:At,minimumFractionDigits:At})},editable:{type:"number"}}),n.push({field:"Created",columnName:"Created",caption:e.translatedTexts.Date,size:"80px",hidden:!0,sortable:!0,render:function(e,t,a){var i=e.Created;return new Date(i).toLocaleDateString()}}),n.push({field:"CcashlineiID",columnName:"CcashlineiID",caption:e.translatedTexts.ccashlineid,size:"150px",hidden:!0}),n.push({field:"Multiplierap",columnName:"Multiplierap",caption:e.translatedTexts.multiplierap,hidden:!0}),n.push({field:"C_ConversionType_ID",columnName:"C_ConversionType_ID",caption:e.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!0}),n.push({field:"DATEACCT",columnName:"DATEACCT",caption:e.translatedTexts.DateAcct,size:"85px",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.DATEACCT;return new Date(i).toLocaleString()},hidden:!0}),n.push({field:"AD_Org_ID",columnName:"AD_Org_ID",caption:e.translatedTexts.AD_Org_ID,size:"85px",hidden:!0}),n.push({field:"OrgName",columnName:"OrgName",caption:e.translatedTexts.AD_Org_ID,size:"85px",hidden:!0});var l=[],s=[];a.length>0&&(s=Object.keys(a[0]));for(var o=0;o<a.length;o++){var r={};r.recid=o;for(var u=0;u<s.length;u++){var d=s[u];"selectrow"==d.toLower()?r[d]=!1:r[d]=e.Utility.encodeText(a[o][d])}l.push(r)}if(null!=le&&null!=le&&(le.destroy(),le=null),le=Q.w2grid({name:"openformatgridcash_"+c.windowNo,multiSelect:!0,columns:n,records:l,onChange:function(t){ra(t,!1,!1,!0,!1)&&function(t){if(vt)return void t.preventDefault();var a=le.getColumn("AppliedAmt",!0),i=le.getColumn("SelectRow",!0),n=0;if(null==le.columns[a].editable)return;if(n=""!=t.value_new?t.value_new:n,t.column==a&&(ft?n.toString().contains("−")&&(n=(-1*mt.GetConvertedNumber(n,ft)).toString()):n.toString().contains("−")||n.toString().contains(",")?n=n.toString().contains("−")?(-1*mt.GetConvertedNumber(n,ft)).toString():mt.GetConvertedNumber(n,ft).toString():isNaN(n)||(n=mt.GetFormatedValue(n,"init",ft).toString()),isNaN(n)))return e.ADialog.warn("VIS_ValidAmount"),void t.preventDefault();if(null!=le.getChanges(t.recid)&&le.getChanges(t.recid).length>0&&le.get(t.recid).changes){if(e.Utility.Util.getValueOfDecimal(n)>0&&e.Utility.Util.getValueOfDecimal(n)>e.Utility.Util.getValueOfDecimal(le.get(t.recid).OpenAmt))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(le.get(t.recid).OpenAmt)<0&&e.Utility.Util.getValueOfDecimal(n)<e.Utility.Util.getValueOfDecimal(le.get(t.recid).OpenAmt))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(le.get(t.recid).OpenAmt)>0&&e.Utility.Util.getValueOfDecimal(n)<0)return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();le.get(t.recid).changes.AppliedAmt=""!=t.value_new?t.value_new:n,le.refreshCell(t.recid,"AppliedAmt")}else t.column>0&&le.set(t.recid,{AppliedAmt:""!=t.value_new?t.value_new:n});if((t.column==i||null==t.column)&&de.is(":checked")&&0==e.Utility.Util.getValueOfDecimal(le.get(t.recid).OpenAmt))return e.ADialog.warn("NotFoundCurrencyRate"),void t.preventDefault();a==t.column&&va(t.recid,t.column,!1,!0)}(t)},onClick:function(a){!function(a){if(vt)return void a.preventDefault();var i=le.getColumn("AppliedAmt",!0),n=le.getColumn("SelectRow",!0);if(0==a.column||null==a.column){var l=le.getChanges(),s=t.grep(l,function(e,t){return parseInt(e.recid)==parseInt(a.recid)});if(null==s||null==s[0]||0==s.length||null==s[0].SelectRow)le.get(a.recid).AppliedAmt=0,le.refreshCell(0,"AppliedAmt");else if(1==s[0].SelectRow){if(0==e.Utility.Util.getValueOfInt(Et))Et=le.get(a.recid).C_ConversionType_ID;else if(Et!=le.get(a.recid).C_ConversionType_ID){var o=document.getElementsByName(a.target);o.length>0&&(o=o[0]);var r=t(o).find("#grid_openformatgridcash_rec_"+a.recid);r.length>0&&(r=r[0]),t(r).find("input:checked").prop("checked")&&t(r).find("input:checked").prop("checked",!1),le.get(a.recid).changes=!1,le.unselect(a.recid),le.columns[i].editable=!1,le.refreshCell(0,"AppliedAmt"),e.ADialog.warn("VIS_ConversionNotMatched")}if(de.is(":checked")){if(""==De.val()){e.ADialog.warn("VIS_SlctcnvrsnDate"),le.get(a.recid).changes=!1,le.unselect(a.recid),le.columns[i].editable=!1,le.refreshCell(a.recid,"AppliedAmt");var c=t("#grid_"+le.name+'_records td[col="0"]').find('input[type="checkbox"]');t(c[a.index]).prop("checked",!1),le.editChange.call(le,c[a.index],a.index,0,a);var u={type:"click",phase:"before",target:"grid",recid:a.recid,index:a.index,isStopped:!1,"isCan//celled":!1,onComplete:null};return le.trigger(u),!1}var d=le.get(a.recid).DATEACCT;if(Globalize.format(new Date(De.val()),"yyyy-MM-dd")!=(d=Globalize.format(new Date(d),"yyyy-MM-dd"))){e.ADialog.warn("VIS_SelectSameDate");i=le.getColumn("DATEACCT",!0);le.get(a.recid).changes=!1,le.unselect(a.recid),le.columns[i].editable=!1,le.refreshCell(a.recid,"AppliedAmt");c=t("#grid_"+le.name+'_records td[col="0"]').find('input[type="checkbox"]');t(c[a.index]).prop("checked",!1),le.editChange.call(le,c[a.index],a.index,0,a);u={type:"click",phase:"before",target:"grid",recid:a.recid,index:a.index,isStopped:!1,"isCan//celled":!1,onComplete:null};return le.trigger(u),!1}}}else le.unselect(a.recid),le.columns[i].editable=!1,le.get(0).changes.AppliedAmt="0",le.refreshCell(0,"AppliedAmt");n!=a.column&&null!=a.column||null==s[0]||null==s[0].SelectRow||(le.get(a.recid).AppliedAmt=e.Utility.Util.getValueOfDecimal(le.get(a.recid).OpenAmt)),va(a.recid,a.column,!1,!0)}}(a),Da()},onDblClick:function(a){!function(a){if(null==le.columns[a.column])return void a.preventDefault();if("AppliedAmt"==le.columns[a.column].field){var i=le.getChanges();if(null==i||0==i.length)return void(le.columns[a.column].editable=!1);var n=t.grep(i,function(e,t){return parseInt(e.recid)==parseInt(a.recid)});if(null==n||null==n[0]||null==n[0].SelectRow)return void(le.columns[a.column].editable=!1);le.columns[a.column].editable={type:"number"},le.columns[a.column].render=function(t,i,n){var l=0;return"AppliedAmt"==le.columns[a.column].field&&(null==t.changes||null==t.changes.AppliedAmt||null==t.changes.SelectRow?null!=t.changes&&null!=t.changes.SelectRow&&1==t.changes.SelectRow&&null==t.changes.AppliedAmt?(t.changes.AppliedAmt=t.OpenAmt,l=ua(t.changes.AppliedAmt.toString(),ft)):l=0:null!=t.changes&&null!=t.changes.SelectRow&&1==t.changes.SelectRow&&null==t.changes.AppliedAmt?(t.changes.AppliedAmt=da(a,t.OpenAmt,t.OpenAmt),l=ua(t.changes.AppliedAmt.toString(),ft)):l=ua(t.changes.AppliedAmt.toString(),ft)),parseFloat(l)>0&&parseFloat(l)>parseFloat(t.OpenAmt)||parseFloat(t.OpenAmt)<0&&parseFloat(l)<parseFloat(t.OpenAmt)?(e.ADialog.warn("AppliedAmtgrtr"),l=parseFloat(t.OpenAmt)):parseFloat(t.OpenAmt)>0&&parseFloat(l)<0&&(e.ADialog.warn("VIS_AppliedAmtleszero"),l=parseFloat(t.OpenAmt)),0!=t.OpenAmt&&0!=t.AppliedAmt&&""!=t.OpenAmt&&""!=t.AppliedAmt&&null!=t.changes&&1==t.changes.SelectRow&&t.OpenAmt==t.AppliedAmt&&parseFloat(t.changes.AppliedAmt)==t.AppliedAmt&&Ia(),l.contains("−")&&(l=l.replace("−","-")),parseFloat(l).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}}(a)},onSelect:function(e){e.all&&(e.onComplete=function(){Q.find("#grid_openformatgridcash_"+c.windowNo+"_records").on("scroll",aa)})},onEditField:function(e){e.onComplete=function(e){id=e.recid,t("#grid_openformatgridcash_"+c.windowNo+"_edit_"+id+"_"+e.column).keydown(function(e){var t=Bt.isDecimalSeparatorDot(window.navigator.language);return!!(t||190!=e.keyCode&&110!=e.keyCode)&&((!t||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which||(this.value=this.value.replace(".","")),!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||(this.value=this.value.replace(",","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))})}}}),He>0)for(var g=0;g<He;g++){i=t("#grid_"+le.name+'_records td[col="0"]').find('input[type="checkbox"]');t(i[g]).prop("checked",!0),le.editChange.call(le,i[g],g,0,event);var p={type:"click",phase:"before",target:"grid",recid:g,index:g,isStopped:!1,"isCan//celled":!1,onComplete:null};le.trigger(p)}He=0,le.autoLoad=!0,t(t(le.box)[0]).find(".w2ui-search-down").css("margin-top","4px"),t(t(le.box)[0]).find(".w2ui-search-clear").css("margin-top","4px")}function oa(e,a,i,n,l){var s=!0,o=null;return a?o=t("#grid_"+se.name+'_records td[col="0"]').find('input[type="checkbox"]:checked'):i?o=t("#grid_"+ne.name+'_records td[col="0"]').find('input[type="checkbox"]:checked'):n?o=t("#grid_"+le.name+'_records td[col="0"]').find('input[type="checkbox"]:checked'):l&&(o=t("#grid_"+Z.name+'_records td[col="0"]').find('input[type="checkbox"]:checked')),null!=o&&o.length>50&&(t(e).prop("checked",!1),s=!1),s}function ra(a,i,n,l,s){var o=!0,r=null;i?r=se.name:n?r=ne.name:l?r=le.name:s&&(r=Z.name);var c=t("#grid_"+r+'_records td[col="0"]').find('input[type="checkbox"]:checked');if(null!=c&&c.length>50){var u=t("#grid_"+r+'_records td[col="0"]').find('input[type="checkbox"]');t(u[a.recid]).prop("checked",!1),e.ADialog.warn("VIS_MaxLimitReached"),a.preventDefault(),o=!1}return o}function ca(a,i){var n=[];n.push({field:"SelectRow",columnName:"SelectRow",caption:e.translatedTexts.VIS_Check,size:"50px",editable:{type:"checkbox"},sortable:!0}),n.push({field:"AD_Org_ID",columnName:"AD_Org_ID",caption:e.translatedTexts.AD_Org_ID,size:"85px",hidden:!0}),n.push({field:"OrgName",columnName:"OrgName",caption:e.translatedTexts.AD_Org_ID,size:"105px",hidden:!1,sortable:!0}),n.push({field:"DATEACCT",columnName:"DATEACCT",caption:e.translatedTexts.DateAcct,size:"105px",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.DATEACCT;return new Date(i).toLocaleDateString()}}),n.push({field:"Documentno",columnName:"Documentno",caption:e.translatedTexts.DocumentNo,size:"120px",hidden:!1,sortable:!0}),n.push({field:"InvoiceScheduleDate",columnName:"InvoiceScheduleDate",caption:e.translatedTexts.ScheduleDate,size:"100px",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.InvoiceScheduleDate;return new Date(i).toLocaleDateString()}}),n.push({field:"DocBaseType",columnName:"DocBaseType",caption:e.translatedTexts.DocBaseType,size:"120px",hidden:!1,sortable:!0}),n.push({field:"PayName",columnName:"PayName",caption:e.translatedTexts.PaymentMethod,size:"120px",hidden:!1,sortable:!0}),n.push({field:"Isocode",columnName:"Isocode",caption:e.Msg.getMsg("TrxCurrency"),size:"85px",hidden:!1,sortable:!0}),n.push({field:"ConversionName",columnName:"ConversionName",caption:e.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!1,sortable:!0}),i?n.push({field:"Currency",columnName:"Currency",caption:e.translatedTexts.Amount,size:"100px",attr:"align=right",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.Currency;return parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}):n.push({field:"Currency",columnName:"Currency",caption:e.translatedTexts.Amount,size:"100px",hidden:!0}),n.push({field:"Converted",columnName:"Converted",caption:e.Msg.getMsg("ConvertedAmount"),size:"100px",hidden:!1,sortable:!0,attr:"align=right",render:function(e,t,a){var i=e.Converted;return parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}),n.push({field:"Amount",columnName:"Amount",caption:e.translatedTexts.OpenAmount,size:"100px",hidden:!1,sortable:!0,attr:"align=right",render:function(e,t,a){var i=e.Amount;return parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}),n.push({field:"Discount",columnName:"Discount",caption:e.translatedTexts.DiscountAmt,size:"100px",hidden:!1,sortable:!0,attr:"align=right",render:function(e,t,a){var i=e.Discount;return i=da(event,i,i),parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})},editable:{type:"number"}}),n.push({field:"Date1",columnName:"Date1",caption:e.translatedTexts.Date,size:"80px",hidden:!0,render:function(e,t,a){var i=e.Date1;return new Date(i).toLocaleDateString()}}),n.push({field:"CinvoiceID",columnName:"AD_Org_ID",caption:e.translatedTexts.cinvoiceid,size:"150px",hidden:!0}),n.push({field:"Multiplierap",columnName:"Multiplierap",caption:e.translatedTexts.multiplierap,hidden:!0}),n.push({field:"Writeoff",columnName:"Writeoff",caption:e.translatedTexts.WriteOffAmount,size:"100px",attr:"align=right",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.Writeoff;return i=da(event,i,i),parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})},editable:{type:"number"}}),n.push({field:"AppliedAmt",columnName:"AppliedAmt",caption:e.translatedTexts.AppliedAmount,size:"100px",hidden:!1,sortable:!0,attr:"align=right",render:function(e,t,a){var i=e.AppliedAmt;return i=da(event,i,i),parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})},editable:{type:"number"}}),Vt>0&&n.push({field:"C_InvoicePaySchedule_ID",columnName:"C_InvoicePaySchedule_ID",caption:e.translatedTexts.C_InvoicePaySchedule_ID,size:"100px",hidden:!0}),n.push({field:"C_ConversionType_ID",columnName:"C_ConversionType_ID",caption:e.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!0}),n.push({field:"DATEACCT",columnName:"DATEACCT",caption:e.translatedTexts.DateAcct,size:"85px",hidden:!1,sortable:!0,render:function(e,t,a){var i=e.DATEACCT;return new Date(i).toLocaleString()},hidden:!0}),n.push({field:"AD_Org_ID",columnName:"AD_Org_ID",caption:e.translatedTexts.AD_Org_ID,size:"85px",hidden:!0}),n.push({field:"OrgName",columnName:"OrgName",caption:e.translatedTexts.AD_Org_ID,size:"85px",hidden:!0});var l=[],s=[];a.length>0&&(s=Object.keys(a[0]));for(var o=0;o<a.length;o++){var r={};r.recid=o;for(var u=0;u<s.length;u++){var d=s[u];"selectrow"==d.toLower()?r[d]=!1:r[d]=e.Utility.encodeText(a[o][d])}l.push(r)}if(null!=se&&null!=se&&(se.destroy(),se=null),se=$.w2grid({name:"openformatgridinvoice_"+c.windowNo,multiSelect:!0,columns:n,records:l,onChange:function(t){ra(t,!0,!1,!1,!1)&&(!function(t){var a=se.getColumn("AppliedAmt",!0),i=se.getColumn("Writeoff",!0),n=se.getColumn("Discount",!0),l=se.getColumn("SelectRow",!0),s=0,o=0,r=0,c=0;if(null==se.columns[a].editable&&null==se.columns[i].editable&&null==se.columns[n].editable)return;if(c=""!=t.value_new?t.value_new:c,t.column==a||t.column==i||t.column==n){if(ft?c.toString().contains("−")&&(c=(-1*mt.GetConvertedNumber(c,ft)).toString()):c.toString().contains("−")||c.toString().contains(",")?c=c.toString().contains("−")?(-1*mt.GetConvertedNumber(c,ft)).toString():mt.GetConvertedNumber(c,ft).toString():isNaN(c)||(c=mt.GetFormatedValue(c,"init",ft).toString()),isNaN(c))return e.ADialog.warn("VIS_ValidAmount"),void t.preventDefault();o=null!=se.get(t.recid).changes.AppliedAmt&&t.column!=a?ua(se.get(t.recid).changes.AppliedAmt,ft):c,s=null!=se.get(t.recid).changes.Discount&&t.column!=n?ua(se.get(t.recid).changes.Discount,ft):c,r=null!=se.get(t.recid).changes.Writeoff&&t.column!=i?ua(se.get(t.recid).changes.Writeoff,ft):c}if(null!=se.getChanges(t.recid)&&se.getChanges(t.recid).length>0&&se.get(t.recid).changes){if(e.Utility.Util.getValueOfDecimal(c)>0&&e.Utility.Util.getValueOfDecimal(c)>e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)<0&&e.Utility.Util.getValueOfDecimal(c)<e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)>0&&e.Utility.Util.getValueOfDecimal(c)<0)return e.ADialog.warn("VIS_AppliedAmtleszero"),void t.preventDefault();if(a==t.column){if(e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)<0&&e.Utility.Util.getValueOfDecimal((e.Utility.Util.getValueOfDecimal(c)+e.Utility.Util.getValueOfDecimal(r)+e.Utility.Util.getValueOfDecimal(s)).toFixed(At))<e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)>0&&e.Utility.Util.getValueOfDecimal((e.Utility.Util.getValueOfDecimal(c)+e.Utility.Util.getValueOfDecimal(r)+e.Utility.Util.getValueOfDecimal(s)).toFixed(At))>e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)>0&&e.Utility.Util.getValueOfDecimal(c)<0)return e.ADialog.warn("VIS_AppliedAmtleszero"),void t.preventDefault();se.get(t.recid).changes.AppliedAmt=""!=t.value_new?t.value_new:c,se.refreshCell(t.recid,"AppliedAmt")}else if(i==t.column){if(e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)<0&&e.Utility.Util.getValueOfDecimal((e.Utility.Util.getValueOfDecimal(c)+e.Utility.Util.getValueOfDecimal(o)+e.Utility.Util.getValueOfDecimal(s)).toFixed(At))<e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)>0&&e.Utility.Util.getValueOfDecimal((e.Utility.Util.getValueOfDecimal(c)+e.Utility.Util.getValueOfDecimal(o)+e.Utility.Util.getValueOfDecimal(s)).toFixed(At))>e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)>0&&e.Utility.Util.getValueOfDecimal(c)<0)return e.ADialog.warn("VIS_AppliedAmtleszero"),void t.preventDefault();se.get(t.recid).changes.Writeoff=""!=t.value_new?t.value_new:c,se.refreshCell(t.recid,"Writeoff")}else if(n==t.column){if(e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)<0&&e.Utility.Util.getValueOfDecimal((e.Utility.Util.getValueOfDecimal(c)+e.Utility.Util.getValueOfDecimal(o)+e.Utility.Util.getValueOfDecimal(r)).toFixed(At))<e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)>0&&e.Utility.Util.getValueOfDecimal((e.Utility.Util.getValueOfDecimal(c)+e.Utility.Util.getValueOfDecimal(o)+e.Utility.Util.getValueOfDecimal(r)).toFixed(At))>e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount))return e.ADialog.warn("AppliedAmtgrtr"),void t.preventDefault();if(e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)>0&&e.Utility.Util.getValueOfDecimal(c)<0)return e.ADialog.warn("VIS_AppliedAmtleszero"),void t.preventDefault();se.get(t.recid).changes.Discount=""!=t.value_new?t.value_new:c,se.refreshCell(t.recid,"Discount")}}else t.column>0&&(a==t.column?se.set(t.recid,{AppliedAmt:""!=t.value_new?t.value_new:c}):i==t.column?se.set(t.recid,{Writeoff:""!=t.value_new?t.value_new:c}):n==t.column&&se.set(t.recid,{Discount:""!=t.value_new?t.value_new:c}));if(l==t.column||null==t.column)if(de.is(":checked")){if(0==e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount))return e.ADialog.warn("NotFoundCurrencyRate"),void t.preventDefault();se.get(t.recid).AppliedAmt=e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount)}else se.get(t.recid).AppliedAmt=e.Utility.Util.getValueOfDecimal(se.get(t.recid).Amount);t.column!=se.getColumn("Discount",!0)&&t.column!=se.getColumn("Writeoff",!0)&&t.column!=se.getColumn("AppliedAmt",!0)||va(t.recid,t.column,!0,!1)}(t),Da())},onClick:function(a){!function(a){var i=se.getColumn("AppliedAmt",!0),n=se.getColumn("SelectRow",!0);if(0==a.column||null==a.column){var l=se.getChanges(),s=t.grep(l,function(e,t){return parseInt(e.recid)==parseInt(a.recid)});if(null==s||null==s[0]||0==s.length||null==s[0].SelectRow)se.get(a.recid).AppliedAmt=0,se.get(a.recid).Writeoff=0,se.get(a.recid).Discount=0,se.refreshCell(a.recid,"AppliedAmt"),se.refreshCell(a.recid,"Writeoff"),se.refreshCell(a.recid,"Discount"),Da();else if(1==s[0].SelectRow){if(0==e.Utility.Util.getValueOfInt(Et))Et=se.get(a.recid).C_ConversionType_ID;else if(!(vt&&X||Et==se.get(a.recid).C_ConversionType_ID)){var o=document.getElementsByName(a.target);o.length>0&&(o=o[0]);var r=t(o).find("#grid_openformatgridinvoice_rec_"+a.recid);r.length>0&&(r=r[0]),t(r).find("input:checked").prop("checked")&&t(r).find("input:checked").prop("checked",!1),se.get(a.recid).changes=!1,se.columns[i].editable=!1,se.get(a.recid).changes.AppliedAmt="0",se.refreshCell(a.recid,"AppliedAmt"),se.get(a.recid).changes.Discount="0",se.refreshCell(a.recid,"Discount"),se.get(a.recid).changes.Writeoff="0",se.refreshCell(a.recid,"Writeoff"),e.ADialog.warn("VIS_ConversionNotMatched")}if(de.is(":checked")){if(""==De.val()){e.ADialog.warn("VIS_SlctcnvrsnDate"),se.get(a.recid).changes=!1,se.unselect(a.recid),se.columns[i].editable=!1,se.get(a.recid).changes.AppliedAmt="0",se.refreshCell(a.recid,"AppliedAmt");var c=t("#grid_"+se.name+'_records td[col="0"]').find('input[type="checkbox"]');t(c[a.index]).prop("checked",!1),se.editChange.call(se,c[a.index],a.index,0,a);var u={type:"click",phase:"before",target:"grid",recid:a.recid,index:a.index,isStopped:!1,"isCan//celled":!1,onComplete:null};return se.trigger(u),!1}var d=Globalize.format(new Date(De.val()),"yyyy-MM-dd");Ae.val(Globalize.format(new Date(d),"yyyy-MM-dd"))}else Da()}else se.unselect(a.recid),se.columns[i].editable=!1,se.get(a.recid).changes.AppliedAmt="0",se.refreshCell(a.recid,"AppliedAmt"),se.get(a.recid).changes.Discount="0",se.refreshCell(a.recid,"Discount"),se.get(a.recid).changes.Writeoff="0",se.refreshCell(a.recid,"Writeoff");n!=a.column&&null!=a.column||null==s[0]||null==s[0].SelectRow||(se.get(a.recid).AppliedAmt=e.Utility.Util.getValueOfDecimal(se.get(a.recid).Amount)),va(a.recid,a.column,!0,!1)}}(a),Da()},onDblClick:function(a){!function(a){if(null==se.columns[a.column])return void a.preventDefault();if("AppliedAmt"==se.columns[a.column].field||"Writeoff"==se.columns[a.column].field||"Discount"==se.columns[a.column].field){var i=se.getChanges();if(null==i||0==i.length)return void(se.columns[a.column].editable=!1);var n=t.grep(i,function(e,t){return parseInt(e.recid)==parseInt(a.recid)});if(null==n||null==n[0]||null==n[0].SelectRow)return void(se.columns[a.column].editable=!1);se.columns[a.column].editable={type:"number"},se.columns[a.column].render=function(t,i,n){var l=0;if("AppliedAmt"==se.columns[a.column].field?null==t.changes||null==t.changes.AppliedAmt||null==t.changes.SelectRow?null!=t.changes&&null!=t.changes.SelectRow&&1==t.changes.SelectRow&&null==t.changes.AppliedAmt?(t.changes.AppliedAmt=t.Amount,l=ua(t.changes.AppliedAmt.toString(),ft)):l=0:null!=t.changes&&null!=t.changes.SelectRow&&1==t.changes.SelectRow&&null==t.changes.AppliedAmt?(t.changes.AppliedAmt=t.Amount,l=ua(t.changes.AppliedAmt.toString(),ft)):l=ua(t.changes.AppliedAmt.toString(),ft):"Writeoff"==se.columns[a.column].field?null==t.changes||null==t.changes.Writeoff||null==t.changes.SelectRow?null!=t.changes&&null!=t.changes.SelectRow&&1==t.changes.SelectRow&&null==t.changes.Writeoff?(t.changes.Writeoff=t.Writeoff,l=ua(t.changes.Writeoff.toString(),ft)):l=0:null!=t.changes&&null!=t.changes.SelectRow&&1==t.changes.SelectRow&&null==t.changes.Writeoff?(t.changes.Writeoff=t.Writeoff,l=ua(t.changes.Writeoff.toString(),ft)):l=ua(t.changes.Writeoff.toString(),ft):"Discount"==se.columns[a.column].field&&(null==t.changes||null==t.changes.Discount||null==t.changes.SelectRow?null!=t.changes&&null!=t.changes.SelectRow&&1==t.changes.SelectRow&&null==t.changes.Discount?(t.changes.Discount=t.Discount,l=ua(t.changes.Discount.toString(),ft)):l=0:null!=t.changes&&null!=t.changes.SelectRow&&1==t.changes.SelectRow&&null==t.changes.Discount?(t.changes.Discount=t.Discount,l=ua(t.changes.Discount.toString(),ft)):l=ua(t.changes.Discount.toString(),ft)),parseFloat(l)>0&&parseFloat(l)>parseFloat(t.Amount)||parseFloat(t.Amount)<0&&parseFloat(l)<parseFloat(t.Amount)?(e.ADialog.warn("AppliedAmtgrtr"),l=parseFloat(t.Amount)):parseFloat(t.Amount)>0&&parseFloat(l)<0&&(e.ADialog.warn("VIS_AppliedAmtleszero"),l=parseFloat(t.Amount)),0!=t.Amount&&0!=t.AppliedAmt&&""!=t.OpenAmt&&""!=t.AppliedAmt&&null!=t.changes&&1==t.changes.SelectRow&&parseFloat(t.Amount)===t.AppliedAmt&&parseFloat(t.changes.AppliedAmt)==t.AppliedAmt){if(0!=t.changes.Discount||0!=t.changes.Writeoff){var s=parseFloat(t.changes.Discount)+parseFloat(t.changes.Writeoff)+parseFloat(t.changes.AppliedAmt);Math.abs(s)>Math.abs(parseFloat(t.Amount))&&(e.ADialog.warn("AppliedAmtgrtr"),"Discount"==se.columns[a.column].field?(t.changes.Discount=0,l=t.changes.Discount):"Writeoff"==se.columns[a.column].field?(t.changes.Writeoff=0,l=t.changes.Writeoff):"AppliedAmt"==se.columns[a.column].field&&(t.changes.AppliedAmt=0,l=t.changes.AppliedAmt))}Ia()}return parseFloat(l).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})}}}(a)},onSelect:function(e){e.all&&(e.onComplete=function(){$.find("#grid_openformatgridinvoice_"+c.windowNo+"_records").on("scroll",ia)})},onEditField:function(e){e.onComplete=function(e){id=e.recid,t("#grid_openformatgridinvoice_"+c.windowNo+"_edit_"+id+"_"+e.column).keydown(function(e){var t=Bt.isDecimalSeparatorDot(window.navigator.language);return!!(t||190!=e.keyCode&&110!=e.keyCode)&&((!t||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which||(this.value=this.value.replace(".","")),!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||(this.value=this.value.replace(",","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))})}}}),at>0)for(var g=0;g<at;g++){i=t("#grid_"+se.name+'_records td[col="0"]').find('input[type="checkbox"]');t(i[g]).prop("checked",!0),se.editChange.call(se,i[g],g,0,event);var p={type:"click",phase:"before",target:"grid",recid:g,index:g,isStopped:!1,"isCan//celled":!1,onComplete:null};se.trigger(p)}at=0,se.autoLoad=!0,t(t(se.box)[0]).find(".w2ui-search-down").css("margin-top","4px"),t(t(se.box)[0]).find(".w2ui-search-clear").css("margin-top","4px")}function ua(e,t){var a=0;return"string"==typeof e||(e=e.toString()),t?(e.contains("−")?e=(-1*mt.GetConvertedNumber(e,t)).toString():e.contains(".")&&(e=mt.GetConvertedNumber(e,t).toString()),a=""!=e?e:a):(e.contains("−")&&!e.contains(".")?e=(-1*mt.GetConvertedNumber(e,t)).toString():e.contains(",")&&(e=mt.GetConvertedNumber(e,t).toString()),a=""!=e?e:a),a}function da(t,a,i){var n=!1;if(t.value_new=e.Utility.Util.getValueOfString(a),t.value_new.contains(".")){n=!0;for(var l=[],s=0;s<t.value_new.length;s++)"."===t.value_new[s]&&l.push(s);l.length>1&&(t.value_new=ga(t.value_new,"."))}if(t.value_new.contains(","))if(n)t.value_new=ga(t.value_new,",");else{for(l=[],s=0;s<t.value_new.length;s++)","===t.value_new[s]&&l.push(s);l.length>1?t.value_new=ga(t.value_new,","):t.value_new=t.value_new.replace(",",".")}return""==t.value_new&&(t.value_new="0"),t.value_new}function ga(e,t){var a=e.split(t);return(e=a.slice(0,-1).join("")+"."+a.slice(-1)).indexOf(".")==e.length-1&&(e=e.replace(".","")),e}function pa(e,t){var a=e.split(t);return(e=a.slice(0,-1).join("")+a.slice(-1)).indexOf("."==t?",":".")==e.length-1&&(e=e.replace("."==t?",":".","")),e}function va(e,t,a,i){var n=e,l=t;null!=l&&null!=l||(l=0);if(a||i){if(i){if(0==l){o=le.columns;st=Aa(le.getChanges(),n);r=o[ye=_a(o,"AppliedAmt")].field,c=le.get(n).changes;if(st){d={SelectRow:(u=le.get(n)).SelectRow,Date1:u.Date1,ReceiptNo:u.ReceiptNo,VSS_paymenttype:u.VSS_paymenttype,Isocode:u.Isocode,CcashlineiID:u.CcashlineiID,Amount:u.Amount,OpenAmt:u.OpenAmt,Payment:u.Payment,Multiplierap:u.Multiplierap,DocBaseType:u.DocBaseType,ConvertedAmount:u.ConvertedAmount,AppliedAmt:u.AppliedAmt,C_ConversionType_ID:u.C_ConversionType_ID,ConversionName:u.ConversionName,DATEACCT:u.DATEACCT,AD_Org_ID:u.AD_Org_ID,OrgName:u.OrgName};Ye.push(d),Te=_a(o,"OpenAmt");g=parseFloat(le.get(n)[o[Te].field]);_value=pa(parseFloat(g).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At}),ft?",":"."),"AppliedAmt"==r&&(null!=c&&null!=c?(c.AppliedAmt=_value,le.refreshCell(n,"AppliedAmt")):le.set(n,{AppliedAmt:_value}))}else{for(v=0;v<Ye.length;v++)Ye[v].CcashlineiID==le.get(n).CcashlineiID&&Ye.splice(v,1);"AppliedAmt"==r&&(null!=c&&null!=c?(c.AppliedAmt=g,le.get(n).AppliedAmt=0,le.refreshCell(n,"AppliedAmt")):le.set(n,{AppliedAmt:0}));for(_=!1,V=0;V<se.getChanges().length;V++)null!=se.getChanges()[V].SelectRow&&0!=se.getChanges()[V].SelectRow&&(_=!0);for(A=!1,V=0;V<le.getChanges().length;V++)null!=le.getChanges()[V].SelectRow&&0!=le.getChanges()[V].SelectRow&&(A=!0);for(m=!1,V=0;V<ne.getChanges().length;V++)null!=ne.getChanges()[V].SelectRow&&0!=ne.getChanges()[V].SelectRow&&(m=!0);for(f=!1,V=0;V<Z.getChanges().length;V++)null!=Z.getChanges()[V].SelectRow&&0!=Z.getChanges()[V].SelectRow&&(f=!0);f||_||A||m||(Et=0),le.columns[ye].editable=!1}}}else if(0==l){o=se.columns;nt=Aa(se.getChanges(),n);c=se.get(n).changes,o[_a(o,"Writeoff")].field;var s=o[Me=_a(o,"AppliedAmt")].field;if(nt){d={SelectRow:(u=se.get(n)).SelectRow,InvoiceRecord:u.InvoiceRecord,Date1:u.Date1,Documentno:u.Documentno,CinvoiceID:u.CinvoiceID,Isocode:u.Isocode,Currency:u.Currency,Converted:u.Converted,Amount:u.Amount,Discount:u.Discount,Multiplierap:u.Multiplierap,DocBaseType:u.DocBaseType,Writeoff:u.Writeoff,AppliedAmt:u.AppliedAmt,C_InvoicePaySchedule_ID:u.C_InvoicePaySchedule_ID,InvoiceScheduleDate:u.InvoiceScheduleDate,C_ConversionType_ID:u.C_ConversionType_ID,ConversionName:u.ConversionName,DATEACCT:u.DATEACCT,AD_Org_ID:u.AD_Org_ID,OrgName:u.OrgName,PayName:u.PayName};tt.push(d),Pe=_a(o,"Amount");g=parseFloat(se.get(n)[o[Pe].field]);be=_a(o,"Discount"),g-=parseFloat(se.get(n)[o[be].field]),_value=pa(parseFloat(g).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At}),ft?",":"."),"AppliedAmt"==s&&(null!=c&&null!=c?(c.Writeoff=0,c.AppliedAmt=_value,be=_a(o,"Discount"),c.Discount=pa(parseFloat(se.get(n)[o[be].field]).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At}),ft?",":"."),se.refreshCell(n,"Writeoff"),se.refreshCell(n,"AppliedAmt"),se.refreshCell(n,"Discount")):(se.set(n,{Writeoff:0}),se.set(n,{AppliedAmt:_value})))}else{for(v=0;v<tt.length;v++)tt[v].C_InvoicePaySchedule_ID==se.get(n).C_InvoicePaySchedule_ID&&tt.splice(v,1);"AppliedAmt"==s&&null!=c&&null!=c&&(c.Writeoff=g,c.AppliedAmt=g,c.Discount=g,be=_a(o,"Discount"),se.get(n).AppliedAmt=0,se.refreshCell(n,"Writeoff"),se.refreshCell(n,"AppliedAmt"),se.refreshCell(n,"Discount"));for(_=!1,V=0;V<se.getChanges().length;V++)null!=se.getChanges()[V].SelectRow&&0!=se.getChanges()[V].SelectRow&&(_=!0);for(A=!1,V=0;V<le.getChanges().length;V++)null!=le.getChanges()[V].SelectRow&&0!=le.getChanges()[V].SelectRow&&(A=!0);for(m=!1,V=0;V<ne.getChanges().length;V++)null!=ne.getChanges()[V].SelectRow&&0!=ne.getChanges()[V].SelectRow&&(m=!0);for(f=!1,V=0;V<Z.getChanges().length;V++)null!=Z.getChanges()[V].SelectRow&&0!=Z.getChanges()[V].SelectRow&&(f=!0);f||_||A||m||(Et=0),se.columns[Me].editable=!1}}}else if(0==l){var o=ne.columns;lt=Aa(ne.getChanges(),n);var r=o[Ie=_a(o,"AppliedAmt")].field,c=ne.get(n).changes;if(lt){var u,d={SelectRow:(u=ne.get(n)).SelectRow,Date1:u.Date1,Documentno:u.Documentno,CpaymentID:u.CpaymentID,Isocode:u.Isocode,ConvertedAmount:u.ConvertedAmount,OpenAmt:u.OpenAmt,Payment:u.Payment,Multiplierap:u.Multiplierap,DocBaseType:u.DocBaseType,AppliedAmt:u.AppliedAmt,C_ConversionType_ID:u.C_ConversionType_ID,ConversionName:u.ConversionName,DATEACCT:u.DATEACCT,AD_Org_ID:u.AD_Org_ID,OrgName:u.OrgName,PayName:u.PayName};Ze.push(d),we=_a(o,"OpenAmt");var g=parseFloat(ne.get(n)[o[we].field]);_value=pa(parseFloat(g).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At}),ft?",":".");var p=_a(o,"Date1");new Date(ne.get(n)[o[p].field]),"AppliedAmt"==r&&(null!=c&&null!=c?(c.AppliedAmt=_value,ne.refreshCell(n,"AppliedAmt")):ne.set(n,{AppliedAmt:_value}))}else{for(var v=0;v<Ze.length;v++)Ze[v].CpaymentID==ne.get(n).CpaymentID&&Ze.splice(v,1);"AppliedAmt"==r&&(null!=c&&null!=c?(c.AppliedAmt=g,ne.get(n).AppliedAmt=0,ne.refreshCell(n,"AppliedAmt")):ne.set(n,{AppliedAmt:0}));for(var _=!1,V=0;V<se.getChanges().length;V++)null!=se.getChanges()[V].SelectRow&&0!=se.getChanges()[V].SelectRow&&(_=!0);for(var A=!1,V=0;V<le.getChanges().length;V++)null!=le.getChanges()[V].SelectRow&&0!=le.getChanges()[V].SelectRow&&(A=!0);for(var m=!1,V=0;V<ne.getChanges().length;V++)null!=ne.getChanges()[V].SelectRow&&0!=ne.getChanges()[V].SelectRow&&(m=!0);for(var f=!1,V=0;V<Z.getChanges().length;V++)null!=Z.getChanges()[V].SelectRow&&0!=Z.getChanges()[V].SelectRow&&(f=!0);f||_||A||m||(Et=0),ne.columns[Ie].editable=!1}}Ia()}function _a(e,t){for(var a=0,i=0;i<e.length;i++)if(e[i].field==t){a=i;break}return a}function Va(e,t){var a=e,i=t;null!=i&&null!=i||(i=0);if(0==i){var n=Z.columns;ee=Aa(Z.getChanges(),a);var l,s=n[10].field;if(Z.get(a)&&(l=Z.get(a).changes),ee){for(var o=null,r=0;Z.records.length;r++)if(Z.records[r].recid==parseInt(a)){o=Z.records[r];break}var c={SelectRow:o.SelectRow,GLRecords:l.GLRecords,Date1:o.Date1,DOCUMENTNO:o.DOCUMENTNO,Account:o.Account,DATEDOC:o.DATEDOC,Isocode:o.Isocode,GL_JOURNALLINE_ID:o.GL_JOURNALLINE_ID,GL_Journal_ID:o.GL_Journal_ID,OpenAmount:o.OpenAmount,ConvertedAmount:o.ConvertedAmount,AppliedAmt:o.AppliedAmt,C_ConversionType_ID:o.C_ConversionType_ID,ConversionName:o.ConversionName,DATEACCT:o.DATEACCT,AD_Org_ID:o.AD_Org_ID,OrgName:o.OrgName};je.push(c);var u=parseFloat(Z.get(a)[n[9].field]);new Date(Z.get(a)[n[11].field]),"AppliedAmt"==s&&null!=l&&null!=l&&(l.AppliedAmt=u,Z.set(a,{AppliedAmt:u}),Z.refreshCell(a,"AppliedAmt"))}else{for(var d=0;d<je.length;d++)je[d].GL_JOURNALLINE_ID==Z.get(a).GL_JOURNALLINE_ID&&je.splice(d,1);"AppliedAmt"==s&&null!=l&&null!=l&&(l.AppliedAmt=u,Z.get(a).AppliedAmt=0,Z.refreshCell(a,"AppliedAmt"));for(var g=!1,p=0;p<se.getChanges().length;p++)null!=se.getChanges()[p].SelectRow&&0!=se.getChanges()[p].SelectRow&&(g=!0);var v=!1;for(p=0;p<le.getChanges().length;p++)null!=le.getChanges()[p].SelectRow&&0!=le.getChanges()[p].SelectRow&&(v=!0);var _=!1;for(p=0;p<ne.getChanges().length;p++)null!=ne.getChanges()[p].SelectRow&&0!=ne.getChanges()[p].SelectRow&&(_=!0);var V=!1;for(p=0;p<Z.getChanges().length;p++)null!=Z.getChanges()[p].SelectRow&&0!=Z.getChanges()[p].SelectRow&&(V=!0);V||g||v||_||(Et=0)}}Ia()}function Aa(e,a){if(null==e||0==e.length)return!1;var i=t.grep(e,function(e,t){return parseInt(e.recid)==a});return null!=i&&null!=i[0]&&0!=i.length&&null!=i[0].SelectRow&&i[0].SelectRow}function ma(){Sa(D.getName(),D.value)}function fa(){Sa(h.getName(),h.getValue())}function Da(){kt=[],_dateAcct=[];for(var e=0;e<ne.getChanges().length;e++)if(void 0===ne.getChanges()[e].SelectRow);else if(1==ne.getChanges()[e].SelectRow){var t=ne.get(ne.getChanges()[e].recid).DATEACCT;kt.push(new Date(t));var a=ne.get(ne.getChanges()[e].recid).DATEACCT;_dateAcct.push(new Date(a)),Ae.val(Globalize.format(new Date(Math.max.apply(null,_dateAcct)),"yyyy-MM-dd"))}for(e=0;e<se.getChanges().length;e++)if(void 0===se.getChanges()[e].SelectRow);else if(1==se.getChanges()[e].SelectRow){t=se.get(se.getChanges()[e].recid).Date1;if(kt.push(new Date(t)),0==ne.getChanges().length&&0==le.getChanges().length&&0==Z.getChanges().length){a=se.get(se.getChanges()[e].recid).DATEACCT;_dateAcct.push(new Date(a)),Ae.val(Globalize.format(new Date(Math.max.apply(null,_dateAcct)),"yyyy-MM-dd"))}}for(e=0;e<le.getChanges().length;e++)if(void 0===le.getChanges()[e].SelectRow);else if(1==le.getChanges()[e].SelectRow){t=le.get(le.getChanges()[e].recid).DATEACCT;if(kt.push(new Date(t)),0==ne.getChanges().length&&0==se.getChanges().length&&0==Z.getChanges().length){a=le.get(le.getChanges()[e].recid).DATEACCT;_dateAcct.push(new Date(a)),Ae.val(Globalize.format(new Date(Math.max.apply(null,_dateAcct)),"yyyy-MM-dd"))}}for(e=0;e<Z.getChanges().length;e++)if(void 0===Z.getChanges()[e].SelectRow);else if(1==Z.getChanges()[e].SelectRow){t=null;for(var i=0;Z.records.length;i++)if(Z.records[i].recid==Z.getChanges()[e].recid){t=Z.records[i].DATEACCT;break}if(kt.push(new Date(t)),0==ne.getChanges().length&&0==le.getChanges().length&&0==se.getChanges().length){for(a=null,i=0;Z.records.length;i++)if(Z.records[i].recid==Z.getChanges()[e].recid){a=Z.records[i].DATEACCT;break}_dateAcct.push(new Date(a)),Ae.val(Globalize.format(new Date(Math.max.apply(null,_dateAcct)),"yyyy-MM-dd"))}}ue=new Date(Math.max.apply(null,kt)),0!=kt.length&&"Invalid Date"!=kt||(ue=new Date),Ae.val(Globalize.format(ue,"yyyy-MM-dd"))}function ha(){if(Ce>0){var a=de.is(":checked");if(0==(Se=I.val()))return e.ADialog.info("Message",!0,"select currency","");if(AD_Org_ID=f.val(),i=k.val(),n=G.val(),srchText=Fe.val(),gt[0].style.visibility="visible",bt=1,Mt=1,xt=0,Ut=!1,""!=n&&i>n)return G.val(""),e.ADialog.info("Message",!0,e.Msg.getMsg("VIS_FromDateGreater"),"");null!=i&&null!=i&&""!=i&&e.DB.to_date(i),null!=n&&null!=n&&""!=n&&e.DB.to_date(n),t.ajax({url:e.Application.contextUrl+"VIS/PaymentAllocation/GetGLData",dataType:"json",data:{AD_Org_ID,_C_Currency_ID:Se,_C_BPartner_ID:Ce,page:bt,size:Dt,fromDate:i,toDate:n,srchText,chk:a,isInterComp:Ve},async:!0,success:function(e){var t=JSON.parse(e);if(t){if(1==bt&&t.length>0&&(xt=t[0].GLRecords,Mt=Math.ceil(xt/Dt)),je.length>0){ze=je.length;for(var i=0;i<t.length;i++){0==je.filter(function(e){return e.GL_JOURNALLINE_ID==t[i].GL_JOURNALLINE_ID}).length&&(t[i].recid=je.length+i,je.push(t[i]))}t=je,je=[]}na(t,a),W.find("#grid_openformatglgrid_"+c.windowNo+"_records").on("scroll",ea),Ut=!0,Xt()}},error:function(e){gt[0].style.visibility="hidden"}})}}function Ca(){kt=[],Gt=!0;for(var e=0;e<ne.getChanges().length;e++)if(void 0===ne.getChanges()[e].SelectRow);else if(1==ne.getChanges()[e].SelectRow){var t=ne.get(ne.getChanges()[e].recid).DATEACCT;Gt&&parseInt(y.val())!=parseInt(ne.get(ne.getChanges()[e].recid).AD_Org_ID)&&(Gt=!1),kt.push(new Date(t))}for(e=0;e<se.getChanges().length;e++)if(void 0===se.getChanges()[e].SelectRow);else if(1==se.getChanges()[e].SelectRow){t=se.get(se.getChanges()[e].recid).Date1;Gt&&parseInt(y.val())!=parseInt(se.get(se.getChanges()[e].recid).AD_Org_ID)&&(Gt=!1),kt.push(new Date(t))}for(e=0;e<le.getChanges().length;e++)if(void 0===le.getChanges()[e].SelectRow);else if(1==le.getChanges()[e].SelectRow){t=le.get(le.getChanges()[e].recid).DATEACCT;Gt&&parseInt(y.val())!=parseInt(le.get(le.getChanges()[e].recid).AD_Org_ID)&&(Gt=!1),kt.push(new Date(t))}for(e=0;e<Z.getChanges().length;e++)if(void 0===Z.getChanges()[e].SelectRow);else if(1==Z.getChanges()[e].SelectRow){t=Z.get(Z.getChanges()[e].recid).DATEACCT;kt.push(new Date(t))}return 0!=kt.length}function Sa(e,t){if("C_BPartner_ID"!=e&&null==t)return $t(),void ba();"C_BPartner_ID"==e?(Ce=t)>0&&D.getControl().removeClass("vis-ev-col-mandatory"):"C_Currency_ID"==e?(Se=parseInt(t),Zt()):"Date"==e&&de&&ya()}function Ia(){gt[0].style.visibility="visible";var t=e.DisplayType.GetNumberFormat(e.DisplayType.Amount),a=new Date;a=null;var i=parseFloat(0);Ue=0;var n=null,l=null,s=null,o=null;if(ne&&(n=ne.getChanges()),le&&(l=le.getChanges()),se&&(s=se.getChanges()),Z&&(o=Z.getChanges()),null!=n){for(var r=0;r<n.length;r++)if(1==n[r].SelectRow){var c=ne.get(n[r].recid),u=new Date(c.Date1);a=(new e.TimeUtil).max(a,u);var d=Object.keys(c);""!=n[r][d[d.indexOf("AppliedAmt")]]&&null!=n[r][d[d.indexOf("AppliedAmt")]]?(_=n[r][d[d.indexOf("AppliedAmt")]].toString().contains("-")||n[r][d[d.indexOf("AppliedAmt")]].toString().contains("−")?(-1*Math.abs(t.GetConvertedNumber(n[r][d[d.indexOf("AppliedAmt")]].toString(),ft))).toFixed(At):t.GetConvertedNumber(n[r][d[d.indexOf("AppliedAmt")]].toString(),ft).toFixed(At),_=parseFloat(_)):(_=0,console.log("Payment Row: "+n[r][d[d.indexOf("AppliedAmt")]]+", RowNo:-"+r)),i+=isNaN(_)?0:_,Ue++}i=i.toFixed(At),i=parseFloat(i)}xe.text(Ue+" "+e.Msg.getMsg("SelectedLines")+" - "+"Σ "+parseFloat(i).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})+" ");var g=parseFloat(0);if(Ee=0,null!=l){for(r=0;r<l.length;r++)if(1==l[r].SelectRow){c=le.get(l[r].recid),u=new Date(c.Created);a=(new e.TimeUtil).max(a,u);d=Object.keys(c);""!=l[r][d[d.indexOf("AppliedAmt")]]&&null!=l[r][d[d.indexOf("AppliedAmt")]]?(_=l[r][d[d.indexOf("AppliedAmt")]].toString().contains("-")||l[r][d[d.indexOf("AppliedAmt")]].toString().contains("−")?(-1*Math.abs(t.GetConvertedNumber(l[r][d[d.indexOf("AppliedAmt")]].toString(),ft))).toFixed(At):t.GetConvertedNumber(l[r][d[d.indexOf("AppliedAmt")]].toString(),ft).toFixed(At),_=parseFloat(_)):(_=0,console.log("Cash Row: "+l[r][d[d.indexOf("AppliedAmt")]]+", RowNo:-"+r)),g+=isNaN(_)?0:_,Ee++}g=g.toFixed(At),g=parseFloat(g)}Ne.text(Ee+" "+e.Msg.getMsg("SelectedLines")+" - "+"Σ "+parseFloat(g).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})+" ");var p=parseFloat(0);if(Re=0,null!=s){for(r=0;r<s.length;r++)if(1==s[r].SelectRow){c=se.get(s[r].recid);"Invalid Date"==(u=Vt>0?new Date(c.InvoiceScheduleDate):new Date(c.Date1))&&(u=new Date(c.Date1)),a=(new e.TimeUtil).max(a,u);d=Object.keys(c);""!=s[r][d[d.indexOf("AppliedAmt")]]&&null!=s[r][d[d.indexOf("AppliedAmt")]]?(_=s[r][d[d.indexOf("AppliedAmt")]].toString().contains("-")||s[r][d[d.indexOf("AppliedAmt")]].toString().contains("−")?(-1*Math.abs(t.GetConvertedNumber(s[r][d[d.indexOf("AppliedAmt")]].toString(),ft))).toFixed(At):t.GetConvertedNumber(s[r][d[d.indexOf("AppliedAmt")]].toString(),ft).toFixed(At),_=parseFloat(_)):(_=0,console.log("Invoice Row: "+s[r][d[d.indexOf("AppliedAmt")]]+", RowNo:-"+r)),p+=isNaN(_)?0:_,Re++}p=p.toFixed(At),p=parseFloat(p)}Le.text(Re+" "+e.Msg.getMsg("SelectedLines")+" - "+"Σ "+parseFloat(p).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})+" ");var v=parseFloat(0);if(K=0,null!=o){for(r=0;r<o.length;r++)if(1==o[r].SelectRow){c=Z.get(o[r].recid);u=new Date(c.Date1),a=(new e.TimeUtil).max(a,u);var _;d=Object.keys(c);""!=o[r][d[d.indexOf("AppliedAmt")]]&&null!=o[r][d[d.indexOf("AppliedAmt")]]?(_=parseFloat(o[r][d[d.indexOf("AppliedAmt")]]).toFixed(At),_=parseFloat(_)):(_=0,console.log("GL Row: "+o[r][d[d.indexOf("AppliedAmt")]]+", RowNo:-"+r)),v+=isNaN(_)?0:_,K++}v=v.toFixed(At),v=parseFloat(v)}Y.text(K+" "+e.Msg.getMsg("SelectedLines")+" - "+"Σ "+parseFloat(v).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At})+" "),null!=I.children("option").filter(":selected").text()&&dt.text(I.children("option").filter(":selected").text());var V=parseFloat(i+g-(p+v)).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At});rt.text(V),parseFloat(V)==parseFloat(0)?(ct.prop("readonly",!1),ct.css({"pointer-events":"auto",opacity:"1"})):(ct.prop("readonly",!0),ct.css({"pointer-events":"none",opacity:"0.5"})),gt[0].style.visibility="hidden"}function ya(){var a=parseFloat(0).toLocaleString(navigator.language,{minimumFractionDigits:At,maximumFractionDigits:At});xe.text("0 "+e.Msg.getMsg("SelectedLines")+" - "+"Σ "+a+" "),Ne.text("0 "+e.Msg.getMsg("SelectedLines")+" - "+"Σ "+a+" "),Le.text("0 "+e.Msg.getMsg("SelectedLines")+" - "+"Σ "+a+" "),Y.text("0 "+e.Msg.getMsg("SelectedLines")+" - "+"Σ "+a+" "),rt.text(a),oe.prop("checked",!1),re.prop("checked",!1),ce.prop("checked",!1),H.prop("checked",!1),t(".vis-allocation-payment-grid, .vis-allocation-cashLine-grid, .vis-allocation-invoice-grid, .vis-allocation-gl-grid").css("height","80%"),t("#cashMaindiv").css("display","none"),t("#glMaindiv").css("display","none"),Oa()}function Oa(){de.is(":checked")?(he.css("display","block"),"I"==J.val()&&"P"==j.val()||"P"==J.val()&&"I"==j.val()||"I"==J.val()&&"I"==j.val()?g.find(".vis-conversionType").css("display","block"):(g.find(".vis-conversionType").css("display","none"),h.getControl().val(""))):(he.css("display","none"),g.find(".vis-conversionType").css("display","none"),h.getControl().val(""))}function Ta(){var e,t;if(null!=ne&&(e=ne.getChanges()),null!=le&&(t=le.getChanges()),re.prop("checked",!1),ce.prop("checked",!1),q.prop("checked",!1),vt){if(vt=!0,_t=!1,null!=t){for(a=0;a<t.length;a++){if(Aa(le.getChanges(),t[a].recid))null!=(i=le.get(t[a].recid).changes)&&null!=i&&(i.SelectRow=!1,i.AppliedAmt=0,le.refreshCell(t[a].recid,"SelectRow"),le.refreshCell(t[a].recid,"AppliedAmt"))}le&&le.refresh()}_.css("display","none"),v.css("display",""),ne&&ne.refresh()}else{if(vt=!1,_t=!0,null!=e){for(var a=0;a<e.length;a++){var i;if(Aa(ne.getChanges(),e[a].recid))null!=(i=ne.get(e[a].recid).changes)&&null!=i&&(i.SelectRow=!1,i.AppliedAmt=0,ne.refreshCell(e[a].recid,"SelectRow"),ne.refreshCell(e[a].recid,"AppliedAmt"))}ne&&ne.refresh()}v.css("display","none"),_.css("display",""),le&&le.refresh()}Ia()}function wa(){var e=!0;e&&Pa()}function Pa(){gt[0].style.visibility="visible";var a=ne.getChanges(),i=le.getChanges(),n=se.getChanges(),l=Z.getChanges(),s=(me.val(),Ae.val());"G"==J.val()||"G"==j.val()?function(a,i,n,l){t.ajax({url:e.Application.contextUrl+"VIS/PaymentAllocation/CheckPeriodState",data:{DateTrx:me.val(),AD_Org_ID:y.val()},async:!1,success:function(s){if(""!=s)return e.ADialog.info("",!0,s,""),ot=!0,Yt(),gt[0].style.visibility="hidden","";gt[0].style.visibility="visible";var o="",r="",c="",u="",d="",g=0,p=[],v=[],_=[],V=[],A=de.is(":checked");if(A)var m=Globalize.format(new Date(De.val()),"yyyy-MM-dd");else m=Globalize.format(new Date,"yyyy-MM-dd");if(a.length>0){o=(C=Object.keys(ne.get(0)))[C.indexOf("AppliedAmt")];for(var f=0;f<a.length;f++){var D=ne.get(a[f].recid);if(g=parseInt(D.C_ConversionType_ID),null!=a[f].AppliedAmt&&0!=a[f].AppliedAmt)h=ua(h=a[f].AppliedAmt,ft),p.push({AppliedAmt:h,Date:D.Date1,Converted:D.ConvertedAmount,cpaymentid:D.CpaymentID,Documentno:D.Documentno,Isocode:D.Isocode,Multiplierap:D.Multiplierap,OpenAmt:D.OpenAmt,Payment:D.Payment,Org:parseInt(y.val()),IsPaid:!1,paidAmt:0,payment:o})}}if(n.length>0){o=(C=Object.keys(le.get(0)))[C.indexOf("AppliedAmt")];for(f=0;f<n.length;f++){var h;D=le.get(n[f].recid);if(g=parseInt(D.C_ConversionType_ID),0!=n[f].AppliedAmt&&null!=n[f].AppliedAmt)h=ua(h=n[f].AppliedAmt,ft),v.push({AppliedAmt:h,Date:D.Created,Amount:D.Amount,ccashlineid:D.CcashlineiID,Converted:D.ConvertedAmount,Isocode:D.Isocode,Multiplierap:D.Multiplierap,OpenAmt:D.OpenAmt,ReceiptNo:D.ReceiptNo,Org:parseInt(y.val()),IsPaid:!1,paidAmt:0,payment:o})}}if(i.length>0){var C;r=(C=Object.keys(se.get(0)))[C.indexOf("AppliedAmt")],c=C[C.indexOf("Discount")],u=C[C.indexOf("Writeoff")],d=C[C.indexOf("Amount")];for(f=0;f<i.length;f++){D=se.get(i[f].recid);g=parseInt(D.C_ConversionType_ID);var S=i[f].Discount;null==S&&(S=D.Discount);var I=i[f].AppliedAmt;null==I&&(I=D.AppliedAmt);var O=i[f].Writeoff;null==O&&(O=D.Writeoff),0!=I&&null!=I&&(I=ua(I,ft),S=ua(S,ft),O=ua(O,ft),Vt<=0?V.push({AppliedAmt:I,Discount:S,Writeoff:O,cinvoiceid:D.CinvoiceID,Converted:D.Converted,Currency:D.Currency,Date:D.Date1,Docbasetype:D.DocBaseType,applied:r,discount:c,open:d,writeOff:u,documentno:D.Documentno,Isocode:D.Isocode,Multiplierap:D.Multiplierap,Amount:D.Amount,Org:parseInt(y.val()),IsPaid:!1,paidAmt:0}):V.push({AppliedAmt:I,Discount:S,Writeoff:O,cinvoiceid:D.CinvoiceID,Converted:D.Converted,Currency:D.Currency,Date:D.InvoiceScheduleDate,Docbasetype:D.DocBaseType,applied:r,discount:c,open:d,writeOff:u,documentno:D.Documentno,Isocode:D.Isocode,Multiplierap:D.Multiplierap,Amount:D.Amount,c_invoicepayschedule_id:D.C_InvoicePaySchedule_ID,Org:parseInt(y.val()),IsPaid:!1,paidAmt:0}))}}if(l.length>0)for(f=0;f<l.length;f++){D=Z.get(l[f].recid);g=parseInt(D.C_ConversionType_ID),null!=l[f].AppliedAmt&&0!=l[f].AppliedAmt&&_.push({AppliedAmt:l[f].AppliedAmt,Date:D.DATEACCT,DateDoc:D.DATEDOC,DocumentNo:D.DOCUMENTNO,OpenAmount:D.OpenAmount,GL_JournalLine_ID:D.GL_JOURNALLINE_ID,GL_Journal_ID:D.GL_Journal_ID,ConvertedAmount:D.ConvertedAmount,Org:parseInt(y.val()),IsPaid:!1,paidAmt:0})}!function(a,i,n,l,s,o,r,c,u,d,g,p,v){t.ajax({url:e.Application.contextUrl+"VIS/PaymentAllocation/saveGLJData",type:"POST",data:{paymentData:a,invoiceData:i,cashData:n,glData:l,DateTrx:s,_windowNo:pt.windowNo,C_Currency_ID:Se,C_BPartner_ID:Ce,AD_Org_ID:y.val(),C_CurrencyType_ID:o,DateAcct:Ae.val(),applied:r,discount:c,open:u,payment:d,writeOff:g,conversionDate:p,chk:v},async:!1,success:function(t){tt=[],Ze=[],Ye=[],je=[],ie=[],ot=!0,Yt(),le&&le.refresh(),Z&&Z.refresh(),se&&se.refresh(),ne&&ne.refresh();var a=e.DisplayType.GetNumberFormat(e.DisplayType.Amount);Y.text("0 "+e.Msg.getMsg("SelectedLines")+" - "+"Σ "+a.GetFormatedValue(0)+" "),rt.text(a.GetFormatedValue(0)),gt[0].style.visibility="hidden",e.ADialog.info("",!0,t,"")},error:function(t){e.ADialog.info("",!0,t,""),gt[0].style.visibility="hidden"}})}(JSON.stringify(p),JSON.stringify(V),JSON.stringify(v),JSON.stringify(_),me.val(),g,r,c,d,o,u,m,A)},error:function(t){e.ADialog.info("",!0,t,""),gt[0].style.visibility="hidden"}})}(a,n,i,l):"C"==J.val()||"C"==j.val()?function(a,i,n,l,s){if(Re+Ee==0)return"";t.ajax({url:e.Application.contextUrl+"PaymentAllocation/CheckPeriodState",data:{DateTrx:Ae.val(),AD_Org_ID:y.val()},async:!1,success:function(l){if(""!=l)return e.ADialog.info("",!0,l,""),ot=!0,Yt(),gt[0].style.visibility="hidden","";for(var o="",r="",c="",u="",d="",g=0,p=[],v=[],_=[],V=0;V<a.length;V++){var A=ne.get(a[V].recid);if(g=parseInt(A.C_ConversionType_ID),0!=a[V].AppliedAmt&&null!=a[V].AppliedAmt)D=ua(D=a[V].AppliedAmt,ft),p.push({AppliedAmt:D,Date:A.Date1,Converted:A.ConvertedAmount,CpaymentID:A.CpaymentID,Documentno:A.Documentno,Isocode:A.Isocode,Multiplierap:A.Multiplierap,OpenAmt:A.OpenAmt,Payment:A.Payment,Org:parseInt(y.val()),IsPaid:!1,paidAmt:0})}var m=de.is(":checked");if(m)var f=Globalize.format(new Date(De.val()),"yyyy-MM-dd");else f=Globalize.format(new Date,"yyyy-MM-dd");if(i.length>0){o=(h=Object.keys(le.get(0)))[h.indexOf("AppliedAmt")],r=h[h.indexOf("AppliedAmt")];for(V=0;V<i.length;V++){var D;A=le.get(i[V].recid);if(g=parseInt(A.C_ConversionType_ID),0!=i[V].AppliedAmt&&null!=i[V].AppliedAmt)D=ua(D=i[V].AppliedAmt,ft),v.push({AppliedAmt:D,Date:A.Created,Amount:A.Amount,ccashlineid:A.CcashlineiID,Converted:A.ConvertedAmount,Isocode:A.Isocode,Multiplierap:A.Multiplierap,OpenAmt:A.OpenAmt,ReceiptNo:A.ReceiptNo,Org:parseInt(y.val()),IsPaid:!1,paidAmt:0})}}if(n.length>0){var h;r=(h=Object.keys(se.get(0)))[h.indexOf("AppliedAmt")],c=h[h.indexOf("Discount")],u=h[h.indexOf("Writeoff")],d=h[h.indexOf("Amount")];for(V=0;V<n.length;V++){A=se.get(n[V].recid);g=parseInt(A.C_ConversionType_ID);var C=n[V].Discount;null==C&&(C=A.Discount);var S=n[V].AppliedAmt;null==S&&(S=A.AppliedAmt);var O=n[V].Writeoff;null==O&&(O=A.Writeoff),0!=S&&null!=S&&(S=ua(S,ft),C=ua(C,ft),O=ua(O,ft),Vt<=0?_.push({AppliedAmt:S,Discount:C,Writeoff:O,cinvoiceid:A.CinvoiceID,Converted:A.Converted,Currency:A.Currency,Date:A.Date1,Docbasetype:A.DocBaseType,documentno:A.Documentno,Isocode:A.Isocode,Multiplierap:A.Multiplierap,Amount:A.Amount,Org:parseInt(y.val()),IsPaid:!1,paidAmt:0}):_.push({AppliedAmt:S,Discount:C,Writeoff:O,cinvoiceid:A.CinvoiceID,Converted:A.Converted,Currency:A.Currency,Date:A.InvoiceScheduleDate,Docbasetype:A.DocBaseType,documentno:A.Documentno,Isocode:A.Isocode,Multiplierap:A.Multiplierap,Amount:A.Amount,c_invoicepayschedule_id:A.C_InvoicePaySchedule_ID,Org:parseInt(y.val()),IsPaid:!1,paidAmt:0}))}}t.ajax({url:e.Application.contextUrl+"PaymentAllocation/SaveCashData",type:"POST",data:{paymentData:JSON.stringify(p),cashData:JSON.stringify(v),invoiceData:JSON.stringify(_),currency:I.val(),isCash:!0,_C_BPartner_ID:Ce,_windowNo:pt.windowNo,payment:o,DateTrx:me.val(),appliedamt:r,discount:c,writeOff:u,open:d,DateAcct:s,_CurrencyType_ID:g,isInterBPartner:!1,conversionDate:f,chk:m},success:function(t){tt=[],e.ADialog.info("",!0,t,""),ot=!0,Yt(),gt[0].style.visibility="hidden"},error:function(t){e.ADialog.info("",!0,t,""),gt[0].style.visibility="hidden"}})},error:function(t){e.ADialog.info("",!0,t,""),gt[0].style.visibility="hidden"}})}(a,i,n,0,s):function(a,i,n,l,s){if(Re+Ie==0)return"";t.ajax({url:e.Application.contextUrl+"PaymentAllocation/CheckPeriodState",data:{DateTrx:me.val(),AD_Org_ID:y.val()},async:!1,success:function(l){if(""!=l)return e.ADialog.info("",!0,l,""),ot=!0,Yt(),gt[0].style.visibility="hidden","";var o="",r="",c="",u="",d="",g=0,p=[],v=[],_=[],V=de.is(":checked");if(V)var A=Globalize.format(new Date(De.val()),"yyyy-MM-dd");else A=Globalize.format(new Date,"yyyy-MM-dd");for(var m=0;m<a.length;m++){var f=ne.get(a[m].recid);if(o=(C=Object.keys(ne.get(0)))[C.indexOf("AppliedAmt")],g=V?h.getValue():parseInt(f.C_ConversionType_ID),null!=a[m].AppliedAmt&&0!=a[m].AppliedAmt){var D=a[m].AppliedAmt;D=ua(D,ft),p.push({appliedamt:D,date:f.Date1,converted:f.ConvertedAmount,cpaymentid:f.CpaymentID,documentno:f.Documentno,isocode:f.Isocode,multiplierap:f.Multiplierap,openamt:f.OpenAmt,payment:f.Payment,Org:parseInt(y.val())})}}if(i.length>0){var C=Object.keys(le.get(0));for(m=0;m<i.length;m++){f=le.get(i[m].recid);v.push({appliedamt:i[m].AppliedAmt,date:f.Created,amount:f.Amount,ccashlineid:f.CcashlineiID,converted:f.ConvertedAmount,isocode:f.Isocode,multiplierap:f.Multiplierap,openamt:f.OpenAmt,receiptno:f.ReceiptNo,Org:parseInt(y.val())})}}if(n.length>0){r=(C=Object.keys(se.get(0)))[C.indexOf("AppliedAmt")],o=C[C.indexOf("AppliedAmt")],c=C[C.indexOf("Discount")],u=C[C.indexOf("Writeoff")],d=C[C.indexOf("Amount")];for(m=0;m<n.length;m++){f=se.get(n[m].recid);g=V?h.getValue():parseInt(f.C_ConversionType_ID);var S=n[m].Discount;null==S&&(S=f.Discount);var O=n[m].AppliedAmt;null==O&&(O=f.AppliedAmt);var T=n[m].Writeoff;null==T&&(T=f.Writeoff),0!=O&&null!=O&&(O=ua(O,ft),S=ua(S,ft),T=ua(T,ft),Vt<=0?_.push({appliedamt:O,discount:S,writeoff:T,cinvoiceid:f.CinvoiceID,converted:f.Converted,currency:f.Currency,date:f.Date1,docbasetype:f.DocBaseType,documentno:f.Documentno,isocode:f.Isocode,multiplierap:f.Multiplierap,amount:f.Amount,Org:parseInt(y.val())}):_.push({appliedamt:O,discount:S,writeoff:T,cinvoiceid:f.CinvoiceID,converted:f.Converted,currency:f.Currency,date:f.InvoiceScheduleDate,docbasetype:f.DocBaseType,DocumentNo:f.Documentno,Isocode:f.Isocode,Multiplierap:f.Multiplierap,Amount:f.Amount,c_invoicepayschedule_id:f.C_InvoicePaySchedule_ID,Org:parseInt(y.val())}))}}t.ajax({url:e.Application.contextUrl+"PaymentAllocation/SavePaymentData",type:"POST",data:{paymentData:JSON.stringify(p),cashData:JSON.stringify(v),invoiceData:JSON.stringify(_),currency:I.val(),isCash:!0,_C_BPartner_ID:Ce,_windowNo:pt.windowNo,payment:o,DateTrx:me.val(),appliedamt:r,discount:c,writeOff:u,open:d,DateAcct:s,_CurrencyType_ID:g,isInterBPartner:_e,conversionDate:A,chk:V},success:function(t){tt=[],Ze=[],ot=!0,Yt(),e.ADialog.info("",!0,t,""),gt[0].style.visibility="hidden"},error:function(){e.ADialog.info("",!0,l,""),gt[0].style.visibility="hidden"}})},error:function(t){e.ADialog.info("",!0,t,""),gt[0].style.visibility="hidden"}})}(a,i,n,0,s)}function ba(){var e=de.is(":checked");ca([],e),la([],e),sa([],e),na([],e),t(".vis-allocate-glSum").css("text-align","right"),t(".vis-allocate-glSum").css("margin-right","10px")}e.translatedTexts=e.Msg.translate(e.Env.getCtx(),["AD_Org_ID","C_BPartner_ID","C_Currency_ID","C_Payment_ID ","C_CashLine_ID","C_Cash_ID","C_Invoice_ID ","Date","DocumentNo","TrxCurrency","C_ConversionType_ID","Amount","ConvertedAmount","OpenAmount","multiplierap","AppliedAmount","C_ConversionType_ID","RECEIPTNO","PaymentType","ccashlineid","ScheduleDate","cinvoiceid","DiscountAmt","DocBaseType","WriteOffAmount","C_InvoicePaySchedule_ID","DateAcct","GL_JOURNALLINE_ID","GL_Journal_ID","DocType","Doc_Base_Type","FromDate","Payment_Type","CreditOrDebit","Account","VIS_Check","AD_OrgTrx_ID","PaymentMethod"],!0),this.Initialize=function(){Se=r.getContextAsInt("$C_Currency_ID"),Vt=Qt("VIS_131"),function(){var t=null,a=e.MLookupFactory.get(r,pt.windowNo,0,e.DisplayType.TableDir,"C_Currency_ID",0,!1,"IsMyCurrency='Y'");t=a.getData(!0,!0,!1,!1);var i=0;if(null!=t&&null!=t&&t.length>0){for(var n=0;n<t.length;n++)I.append("<option value="+t[n].Key+">"+t[n].Name+"</option>"),t[n].Key==Se&&(I.val(Se),i=1);0==i&&(I.val(0),I.addClass("vis-ev-col-mandatory"))}a=e.MLookupFactory.get(r,pt.windowNo,2758,e.DisplayType.Search,"C_BPartner_ID",0,!1,"C_BPartner.IsActive ='Y' And C_Bpartner.IsSummary ='N' "),D=new e.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,e.DisplayType.Search,a),a=e.MLookupFactory.get(r,pt.windowNo,10294,e.DisplayType.TableDir,"C_ConversionType_ID",0,!1,"C_ConversionType.IsActive = 'Y' AND C_ConversionType.AD_Org_ID IN (0, @OrgID@)"),h=new e.Controls.VComboBox("C_ConversionType_ID",!1,!1,!0,a,50),a=e.MLookupFactory.get(r,pt.windowNo,0,e.DisplayType.TableDir,"VA009_PaymentMethod_ID",0,!1,"VA009_PAYMENTMETHOD.VA009_PAYMENTMETHOD_ID IN (SELECT VA009_PAYMENTMETHOD_ID FROM VA009_PAYMENTMETHOD WHERE VA009_PAYMENTBASETYPE NOT IN ('B','C','P') )"),S=new e.Controls.VComboBox("VA009_PaymentMethod_ID",!1,!1,!0,a,50),a=e.MLookupFactory.get(r,pt.windowNo,0,e.DisplayType.TableDir,"VA009_PaymentMethod_ID",0,!1,"VA009_PAYMENTMETHOD.IsActive='Y' AND VA009_PAYMENTMETHOD.AD_Client_ID = @AD_Client_ID@"),C=new e.Controls.VComboBox("VA009_PaymentMethod_ID",!1,!1,!0,a,50)}(),t.ajax({type:"POST",url:e.Application.contextUrl+"PaymentAllocation/GetDocType",dataType:"json",success:function(t){var a=JSON.parse(t);if(a){O.empty(),O.append("<option value= 0></option>");for(var i=0;i<a.length;i++)o=e.Utility.Util.getValueOfString(a[i].DocType),B=e.Utility.Util.getValueOfInt(a[i].C_DocType_ID),O.append(" <option value="+B+">"+o+"</option>")}else O.append("<option value= 0 ></option>");O.prop("selectedIndex",0)},error:function(e){console.log(e)}}),t.ajax({type:"POST",url:e.Application.contextUrl+"PaymentAllocation/GetPaymentType",dataType:"json",success:function(t){var a=JSON.parse(t);if(a){w.empty(),w.append("<option value='0'></option>");for(var i=0;i<a.length;i++)paymentType=e.Utility.Util.getValueOfString(a[i].Name),paymentType_ID=e.Utility.Util.getValueOfString(a[i].Value),w.append(" <option value="+paymentType_ID+">"+paymentType+"</option>")}else w.append("<option value= '0'></option>");w.prop("selectedIndex",0)},error:function(e){console.log(e)}}),t.ajax({type:"POST",url:e.Application.contextUrl+"PaymentAllocation/GetpayDocType",dataType:"json",success:function(t){var a=JSON.parse(t);if(a){T.empty(),T.append("<option value='0'></option>");for(var i=0;i<a.length;i++)o=e.Utility.Util.getValueOfString(a[i].DocType),B=e.Utility.Util.getValueOfInt(a[i].C_DocType_ID),T.append(" <option value="+B+">"+o+"</option>")}else T.append("<option value= 0></option>");T.prop("selectedIndex",0)},error:function(e){console.log(e)}}),t.ajax({type:"POST",url:e.Application.contextUrl+"PaymentAllocation/GetDocbaseType",dataType:"json",success:function(t){var a=JSON.parse(t);if(a){P.empty(),P.append("<option value='0'></option>");for(var i=0;i<a.length;i++)docBaseType=e.Utility.Util.getValueOfString(a[i].DocbaseType),docBaseName=e.Utility.Util.getValueOfString(a[i].Name),P.append(" <option value="+docBaseType+">"+docBaseName+"</option>")}else P.append("<option value= '0'></option>");P.prop("selectedIndex",0)},error:function(e){console.log(e)}}),t.ajax({type:"POST",url:e.Application.contextUrl+"PaymentAllocation/GetpayDocbaseType",dataType:"json",success:function(t){var a=JSON.parse(t);if(a){b.empty(),b.append("<option value='0'></option>");for(var i=0;i<a.length;i++)docbaseType=e.Utility.Util.getValueOfString(a[i].DocbaseType),docBaseName=e.Utility.Util.getValueOfString(a[i].Name),b.append(" <option value="+docbaseType+">"+docBaseName+"</option>")}else b.append("<option value='0'></option>");b.prop("selectedIndex",0)},error:function(e){console.log(e)}}),t.ajax({type:"POST",url:e.Application.contextUrl+"VIS/PaymentAllocation/GetOrg",dataType:"json",success:function(t){var a=JSON.parse(t);if(a){f.empty(),0!=e.Env.getCtx().getAD_Org_ID()&&null!=e.Env.getCtx().ctx["#AD_Org_Name"]&&f.append("<option value="+e.Env.getCtx().getAD_Org_ID()+">"+e.Env.getCtx().ctx["#AD_Org_Name"]+"</option>");for(var i=0;i<a.length;i++)(a[i].Value!=e.Env.getCtx().getAD_Org_ID()&&e.Env.getCtx().ctx["#AD_Org_Name"]!=a[i].Name||a[i].Value==e.Env.getCtx().getAD_Org_ID()&&e.Env.getCtx().ctx["#AD_Org_Name"]!=a[i].Name)&&(OrgName=e.Utility.Util.getValueOfString(a[i].Name),AD_Org_ID=e.Utility.Util.getValueOfInt(a[i].Value),f.append(" <option value="+AD_Org_ID+">"+OrgName+"</option>"))}else f.append("<option value=0></option>");e.context.getContextAsInt("#AD_Org_ID")>0?(f.val(e.context.getContextAsInt("#AD_Org_ID")),r.setContext(c.windowNo,"OrgID",e.context.getContextAsInt("#AD_Org_ID")),f.removeClass("vis-ev-col-mandatory")):f.prop("selectedIndex",0)},error:function(e){console.log(e)}}),Zt(),t.ajax({type:"POST",url:e.Application.contextUrl+"VIS/PaymentAllocation/GetOrganization",dataType:"json",success:function(t){var a=JSON.parse(t);if(a){y.empty(),y.addClass("vis-ev-col-mandatory"),y.append("<option value=0></option>");for(var i=0;i<a.length;i++)OrgName=e.Utility.Util.getValueOfString(a[i].Name),AD_Org_ID=e.Utility.Util.getValueOfInt(a[i].Value),y.append(" <option value="+AD_Org_ID+">"+OrgName+"</option>")}else y.append("<option value=0></option>");e.context.getContextAsInt("#AD_Org_ID")>0?(y.val(e.context.getContextAsInt("#AD_Org_ID")),y.removeClass("vis-ev-col-mandatory")):y.prop("selectedIndex",0)},error:function(e){console.log(e)}}),J.empty(),j.empty(),J.append("<option value=0></option>"),j.append("<option value=0></option>"),J.append('<option value="C">'+e.translatedTexts.C_Cash_ID+"</option>"),j.append('<option value="C">'+e.translatedTexts.C_Cash_ID+"</option>"),J.append('<option value="I">'+e.translatedTexts.C_Invoice_ID+"</option>"),j.append('<option value="I">'+e.translatedTexts.C_Invoice_ID+"</option>"),J.append('<option value="G">'+e.translatedTexts.GL_Journal_ID+"</option>"),j.append('<option value="G">'+e.translatedTexts.GL_Journal_ID+"</option>"),J.append('<option value="P">'+e.translatedTexts.C_Payment_ID+"</option>"),j.append('<option value="P">'+e.translatedTexts.C_Payment_ID+"</option>"),function(){var i=t('<div class="vis-allocation-leftControls">');i.append('<div class="input-group vis-input-wrap"><div class="vis-control-wrap"><select class="vis-allocation-currencycmb" id=VIS_Org_'+c.windowNo+'></select><label title="View organization" >'+e.translatedTexts.AD_Org_ID+"</label>");var n=t('<div class="vis-allocation-leftControls">'),l=t('<div class="input-group vis-input-wrap">'),s=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');n.append(l),l.append(s),l.append(o),s.append(D.getControl().addClass("vis-allocation-bpartner").attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")).append("<label>"+e.translatedTexts.C_BPartner_ID+"</label>"),o.append(D.getBtn(0));var r=t('<div class="vis-allocation-leftControls">');l=t('<div class="input-group vis-input-wrap">'),s=t('<div class="vis-control-wrap">');r.append(l),l.append(s),s.append(I).append("<label>"+e.translatedTexts.C_Currency_ID+"</label>"),g.append(i).append(n).append(r);var u=t('<div class="vis-allocation-leftControls"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><label class="vis-ec-col-lblchkbox"><input name="vchkMultiCurrency" class="vis-allocation-multicheckbox" type="checkbox">'+e.Msg.getMsg("MultiCurrency")+'</label></div></div></div><div class="vis-allocation-leftControls" id = VIS_cnvrDateDiv_'+c.windowNo+' ><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input  class="vis-allocation-date" style="display:block;" id=VIS_cmbConversionDate_'+c.windowNo+' type="date" max="9999-12-31"><label title="View allocation will be created on this date" type="date" >'+e.Msg.getMsg("ConversionDate")+"</label></div></div></div>");g.append(u),r=t('<div class="vis-allocation-leftControls vis-conversionType" style="display:none">'),l=t('<div class="input-group vis-input-wrap">'),s=t('<div class="vis-control-wrap">'),r.append(l),l.append(s),s.append(h.getControl()).append("<label>"+e.translatedTexts.C_ConversionType_ID+"</label>"),g.append(r);var d=t('<div class="vis-allocation-leftControls">');l=t('<div class="input-group vis-input-wrap">'),s=t('<div class="vis-control-wrap">');d.append(l),l.append(s),s.append(J).append("<label> "+e.Msg.getMsg("AllocationFrom")+"</label>");var p=t('<div class="vis-allocation-leftControls">');l=t('<div class="input-group vis-input-wrap">'),s=t('<div class="vis-control-wrap">');p.append(l),l.append(s),s.append(j).append("<label> "+e.Msg.getMsg("AllocationTo")+"</label>"),g.append(d).append(p);var v=t('<div class="vis-allocation-leftControls" id="cashMaindiv"  style="display: none !important;"><input  class="vis-allocation-cashbox"  type="checkbox"><label>'+e.Msg.getMsg("Cash")+'</label></div><div class="vis-allocation-leftControls" id="glMaindiv" style="display: none !important;"><input  class="vis-allocation-glvoucher"  type="checkbox"><label>'+e.Msg.getMsg("GL Voucher")+'</label></div><div class="vis-allocation-leftControls"> <div class= "input-group vis-input-wrap" > <div class="vis-control-wrap"> <label class="vis-ec-col-lblchkbox"><input id=VIS_chkbxICompanyAllocation_'+c.windowNo+' class="vis-allocation-interComp" type="checkbox">'+e.Msg.getMsg("InterCompanyAllocation")+'</label></div> </div> </div><div class="vis-allocation-leftControls"> <div class= "input-group vis-input-wrap" > <div class="vis-control-wrap"><label class="vis-ec-col-lblchkbox"><input id=VIS_chkbxBPAllocation_'+c.windowNo+' class="vis-allocation-interBP" type="checkbox">'+e.Msg.getMsg("BPAllocation")+"</label></div></div> </div>");g.append(v),v.find(".panel-body").append('<div class="vis-allocation-leftControls"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input  class="vis-allocation-fromDate"  type="date"><label>'+e.Msg.getMsg("VIS_FromDate")+'</label></div></div></div><div class="vis-allocation-leftControls"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input  class="vis-allocation-toDate"  type="date"><label>'+e.Msg.getMsg("VIS_ToDate")+"</label></div></div></div>"),de=g.find(".vis-allocation-multicheckbox"),ge=g.find(".vis-allocation-cashbox"),z=g.find(".vis-allocation-glvoucher"),q=g.find(".vis-allocation-glinvoice"),a=g.find(".vis-allocation-docNo");var _=t('<div class="vis-allocation-resultdiv">');_.append('<div class="vis-allocation-leftControls"><span class="vis-allocation-inputLabels">'+e.Msg.getMsg("Difference")+"</span>"),_.append('<div class="vis-allocation-leftControls" style=" margin-bottom: 10px; "><span class="vis-allocation-lblCurrnecy"></span><span class="vis-allocation-lbldifferenceAmt" style="float:right;"></span>'),_.append('<div class="vis-allocation-leftControls"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select class="vis-allocation-currencycmb" id=VIS_cmbOrg_'+c.windowNo+"></select><label title="+e.Msg.getMsg("VIS_AllocOrgTitle")+">"+e.Msg.getMsg("VIS_AllocOrg")+"</label>"),_.append('<div class="vis-allocation-leftControls"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input  class="vis-allocation-date" disabled  id=VIS_cmbDate_'+c.windowNo+' type="date"><label title="View allocation will be created on this date" type="date" >'+e.Msg.getMsg("TransactionDate")+"</label></div></div></div>"),_.append('<div class="vis-allocation-leftControls"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input  class="vis-allocation-date" disabled id=VIS_cmbAcctDate_'+c.windowNo+' type="date"><label title="View allocation will be created on this date" type="date" >'+e.Msg.getMsg("DateAcct")+"</label></div></div></div>"),g.append(_),(me=g.find("#VIS_cmbDate_"+c.windowNo)).val(Globalize.format(new Date,"yyyy-MM-dd")),(Ae=g.find("#VIS_cmbAcctDate_"+c.windowNo)).val(Globalize.format(new Date,"yyyy-MM-dd")),De=g.find("#VIS_cmbConversionDate_"+c.windowNo),(he=g.find("#VIS_cnvrDateDiv_"+c.windowNo)).css("display","none"),y=g.find("#VIS_cmbOrg_"+c.windowNo),f=g.find("#VIS_Org_"+c.windowNo),pe=g.find("#VIS_chkbxBPAllocation_"+c.windowNo),ve=g.find("#VIS_chkbxICompanyAllocation_"+c.windowNo)}(),v.append('<div class="d-flex doc-allocation"><div class="vis-doc-AllocOuter-wrap"><div><p>'+e.translatedTexts.C_Payment_ID+'</p>  <input type="checkbox" id="paymentselectall" /><p style="margin: 0 4px;"></p> <span id="pclrbutton_'+c.windowNo+'" style="cursor: pointer;margin: 2px 0 0;" class="glyphicon glyphicon-refresh" title='+e.Msg.getMsg("Reset")+'></span></div><p class="vis-allocate-paymentSum"> 0 '+e.Msg.getMsg("SelectedLines")+' - Σ 0.00</p></div> <div class="vis-allocation-topFields-wrap"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input placeholder="'+e.Msg.getMsg("SearchResults")+'" data-hasbtn=" " type="text" id="paySrch'+c.windowNo+'" /><label>'+e.Msg.getMsg("SearchResults")+'</label></div><div class="input-group-append"><a class="input-group-text" id="_SrchpBtn_'+c.windowNo+'"><span class="glyphicon glyphicon-search"></span></a></div></div><div class="input-group vis-input-wrap" id="docType_'+c.windowNo+'"></div><div class="payBaseType input-group vis-input-wrap" id="docbaseType_'+c.windowNo+'"></div><div class="payMethod input-group vis-input-wrap" id="payPayMethod_'+c.windowNo+'"></div><div class="vis-fdate-allocation input-group vis-input-wrap"></div><div class="vis-tdate-allocation input-group vis-input-wrap"></div></div></div> ').append(' <div class= "vis-allocation-payment-grid" ></div> '),F=v.find(".vis-allocation-payment-grid"),xe=v.find(".vis-allocate-paymentSum"),re=v.find("#paymentselectall"),ke=v.find("#paySrch"+c.windowNo),Qe=v.find("#_SrchpBtn_"+c.windowNo),v.find("#docType_"+c.windowNo).append(t('<div class="vis-control-wrap">').append(T).append("<label>"+e.translatedTexts.DocType+"</label>")),v.find("#docbaseType_"+c.windowNo).append(t('<div class="vis-control-wrap">').append(b).append("<label>"+e.translatedTexts.DocBaseType+"</label>")),v.find("#payPayMethod_"+c.windowNo).append(t('<div class="vis-control-wrap">').append(S.getControl()).append("<label>"+e.translatedTexts.PaymentMethod+"</label>")),v.find(".vis-fdate-allocation").append(t('<div class="vis-control-wrap">').append(L).append("<label>"+e.translatedTexts.FromDate+"</label>")),v.find(".vis-tdate-allocation").append(t('<div class="vis-control-wrap">').append(R).append("<label>"+e.Msg.getMsg("ToDate")+"</label>")),et=v.find("#pclrbutton_"+c.windowNo),_.append('<div class="d-flex cash-allocation"><div class="vis-doc-AllocOuter-wrap"><div><p>'+e.translatedTexts.C_CashLine_ID+'</p> <input type="checkbox" id="cashselectall" /><p style="margin: 0 4px;"></p> <span id="cclrbutton_'+c.windowNo+'" style="cursor: pointer;margin: 2px 0 0;" class="glyphicon glyphicon-refresh"  title='+e.Msg.getMsg("Reset")+'></span></div><p class="vis-allocate-cashSum"> 0 '+e.Msg.getMsg("SelectedLines")+' - Σ 0.00</p></div><div class="vis-allocation-topFields-wrap"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input placeholder="'+e.Msg.getMsg("SearchResults")+'" data-hasbtn=" " type="text" id="cashSrch'+c.windowNo+'" /><label>'+e.Msg.getMsg("SearchResults")+'</label></div><div class="input-group-append"><a class="input-group-text" id="_SrchcBtn_'+c.windowNo+'"><span class="glyphicon glyphicon-search"></span></a></div></div><div class="input-group vis-input-wrap payType" id="_paymentType'+c.windowNo+'"></div><div class="input-group vis-input-wrap vis-fdate-allocation"></div><div class="input-group vis-input-wrap vis-tdate-allocation"></div></div></div>').append('<div  class="vis-allocation-cashLine-grid"></div>'),Q=_.find(".vis-allocation-cashLine-grid"),Ne=_.find(".vis-allocate-cashSum"),ce=_.find("#cashselectall"),Be=_.find("#cashSrch"+c.windowNo),We=_.find("#_SrchcBtn_"+c.windowNo),_.find("#_paymentType"+c.windowNo).append(t('<div class="vis-control-wrap">').append(w).append("<label>"+e.translatedTexts.Payment_Type+"</label>")),_.find(".vis-fdate-allocation").append(t('<div class="vis-control-wrap">').append(U).append("<label>"+e.translatedTexts.FromDate+"</label>")),_.find(".vis-tdate-allocation").append(t('<div class="vis-control-wrap">').append(E).append("<label>"+e.Msg.getMsg("ToDate")+"</label>")),Ke=_.find("#cclrbutton_"+c.windowNo),V.append('<div class="d-flex in-allocation"><div class="vis-doc-AllocOuter-wrap"><div><span>'+e.translatedTexts.C_Invoice_ID+'</span> <input type="checkbox" id="invoiceselectall" /><span style="margin: 0 4px;"></span> <span id="clrbutton_'+c.windowNo+'" style="cursor: pointer;margin: 2px 0 0;" class="glyphicon glyphicon-refresh"  title='+e.Msg.getMsg("Reset")+'></span></div><p class="vis-allocate-invoiceSum"> 0'+e.Msg.getMsg("SelectedLines")+' - Σ 0.00</p></div><div class="vis-allocation-topFields-wrap"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input placeholder="'+e.Msg.getMsg("SearchResults")+'" data-hasbtn=" " type="text" id="invSrch'+c.windowNo+'" /><label>'+e.Msg.getMsg("SearchResults")+'</label></div><div class="input-group-append"><a class="input-group-text" id="_SrchBtn_'+c.windowNo+'"><span class="glyphicon glyphicon-search"></span></a></div></div><div class="input-group vis-input-wrap" id="docType'+c.windowNo+'"></div><div class="invBaseType input-group vis-input-wrap" id="invbaseType_'+c.windowNo+'"></div><div class="payMethod input-group vis-input-wrap" id="invPayMethod_'+c.windowNo+'"></div><div class="vis-fdate-allocation input-group vis-input-wrap"></div><div class="vis-tdate-allocation input-group vis-input-wrap"></div></div></div>').append('<div  class="vis-allocation-invoice-grid"></div>'),$=V.find(".vis-allocation-invoice-grid"),Le=V.find(".vis-allocate-invoiceSum"),oe=V.find("#invoiceselectall"),Ge=V.find("#invSrch"+c.windowNo),$e=V.find("#_SrchBtn_"+c.windowNo),V.find("#docType"+c.windowNo).append(t('<div class="vis-control-wrap">').append(O).append("<label>"+e.translatedTexts.DocType+"</label>")),V.find("#invbaseType_"+c.windowNo).append(t('<div class="vis-control-wrap">').append(P).append("<label>"+e.translatedTexts.DocBaseType+"</label>")),V.find("#invPayMethod_"+c.windowNo).append(t('<div class="vis-control-wrap">').append(C.getControl()).append("<label>"+e.translatedTexts.PaymentMethod+"</label>")),V.find(".vis-fdate-allocation").append(t('<div class="vis-control-wrap">').append(x).append("<label>"+e.translatedTexts.FromDate+"</label>")),V.find(".vis-tdate-allocation").append(t('<div class="vis-control-wrap">').append(N).append("<label>"+e.Msg.getMsg("ToDate")+"</label>")),it=V.find("#clrbutton_"+c.windowNo),A.append('<div class="d-flex  gl-allocation"><div class="vis-doc-AllocOuter-wrap"><div><span>'+e.translatedTexts.GL_Journal_ID+'</span> <input type="checkbox" id="glselectall" /><span style="margin: 0 4px;"></span> <span id="gclrbutton_'+c.windowNo+'" style="cursor: pointer;margin: 2px 0 0;" class="glyphicon glyphicon-refresh"  title='+e.Msg.getMsg("Reset")+'></span></div><p class="vis-allocate-glSum"> 0'+e.Msg.getMsg("SelectedLines")+' - Σ 0.00</p></div><div class="vis-allocation-topFields-wrap"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input placeholder="'+e.Msg.getMsg("SearchResults")+'" data-hasbtn=" " type="text" id="glSrch'+c.windowNo+'" /><label>'+e.Msg.getMsg("SearchResults")+'</label></div><div class="input-group-append"><a class="input-group-text" id="_SrchglBtn_'+c.windowNo+'"><span class="glyphicon glyphicon-search"></span></a></div></div><div class="input-group vis-input-wrap vis-fdate-allocation"></div><div class="input-group vis-input-wrap vis-tdate-allocation"></div></div></div>').append('<div  class="vis-allocation-gl-grid"></div>'),W=A.find(".vis-allocation-gl-grid"),Y=A.find(".vis-allocate-glSum"),H=A.find("#glselectall"),Fe=A.find("#glSrch"+c.windowNo),Je=A.find("#_SrchglBtn_"+c.windowNo),A.find(".vis-fdate-allocation").append(t('<div class="vis-control-wrap">').append(k).append("<label>"+e.translatedTexts.FromDate+"</label>")),A.find(".vis-tdate-allocation").append(t('<div class="vis-control-wrap">').append(G).append("<label>"+e.Msg.getMsg("ToDate")+"</label>")),qe=A.find("#gclrbutton_"+c.windowNo),p.append(v).append(_).append(V).append(A).append(m),v.css("display",""),_.css("display","none"),u.append(d.append(g)).append(p);var i=t('<div class="vis-allocation-leftpanel-bottomDiv">'),n=t('<div class="vis-DiffernceWrapDiv">');i.append(n),n.append('<div class="vis-allocation-leftControls"><span class="vis-allocation-inputLabels">'+e.Msg.getMsg("Difference")+"</span>"),n.append('<div class="vis-allocation-leftControls"><span class="vis-allocation-lblCurrnecy" style=" padding: 0 5px; "></span><span class="vis-allocation-lbldifferenceAmt"></span>');var l=t('<div style="padding-right: 15px;float: right; margin-top: 10px;">');l.append(' <a class="vis-group-btn vis-group-create vis-group-grayBtn" style="float: right;">'+e.Msg.getMsg("Process")+"</a>");var s=t('<div style="padding-right: 15px;float: right; margin-top: 10px;">');s.append(' <a class="vis-group-create vis-group-grayBtn" id="vis_srchbtn_'+c.windowNo+'" style="float: left;">'+e.Msg.getMsg("Search")+"</a>"),d.append(i),i.append(l),i.append(s),u.append(d.append(g).append(i)).append(p),(ct=u.find(".vis-group-btn")).css({"pointer-events":"none",opacity:"0.5"}),ut=u.find("#vis_srchbtn_"+c.windowNo),(gt=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="hidden",u.append(gt),function(){function i(){return 1==Nt&&1==Lt&&1==Rt&&1==Ut}function n(){return 0==j.val()&&0==J.val()?(e.ADialog.info("",!0,e.Msg.getMsg("allocationFrom_And_allocationTo"),""),J.addClass("vis-ev-col-mandatory"),j.addClass("vis-ev-col-mandatory"),!1):0==J.val()?(e.ADialog.info("",!0,e.Msg.getMsg("selectAllocationFrom"),""),j.val(0),J.addClass("vis-ev-col-mandatory"),j.addClass("vis-ev-col-mandatory"),!1):0!=j.val()||(e.ADialog.info("",!0,e.Msg.getMsg("selectAllocationTo"),""),j.addClass("vis-ev-col-mandatory"),!1)}function l(){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?Ht():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),S.setValue(null)):S.setValue(null):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),S.setValue(null))}function s(){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?qt():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),C.setValue(null)):C.setValue(null):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),C.setValue(null))}f.on("change",function(t){if(r.setContext(c.windowNo,"OrgID",e.Utility.Util.getValueOfInt(f.val())),h.getControl().val(""),de.is(":checked")&&""==De.val())return ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0||(D.getControl().addClass("vis-ev-col-mandatory"),ba())}),D.fireValueChanged=ma,h.fireValueChanged=fa,I.on("change",function(t){if(Sa("C_Currency_ID",I.val()),de.is(":checked")&&""==De.val())return ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0||(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),ba())}),de.on("change",function(t){Sa("Date",de.is(":checked")),de.is(":checked")&&""==De.val()?De.val(""):(e.Utility.Util.getValueOfInt(D.value)>0||(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),ba()),de.is(":checked")||De.val(""))}),ge.on("change",function(e){z.is(":checked")&&(t(".vis-allocate-invoicediv").insertBefore(".vis-allocate-gldiv"),v.css("display","none"),_.css("display","none"),A.css("display","block"),V.css("display","block"),se&&se.refresh(),Z&&Z.refresh()),Ta()}),ut.on("click",function(t){if(ba(),de.is(":checked")&&(""==De.val()||null==h.getValue()&&("I"==J.val()&&"P"==j.val()||"P"==J.val()&&"I"==j.val()||"I"==J.val()&&"I"==j.val())))return""==De.val()?e.ADialog.warn("VIS_SlctcnvrsnDate"):null==h.getValue()&&e.ADialog.warn("VIS_SlctcnvrsnType"),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&($t(),function(){console.info("BPartner Name : "+D.getName()+" , Value : "+D.value),console.info("Currency ID : "+I.val()),console.info("Allocation From : "+J.val()),console.info("Allocation To : "+j.val()),console.info("MultiCurrency : "+de.is(":checked")),console.info("Currency Type : "+h.getName()+" , Value : "+h.getValue()),console.info("Organization : "+y.val()),console.info("Document Number : "+a.val()),console.info("Document Type : "+O.val()),console.info("Pay Document Type : "+T.val()),console.info("From Date : "+x.val()),console.info("To Date : "+N.val()),console.info("Conversion Date : "+De.val()),gt[0].style.visibility="visible",ht=1,Ct=1,St=0,It=1,yt=1,Ot=0,Tt=1,wt=1,Pt=0,bt=1,Mt=1,xt=0,Nt=!1,Lt=!1,Rt=!1,Ut=!1,Et=0,"P"==J.val()|"P"==j.val()?Ht():Nt=!0;"C"==J.val()|"C"==j.val()?Kt():Lt=!0;"I"==J.val()|"I"==j.val()?qt():Rt=!0;"G"==J.val()|"G"==j.val()?ha():Ut=!0;Jt(J.val(),j.val())}()):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),D.getControl().addClass("vis-ev-col-mandatory"),$t())}),z.on("change",function(e){ge.prop("checked",!1),z.is(":checked")?(t(".vis-allocate-invoicediv").insertBefore(".vis-allocate-gldiv"),V.css("display","block"),A.css("display","block"),v.css("display","none"),_.css("display","none"),se&&se.refresh(),Z&&Z.refresh()):(t(".vis-allocate-invoicediv").insertBefore(".vis-allocate-paymentdiv"),V.css("display","block"),A.css("display","none"),v.css("display","block"),_.css("display","none"),se&&se.refresh(),ne&&ne.refresh())}),q.on("change",function(e){}),me.on("change",function(t){if(Ca()){if(new Date(me.val())<ue)return e.ADialog.info("",!0,e.Msg.getMsg("SelectMaxDate")+Globalize.format(new Date(ue),"yyyy-MM-dd"),""),me.val(Globalize.format(new Date(ue),"yyyy-MM-dd")),!1}else e.ADialog.info("",!0,e.Msg.getMsg("PleaseSelectRecord"),"")}),ct.on("click",function(t){if(0==e.Utility.Util.getValueOfInt(D.value))return e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),D.getControl().addClass("vis-ev-col-mandatory"),$t(),ba(),!1;if(Ca()){if(""==me.val().trim())return e.ADialog.info("",!0,e.Msg.getMsg("InvalidDateFormat"),""),!1;if(me.val()<Globalize.format(new Date(ue),"yyyy-MM-dd"))return e.ADialog.info("",!0,e.Msg.getMsg("SelectMaxDate")+Globalize.format(new Date(ue),"yyyy-MM-dd"),""),me.val(Globalize.format(new Date(ue),"yyyy-MM-dd")),!1;Gt?parseInt(y.val())>0?wa():e.ADialog.info("",!0,e.Msg.getMsg("ValidateOrg"),""):e.ADialog.confirm("ConfirmForDiffOrg",!0,"","Confirm",function(t){t&&(parseInt(y.val())>0?wa():e.ADialog.info("",!0,e.Msg.getMsg("ValidateOrg"),""))})}else e.ADialog.info("",!0,e.Msg.getMsg("PleaseSelectRecord"),"")}),C.fireValueChanged=s,O.on("change",function(t){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?qt():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),O.val(0)):O.val(0):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),O.val(0))}),S.fireValueChanged=l,T.on("change",function(t){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?Ht():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),T.val(0)):T.val(0):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),T.val(0))}),b.on("change",function(t){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?Ht():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),b.val(0)):b.val(0):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),b.val(0))}),P.on("change",function(t){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?qt():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),P.val(0)):P.val(0):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),P.val(0))}),w.on("change",function(t){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?Kt():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),w.val(0)):w.val(0):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),w.val(0))}),x.on("blur",function(t){var a=Date.parse(x.val()),l=new Date(parseInt(a));if(isNaN(l.getTime())||!(l.getTime()<0))return de.is(":checked")&&""==De.val()?(e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t()):void(e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?qt():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),x.val("")):x.val(""):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),x.val("")));e.ADialog.warn("VIS_InvalidDate")}),N.on("blur",function(t){var a=Date.parse(N.val()),l=new Date(parseInt(a));if(isNaN(l.getTime())||!(l.getTime()<0))return de.is(":checked")&&""==De.val()?(e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t()):void(e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?qt():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),N.val("")):N.val(""):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),N.val("")));e.ADialog.warn("VIS_InvalidDate")}),L.on("blur",function(t){var a=Date.parse(L.val()),l=new Date(parseInt(a));if(isNaN(l.getTime())||!(l.getTime()<0))return de.is(":checked")&&""==De.val()?(e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t()):void(e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?Ht():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),L.val("")):L.val(""):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),L.val("")));e.ADialog.warn("VIS_InvalidDate")}),R.on("blur",function(t){var a=Date.parse(R.val()),l=new Date(parseInt(a));if(isNaN(l.getTime())||!(l.getTime()<0))return de.is(":checked")&&""==De.val()?(e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t()):void(e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?Ht():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),R.val("")):R.val(""):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),R.val("")));e.ADialog.warn("VIS_InvalidDate")}),U.on("blur",function(t){var a=Date.parse(U.val()),l=new Date(parseInt(a));if(isNaN(l.getTime())||!(l.getTime()<0))return de.is(":checked")&&""==De.val()?(e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t()):void(e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?Kt():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),U.val("")):U.val(""):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),U.val("")));e.ADialog.warn("VIS_InvalidDate")}),E.on("blur",function(t){var a=Date.parse(E.val()),l=new Date(parseInt(a));if(isNaN(l.getTime())||!(l.getTime()<0))return de.is(":checked")&&""==De.val()?(e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t()):void(e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?Kt():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),E.val("")):E.val(""):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),E.val("")));e.ADialog.warn("VIS_InvalidDate")}),k.on("blur",function(t){var a=Date.parse(k.val()),l=new Date(parseInt(a));if(isNaN(l.getTime())||!(l.getTime()<0))return de.is(":checked")&&""==De.val()?(e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t()):void(e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?ha():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),k.val("")):k.val(""):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),k.val("")));e.ADialog.warn("VIS_InvalidDate")}),G.on("blur",function(t){var a=Date.parse(G.val()),l=new Date(parseInt(a));if(isNaN(l.getTime())||!(l.getTime()<0))return de.is(":checked")&&""==De.val()?(e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t()):void(e.Utility.Util.getValueOfInt(D.value)>0?n()?i()?ha():(e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),""),G.val("")):G.val(""):(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),G.val("")));e.ADialog.warn("VIS_InvalidDate")}),Ge.on("keypress",function(t){if(13==t.keyCode){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?(Ct=1,qt()):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}}),$e.on("click",function(t){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?(Ct=1,qt()):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}),ke.on("keypress",function(t){if(13==t.keyCode){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?(wt=1,Ht()):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}}),Qe.on("click",function(t){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?(wt=1,Ht()):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}),Be.on("keypress",function(t){if(13==t.keyCode){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?(yt=1,Kt()):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}}),We.on("click",function(t){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?(yt=1,Kt()):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}),Fe.on("keypress",function(t){if(13==t.keyCode){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?(Mt=1,ha()):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}}),Je.on("click",function(t){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?(Mt=1,ha()):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}),oe.on("change",function(e){gt[0].style.visibility="visible";for(var a=t("#grid_"+se.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<a.length&&(t(a[i]).prop("checked",oe.prop("checked")),oa(a[i],!0,!1,!1,!1));i++){se.editChange.call(se,a[i],i,0,e);var n={type:"click",phase:"before",target:"grid",recid:se.records[i].recid,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};se.trigger(n)}0==oe.prop("checked")&&(tt=[]),gt[0].style.visibility="hidden"}),re.on("change",function(e){gt[0].style.visibility="visible";for(var a=t("#grid_"+ne.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<a.length&&(t(a[i]).prop("checked",re.prop("checked")),oa(a[i],!1,!0,!1,!1));i++){ne.editChange.call(ne,a[i],i,0,e);var n={type:"click",phase:"before",target:"grid",recid:ne.records[i].recid,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};ne.trigger(n)}0==re.prop("checked")&&(Ze=[]),gt[0].style.visibility="hidden"}),ce.on("change",function(e){gt[0].style.visibility="visible";for(var a=t("#grid_"+le.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<a.length&&(t(a[i]).prop("checked",ce.prop("checked")),oa(a[i],!1,!1,!0,!1));i++){le.editChange.call(le,a[i],i,0,e);var n={type:"click",phase:"before",target:"grid",recid:le.records[i].recid,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};le.trigger(n)}0==ce.prop("checked")&&(Ye=[]),gt[0].style.visibility="hidden"}),H.on("change",function(e){gt[0].style.visibility="visible",0==H.prop("checked")&&(ie=[]);for(var a=t("#grid_"+Z.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<a.length&&(t(a[i]).prop("checked",H.prop("checked")),oa(a[i],!1,!1,!1,!0));i++){Z.editChange.call(Z,a[i],i,0,e);var n={type:"click",phase:"before",target:"grid",recid:Z.records[i].recid,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};Z.trigger(n)}0==H.prop("checked")&&(je=[]),gt[0].style.visibility="hidden"}),y.on("change",function(e){parseInt(y.val())>0?y.removeClass("vis-ev-col-mandatory"):y.addClass("vis-ev-col-mandatory")}),De.on("blur",function(t){var a=Date.parse(De.val()),i=new Date(parseInt(a));if(!isNaN(i.getTime())&&i.getTime()<0)e.ADialog.warn("VIS_InvalidDate");else{if(fe=De.val(),de.is(":checked")&&""==De.val())return ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0||(e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),""),ba())}}),pe.on("change",function(e){Sa("Date",pe.is(":checked")),_e=pe.is(":checked")}),ve.on("change",function(e){Sa("Date",ve.is(":checked")),Ve=ve.is(":checked")}),it.on("click",function(a){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?se&&function(e){for(var a=t("#grid_"+se.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<a.length;i++){t(a[i]).prop("checked",!1),se.editChange.call(se,a[i],i,0,e);var n={type:"click",phase:"before",target:"grid",recid:i,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};se.trigger(n)}tt=[],oe.prop("checked",!1),O.val(0),P.val(0),C.setValue(null),Ge.val(""),x.val(""),N.val(""),qt()}(a):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}),qe.on("click",function(a){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?Z&&function(e){for(var a=t("#grid_"+Z.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<a.length;i++){t(a[i]).prop("checked",!1),Z.editChange.call(Z,a[i],i,0,e);var n={type:"click",phase:"before",target:"grid",recid:i,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};Z.trigger(n)}je=[],H.prop("checked",!1),Fe.val(""),k.val(""),G.val(""),ha()}(a):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}),Ke.on("click",function(a){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?le&&function(e){for(var a=t("#grid_"+le.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<a.length;i++){t(a[i]).prop("checked",!1),le.editChange.call(le,a[i],i,0,e);var n={type:"click",phase:"before",target:"grid",recid:i,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};le.trigger(n)}Ye=[],ce.prop("checked",!1),Be.val(""),w.val(0),U.val(""),E.val(""),Kt()}(a):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}),et.on("click",function(a){if(de.is(":checked")&&""==De.val())return e.ADialog.warn("VIS_SlctcnvrsnDate"),ba(),void $t();e.Utility.Util.getValueOfInt(D.value)>0?n()&&(i()?ne&&function(e){for(var a=t("#grid_"+ne.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<a.length;i++){t(a[i]).prop("checked",!1),ne.editChange.call(ne,a[i],i,0,e);var n={type:"click",phase:"before",target:"grid",recid:i,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};ne.trigger(n)}Ze=[],re.prop("checked",!1),b.val(0),T.val(0),S.setValue(null),ke.val(""),L.val(""),R.val(""),Ht()}(a):e.ADialog.info("",!0,e.Msg.getMsg("VIS_Search_Btn"),"")):e.ADialog.info("",!0,e.Msg.getMsg("SelectBusinessPartnerFirst"),"")}),J.on("change",function(e){0==J.val()?J.addClass("vis-ev-col-mandatory"):J.removeClass("vis-ev-col-mandatory"),jt(e),"P"==J.val()?(j.find("option[value=C]").hide(),j.find("option[value=P]").show(),j.find("option[value=G]").show()):"C"==J.val()?(j.find("option[value=P]").hide(),j.find("option[value=C]").show(),j.find("option[value=G]").show()):"G"==J.val()?(j.find("option[value=P]").show(),j.find("option[value=C]").show(),j.find("option[value=G]").hide()):(j.find("option[value=C]").show(),j.find("option[value=P]").show(),j.find("option[value=G]").show()),j.val(0),j.addClass("vis-ev-col-mandatory"),Wt(J.val()),Jt(J.val(),j.val()),$t()}),j.on("change",function(e){0==parseInt(j.val())?j.css("background-color",zt(!0)):j.css("background-color",zt(!1)),jt(e),"P"==J.val()&&"C"==j.val()||"C"==J.val()&&"P"==j.val()?(h.getControl().val(""),De.val(""),de.prop("checked",!1),de.attr("checked",!1),de.prop("disabled",!0)):de.prop("disabled",!1);var t=J.val(),a=j.val();$t(),Wt(j.val()),Jt(t,a),Oa()})}(),ba(),A.css("display","none"),rt=n.find(".vis-allocation-lbldifferenceAmt"),dt=n.find(".vis-allocation-lblCurrnecy"),u.find(".vis-allocation-resultdiv").css({width:"100%",margin:"0",bottom:"0",position:"inherit"}),gt[0].style.visibility="hidden"},this.disposeComponent=function(){null!=ne&&null!=ne&&(ne.destroy(),ne=null),null!=le&&null!=le&&(le.destroy(),le=null),null!=se&&null!=se&&(se.destroy(),se=null),null!=Z&&null!=Z&&(Z.destroy(),Z=null),oe=null,re=null,ce=null,Z=null,kt=null},this.getRoot=function(){return u},this.refreshUI=function(){ne.resize(),le.resize(),se.resize(),Z.resize()}}a.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.Initialize(),this.frame.getContentGrid().append(this.getRoot())},a.prototype.refresh=function(){this.refreshUI()},a.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps=e.Apps||{},e.Apps.AForms=e.Apps.AForms||{},e.Apps.AForms.VAllocation=a}(VIS,jQuery)},9469:()=>{VAS=window.VAS||{},function(e,t){e.AttachError=function(e,a){var i;this.frame,this.WindowNo;var n=this,l=null;this.show=function(){i=t("<div style='width: 100%; height: 100%; background-color: white; padding-right:10px'>"),l=t("<div class='vas-errorBody'>").html(a),i.append(l);var e=new VIS.ChildDialog;e.setHeight(t(window).height()-350),e.setWidth(t(window).width()-700),e.setTitle(VIS.Msg.getMsg("VAS_error")),e.setContent(i),e.show(),e.onClose=function(){n.onClose&&n.onClose(),n.dispose()}},this.disposeComponent=function(){i=null,l=null,this.disposeComponent=null}},e.AttachError.prototype.dispose=function(){this.disposeComponent()},e.AttachError=e.AttachError}(VAS,jQuery)},9659:()=>{VAS=window.VAS||{},function(e,t){e.VAS_LowestSellProduct=function(){var e;this.frame,this.windowNo,this.widgetInfo;var a=this,i=t('<div class="h-100 w-100">'),n="",l="",s="",o=[],r=(new VIS.CultureSeparator,null),c=null,u=null,d=null,g=0,p=0;function v(){n.append('<div class="VAS-orgName-col"><h1>#'+(p+1)+'</h1><div class="VAS-org-name"><span>'+o[p].Name+'</span></div></div><img src="'+(""!=o[p].ImageUrl?VIS.Application.contextUrl+o[p].ImageUrl:VIS.Application.contextUrl+"Areas/VAS/Content/Images/cube-icon.png")+'" alt="">'),s.append('<h1><span style="margin-right:0.2em;">'+o[p].Symbol+"</span>"+_(o[p].PreviousTotal,o[p].StdPrecision)+(null!=r?"<span>"+r+"</span>":"")+'<span class="VAS-sale-Qty">('+o[p].PreviousQty+" "+o[p].UOM+")</span></h1><span>"+VIS.Msg.getMsg("VAS_LastYear")+"</span>"),l.append('<h1><span style="margin-right:0.2em;">'+o[p].Symbol+"</span>"+_(o[p].CurrentTotal,o[p].StdPrecision)+(null!=r?"<span>"+r+"</span>":"")+'<span class="VAS-sale-Qty"">('+o[p].CurrentQty+" "+o[p].UOM+")</span></h1><span>"+VIS.Msg.getMsg("VAS_CurrentYear")+"</span>"),p>0?u.css("opacity","1"):u.css("opacity","0.6"),o.length-1>p?d.css("opacity","1"):d.css("opacity","0.6"),c.text(p+1+VIS.Msg.getMsg("VAS_Of")+o.length),e[0].style.visibility="hidden"}function _(e,t){return e>=1e12?(r=VIS.Msg.getMsg("VAS_Trillion"),(e/1e12).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e9?(r=VIS.Msg.getMsg("VAS_Billion"),(e/1e9).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e6?(r=VIS.Msg.getMsg("VAS_Million"),(e/1e6).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):e>=1e3?(r=VIS.Msg.getMsg("VAS_Thousand"),(e/1e3).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):(r=null,e.toLocaleString(window.navigator.language,{minimumFractionDigits:t,maximumFractionDigits:t}))}this.initalize=function(){(e=t("<div class='vis-apanel-busy'>")).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),e[0].style.visibility="visible",i.append(e),g=this.widgetInfo.AD_UserHomeWidgetID,i.append('<div class="VAS-selling-container VAS-lowest-selling-prod"><div class="VAS-container-heading">'+VIS.Msg.getMsg("VAS_LowestSellProduct")+'</div><div class="VAS-org-col" id="VAS_divProduct_'+g+'"></div><div class="VAS-yearly-revenue"><div class="VAS-lastRevenue" id="VAS_divLastYear_'+g+'"></div><div class="VAS-currentRevenue" id="VAS_divCurrentYear_'+g+'"></div><div class="VAS-pagination-sell"><div class= "VAS-arrow-col"><a href="javascript:void(0);"><span class="fa fa-arrow-left" id="VAS_Prev_'+g+'"></span></a><a href="javascript:void(0);"><span class="fa fa-arrow-right" id="VAS_Next_'+g+'"></span></a></div><div class="VAS-page-count" id="VAS_spnPageCount_'+g+'">1 of 10</div></div></div></div>'),n=i.find("#VAS_divProduct_"+g),s=i.find("#VAS_divLastYear_"+g),l=i.find("#VAS_divCurrentYear_"+g),c=i.find("#VAS_spnPageCount_"+g),u=i.find("#VAS_Prev_"+g),d=i.find("#VAS_Next_"+g),u.on(VIS.Events.onTouchStartOrClick,function(){p>0&&(e[0].style.visibility="visible",p--,n.empty(),s.empty(),l.empty(),v())}),d.on(VIS.Events.onTouchStartOrClick,function(){p<o.length-1&&(e[0].style.visibility="visible",p++,n.empty(),s.empty(),l.empty(),v())})},this.intialLoad=function(){n.empty(),s.empty(),l.empty(),p=0,VIS.dataContext.getJSONData(VIS.Application.contextUrl+"Product/GetLowestProductData","",function(t){null!=t&&(o=t,v()),e[0].style.visibility="hidden"})},this.getRoot=function(){return i},this.refreshWidget=function(){e[0].style.visibility="visible",p=0,a.intialLoad()}},e.VAS_LowestSellProduct.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad()},50)},e.VAS_LowestSellProduct.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_LowestSellProduct.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_LowestSellProduct.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},9673:()=>{VAS=window.VAS||{},function(e,t){e.VAS_InvGrandTotalWidget=function(){var a;this.frame,this.windowNo;var i=this,n=VIS.Env.getCtx(),l=null,s=null,o=null,r=t('<div class="h-100 w-100">'),c=null,u=(new VIS.CultureSeparator,null),d=0,g=null;function p(t,a){var i=t<0,n=0;return(t=Math.abs(t))>=1e12?(o=e.translatedTexts.VAS_Trillion,n=(t/1e12).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):t>=1e9?(o=e.translatedTexts.VAS_Billion,n=(t/1e9).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):t>=1e6?(o=e.translatedTexts.VAS_Million,n=(t/1e6).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):t>=1e3?(o=e.translatedTexts.VAS_Thousand,n=(t/1e3).toLocaleString(window.navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2})):(o="",n=t.toLocaleString(window.navigator.language,{minimumFractionDigits:a,maximumFractionDigits:a})),i&&(n="-"+n),n}this.initalize=function(){v(),(a=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>')).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),a[0].style.visibility="visible",r.append(a),u='<div class="vas-igtwidg-invoices-box vas-idtwidg-emptydiv"><div class="vas-igtwidg-invoices-detail" ><div class="vas-igtwidg-thumb-w-txt"><img src="" alt="" class="vas-igtwidg-emptyimg"><div class="vas-igtwidg-vendor-w-date"><div class="vas-igtwidg-vendor-name"></div><div class="vas-igtwidg-invoiceDate"></div></div>',s=0!=VIS.Utility.Util.getValueOfInt(this.widgetInfo.AD_UserHomeWidgetID)?this.widgetInfo.AD_UserHomeWidgetID:i.windowNo;var e=1==VIS.Env.getCtx().isSOTrx(i.windowNo)?"vas-igtwidg-customer-bgColor":"vas-igtwidg-vendor-bgColor";c=t('<div class="vas-igtwidg-top-vendors-col '+e+'">');var n=t('<div class="d-flex justify-content-between">'),o=t('<div class= "vas-igtwidg-vendors-heading">'+(1==VIS.Env.getCtx().isSOTrx(i.windowNo)?VIS.Msg.getMsg("VAS_Top5"):VIS.Msg.getMsg("VAS_TopPurchase5"))+"</div>");YearBasedDataListDiv=t('<div class="VAS-YearBasedDataListDiv">'),$YearBasedDataListDiv=t('<div class="input-group vis-input-wrap">'),l=VIS.MLookupFactory.get(VIS.Env.getCtx(),i.windowNo,0,VIS.DisplayType.List,"VAS_YearBasedData",ColumnIds.AD_Reference_ID,!1,null),i.vYearBasedDataList=new VIS.Controls.VComboBox("VAS_YearBasedData",!0,!1,!0,l,20),i.vYearBasedDataList.setValue("02");var g=t('<div class="vis-control-wrap">');$YearBasedDataListDiv.append(g),g.append(i.vYearBasedDataList.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")),$YearBasedDataListDiv.append(g),YearBasedDataListDiv.append($YearBasedDataListDiv),n.append(o).append(YearBasedDataListDiv),c.append(n),i.vYearBasedDataList.fireValueChanged=function(){d=0,i.vYearBasedDataList.setValue(i.vYearBasedDataList.getValue()),c.find("#vas_listContainer_"+s).remove(),c.find("#vas_norecordcont_"+s).remove(),a[0].style.visibility="visible",i.intialLoad()},a[0].style.visibility="visible"},this.intialLoad=function(){var l="hsl("+(Math.floor(360*Math.random())+0)+", 100%,"+(Math.floor(16*Math.random())+60)+"%)";VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetInvTotalGrandData",{ISOtrx:VIS.Env.getCtx().isSOTrx(i.windowNo),ListValue:i.vYearBasedDataList.getValue()},function(i){var v,_=i;if(null!=_&&_.length>0){v=["VAS_Since","VAS_Top5","VAS_Million","VAS_Trillion","VAS_Billion","VAS_Thousand","VAS_TopPurchase5"],e.translatedTexts=VIS.Msg.translate(n,v,!0),g=t('<div class="vas-igtwidg-vendors-listing" id="vas_listContainer_'+s+'">');for(var V=0;V<_.length;V++){d+=1;var A="",m=_[V].Name.trim().split(" ");A=m[0].substring(0,1).toUpperCase(),m.length>1?A+=m[m.length-1].substring(0,1).toUpperCase():A=m[0].substring(0,2).toUpperCase();var f='<div class="vas-igtwidg-invoices-box"><div class= "vas-igtwidg-invoices-detail"><div class="vas-igtwidg-thumb-w-txt">';null!=_[V].ImageUrl?f+='<img class="vas-businessPartnerImg" alt="'+_[V].ImageUrl+'" src="'+VIS.Application.contextUrl+_[V].ImageUrl+'">':f+='<div style="float:left; background-color:'+l+'" class="vas-igtwidg-img-icon"><span style="font-size: 16px;">'+A+"</span></div>",f+='<div class="vas-igtwidg-vendor-w-date"><div class="vas-igtwidg-vendor-name">'+_[V].Name+"</div></div></div >",f+='<div class="vas-igtwidg-invoiceTotalAmt"><span class="vas-igtwidg-amt-val">'+(3!=_[V].Symbol.length?'<span class="vas-vaswidg-Symbol">'+_[V].Symbol+"</span>":"")+p(_[V].GrandTotalAmt,_[V].stdPrecision)+'<span style="font-weight: 600;padding-left:1px;">'+o+"</span>",3==_[V].Symbol.length&&_[V].Symbol,f+="</div ></div >",g.append(f)}d<5&&function(e){for(var t=0;t<e;t++)g.append(u)}(5-d),c.append(g),r.append(c)}else c.append('<div class="vas-igwidg-notfounddiv" id="vas_norecordcont_'+s+'">'+VIS.Msg.getMsg("VAS_RecordNotFound")+"</div>"),r.append(c);a[0].style.visibility="hidden"})};var v=function(){ColumnIds=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VAS/PoReceipt/GetColumnID",{refernceName:"VAS_YearBasedData"},null)};this.getRoot=function(){return r},this.refreshWidget=function(){a[0].style.visibility="visible",d=0,c.find("#vas_listContainer_"+s).remove(),c.find("#vas_norecordcont_"+s).remove(),i.intialLoad()}},e.VAS_InvGrandTotalWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e,this.initalize(),this.frame.getContentGrid().append(this.getRoot());var a=this;window.setTimeout(function(){a.intialLoad()},50)},e.VAS_InvGrandTotalWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_InvGrandTotalWidget.prototype.widgetSizeChange=function(e){this.widgetInfo=e},e.VAS_InvGrandTotalWidget.prototype.dispose=function(){this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null}}(VAS,jQuery)},9751:()=>{VAS=window.VAS||{},function(e,t){e.VAS_CashBalanceWidget=function(){this.frame,this.windowNo;var e,a,i,n,l,s,o,r,c=this,u=0,d=4,g=[],p=null;function v(){$divCashBal=e.find("#div_cashBal_widget_"+p),n=e.find("#VAS_divCashBody_"+p),i=e.find("#div_cashDetail_"+p),$nextArrow=e.find("#VAS_CashNextArrow_"+p),l=e.find("#VAS_CashPrevArrow_"+p),s=e.find("#VAS_PageInfo_"+p),o=e.find("#busyDivId_"+p),$divnoCashData=e.find("#div_noCashData_"+p),V(!0),t.ajax({url:VIS.Application.contextUrl+"VAS_PaymentWidget/GetCashBookBalance",dataType:"json",async:!0,success:function(e){var a="";null==(g=jQuery.parseJSON(e))||g.length<=0?($divCashBal.find(".VAS_noBankData").length>0&&$divCashBal.find(".VAS_noBankData").remove(),a=t('<div class="VAS_noCashData"  id="div_noCashData_'+p+'">'+VIS.Msg.getMsg("VAS_NoData")+"</div>"),$divCashBal.append(a),$divCashBal.css("height","100%"),$divnoCashData.show(),n.hide(),l.addClass("disabled"),$nextArrow.addClass("disabled")):_(),V(!1)},error:function(e){console.log(e),V(!1)}}),$nextArrow.on("click",function(e){V(!0),(u+1)*d<g.length&&(u++,_()),V(!1)}),l.on("click",function(e){V(!0),u>0&&(u--,_()),V(!1)}),r='<div class="VAS-cashDetail-box VAS-cashDummy-div"><div class="VAS-cashbook-name"> - </div><div class="VAS-CashBaldata"><div class="VAS-cashISOCode">-</div> <div class="VAS-cashbook-amount">-</div></div></div>'}function _(){if(n.empty(),null!=g){var e=u*d,t=Math.min(e+d,g.length),a="<span>"+(u+1).toString()+" </span><span>"+VIS.Msg.getMsg("VAS_Of")+" </span><span>"+Math.ceil(g.length/d).toString()+"</span>";s.html(a);for(var o=$divCashBal.width(),c=e;c<t;c++)n.append('<div class="VAS-cashDetail-box" id="div_cashDetail_'+p+'"><div class="VAS-cashbook-name" title="'+g[c].Name+'">'+g[c].Name+'</div><div class="VAS-CashBaldata"><div class="VAS-cashISOCode"> '+g[c].CurSymbol+'</div> <div class="VAS-cashbook-amount">'+g[c].CompletedBalance.toLocaleString(window.navigator.language,{minimumFractionDigits:g[c].StdPrecision,maximumFractionDigits:g[c].StdPrecision})+"</div></div></div>");i.width(o-20),t-e<d&&function(e){for(var t=0;t<e;t++)n.append(r)}(d-(t-e)),0==u?(l.addClass("disabled"),$nextArrow.removeClass("disabled")):(l.removeClass("disabled"),t==g.length?$nextArrow.addClass("disabled"):$nextArrow.removeClass("disabled")),g.length<=4&&$nextArrow.addClass("disabled"),V(!1)}}function V(e){e?o.show():o.hide()}this.sizeChanged=function(e){for(var a=$divCashBal.width()-20,i=$divCashBal.find(".VAS-cashbook-name").length,n=0;n<i;n++)t($divCashBal.find(".VAS-cashbook-name")[n]).css("width",a+"px")},this.refreshWidget=function(){V(!0),u=0,d=4,g=[],v()},this.Initialize=function(){0==(p=this.widgetInfo.AD_UserHomeWidgetID)&&(p=c.windowNo),e=t('<div class="VAS-cashroot"  id="VAS_cashroot_"></div>'),a=t('<div id="busyDivId_'+p+'" class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis_widgetloader"></i></div></div>'),e.append(a),e.append('<div class="VAS-cashbalance-container" id="div_cashBal_widget_'+p+'"><div class="VAS-cashwidget-header"><h1>'+VIS.Msg.getMsg("VAS_CashBalance")+'</h1><div class="VAS-casharrow-control"><a href="#"><i id="VAS_CashPrevArrow_'+p+'" class="fa fa-arrow-circle-left VAS-cashwidget-leftar" aria-hidden="true"></i></a><span id="VAS_PageInfo_'+p+'" class="vas-cashwidget-pageInfo"></span><a href="#"><i id="VAS_CashNextArrow_'+p+'" class="fa fa-arrow-circle-right VAS-cashwidget-rightar" aria-hidden="true"></i></a></div></div><div class="VAS-cashwidget-body" id="VAS_divCashBody_'+p+'"></div>'),v()},this.getRoot=function(){return e}},e.VAS_CashBalanceWidget.prototype.refreshWidget=function(){this.refreshWidget()},e.VAS_CashBalanceWidget.prototype.widgetSizeChange=function(e){this.sizeChanged(e)},e.VAS_CashBalanceWidget.prototype.init=function(e,t){this.frame=t,this.widgetInfo=t.widgetInfo,this.windowNo=e;this.Initialize();this.frame.getContentGrid().append(this.getRoot())},e.VAS_CashBalanceWidget.prototype.dispose=function(){this.frame&&this.frame.dispose(),this.frame=null,this.windowNo=null,$bsyDiv=null,$self=null,$root=null,$dummDiv=null}}(VAS,jQuery)},9768:()=>{VAS=window.VAS||{},function(e,t){e.VAS_ScheduleDetail=function(){this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var a=this.ctx,n=1,l=10,s=this,o=0,r=[],c=0,u=[],d=null,g=null,p=null,v=null,_=null,V=null,A=null,m=null,f=null,D=!1;e.translatedTexts=VIS.Msg.translate(a,["VAS_LineNum","DueDate","DueAmt","VA009_PaymentMethod_ID","IsPaid","DateAcct","VAS_Payment","DocumentNo","C_BankAccount_ID","VAS_CheckDate","VAS_CheckNo","VAS_ClickToSeePayment","VAS_NotPaid"],!0);var h=t('<div class = "vas-scheduleData-root"></div>'),C=t("<div class ='vas-scheduleDataWrapper'></div>");m=t('<div class="VAS-scheduledata-Paging mr-3">');this.init=function(){C.append('<div class="vas-scheduleDataListGroup"><div id="VAS-ScheduleData_'+s.windowNo+'" class="VAS-ScheduleData mb-2"></div></div>'),h.append(C),d=t('<ul class="vis-statusbar-ul">'),g=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="First Page" style="opacity: 0.6;"></i></div></li>'),p=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="Page Up" style="opacity: 0.6;"></i></div></li>'),v=t("<select>"),_=t("<li>").append(v),V=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="Page Down" style="opacity: 0.6;"></i></div></li>'),A=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="Last Page" style="opacity: 0.6;"></i></div></li>'),d.append(g).append(p).append(_).append(V).append(A),m.append(d),g.on("click",function(){"1"==t(this).css("opacity")&&(n=1,s.getInvoiceTaxData(c))}),p.on("click",function(){"1"==t(this).css("opacity")&&(n--,s.getInvoiceTaxData(c))}),V.on("click",function(){"1"==t(this).css("opacity")&&(n++,s.getInvoiceTaxData(c))}),A.on("click",function(){"1"==t(this).css("opacity")&&(n=parseInt(v.find("Option:last").val()),s.getInvoiceTaxData(c))}),v.on("change",function(){n=v.val(),s.getInvoiceTaxData(c)}),h.append(m)},this.getInvoiceTaxData=function(a){t.ajax({url:VIS.Application.contextUrl+"VAS/PoReceipt/GetScheduleData",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{InvoiceId:a,pageNo:n,pageSize:l},success:function(a){if(C.find("#VAS-ScheduleData_"+s.windowNo).empty(),C.find("#vas_norecordcont_"+s.windowNo).remove(),""!=JSON.parse(a)){if(null!=(a=JSON.parse(a))&&a.length>0){for(r=a,o=Math.ceil(a[0].RecordCount/l),i=0;i<a.length;i++)f='<div data-payscheduleid="'+a[i].C_InvoicePaySchedule_ID+'" class="vas-scheduledatalist"><div class="vas-scheduleDataListItem mb-2 vas-scheduleDataListItem-block" title="'+e.translatedTexts.VAS_ClickToSeePayment+'">',"Y"==a[i].IsPaid?f+='<span class="vas-scheduleDataListPaid">'+e.translatedTexts.IsPaid+"</span>":f+='<span class="vas-scheduleDataListNotPaid">'+e.translatedTexts.VAS_NotPaid+"</span>",f+='<div class="vas-scheduleData-sglItem mb-2"><div class="vas-scheduleDataElement"><span class="vas-scheduleDataElementTTl font-weight-bold">'+e.translatedTexts.DueDate+'</span><span class="vas-scheduleDataElementValue">'+VIS.Utility.Util.getValueOfDate(a[i].DueDate).toLocaleDateString()+'</span></div><div class="vas-scheduleDataElement vas-setTaxPaybleAmtWidth"><span class="vas-scheduleDataElementTTl font-weight-bold text-right">'+e.translatedTexts.DueAmt+'</span><span class="vas-scheduleDataElementValue text-right">'+a[i].DueAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:a[i].stdPrecision,maximumFractionDigits:a[i].stdPrecision})+'</span></div><div class="vas-scheduleDataElement vas-setTaxAmtWidth"><span class="vas-scheduleDataElementTTl font-weight-bold" title="'+e.translatedTexts.VA009_PaymentMethod_ID+'">'+e.translatedTexts.VA009_PaymentMethod_ID+'</span><span class="vas-scheduleDataElementValue">'+a[i].PayMethod+'</span></div></div ></div><div id="VAS-PaymentData_'+s.windowNo+'" class="VAS-PaymentData mb-2"></div></div>',f+='<div id="VAS-PaymentData_'+s.windowNo+'" class="VAS-PaymentData mb-2"></div></div>',C.find("#VAS-ScheduleData_"+s.windowNo).append(f);h.find(".VAS-scheduledata-Paging").show(),function(e){if(v.empty(),e>0){for(var a=0;a<e;a++)v.append(t("<option value="+(a+1)+">"+(a+1)+"</option>"));v.val(n),e>n?(V.css("opacity","1"),A.css("opacity","1")):(V.css("opacity","0.6"),A.css("opacity","0.6")),n>1?(g.css("opacity","1"),p.css("opacity","1")):(g.css("opacity","0.6"),p.css("opacity","0.6")),1==e&&(g.css("opacity","0.6"),p.css("opacity","0.6"),V.css("opacity","0.6"),A.css("opacity","0.6"))}else g.css("opacity","0.6"),p.css("opacity","0.6"),V.css("opacity","0.6"),A.css("opacity","0.6")}(o),C.find("#VAS-ScheduleData_"+s.windowNo).find(".vas-scheduledatalist").on("click",function(){var a=t(this).attr("data-payscheduleid");u=jQuery.grep(r,function(e){return VIS.Utility.Util.getValueOfInt(e.C_InvoicePaySchedule_ID)==VIS.Utility.Util.getValueOfInt(a)}),t(this).find(".VAS-PaymentData").click(function(e){e.stopPropagation()}),C.find("#VAS-ScheduleData_"+s.windowNo).find(".vas-scheduleDataListItem").removeClass("vas-scheduleData-Active"),t(this).find(".vas-scheduleDataListItem").addClass("vas-scheduleData-Active"),f='<div class="vas-paymentDataListItem vas-newListItem mb-2"><div class="vas-paymentheading">'+e.translatedTexts.VAS_Payment+'</div><hr class="vas-paymentData-underline"><div class="vas-paymentData-sglItem mb-2"><div class="vas-paymentDataElement"><span class="vas-paymentDataElementTTl font-weight-bold">'+e.translatedTexts.DocumentNo+'</span><span class="vas-paymentDataElementValue">'+(u[0].DocumentNo||"")+'</span></div><div class="vas-paymentDataElement"><span class="vas-paymentDataElementTTl font-weight-bold">'+e.translatedTexts.DateAcct+'</span><span class="vas-paymentDataElementValue">'+(null!=u[0].DateAcct?VIS.Utility.Util.getValueOfDate(u[0].DateAcct).toLocaleDateString():"")+'</span></div><div class="vas-paymentDataElement"><span class="vas-paymentDataElementTTl font-weight-bold">'+e.translatedTexts.VAS_CheckDate+'</span><span class="vas-paymentDataElementValue">'+(null!=u[0].CheckDate?VIS.Utility.Util.getValueOfDate(u[0].CheckDate).toLocaleDateString():"")+'</span></div><div class="vas-paymentDataElement"><span class="vas-paymentDataElementTTl font-weight-bold">'+e.translatedTexts.VAS_CheckNo+'</span><span class="vas-paymentDataElementValue">'+(u[0].CheckNo||"")+"</span></div></div></div></div>",t(this).find("#VAS-PaymentData_"+s.windowNo).find(".vas-paymentDataListItem").length>0?D=!1:(D=!0,C.find("#VAS-ScheduleData_"+s.windowNo).find(".vas-scheduledatalist").find("#VAS-PaymentData_"+s.windowNo).empty()),D&&"Y"==u[0].IsPaid&&"RE"!=u[0].DocStatus&&"VO"!=u[0].DocStatus?t(this).find("#VAS-PaymentData_"+s.windowNo).append(f):"Y"==u[0].IsPaid&&(t(this).find(".vas-scheduleDataListItem").removeClass("vas-scheduleData-Active"),t(this).find("#VAS-PaymentData_"+s.windowNo).empty())})}}else C.append('<div class="vas-igwidg-notfounddiv" id="vas_norecordcont_'+s.windowNo+'">'+VIS.Msg.getMsg("VAS_ScheduleDataNotFound")+"</div>"),h.find(".VAS-scheduledata-Paging").hide()},error:function(e){console.log(e)}})},this.getRoot=function(){return h},e.VAS_ScheduleDetail.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,s.windowNo=e,this.init()},e.VAS_ScheduleDetail.prototype.refreshPanelData=function(e,t){this.record_ID=e,c=e,n=1,l=10,this.selectedRow=t,this.getInvoiceTaxData(e)},e.VAS_ScheduleDetail.prototype.sizeChanged=function(e){this.panelWidth=e},e.VAS_ScheduleDetail.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,lblTitle=null}}}(VAS,jQuery)},9873:()=>{!function(e,t){function a(){this.frame,this.windowNo;var a=this,i=!1,n=!1,l=[],s=0,o=0,r=[],c=new e.Controls.VLabel(e.Msg.getElement(e.Env.getCtx(),"M_Attribute_ID"),"M_Attribute_ID",!1,!0),u=new e.Controls.VLabel(e.Msg.getElement(e.Env.getCtx(),"M_Attribute_ID"),"M_Attribute_ID",!1,!0),d=new e.Controls.VLabel(e.Msg.getElement(e.Env.getCtx(),"M_PriceList_ID"),"M_PriceList_ID",!1,!0),g=new e.Controls.VLabel(e.Msg.getElement(e.Env.getCtx(),"M_Warehouse_ID"),"M_Warehouse_ID",!1,!0),p=(new e.Controls.VLabel(e.Msg.getMsg("Mode",!1,!1),"Mode",!1,!0),new e.Controls.VComboBox("",!1,!1,!0)),v=new e.Controls.VComboBox("",!1,!1,!0),_=new e.Controls.VComboBox("",!1,!1,!0),V=new e.Controls.VComboBox("",!1,!1,!0),A=new e.Controls.VComboBox("",!1,!1,!0);this.log=e.Logging.VLogger.getVLogger("VAttributeGrid");var m=t("<div class='vis-forms-container' style='width: 100%; height: 100%; background-color: white; '>"),f=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),D=null,h=null,C=null,S=null,I=null,y=null,O=null,T=null,w=null,P=260,b=50,M=t(window).width()-P,x=t(window).width()-b,N=(t(window).height(),t("<table style='width: 100%;'>"));function L(){l.push({Key:"0",Name:e.Msg.getMsg("ModeView",!1,!1)}),R(A.getControl(),l),t.ajax({url:e.Application.contextUrl+"Common/GetDataQueryAttribute",type:"GET",dataType:"json",async:!1,success:function(e){if(e.lst){r=e.lst;for(var t=0;t<r.length;t++)U(p.getControl(),r[t].GetKeyNamePair,t),U(v.getControl(),r[t].GetKeyNamePair,t)}e.priceList&&R(_.getControl(),e.priceList),e.whList&&R(V.getControl(),e.whList),setBusy(!1)}})}function R(e,t){for(var a=0;a<t.length;a++)e.append(" <option selected value='"+t[a].Key+"' >"+t[a].Name+"</option>");e.prop("selectedIndex",0)}function U(e,t,a){0==a&&e.append(" <option selected value='0' ></option>"),e.append(" <option selected value='"+t.Key+"' >"+t.Name+"</option>"),e.prop("selectedIndex",0)}function E(i,n,l,r){var c=0,u=0,d=0,g=0;i&&(c=i.GetM_Attribute_ID,u=i.GetM_AttributeValue_ID),n&&(d=n.GetM_Attribute_ID,g=n.GetM_AttributeValue_ID),t.ajax({url:e.Application.contextUrl+"Common/GetGridElement",dataType:"json",data:{xM_Attribute_ID:c,xM_AttributeValue_ID:u,yM_Attribute_ID:d,yM_AttributeValue_ID:g,M_PriceList_Version_ID:s,M_Warehouse_ID:o,windowNo:a.windowNo},async:!1,success:function(e){setBusy(!1)}})}function k(){if(null!=p&&!n){var i=p.getControl()[0].selectedIndex,l=v.getControl()[0].selectedIndex;if(i!=l){n=!0,s=_.getControl().find("option:selected").val(),o=V.getControl().find("option:selected").val();var u=2,d=[],g=[],m=null,f=null;i>0&&(d=r[i-1].GetMAttributeValues),null!=d&&(u=d.length+1,a.log.info("X - "+r[i-1].GetName+" #"+d.length));var D=2;l>0&&(g=r[l-1].GetMAttributeValues),g.length>0&&(D=g.length+1,a.log.info("Y - "+r[l-1].GetName+" #"+g.length)),a.log.info("Rows="+D+" - Cols="+u),function(a,i){for(i=i<2?2:i,a+=1,row=0;row<a;row++){var n=t("<tr id='row_"+row+"' >");for(N.append(n),col=0;col<i;col++){var l=t("<td id='col_"+col+"'  style='padding: 4px 15px 2px;'>");n.append(l)}}var s=new e.Controls.VLabel;s.getControl().text("Mode");var o=N.find("#row_0");2==i?(o.find("#col_"+(i-1)).append(A.getControl().css("display","inline-block").css("width","236px").css("height","30px")),o.find("#col_"+(i-2)).append(s.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))):(o.find("#col_2").append(A.getControl().css("display","inline-block").css("width","236px").css("height","30px")),o.find("#col_1").append(s.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")))}(D,u);for(row=0;row<D;row++)for(col=0;col<u;col++)if(null!=d&&(m=d[col]),null!=g&&(f=g[row]),0==row&&0==col){var h=new e.Controls.VLabel,C=new e.Controls.VLabel;null!=d&&(h.getControl().text(r[i-1].GetName),N.find("#row_1").find("#col_"+col).append(h.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))),g.length>0&&(C.getControl().text(r[l-1].GetName),N.find("#row_1").find("#col_"+col).append(C.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))),null!=m&&((c=new e.Controls.VLabel).getControl().text(m.Name),N.find("#row_1").find("#col_"+(col+1)).append(c.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")))}else 0==row?null!=m&&((c=new e.Controls.VLabel).getControl().text(m.Name),N.find("#row_1").find("#col_"+(col+1)).append(c.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))):0==col?null!=f&&((c=new e.Controls.VLabel).getControl().text(f.Name),N.find("#row_"+row+1).find("#col_"+col).append(c.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))):E(m,f,col,row);n=!1}else a.log.warning("Same Attribute Selected")}}setBusy=function(e){f.css("display",e?"block":"none")},this.Initialize=function(){if(function(){setBusy(!0),e.Application.contextUrl,D=t("<div id='sideDiv_"+a.windowNo+"' class='vis-archive-left-sidebar'>"),C=t("<div id='btnSpaceDiv_"+a.windowNo+"'  class='vis-archive-l-s-head'><button id='btnSpace_"+a.windowNo+"' class='vis-archive-sb-t-button'><i class='vis vis-arrow-left'></i></button></div></div>"),S=t("<div class='vis-archive-l-s-content vis-leftsidebarouterwrap' id='parameterDiv_"+a.windowNo+"'>"),D.append(C).append(S),e.Application.contextUrl,T=t("<button id='btnRefresh_"+a.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button'><i class='vis vis-refresh'></i></button>"),O=t("<input id='btnOk_"+a.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' style='min-width: 70px;' type='button' value='"+e.Msg.getMsg("OK",!1,!1)+"'>");var i=t("<table style='width: 100%;'>");S.append(i),tr=t("<tr>"),td=t("<td style='padding: 10px 10px 0px'>");var n=t('<div class="input-group vis-input-wrap">'),l=t('<div class="vis-control-wrap">');i.append(tr),tr.append(td),td.append(n),n.append(l),l.append(p.getControl().css("display","inline-block")),l.append(c.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px;'>"),n=t('<div class="input-group vis-input-wrap">'),l=t('<div class="vis-control-wrap">'),i.append(tr),tr.append(td),td.append(n),n.append(l),l.append(v.getControl().css("display","inline-block")),l.append(u.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px'>"),n=t('<div class="input-group vis-input-wrap">'),l=t('<div class="vis-control-wrap">'),i.append(tr),tr.append(td),td.append(n),n.append(l),l.append(_.getControl().css("display","inline-block")),l.append(d.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")),tr=t("<tr>"),td=t("<td style='padding: 0px 10px 0px'>"),n=t('<div class="input-group vis-input-wrap">'),l=t('<div class="vis-control-wrap">'),i.append(tr),tr.append(td),td.append(n),n.append(l),l.append(V.getControl().css("display","inline-block")),l.append(g.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")),y=t("<div class='vis-frm-bot-btn-wrp'>");var s=t("<div class='vis-frm-bot-btn-wrp'>");s.append(O),y.append(T),h=t("<div id='rightSideGridDiv_"+a.windowNo+"' class='vis-frm-grid-wrap'>"),(I=t("<div id='gridDiv_"+a.windowNo+"' class='vis-frm-grid-inn'>")).append(N),h.append(I),h.append(s),D.append(y),m.append(f),m.append(D).append(h)}(),w=m.find("#btnSpace_"+a.windowNo),null!=O&&O.on(e.Events.onTouchStartOrClick,function(){A.getControl().find("option:selected").val(),a.dispose()}),null!=T&&T.on(e.Events.onTouchStartOrClick,function(){setBusy(!0),N.empty(),k(),setBusy(!1)}),null!=w)var n=0;w.on(e.Events.onTouchStartOrClick,function(){i?(T.show(),c.getControl().show(),u.getControl().show(),n=e.Application.isRTL?180:0,w.animate({borderSpacing:n},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),i=!1,h.animate({width:M},"slow"),S.css("display","block"),C.animate({width:P},"slow"),D.animate({width:P},"slow")):(n=e.Application.isRTL?0:180,T.hide(),c.getControl().hide(),u.getControl().hide(),w.animate({borderSpacing:n},{step:function(e,a){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),i=!0,h.animate({width:x},"slow"),D.animate({width:b},"slow"),C.animate({width:b},"slow"),S.css("display","none"))})},this.display=function(){setTimeout(L(),5)},this.getRoot=function(){return m},this.disposeComponent=function(){O&&O.off(e.Events.onTouchStartOrClick),T&&T.off(e.Events.onTouchStartOrClick),w&&w.off(e.Events.onTouchStartOrClick),a.windowNo=null,i=null,c=null,u=null,a.log=null,m=null,f=null,D=null,h=null,C=null,S=null,I=null,y=null,O=null,T=null,w=null,P=null,b=null,M=null,x=null,a=null,this.getRoot=null,this.disposeComponent=null}}e.Apps.AForms=e.Apps.AForms||{},a.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.Initialize(),this.frame.getContentGrid().append(this.getRoot()),this.display()},a.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.VAttributeGrid=a}(VIS,jQuery)},9914:()=>{VIS=window.VIS||{},function(e,t){function a(){this.windowNo=null;var a=t("<div style='width: 100%; height: 100%; background-color: white;'>"),i=this,n=null,l=null,s=null,o=null,r=null,c=null,u=null,d=null,g=null,p=null,v=null,_=null,V=null,A=null,m=null,f=null,D=e.Application.contextUrl+"JsonData/JDataSetWithCode";function h(e){v[0].style.visibility=e?"visible":"hidden"}function C(){var t=null;t=null!=m?jQuery.extend(!0,{},m):new e.Query;var a=s.getValue();null!=a&&"-1"!=a.toString()&&0!=a.toString().trim().length||(a=null),null!=a&&a.toString().length>0&&t.addRestriction("AD_Org_ID",e.Query.prototype.EQUAL,a),null!=(a=_.getValue())&&a.toString().length>0&&t.addRestriction("M_Locator_ID",e.Query.prototype.EQUAL,a),null!=(a=V.getValue())&&a.toString().length>0&&t.addRestriction("M_Product_ID",e.Query.prototype.EQUAL,a),null!=(a=o.getValue())&&"-1"!=a.toString()&&0!=a.toString().trim().length||(a=null),null!=a&&a.toString().length>0&&t.addRestriction("MovementType",e.Query.prototype.EQUAL,a);var i=r.val().toString();null!=i&&i.length>0&&(i=new Date(i),t.addRestriction("TRUNC(MovementDate,'DD')",e.Query.prototype.GREATER_EQUAL,i)),null!=(i=c.val().toString())&&i.length>0&&(i=new Date(i),t.addRestriction("TRUNC(MovementDate,'DD')",e.Query.prototype.LESS_EQUAL,i)),f.setQuery(t),A.query(0,0,!1)}this.initialize=function(){(v=t('<div class="vis-busyindicatorouterwrap" style="visibility: hidden;"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="hidden",a.append(v),h(!0),window.setTimeout(function(){!function(){t(window).height();var v=e.MLookupFactory.get(e.Env.getCtx(),0,0,e.DisplayType.TableDir,"AD_Org_ID",0,!1," AD_Org.AD_Org_ID <> 0 AND AD_Org.IsSummary='N' AND AD_Org.IsActive='Y' AND AD_Org.IsCostCenter='N' AND AD_Org.IsProfitCenter='N' ");s=new e.Controls.VComboBox("AD_Org_ID",!1,!1,!0,v,50);var D=e.MLookupFactory.get(e.Env.getCtx(),0,0,e.DisplayType.List,"MovementType",189,!1,null);o=new e.Controls.VComboBox("MovementType",!1,!1,!0,D,29);var I=t("<div class='input-group vis-input-wrap'>"),y=t("<div class='vis-control-wrap'>"),O=t("<div class='input-group-append'>"),T=e.MLookupFactory.get(e.context,0,0,e.DisplayType.Search,"M_Locator_ID",0,!1,"");_=new e.Controls.VTextBoxButton("M_Locator_ID",!1,!1,!0,e.DisplayType.Search,T),I.append(y),y.append(_.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),I.append(O),O.append(_.getBtn(0)),O.append(_.getBtn(1)),_.getBtn(0).addClass("vis-lookupButtons"),_.getBtn(1).addClass("vis-lookupButtons");var w=t("<div class='input-group vis-input-wrap'>"),P=t("<div class='vis-control-wrap'>"),b=t("<div class='input-group-append'>"),M=e.MLookupFactory.get(e.context,0,0,e.DisplayType.Search,"M_Product_ID",0,!1,"");V=new e.Controls.VTextBoxButton("M_Product_ID",!1,!1,!0,e.DisplayType.Search,M),w.append(P),P.append(V.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),w.append(b),b.append(V.getBtn(0)),b.append(V.getBtn(1)),V.getBtn(0).addClass("vis-lookupButtons"),V.getBtn(1).addClass("vis-lookupButtons"),n=t("<div class='vis-mainContainer'>");var x=t("<div class='vis-pSelectInfo vis-leftsidebarouterwrap'>"),N=t("<div class='vis-pSelectInner'>");x.append(N);var L=t("<div class='vis-paymentselect-field'>"),R=t("<div class='input-group vis-input-wrap'>"),U=t("<div class='vis-control-wrap'>");L.append(R),R.append(U),U.append(s.getControl()),U.append(t("<label>"+e.Msg.translate(e.Env.getCtx(),"AD_Org_ID")+" </label>")),N.append(L);var E=t("<div class='vis-paymentselect-field'>"),k=t("<div class='input-group vis-input-wrap'>"),G=t("<div class='vis-control-wrap'>");E.append(k),k.append(G),G.append(o.getControl()),G.append(t("<label>"+e.Msg.translate(e.Env.getCtx(),"MovementType")+" </label>")),N.append(E);var B=t("<div class='vis-paymentselect-field'>");B.append(I),y.append(t("<label>"+e.Msg.translate(e.Env.getCtx(),"M_Locator_ID")+" </label>")),N.append(B);var F=t("<div class='vis-paymentselect-field'>");F.append(w),P.append(t("<label>"+e.Msg.translate(e.Env.getCtx(),"Product")+" </label>")),N.append(F);var Q=t("<div class='vis-paymentselect-field'>"),$=t("<div class='input-group vis-input-wrap'>"),W=t("<div class='vis-control-wrap'>");W.append(t("<input  id='VIS_dtpFromDate"+i.windowNo+"'type='date'>")),W.append(t("<label>"+e.Msg.translate(e.Env.getCtx(),"DateFrom")+" </label>")),Q.append($),$.append(W),N.append(Q);var J=t("<div class='vis-paymentselect-field'>"),j=t("<div class='input-group vis-input-wrap'>"),z=t("<div class='vis-control-wrap'>");z.append(t("<input  id='VIS_dtpToDate"+i.windowNo+"'type='date'>")),z.append(t("<label>"+e.Msg.translate(e.Env.getCtx(),"DateTo")+" </label>")),J.append(j),j.append(z),N.append(J);var q=t("<div class='vis-paymentselect-field'>");q.append(t("<button class='VIS_Pref_btn-2' id='VIS_btnRefresh_"+i.windowNo+"' style='margin-top: 0px;'><i class='vis vis-refresh'></i></button>")),x.append(q);var Y=t("<div class='vis-paymentselect-field'>");Y.append(t("<button class='VIS_Pref_btn-2' id='VIS_btnZoom_"+i.windowNo+"' style='margin-top: 0px;'><i class='vis vis-find'></i></button>")),x.append(Y),l=t("<div class='vis-pSelectIionGrid'>");var H=" <div class='vis-pSelectProcess'> <div class='vis-paymentselect-field'> <input id='VIS_btnCancel_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+e.Msg.getMsg("Cancel")+"' ></input> <input id='VIS_btnOK_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+e.Msg.getMsg("OK")+"' ></input> </div> </div>";n.append(x).append(l).append(t(H)),a.append(n),function(){r=t("#VIS_dtpFromDate"+i.windowNo),c=t("#VIS_dtpToDate"+i.windowNo),u=t("#VIS_btnRefresh_"+i.windowNo),d=t("#VIS_btnZoom_"+i.windowNo),g=t("#VIS_btnOK_"+i.windowNo),p=t("#VIS_btnCancel_"+i.windowNo);var e=new Date,a=("0"+e.getDate()).slice(-2),n=("0"+(e.getMonth()+1)).slice(-2);e.getFullYear()}(),window.setTimeout(function(){var a;a=223,e.AEnv.getGridWindow(i.windowNo,a,function(a){if(null!=a.error)return e.ADialog.error(a.error),self.dispose(),void(self=null);var n=t.parseJSON(a.result);e.context.setContextOfWindow(t.parseJSON(a.wCtx),i.windowNo);var s=new e.GridWindow(n);null!=s&&(f=s.getTabs()[0],(A=new e.GridController(!1)).initGrid(!0,i.windowNo,i,f),A.setVisible(!0),window.innerHeight>700?A.sizeChanged(window.innerHeight-230,window.innerWidth):A.sizeChanged(window.innerHeight-215,window.innerWidth),l.append(A.getRoot()),A.activate(),(m=new e.Query).addRestriction("AD_Client_ID",e.Query.prototype.EQUAL,e.context.getAD_Client_ID()))})},20),u.on("click",function(){C()}),d.on("click",function(){!function(){var t=0,a=null,n=null,l=[],s=e.context.getContextAsInt(i.windowNo,"M_InOutLine_ID");if(0!=s?(e.context.getContext(i.windowNo,"MovementType").equals("C-")?t=169:e.context.getContext(i.windowNo,"MovementType").equals("C+")?t=409:e.context.getContext(i.windowNo,"MovementType").equals("V+")?t=184:e.context.getContext(i.windowNo,"MovementType").equals("V-")&&(t=411),a="M_InOut_ID",n="VIS_140",l[0]=new e.DB.SqlParam("@lineID",s)):0!=(s=e.context.getContextAsInt(i.windowNo,"M_InventoryLine_ID"))?(t=168,a="M_Inventory_ID",n="VIS_141",l[0]=new e.DB.SqlParam("@lineID",s)):0!=(s=e.context.getContextAsInt(i.windowNo,"M_MovementLine_ID"))?(t=170,a="M_Movement_ID",n="VIS_142",l[0]=new e.DB.SqlParam("@lineID",s)):0!=(s=e.context.getContextAsInt(i.windowNo,"M_ProductionLine_ID"))&&(t=191,a="M_Production_ID",n="VIS_143",l[0]=new e.DB.SqlParam("@lineID",s)),0!=t)A.getSelectedRows().length>0?function(t,a,i,n){var l=new e.Query;l.addRestriction(t,e.Query.prototype.EQUAL,n),e.viewManager.startWindow(i,l)}(a,0,t,e.Utility.Util.getValueOfInt(S(n,null,null))):alert(e.Msg.getMsg("NoRecordSelected"))}()}),g.on("click",function(){C()}),p.on("click",function(){i.dispose()}),h(!0)}(),h(!1)},20)};var S=function(a,i,n){var l=!!n,s=null;return function(e,a,i){var n=null;t.ajax({url:D,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:a,data:JSON.stringify(e)}).done(function(e){n=e,i&&i(e)})}({sql:a,page:1,pageSize:0},l,function(t){a=(new e.DB.DataSet).toJson(t);var a=(new e.DB.DataSet).toJson(t);s=a.getTable(0).getRows().length>0?a.getTable(0).getRow(0).getCell(0):null,a.dispose(),a=null,l&&n(s)}),s};this.getRoot=function(){return a},this.refreshUI=function(){A&&A.vTable.resize()},this.dataStatusChanged=function(e){},this.setBusy=function(e){h(e)},this.disposeComponent=function(){windowNo=null,a=null,i=this,n=null,$divBankAccount=null,$divCurrentBalance=null,$divBusinessPartner=null,$divOnlyDueInvoice=null,$divPaymentDate=null,$divPaymentMethod=null,l=null,$cmbBankAccount=null,$cmbBusinessPartner=null,$cmbPaymentMethod=null,$cmbPaymentDate=null,$lblCurrentBal=null,$chkOnlyDueInvoice=null,$txtCurrentBal=null,$lblMsg=null,$txtPaymentAmount=null,u=null,g=null,p=null}}e.Apps.AForms=e.Apps.AForms||{},a.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.frame.getContentGrid().append(this.getRoot()),this.initialize()},a.prototype.refresh=function(){this.refreshUI()},a.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.VTrxMaterial=a}(VIS,jQuery)},9936:()=>{!function(e){e.Logging.Level,e.Utility.Util;function t(){e.CalloutEngine.call(this,"VIS.CalloutCurrency")}function a(){e.CalloutEngine.call(this,"VIS.CalloutPriclistUOM")}e.Utility.inheritPrototype(t,e.CalloutEngine),t.prototype.Currency=function(t,a,i,n,l,s){if(null==l||""==l.toString())return"";try{var o=e.dataContext.getJSONRecord("MPriceList/GetPriceList",l.toString());null!=o&&i.setValue("C_Currency_ID",o.C_Currency_ID)}catch(e){this.setCalloutActive(!1)}return i=l=null,""},e.Model.CalloutCurrency=t,e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.SetUOM=function(t,a,i,n,l,s){if(this.isCalloutActive()||null==l||""==l.toString())return"";this.setCalloutActive(!0),null!=i.getField("M_AttributeSetInstance_ID")&&i.setValue("M_AttributeSetInstance_ID",null);try{var o=e.dataContext.getJSONRecord("MProduct/GetC_UOM_ID",l.toString());i.setValue("C_UOM_ID",o)}catch(e){this.setCalloutActive(!1),this.log.severe(e.toString())}return this.setCalloutActive(!1),i=l=null,""},e.Model.CalloutPriclistUOM=a}(VIS,jQuery)},9957:()=>{VIS=window.VIS||{},function(e,t){e.AcctViewerMenu=function(){this.frame,this.windowNo;var a=this,i="",n=t("<div>");this.initalize=function(){n.append('<a id="VIS_btnResult_'+a.windowNo+'">button</a>'),(i=n.find("#VIS_btnResult_"+a.windowNo)).on("click",function(){a.frame.dispose()})},this.openAccountViewer=function(){var t=new e.AcctViewer(e.context.getAD_Client_ID(),1,1,this.windowNo,1);null!=t&&(t.setIsMenu(!0),t.showDialog()),i.trigger("click")},this.getRoot=function(){return n}},e.AcctViewerMenu.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.initalize(),this.openAccountViewer(),this.frame.getContentGrid().append(this.getRoot())},e.AcctViewerMenu.prototype.dispose=function(){this.disposeComponent(),this.frame=null}}(VIS,jQuery)},9959:()=>{VAS=window.VAS||{},function(e,t){e.RequisitionLinesTabPanel=function(){this.record_ID=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var a=null,n=this.ctx;e.translatedTexts=VIS.Msg.translate(n,["VAS_ReuitionLinesTabPanel","VAS_LineNo","VAS_Requition","VAS_Product","VAS_Charge","VAS_QuantityReq","VAS_Uom","VAS_UnitPrice","VAS_LineAmount","VAS_Description"],!0);var l=t('<div class = "root"></div>'),s=t("<div class ='vas-apTaxWrapper'></div>");a=t("<h6 class='vas-apTax-ttl'>"+e.translatedTexts.VAS_ReuitionLinesTabPanel+"</h6>"),this.init=function(){s.append(a),function(){s.append('<div class="vas-aptaxListGroup"><div id="VAS-TaxDetail_'+this.windowNo+'" class= "VAS-TaxDetail mb-2" > </div></div>')}(),l.append(s)},this.getReuitionLinesData=function(a){t.ajax({url:VIS.Application.contextUrl+"VAS/OrderLineTabPanel/GetRequitionLinesData",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{OrderLineId:a},success:function(t){if(s.find("#VAS-TaxDetail_"+self.windowNo).empty(),null!=(t=JSON.parse(t))&&t.length>0)for(i=0;i<t.length;i++){var a='<div class="vas-apListItem mb-2"><div class="vas-ap-sglItem d-flex flex-column mb-2"><div class="vas-singleItemListWrap mb-2"><div class="vas-singleTaxElement vas-setTaxWidth vas-setUomWidth"><span class="vas-singleTaxElementTTl font-weight-bold w-100">'+e.translatedTexts.VAS_LineNo+'</span><span class="vas-singleRequesitionValue">'+t[i].LineNo+'</span></div><div class="vas-singleTaxElement vas-setTaxPaybleAmtWidth vas-setUomWidth"><span class="vas-singleTaxElementTTl font-weight-bold w-100">'+e.translatedTexts.VAS_Requition+'</span><span class="vas-singleRequesitionValue w-100">'+t[i].RequitionDocumentNo+'</span></div><div class="vas-singleTaxElement vas-setShipWidth vas-setChargeWidth"><span class="vas-singleTaxElementTTl w-100 font-weight-bold vas-tp-widthpro">'+e.translatedTexts.VAS_Product+'</span><span class="vas-singleRequesitionValue w-100">'+t[i].ProductName+'</span></div><div class="vas-singleTaxElement vas-setTaxProWidth vas-setUomWidth"><span class="vas-singleTaxElementTTl w-100 font-weight-bold">'+e.translatedTexts.VAS_QuantityReq+'</span><span class="vas-singleRequesitionValue w-100">'+t[i].Qty.toLocaleString()+'</span></div><div class="vas-singleTaxElement vas-setTaxProWidth vas-setChargeWidth"><span class="vas-singleTaxElementTTl w-100 font-weight-bold vas-setShipWidth">'+e.translatedTexts.VAS_Charge+'</span><span class="vas-singleRequesitionValue w-100">'+t[i].ChargeName+'</span></div><div class="vas-singleTaxElement vas-setTaxProWidth vas-setUomWidth"><span class="vas-singleTaxElementTTl w-100 font-weight-bold">'+e.translatedTexts.VAS_Uom+'</span><span class="vas-singleRequesitionValue w-100">'+t[i].UomName+'</span></div><div class="vas-singleTaxElement vas-setTaxProWidth vas-setUomWidth"><span class="vas-singleTaxElementTTl w-100 font-weight-bold">'+e.translatedTexts.VAS_UnitPrice+'</span><span class="vas-singleRequesitionValue w-100">'+t[i].PriceActual.toLocaleString(window.navigator.language,{minimumFractionDigits:t[i].StdPrecision,maximumFractionDigits:t[i].StdPrecision})+'</span></div><div class="vas-singleTaxElement vas-setTaxProWidth vas-setUomWidth"><span class="vas-singleTaxElementTTl w-100 font-weight-bold">'+e.translatedTexts.VAS_LineAmount+'</span><span class="vas-singleRequesitionValue w-100">'+t[i].LineNetAmt.toLocaleString(window.navigator.language,{minimumFractionDigits:t[i].StdPrecision,maximumFractionDigits:t[i].StdPrecision})+'</span></div></div><div class="vas-singleTaxElement"><span class="vas-singleTaxElementTTl w-100 font-weight-bold vas-setReqAmtWidth">'+e.translatedTexts.VAS_Description+'</span><span class="vas-singleTaxDescription">'+t[i].Description+"</span></div></div ></div>";s.find("#VAS-TaxDetail_"+this.windowNo).append(a)}},error:function(e){console.log(e)}})},this.getRoot=function(){return l},e.RequisitionLinesTabPanel.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,this.init()},e.RequisitionLinesTabPanel.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.getReuitionLinesData(e)},e.RequisitionLinesTabPanel.prototype.sizeChanged=function(e){this.panelWidth=e},e.RequisitionLinesTabPanel.prototype.dispose=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,a=null}}}(VAS,jQuery)}},a={};function n(e){var i=a[e];if(void 0!==i)return i.exports;var l=a[e]={exports:{}};return t[e](l,l.exports,n),l.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";n(3306),n(9397),n(9463),n(2789),n(8818),n(745),n(7123),n(6656),n(3650),n(5239),n(318),n(9957),n(3632),n(3490),n(3392),n(8949),n(9873),n(3835),n(1560),n(8806),n(9914),n(2572),n(315),n(9469),n(4416),n(7932),n(3970),n(6085),n(7487),n(5068),n(6351),n(6397),n(2425),n(3475),n(8236),n(7001),n(1682),n(5116),n(5390),n(7096),n(8323),n(3225),n(8435),n(6381),n(4559),n(5375),n(2685),n(9936),n(2738),n(5290),n(472),n(8692),n(8489),n(5176),n(3208),n(6997),n(7018),n(9192),n(290),n(4943),n(1895),n(5024),n(1637),n(8722),n(9959),n(4096),n(1071),n(3309),n(8648),n(1528),n(3378),n(1113),n(284),n(9673),n(141),n(9383),n(3983),n(9659),n(5924),n(9751),n(5635),n(2123),n(4018),n(9459),n(7522),n(1870),n(1186),n(7566),n(2468),n(7162),n(4864),n(1025),n(6593),n(6943),n(5456),n(7270),n(7328),n(5209),n(5878),n(1109),n(4374),n(7483),n(9768),n(5648),n(4099),n(818),n(3003),n(6429),n(1339),n(4033),n(7520)})()})();