/*version 1.0.0.9*/(function(n,t){function i(){function di(){var t=n.dataContext.getJSONData(n.Application.contextUrl+"ForecastForm/GetTableAndRecordInfo",{AD_Table_ID:r.ad_table_ID,AD_Record_ID:r.record_ID});t!=null&&(w=n.Utility.Util.getValueOfInt(t.AD_Org_ID),tt=n.Utility.Util.getValueOfString(t.Table_Name)=="C_MasterForecast"?!0:!1,b=n.Utility.Util.getValueOfString(t.Table_Name)=="VA073_SalesForecast"?!0:!1,vi=n.Utility.Util.getValueOfInt(t.TeamColumn_ID),pi=n.Utility.Util.getValueOfInt(t.BudgetColumn_ID))}function gi(){et=t('<div class="vis-budget-main-wrap vis-formouterwrpdiv">');s=t('<div class="vis-budget-form-wrap">');u=t('<div class="vis-budget-form-row">');f=t('<div class="input-group vis-input-wrap" id="VIS_Organization_'+r.windowNo+'">');u.append(f);s.append(u);u=t('<div class="vis-budget-form-row">');f=t('<div class="input-group vis-input-wrap" id="VIS_Period_'+r.windowNo+'">');u.append(f);s.append(u);u=t('<div class="vis-budget-form-row">');f=t('<div class="input-group vis-input-wrap" id="VIS_IncludeSO_'+r.windowNo+'">');u.append(f);s.append(u);u=t('<div class="vis-budget-form-row">');f=t('<div class="input-group vis-input-wrap" id="VIS_DocumentType_'+r.windowNo+'">');u.append(f);s.append(u);u=t('<div class="vis-budget-form-row">');f=t('<div class="input-group vis-input-wrap" id="VIS_IncludeOpenSalesOrder_'+r.windowNo+'">');u.append(f);s.append(u);u=t('<div class="vis-budget-form-row">');f=t('<div class="input-group vis-input-wrap" id="VIS_OpenSalesOrder_'+r.windowNo+'">');u.append(f);s.append(u);u=t('<div class="vis-budget-form-row">');f=t('<div class="input-group vis-input-wrap" id="VIS_IncludeOpportunity_'+r.windowNo+'">');u.append(f);s.append(u);u=t('<div class="vis-budget-form-row">');f=t('<div class="input-group vis-input-wrap" id="VIS_Opportunity_'+r.windowNo+'">');u.append(f);s.append(u);tt&&(u=t('<div class="vis-budget-form-row">'),f=t('<div class="input-group vis-input-wrap" id="VIS_TeamForecast_'+r.windowNo+'">'),u.append(f),s.append(u));b&&(u=t('<div class="vis-budget-form-row">'),f=t('<div class="input-group vis-input-wrap" id="VIS_BudgetForecast_'+r.windowNo+'">'),u.append(f),s.append(u));u=t('<div class="vis-budget-form-row">');f=t('<div class="input-group vis-input-wrap" id="VIS_ProductCategory_'+r.windowNo+'">');u.append(f);s.append(u);b&&(u=t('<div class="vis-budget-form-row">'),f=t('<div class="input-group vis-input-wrap" id="VIS_PriceList_'+r.windowNo+'">'),u.append(f),s.append(u));u=t('<div class="vis-budget-form-row">');f=t('<div class="input-group vis-input-wrap" id="VIS_BudgetQuantity_'+r.windowNo+'">');u.append(f);s.append(u);u=t('<div class="vis-budget-form-row">');f=t('<div class="input-group vis-input-wrap" id="VIS_GenerateLines_'+r.windowNo+'">');u.append(f);s.append(u);yt=t('<div class="VIS_buttons-wrap .vis-budget-buttons-wrap">');pt=t('<div class="pull-right">');wt=t('<span class="btn vis-budget-buttons-wrap-span">'+n.Msg.translate(p,"VIS_OK")+"<\/span>");bt=t('<span class="btn vis-budget-buttons-wrap-span">'+n.Msg.translate(p,"Cancel")+"<\/span>");ai=t('<span class="btn vis-budget-buttons-wrap-span">'+n.Msg.translate(p,"Apply")+"<\/span>");pt.append(wt).append(ai).append(bt);yt.append(pt);et.append(s).append(yt);o.append(et).append(ft)}function nr(){ot=o.find("#VIS_Organization_"+r.windowNo);st=o.find("#VIS_Period_"+r.windowNo);gt=o.find("#VIS_IncludeSO_"+r.windowNo);ni=o.find("#VIS_DocumentType_"+r.windowNo);ii=o.find("#VIS_IncludeOpenSalesOrder_"+r.windowNo);ht=o.find("#VIS_OpenSalesOrder_"+r.windowNo);ui=o.find("#VIS_IncludeOpportunity_"+r.windowNo);ct=o.find("#VIS_Opportunity_"+r.windowNo);tt&&(lt=o.find("#VIS_TeamForecast_"+r.windowNo));b&&(oi=o.find("#VIS_BudgetForecast_"+r.windowNo),hi=o.find("#VIS_PriceList_"+r.windowNo));at=o.find("#VIS_ProductCategory_"+r.windowNo);ci=o.find("#VIS_BudgetQuantity_"+r.windowNo);li=o.find("#VIS_GenerateLines_"+r.windowNo)}function tr(){var yt,pt,i,wt,u,bt,ai,bi,di,f,gi,nr,o,tr,s,ir,d,rr,ft,ur,et,fr,er;kt=n.MLookupFactory.get(p,r.windowNo,w,n.DisplayType.Search,"AD_Org_ID",0,!1,"AD_Org_ID.IsActive = 'Y'");rt=new n.Controls.VTextBoxButton("AD_Org_ID",!0,!1,!1,n.DisplayType.Search,kt);yt=t('<div class="vis-control-wrap">');pt=t('<div class="input-group-append">');ot.append(yt);yt.append(rt.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+n.translatedTexts.AD_Org_ID+"<\/label>");ot.append(pt);pt.append(rt.getBtn(0));i="C_Period.IsActive='Y' AND C_Period.C_Year_ID  IN  (Select C_Year_ID FROM C_Year WHERE C_Calendar_ID =  ((SELECT AD_OrgInfo.C_Calendar_ID FROM AD_OrgInfo WHERE AD_OrgInfo.AD_Org_ID = "+w+"))  OR (EXISTS(SELECT 1 FROM AD_OrgInfo WHERE AD_OrgInfo.AD_Org_ID = "+w+" AND AD_OrgInfo.C_Calendar_ID IS NULL) AND  (C_Calendar_ID = (SELECT AD_ClientInfo.C_Calendar_ID FROM AD_ClientInfo WHERE AD_ClientInfo.AD_Client_ID = "+ki+")))  AND C_year.IsActive = 'Y') and C_Period.Startdate < SYSDATE ORDER BY C_Period.C_Period_ID";dt=n.MLookupFactory.get(p,r.windowNo,1004891,n.DisplayType.Search,"C_Period_ID",0,!1,i);a=new n.Controls.VTextBoxButton("C_Period_ID",!0,!1,!0,n.DisplayType.Search,dt);wt=t('<div class="vis-control-wrap">');u=t('<div class="input-group-append">');st.append(wt);wt.append(a.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+n.translatedTexts.C_Period_ID+"<\/label>");st.append(u);u.append(a.getBtn(0));u.append(a.getBtn(1));a.getControl().prop("disabled",!0);a.getBtn(0).prop("disabled",!0);a.getBtn(1).prop("disabled",!0);h=new n.Controls.VCheckBox("IncludeSO",!1,!1,!0,n.Msg.getMsg("IncludeSO"),null);bt=t('<div class="vis-control-wrap">');gt.append(bt);bt.append(h.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," "));i="C_DocType.IsActive = 'Y' AND C_DocType.DocBaseType IN ('SOO', 'POO', 'BOO') AND C_DocType.IsSOTrx = 'Y' AND  C_DocType.IsReturnTrx = 'N' AND  C_DocType.IsSalesQuotation = 'N' AND C_DocType.IsBlanketTrx = 'N'  AND C_DocType.AD_Org_ID IN (0, "+w+") ";ti=n.MLookupFactory.get(p,r.windowNo,2173,n.DisplayType.TableDir,"C_DocType_ID",0,!1,i);it=new n.Controls.VComboBox("C_DocType_ID",!1,!1,!0,ti,50);it.getControl().prop("disabled",!0);ai=t('<div class="vis-control-wrap">');ni.append(ai);ai.append(it.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+n.translatedTexts.C_DocType_ID+"<\/label>");v=new n.Controls.VCheckBox("IncludeOpenSO",!1,!1,!0,n.Msg.getMsg("IncludeOpenSO"),null);bi=t('<div class="vis-control-wrap">');ii.append(bi);bi.append(v.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," "));i="C_Order.DocStatus IN ('CO') AND C_Order.IsSOTrx = 'Y' AND  C_Order.IsReturnTrx = 'N' AND  C_Order.IsSalesQuotation = 'N' AND C_Order.IsBlanketTrx = 'N' AND C_Order.AD_Org_ID IN (0, "+w+")";ri=n.MLookupFactory.get(p,r.windowNo,2213,n.DisplayType.MultiKey,"C_Order_ID",0,!1,i);c=new n.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,n.DisplayType.MultiKey,ri);c.getControl().prop("disabled",!0);c.getBtn(0).prop("disabled",!0);c.getBtn(1).prop("disabled",!0);c.setCustomInfo("Budget_OpenSalesOrder");di=t('<div class="vis-control-wrap">');f=t('<div class="input-group-append">');ht.append(di);di.append(c.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+n.Msg.getMsg("OpenSO")+"<\/label>");ht.append(f);f.append(c.getBtn(0));f.append(c.getBtn(1));y=new n.Controls.VCheckBox("IncludeOpportunity",!1,!1,!0,n.Msg.getMsg("IncludeOpportunity"),null);gi=t('<div class="vis-control-wrap">');ui.append(gi);gi.append(y.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," "));i="C_Project.IsActive = 'Y' AND C_Project.IsOpportunity = 'Y' AND C_Project.AD_Org_ID IN (0, "+w+")";fi=n.MLookupFactory.get(p,r.windowNo,5766,n.DisplayType.MultiKey,"C_Project_ID",0,!1,i);l=new n.Controls.VTextBoxButton("C_Project_ID",!0,!1,!0,n.DisplayType.MultiKey,fi);l.getControl().prop("disabled",!0);l.getBtn(0).prop("disabled",!0);l.getBtn(1).prop("disabled",!0);l.setCustomInfo("Budget_Opportunity");nr=t('<div class="vis-control-wrap">');o=t('<div class="input-group-append">');ct.append(nr);nr.append(l.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+n.Msg.getMsg("Opportunity")+"<\/label>");ct.append(o);o.append(l.getBtn(0));o.append(l.getBtn(1));tt&&(i=" C_Forecast.AD_Org_ID IN (0, "+w+") AND C_Forecast.DocStatus IN ('CO', 'CL')",ei=n.MLookupFactory.get(p,r.windowNo,vi,n.DisplayType.MultiKey,"C_Forecast_ID",0,!1,i),nt=new n.Controls.VTextBoxButton("C_Forecast_ID",!0,!1,!0,n.DisplayType.MultiKey,ei),nt.setCustomInfo("Budget_TeamForecast"),tr=t('<div class="vis-control-wrap">'),s=t('<div class="input-group-append">'),lt.append(tr),tr.append(nt.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+n.translatedTexts.TeamForecast+"<\/label>"),lt.append(s),s.append(nt.getBtn(0)),s.append(nt.getBtn(1)));b&&(i=" C_MasterForecast.AD_Org_ID IN (0, "+w+") AND C_MasterForecast.DocStatus IN ('CO', 'CL')",yi=n.MLookupFactory.get(p,r.windowNo,pi,n.DisplayType.MultiKey,"C_MasterForecast_ID",0,!1,i),ut=new n.Controls.VTextBoxButton("C_MasterForecast_ID",!0,!1,!0,n.DisplayType.MultiKey,yi),ir=t('<div class="vis-control-wrap">'),d=t('<div class="input-group-append">'),oi.append(ir),ir.append(ut.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+n.translatedTexts.MasterForecast+"<\/label>"),oi.append(d),d.append(ut.getBtn(0)),d.append(ut.getBtn(1)));i="M_Product_Category.IsActive = 'Y' AND M_Product_Category.AD_Org_ID IN (0, "+w+")";si=n.MLookupFactory.get(p,r.windowNo,2012,n.DisplayType.MultiKey,"M_Product_Category_ID",0,!1,i);e=new n.Controls.VTextBoxButton("M_Product_Category_ID",!0,!1,!0,n.DisplayType.MultiKey,si);rr=t('<div class="vis-control-wrap">');ft=t('<div class="input-group-append">');at.append(rr);rr.append(e.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+n.translatedTexts.M_Product_Category_ID+"<\/label>");at.append(ft);ft.append(e.getBtn(0));ft.append(e.getBtn(1));e.fireValueChanged=function(){e.getControl().trigger("change")};b&&(i="M_PriceList.IsActive = 'Y' AND M_PriceList.IsSOPriceList='Y' AND M_PriceList.AD_Org_ID IN (0, "+w+")",wi=n.MLookupFactory.get(p,r.windowNo,2100,n.DisplayType.Search,"M_PriceList_ID",0,!1,i),k=new n.Controls.VTextBoxButton("M_PriceList_ID",!0,!1,!0,n.DisplayType.Search,wi),ur=t('<div class="vis-control-wrap">'),et=t('<div class="input-group-append">'),hi.append(ur),ur.append(k.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+n.translatedTexts.M_PriceList_ID+"<\/label>"),hi.append(et),et.append(k.getBtn(0)),et.append(k.getBtn(1)),k.getControl().prop("disabled",!0));g=new n.Controls.VAmountTextBox("BudgetQuantity",!1,!1,!0,50,100,n.DisplayType.Quantity);g.getControl().prop("disabled",!0);fr=t('<div class="vis-control-wrap">');ci.append(fr);fr.append(g.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).append("<label>"+n.Msg.getMsg("BudgetQuantity")+"<\/label>");vt=new n.Controls.VCheckBox("GenerateLines",!1,!1,!0,n.Msg.getMsg("GenerateLines"),null);er=t('<div class="vis-control-wrap">');li.append(er);er.append(vt.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," "))}function ir(){rt.setValue(w);h.getControl().on("click",function(){it.getControl().prop("disabled",h.getValue()?!1:!0);a.getControl().prop("disabled",h.getValue()?!1:!0);a.getBtn(0).prop("disabled",h.getValue()?!1:!0);a.getBtn(1).prop("disabled",h.getValue()?!1:!0);h.getValue()||(it.setValue(),a.setValue());e.getControl().trigger("change")});v.getControl().on("click",function(){c.getControl().prop("disabled",v.getValue()?!1:!0);c.getBtn(0).prop("disabled",v.getValue()?!1:!0);c.getBtn(1).prop("disabled",v.getValue()?!1:!0);v.getValue()||c.setValue();e.getControl().trigger("change")});y.getControl().on("click",function(){l.getControl().prop("disabled",y.getValue()?!1:!0);l.getBtn(0).prop("disabled",y.getValue()?!1:!0);l.getBtn(1).prop("disabled",y.getValue()?!1:!0);y.getValue()||l.setValue();e.getControl().trigger("change")});e.getControl().on("change",function(){e.getControl().prop("disabled",v.getValue()||y.getValue()||h.getValue()?!0:!1);e.getBtn(0).prop("disabled",v.getValue()||y.getValue()||h.getValue()?!0:!1);e.getBtn(1).prop("disabled",v.getValue()||y.getValue()||h.getValue()?!0:!1);v.getValue()||y.getValue()||h.getValue()?e.setValue():"";e.getValue()!=undefined||n.Utility.Util.getValueOfString(e.getValue())!=""?(g.getControl().prop("disabled",!1),k.getControl().prop("disabled",!1)):(g.getControl().prop("disabled",!0),g.getControl().val(0),k.getControl().prop("disabled",!0))});wt.on("click",function(){d(!0);var t=0,i=0,u=0;if(tt&&(t=nt.getValue()),b&&(i=ut.getValue(),u=k.getValue()),e.getValue()!=undefined||n.Utility.Util.getValueOfString(e.getValue())!=""){if(n.Utility.Util.getValueOfDecimal(g.getValue())==0)return n.ADialog.info("SelectBudgetQunatity"),d(!1),!1;if(b&&n.Utility.Util.getValueOfDecimal(k.getValue())==0)return n.ADialog.info("SelectPriceList"),d(!1),!1}bi(t,i,u,function(t){n.ADialog.info("","",JSON.parse(t));d(!1);r.frame.close()})});ai.on("click",function(){d(!0);var t=0,i=0,r=0;if(tt&&(t=nt.getValue()),b&&(i=ut.getValue(),r=k.getValue()),e.getValue()!=undefined||n.Utility.Util.getValueOfString(e.getValue())!=""){if(n.Utility.Util.getValueOfDecimal(g.getValue())==0)return n.ADialog.info("SelectBudgetQunatity"),d(!1),!1;if(b&&n.Utility.Util.getValueOfDecimal(k.getValue())==0)return n.ADialog.info("SelectPriceList"),d(!1),!1}bi(t,i,r,function(t){n.ADialog.info("","",JSON.parse(t));d(!1)})});bt.on("click",function(){r.frame.close()})}function bi(i,u,f,o){t.ajax({url:n.Application.contextUrl+"ForecastForm/CreateForecastLine",type:"POST",dataType:"json",async:!0,data:{Org_ID:rt.getValue(),Period_ID:a.getValue(),IncludeSO:h.getValue(),DocType:it.getValue(),IncludeOpenSO:v.getValue(),OpenOrders:c.getValue(),IncludeOpportunity:y.getValue(),Opportunity:l.getValue(),ProductCategory:e.getValue(),BudgetQunatity:g.getValue(),DeleteAndGenerateLines:vt.getValue(),Forecast_ID:r.record_ID,TeamForecast_IDS:i,Table_ID:r.ad_table_ID,IsMasterForecast:tt,IsBudgetForecast:b,MasterForecast_IDs:u,SalesPriceList_ID:f},success:function(n){o(n)},error:function(t){console.log(t);d(!1);n.ADialog.error("Error")}})}function d(n){ft[0].style.visibility=n?"visible":"hidden"}this.frame;this.windowNo;var r=this,o=t("<div style='height:100%;background-color:white;' class='vis-forms-container' >"),ft=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>'),p=n.Env.getCtx(),et=null,s=null,u=null,f=null,ot,kt,rt,st,dt,a,gt,h,ni,ti,it,ii,v,ht,ri,c,ui,y,ct,fi,l,lt,ei,nt,vi=0,oi,yi,ut,pi=0,at,si,e,hi,wi,k,ci,g,li,vt,yt=null,pt=null,wt=null,bt=null,ai=null;this.ad_table_ID;this.ad_window_ID;this.record_ID;var w=n.context.getWindowContextAsInt(r.windowNo,"AD_Org_ID",!1),ki=n.context.getWindowContextAsInt(r.windowNo,"AD_Client_ID",!1),tt=!1,b=!1;n.translatedTexts=n.Msg.translate(n.Env.getCtx(),["AD_Org_ID","C_Period_ID","C_DocType_ID","M_Product_Category_ID","TeamForecast","MasterForecast","M_PriceList_ID"],!0);this.Initialize=function(){d(!0);di();gi();nr();tr();ir();d(!1)};this.setHeight=function(){tt?367:b?402:352};this.setWidth=function(){return 635};this.getRoot=function(){return o};this.disposeComponent=function(){r=null;o=null;ft=null;et=null;s=null;u=null;f=null;yt=null;pt=null;wt=null;bt=null;ot=null;kt=null;rt=null;st=null;dt=null;a=null;gt=null;h=null;ni=null;ti=null;it=null;ii=null;v=null;ht=null;ri=null;c=null;ui=null;y=null;ct=null;fi=null;l=null;lt=null;ei=null;nt=null;at=null;si=null;e=null;ci=null;g=null;li=null;vt=null};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.ad_table_ID=this.frame.getAD_Table_ID();this.ad_window_ID=this.frame.getAD_Window_ID();this.record_ID=this.frame.getRecord_ID();this.Initialize();this.frame.getContentGrid().append(this.getRoot())};i.prototype.dispose=function(){this.disposeComponent();this.frame=null}}n.AForms=n.AForms||{};n.AForms.createforecast=i})(VIS,jQuery),function(n,t){function i(){function b(){var u,b,k;if(o=t('<div class="vis-gl-main-wrap">'),u=n.context.getWindowContext(r.windowNo,"AD_Column_ID",!0),u=="")return n.ADialog.error("VIS_DimensionColNotSelected",!0,"",""),!1;b=n.dataContext.getJSONRecord("GlJournall/ColumnName",u);s=t('<div class="vis-gl-form-wrap">');h=t('<div class="vis-gl-form-row">');c=t('<div class="vis-gl-form-col">');w=t("<label>"+n.Msg.translate(e,b)+"<\/label>");c.append(w);$formDataR=t('<div class="vis-gl-form-col2">');k=n.MLookupFactory.getMLookUp(e,r.windowNo,n.Utility.Util.getValueOfString(u),n.DisplayType.Search);i=new n.Controls.VTextBoxButton(b,!1,!1,!0,n.DisplayType.Search,k);$formDataR.append(t("<div>").append(i).append(i.getControl()).append(i.getBtn(0)));h.append(c).append($formDataR);s.append(h);l=t('<div class="VIS_buttons-wrap .vis-gl-buttons-wrap">');a=t('<div class="pull-right">');v=t('<span class="btn vis-gl-buttons-wrap-span">'+n.Msg.translate(e,"VIS_OK")+"<\/span>");y=t('<span class="btn vis-gl-buttons-wrap-span">'+n.Msg.translate(e,"Cancel")+"<\/span>");a.append(v).append(y);l.append(a);o.append(s).append(l);p.append(o).append(f)}function k(){var t=n.context.getWindowContextAsInt(r.windowNo,"DimensionValue",!0);t>0&&i.setValue(t);v.on("click",function(){if(u(!0),i.getValue()==null)return u(!1),n.ADialog.error("VIS_DimensionNotSelected",!0,"",""),!1;var t=n.context.getWindowContext(r.windowNo,"GL_LineDimension_ID",!0),f=t.toString().concat(",",i.getValue().toString()),e=n.dataContext.getJSONRecord("GlJournall/SaveDimensionReference",f);if(e<=0)return u(!1),n.ADialog.error("VIS_NotSaved",!0,"",""),!1;n.ADialog.info("VIS_Saved",!0,"","");u(!1);r.frame.close()});y.on("click",function(){r.frame.close()})}function u(n){f[0].style.visibility=n?"visible":"hidden"}this.frame;this.windowNo;var r=this,p=t("<div style='height:100%;background-color:white;' class='vis-forms-container' >"),f=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>'),e=n.Env.getCtx(),o=null,s=null,h=null,c=null,w=null,i=null,l=null,a=null,v=null,y=null;this.Initialize=function(){u(!0);b();k();u(!1)};this.setHeight=function(){return 235};this.setWidth=function(){return 368};this.getRoot=function(){return p};this.disposeComponent=function(){r=null;p=null;f=null;o=null;s=null;h=null;c=null;w=null;i=null;l=null;a=null;v=null;y=null}}n.AForms=n.AForms||{};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.Initialize();this.frame.getContentGrid().append(this.getRoot())};i.prototype.dispose=function(){this.disposeComponent();this.frame=null};n.AForms.glDimensionValue=i}(VIS,jQuery),function(n,t){function i(){function eh(n,i,r){var u=null;return t.ajax({url:uh,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(n)}).done(function(n){u=n;r&&r(n)}),u}function oh(){function h(){return gr==!0&&nu==!0&&tu==!0&&iu==!0?!0:!1}function o(){return l.val()==0&&w.val()==0?(n.ADialog.info("",!0,n.Msg.getMsg("allocationFrom_And_allocationTo"),""),w.addClass("vis-ev-col-mandatory"),l.addClass("vis-ev-col-mandatory"),!1):w.val()==0?(n.ADialog.info("",!0,n.Msg.getMsg("selectAllocationFrom"),""),l.val(0),w.addClass("vis-ev-col-mandatory"),l.addClass("vis-ev-col-mandatory"),!1):l.val()==0?(n.ADialog.info("",!0,n.Msg.getMsg("selectAllocationTo"),""),l.addClass("vis-ev-col-mandatory"),!1):!0}function c(){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?di():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),ai.setValue(null)):ai.setValue(null):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),ai.setValue(null))}function y(){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?hi():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),li.setValue(null)):li.setValue(null):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),li.setValue(null))}gt.on("change",function(){if(gi.setContext(e.windowNo,"OrgID",n.Utility.Util.getValueOfInt(gt.val())),pt.getControl().val(""),s.is(":checked")&&a.val()==""){b();k();return}n.Utility.Util.getValueOfInt(p.value)>0||(p.getControl().addClass("vis-ev-col-mandatory"),b())});p.fireValueChanged=fl;pt.fireValueChanged=el;st.on("change",function(){if(tf("C_Currency_ID",st.val()),s.is(":checked")&&a.val()==""){b();k();return}n.Utility.Util.getValueOfInt(p.value)>0||(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),b())});s.on("change",function(){if(tf("Date",s.is(":checked")),s.is(":checked")&&a.val()==""){a.val("");return}n.Utility.Util.getValueOfInt(p.value)>0||(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),b());s.is(":checked")||a.val("")});ee.on("change",function(){sf.is(":checked")&&(t(".vis-allocate-invoicediv").insertBefore(".vis-allocate-gldiv"),rt.css("display","none"),ot.css("display","none"),yt.css("display","block"),lt.css("display","block"),i&&i.refresh(),r&&r.refresh());gs()});cs.on("click",function(){if(s.is(":checked")&&(a.val()==""||pt.getValue()==null&&(w.val()=="I"&&l.val()=="P"||w.val()=="P"&&l.val()=="I"||w.val()=="I"&&l.val()=="I"))){a.val()==""?n.ADialog.warn("VIS_SlctcnvrsnDate"):pt.getValue()==null&&n.ADialog.warn("VIS_SlctcnvrsnType");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(k(),ll()):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),p.getControl().addClass("vis-ev-col-mandatory"),k(),b())});sf.on("change",function(){ee.prop("checked",!1);sf.is(":checked")?(t(".vis-allocate-invoicediv").insertBefore(".vis-allocate-gldiv"),lt.css("display","block"),yt.css("display","block"),rt.css("display","none"),ot.css("display","none"),i&&i.refresh(),r&&r.refresh()):(t(".vis-allocate-invoicediv").insertBefore(".vis-allocate-paymentdiv"),lt.css("display","block"),yt.css("display","none"),rt.css("display","block"),ot.css("display","none"),i&&i.refresh(),u&&u.refresh())});ue.on("change",function(){});ht.on("change",function(){if(ds()){if(new Date(ht.val())<ur)return n.ADialog.info("",!0,n.Msg.getMsg("SelectMaxDate")+Globalize.format(new Date(ur),"yyyy-MM-dd"),""),ht.val(Globalize.format(new Date(ur),"yyyy-MM-dd")),!1}else n.ADialog.info("",!0,n.Msg.getMsg("PleaseSelectRecord"),"")});su.on("click",function(){if(n.Utility.Util.getValueOfInt(p.value)==0)return n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),p.getControl().addClass("vis-ev-col-mandatory"),k(),b(),!1;if(ds()){if(ht.val().trim()=="")return n.ADialog.info("",!0,n.Msg.getMsg("InvalidDateFormat"),""),!1;if(ht.val()<Globalize.format(new Date(ur),"yyyy-MM-dd"))return n.ADialog.info("",!0,n.Msg.getMsg("SelectMaxDate")+Globalize.format(new Date(ur),"yyyy-MM-dd"),""),ht.val(Globalize.format(new Date(ur),"yyyy-MM-dd")),!1;ru?parseInt(d.val())>0?nh():n.ADialog.info("",!0,n.Msg.getMsg("ValidateOrg"),""):n.ADialog.confirm("ConfirmForDiffOrg",!0,"","Confirm",function(t){if(t)parseInt(d.val())>0?nh():n.ADialog.info("",!0,n.Msg.getMsg("ValidateOrg"),"");else return})}else n.ADialog.info("",!0,n.Msg.getMsg("PleaseSelectRecord"),"")});li.fireValueChanged=y;bt.on("change",function(){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?hi():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),bt.val(0)):bt.val(0):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),bt.val(0))});ai.fireValueChanged=c;kt.on("change",function(){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?di():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),kt.val(0)):kt.val(0):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),kt.val(0))});ii.on("change",function(){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?di():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),ii.val(0)):ii.val(0):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),ii.val(0))});ti.on("change",function(){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?hi():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),ti.val(0)):ti.val(0):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),ti.val(0))});ni.on("change",function(){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?uu():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),ni.val(0)):ni.val(0):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),ni.val(0))});vi.on("blur",function(){var i=Date.parse(vi.val()),t=new Date(parseInt(i));if(!isNaN(t.getTime())&&t.getTime()<0){n.ADialog.warn("VIS_InvalidDate");return}if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?hi():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),vi.val("")):vi.val(""):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),vi.val(""))});ei.on("blur",function(){var i=Date.parse(ei.val()),t=new Date(parseInt(i));if(!isNaN(t.getTime())&&t.getTime()<0){n.ADialog.warn("VIS_InvalidDate");return}if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?hi():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),ei.val("")):ei.val(""):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),ei.val(""))});nr.on("blur",function(){var i=Date.parse(nr.val()),t=new Date(parseInt(i));if(!isNaN(t.getTime())&&t.getTime()<0){n.ADialog.warn("VIS_InvalidDate");return}if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?di():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),nr.val("")):nr.val(""):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),nr.val(""))});yi.on("blur",function(){var i=Date.parse(yi.val()),t=new Date(parseInt(i));if(!isNaN(t.getTime())&&t.getTime()<0){n.ADialog.warn("VIS_InvalidDate");return}if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?di():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),yi.val("")):yi.val(""):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),yi.val(""))});tr.on("blur",function(){var i=Date.parse(tr.val()),t=new Date(parseInt(i));if(!isNaN(t.getTime())&&t.getTime()<0){n.ADialog.warn("VIS_InvalidDate");return}if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?uu():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),tr.val("")):tr.val(""):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),tr.val(""))});pi.on("blur",function(){var i=Date.parse(pi.val()),t=new Date(parseInt(i));if(!isNaN(t.getTime())&&t.getTime()<0){n.ADialog.warn("VIS_InvalidDate");return}if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?uu():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),pi.val("")):pi.val(""):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),pi.val(""))});ir.on("blur",function(){var i=Date.parse(ir.val()),t=new Date(parseInt(i));if(!isNaN(t.getTime())&&t.getTime()<0){n.ADialog.warn("VIS_InvalidDate");return}if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?yu():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),ir.val("")):ir.val(""):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),ir.val(""))});wi.on("blur",function(){var i=Date.parse(wi.val()),t=new Date(parseInt(i));if(!isNaN(t.getTime())&&t.getTime()<0){n.ADialog.warn("VIS_InvalidDate");return}if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()?h()?yu():(n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),""),wi.val("")):wi.val(""):(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),wi.val(""))});wu.on("keypress",function(t){if(t.keyCode==13){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?(cu=1,hi()):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")}});ns.on("click",function(){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?(cu=1,hi()):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")});pu.on("keypress",function(t){if(t.keyCode==13){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?(au=1,di()):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")}});go.on("click",function(){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?(au=1,di()):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")});bu.on("keypress",function(t){if(t.keyCode==13){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?(lu=1,uu()):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")}});ts.on("click",function(){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?(lu=1,uu()):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")});lf.on("keypress",function(t){if(t.keyCode==13){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?(vu=1,yu()):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")}});is.on("click",function(){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?(vu=1,yu()):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")});bi.on("change",function(n){var u,r,f;for(v[0].style.visibility="visible",u=t("#grid_"+i.name+'_records td[col="0"]').find('input[type="checkbox"]'),r=0;r<u.length;r++){if(t(u[r]).prop("checked",bi.prop("checked")),!be(u[r],!0,!1,!1,!1))break;i.editChange.call(i,u[r],r,0,n);f={type:"click",phase:"before",target:"grid",recid:r,index:r,isStopped:!1,"isCan//celled":!1,onComplete:null};i.trigger(f)}bi.prop("checked")==!1&&(ft=[]);v[0].style.visibility="hidden"});hr.on("change",function(n){var r,i,f;for(v[0].style.visibility="visible",r=t("#grid_"+u.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<r.length;i++){if(t(r[i]).prop("checked",hr.prop("checked")),!be(r[i],!1,!0,!1,!1))break;u.editChange.call(u,r[i],i,0,n);f={type:"click",phase:"before",target:"grid",recid:i,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};u.trigger(f)}hr.prop("checked")==!1&&(ct=[]);v[0].style.visibility="hidden"});cr.on("change",function(n){var r,i,u;for(v[0].style.visibility="visible",r=t("#grid_"+f.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<r.length;i++){if(t(r[i]).prop("checked",cr.prop("checked")),!be(r[i],!1,!1,!0,!1))break;f.editChange.call(f,r[i],i,0,n);u={type:"click",phase:"before",target:"grid",recid:i,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};f.trigger(u)}cr.prop("checked")==!1&&(vt=[]);v[0].style.visibility="hidden"});oi.on("change",function(n){var u,i,f;for(v[0].style.visibility="visible",oi.prop("checked")==!1&&(si=[]),u=t("#grid_"+r.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<u.length;i++){if(t(u[i]).prop("checked",oi.prop("checked")),!be(u[i],!1,!1,!1,!0))break;r.editChange.call(r,u[i],i,0,n);f={type:"click",phase:"before",target:"grid",recid:i,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null};r.trigger(f)}oi.prop("checked")==!1&&(ut=[]);v[0].style.visibility="hidden"});d.on("change",function(){parseInt(d.val())>0?d.removeClass("vis-ev-col-mandatory"):d.addClass("vis-ev-col-mandatory")});a.on("blur",function(){var i=Date.parse(a.val()),t=new Date(parseInt(i));if(!isNaN(t.getTime())&&t.getTime()<0){n.ADialog.warn("VIS_InvalidDate");return}if(uo=a.val(),s.is(":checked")&&a.val()==""){b();k();return}n.Utility.Util.getValueOfInt(p.value)>0||(n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),""),b())});oe.on("change",function(){tf("Date",oe.is(":checked"));eu=oe.is(":checked")});se.on("change",function(){tf("Date",se.is(":checked"));fr=se.is(":checked")});es.on("click",function(t){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?i&&sh(t):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")});rs.on("click",function(t){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?r&&hh(t):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")});us.on("click",function(t){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?f&&ch(t):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")});fs.on("click",function(t){if(s.is(":checked")&&a.val()==""){n.ADialog.warn("VIS_SlctcnvrsnDate");b();k();return}n.Utility.Util.getValueOfInt(p.value)>0?o()&&(h()?u&&lh(t):n.ADialog.info("",!0,n.Msg.getMsg("VIS_Search_Btn"),"")):n.ADialog.info("",!0,n.Msg.getMsg("SelectBusinessPartnerFirst"),"")});w.on("change",function(n){w.val()==0?w.addClass("vis-ev-col-mandatory"):w.removeClass("vis-ev-col-mandatory");vs(n);w.val()=="P"?(l.find("option[value=C]").hide(),l.find("option[value=P]").show(),l.find("option[value=G]").show()):w.val()=="C"?(l.find("option[value=P]").hide(),l.find("option[value=C]").show(),l.find("option[value=G]").show()):w.val()=="G"?(l.find("option[value=P]").show(),l.find("option[value=C]").show(),l.find("option[value=G]").hide()):(l.find("option[value=C]").show(),l.find("option[value=P]").show(),l.find("option[value=G]").show());l.val(0);l.addClass("vis-ev-col-mandatory");as(w.val());df(w.val(),l.val());k()});l.on("change",function(n){if(l.val()!=0&&w.val()!=0){l.removeClass("vis-ev-col-mandatory");vs(n);var t=w.val(),i=l.val();as(l.val());df(t,i)}else b(),l.addClass("vis-ev-col-mandatory");k()})}function k(){ni.val(0);ti.val(0);ii.val(0);kt.val(0);bt.val(0);li.setValue(null);ai.setValue(null);vi.val("");ei.val("");nr.val("");yi.val("");tr.val("");pi.val("");ir.val("");wi.val("");pu.val("");wu.val("");lf.val("");bu.val("");vt=[];ft=[];ct=[];ut=[];ui.val(Globalize.format(new Date,"yyyy-MM-dd"));po()}function sh(n){for(var f,u=t("#grid_"+i.name+'_records td[col="0"]').find('input[type="checkbox"]'),r=0;r<u.length;r++)t(u[r]).prop("checked",!1),i.editChange.call(i,u[r],r,0,n),f={type:"click",phase:"before",target:"grid",recid:r,index:r,isStopped:!1,"isCan//celled":!1,onComplete:null},i.trigger(f);ft=[];bi.prop("checked",!1);bt.val(0);ti.val(0);li.setValue(null);wu.val("");vi.val("");ei.val("");hi()}function hh(n){for(var f,u=t("#grid_"+r.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<u.length;i++)t(u[i]).prop("checked",!1),r.editChange.call(r,u[i],i,0,n),f={type:"click",phase:"before",target:"grid",recid:i,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null},r.trigger(f);ut=[];oi.prop("checked",!1);lf.val("");ir.val("");wi.val("");yu()}function ch(n){for(var u,r=t("#grid_"+f.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<r.length;i++)t(r[i]).prop("checked",!1),f.editChange.call(f,r[i],i,0,n),u={type:"click",phase:"before",target:"grid",recid:i,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null},f.trigger(u);vt=[];cr.prop("checked",!1);bu.val("");ni.val(0);tr.val("");pi.val("");uu()}function lh(n){for(var f,r=t("#grid_"+u.name+'_records td[col="0"]').find('input[type="checkbox"]'),i=0;i<r.length;i++)t(r[i]).prop("checked",!1),u.editChange.call(u,r[i],i,0,n),f={type:"click",phase:"before",target:"grid",recid:i,index:i,isStopped:!1,"isCan//celled":!1,onComplete:null},u.trigger(f);ct=[];hr.prop("checked",!1);ii.val(0);kt.val(0);ai.setValue(null);pu.val("");nr.val("");yi.val("");di()}function as(n){n=="P"?u&&u.refresh():n=="C"?f&&f.refresh():n=="I"?i&&i.refresh():n=="G"&&r&&r.refresh()}function df(n,t){rt.css("display","none");ot.css("display","none");lt.css("display","none");yt.css("display","none");ki=!0;hu=!0;rr=!0;n=="P"?(hu=!1,rt.css("display","block"),u&&u.clear()):n=="C"?(ki=!1,ot.css("display","block"),f&&f.clear()):n=="I"?(lt.css("display","block"),i&&i.clear()):n=="G"&&(yt.css("display","block"),rr=!1,r&&r.clear());t=="P"?(hu=!1,rt.css("display","block"),u&&u.clear()):t=="C"?(ki=!1,ot.css("display","block"),f&&f.clear()):t=="I"?(lt.css("display","block"),i&&i.clear()):t=="G"&&(yt.css("display","block"),rr=!1,r&&r.clear())}function vs(n){var u,r,f;if(i!=null){for(u=t("#grid_"+i.name+'_records td[col="0"]').find('input[type="checkbox"]'),r=0;r<u.length;r++)t(u[r]).prop("checked",!1),i.editChange.call(i,u[r],r,0,n),f={type:"click",phase:"before",target:"grid",recid:r,index:r,isStopped:!1,"isCan//celled":!1,onComplete:null},i.trigger(f);ft=[]}}function ah(){var i=null,t=n.MLookupFactory.get(gi,pr.windowNo,0,n.DisplayType.TableDir,"C_Currency_ID",0,!1,"IsMyCurrency='Y'"),u,r;if(i=t.getData(!0,!0,!1,!1),u=0,i!=null&&i!=undefined&&i.length>0){for(r=0;r<i.length;r++)st.append("<option value="+i[r].Key+">"+i[r].Name+"<\/option>"),i[r].Key==g&&(st.val(g),u=1);u==0&&(st.val(0),st.addClass("vis-ev-col-mandatory"))}t=n.MLookupFactory.getMLookUp(gi,pr.windowNo,3499,n.DisplayType.Search);p=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,t);t=n.MLookupFactory.get(gi,pr.windowNo,10294,n.DisplayType.TableDir,"C_ConversionType_ID",0,!1,"C_ConversionType.IsActive = 'Y' AND C_ConversionType.AD_Org_ID IN (0, @OrgID@)");pt=new n.Controls.VComboBox("C_ConversionType_ID",!1,!1,!0,t,50);t=n.MLookupFactory.get(gi,pr.windowNo,0,n.DisplayType.TableDir,"VA009_PaymentMethod_ID",0,!1,"VA009_PAYMENTMETHOD.VA009_PAYMENTMETHOD_ID IN (SELECT VA009_PAYMENTMETHOD_ID FROM VA009_PAYMENTMETHOD WHERE VA009_PAYMENTBASETYPE NOT IN ('B','C','P') )");ai=new n.Controls.VComboBox("VA009_PaymentMethod_ID",!1,!1,!0,t,50);t=n.MLookupFactory.get(gi,pr.windowNo,0,n.DisplayType.TableDir,"VA009_PaymentMethod_ID",0,!1,"VA009_PAYMENTMETHOD.IsActive='Y' AND VA009_PAYMENTMETHOD.AD_Client_ID = @AD_Client_ID@");li=new n.Controls.VComboBox("VA009_PaymentMethod_ID",!1,!1,!0,t,50)}function vh(){t.ajax({type:"POST",url:n.Application.contextUrl+"PaymentAllocation/GetPaymentType",dataType:"json",success:function(t){var r=JSON.parse(t),i;if(r)for(ni.empty(),ni.append("<option value='0'><\/option>"),i=0;i<r.length;i++)paymentType=n.Utility.Util.getValueOfString(r[i].Name),paymentType_ID=n.Utility.Util.getValueOfString(r[i].Value),ni.append(" <option value="+paymentType_ID+">"+paymentType+"<\/option>");else ni.append("<option value= '0'><\/option>");ni.prop("selectedIndex",0)},error:function(n){console.log(n)}})}function yh(){t.ajax({type:"POST",url:n.Application.contextUrl+"PaymentAllocation/GetDocbaseType",dataType:"json",success:function(t){var r=JSON.parse(t),i;if(r)for(ti.empty(),ti.append("<option value='0'><\/option>"),i=0;i<r.length;i++)docBaseType=n.Utility.Util.getValueOfString(r[i].DocbaseType),docBaseName=n.Utility.Util.getValueOfString(r[i].Name),ti.append(" <option value="+docBaseType+">"+docBaseName+"<\/option>");else ti.append("<option value= '0'><\/option>");ti.prop("selectedIndex",0)},error:function(n){console.log(n)}})}function ph(){t.ajax({type:"POST",url:n.Application.contextUrl+"PaymentAllocation/GetpayDocbaseType",dataType:"json",success:function(t){var r=JSON.parse(t),i;if(r)for(ii.empty(),ii.append("<option value='0'><\/option>"),i=0;i<r.length;i++)docbaseType=n.Utility.Util.getValueOfString(r[i].DocbaseType),docBaseName=n.Utility.Util.getValueOfString(r[i].Name),ii.append(" <option value="+docbaseType+">"+docBaseName+"<\/option>");else ii.append("<option value='0'><\/option>");ii.prop("selectedIndex",0)},error:function(n){console.log(n)}})}function wh(){t.ajax({type:"POST",url:n.Application.contextUrl+"PaymentAllocation/GetpayDocType",dataType:"json",success:function(t){var r=JSON.parse(t),i;if(r)for(kt.empty(),kt.append("<option value='0'><\/option>"),i=0;i<r.length;i++)ie=n.Utility.Util.getValueOfString(r[i].DocType),re=n.Utility.Util.getValueOfInt(r[i].C_DocType_ID),kt.append(" <option value="+re+">"+ie+"<\/option>");else kt.append("<option value= 0><\/option>");kt.prop("selectedIndex",0)},error:function(n){console.log(n)}})}function bh(){t.ajax({type:"POST",url:n.Application.contextUrl+"PaymentAllocation/GetDocType",dataType:"json",success:function(t){var r=JSON.parse(t),i;if(r)for(bt.empty(),bt.append("<option value= 0 ><\/option>"),i=0;i<r.length;i++)ie=n.Utility.Util.getValueOfString(r[i].DocType),re=n.Utility.Util.getValueOfInt(r[i].C_DocType_ID),bt.append(" <option value="+re+">"+ie+"<\/option>");else bt.append("<option value= 0 ><\/option>");bt.prop("selectedIndex",0)},error:function(n){console.log(n)}})}function hi(){if(at>0){if(AD_Org_ID=gt.val(),g=st.val(),g==0)return n.ADialog.info("Message",!0,"select currency","");if(y=vi.val(),c=ei.val(),c!=""&&y>c)return ei.val(""),n.ADialog.info("Message",!0,n.Msg.getMsg("VIS_FromDateGreater"),"");v[0].style.visibility="visible";wr=1;cu=1;pf=0;tu=!1;et=0;var i=s.is(":checked"),r=null;tt=ht.val();r=tt!=null&&tt!=undefined&&tt!=""?n.DB.to_date(tt):n.DB.to_date(new Date);te=ne.val();or=bt.val();docBaseType=ti.val();sr=n.Utility.Util.getValueOfInt(li.getValue());srchText=wu.val();y!=null&&y!=undefined&&y!=""&&n.DB.to_date(y);c!=null&&c!=undefined&&c!=""&&n.DB.to_date(c);t.ajax({url:n.Application.contextUrl+"PaymentAllocation/GetInvoice",data:{AD_Org_ID:AD_Org_ID,_C_Currency_ID:g,_C_BPartner_ID:at,isInterBPartner:eu,chk:i,date:r,page:wr,size:fi,docNo:te,c_docType_ID:or,docBaseType:docBaseType,PaymentMethod_ID:sr,fromDate:y,toDate:c,conversionDate:uo,srchText:srchText,isInterComp:fr,conversionType_ID:pt.getValue()},async:!0,success:function(n){var t=JSON.parse(n),r,u;if(t){if(wr==1&&t.length>0&&(pf=t[0].InvoiceRecord,cu=Math.ceil(pf/fi)),ft.length>0){for(vr=ft.length,r=0;r<t.length;r++)u=ft.filter(function(n){return n.C_InvoicePaySchedule_ID==t[r].C_InvoicePaySchedule_ID}),u.length==0&&(t[r].recid=ft.length+r,ft.push(t[r]));t=ft;ft=[]}bs(t,i);le=9;ou=10;ae=13;hf=14;ef.find("#grid_openformatgridinvoice_"+e.windowNo+"_records").on("scroll",vo);tu=!0;we()}},error:function(){v[0].style.visibility="hidden"}})}}function kh(){w.empty();l.empty();w.append("<option value=0><\/option>");l.append("<option value=0><\/option>");w.append('<option value="C">'+n.translatedTexts.C_Cash_ID+"<\/option>");l.append('<option value="C">'+n.translatedTexts.C_Cash_ID+"<\/option>");w.append('<option value="I">'+n.translatedTexts.C_Invoice_ID+"<\/option>");l.append('<option value="I">'+n.translatedTexts.C_Invoice_ID+"<\/option>");w.append('<option value="G">'+n.translatedTexts.GL_Journal_ID+"<\/option>");l.append('<option value="G">'+n.translatedTexts.GL_Journal_ID+"<\/option>");w.append('<option value="P">'+n.translatedTexts.C_Payment_ID+"<\/option>");l.append('<option value="P">'+n.translatedTexts.C_Payment_ID+"<\/option>")}function dh(){var h=t('<div class="vis-allocation-leftControls">'),y,o,f;h.append('<div class="input-group vis-input-wrap"><div class="vis-control-wrap"><select class="vis-allocation-currencycmb" id=VIS_Org_'+e.windowNo+'><\/select><label title="View organization" >'+n.translatedTexts.AD_Org_ID+"<\/label>");var c=t('<div class="vis-allocation-leftControls">'),i=t('<div class="input-group vis-input-wrap">'),r=t('<div class="vis-control-wrap">'),v=t('<div class="input-group-append">');c.append(i);i.append(r);i.append(v);r.append(p.getControl().addClass("vis-allocation-bpartner").attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")).append("<label>"+n.translatedTexts.C_BPartner_ID+"<\/label>");v.append(p.getBtn(0));var u=t('<div class="vis-allocation-leftControls">'),i=t('<div class="input-group vis-input-wrap">'),r=t('<div class="vis-control-wrap">');u.append(i);i.append(r);r.append(st).append("<label>"+n.translatedTexts.C_Currency_ID+"<\/label>");it.append(h).append(c).append(u);y=t('<div class="vis-allocation-leftControls"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><label class="vis-ec-col-lblchkbox"><input name="vchkMultiCurrency" class="vis-allocation-multicheckbox" type="checkbox">'+n.Msg.getMsg("MultiCurrency")+'<\/label><\/div><\/div><\/div><div class="vis-allocation-leftControls" id = VIS_cnvrDateDiv_'+e.windowNo+' ><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input  class="vis-allocation-date" style="display:block;" id=VIS_cmbConversionDate_'+e.windowNo+' type="date" max="9999-12-31"><label title="View allocation will be created on this date" type="date" >'+n.Msg.getMsg("ConversionDate")+"<\/label><\/div><\/div><\/div>");it.append(y);u=t('<div class="vis-allocation-leftControls vis-conversionType" style="display:none">');i=t('<div class="input-group vis-input-wrap">');r=t('<div class="vis-control-wrap">');u.append(i);i.append(r);r.append(pt.getControl()).append("<label>"+n.translatedTexts.C_ConversionType_ID+"<\/label>");it.append(u);var b=t('<div class="vis-allocation-leftControls">'),i=t('<div class="input-group vis-input-wrap">'),r=t('<div class="vis-control-wrap">');b.append(i);i.append(r);r.append(w).append("<label> "+n.Msg.getMsg("AllocationFrom")+"<\/label>");var k=t('<div class="vis-allocation-leftControls">'),i=t('<div class="input-group vis-input-wrap">'),r=t('<div class="vis-control-wrap">');k.append(i);i.append(r);r.append(l).append("<label> "+n.Msg.getMsg("AllocationTo")+"<\/label>");it.append(b).append(k);o=t('<div class="vis-allocation-leftControls" id="cashMaindiv"  style="display: none !important;"><input  class="vis-allocation-cashbox"  type="checkbox"><label>'+n.Msg.getMsg("Cash")+'<\/label><\/div><div class="vis-allocation-leftControls" id="glMaindiv" style="display: none !important;"><input  class="vis-allocation-glvoucher"  type="checkbox"><label>'+n.Msg.getMsg("GL Voucher")+'<\/label><\/div><div class="vis-allocation-leftControls"> <div class= "input-group vis-input-wrap" > <div class="vis-control-wrap"> <label class="vis-ec-col-lblchkbox"><input id=VIS_chkbxICompanyAllocation_'+e.windowNo+' class="vis-allocation-interComp" type="checkbox">'+n.Msg.getMsg("InterCompanyAllocation")+'<\/label><\/div> <\/div> <\/div><div class="vis-allocation-leftControls"> <div class= "input-group vis-input-wrap" > <div class="vis-control-wrap"><label class="vis-ec-col-lblchkbox"><input id=VIS_chkbxBPAllocation_'+e.windowNo+' class="vis-allocation-interBP" type="checkbox">'+n.Msg.getMsg("BPAllocation")+"<\/label><\/div><\/div> <\/div>");it.append(o);o.find(".panel-body").append('<div class="vis-allocation-leftControls"><div class="vis-allocation-leftControls"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input  class="vis-allocation-toDate"  type="date"><label>'+n.Msg.getMsg("VIS_ToDate")+"<\/label><\/div><\/div><\/div>");s=it.find(".vis-allocation-multicheckbox");ee=it.find(".vis-allocation-cashbox");sf=it.find(".vis-allocation-glvoucher");ue=it.find(".vis-allocation-glinvoice");ne=it.find(".vis-allocation-docNo");f=t('<div class="vis-allocation-resultdiv">');f.append('<div class="vis-allocation-leftControls"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select class="vis-allocation-currencycmb" id=VIS_cmbOrg_'+e.windowNo+"><\/select><label title="+n.Msg.getMsg("VIS_AllocOrgTitle")+">"+n.Msg.getMsg("VIS_AllocOrg")+"<\/label>");f.append('<div class="vis-allocation-leftControls"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input  class="vis-allocation-date" disabled  id=VIS_cmbDate_'+e.windowNo+' type="date"><label title="View allocation will be created on this date" type="date" >'+n.Msg.getMsg("TransactionDate")+"<\/label><\/div><\/div><\/div>");f.append('<div class="vis-allocation-leftControls"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input  class="vis-allocation-date" disabled id=VIS_cmbAcctDate_'+e.windowNo+' type="date"><label title="View allocation will be created on this date" type="date" >'+n.Msg.getMsg("DateAcct")+"<\/label><\/div><\/div><\/div>");it.append(f);ht=it.find("#VIS_cmbDate_"+e.windowNo);ht.val(Globalize.format(new Date,"yyyy-MM-dd"));ui=it.find("#VIS_cmbAcctDate_"+e.windowNo);ui.val(Globalize.format(new Date,"yyyy-MM-dd"));a=it.find("#VIS_cmbConversionDate_"+e.windowNo);he=it.find("#VIS_cnvrDateDiv_"+e.windowNo);he.css("display","none");d=it.find("#VIS_cmbOrg_"+e.windowNo);gt=it.find("#VIS_Org_"+e.windowNo);oe=it.find("#VIS_chkbxBPAllocation_"+e.windowNo);se=it.find("#VIS_chkbxICompanyAllocation_"+e.windowNo)}function gh(){rt.append('<div class="d-flex doc-allocation"><div class="vis-doc-AllocOuter-wrap"><div><p>'+n.translatedTexts.C_Payment_ID+'<\/p>  <input type="checkbox" id="paymentselectall" /><p style="margin: 0 4px;"><\/p> <span id="pclrbutton_'+e.windowNo+'" style="cursor: pointer;margin: 2px 0 0;" class="glyphicon glyphicon-refresh" title='+n.Msg.getMsg("Reset")+'><\/span><\/div><p class="vis-allocate-paymentSum"> 0 '+n.Msg.getMsg("SelectedLines")+" - "+ri+' 0.00<\/p><\/div> <div class="vis-allocation-topFields-wrap"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input placeholder="'+n.Msg.getMsg("SearchResults")+'" data-hasbtn=" " type="text" id="paySrch'+e.windowNo+'" /><label>'+n.Msg.getMsg("SearchResults")+'<\/label><\/div><div class="input-group-append"><a class="input-group-text" id="_SrchpBtn_'+e.windowNo+'"><span class="glyphicon glyphicon-search"><\/span><\/a><\/div><\/div><div class="input-group vis-input-wrap" id="docType_'+e.windowNo+'"><\/div><div class="payBaseType input-group vis-input-wrap" id="docbaseType_'+e.windowNo+'"><\/div><div class="payMethod input-group vis-input-wrap" id="payPayMethod_'+e.windowNo+'"><\/div><div class="vis-fdate-allocation input-group vis-input-wrap"><\/div><div class="vis-tdate-allocation input-group vis-input-wrap"><\/div><\/div><\/div> ').append(' <div class= "vis-allocation-payment-grid" ><\/div> ');uf=rt.find(".vis-allocation-payment-grid");eo=rt.find(".vis-allocate-paymentSum");hr=rt.find("#paymentselectall");pu=rt.find("#paySrch"+e.windowNo+"");go=rt.find("#_SrchpBtn_"+e.windowNo+"");rt.find("#docType_"+e.windowNo+"").append(t('<div class="vis-control-wrap">').append(kt).append("<label>"+n.translatedTexts.DocType+"<\/label>"));rt.find("#docbaseType_"+e.windowNo+"").append(t('<div class="vis-control-wrap">').append(ii).append("<label>"+n.translatedTexts.DocBaseType+"<\/label>"));rt.find("#payPayMethod_"+e.windowNo+"").append(t('<div class="vis-control-wrap">').append(ai.getControl()).append("<label>"+n.translatedTexts.PaymentMethod+"<\/label>"));rt.find(".vis-fdate-allocation").append(t('<div class="vis-control-wrap">').append(nr).append("<label>"+n.translatedTexts.FromDate+"<\/label>"));rt.find(".vis-tdate-allocation").append(t('<div class="vis-control-wrap">').append(yi).append("<label>"+n.Msg.getMsg("ToDate")+"<\/label>"));fs=rt.find("#pclrbutton_"+e.windowNo)}function nc(){ot.append('<div class="d-flex cash-allocation"><div class="vis-doc-AllocOuter-wrap"><div><p>'+n.translatedTexts.C_CashLine_ID+'<\/p> <input type="checkbox" id="cashselectall" /><p style="margin: 0 4px;"><\/p> <span id="cclrbutton_'+e.windowNo+'" style="cursor: pointer;margin: 2px 0 0;" class="glyphicon glyphicon-refresh"  title='+n.Msg.getMsg("Reset")+'><\/span><\/div><p class="vis-allocate-cashSum"> 0 '+n.Msg.getMsg("SelectedLines")+" - "+ri+' 0.00<\/p><\/div><div class="vis-allocation-topFields-wrap"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input placeholder="'+n.Msg.getMsg("SearchResults")+'" data-hasbtn=" " type="text" id="cashSrch'+e.windowNo+'" /><label>'+n.Msg.getMsg("SearchResults")+'<\/label><\/div><div class="input-group-append"><a class="input-group-text" id="_SrchcBtn_'+e.windowNo+'"><span class="glyphicon glyphicon-search"><\/span><\/a><\/div><\/div><div class="input-group vis-input-wrap payType" id="_paymentType'+e.windowNo+'"><\/div><div class="input-group vis-input-wrap vis-fdate-allocation"><\/div><div class="input-group vis-input-wrap vis-tdate-allocation"><\/div><\/div><\/div>').append('<div  class="vis-allocation-cashLine-grid"><\/div>');ff=ot.find(".vis-allocation-cashLine-grid");oo=ot.find(".vis-allocate-cashSum");cr=ot.find("#cashselectall");bu=ot.find("#cashSrch"+e.windowNo+"");ts=ot.find("#_SrchcBtn_"+e.windowNo+"");ot.find("#_paymentType"+e.windowNo+"").append(t('<div class="vis-control-wrap">').append(ni).append("<label>"+n.translatedTexts.Payment_Type+"<\/label>"));ot.find(".vis-fdate-allocation").append(t('<div class="vis-control-wrap">').append(tr).append("<label>"+n.translatedTexts.FromDate+"<\/label>"));ot.find(".vis-tdate-allocation").append(t('<div class="vis-control-wrap">').append(pi).append("<label>"+n.Msg.getMsg("ToDate")+"<\/label>"));us=ot.find("#cclrbutton_"+e.windowNo)}function tc(){lt.append('<div class="d-flex in-allocation"><div class="vis-doc-AllocOuter-wrap"><div><span>'+n.translatedTexts.C_Invoice_ID+'<\/span> <input type="checkbox" id="invoiceselectall" /><span style="margin: 0 4px;"><\/span> <span id="clrbutton_'+e.windowNo+'" style="cursor: pointer;margin: 2px 0 0;" class="glyphicon glyphicon-refresh"  title='+n.Msg.getMsg("Reset")+'><\/span><\/div><p class="vis-allocate-invoiceSum"> 0'+n.Msg.getMsg("SelectedLines")+" - "+ri+' 0.00<\/p><\/div><div class="vis-allocation-topFields-wrap"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input placeholder="'+n.Msg.getMsg("SearchResults")+'" data-hasbtn=" " type="text" id="invSrch'+e.windowNo+'" /><label>'+n.Msg.getMsg("SearchResults")+'<\/label><\/div><div class="input-group-append"><a class="input-group-text" id="_SrchBtn_'+e.windowNo+'"><span class="glyphicon glyphicon-search"><\/span><\/a><\/div><\/div><div class="input-group vis-input-wrap" id="docType'+e.windowNo+'"><\/div><div class="invBaseType input-group vis-input-wrap" id="invbaseType_'+e.windowNo+'"><\/div><div class="payMethod input-group vis-input-wrap" id="invPayMethod_'+e.windowNo+'"><\/div><div class="vis-fdate-allocation input-group vis-input-wrap"><\/div><div class="vis-tdate-allocation input-group vis-input-wrap"><\/div><\/div><\/div>').append('<div  class="vis-allocation-invoice-grid"><\/div>');ef=lt.find(".vis-allocation-invoice-grid");so=lt.find(".vis-allocate-invoiceSum");bi=lt.find("#invoiceselectall");wu=lt.find("#invSrch"+e.windowNo+"");ns=lt.find("#_SrchBtn_"+e.windowNo+"");lt.find("#docType"+e.windowNo+"").append(t('<div class="vis-control-wrap">').append(bt).append("<label>"+n.translatedTexts.DocType+"<\/label>"));lt.find("#invbaseType_"+e.windowNo+"").append(t('<div class="vis-control-wrap">').append(ti).append("<label>"+n.translatedTexts.DocBaseType+"<\/label>"));lt.find("#invPayMethod_"+e.windowNo+"").append(t('<div class="vis-control-wrap">').append(li.getControl()).append("<label>"+n.translatedTexts.PaymentMethod+"<\/label>"));lt.find(".vis-fdate-allocation").append(t('<div class="vis-control-wrap">').append(vi).append("<label>"+n.translatedTexts.FromDate+"<\/label>"));lt.find(".vis-tdate-allocation").append(t('<div class="vis-control-wrap">').append(ei).append("<label>"+n.Msg.getMsg("ToDate")+"<\/label>"));es=lt.find("#clrbutton_"+e.windowNo)}function ic(){yt.append('<div class="d-flex  gl-allocation"><div class="vis-doc-AllocOuter-wrap"><div><span>'+n.translatedTexts.GL_Journal_ID+'<\/span> <input type="checkbox" id="glselectall" /><span style="margin: 0 4px;"><\/span> <span id="gclrbutton_'+e.windowNo+'" style="cursor: pointer;margin: 2px 0 0;" class="glyphicon glyphicon-refresh"  title='+n.Msg.getMsg("Reset")+'><\/span><\/div><p class="vis-allocate-glSum"> 0'+n.Msg.getMsg("SelectedLines")+" - "+ri+' 0.00<\/p><\/div><div class="vis-allocation-topFields-wrap"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input placeholder="'+n.Msg.getMsg("SearchResults")+'" data-hasbtn=" " type="text" id="glSrch'+e.windowNo+'" /><label>'+n.Msg.getMsg("SearchResults")+'<\/label><\/div><div class="input-group-append"><a class="input-group-text" id="_SrchglBtn_'+e.windowNo+'"><span class="glyphicon glyphicon-search"><\/span><\/a><\/div><\/div><div class="input-group vis-input-wrap vis-fdate-allocation"><\/div><div class="input-group vis-input-wrap vis-tdate-allocation"><\/div><\/div><\/div>').append('<div  class="vis-allocation-gl-grid"><\/div>');of=yt.find(".vis-allocation-gl-grid");fe=yt.find(".vis-allocate-glSum");oi=yt.find("#glselectall");lf=yt.find("#glSrch"+e.windowNo+"");is=yt.find("#_SrchglBtn_"+e.windowNo+"");yt.find(".vis-fdate-allocation").append(t('<div class="vis-control-wrap">').append(ir).append("<label>"+n.translatedTexts.FromDate+"<\/label>"));yt.find(".vis-tdate-allocation").append(t('<div class="vis-control-wrap">').append(wi).append("<label>"+n.Msg.getMsg("ToDate")+"<\/label>"));rs=yt.find("#gclrbutton_"+e.windowNo)}function rc(){t.ajax({type:"POST",url:n.Application.contextUrl+"VIS/PaymentAllocation/GetOrg",dataType:"json",success:function(t){var r=JSON.parse(t),i;if(r)for(gt.empty(),n.Env.getCtx().getAD_Org_ID()!=0&&gt.append("<option value="+n.Env.getCtx().getAD_Org_ID()+">"+n.Env.getCtx().ctx["#AD_Org_Name"]+"<\/option>"),i=0;i<r.length;i++)r[i].Value!=n.Env.getCtx().getAD_Org_ID()&&(OrgName=n.Utility.Util.getValueOfString(r[i].Name),AD_Org_ID=n.Utility.Util.getValueOfInt(r[i].Value),gt.append(" <option value="+AD_Org_ID+">"+OrgName+"<\/option>"));else gt.append("<option value=0><\/option>");n.context.getContextAsInt("#AD_Org_ID")>0?(gt.val(n.context.getContextAsInt("#AD_Org_ID")),gt.removeClass("vis-ev-col-mandatory")):gt.prop("selectedIndex",0)},error:function(n){console.log(n)}})}function uc(){t.ajax({type:"POST",url:n.Application.contextUrl+"VIS/PaymentAllocation/GetOrganization",dataType:"json",success:function(t){var r=JSON.parse(t),i;if(r)for(d.empty(),d.addClass("vis-ev-col-mandatory"),d.append("<option value=0><\/option>"),i=0;i<r.length;i++)OrgName=n.Utility.Util.getValueOfString(r[i].Name),AD_Org_ID=n.Utility.Util.getValueOfInt(r[i].Value),d.append(" <option value="+AD_Org_ID+">"+OrgName+"<\/option>");else d.append("<option value=0><\/option>");n.context.getContextAsInt("#AD_Org_ID")>0?(d.val(n.context.getContextAsInt("#AD_Org_ID")),d.removeClass("vis-ev-col-mandatory")):d.prop("selectedIndex",0)},error:function(n){console.log(n)}})}function fc(){v=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');v[0].style.visibility="hidden";fu.append(v)}function du(){var t;if(at!=0&&g!=0){p.getControl().removeClass("vis-ev-col-mandatory");v[0].style.visibility="visible";wr=1;cu=1;pf=0;br=1;lu=1;wf=0;kr=1;au=1;bf=0;dr=1;vu=1;kf=0;yr==!0?(gr==!0,nu==!0,tu==!0,iu==!0,yr=!1):(gr=!1,nu=!1,tu=!1,iu=!1);et=0;t=null;tt=ht.val();t=tt!=null&&tt!=undefined&&tt!=""?n.DB.to_date(tt):n.DB.to_date(new Date);var i=s.is(":checked"),r=gi.getAD_Role_ID(),u=gi.getAD_User_ID(),f=n.MRole.getDefault(),e=at;di();uu();hi();po();w.val("P");w.trigger("change");l.val("P");l.trigger("change");w.val()==0&&w.val()==0?b():df(w.val(),l.val())}}function di(){if(AD_Org_ID=gt.val(),g=st.val(),at!=0&&g!=0){if(y=nr.val(),c=yi.val(),c!=""&&y>c)return yi.val(""),n.ADialog.info("Message",!0,n.Msg.getMsg("VIS_FromDateGreater"),"");kr=1;au=1;bf=0;gr=!1;var i=s.is(":checked");or=kt.val();docBaseType=ii.val();sr=n.Utility.Util.getValueOfInt(ai.getValue());srchText=pu.val();v[0].style.visibility="visible";y!=null&&y!=undefined&&y!=""&&n.DB.to_date(y);c!=null&&c!=undefined&&c!=""&&n.DB.to_date(c);t.ajax({url:n.Application.contextUrl+"PaymentAllocation/GetPayments",data:{AD_Org_ID:AD_Org_ID,_C_Currency_ID:g,_C_BPartner_ID:at,isInterBPartner:eu,chk:i,page:kr,size:fi,c_docType_ID:or,docBaseType:docBaseType,PaymentMethod_ID:sr,fromDate:y,toDate:c,srchText:srchText,isInterComp:fr},async:!0,success:function(n){var t=JSON.parse(n),r,u;if(t){if(kr==1&&t.length>0&&(bf=t[0].PaymentRecord,au=Math.ceil(bf/fi)),ct.length>0){for(ar=ct.length,r=0;r<t.length;r++)u=ct.filter(function(n){return n.CpaymentID==t[r].CpaymentID}),u.length==0&&(t[r].recid=ct.length+r,ct.push(t[r]));t=ct;ct=[]}ps(t,i);uf.find("#grid_openformatgrid_"+e.windowNo+"_records").on("scroll",lo);gr=!0;we()}},error:function(){v[0].style.visibility="hidden"}})}}function uu(){if(g=st.val(),at!=0&&g!=0){if(br=1,lu=1,wf=0,nu=!1,AD_Org_ID=gt.val(),y=tr.val(),c=pi.val(),paymentType=ni.val(),srchText=bu.val(),c!=""&&y>c)return pi.val(""),n.ADialog.info("Message",!0,n.Msg.getMsg("VIS_FromDateGreater"),"");var i=s.is(":checked");y!=null&&y!=undefined&&y!=""&&n.DB.to_date(y);c!=null&&c!=undefined&&c!=""&&n.DB.to_date(c);v[0].style.visibility="visible";t.ajax({url:n.Application.contextUrl+"PaymentAllocation/GetCashJounral",data:{AD_Org_ID:AD_Org_ID,_C_Currency_ID:g,_C_BPartner_ID:at,isInterBPartner:eu,chk:i,page:br,size:fi,fromDate:y,toDate:c,paymentType_ID:paymentType,srchText:srchText,isInterComp:fr},async:!0,success:function(n){var t=JSON.parse(n),r,u;if(t){if(br==1&&t.length>0&&(wf=t[0].CashRecord,lu=Math.ceil(wf/fi)),vt.length>0){for(af=vt.length,r=0;r<t.length;r++)u=vt.filter(function(n){return n.CcashlineiID==t[r].CcashlineiID}),u.length==0&&(t[r].recid=vt.length+r,vt.push(t[r]));t=vt;vt=[]}ws(t,i);ff.find("#grid_openformatgridcash_"+e.windowNo+"_records").on("scroll",ao);nu=!0;we()}},error:function(){v[0].style.visibility="hidden"}})}}function ec(){t.ajax({url:n.Application.contextUrl+"PaymentAllocation/GetCurrencyPrecision",data:{_C_Currency_ID:g},async:!0,success:function(n){var t=JSON.parse(n);t&&(o=t)},error:function(){}})}function we(){v[0].style.visibility=gr==!0&&nu==!0&&tu==!0&&iu==!0?"hidden":"visible"}function co(){t(this).scrollTop()>0&&(v[0].style.visibility="visible",t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&dr<vu&&(dr++,oc(dr,fi)),v[0].style.visibility="hidden")}function oc(i,r){var f=s.is(":checked"),u;if(g=st.val(),g==0)return n.ADialog.info("Message",!0,"select currency","");u=null;tt=ht.val();u=tt!=null&&tt!=undefined&&tt!=""?n.DB.to_date(tt):n.DB.to_date(new Date);y!=null&&y!=undefined&&y!=""&&n.DB.to_date(y);c!=null&&c!=undefined&&c!=""&&n.DB.to_date(c);t.ajax({url:n.Application.contextUrl+"VIS/PaymentAllocation/GetGLData",dataType:"json",data:{AD_Org_ID:AD_Org_ID,_C_Currency_ID:g,_C_BPartner_ID:at,page:i,size:r,fromDate:y,toDate:c,srchText:srchText,chk:f,isInterComp:fr},async:!0,success:function(n){var t=JSON.parse(n),i,r;if(t){if(ut.length>0){for(lr=ut.length,i=0;i<t.length;i++)r=ut.filter(function(n){return n.GL_JOURNALLINE_ID==t[i].GL_JOURNALLINE_ID}),r.length==0&&(t[i].recid=ut.length+i,ut.push(t[i]));t=ut;ut=[]}lc(t)}},error:function(){}})}function lo(){t(this).scrollTop()>0&&(v[0].style.visibility="visible",t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&kr<au&&(kr++,sc(kr,fi)),v[0].style.visibility="hidden")}function sc(i,r){if(g=st.val(),g==0)return n.ADialog.info("Message",!0,"select currency","");var f=s.is(":checked"),e=null;tt=ht.val();e=tt!=null&&tt!=undefined&&tt!=""?n.DB.to_date(tt):n.DB.to_date(new Date);or=kt.val();docBaseType=ii.val();sr=n.Utility.Util.getValueOfInt(ai.getValue());srchText=pu.val();y!=null&&y!=undefined&&y!=""&&n.DB.to_date(y);c!=null&&c!=undefined&&c!=""&&n.DB.to_date(c);t.ajax({url:n.Application.contextUrl+"PaymentAllocation/GetPayments",data:{AD_Org_ID:AD_Org_ID,_C_Currency_ID:g,_C_BPartner_ID:at,isInterBPartner:eu,chk:f,page:i,size:r,c_docType_ID:or,docBaseType:docBaseType,PaymentMethod_ID:sr,fromDate:y,toDate:c,srchText:srchText,isInterComp:fr},async:!0,success:function(n){var t=JSON.parse(n),f,r,i,e;if(t){if(f=u.records.length,r=[],ct.length>0){for(ar=ct.length,i=0;i<t.length;i++)e=ct.filter(function(n){return n.CpaymentID==t[i].CpaymentID}),e.length==0&&(t[i].recid=f+i,r.push(t[i]));t=r;ct=[];r=[]}ac(t)}},error:function(){}})}function ao(){t(this).scrollTop()>0&&(v[0].style.visibility="visible",t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&br<lu&&(br++,hc(br,fi)),v[0].style.visibility="hidden")}function hc(i,r){if(g=st.val(),g==0)return n.ADialog.info("Message",!0,"select currency","");var u=s.is(":checked"),e=null;tt=ht.val();paymentType=ni.val();srchText=bu.val();e=tt!=null&&tt!=undefined&&tt!=""?n.DB.to_date(tt):n.DB.to_date(new Date);y!=null&&y!=undefined&&y!=""&&n.DB.to_date(y);c!=null&&c!=undefined&&c!=""&&n.DB.to_date(c);t.ajax({url:n.Application.contextUrl+"PaymentAllocation/GetCashJounral",data:{AD_Org_ID:AD_Org_ID,_C_Currency_ID:g,_C_BPartner_ID:at,isInterBPartner:eu,chk:u,page:i,size:r,fromDate:y,toDate:c,paymentType_ID:paymentType,srchText:srchText,isInterComp:fr},async:!0,success:function(n){var t=JSON.parse(n),u,r,i,e;if(t){if(u=f.records.length,r=[],vt.length>0){for(af=vt.length,i=0;i<t.length;i++)e=vt.filter(function(n){return n.CcashlineiID==t[i].CcashlineiID}),e.length==0&&(t[i].recid=u+i,r.push(t[i]));t=r;vt=[];r=[]}vc(t)}},error:function(){}})}function vo(){t(this).scrollTop()>0&&(v[0].style.visibility="visible",t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&wr<cu&&(wr++,cc(wr,fi)),v[0].style.visibility="hidden")}function cc(r,u){var e=s.is(":checked"),f=null;if(tt=ht.val(),f=tt!=null&&tt!=undefined&&tt!=""?n.DB.to_date(tt):n.DB.to_date(new Date),te=ne.val(),g=st.val(),g==0)return n.ADialog.info("Message",!0,"select currency","");or=bt.val();docBaseType=ti.val();sr=n.Utility.Util.getValueOfInt(li.getValue());srchText=wu.val();y!=null&&y!=undefined&&y!=""&&n.DB.to_date(y);c!=null&&c!=undefined&&c!=""&&n.DB.to_date(c);t.ajax({url:n.Application.contextUrl+"PaymentAllocation/GetInvoice",data:{AD_Org_ID:AD_Org_ID,_C_Currency_ID:g,_C_BPartner_ID:at,isInterBPartner:eu,chk:e,date:f,page:r,size:u,docNo:te,c_docType_ID:or,docBaseType:docBaseType,PaymentMethod_ID:sr,fromDate:y,toDate:c,conversionDate:uo,srchText:srchText,isInterComp:fr,conversionType_ID:pt.getValue()},async:!0,success:function(n){var t=JSON.parse(n),u,f,r,e;if(t){if(u=[],f=i.records.length,ft.length>0){for(vr=ft.length,r=0;r<t.length;r++)e=ft.filter(function(n){return n.C_InvoicePaySchedule_ID==t[r].C_InvoicePaySchedule_ID}),e.length==0&&(t[r].recid=f+r,u.push(t[r]));t=u;ft=[];u=[]}yc(t);le=9;ou=10;ae=13;hf=14}},error:function(){}})}function lc(i){var o=[],s=[],a,f,h,c,l,u,v,y;for(i.length>0&&(s=Object.keys(i[0])),a=0,r.records.length>0&&(a=r.records.length),f=0;f<i.length;f++){for(h={},h.recid=a+f,c=0;c<s.length;c++)l=s[c],h[l]=l=="SelectRow"?!1:n.Utility.encodeText(i[f][l]);o.push(h)}if(w2utils.encodeTags(o),r.add(o),lr>0)for(u=0;u<lr;u++)v=t("#grid_"+r.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(v[u]).prop("checked",!0),r.editChange.call(r,v[u],u,0,event),y={type:"click",phase:"before",target:"grid",recid:u,index:u,isStopped:!1,"isCan//celled":!1,onComplete:null},r.trigger(y);lr=0;o=[];s=[];of.find("#grid_openformatglgrid_"+e.windowNo+"_records").on("scroll",co)}function ys(i,u){var f=[],y,c,h,l,a,v,s,u,p;for(f.push({field:"SelectRow",caption:n.translatedTexts.VIS_Check,size:"50px",editable:{type:"checkbox"}}),f.push({field:"AD_Org_ID",caption:n.translatedTexts.AD_Org_ID,size:"85px",hidden:!0}),f.push({field:"OrgName",caption:n.translatedTexts.AD_Org_ID,size:"105px",hidden:!1,sortable:!1}),f.push({field:"DATEACCT",caption:n.translatedTexts.DateAcct,render:function(n){var t=n.DATEACCT;return new Date(t).toLocaleDateString()},size:"105px",hidden:!1,sortable:!1}),f.push({field:"DOCUMENTNO",caption:n.translatedTexts.DocumentNo,size:"120px",hidden:!1,sortable:!1}),f.push({field:"Account",caption:n.translatedTexts.Account,size:"150px",hidden:!1,sortable:!1}),f.push({field:"Isocode",caption:n.translatedTexts.TrxCurrency,size:"105px",hidden:!1}),f.push({field:"ConversionName",caption:n.translatedTexts.C_ConversionType_ID,size:"105px",hidden:!1,sortable:!1}),f.push({field:"ConvertedAmount",caption:n.Msg.getMsg("Amount"),attr:"align=right",size:"150px",hidden:!1,sortable:!1,render:function(n){var t=n.ConvertedAmount;return parseFloat(t).toLocaleString(navigator.language,{maximumFractionDigits:o,minimumFractionDigits:o})}}),f.push({field:"OpenAmount",caption:n.translatedTexts.OpenAmount,attr:"align=right",size:"150px",hidden:!1,sortable:!1,render:function(n){var t=n.OpenAmount;return parseFloat(t).toLocaleString(navigator.language,{maximumFractionDigits:o,minimumFractionDigits:o})}}),f.push({field:"AppliedAmt",caption:n.translatedTexts.AppliedAmount,size:"150px",attr:"align=right",hidden:!1,sortable:!1,render:function(n){var t=n.AppliedAmt;return parseFloat(t).toLocaleString(navigator.language,{maximumFractionDigits:o,minimumFractionDigits:o})}}),f.push({field:"DATEDOC",caption:n.translatedTexts.Date,render:function(n){var t=n.DATEDOC;return new Date(t).toLocaleDateString()},size:"80px",hidden:!0}),f.push({field:"GL_JOURNALLINE_ID",caption:n.translatedTexts.GL_JOURNALLINE_ID,size:"150px",hidden:!0}),f.push({field:"C_ConversionType_ID",caption:n.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!0}),f.push({field:"GL_Journal_ID",caption:n.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!0}),y=[],c=[],i.length>0&&(c=Object.keys(i[0])),h=0;h<i.length;h++){for(l={},l.recid=h,a=0;a<c.length;a++)v=c[a],l[v]=v=="SelectRow"?!1:n.Utility.encodeText(i[h][v]);y.push(l)}if(r!=undefined&&r!=null&&(r.destroy(),r=null),r=of.w2grid({name:"openformatglgrid_"+e.windowNo,multiSelect:!0,columns:f,records:y,onChange:function(n){ke(n,!1,!1,!1,!0)&&il(n)},onClick:function(n){nl(n);er()},onDblClick:function(n){n.preventDefault();return},onSelect:function(n){n.all&&(n.onComplete=function(){of.find("#grid_openformatglgrid_"+e.windowNo+"_records").on("scroll",co)})},onEditField:function(n){n.onComplete=function(n){id=n.recid;t("#grid_openformatglgrid_"+e.windowNo+"_edit_"+id+"_10").keydown(function(n){var t=pe.isDecimalSeparatorDot(window.navigator.language);if(t||n.keyCode!=190&&n.keyCode!=110){if(t&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)&&(this.value=this.value.replace(".","")),n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&(this.value=this.value.replace(",","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0})}}}),lr>0)for(s=0;s<lr;s++)u=t("#grid_"+r.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(u[s]).prop("checked",!0),r.editChange.call(r,u[s],s,0,event),p={type:"click",phase:"before",target:"grid",recid:s,index:s,isStopped:!1,"isCan//celled":!1,onComplete:null},r.trigger(p);lr=0;r.autoLoad=!0;t(t(r.box)[0]).find(".w2ui-search-down").css("margin-top","4px");t(t(r.box)[0]).find(".w2ui-search-clear").css("margin-top","4px")}function ps(i,r){var f=[],y,c,h,l,a,v,s,r,p;for(f.push({field:"SelectRow",caption:n.translatedTexts.VIS_Check,size:"50px",editable:{type:"checkbox"}}),f.push({field:"AD_Org_ID",caption:n.translatedTexts.AD_Org_ID,size:"85px",hidden:!0}),f.push({field:"OrgName",caption:n.translatedTexts.AD_Org_ID,size:"85px",hidden:!1}),f.push({field:"DATEACCT",caption:n.translatedTexts.DateAcct,size:"85px",hidden:!1,render:function(n){var t=n.DATEACCT;return new Date(t).toLocaleDateString()}}),f.push({field:"Documentno",caption:n.translatedTexts.DocumentNo,size:"120px",hidden:!1}),f.push({field:"DocBaseType",caption:n.translatedTexts.DocBaseType,size:"120px",hidden:!1}),f.push({field:"PayName",caption:n.translatedTexts.PaymentMethod,size:"120px",hidden:!1}),f.push({field:"Isocode",caption:n.translatedTexts.TrxCurrency,size:"85px",hidden:!1}),f.push({field:"ConversionName",caption:n.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!1}),r?f.push({field:"Payment",caption:n.translatedTexts.Amount,size:"150px",attr:"align=right",hidden:!1,render:function(n){var t=n.Payment;return parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}):f.push({field:"Payment",caption:n.translatedTexts.Amount,size:"150px",hidden:!0}),f.push({field:"ConvertedAmount",caption:n.translatedTexts.ConvertedAmount,size:"150px",attr:"align=right",hidden:!1,render:function(n){var t=n.ConvertedAmount;return parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}),f.push({field:"OpenAmt",caption:n.translatedTexts.OpenAmount,size:"150px",attr:"align=right",hidden:!1,render:function(n){var t=n.OpenAmt;return parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}),f.push({field:"Multiplierap",caption:n.translatedTexts.multiplierap,size:"150px",hidden:!0}),f.push({field:"AppliedAmt",caption:n.translatedTexts.AppliedAmount,size:"150px",attr:"align=right",hidden:!1,render:function(n){var t=n.AppliedAmt;return t=gf(event,t,t),parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})},editable:{type:"number"}}),f.push({field:"Date1",caption:n.translatedTexts.Date,size:"80px",hidden:!0,render:function(n){var t=n.Date1;return new Date(t).toLocaleDateString()}}),f.push({field:"CpaymentID",caption:n.translatedTexts.c_payment_id,size:"150px",hidden:!0}),f.push({field:"C_ConversionType_ID",caption:n.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!0}),y=[],c=[],i.length>0&&(c=Object.keys(i[0])),h=0;h<i.length;h++){for(l={},l.recid=h,a=0;a<c.length;a++)v=c[a],l[v]=v=="SelectRow"?!1:n.Utility.encodeText(i[h][v]);y.push(l)}if(u!=undefined&&u!=null&&(u.destroy(),u=null),u=uf.w2grid({name:"openformatgrid_"+e.windowNo,multiSelect:!0,columns:f,records:y,onClick:function(n){dc(n);er()},onChange:function(n){ke(n,!1,!0,!1,!1)&&tl(n)},onDblClick:function(n){pc(n)},onSelect:function(n){n.all&&(n.onComplete=function(){uf.find("#grid_openformatgrid_"+e.windowNo+"_records").on("scroll",lo)})},onEditField:function(n){n.onComplete=function(n){id=n.recid;t("#grid_openformatgrid_"+e.windowNo+"_edit_"+id+"_12").keydown(function(n){var t=pe.isDecimalSeparatorDot(window.navigator.language);if(t||n.keyCode!=190&&n.keyCode!=110){if(t&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)&&(this.value=this.value.replace(".","")),n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&(this.value=this.value.replace(",","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0})}}}),ar>0)for(s=0;s<ar;s++)r=t("#grid_"+u.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(r[s]).prop("checked",!0),u.editChange.call(u,r[s],s,0,event),p={type:"click",phase:"before",target:"grid",recid:s,index:s,isStopped:!1,"isCan//celled":!1,onComplete:null},u.trigger(p);ar=0;u.autoLoad=!0;t(t(u.box)[0]).find(".w2ui-search-down").css("margin-top","4px");t(t(u.box)[0]).find(".w2ui-search-clear").css("margin-top","4px")}function ac(i){var o=[],s=[],a,f,h,c,l,r,v,y;for(i.length>0&&(s=Object.keys(i[0])),a=0,u.records.length>0&&(a=u.records.length),f=0;f<i.length;f++){for(h={},h.recid=a+f,c=0;c<s.length;c++)l=s[c],h[l]=l=="SelectRow"?!1:n.Utility.encodeText(i[f][l]);o.push(h)}if(w2utils.encodeTags(o),u.add(o),ar>0)for(r=0;r<ar;r++)v=t("#grid_"+u.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(v[r]).prop("checked",!0),u.editChange.call(u,v[r],r,0,event),y={type:"click",phase:"before",target:"grid",recid:r,index:r,isStopped:!1,"isCan//celled":!1,onComplete:null},u.trigger(y);ar=0;o=[];s=[];uf.find("#grid_openformatgrid_"+e.windowNo+"_records").on("scroll",lo)}function ws(i,r){var u=[],y,c,h,l,a,v,s,r,p;for(u.push({field:"SelectRow",caption:n.translatedTexts.VIS_Check,size:"50px",editable:{type:"checkbox"}}),u.push({field:"AD_Org_ID",caption:n.translatedTexts.AD_Org_ID,size:"85px",hidden:!0}),u.push({field:"OrgName",caption:n.translatedTexts.AD_Org_ID,size:"105px",hidden:!1}),u.push({field:"DATEACCT",caption:n.translatedTexts.DateAcct,size:"105px",hidden:!1,render:function(n){var t=n.DATEACCT;return new Date(t).toLocaleDateString()}}),u.push({field:"ReceiptNo",caption:n.translatedTexts.RECEIPTNO,size:"120px",hidden:!1}),u.push({field:"VSS_paymenttype",caption:"Payment ID",size:"120px",hidden:!0}),u.push({field:"Payment",caption:"Payment Type",size:"120px",hidden:!1}),u.push({field:"Isocode",caption:n.Msg.getMsg("TrxCurrency"),size:"105px",hidden:!1}),u.push({field:"ConversionName",caption:n.translatedTexts.C_ConversionType_ID,size:"105px",hidden:!1}),r?u.push({field:"Amount",caption:n.translatedTexts.Amount,size:"150px",attr:"align=right",hidden:!1,render:function(n){var t=n.Amount;return parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}):u.push({field:"Amount",caption:n.translatedTexts.Amount,size:"150px",hidden:!0}),u.push({field:"ConvertedAmount",caption:n.Msg.getMsg("ConvertedAmount"),size:"150px",attr:"align=right",hidden:!1,render:function(n){var t=n.ConvertedAmount;return parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}),u.push({field:"OpenAmt",caption:n.translatedTexts.OpenAmount,size:"150px",hidden:!1,attr:"align=right",render:function(n){var t=n.OpenAmt;return parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}),u.push({field:"AppliedAmt",caption:n.translatedTexts.AppliedAmount,size:"150px",attr:"align=right",hidden:!1,render:function(n){var t=n.AppliedAmt;return t=gf(event,t,t),parseFloat(t).toLocaleString(navigator.language,{maximumFractionDigits:o,minimumFractionDigits:o})},editable:{type:"number"}}),u.push({field:"Created",caption:n.translatedTexts.Date,size:"80px",hidden:!0,render:function(n){var t=n.Created;return new Date(t).toLocaleDateString()}}),u.push({field:"CcashlineiID",caption:n.translatedTexts.ccashlineid,size:"150px",hidden:!0}),u.push({field:"Multiplierap",caption:n.translatedTexts.multiplierap,hidden:!0}),u.push({field:"C_ConversionType_ID",caption:n.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!0}),y=[],c=[],i.length>0&&(c=Object.keys(i[0])),h=0;h<i.length;h++){for(l={},l.recid=h,a=0;a<c.length;a++)v=c[a],l[v]=v.toLower()=="selectrow"?!1:n.Utility.encodeText(i[h][v]);y.push(l)}if(f!=undefined&&f!=null&&(f.destroy(),f=null),f=ff.w2grid({name:"openformatgridcash_"+e.windowNo,multiSelect:!0,columns:u,records:y,onChange:function(n){ke(n,!1,!1,!0,!1)&&rl(n)},onClick:function(n){gc(n);er()},onDblClick:function(n){wc(n)},onSelect:function(n){n.all&&(n.onComplete=function(){ff.find("#grid_openformatgridcash_"+e.windowNo+"_records").on("scroll",ao)})},onEditField:function(n){n.onComplete=function(n){id=n.recid;t("#grid_openformatgridcash_"+e.windowNo+"_edit_"+id+"_12").keydown(function(n){var t=pe.isDecimalSeparatorDot(window.navigator.language);if(t||n.keyCode!=190&&n.keyCode!=110){if(t&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)&&(this.value=this.value.replace(".","")),n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&(this.value=this.value.replace(",","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0})}}}),af>0)for(s=0;s<af;s++)r=t("#grid_"+f.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(r[s]).prop("checked",!0),f.editChange.call(f,r[s],s,0,event),p={type:"click",phase:"before",target:"grid",recid:s,index:s,isStopped:!1,"isCan//celled":!1,onComplete:null},f.trigger(p);af=0;f.autoLoad=!0;t(t(f.box)[0]).find(".w2ui-search-down").css("margin-top","4px");t(t(f.box)[0]).find(".w2ui-search-clear").css("margin-top","4px")}function vc(t){var r=[],u=[],c,i,o,s,h;for(t.length>0&&(u=Object.keys(t[0])),c=0,f.records.length>0&&(c=f.records.length),i=0;i<t.length;i++){for(o={},o.recid=c+i,s=0;s<u.length;s++)h=u[s],o[h]=h.toLower()=="selectrow"?!1:n.Utility.encodeText(t[i][h]);r.push(o)}w2utils.encodeTags(r);f.add(r);r=[];u=[];ff.find("#grid_openformatgridcash_"+e.windowNo+"_records").on("scroll",ao)}function be(n,e,o,s,h){var l=!0,c=null;return e?c=t("#grid_"+i.name+'_records td[col="0"]').find('input[type="checkbox"]:checked'):o?c=t("#grid_"+u.name+'_records td[col="0"]').find('input[type="checkbox"]:checked'):s?c=t("#grid_"+f.name+'_records td[col="0"]').find('input[type="checkbox"]:checked'):h&&(c=t("#grid_"+r.name+'_records td[col="0"]').find('input[type="checkbox"]:checked')),c!=null&&c.length>50&&(t(n).prop("checked",!1),l=!1),l}function ke(e,o,s,h,c){var v=!0,l=null,a,y;return o?l=i.name:s?l=u.name:h?l=f.name:c&&(l=r.name),a=t("#grid_"+l+'_records td[col="0"]').find('input[type="checkbox"]:checked'),a!=null&&a.length>50&&(y=t("#grid_"+l+'_records td[col="0"]').find('input[type="checkbox"]'),t(y[e.recid]).prop("checked",!1),n.ADialog.warn("VIS_MaxLimitReached"),e.preventDefault(),v=!1),v}function bs(r,u){var f=[],y,c,h,l,a,v,s,u,p;for(f.push({field:"SelectRow",caption:n.translatedTexts.VIS_Check,size:"50px",editable:{type:"checkbox"}}),f.push({field:"AD_Org_ID",caption:n.translatedTexts.AD_Org_ID,size:"85px",hidden:!0}),f.push({field:"OrgName",caption:n.translatedTexts.AD_Org_ID,size:"105px",hidden:!1}),f.push({field:"DATEACCT",caption:n.translatedTexts.DateAcct,size:"105px",hidden:!1,render:function(n){var t=n.DATEACCT;return new Date(t).toLocaleDateString()}}),f.push({field:"Documentno",caption:n.translatedTexts.DocumentNo,size:"120px",hidden:!1}),f.push({field:"InvoiceScheduleDate",caption:n.translatedTexts.ScheduleDate,size:"100px",hidden:!1,render:function(n){var t=n.InvoiceScheduleDate;return new Date(t).toLocaleDateString()}}),f.push({field:"DocBaseType",caption:n.translatedTexts.DocBaseType,size:"120px",hidden:!1}),f.push({field:"PayName",caption:n.translatedTexts.PaymentMethod,size:"120px",hidden:!1}),f.push({field:"Isocode",caption:n.Msg.getMsg("TrxCurrency"),size:"85px",hidden:!1}),f.push({field:"ConversionName",caption:n.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!1}),u?f.push({field:"Currency",caption:n.translatedTexts.Amount,size:"100px",attr:"align=right",hidden:!1,render:function(n){var t=n.Currency;return parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}):f.push({field:"Currency",caption:n.translatedTexts.Amount,size:"100px",hidden:!0}),f.push({field:"Converted",caption:n.Msg.getMsg("ConvertedAmount"),size:"100px",hidden:!1,attr:"align=right",render:function(n){var t=n.Converted;return parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}),f.push({field:"Amount",caption:n.translatedTexts.OpenAmount,size:"100px",hidden:!1,attr:"align=right",render:function(n){var t=n.Amount;return parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}),f.push({field:"Discount",caption:n.translatedTexts.DiscountAmt,size:"100px",hidden:!1,attr:"align=right",render:function(n){var t=n.Discount;return t=gf(event,t,t),parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})},editable:{type:"number"}}),f.push({field:"Date1",caption:n.translatedTexts.Date,size:"80px",hidden:!0,render:function(n){var t=n.Date1;return new Date(t).toLocaleDateString()}}),f.push({field:"CinvoiceID",caption:n.translatedTexts.cinvoiceid,size:"150px",hidden:!0}),f.push({field:"Multiplierap",caption:n.translatedTexts.multiplierap,hidden:!0}),f.push({field:"Writeoff",caption:n.translatedTexts.WriteOffAmount,size:"100px",attr:"align=right",hidden:!1,render:function(n){var t=n.Writeoff;return t=gf(event,t,t),parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})},editable:{type:"number"}}),f.push({field:"AppliedAmt",caption:n.translatedTexts.AppliedAmount,size:"100px",hidden:!1,attr:"align=right",render:function(n){var t=n.AppliedAmt;return t=gf(event,t,t),parseFloat(t).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})},editable:{type:"number"}}),ku>0&&f.push({field:"C_InvoicePaySchedule_ID",caption:n.translatedTexts.C_InvoicePaySchedule_ID,size:"100px",hidden:!0}),f.push({field:"C_ConversionType_ID",caption:n.translatedTexts.C_ConversionType_ID,size:"85px",hidden:!0}),y=[],c=[],r.length>0&&(c=Object.keys(r[0])),h=0;h<r.length;h++){for(l={},l.recid=h,a=0;a<c.length;a++)v=c[a],l[v]=v.toLower()=="selectrow"?!1:n.Utility.encodeText(r[h][v]);y.push(l)}if(i!=undefined&&i!=null&&(i.destroy(),i=null),i=ef.w2grid({name:"openformatgridinvoice_"+e.windowNo,multiSelect:!0,columns:f,records:y,onChange:function(n){ke(n,!0,!1,!1,!1)&&(ul(n),er())},onClick:function(n){kc(n);er()},onDblClick:function(n){bc(n)},onSelect:function(n){n.all&&(n.onComplete=function(){ef.find("#grid_openformatgridinvoice_"+e.windowNo+"_records").on("scroll",vo)})},onEditField:function(n){n.onComplete=function(n){id=n.recid;(n.column==12||n.column==16||n.column==17)&&t("#grid_openformatgridinvoice_"+e.windowNo+"_edit_"+id+"_"+n.column).keydown(function(n){var t=pe.isDecimalSeparatorDot(window.navigator.language);if(t||n.keyCode!=190&&n.keyCode!=110){if(t&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)&&(this.value=this.value.replace(".","")),n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&(this.value=this.value.replace(",","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0})}}}),vr>0)for(s=0;s<vr;s++)u=t("#grid_"+i.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(u[s]).prop("checked",!0),i.editChange.call(i,u[s],s,0,event),p={type:"click",phase:"before",target:"grid",recid:s,index:s,isStopped:!1,"isCan//celled":!1,onComplete:null},i.trigger(p);vr=0;i.autoLoad=!0;t(t(i.box)[0]).find(".w2ui-search-down").css("margin-top","4px");t(t(i.box)[0]).find(".w2ui-search-clear").css("margin-top","4px")}function yc(r){var o=[],s=[],a,f,h,c,l,u,v,y;for(r.length>0&&(s=Object.keys(r[0])),a=0,i.records.length>0&&(a=i.records.length),f=0;f<r.length;f++){for(h={},h.recid=a+f,c=0;c<s.length;c++)l=s[c],h[l]=l.toLower()=="selectrow"?!1:n.Utility.encodeText(r[f][l]);o.push(h)}if(w2utils.encodeTags(o),i.add(o),vr>0)for(u=0;u<vr;u++)v=t("#grid_"+i.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(v[u]).prop("checked",!0),i.editChange.call(i,v[u],u,0,event),y={type:"click",phase:"before",target:"grid",recid:u,index:u,isStopped:!1,"isCan//celled":!1,onComplete:null},i.trigger(y);vr=0;o=[];s=[];ef.find("#grid_openformatgridinvoice_"+e.windowNo+"_records").on("scroll",vo)}function pc(i){var r,f;if(u.columns[i.column]==undefined){i.preventDefault();return}if(u.columns[i.column].field=="AppliedAmt"){if(r=u.getChanges(),r==undefined||r.length==0){u.columns[i.column].editable=!1;return}if(f=t.grep(r,function(n){return parseInt(n.recid)==parseInt(i.recid)}),f==null||f[0]==undefined||f[0].SelectRow==undefined){u.columns[i.column].editable=!1;return}u.columns[i.column].editable={type:"number"};u.columns[i.column].render=function(t){var r=0;return u.columns[i.column].field=="AppliedAmt"&&(t.changes==undefined||t.changes.AppliedAmt==undefined||t.changes.SelectRow==undefined?t.changes!=undefined&&t.changes.SelectRow!=undefined&&t.changes.SelectRow==!0&&t.changes.AppliedAmt==undefined?(t.changes.AppliedAmt=t.OpenAmt,r=nt(t.changes.AppliedAmt.toString(),h)):r=0:t.changes!=undefined&&t.changes.SelectRow!=undefined&&t.changes.SelectRow==!0&&t.changes.AppliedAmt==undefined?(t.changes.AppliedAmt=t.OpenAmt,r=nt(t.changes.AppliedAmt.toString(),h)):r=nt(t.changes.AppliedAmt.toString(),h)),parseFloat(r)>0&&parseFloat(r)>parseFloat(t.OpenAmt)?(n.ADialog.warn("AppliedAmtgrtr"),r=parseFloat(t.OpenAmt)):parseFloat(t.OpenAmt)<0&&parseFloat(r)<parseFloat(t.OpenAmt)?(n.ADialog.warn("AppliedAmtgrtr"),r=parseFloat(t.OpenAmt)):parseFloat(t.OpenAmt)>0&&parseFloat(r)<0&&(n.ADialog.warn("VIS_AppliedAmtleszero"),r=parseFloat(t.OpenAmt)),t.OpenAmt!=0&&t.AppliedAmt!=0&&t.OpenAmt!=""&&t.AppliedAmt!=""&&t.changes!=undefined&&t.changes.SelectRow==!0&&t.OpenAmt==t.AppliedAmt&&parseFloat(t.changes.AppliedAmt)==t.AppliedAmt&&rf(),parseFloat(r).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}}function wc(i){var r,u;if(f.columns[i.column]==undefined){i.preventDefault();return}if(f.columns[i.column].field=="AppliedAmt"){if(r=f.getChanges(),r==undefined||r.length==0){f.columns[i.column].editable=!1;return}if(u=t.grep(r,function(n){return parseInt(n.recid)==parseInt(i.recid)}),u==null||u[0]==undefined||u[0].SelectRow==undefined){f.columns[i.column].editable=!1;return}f.columns[i.column].editable={type:"number"};f.columns[i.column].render=function(t){var r=0;return f.columns[i.column].field=="AppliedAmt"&&(t.changes==undefined||t.changes.AppliedAmt==undefined||t.changes.SelectRow==undefined?t.changes!=undefined&&t.changes.SelectRow!=undefined&&t.changes.SelectRow==!0&&t.changes.AppliedAmt==undefined?(t.changes.AppliedAmt=t.OpenAmt,r=nt(t.changes.AppliedAmt.toString(),h)):r=0:t.changes!=undefined&&t.changes.SelectRow!=undefined&&t.changes.SelectRow==!0&&t.changes.AppliedAmt==undefined?(t.changes.AppliedAmt=t.OpenAmt,r=nt(t.changes.AppliedAmt.toString(),h)):r=nt(t.changes.AppliedAmt.toString(),h)),parseFloat(r)>0&&parseFloat(r)>parseFloat(t.OpenAmt)?(n.ADialog.warn("AppliedAmtgrtr"),r=parseFloat(t.OpenAmt)):parseFloat(t.OpenAmt)<0&&parseFloat(r)<parseFloat(t.OpenAmt)?(n.ADialog.warn("AppliedAmtgrtr"),r=parseFloat(t.OpenAmt)):parseFloat(t.OpenAmt)>0&&parseFloat(r)<0&&(n.ADialog.warn("VIS_AppliedAmtleszero"),r=parseFloat(t.OpenAmt)),t.OpenAmt!=0&&t.AppliedAmt!=0&&t.OpenAmt!=""&&t.AppliedAmt!=""&&t.changes!=undefined&&t.changes.SelectRow==!0&&t.OpenAmt==t.AppliedAmt&&parseFloat(t.changes.AppliedAmt)==t.AppliedAmt&&rf(),parseFloat(r).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}}function bc(r){var u,f;if(i.columns[r.column]==undefined){r.preventDefault();return}if(i.columns[r.column].field=="AppliedAmt"||i.columns[r.column].field=="Writeoff"||i.columns[r.column].field=="Discount"){if(u=i.getChanges(),u==undefined||u.length==0){i.columns[r.column].editable=!1;return}if(f=t.grep(u,function(n){return parseInt(n.recid)==parseInt(r.recid)}),f==null||f[0]==undefined||f[0].SelectRow==undefined){i.columns[r.column].editable=!1;return}i.columns[r.column].editable={type:"number"};i.columns[r.column].render=function(t){var u=0,f;return i.columns[r.column].field=="AppliedAmt"?t.changes==undefined||t.changes.AppliedAmt==undefined||t.changes.SelectRow==undefined?t.changes!=undefined&&t.changes.SelectRow!=undefined&&t.changes.SelectRow==!0&&t.changes.AppliedAmt==undefined?(t.changes.AppliedAmt=t.Amount,u=nt(t.changes.AppliedAmt.toString(),h)):u=0:t.changes!=undefined&&t.changes.SelectRow!=undefined&&t.changes.SelectRow==!0&&t.changes.AppliedAmt==undefined?(t.changes.AppliedAmt=t.Amount,u=nt(t.changes.AppliedAmt.toString(),h)):u=nt(t.changes.AppliedAmt.toString(),h):i.columns[r.column].field=="Writeoff"?t.changes==undefined||t.changes.Writeoff==undefined||t.changes.SelectRow==undefined?t.changes!=undefined&&t.changes.SelectRow!=undefined&&t.changes.SelectRow==!0&&t.changes.Writeoff==undefined?(t.changes.Writeoff=t.Writeoff,u=nt(t.changes.Writeoff.toString(),h)):u=0:t.changes!=undefined&&t.changes.SelectRow!=undefined&&t.changes.SelectRow==!0&&t.changes.Writeoff==undefined?(t.changes.Writeoff=t.Writeoff,u=nt(t.changes.Writeoff.toString(),h)):u=nt(t.changes.Writeoff.toString(),h):i.columns[r.column].field=="Discount"&&(t.changes==undefined||t.changes.Discount==undefined||t.changes.SelectRow==undefined?t.changes!=undefined&&t.changes.SelectRow!=undefined&&t.changes.SelectRow==!0&&t.changes.Discount==undefined?(t.changes.Discount=t.Discount,u=nt(t.changes.Discount.toString(),h)):u=0:t.changes!=undefined&&t.changes.SelectRow!=undefined&&t.changes.SelectRow==!0&&t.changes.Discount==undefined?(t.changes.Discount=t.Discount,u=nt(t.changes.Discount.toString(),h)):u=nt(t.changes.Discount.toString(),h)),parseFloat(u)>0&&parseFloat(u)>parseFloat(t.Amount)?(n.ADialog.warn("AppliedAmtgrtr"),u=parseFloat(t.Amount)):parseFloat(t.Amount)<0&&parseFloat(u)<parseFloat(t.Amount)?(n.ADialog.warn("AppliedAmtgrtr"),u=parseFloat(t.Amount)):parseFloat(t.Amount)>0&&parseFloat(u)<0&&(n.ADialog.warn("VIS_AppliedAmtleszero"),u=parseFloat(t.Amount)),t.Amount!=0&&t.AppliedAmt!=0&&t.OpenAmt!=""&&t.AppliedAmt!=""&&t.changes!=undefined&&t.changes.SelectRow==!0&&parseFloat(t.Amount)===t.AppliedAmt&&parseFloat(t.changes.AppliedAmt)==t.AppliedAmt&&((t.changes.Discount!=0||t.changes.Writeoff!=0)&&(f=parseFloat(t.changes.Discount)+parseFloat(t.changes.Writeoff)+parseFloat(t.changes.AppliedAmt),Math.abs(f)>Math.abs(parseFloat(t.Amount))&&(n.ADialog.warn("AppliedAmtgrtr"),i.columns[r.column].field=="Discount"?(t.changes.Discount=0,u=t.changes.Discount):i.columns[r.column].field=="Writeoff"?(t.changes.Writeoff=0,u=t.changes.Writeoff):i.columns[r.column].field=="AppliedAmt"&&(t.changes.AppliedAmt=0,u=t.changes.AppliedAmt))),rf()),parseFloat(u).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})}}}function nt(n,t){var i=0;return typeof n=="string"?n:n=n.toString(),t?(n.contains("−")?n=(-1*wt.GetConvertedNumber(n,t)).toString():n.contains(".")&&(n=wt.GetConvertedNumber(n,t).toString()),i=n!=""?n:i):(n.contains("−")&&!n.contains(".")?n=(-1*wt.GetConvertedNumber(n,t)).toString():n.contains(",")&&(n=wt.GetConvertedNumber(n,t).toString()),i=n!=""?n:i),i}function gf(t,i){var f=!1,u,r;if(t.value_new=n.Utility.Util.getValueOfString(i),t.value_new.contains(".")){for(f=!0,u=[],r=0;r<t.value_new.length;r++)t.value_new[r]==="."&&u.push(r);u.length>1&&(t.value_new=yo(t.value_new,"."))}if(t.value_new.contains(","))if(f)t.value_new=yo(t.value_new,",");else{for(u=[],r=0;r<t.value_new.length;r++)t.value_new[r]===","&&u.push(r);t.value_new=u.length>1?yo(t.value_new,","):t.value_new.replace(",",".")}return t.value_new==""&&(t.value_new="0"),t.value_new}function yo(n,t){var i=n.split(t);return n=i.slice(0,-1).join("")+"."+i.slice(-1),n.indexOf(".")==n.length-1&&(n=n.replace(".","")),n}function de(n,t){var i=n.split(t);return n=i.slice(0,-1).join("")+i.slice(-1),n.indexOf(t=="."?",":".")==n.length-1&&(n=n.replace(t=="."?",":".","")),n}function kc(r){var o=i.getColumn("AppliedAmt",!0),y=i.getColumn("SelectRow",!0),c,u,e,f,h,l,v;if(r.column==0||r.column==null){if(c=i.getChanges(),u=t.grep(c,function(n){return parseInt(n.recid)==parseInt(r.recid)}),u==null||u[0]==undefined||u.length==0||u[0].SelectRow==undefined)i.records[r.recid].AppliedAmt=0,i.records[r.recid].Writeoff=0,i.records[r.recid].Discount=0,i.refreshCell(r.recid,"AppliedAmt"),i.refreshCell(r.recid,"Writeoff"),i.refreshCell(r.recid,"Discount"),er();else if(u[0].SelectRow==!0)if(et==0?et=i.get(r.recid).C_ConversionType_ID:ki&&rr||et==i.get(r.recid).C_ConversionType_ID||(e=document.getElementsByName(r.target),e.length>0&&(e=e[0]),f=t(e).find("#grid_openformatgridinvoice_rec_"+r.recid+""),f.length>0&&(f=f[0]),t(f).find("input:checked").prop("checked")&&t(f).find("input:checked").prop("checked",!1),i.get(r.recid).changes=!1,i.columns[o].editable=!1,i.get(r.recid).changes.AppliedAmt="0",i.refreshCell(r.recid,"AppliedAmt"),i.get(r.recid).changes.Discount="0",i.refreshCell(r.recid,"Discount"),i.get(r.recid).changes.Writeoff="0",i.refreshCell(r.recid,"Writeoff"),n.ADialog.warn("VIS_ConversionNotMatched")),s.is(":checked")){if(a.val()=="")return n.ADialog.warn("VIS_SlctcnvrsnDate"),i.get(r.recid).changes=!1,i.unselect(r.recid),i.columns[o].editable=!1,i.get(r.recid).changes.AppliedAmt="0",i.refreshCell(r.recid,"AppliedAmt"),h=t("#grid_"+i.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(h[r.recid]).prop("checked",!1),i.editChange.call(i,h[r.recid],r.recid,0,r),l={type:"click",phase:"before",target:"grid",recid:r.recid,index:r.recid,isStopped:!1,"isCan//celled":!1,onComplete:null},i.trigger(l),!1;v=Globalize.format(new Date(a.val()),"yyyy-MM-dd");ui.val(Globalize.format(new Date(v),"yyyy-MM-dd"))}else er();else i.unselect(r.recid),i.columns[o].editable=!1,i.get(r.recid).changes.AppliedAmt="0",i.refreshCell(r.recid,"AppliedAmt"),i.get(r.recid).changes.Discount="0",i.refreshCell(r.recid,"Discount"),i.get(r.recid).changes.Writeoff="0",i.refreshCell(r.recid,"Writeoff");y!=r.column&&r.column!=null||u[0]==undefined||u[0].SelectRow==undefined||(i.records[r.recid].AppliedAmt=n.Utility.Util.getValueOfDecimal(i.get(r.recid).Amount));gu(r.recid,r.column,!0,!1)}}function dc(i){var y,v,r,h,e,l,p,f,o,c;if(hu){i.preventDefault();return}if(f=u.getColumn("AppliedAmt",!0),y=u.getColumn("SelectRow",!0),i.column==0||i.column==null){if(v=u.getChanges(),r=t.grep(v,function(n){return parseInt(n.recid)==parseInt(i.recid)}),r==null||r[0]==undefined||r.length==0||r[0].SelectRow==undefined)u.records[i.recid].AppliedAmt=0,u.refreshCell(i.recid,"AppliedAmt"),er();else if(r[0].SelectRow==!0){let r=t.grep(v,function(n){return n.SelectRow==!0});if(s.is(":checked")?et=pt.getValue():rr&&r!=null&&r.length>0&&(et=u.get(r[0].recid).C_ConversionType_ID),et==0?et=u.get(i.recid).C_ConversionType_ID:et!=u.get(i.recid).C_ConversionType_ID&&(h=document.getElementsByName(i.target),h.length>0&&(h=h[0]),e=t(h).find("#grid_openformatgrid_rec_"+i.recid+""),e.length>0&&(e=e[0]),t(e).find("input:checked").prop("checked")&&t(e).find("input:checked").prop("checked",!1),u.get(i.recid).changes=!1,u.unselect(i.recid),u.columns[f].editable=!1,u.get(i.recid).changes.AppliedAmt="0",u.refreshCell(i.recid,"AppliedAmt"),n.ADialog.warn("VIS_ConversionNotMatched")),s.is(":checked")){if(a.val()=="")return n.ADialog.warn("VIS_SlctcnvrsnDate"),u.get(i.recid).changes=!1,u.unselect(i.recid),u.columns[f].editable=!1,u.get(i.recid).changes.AppliedAmt="0",u.refreshCell(i.recid,"AppliedAmt"),o=t("#grid_"+u.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(o[i.recid]).prop("checked",!1),u.editChange.call(u,o[i.recid],i.recid,0,i),c={type:"click",phase:"before",target:"grid",recid:i.recid,index:i.recid,isStopped:!1,"isCan//celled":!1,onComplete:null},u.trigger(c),!1;if(l=u.records[i.recid].DATEACCT,p=Globalize.format(new Date(a.val()),"yyyy-MM-dd"),l=Globalize.format(new Date(l),"yyyy-MM-dd"),p!=l)return n.ADialog.warn("VIS_SelectSameDate"),f=u.getColumn("DATEACCT",!0),u.get(i.recid).changes=!1,u.unselect(i.recid),u.columns[f].editable=!1,u.get(i.recid).changes.AppliedAmt="0",u.refreshCell(i.recid,"AppliedAmt"),o=t("#grid_"+u.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(o[i.recid]).prop("checked",!1),u.editChange.call(u,o[i.recid],i.recid,0,i),c={type:"click",phase:"before",target:"grid",recid:i.recid,index:i.recid,isStopped:!1,"isCan//celled":!1,onComplete:null},u.trigger(c),!1}}else u.unselect(i.recid),u.columns[f].editable=!1,u.get(i.recid).changes.AppliedAmt="0",u.refreshCell(i.recid,"AppliedAmt");y!=i.column&&i.column!=null||r[0]==undefined||r[0].SelectRow==undefined||(u.records[i.recid].AppliedAmt=n.Utility.Util.getValueOfDecimal(u.get(i.recid).OpenAmt));gu(i.recid,i.column,!1,!1)}}function gc(i){var v,y,r,h,e,l,p,u,o,c;if(ki){i.preventDefault();return}if(u=f.getColumn("AppliedAmt",!0),v=f.getColumn("SelectRow",!0),i.column==0||i.column==null){if(y=f.getChanges(),r=t.grep(y,function(n){return parseInt(n.recid)==parseInt(i.recid)}),r==null||r[0]==undefined||r.length==0||r[0].SelectRow==undefined)f.records[i.recid].AppliedAmt=0,f.refreshCell(0,"AppliedAmt");else if(r[0].SelectRow==!0){if(et==0?et=f.get(i.recid).C_ConversionType_ID:et!=f.get(i.recid).C_ConversionType_ID&&(h=document.getElementsByName(i.target),h.length>0&&(h=h[0]),e=t(h).find("#grid_openformatgridcash_rec_"+i.recid+""),e.length>0&&(e=e[0]),t(e).find("input:checked").prop("checked")&&t(e).find("input:checked").prop("checked",!1),f.get(i.recid).changes=!1,f.unselect(i.recid),f.columns[u].editable=!1,f.refreshCell(0,"AppliedAmt"),n.ADialog.warn("VIS_ConversionNotMatched")),s.is(":checked")){if(a.val()=="")return n.ADialog.warn("VIS_SlctcnvrsnDate"),f.get(i.recid).changes=!1,f.unselect(i.recid),f.columns[u].editable=!1,f.refreshCell(i.recid,"AppliedAmt"),o=t("#grid_"+f.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(o[i.recid]).prop("checked",!1),f.editChange.call(f,o[i.recid],i.recid,0,i),c={type:"click",phase:"before",target:"grid",recid:i.recid,index:i.recid,isStopped:!1,"isCan//celled":!1,onComplete:null},f.trigger(c),!1;if(l=f.records[i.recid].DATEACCT,p=Globalize.format(new Date(a.val()),"yyyy-MM-dd"),l=Globalize.format(new Date(l),"yyyy-MM-dd"),p!=l)return n.ADialog.warn("VIS_SelectSameDate"),u=f.getColumn("DATEACCT",!0),f.get(i.recid).changes=!1,f.unselect(i.recid),f.columns[u].editable=!1,f.refreshCell(i.recid,"AppliedAmt"),o=t("#grid_"+f.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(o[i.recid]).prop("checked",!1),f.editChange.call(f,o[i.recid],i.recid,0,i),c={type:"click",phase:"before",target:"grid",recid:i.recid,index:i.recid,isStopped:!1,"isCan//celled":!1,onComplete:null},f.trigger(c),!1}}else f.unselect(i.recid),f.columns[u].editable=!1,f.get(0).changes.AppliedAmt="0",f.refreshCell(0,"AppliedAmt");v!=i.column&&i.column!=null||r[0]==undefined||r[0].SelectRow==undefined||(f.records[i.recid].AppliedAmt=n.Utility.Util.getValueOfDecimal(f.get(i.recid).OpenAmt));gu(i.recid,i.column,!1,!0)}}function nl(i){var y,p,f,l,h,v,w,o,e,c,u;if(rr){i.preventDefault();return}if(o=r.getColumn("AppliedAmt",!0),y=r.getColumn("SelectRow",!0),i.column==0||i.column==null){if(p=r.getChanges(),f=t.grep(p,function(n){return parseInt(n.recid)==parseInt(i.recid)}),f==null||f[0]==undefined||f.length==0||f[0].SelectRow==undefined)for(r.records[i.recid].AppliedAmt=0,r.refreshCell(i.recid,"AppliedAmt"),er(),u=0;u<si.length;u++)si[u].recid==i.recid&&si.splice(u,1);else if(f[0].SelectRow==!0){if(et==0?et=r.get(i.recid).C_ConversionType_ID:et!=r.get(i.recid).C_ConversionType_ID&&(l=document.getElementsByName(i.target),l.length>0&&(l=l[0]),h=t(l).find("#grid_openformatglgrid_rec_"+i.recid+""),h.length>0&&(h=h[0]),t(h).find("input:checked").prop("checked")&&t(h).find("input:checked").prop("checked",!1),r.get(i.recid).changes=!1,r.unselect(i.recid),r.columns[o].editable=!1,r.get(i.recid).changes.AppliedAmt="0",r.refreshCell(i.recid,"AppliedAmt"),n.ADialog.warn("VIS_ConversionNotMatched")),s.is(":checked")){if(a.val()=="")return n.ADialog.warn("VIS_SlctcnvrsnDate"),r.get(i.recid).changes=!1,r.unselect(i.recid),r.columns[o].editable=!1,r.get(i.recid).changes.AppliedAmt="0",r.refreshCell(i.recid,"AppliedAmt"),e=t("#grid_"+r.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(e[i.recid]).prop("checked",!1),r.editChange.call(r,e[i.recid],i.recid,0,i),c={type:"click",phase:"before",target:"grid",recid:i.recid,index:i.recid,isStopped:!1,"isCan//celled":!1,onComplete:null},r.trigger(c),!1;if(v=r.records[i.recid].DATEACCT,w=Globalize.format(new Date(a.val()),"yyyy-MM-dd"),v=Globalize.format(new Date(v),"yyyy-MM-dd"),w!=v)return n.ADialog.warn("VIS_SelectSameDate"),o=r.getColumn("DATEACCT",!0),r.get(i.recid).changes=!1,r.unselect(i.recid),r.columns[o].editable=!1,r.get(i.recid).changes.AppliedAmt="0",r.refreshCell(i.recid,"AppliedAmt"),e=t("#grid_"+r.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(e[i.recid]).prop("checked",!1),r.editChange.call(r,e[i.recid],i.recid,0,i),c={type:"click",phase:"before",target:"grid",recid:i.recid,index:i.recid,isStopped:!1,"isCan//celled":!1,onComplete:null},r.trigger(c),!1}if(si.push(f[0]),si.length==1)io=r.get(i.recid).OpenAmount;else if(si.length>1&&(ro=r.get(i.recid).OpenAmount,!(parseFloat(io)>0&&parseFloat(ro)>0)&&!(parseFloat(io)<0&&parseFloat(ro)<0))){for(oi.is(":checked")||n.ADialog.info("",!0,n.translatedTexts.CreditOrDebit),r.get(i.recid).changes=!1,r.unselect(i.recid),r.columns[o].editable=!1,r.get(i.recid).changes.AppliedAmt="0",r.refreshCell(i.recid,"AppliedAmt"),e=t("#grid_"+r.name+'_records td[col="0"]').find('input[type="checkbox"]'),t(e[i.recid]).prop("checked",!1),r.editChange.call(r,e[i.recid],i.recid,0,i),c={type:"click",phase:"before",target:"grid",recid:i.recid,index:i.recid,isStopped:!1,"isCan//celled":!1,onComplete:null},r.trigger(c),u=0;u<si.length;u++)si[u].recid==i.recid&&si.splice(u,1);if(!oi.is(":checked"))return!1}}else r.unselect(i.recid),r.columns[o].editable=!1,r.get(i.recid).changes.AppliedAmt="0",r.refreshCell(i.recid,"AppliedAmt");y!=i.column&&i.column!=null||f[0]==undefined||f[0].SelectRow==undefined||(r.records[i.recid].AppliedAmt=n.Utility.Util.getValueOfDecimal(r.get(i.recid).OpenAmount));ks(i.recid,i.column)}}function tl(t){if(hu){t.preventDefault();return}var r=u.getColumn("AppliedAmt",!0),f=u.getColumn("SelectRow",!0),i=0;if(u.columns[r].editable!=undefined){if(i=t.value_new!=""?t.value_new:i,t.column==r&&(h?i.toString().contains("−")&&(i=(-1*wt.GetConvertedNumber(i,h)).toString()):i.toString().contains("−")||i.toString().contains(",")?i=i.toString().contains("−")?(-1*wt.GetConvertedNumber(i,h)).toString():wt.GetConvertedNumber(i,h).toString():isNaN(i)||(i=wt.GetFormatedValue(i,"init",h).toString()),isNaN(i))){n.ADialog.warn("VIS_ValidAmount");t.preventDefault();return}if(u.getChanges(t.recid)!=undefined&&u.getChanges(t.recid).length>0&&u.get(t.recid).changes){if(n.Utility.Util.getValueOfDecimal(i)>0&&n.Utility.Util.getValueOfDecimal(i)>n.Utility.Util.getValueOfDecimal(u.get(t.recid).OpenAmt)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(u.get(t.recid).OpenAmt)<0&&n.Utility.Util.getValueOfDecimal(i)<n.Utility.Util.getValueOfDecimal(u.get(t.recid).OpenAmt)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(u.get(t.recid).OpenAmt)>0&&n.Utility.Util.getValueOfDecimal(i)<0){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}u.get(t.recid).changes.AppliedAmt=t.value_new!=""?t.value_new:i;u.refreshCell(t.recid,"AppliedAmt")}else t.column>0&&u.set(t.recid,{AppliedAmt:t.value_new!=""?t.value_new:i});if((t.column==f||t.column==null)&&s.is(":checked")&&n.Utility.Util.getValueOfDecimal(u.get(t.recid).OpenAmt)==0){n.ADialog.warn("NotFoundCurrencyRate");t.preventDefault();return}r==t.column&&gu(t.index,t.column,!1,!1)}}function il(t){if(rr){t.preventDefault();return}var i=r.getColumn("AppliedAmt",!0);if(r.columns[i].editable!=undefined){if(r.getChanges(t.recid)!=undefined&&r.getChanges(t.recid).length>0&&r.get(t.recid).changes){if(n.Utility.Util.getValueOfDecimal(t.value_new)>0&&n.Utility.Util.getValueOfDecimal(t.value_new)>n.Utility.Util.getValueOfDecimal(r.get(t.recid).OpenAmount)){r.set(0,{AppliedAmt:n.Utility.Util.getValueOfDecimal(r.get(t.recid).OpenAmount)});n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(r.get(t.recid).OpenAmount)<0&&n.Utility.Util.getValueOfDecimal(t.value_new)<n.Utility.Util.getValueOfDecimal(r.get(t.recid).OpenAmount)){r.set(0,{AppliedAmt:n.Utility.Util.getValueOfDecimal(r.get(t.recid).OpenAmount)});n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}i==t.column&&(r.get(t.recid).changes.AppliedAmt=t.value_new);r.refreshCell(t.recid,"AppliedAmt")}else t.column>0&&r.set(t.recid,{AppliedAmt:t.value_new});t.column==i&&(parseFloat(r.get(t.recid).OpenAmount)>parseFloat(r.get(t.recid).AppliedAmt)||r.set(0,{AppliedAmt:r.get(t.recid).OpenAmount}),ks(t.index,t.column))}}function rl(t){if(ki){t.preventDefault();return}var r=f.getColumn("AppliedAmt",!0),u=f.getColumn("SelectRow",!0),i=0;if(f.columns[r].editable!=undefined){if(i=t.value_new!=""?t.value_new:i,t.column==r&&(h?i.toString().contains("−")&&(i=(-1*wt.GetConvertedNumber(i,h)).toString()):i.toString().contains("−")||i.toString().contains(",")?i=i.toString().contains("−")?(-1*wt.GetConvertedNumber(i,h)).toString():wt.GetConvertedNumber(i,h).toString():isNaN(i)||(i=wt.GetFormatedValue(i,"init",h).toString()),isNaN(i))){n.ADialog.warn("VIS_ValidAmount");t.preventDefault();return}if(f.getChanges(t.recid)!=undefined&&f.getChanges(t.recid).length>0&&f.get(t.recid).changes){if(n.Utility.Util.getValueOfDecimal(i)>0&&n.Utility.Util.getValueOfDecimal(i)>n.Utility.Util.getValueOfDecimal(f.get(t.recid).OpenAmt)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(f.get(t.recid).OpenAmt)<0&&n.Utility.Util.getValueOfDecimal(i)<n.Utility.Util.getValueOfDecimal(f.get(t.recid).OpenAmt)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(f.get(t.recid).OpenAmt)>0&&n.Utility.Util.getValueOfDecimal(i)<0){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}f.get(t.recid).changes.AppliedAmt=t.value_new!=""?t.value_new:i;f.refreshCell(t.recid,"AppliedAmt")}else t.column>0&&f.set(t.recid,{AppliedAmt:t.value_new!=""?t.value_new:i});if((t.column==u||t.column==null)&&s.is(":checked")&&n.Utility.Util.getValueOfDecimal(f.get(t.recid).OpenAmt)==0){n.ADialog.warn("NotFoundCurrencyRate");t.preventDefault();return}r==t.column&&gu(t.index,t.column,!1,!0)}}function ul(t){var u=i.getColumn("AppliedAmt",!0),f=i.getColumn("Writeoff",!0),e=i.getColumn("Discount",!0),v=i.getColumn("SelectRow",!0),c=0,l=0,a=0,r=0;if(i.columns[u].editable!=undefined||i.columns[f].editable!=undefined||i.columns[e].editable!=undefined){if(r=t.value_new!=""?t.value_new:r,t.column==u||t.column==f||t.column==e){if(h?r.toString().contains("−")&&(r=(-1*wt.GetConvertedNumber(r,h)).toString()):r.toString().contains("−")||r.toString().contains(",")?r=r.toString().contains("−")?(-1*wt.GetConvertedNumber(r,h)).toString():wt.GetConvertedNumber(r,h).toString():isNaN(r)||(r=wt.GetFormatedValue(r,"init",h).toString()),isNaN(r)){n.ADialog.warn("VIS_ValidAmount");t.preventDefault();return}l=i.get(t.recid).changes.AppliedAmt!=undefined&&t.column!=u?nt(i.get(t.recid).changes.AppliedAmt,h):r;c=i.get(t.recid).changes.Discount!=undefined&&t.column!=e?nt(i.get(t.recid).changes.Discount,h):r;a=i.get(t.recid).changes.Writeoff!=undefined&&t.column!=f?nt(i.get(t.recid).changes.Writeoff,h):r}if(i.getChanges(t.recid)!=undefined&&i.getChanges(t.recid).length>0&&i.get(t.recid).changes){if(n.Utility.Util.getValueOfDecimal(r)>0&&n.Utility.Util.getValueOfDecimal(r)>n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)<0&&n.Utility.Util.getValueOfDecimal(r)<n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)>0&&n.Utility.Util.getValueOfDecimal(r)<0){n.ADialog.warn("VIS_AppliedAmtleszero");t.preventDefault();return}if(u==t.column){if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)<0&&n.Utility.Util.getValueOfDecimal((n.Utility.Util.getValueOfDecimal(r)+n.Utility.Util.getValueOfDecimal(a)+n.Utility.Util.getValueOfDecimal(c)).toFixed(o))<n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)>0&&n.Utility.Util.getValueOfDecimal((n.Utility.Util.getValueOfDecimal(r)+n.Utility.Util.getValueOfDecimal(a)+n.Utility.Util.getValueOfDecimal(c)).toFixed(o))>n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)>0&&n.Utility.Util.getValueOfDecimal(r)<0){n.ADialog.warn("VIS_AppliedAmtleszero");t.preventDefault();return}i.get(t.recid).changes.AppliedAmt=t.value_new!=""?t.value_new:r;i.refreshCell(t.recid,"AppliedAmt")}else if(f==t.column){if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)<0&&n.Utility.Util.getValueOfDecimal((n.Utility.Util.getValueOfDecimal(r)+n.Utility.Util.getValueOfDecimal(l)+n.Utility.Util.getValueOfDecimal(c)).toFixed(o))<n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)>0&&n.Utility.Util.getValueOfDecimal((n.Utility.Util.getValueOfDecimal(r)+n.Utility.Util.getValueOfDecimal(l)+n.Utility.Util.getValueOfDecimal(c)).toFixed(o))>n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)>0&&n.Utility.Util.getValueOfDecimal(r)<0){n.ADialog.warn("VIS_AppliedAmtleszero");t.preventDefault();return}i.get(t.recid).changes.Writeoff=t.value_new!=""?t.value_new:r;i.refreshCell(t.recid,"Writeoff")}else if(e==t.column){if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)<0&&n.Utility.Util.getValueOfDecimal((n.Utility.Util.getValueOfDecimal(r)+n.Utility.Util.getValueOfDecimal(l)+n.Utility.Util.getValueOfDecimal(a)).toFixed(o))<n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)>0&&n.Utility.Util.getValueOfDecimal((n.Utility.Util.getValueOfDecimal(r)+n.Utility.Util.getValueOfDecimal(l)+n.Utility.Util.getValueOfDecimal(a)).toFixed(o))>n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)){n.ADialog.warn("AppliedAmtgrtr");t.preventDefault();return}if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)>0&&n.Utility.Util.getValueOfDecimal(r)<0){n.ADialog.warn("VIS_AppliedAmtleszero");t.preventDefault();return}i.get(t.recid).changes.Discount=t.value_new!=""?t.value_new:r;i.refreshCell(t.recid,"Discount")}}else t.column>0&&(u==t.column?i.set(t.recid,{AppliedAmt:t.value_new!=""?t.value_new:r}):f==t.column?i.set(t.recid,{Writeoff:t.value_new!=""?t.value_new:r}):e==t.column&&i.set(t.recid,{Discount:t.value_new!=""?t.value_new:r}));if(v==t.column||t.column==null)if(s.is(":checked")){if(n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)==0){n.ADialog.warn("NotFoundCurrencyRate");t.preventDefault();return}i.records[t.recid].AppliedAmt=n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount)}else i.records[t.recid].AppliedAmt=n.Utility.Util.getValueOfDecimal(i.get(t.recid).Amount);(t.column==i.getColumn("Discount",!0)||t.column==i.getColumn("Writeoff",!0)||t.column==i.getColumn("AppliedAmt",!0))&&gu(t.index,t.column,!0,!1)}}function gu(n,t,e,s){var a=n,nt=t,ut,ot,tt,y,v,st,rt,c,it,w,p,b,k,d,g,l;if((nt==null||nt==undefined)&&(nt=0),ut=null,e||s){if(s){if(nt==0)if(y=f.columns,hs=nf(f.getChanges(),a),fo=ci(y,"AppliedAmt"),tt=y[fo].field,v=f.get(a).changes,hs)c=f.records[a],it={SelectRow:c.SelectRow,Date1:c.Date1,ReceiptNo:c.ReceiptNo,VSS_paymenttype:c.VSS_paymenttype,Isocode:c.Isocode,CcashlineiID:c.CcashlineiID,Amount:c.Amount,OpenAmt:c.OpenAmt,Payment:c.Payment,Multiplierap:c.Multiplierap,DocBaseType:c.DocBaseType,ConvertedAmount:c.ConvertedAmount,AppliedAmt:c.AppliedAmt,C_ConversionType_ID:c.C_ConversionType_ID,ConversionName:c.ConversionName,DATEACCT:c.DATEACCT,AD_Org_ID:c.AD_Org_ID,OrgName:c.OrgName},vt.push(it),bo=ci(y,"OpenAmt"),w=parseFloat(f.get(a)[y[bo].field]),_value=de(parseFloat(w).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o}),h?",":"."),tt=="AppliedAmt"&&(v!=null&&v!=undefined?(v.AppliedAmt=_value,f.refreshCell(a,"AppliedAmt")):f.set(a,{AppliedAmt:_value}));else{for(p=0;p<vt.length;p++)vt[p].CcashlineiID==f.records[a].CcashlineiID&&vt.splice(p,1);for(tt=="AppliedAmt"&&v!=null&&v!=undefined&&(v.AppliedAmt=w,f.records[a].AppliedAmt=0,f.refreshCell(a,"AppliedAmt")),b=!1,l=0;l<i.getChanges().length;l++)i.getChanges()[l].SelectRow==undefined||i.getChanges()[l].SelectRow==!1||(b=!0);for(k=!1,l=0;l<f.getChanges().length;l++)f.getChanges()[l].SelectRow==undefined||f.getChanges()[l].SelectRow==!1||(k=!0);for(d=!1,l=0;l<u.getChanges().length;l++)u.getChanges()[l].SelectRow==undefined||u.getChanges()[l].SelectRow==!1||(d=!0);for(g=!1,l=0;l<r.getChanges().length;l++)r.getChanges()[l].SelectRow==undefined||r.getChanges()[l].SelectRow==!1||(g=!0);g||b||k||d||(et=0);f.columns[fo].editable=!1}}else if(nt==0)if(y=i.columns,os=nf(i.getChanges(),a),v=i.get(a).changes,ae=ci(y,"Writeoff"),st=y[ae].field,hf=ci(y,"AppliedAmt"),rt=y[hf].field,os)c=i.records[a],it={SelectRow:c.SelectRow,InvoiceRecord:c.InvoiceRecord,Date1:c.Date1,Documentno:c.Documentno,CinvoiceID:c.CinvoiceID,Isocode:c.Isocode,Currency:c.Currency,Converted:c.Converted,Amount:c.Amount,Discount:c.Discount,Multiplierap:c.Multiplierap,DocBaseType:c.DocBaseType,Writeoff:c.Writeoff,AppliedAmt:c.AppliedAmt,C_InvoicePaySchedule_ID:c.C_InvoicePaySchedule_ID,InvoiceScheduleDate:c.InvoiceScheduleDate,C_ConversionType_ID:c.C_ConversionType_ID,ConversionName:c.ConversionName,DATEACCT:c.DATEACCT,AD_Org_ID:c.AD_Org_ID,OrgName:c.OrgName,PayName:c.PayName},ft.push(it),le=ci(y,"Amount"),w=parseFloat(i.get(a)[y[le].field]),ou=ci(y,"Discount"),w=w-parseFloat(i.get(a)[y[ou].field]),_value=de(parseFloat(w).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o}),h?",":"."),rt=="AppliedAmt"&&(v!=null&&v!=undefined?(v.Writeoff=0,v.AppliedAmt=_value,ou=ci(y,"Discount"),v.Discount=de(parseFloat(i.get(a)[y[ou].field]).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o}),h?",":"."),i.refreshCell(a,"Writeoff"),i.refreshCell(a,"AppliedAmt"),i.refreshCell(a,"Discount")):(i.set(a,{Writeoff:0}),i.set(a,{AppliedAmt:_value})));else{for(p=0;p<ft.length;p++)ft[p].C_InvoicePaySchedule_ID==i.records[a].C_InvoicePaySchedule_ID&&ft.splice(p,1);for(rt=="AppliedAmt"&&v!=null&&v!=undefined&&(v.Writeoff=w,v.AppliedAmt=w,v.Discount=w,ou=ci(y,"Discount"),i.records[a].AppliedAmt=0,i.refreshCell(a,"Writeoff"),i.refreshCell(a,"AppliedAmt"),i.refreshCell(a,"Discount")),b=!1,l=0;l<i.getChanges().length;l++)i.getChanges()[l].SelectRow==undefined||i.getChanges()[l].SelectRow==!1||(b=!0);for(k=!1,l=0;l<f.getChanges().length;l++)f.getChanges()[l].SelectRow==undefined||f.getChanges()[l].SelectRow==!1||(k=!0);for(d=!1,l=0;l<u.getChanges().length;l++)u.getChanges()[l].SelectRow==undefined||u.getChanges()[l].SelectRow==!1||(d=!0);for(g=!1,l=0;l<r.getChanges().length;l++)r.getChanges()[l].SelectRow==undefined||r.getChanges()[l].SelectRow==!1||(g=!0);g||b||k||d||(et=0);i.columns[hf].editable=!1}}else if(nt==0)if(y=u.columns,ss=nf(u.getChanges(),a),ce=ci(y,"AppliedAmt"),tt=y[ce].field,v=u.get(a).changes,ss)c=u.records[a],it={SelectRow:c.SelectRow,Date1:c.Date1,Documentno:c.Documentno,CpaymentID:c.CpaymentID,Isocode:c.Isocode,ConvertedAmount:c.ConvertedAmount,OpenAmt:c.OpenAmt,Payment:c.Payment,Multiplierap:c.Multiplierap,DocBaseType:c.DocBaseType,AppliedAmt:c.AppliedAmt,C_ConversionType_ID:c.C_ConversionType_ID,ConversionName:c.ConversionName,DATEACCT:c.DATEACCT,AD_Org_ID:c.AD_Org_ID,OrgName:c.OrgName,PayName:c.PayName},ct.push(it),ko=ci(y,"OpenAmt"),w=parseFloat(u.get(a)[y[ko].field]),_value=de(parseFloat(w).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o}),h?",":"."),ot=ci(y,"Date1"),ut=new Date(u.get(a)[y[ot].field]),tt=="AppliedAmt"&&(v!=null&&v!=undefined?(v.AppliedAmt=_value,u.refreshCell(a,"AppliedAmt")):u.set(a,{AppliedAmt:_value}));else{for(p=0;p<ct.length;p++)ct[p].CpaymentID==u.records[a].CpaymentID&&ct.splice(p,1);for(tt=="AppliedAmt"&&v!=null&&v!=undefined&&(v.AppliedAmt=w,u.records[a].AppliedAmt=0,u.refreshCell(a,"AppliedAmt")),b=!1,l=0;l<i.getChanges().length;l++)i.getChanges()[l].SelectRow==undefined||i.getChanges()[l].SelectRow==!1||(b=!0);for(k=!1,l=0;l<f.getChanges().length;l++)f.getChanges()[l].SelectRow==undefined||f.getChanges()[l].SelectRow==!1||(k=!0);for(d=!1,l=0;l<u.getChanges().length;l++)u.getChanges()[l].SelectRow==undefined||u.getChanges()[l].SelectRow==!1||(d=!0);for(g=!1,l=0;l<r.getChanges().length;l++)r.getChanges()[l].SelectRow==undefined||r.getChanges()[l].SelectRow==!1||(g=!0);g||b||k||d||(et=0);u.columns[ce].editable=!1}rf()}function ci(n,t){for(var r=0,i=0;i<n.length;i++)if(n[i].field==t){r=i;break}return r}function ks(n,t){var s=n,l=t,g,a,p,h,o,v,nt,y,c,w,b,k,d,e;if((l==null||l==undefined)&&(l=0),g=null,l==0)if(a=r.columns,wo=nf(r.getChanges(),s),p=a[10].field,r.get(s)&&(h=r.get(s).changes),wo){for(o=null,v=0;r.records.length;v++)if(r.records[v].recid==parseInt(s)){o=r.records[v];break}nt={SelectRow:o.SelectRow,GLRecords:h.GLRecords,Date1:o.Date1,DOCUMENTNO:o.DOCUMENTNO,Account:o.Account,DATEDOC:o.DATEDOC,Isocode:o.Isocode,GL_JOURNALLINE_ID:o.GL_JOURNALLINE_ID,GL_Journal_ID:o.GL_Journal_ID,OpenAmount:o.OpenAmount,ConvertedAmount:o.ConvertedAmount,AppliedAmt:o.AppliedAmt,C_ConversionType_ID:o.C_ConversionType_ID,ConversionName:o.ConversionName,DATEACCT:o.DATEACCT,AD_Org_ID:o.AD_Org_ID,OrgName:o.OrgName};ut.push(nt);y=parseFloat(r.get(s)[a[9].field]);g=new Date(r.get(s)[a[11].field]);p=="AppliedAmt"&&h!=null&&h!=undefined&&(h.AppliedAmt=y,r.set(s,{AppliedAmt:y}),r.refreshCell(s,"AppliedAmt"))}else{for(c=0;c<ut.length;c++)ut[c].GL_JOURNALLINE_ID==r.records[s].GL_JOURNALLINE_ID&&ut.splice(c,1);for(p=="AppliedAmt"&&h!=null&&h!=undefined&&(h.AppliedAmt=y,r.records[s].AppliedAmt=0,r.refreshCell(s,"AppliedAmt")),w=!1,e=0;e<i.getChanges().length;e++)i.getChanges()[e].SelectRow==undefined||i.getChanges()[e].SelectRow==!1||(w=!0);for(b=!1,e=0;e<f.getChanges().length;e++)f.getChanges()[e].SelectRow==undefined||f.getChanges()[e].SelectRow==!1||(b=!0);for(k=!1,e=0;e<u.getChanges().length;e++)u.getChanges()[e].SelectRow==undefined||u.getChanges()[e].SelectRow==!1||(k=!0);for(d=!1,e=0;e<r.getChanges().length;e++)r.getChanges()[e].SelectRow==undefined||r.getChanges()[e].SelectRow==!1||(d=!0);d||w||b||k||(et=0)}rf()}function nf(n,i){if(n==null||n.length==0)return!1;var r=t.grep(n,function(n){return parseInt(n.recid)==i});return r==null||r[0]==undefined||r.length==0||r[0].SelectRow==undefined?!1:r[0].SelectRow}function fl(){tf(p.getName(),p.value)}function el(){tf(pt.getName(),pt.getValue())}function er(){var n,t,e,o;for(dt=[],_dateAcct=[],n=0;n<u.getChanges().length;n++)u.getChanges()[n].SelectRow===undefined||u.getChanges()[n].SelectRow==!0&&(t=u.records[u.getChanges()[n].recid].DATEACCT,dt.push(new Date(t)),e=u.records[u.getChanges()[n].recid].DATEACCT,_dateAcct.push(new Date(e)),ui.val(Globalize.format(new Date(Math.max.apply(null,_dateAcct)),"yyyy-MM-dd")));for(n=0;n<i.getChanges().length;n++)i.getChanges()[n].SelectRow===undefined||i.getChanges()[n].SelectRow==!0&&(t=i.records[i.getChanges()[n].recid].Date1,dt.push(new Date(t)),u.getChanges().length==0&&f.getChanges().length==0&&r.getChanges().length==0&&(e=i.records[i.getChanges()[n].recid].DATEACCT,_dateAcct.push(new Date(e)),ui.val(Globalize.format(new Date(Math.max.apply(null,_dateAcct)),"yyyy-MM-dd"))));for(n=0;n<f.getChanges().length;n++)f.getChanges()[n].SelectRow===undefined||f.getChanges()[n].SelectRow==!0&&(t=f.records[f.getChanges()[n].recid].DATEACCT,dt.push(new Date(t)),u.getChanges().length==0&&i.getChanges().length==0&&r.getChanges().length==0&&(e=f.records[f.getChanges()[n].recid].DATEACCT,_dateAcct.push(new Date(e)),ui.val(Globalize.format(new Date(Math.max.apply(null,_dateAcct)),"yyyy-MM-dd"))));for(n=0;n<r.getChanges().length;n++)if(r.getChanges()[n].SelectRow!==undefined&&r.getChanges()[n].SelectRow==!0){for(t=null,o=0;r.records.length;o++)if(r.records[o].recid==r.getChanges()[n].recid){t=r.records[o].DATEACCT;break}if(dt.push(new Date(t)),u.getChanges().length==0&&f.getChanges().length==0&&i.getChanges().length==0){for(e=null,o=0;r.records.length;o++)if(r.records[o].recid==r.getChanges()[n].recid){e=r.records[o].DATEACCT;break}_dateAcct.push(new Date(e));ui.val(Globalize.format(new Date(Math.max.apply(null,_dateAcct)),"yyyy-MM-dd"))}}ur=new Date(Math.max.apply(null,dt));(dt.length==0||dt=="Invalid Date")&&(ur=new Date);ui.val(Globalize.format(ur,"yyyy-MM-dd"))}function yu(){if(at>0){var i=s.is(":checked");if(g=st.val(),g==0)return n.ADialog.info("Message",!0,"select currency","");if(AD_Org_ID=gt.val(),y=ir.val(),c=wi.val(),srchText=lf.val(),v[0].style.visibility="visible",dr=1,vu=1,kf=0,iu=!1,c!=""&&y>c)return wi.val(""),n.ADialog.info("Message",!0,n.Msg.getMsg("VIS_FromDateGreater"),"");y!=null&&y!=undefined&&y!=""&&n.DB.to_date(y);c!=null&&c!=undefined&&c!=""&&n.DB.to_date(c);t.ajax({url:n.Application.contextUrl+"VIS/PaymentAllocation/GetGLData",dataType:"json",data:{AD_Org_ID:AD_Org_ID,_C_Currency_ID:g,_C_BPartner_ID:at,page:dr,size:fi,fromDate:y,toDate:c,srchText:srchText,chk:i,isInterComp:fr},async:!0,success:function(n){var t=JSON.parse(n),r,u;if(t){if(dr==1&&t.length>0&&(kf=t[0].GLRecords,vu=Math.ceil(kf/fi)),ut.length>0){for(lr=ut.length,r=0;r<t.length;r++)u=ut.filter(function(n){return n.GL_JOURNALLINE_ID==t[r].GL_JOURNALLINE_ID}),u.length==0&&(t[r].recid=ut.length+r,ut.push(t[r]));t=ut;ut=[]}ys(t,i);of.find("#grid_openformatglgrid_"+e.windowNo+"_records").on("scroll",co);iu=!0;we()}},error:function(){v[0].style.visibility="hidden"}})}}function ds(){var n,t;for(dt=[],ru=!0,n=0;n<u.getChanges().length;n++)u.getChanges()[n].SelectRow===undefined||u.getChanges()[n].SelectRow==!0&&(t=u.records[u.getChanges()[n].recid].DATEACCT,ru&&parseInt(d.val())!=parseInt(u.records[u.getChanges()[n].recid].AD_Org_ID)&&(ru=!1),dt.push(new Date(t)));for(n=0;n<i.getChanges().length;n++)i.getChanges()[n].SelectRow===undefined||i.getChanges()[n].SelectRow==!0&&(t=i.records[i.getChanges()[n].recid].Date1,ru&&parseInt(d.val())!=parseInt(i.records[i.getChanges()[n].recid].AD_Org_ID)&&(ru=!1),dt.push(new Date(t)));for(n=0;n<f.getChanges().length;n++)f.getChanges()[n].SelectRow===undefined||f.getChanges()[n].SelectRow==!0&&(t=f.records[f.getChanges()[n].recid].DATEACCT,ru&&parseInt(d.val())!=parseInt(f.records[f.getChanges()[n].recid].AD_Org_ID)&&(ru=!1),dt.push(new Date(t)));for(n=0;n<r.getChanges().length;n++)r.getChanges()[n].SelectRow===undefined||r.getChanges()[n].SelectRow==!0&&(t=r.records[r.getChanges()[n].recid].DATEACCT,dt.push(new Date(t)));return dt.length==0?!1:!0}function tf(n,t){if(n!="C_BPartner_ID"&&t==null){k();b();return}n=="C_BPartner_ID"?(at=t,at>0&&p.getControl().removeClass("vis-ev-col-mandatory")):n=="C_Currency_ID"?g=parseInt(t):n=="Date"&&s&&po()}function rf(){var tt,p,w,b,k,nt,d,e,y,it,t,s,rt;v[0].style.visibility="visible";tt=n.DisplayType.GetNumberFormat(n.DisplayType.Amount);p=new Date;p=null;w=parseFloat(0);ho=0;var l=null,a=null,c=null,g=null;if(u&&(l=u.getChanges()),f&&(a=f.getChanges()),i&&(c=i.getChanges()),r&&(g=r.getChanges()),l!=null){for(e=0;e<l.length;e++)if(l[e].SelectRow==!0){var y=u.get(l[e].recid),nt=new Date(y.Date1),it=new n.TimeUtil;p=it.max(p,nt);t=Object.keys(y);l[e][t[t.indexOf("AppliedAmt")]]!=""&&l[e][t[t.indexOf("AppliedAmt")]]!=undefined?(s=l[e][t[t.indexOf("AppliedAmt")]].toString().contains("-")||l[e][t[t.indexOf("AppliedAmt")]].toString().contains("−")?(-1*Math.abs(tt.GetConvertedNumber(l[e][t[t.indexOf("AppliedAmt")]].toString(),h))).toFixed(o):tt.GetConvertedNumber(l[e][t[t.indexOf("AppliedAmt")]].toString(),h).toFixed(o),s=parseFloat(s)):(s=0,console.log("Payment Row: "+l[e][t[t.indexOf("AppliedAmt")]]+", RowNo:-"+e));w=w+(isNaN(s)?0:s);ho++}w=w.toFixed(o);w=parseFloat(w)}if(eo.text(ho+" "+n.Msg.getMsg("SelectedLines")+" - "+ri+" "+parseFloat(w).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})+" "),b=parseFloat(0),ve=0,a!=null){for(e=0;e<a.length;e++)if(a[e].SelectRow==!0){var y=f.get(a[e].recid),nt=new Date(y.Created),it=new n.TimeUtil;p=it.max(p,nt);t=Object.keys(y);a[e][t[t.indexOf("AppliedAmt")]]!=""&&a[e][t[t.indexOf("AppliedAmt")]]!=undefined?(s=a[e][t[t.indexOf("AppliedAmt")]].toString().contains("-")||a[e][t[t.indexOf("AppliedAmt")]].toString().contains("−")?(-1*Math.abs(tt.GetConvertedNumber(a[e][t[t.indexOf("AppliedAmt")]].toString(),h))).toFixed(o):tt.GetConvertedNumber(a[e][t[t.indexOf("AppliedAmt")]].toString(),h).toFixed(o),s=parseFloat(s)):(s=0,console.log("Cash Row: "+a[e][t[t.indexOf("AppliedAmt")]]+", RowNo:-"+e));b=b+(isNaN(s)?0:s);ve++}b=b.toFixed(o);b=parseFloat(b)}if(oo.text(ve+" "+n.Msg.getMsg("SelectedLines")+" - "+ri+" "+parseFloat(b).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})+" "),k=parseFloat(0),cf=0,c!=null){for(e=0;e<c.length;e++)c[e].SelectRow==!0&&(y=i.get(c[e].recid),nt=ku>0?new Date(y.InvoiceScheduleDate):new Date(y.Date1),nt=="Invalid Date"&&(nt=new Date(y.Date1)),it=new n.TimeUtil,p=it.max(p,nt),t=Object.keys(y),c[e][t[t.indexOf("AppliedAmt")]]!=""&&c[e][t[t.indexOf("AppliedAmt")]]!=undefined?(s=c[e][t[t.indexOf("AppliedAmt")]].toString().contains("-")||c[e][t[t.indexOf("AppliedAmt")]].toString().contains("−")?(-1*Math.abs(tt.GetConvertedNumber(c[e][t[t.indexOf("AppliedAmt")]].toString(),h))).toFixed(o):tt.GetConvertedNumber(c[e][t[t.indexOf("AppliedAmt")]].toString(),h).toFixed(o),s=parseFloat(s)):(s=0,console.log("Invoice Row: "+c[e][t[t.indexOf("AppliedAmt")]]+", RowNo:-"+e)),k=k+(isNaN(s)?0:s),cf++);k=k.toFixed(o);k=parseFloat(k)}if(so.text(cf+" "+n.Msg.getMsg("SelectedLines")+" - "+ri+" "+parseFloat(k).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})+" "),d=parseFloat(0),to=0,g!=null){for(e=0;e<g.length;e++)g[e].SelectRow==!0&&(y=r.get(g[e].recid),nt=new Date(y.Date1),it=new n.TimeUtil,p=it.max(p,nt),t=Object.keys(y),g[e][t[t.indexOf("AppliedAmt")]]!=""&&g[e][t[t.indexOf("AppliedAmt")]]!=undefined?(s=parseFloat(g[e][t[t.indexOf("AppliedAmt")]]).toFixed(o),s=parseFloat(s)):(s=0,console.log("GL Row: "+c[e][t[t.indexOf("AppliedAmt")]]+", RowNo:-"+e)),d=d+(isNaN(s)?0:s),to++);d=d.toFixed(o);d=parseFloat(d)}fe.text(to+" "+n.Msg.getMsg("SelectedLines")+" - "+ri+" "+parseFloat(d).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o})+" ");st.children("option").filter(":selected").text()!=null&&ls.text(st.children("option").filter(":selected").text());rt=parseFloat(w+b-(k+d)).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o});ye.text(rt);parseFloat(rt)==parseFloat(0)?(su.prop("readonly",!1),su.css({"pointer-events":"auto",opacity:"1"})):(su.prop("readonly",!0),su.css({"pointer-events":"none",opacity:"0.5"}));v[0].style.visibility="hidden"}function po(){var i=parseFloat(0).toLocaleString(navigator.language,{minimumFractionDigits:o,maximumFractionDigits:o});eo.text("0 "+n.Msg.getMsg("SelectedLines")+" - "+ri+" "+i+" ");oo.text("0 "+n.Msg.getMsg("SelectedLines")+" - "+ri+" "+i+" ");so.text("0 "+n.Msg.getMsg("SelectedLines")+" - "+ri+" "+i+" ");fe.text("0 "+n.Msg.getMsg("SelectedLines")+" - "+ri+" "+i+" ");ye.text(i);bi.prop("checked",!1);hr.prop("checked",!1);cr.prop("checked",!1);oi.prop("checked",!1);t(".vis-allocation-payment-grid, .vis-allocation-cashLine-grid, .vis-allocation-invoice-grid, .vis-allocation-gl-grid").css("height","80%");t("#cashMaindiv").css("display","none");t("#glMaindiv").css("display","none");s.is(":checked")?(he.css("display","block"),w.val()=="I"&&l.val()=="P"||w.val()=="P"&&l.val()=="I"||w.val()=="I"&&l.val()=="I"?it.find(".vis-conversionType").css("display","block"):(it.find(".vis-conversionType").css("display","none"),pt.getControl().val(""))):(he.css("display","none"),it.find(".vis-conversionType").css("display","none"),pt.getControl().val(""))}function gs(){var i,r,n,e,t;if(u!=undefined&&(i=u.getChanges()),f!=undefined&&(r=f.getChanges()),hr.prop("checked",!1),cr.prop("checked",!1),ue.prop("checked",!1),ki){if(ki=!0,hu=!1,r!=null){for(n=0;n<r.length;n++)e=nf(f.getChanges(),r[n].recid),e&&(t=f.get(r[n].recid).changes,t!=null&&t!=undefined&&(t.SelectRow=!1,t.AppliedAmt=0,f.refreshCell(r[n].recid,"SelectRow"),f.refreshCell(r[n].recid,"AppliedAmt")));f&&f.refresh()}ot.css("display","none");rt.css("display","");u&&u.refresh()}else{if(ki=!1,hu=!0,i!=null){for(n=0;n<i.length;n++)e=nf(u.getChanges(),i[n].recid),e&&(t=u.get(i[n].recid).changes,t!=null&&t!=undefined&&(t.SelectRow=!1,t.AppliedAmt=0,u.refreshCell(i[n].recid,"SelectRow"),u.refreshCell(i[n].recid,"AppliedAmt")));u&&u.refresh()}rt.css("display","none");ot.css("display","");f&&f.refresh()}rf()}function nh(){var i=!0,t;yf>vf?(t=yf-vf,yf*.05<=t&&(i=!1,n.ADialog.confirm("AllocationWriteOffWarn",!0,"","Confirm",function(n){n&&th()}))):vf>yf&&(t=vf-yf,vf*.05>=t&&(i=n.ADialog.error("AllocationWriteOffWarn")));i&&th()}function th(){v[0].style.visibility="visible";var o=u.getChanges(),s=f.getChanges(),n=i.getChanges(),h=r.getChanges(),t=ht.val(),e=ui.val();w.val()=="G"||l.val()=="G"?hl(o,n,s,h,t,e):w.val()=="C"||l.val()=="C"?ol(s,n,t,e):sl(o,n,t,e)}function ol(r,u,e,o){if(cf+ve==0)return"";t.ajax({url:n.Application.contextUrl+"PaymentAllocation/CheckPeriodState",data:{DateTrx:ui.val(),AD_Org_ID:d.val()},async:!1,success:function(e){var vt,k,l,y,c,w,p,b;if(e!="")return n.ADialog.info("",!0,e,""),yr=!0,du(),v[0].style.visibility="hidden","";var rt="",g="",ut="",et="",ot="",tt=0,ct=[],it=[],lt=s.is(":checked");if(vt=lt?Globalize.format(new Date(a.val()),"yyyy-MM-dd"):Globalize.format(new Date,"yyyy-MM-dd"),r.length>0)for(l=Object.keys(f.get(0)),rt=l[l.indexOf("AppliedAmt")],g=l[l.indexOf("AppliedAmt")],y=0;y<r.length;y++)c=f.get(r[y].recid),tt=parseInt(c.C_ConversionType_ID),r[y].AppliedAmt!=0&&r[y].AppliedAmt!=undefined&&(k=r[y].AppliedAmt,k=nt(k,h),ct.push({AppliedAmt:k,Date:c.Created,Amount:c.Amount,ccashlineid:c.CcashlineiID,Converted:c.ConvertedAmount,Isocode:c.Isocode,Multiplierap:c.Multiplierap,OpenAmt:c.OpenAmt,ReceiptNo:c.ReceiptNo,Org:parseInt(d.val())}));if(u.length>0)for(l=Object.keys(i.get(0)),g=l[l.indexOf("AppliedAmt")],ut=l[l.indexOf("Discount")],et=l[l.indexOf("Writeoff")],ot=l[l.indexOf("Amount")],y=0;y<u.length;y++)c=i.get(u[y].recid),tt=parseInt(c.C_ConversionType_ID),w=u[y].Discount,w==undefined&&(w=c.Discount),p=u[y].AppliedAmt,p==undefined&&(p=c.AppliedAmt),b=u[y].Writeoff,b==undefined&&(b=c.Writeoff),p!=0&&p!=undefined&&(p=nt(p,h),w=nt(w,h),b=nt(b,h),ku<=0?it.push({AppliedAmt:p,Discount:w,Writeoff:b,cinvoiceid:c.CinvoiceID,Converted:c.Converted,Currency:c.Currency,Date:c.Date1,Docbasetype:c.DocBaseType,documentno:c.Documentno,Isocode:c.Isocode,Multiplierap:c.Multiplierap,Amount:c.Amount,Org:parseInt(d.val())}):it.push({AppliedAmt:p,Discount:w,Writeoff:b,cinvoiceid:c.CinvoiceID,Converted:c.Converted,Currency:c.Currency,Date:c.InvoiceScheduleDate,Docbasetype:c.DocBaseType,documentno:c.Documentno,Isocode:c.Isocode,Multiplierap:c.Multiplierap,Amount:c.Amount,c_invoicepayschedule_id:c.C_InvoicePaySchedule_ID,Org:parseInt(d.val())}));t.ajax({url:n.Application.contextUrl+"PaymentAllocation/SaveCashData",type:"POST",data:{cashData:JSON.stringify(ct),invoiceData:JSON.stringify(it),currency:st.val(),isCash:!0,_C_BPartner_ID:at,_windowNo:pr.windowNo,payment:rt,DateTrx:ht.val(),appliedamt:g,discount:ut,writeOff:et,open:ot,DateAcct:o,_CurrencyType_ID:tt,isInterBPartner:!1,conversionDate:vt,chk:lt},success:function(t){ft=[];n.ADialog.info("",!0,t,"");yr=!0;du();v[0].style.visibility="hidden"},error:function(t){n.ADialog.info("",!0,t,"");v[0].style.visibility="hidden"}})},error:function(t){n.ADialog.info("",!0,t,"");v[0].style.visibility="hidden"}})}function sl(r,f,e,o){if(cf+ce==0)return"";t.ajax({url:n.Application.contextUrl+"PaymentAllocation/CheckPeriodState",data:{DateTrx:ht.val(),AD_Org_ID:d.val()},async:!1,success:function(e){var yt,g,y,l,c,w,p,b,wt;if(e!="")return n.ADialog.info("",!0,e,""),yr=!0,du(),v[0].style.visibility="hidden","";var tt="",ut="",et="",ot="",lt="",it=0,vt=[],rt=[],k=s.is(":checked");for(yt=k?Globalize.format(new Date(a.val()),"yyyy-MM-dd"):Globalize.format(new Date,"yyyy-MM-dd"),l=0;l<r.length;l++)c=u.get(r[l].recid),y=Object.keys(u.get(0)),tt=y[y.indexOf("AppliedAmt")],it=k?pt.getValue():parseInt(c.C_ConversionType_ID),r[l].AppliedAmt!=undefined&&r[l].AppliedAmt!=0&&(g=r[l].AppliedAmt,g=nt(g,h),vt.push({appliedamt:g,date:c.Date1,converted:c.ConvertedAmount,cpaymentid:c.CpaymentID,documentno:c.Documentno,isocode:c.Isocode,multiplierap:c.Multiplierap,openamt:c.OpenAmt,payment:c.Payment,Org:parseInt(d.val())}));if(f.length>0)for(y=Object.keys(i.get(0)),ut=y[y.indexOf("AppliedAmt")],tt=y[y.indexOf("AppliedAmt")],et=y[y.indexOf("Discount")],ot=y[y.indexOf("Writeoff")],lt=y[y.indexOf("Amount")],l=0;l<f.length;l++)c=i.get(f[l].recid),it=k?pt.getValue():parseInt(c.C_ConversionType_ID),w=f[l].Discount,w==undefined&&(w=c.Discount),p=f[l].AppliedAmt,p==undefined&&(p=c.AppliedAmt),b=f[l].Writeoff,b==undefined&&(b=c.Writeoff),p!=0&&p!=undefined&&(p=nt(p,h),w=nt(w,h),b=nt(b,h),ku<=0?rt.push({appliedamt:p,discount:w,writeoff:b,cinvoiceid:c.CinvoiceID,converted:c.Converted,currency:c.Currency,date:c.Date1,docbasetype:c.DocBaseType,documentno:c.Documentno,isocode:c.Isocode,multiplierap:c.Multiplierap,amount:c.Amount,Org:parseInt(d.val())}):rt.push({appliedamt:p,discount:w,writeoff:b,cinvoiceid:c.CinvoiceID,converted:c.Converted,currency:c.Currency,date:c.InvoiceScheduleDate,docbasetype:c.DocBaseType,DocumentNo:c.Documentno,Isocode:c.Isocode,Multiplierap:c.Multiplierap,Amount:c.Amount,c_invoicepayschedule_id:c.C_InvoicePaySchedule_ID,Org:parseInt(d.val())}));wt=!1;ki||(wt=!0);t.ajax({url:n.Application.contextUrl+"PaymentAllocation/SavePaymentData",type:"POST",data:{paymentData:JSON.stringify(vt),invoiceData:JSON.stringify(rt),currency:st.val(),_C_BPartner_ID:at,_windowNo:pr.windowNo,payment:tt,DateTrx:ht.val(),appliedamt:ut,discount:et,writeOff:ot,open:lt,DateAcct:o,_CurrencyType_ID:it,isInterBPartner:!1,conversionDate:yt,chk:k},success:function(t){ft=[];ct=[];yr=!0;du();n.ADialog.info("",!0,t,"");v[0].style.visibility="hidden"},error:function(){n.ADialog.info("",!0,e,"");v[0].style.visibility="hidden"}})},error:function(t){n.ADialog.info("",!0,t,"");v[0].style.visibility="hidden"}})}function hl(e,o,c,l){t.ajax({url:n.Application.contextUrl+"VIS/PaymentAllocation/CheckPeriodState",data:{DateTrx:ht.val(),AD_Org_ID:d.val()},async:!1,success:function(t){var yt,k,w,g,b,tt,p,y;if(t!="")return n.ADialog.info("",!0,t,""),yr=!0,du(),v[0].style.visibility="hidden","";v[0].style.visibility="visible";var it="",ut="",ft="",et="",ot="",rt=0,ct=[],lt=[],at=[],st=[],vt=s.is(":checked");if(yt=vt?Globalize.format(new Date(a.val()),"yyyy-MM-dd"):Globalize.format(new Date,"yyyy-MM-dd"),e.length>0)for(w=Object.keys(u.get(0)),it=w[w.indexOf("AppliedAmt")],p=0;p<e.length;p++)y=u.get(e[p].recid),rt=parseInt(y.C_ConversionType_ID),e[p].AppliedAmt!=undefined&&e[p].AppliedAmt!=0&&(k=e[p].AppliedAmt,k=nt(k,h),ct.push({AppliedAmt:k,Date:y.Date1,Converted:y.ConvertedAmount,cpaymentid:y.CpaymentID,Documentno:y.Documentno,Isocode:y.Isocode,Multiplierap:y.Multiplierap,OpenAmt:y.OpenAmt,Payment:y.Payment,Org:parseInt(d.val()),IsPaid:!1,paidAmt:0,payment:it}));if(c.length>0)for(w=Object.keys(f.get(0)),it=w[w.indexOf("AppliedAmt")],p=0;p<c.length;p++)y=f.get(c[p].recid),rt=parseInt(y.C_ConversionType_ID),c[p].AppliedAmt!=0&&c[p].AppliedAmt!=undefined&&(k=c[p].AppliedAmt,k=nt(k,h),lt.push({AppliedAmt:k,Date:y.Created,Amount:y.Amount,ccashlineid:y.CcashlineiID,Converted:y.ConvertedAmount,Isocode:y.Isocode,Multiplierap:y.Multiplierap,OpenAmt:y.OpenAmt,ReceiptNo:y.ReceiptNo,Org:parseInt(d.val()),IsPaid:!1,paidAmt:0,payment:it}));if(o.length>0)for(w=Object.keys(i.get(0)),ut=w[w.indexOf("AppliedAmt")],ft=w[w.indexOf("Discount")],et=w[w.indexOf("Writeoff")],ot=w[w.indexOf("Amount")],p=0;p<o.length;p++)y=i.get(o[p].recid),rt=parseInt(y.C_ConversionType_ID),g=o[p].Discount,g==undefined&&(g=y.Discount),b=o[p].AppliedAmt,b==undefined&&(b=y.AppliedAmt),tt=o[p].Writeoff,tt==undefined&&(tt=y.Writeoff),b!=0&&b!=undefined&&(b=nt(b,h),g=nt(g,h),tt=nt(tt,h),ku<=0?st.push({AppliedAmt:b,Discount:g,Writeoff:tt,cinvoiceid:y.CinvoiceID,Converted:y.Converted,Currency:y.Currency,Date:y.Date1,Docbasetype:y.DocBaseType,applied:ut,discount:ft,open:ot,writeOff:et,documentno:y.Documentno,Isocode:y.Isocode,Multiplierap:y.Multiplierap,Amount:y.Amount,Org:parseInt(d.val()),IsPaid:!1,paidAmt:0}):st.push({AppliedAmt:b,Discount:g,Writeoff:tt,cinvoiceid:y.CinvoiceID,Converted:y.Converted,Currency:y.Currency,Date:y.InvoiceScheduleDate,Docbasetype:y.DocBaseType,applied:ut,discount:ft,open:ot,writeOff:et,documentno:y.Documentno,Isocode:y.Isocode,Multiplierap:y.Multiplierap,Amount:y.Amount,c_invoicepayschedule_id:y.C_InvoicePaySchedule_ID,Org:parseInt(d.val()),IsPaid:!1,paidAmt:0}));if(l.length>0)for(p=0;p<l.length;p++)y=r.get(l[p].recid),rt=parseInt(y.C_ConversionType_ID),l[p].AppliedAmt!=undefined&&l[p].AppliedAmt!=0&&at.push({AppliedAmt:l[p].AppliedAmt,Date:y.DATEACCT,DateDoc:y.DATEDOC,DocumentNo:y.DOCUMENTNO,OpenAmount:y.OpenAmount,GL_JournalLine_ID:y.GL_JOURNALLINE_ID,GL_Journal_ID:y.GL_Journal_ID,ConvertedAmount:y.ConvertedAmount,Org:parseInt(d.val()),IsPaid:!1,paidAmt:0});cl(JSON.stringify(ct),JSON.stringify(st),JSON.stringify(lt),JSON.stringify(at),ht.val(),rt,ut,ft,ot,it,et,yt,vt)},error:function(t){n.ADialog.info("",!0,t,"");v[0].style.visibility="hidden"}})}function cl(e,o,s,h,c,l,a,y,p,w,b,k,nt){t.ajax({url:n.Application.contextUrl+"VIS/PaymentAllocation/saveGLJData",type:"POST",data:{paymentData:e,invoiceData:o,cashData:s,glData:h,DateTrx:c,_windowNo:pr.windowNo,C_Currency_ID:g,C_BPartner_ID:at,AD_Org_ID:d.val(),C_CurrencyType_ID:l,DateAcct:ui.val(),applied:a,discount:y,open:p,payment:w,writeOff:b,conversionDate:k,chk:nt},async:!1,success:function(t){ft=[];ct=[];vt=[];ut=[];si=[];yr=!0;du();f&&f.refresh();r&&r.refresh();i&&i.refresh();u&&u.refresh();var e=n.DisplayType.GetNumberFormat(n.DisplayType.Amount);fe.text("0 "+n.Msg.getMsg("SelectedLines")+" - "+ri+" "+e.GetFormatedValue(0)+" ");ye.text(e.GetFormatedValue(0));v[0].style.visibility="hidden";n.ADialog.info("",!0,t,"")},error:function(t){n.ADialog.info("",!0,t,"");v[0].style.visibility="hidden"}})}function ll(){console.info("BPartner Name : "+p.getName()+" , Value : "+p.value);console.info("Currency ID : "+st.val());console.info("Allocation From : "+w.val());console.info("Allocation To : "+l.val());console.info("MultiCurrency : "+s.is(":checked"));console.info("Currency Type : "+pt.getName()+" , Value : "+pt.getValue());console.info("Organization : "+d.val());console.info("Document Number : "+ne.val());console.info("Document Type : "+bt.val());console.info("Pay Document Type : "+kt.val());console.info("From Date : "+vi.val());console.info("To Date : "+ei.val());console.info("Conversion Date : "+a.val());v[0].style.visibility="visible";wr=1;cu=1;pf=0;br=1;lu=1;wf=0;kr=1;au=1;bf=0;dr=1;vu=1;kf=0;gr=!1;nu=!1;tu=!1;iu=!1;et=0;w.val()=="P"|l.val()=="P"?di():gr=!0;w.val()=="C"|l.val()=="C"?uu():nu=!0;w.val()=="I"|l.val()=="I"?hi():tu=!0;w.val()=="G"|l.val()=="G"?yu():iu=!0;df(w.val(),l.val())}function b(){var n=s.is(":checked");bs([],n);ps([],n);ws([],n);ys([],n);t(".vis-allocate-glSum").css("text-align","right");t(".vis-allocate-glSum").css("margin-right","10px")}this.frame;this.windowNo;var gi=n.Env.getCtx(),e=this,fu=t('<div class="vis-allocate-root vis-forms-container">'),ge=t('<div class="vis-leftpanel-wrapper vis-pad-0 vis-leftsidebarouterwrap">'),it=t('<div class="vis-leftpanel-inn-wrap">'),no=t('<div class="vis-allocation-rightContainer vis-formouterwrpdiv">'),rt=t('<div class="vis-allocate-paymentdiv" >'),ot=t('<div class="vis-allocate-cashdiv" >'),lt=t('<div class="vis-allocate-invoicediv" >'),yt=t('<div class="vis-allocate-gldiv" style = "height:49%" >'),ih=t("<div >"),ri="Σ",gt=null,p=null,pt=null,li=null,ai=null,st=t('<select class="vis-allocation-currencycmb" ><\/select>'),d=null,bt=t('<select class="sel-allocation"><\/select>'),kt=t('<select class="sel-allocation"><\/select>'),ni=t('<select class="sel-allocation"><\/select>'),ti=t('<select class="sel-allocation"><\/select>'),ii=t('<select class="sel-allocation"><\/select>'),ne,y,c,te,or,sr=null,vi=t('<input class="date-allocation" type="date" max="9999-12-31"><\/input>'),ei=t('<input class="date-allocation" type="date" max="9999-12-31"><\/input>'),nr=t('<input class="date-allocation" type="date" max="9999-12-31"><\/input>'),yi=t('<input class="date-allocation" type="date" max="9999-12-31"><\/input>'),tr=t('<input class="date-allocation" type="date" max="9999-12-31"><\/input>'),pi=t('<input class="date-allocation" type="date" max="9999-12-31"><\/input>'),ir=t('<input class="date-allocation" type="date" max="9999-12-31"><\/input>'),wi=t('<input class="date-allocation" type="date" max="9999-12-31"><\/input>'),al=t('<input value = "" placeholder = "Search..." type = "text" id = _SrchTxtbx_"'+e.windowNo+">"),ie,re=null,uf=null,ff=null,ef=null,of=null,w=t('<select class="vis-allocation-currencycmb" ><\/select>'),l=t('<select class="vis-allocation-currencycmb" ><\/select>'),sf=null,ue=null,fe=null,oi=null,to=0,r=null,rr=!0,wo=!1,io=0,ro=0,si=[],u=null,f=null,i=null,bi=null,hr=null,cr=null,ur=null,s=null,ee=null,oe=null,se=null,eu=!1,fr=!1,ui=null,ht=null,uo="",a=null,he=null,at=0,g=0,ce=10,fo=8,tt=null,bo=7,ko=8,le=9,ou=8,ae=11,hf=12,eo=null,oo=null,so=null,cf=0,ho=0,ve=0,pu=null,wu=null,bu=null,lf=null,go=null,ns=null,ts=null,is=null,ut=[],lr=0,rs=null,vt=[],af=0,us=null,ct=[],ar=0,fs=null,ft=[],vr=0,es=null,os=!1,ss=!1,hs=!1,yr=!1,ye=null,su=null,cs=null,ls=null,v=null,pr=this,ki=!0,hu=!1,vf=0,yf=0,ku=0,o=0,wt=n.DisplayType.GetNumberFormat(n.DisplayType.Amount),h=n.Env.isDecimalPoint(),fi=50,wr=1,cu=1,pf=0,br=1,lu=1,wf=0,kr=1,au=1,bf=0,dr=1,vu=1,kf=0,gr=!1,nu=!1,tu=!1,iu=!1,et=0,dt=[],ru=!0,pe=new n.CultureSeparator,rh=n.Application.contextUrl,uh=rh+"JsonData/JDataSetWithCode",fh=function(t,i,r){var f=r?!0:!1,e={sql:t,page:1,pageSize:0},u=null;return eh(e,f,function(t){i=(new n.DB.DataSet).toJson(t);var i=(new n.DB.DataSet).toJson(t);u=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null;i.dispose();i=null;f&&r(u)}),u};n.translatedTexts=n.Msg.translate(n.Env.getCtx(),["AD_Org_ID","C_BPartner_ID","C_Currency_ID","C_Payment_ID ","C_CashLine_ID","C_Cash_ID","C_Invoice_ID ","Date","DocumentNo","TrxCurrency","C_ConversionType_ID","Amount","ConvertedAmount","OpenAmount","multiplierap","AppliedAmount","C_ConversionType_ID","RECEIPTNO","PaymentType","ccashlineid","ScheduleDate","cinvoiceid","DiscountAmt","DocBaseType","WriteOffAmount","C_InvoicePaySchedule_ID","DateAcct","GL_JOURNALLINE_ID","GL_Journal_ID","DocType","Doc_Base_Type","FromDate","Payment_Type","CreditOrDebit","Account","VIS_Check","AD_OrgTrx_ID","PaymentMethod"],!0);this.Initialize=function(){var i,r,u,f;g=gi.getContextAsInt("$C_Currency_ID");ku=fh("VIS_131");ah();bh();vh();wh();yh();ph();rc();ec();uc();kh();dh();gh();nc();tc();ic();no.append(rt).append(ot).append(lt).append(yt).append(ih);rt.css("display","");ot.css("display","none");fu.append(ge.append(it)).append(no);i=t('<div class="vis-allocation-leftpanel-bottomDiv">');r=t('<div class="vis-DiffernceWrapDiv">');i.append(r);r.append('<div class="vis-allocation-leftControls"><span class="vis-allocation-inputLabels">'+n.Msg.getMsg("Difference")+"<\/span>");r.append('<div class="vis-allocation-leftControls"><span class="vis-allocation-lblCurrnecy" style=" padding: 0 5px; "><\/span><span class="vis-allocation-lbldifferenceAmt"><\/span>');u=t('<div style="padding-right: 15px;float: right; margin-top: 10px;">');u.append(' <a class="vis-group-btn vis-group-create vis-group-grayBtn" style="float: right;">'+n.Msg.getMsg("Process")+"<\/a>");f=t('<div style="padding-right: 15px;float: right; margin-top: 10px;">');f.append(' <a class="vis-group-create vis-group-grayBtn" id="vis_srchbtn_'+e.windowNo+'" style="float: left;">'+n.Msg.getMsg("Search")+"<\/a>");ge.append(i);i.append(u);i.append(f);fu.append(ge.append(it).append(i)).append(no);su=fu.find(".vis-group-btn");su.css({"pointer-events":"none",opacity:"0.5"});cs=fu.find("#vis_srchbtn_"+e.windowNo+"");fc();oh();b();yt.css("display","none");ye=r.find(".vis-allocation-lbldifferenceAmt");ls=r.find(".vis-allocation-lblCurrnecy");fu.find(".vis-allocation-resultdiv").css({width:"100%",margin:"0",bottom:"0",position:"inherit"});v[0].style.visibility="hidden"};this.disposeComponent=function(){u!=undefined&&u!=null&&(u.destroy(),u=null);f!=undefined&&f!=null&&(f.destroy(),f=null);i!=undefined&&i!=null&&(i.destroy(),i=null);r!=undefined&&r!=null&&(r.destroy(),r=null);bi=null;hr=null;cr=null;r=null;dt=null};this.getRoot=function(){return fu};this.refreshUI=function(){u.resize();f.resize();i.resize();r.resize()}}i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.Initialize();this.frame.getContentGrid().append(this.getRoot())};i.prototype.refresh=function(){this.refreshUI()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps=n.Apps||{};n.Apps.AForms=n.Apps.AForms||{};n.Apps.AForms.VAllocation=i}(VIS,jQuery),function(n,t){function i(i){var o,s,h,u,f;this.onClose=null;this.dGrid=null;o="SelectDeselectAll";s=!0;this.arrListColumns=[];this.log=n.Logging.VLogger.getVLogger("VCreateFrom");this.divPaging=null;this.ulPaging=null;this.liFirstPage=null;this.liPrevPage=null;this.liCurrPage=null;this.liNextPage=null;this.liLastPage=null;this.cmbPage=null;h=[];this.multiValues=[];this.editedItems=[];this.NonEditableRecord=[];var r=this,e=n.Application.contextUrl,c=e+"JsonData/JDataSet",l=e+"JsonData/ExecuteNonQuer";this.$root=t("<div style='position:relative'>");this.log=n.Logging.VLogger.getVLogger("VCreateFrom");this.$busyDiv=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');this.topDiv=t("<div class='vis-locatormainwrap vis-formouterwrpdiv'>");this.middelDiv=t("<div class='vis-crtfrm-datawrp'>");this.bottomDiv=t("<div class='vis-ctrfrm-btnwrp'>");this.divPaging=t("<div>");this.record_ID=0;this.windowNo=i.getWindowNo();this.mTab=i;this.initOK=!1;this.isApplied=!1;u="btnOk_"+this.windowNo;this.Okbtn=t("<input id='"+u+"' class='VIS_Pref_btn-2' type='button' value='"+n.Msg.getMsg("OK")+"'>");u="btnCancel_"+this.windowNo;this.cancelbtn=t("<input id='"+u+"' class='VIS_Pref_btn-2' type='button' value='"+n.Msg.getMsg("Cancel")+"'>");u="btnDelete_"+this.windowNo;f=n.Application.contextUrl+"Areas/VIS/Images/base/uncheck-icon.png";this.selectAllButton=t("<button type='button' id='"+u+"' style='margin-bottom:0px;margin-top:0px;display: none;float: left;padding: 0px;border: 0px;' value='Ok' role='button' aria-disabled='false'><img src='"+f+"'><\/button>");u="btnRefresh_"+this.windowNo;f=n.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png";this.btnRefresh=t("<button id='"+u+"' style='margin-bottom: 1px; margin-top: 0px;display: none; float: left; margin-left: 0px;height: 38px; ' class='VIS_Pref_btn-2'><img src='"+f+"'><\/button>");u="btnApply_"+this.windowNo;this.Applybtn=t("<input id='"+u+"' class='VIS_Pref_btn-2' style='display: none;' type='button' value='"+n.Msg.getMsg("Apply")+"'>");this.lblBankAccount=new n.Controls.VLabel;this.lblBPartner=new n.Controls.VLabel;this.lblOrder=new n.Controls.VLabel;this.lblInvoice=new n.Controls.VLabel;this.lblShipment=new n.Controls.VLabel;this.lblLocator=new n.Controls.VLabel;this.lblDeliveryDate=new n.Controls.VLabel;this.lblProduct=new n.Controls.VLabel;this.lblDocumentNoRef=new n.Controls.VLabel;this.lblDocumentNo=new n.Controls.VLabel;this.lblDate=new n.Controls.VLabel;this.lblAmount=new n.Controls.VLabel;this.lblDepositSlip=new n.Controls.VLabel;this.lblAuthCode=new n.Controls.VLabel;this.lblCheckNo=new n.Controls.VLabel;this.lblContainer=null;f=n.Application.contextUrl+"Areas/VIS/Images/pallet-icon.png";this.ContainerTree=t("<button class='input-group-text VIS_Tree-Container-disabled'><i id='ContainerTree_"+this.windowNo+"' class='fa fa-cubes'><\/i><\/button>");this.lblProvisionalInvoice=new n.Controls.VLabel;this.cmbProvisionalInvoice=new n.Controls.VComboBox("",!1,!1,!0);this.DocumentNo=null;this.Date=null;this.Amount=null;this.DepositSlip=null;this.AuthCode=null;this.CheckNo=null;this.fromInvoice=!1;this.ProvisionalInvoice=!1;this.deliveryDate=null;this.cmbOrder=new n.Controls.VComboBox("",!1,!1,!0);this.cmbInvoice=new n.Controls.VComboBox("",!1,!1,!0);this.cmbShipment=new n.Controls.VComboBox("",!1,!1,!0);this.cmbContainer=null;this.DocumentNoRef=null;this.vProduct=null;this.cmbBankAccount=null;this.vBPartner=null;this.locatorField=null;this.child=null;this.relatedToOrg=new n.Controls.VCheckBox("Related To My Organization",!1,!1,!0,"Related To My Organization",null);this.pattrLookup=new n.MPAttributeLookup(n.context,r.windowNo);this.$productAttribute=new n.Controls.VPAttribute("M_AttributeSetInstance_ID",!1,!1,!0,n.DisplayType.PAttribute,r.pattrLookup,r.windowNo,!1,!1,!1,!0);this.title="";this.vetoablechange=function(t){var f,u,e,s,o,i,h;if(t.propertyName=="M_Product_ID"){r.isApplied=!1;r.setBusy(!0);r.multiValues=[];r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null);var u=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),o=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),f=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),i=r.vProduct.getValue(),e=r.deliveryDate.getValue();u>0?r.locatorField!=null?r.loadOrders(u,i,e,!1,1):r.loadOrders(u,i,e,!0,1):o>0?n.VCreateFromShipment.prototype.loadInvoices(o,i,1):f>0?r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(f,i,1):n.VCreateFromInvoice.prototype.loadShipments(f,i,1):s>0?n.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,i,1):r.setBusy(!1)}else if(t.propertyName=="C_BPartner_ID"){r.setBusy(!0);r.multiValues=[];r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null);var c=r.cmbBankAccount.getControl().find("option:selected").val(),l=r.Date.getValue(),a=r.vBPartner.getValue(),v=r.DepositSlip.getValue(),y=r.DocumentNo.getValue(),p=r.AuthCode.getValue(),w=r.CheckNo.getValue(),b=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(c,a,l,y,v,p,w,b,1)}else t.propertyName=="M_InOut_ID"?(r.setBusy(!0),r.editedItems=[],r.multiValues=[],r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null),f=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),i=r.vProduct.getValue(),r.cmbOrder.setValue(-1),r.cmbInvoice.setValue(-1),r.cmbProvisionalInvoice.setValue(-1),r.lblDeliveryDate.setVisible(!1),r.deliveryDate.setVisible(!1),r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(f,i,1):n.VCreateFromInvoice.prototype.loadShipments(f,i,1)):t.propertyName=="C_Order_ID"?(r.isApplied=!1,r.setBusy(!0),r.editedItems=[],r.multiValues=[],r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null),u=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),r.cmbInvoice.setValue(-1),r.cmbShipment.setValue(-1),r.cmbProvisionalInvoice.setValue(-1),r.lblDeliveryDate.setVisible(!0),r.deliveryDate.setVisible(!0),i=r.vProduct.getValue(),e=r.deliveryDate.getValue(),r.locatorField!=null?r.loadOrders(u,i,e,!1,1):r.loadOrders(u,i,e,!0,1)):t.propertyName=="C_ProvisionalInvoice_ID"?(r.isApplied=!1,r.setBusy(!0),r.editedItems=[],r.multiValues=[],r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null),s=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),i=r.vProduct.getValue(),r.cmbOrder.setValue(-1),r.cmbShipment.setValue(-1),r.cmbInvoice.setValue(-1),r.lblDeliveryDate.setVisible(!1),r.deliveryDate.setVisible(!1),n.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,i,1)):t.propertyName=="C_Invoice_ID"?(r.isApplied=!1,r.setBusy(!0),r.editedItems=[],r.multiValues=[],r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null),o=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),i=r.vProduct.getValue(),r.cmbOrder.setValue(-1),r.cmbShipment.setValue(-1),r.cmbProvisionalInvoice.setValue(-1),r.lblDeliveryDate.setVisible(!1),r.deliveryDate.setVisible(!1),n.VCreateFromShipment.prototype.loadInvoices(o,i,1)):t.propertyName=="M_Locator_ID"?r.locatorField!=null&&(r.isApplied=!1,h=parseInt(r.locatorField.getValue()),h>0&&n.VCreateFromShipment.prototype.initContainerDetails(h)):this.locatorField.setBackground("")};this.createPageSettings=function(){this.ulPaging=t('<ul class="vis-statusbar-ul">');this.liFirstPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="First Page" style="opacity: 0.6;"><\/i><\/div><\/li>');this.liPrevPage=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="Page Up" style="opacity: 0.6;"><\/i><\/div><\/li>');this.cmbPage=t("<select>");this.liCurrPage=t("<li>").append(this.cmbPage);this.liNextPage=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="Page Down" style="opacity: 0.6;"><\/i><\/div><\/li>');this.liLastPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="Last Page" style="opacity: 0.6;"><\/i><\/div><\/li>');this.ulPaging.append(this.liFirstPage).append(this.liPrevPage).append(this.liCurrPage).append(this.liNextPage).append(this.liLastPage);this.pageEvents()};this.pageEvents=function(){this.liFirstPage.on("click",function(){var i,u;if(t(this).css("opacity")=="1"){r.setBusy(!0);var f=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),h=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),o=null;if(r.cmbBankAccount!=null&&(o=r.cmbBankAccount.getControl().find("option:selected").val()),i=null,u=null,r.vProduct!=null&&(i=r.vProduct.getValue()),r.deliveryDate!=null&&(u=r.deliveryDate.getValue()),f>0)r.locatorField!=null?r.loadOrders(f,i,u,!1,1):r.loadOrders(f,i,u,!0,1);else if(s>0)n.VCreateFromShipment.prototype.loadInvoices(s,i,1);else if(e>0)r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(e,i,1):n.VCreateFromInvoice.prototype.loadShipments(e,i,1);else if(o!=null){var c=r.Date.getValue(),l=r.vBPartner.getValue(),a=r.DepositSlip.getValue(),v=r.DocumentNo.getValue(),y=r.AuthCode.getValue(),p=r.CheckNo.getValue(),w=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(o,l,c,v,a,y,p,w,1)}else h>0&&n.VCreateFromInvoice.prototype.loadProvisionalInvoices(h,i,1)}});this.liPrevPage.on("click",function(){var i,u;if(t(this).css("opacity")=="1"){r.setBusy(!0);var f=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),h=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),o=null;if(r.cmbBankAccount!=null&&(o=r.cmbBankAccount.getControl().find("option:selected").val()),i=null,u=null,r.vProduct!=null&&(i=r.vProduct.getValue()),r.deliveryDate!=null&&(u=r.deliveryDate.getValue()),f>0)r.locatorField!=null?r.loadOrders(f,i,u,!1,parseInt(r.cmbPage.val())-1):r.loadOrders(f,i,u,!0,parseInt(r.cmbPage.val())-1);else if(s>0)n.VCreateFromShipment.prototype.loadInvoices(s,i,parseInt(r.cmbPage.val())-1);else if(e>0)r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.val())-1):n.VCreateFromInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.val())-1);else if(o!=null){var c=r.Date.getValue(),l=r.vBPartner.getValue(),a=r.DepositSlip.getValue(),v=r.DocumentNo.getValue(),y=r.AuthCode.getValue(),p=r.CheckNo.getValue(),w=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(o,l,c,v,a,y,p,w,parseInt(r.cmbPage.val())-1)}else h>0&&n.VCreateFromInvoice.prototype.loadProvisionalInvoices(h,i,parseInt(r.cmbPage.val())-1)}});this.liNextPage.on("click",function(){var i,u;if(t(this).css("opacity")=="1"){r.setBusy(!0);var f=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),h=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),o=null;if(r.cmbBankAccount!=null&&(o=r.cmbBankAccount.getControl().find("option:selected").val()),i=null,u=null,r.vProduct!=null&&(i=r.vProduct.getValue()),r.deliveryDate!=null&&(u=r.deliveryDate.getValue()),f>0)r.locatorField!=null?r.loadOrders(f,i,u,!1,parseInt(r.cmbPage.val())+1):r.loadOrders(f,i,u,!0,parseInt(r.cmbPage.val())+1);else if(s>0)n.VCreateFromShipment.prototype.loadInvoices(s,i,parseInt(r.cmbPage.val())+1);else if(e>0)r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.val())+1):n.VCreateFromInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.val())+1);else if(o!=null){var c=r.Date.getValue(),l=r.vBPartner.getValue(),a=r.DepositSlip.getValue(),v=r.DocumentNo.getValue(),y=r.AuthCode.getValue(),p=r.CheckNo.getValue(),w=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(o,l,c,v,a,y,p,w,parseInt(r.cmbPage.val())+1)}else h>0&&n.VCreateFromInvoice.prototype.loadProvisionalInvoices(h,i,parseInt(r.cmbPage.val())+1)}});this.liLastPage.on("click",function(){var i,u;if(t(this).css("opacity")=="1"){r.setBusy(!0);var f=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),h=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),o=null;if(r.cmbBankAccount!=null&&(o=r.cmbBankAccount.getControl().find("option:selected").val()),i=null,u=null,r.vProduct!=null&&(i=r.vProduct.getValue()),r.deliveryDate!=null&&(u=r.deliveryDate.getValue()),f>0)r.locatorField!=null?r.loadOrders(f,i,u,!1,parseInt(r.cmbPage.find("Option:last").val())):r.loadOrders(f,i,u,!0,parseInt(r.cmbPage.find("Option:last").val()));else if(s>0)n.VCreateFromShipment.prototype.loadInvoices(s,i,parseInt(r.cmbPage.find("Option:last").val()));else if(e>0)r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.find("Option:last").val())):n.VCreateFromInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.find("Option:last").val()));else if(o!=null){var c=r.Date.getValue(),l=r.vBPartner.getValue(),a=r.DepositSlip.getValue(),v=r.DocumentNo.getValue(),y=r.AuthCode.getValue(),p=r.CheckNo.getValue(),w=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(o,l,c,v,a,y,p,w,parseInt(r.cmbPage.find("Option:last").val()))}else h>0&&n.VCreateFromInvoice.prototype.loadProvisionalInvoices(h,i,parseInt(r.cmbPage.find("Option:last").val()))}});this.cmbPage.on("change",function(){var t,i;r.setBusy(!0);var u=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),o=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),f=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),e=null;if(r.cmbBankAccount!=null&&(e=r.cmbBankAccount.getControl().find("option:selected").val()),t=null,i=null,r.vProduct!=null&&(t=r.vProduct.getValue()),r.deliveryDate!=null&&(i=r.deliveryDate.getValue()),u>0)r.locatorField!=null?r.loadOrders(u,t,i,!1,r.cmbPage.val()):r.loadOrders(u,t,i,!0,r.cmbPage.val());else if(o>0)n.VCreateFromShipment.prototype.loadInvoices(o,t,r.cmbPage.val());else if(f>0)r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(f,t,r.cmbPage.val()):n.VCreateFromInvoice.prototype.loadShipments(f,t,r.cmbPage.val());else if(e!=null){var h=r.Date.getValue(),c=r.vBPartner.getValue(),l=r.DepositSlip.getValue(),a=r.DocumentNo.getValue(),v=r.AuthCode.getValue(),y=r.CheckNo.getValue(),p=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(e,c,h,a,l,v,y,p,r.cmbPage.val())}else s>0&&n.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,t,r.cmbPage.val())})};this.resetPageCtrls=function(n){if(this.cmbPage.empty(),n.TotalPage>0){for(var i=0;i<n.TotalPage;i++)this.cmbPage.append(t("<option value="+(i+1)+">"+(i+1)+"<\/option>"));this.cmbPage.val(n.CurrentPage);n.TotalPage>n.CurrentPage?(this.liNextPage.css("opacity","1"),this.liLastPage.css("opacity","1")):(this.liNextPage.css("opacity","0.6"),this.liLastPage.css("opacity","0.6"));n.CurrentPage>1?(this.liFirstPage.css("opacity","1"),this.liPrevPage.css("opacity","1")):(this.liFirstPage.css("opacity","0.6"),this.liPrevPage.css("opacity","0.6"));n.TotalPage==1&&(this.liFirstPage.css("opacity","0.6"),this.liPrevPage.css("opacity","0.6"),this.liNextPage.css("opacity","0.6"),this.liLastPage.css("opacity","0.6"))}else this.liFirstPage.css("opacity","0.6"),this.liPrevPage.css("opacity","0.6"),this.liNextPage.css("opacity","0.6"),this.liLastPage.css("opacity","0.6")};this.setBusy=function(n){this.$busyDiv.css("display",n?"block":"none")};this.MergeItemsForSave=function(){var e=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),o=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),i,u,f;if(r.editedItems.length>0)for(i in r.editedItems)u=r.editedItems[i].M_Product_ID_K,f=t.grep(r.multiValues,function(n){return e>0?n.M_Product_ID_K==u&&n.C_Order_ID_K==r.editedItems[i].C_Order_ID_K:o>0?n.M_Product_ID_K==u&&n.C_Invoice_ID_K==r.editedItems[i].C_Invoice_ID_K:s>0?n.M_Product_ID_K==u&&n.M_InOut_ID_K==r.editedItems[i].M_InOut_ID_K:n.C_Payment_ID_K==r.editedItems[i].C_Payment_ID_K}),f.length>0||r.multiValues.push(r.editedItems[i])};this.showDialog=function(){this.locatorField&&(this.locatorField.setBackground(!1),this.locatorField.addVetoableChangeListener(this));this.vProduct&&this.vProduct.addVetoableChangeListener(this);this.vBPartner&&this.vBPartner.addVetoableChangeListener(this);this.cmbShipment&&this.cmbShipment.addVetoableChangeListener(this);this.cmbOrder&&this.cmbOrder.addVetoableChangeListener(this);this.cmbProvisionalInvoice&&this.cmbProvisionalInvoice.addVetoableChangeListener(this);this.cmbInvoice&&this.cmbInvoice.addVetoableChangeListener(this);var n=this;this.$root.append(this.$busyDiv);this.setBusy(!1);this.$root.dialog({modal:!0,title:this.title,width:900,height:600,resizable:!1,position:{at:"center top",of:window},close:function(){n.dispose();n.dGrid!=null&&n.dGrid.destroy();r=null;n.$root.dialog("destroy");n.$root=null}})};this.checkcommaordot=function(t,i){var f=!1,u,r;if(t.value_new=n.Utility.Util.getValueOfString(i),t.value_new.contains(".")){for(f=!0,u=[],r=0;r<t.value_new.length;r++)t.value_new[r]==="."&&u.push(r);u.length>1&&(t.value_new=removeAllButLast(t.value_new,"."))}if(t.value_new.contains(","))if(f)t.value_new=removeAllButLast(t.value_new,",");else{for(u=[],r=0;r<t.value_new.length;r++)t.value_new[r]===","&&u.push(r);t.value_new=u.length>1?removeAllButLast(t.value_new,","):t.value_new.replace(",",".")}return t.value_new==""&&(t.value_new="0"),t.value_new};this.removeAllButLast=function(n,t){var i=n.split(t);return n=i.slice(0,-1).join("")+"."+i.slice(-1),n.indexOf(".")==n.length-1&&(n=n.replace(".","")),n};this.disposeComponent=function(){r=null;this.Okbtn&&this.Okbtn.off("click");this.cancelbtn&&this.cancelbtn.off("click");this.selectAllButton&&this.selectAllButton.off("click");this.btnRefresh&&this.btnRefresh.off("click");this.Applybtn&&this.Applybtn.off("click");this.disposeComponent=null}}i.prototype.dispose=function(){this.disposeComponent()};i.prototype.create=function(t){var r=n.Env.getCtx().getContextAsInt(t.getWindowNo(),"BaseTable_ID"),i=null;if(r==392)i=new n.VCreateFromStatement(t);else if(r==318)i=new n.VCreateFromInvoice(t);else if(r==319)i=new n.VCreateFromShipment(t);else{if(r==426)return null;if(t.keyColumnName=="C_ProvisionalInvoice_ID")i=new n.VCreateFormProvisionalInvoice(t);else return null}return i};i.prototype.initBPDetails=function(n){return n};i.prototype.initBPartner=function(t){var r=n.MLookupFactory.getMLookUp(n.Env.getCtx(),this.windowNo,3499,n.DisplayType.Search),i;return this.vBPartner=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,r),i=n.Env.getCtx().getContextAsInt(this.windowNo,"C_BPartner_ID"),this.vBPartner.setValue(i),this.initBPartnerOIS(i,t)};i.prototype.initBPartnerOIS=function(i,r){var o=this.cmbOrder,u,f,e;return t(o).html(""),u=!1,r?(f=n.dataContext.getJSONRecord("MDocType/GetDocType",n.Env.getCtx().getContextAsInt(this.windowNo,"C_DocTypeTarget_ID").toString()),u=n.Utility.Util.getValueOfBoolean(f.IsReturnTrx),e="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx")),u||e||this.getProvisionlInvoices(n.Env.getCtx(),i,u)):u="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsReturnTrx")),this.getOrders(n.Env.getCtx(),i,u,r),this.initBPDetails(i)};i.prototype.initBPartnerForProvisional=function(){var f=n.MLookupFactory.getMLookUp(n.Env.getCtx(),this.windowNo,3499,n.DisplayType.Search),i,r,u;return this.vBPartner=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,f),i=n.Env.getCtx().getContextAsInt(this.windowNo,"C_BPartner_ID"),this.vBPartner.setValue(i),r=this.cmbOrder,t(r).html(""),u="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsReturnTrx")),this.getOrdersForProvisional(n.Env.getCtx(),i,u),this.initBPDetails(i)};i.prototype.getOrders=function(t,i,r,u){var o="m.M_InOutLine_ID",l;u&&(o="m.C_InvoiceLine_ID");var s=n.Env.getCtx().getContextAsInt(this.windowNo,"AD_Org_ID"),a="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsDropShip")),h="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx")),c=n.context.getWindowContextAsInt(this.windowNo,"C_Invoice_ID",!0),e="",f=" C_Order.IsSOTrx ='"+(h?"Y":"N")+"' AND C_Order.IsBlanketTrx='N' AND C_Order.ISSALESQUOTATION='N' AND C_Order.DocStatus IN ('CL', 'CO')";s>0&&(f+=" AND C_Order.AD_Org_ID = "+s);i>0&&(f+=u?" AND (C_Order.C_BPartner_ID = "+i+" OR C_Order.Bill_BPartner_ID = "+i+")":"AND C_Order.C_BPartner_ID = "+i);c>0&&(e=n.dataContext.getJSONData("VCreateFrom/GetConversionWhere",{columns:o,forInvoices:u,recordID:c,Table:"C_Order"},null));e!=null&&e!=""&&(f+=e);u&&!h&&(f+=" AND C_Order.C_Order_ID NOT IN(SELECT DISTINCT OL.C_Order_ID FROM C_ProvisionalInvoice PI INNER JOIN C_ProvisionalInvoiceLine IL ON IL.C_ProvisionalInvoice_ID = PI.C_ProvisionalInvoice_ID INNER JOIN C_OrderLine OL ON OL.C_OrderLine_ID = IL.C_OrderLine_ID AND OL.C_Order_ID = C_Order.C_Order_ID WHERE  PI.IsActive = 'Y' AND pi.DocStatus  NOT IN('VO', 'RE'))");f+="AND C_Order.IsReturnTrx='"+(r?"Y":"N")+"' AND C_Order.IsDropShip='"+(a?"Y":"N")+"'  AND C_Order.C_Order_ID IN (SELECT C_Order_ID FROM (SELECT ol.C_Order_ID,ol.C_OrderLine_ID,ol.QtyOrdered, (SELECT SUM(m.qty) FROM m_matchPO m WHERE ol.C_OrderLine_ID = m.C_OrderLine_ID AND NVL("+o+", 0) != 0 AND m.ISACTIVE = 'Y') AS Qty, (SELECT SUM(IL.QtyInvoiced)  FROM C_INVOICELINE IL INNER JOIN C_Invoice I ON I.C_INVOICE_ID = IL.C_INVOICE_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyInvoiced, (SELECT SUM(IL.QtyInvoiced)  FROM C_ProvisionalInvoiceLine IL INNER JOIN C_ProvisionalInvoice I ON I.C_ProvisionalInvoice_ID = IL.C_ProvisionalInvoice_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyProvisional FROM C_OrderLine ol ";u||n.Utility.Util.getValueOfString(n.Env.getCtx().getContext("$AllowNonItem"))!="N"||(f+=" INNER JOIN M_Product p ON ol.M_Product_ID = p.M_Product_ID AND p.ProductType = 'I'");f+=") t GROUP BY C_Order_ID,C_OrderLine_ID,QtyOrdered  HAVING QtyOrdered > SUM(nvl(Qty,0)) AND QtyOrdered > SUM(NVL(QtyInvoiced,0)))";l=n.MLookupFactory.get(n.Env.getCtx(),this.windowNo,0,n.DisplayType.Search,"C_Order_ID",0,!1,f);this.cmbOrder=new n.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,n.DisplayType.Search,l)};i.prototype.getProvisionlInvoices=function(t,i,r){var s=n.Env.getCtx().getContextAsInt(this.windowNo,"AD_Org_ID"),e=n.context.getWindowContextAsInt(this.windowNo,"C_Invoice_ID",!0),u="",f=" C_ProvisionalInvoice.C_ProvisionalInvoice_ID IN (SELECT DISTINCT i.C_ProvisionalInvoice_ID FROM C_ProvisionalInvoice i INNER JOIN C_DocType d ON (i.C_DocType_ID = d.C_DocType_ID) INNER JOIN C_ProvisionalInvoiceLine pil ON i.C_ProvisionalInvoice_ID = pil.C_ProvisionalInvoice_ID WHERE i.C_BPartner_ID = "+i+" AND i.IsSOTrx = 'N' AND d.IsReturnTrx = '"+(r?"Y":"N")+"' AND i.DocStatus IN('CL', 'CO') AND NVL(pil.C_ProvisionalInvoiceLine_ID, 0) NOT IN (SELECT NVL(C_ProvisionalInvoiceLine_ID, 0) FROM (SELECT NVL(il.C_ProvisionalInvoiceLine_ID, 0) AS C_ProvisionalInvoiceLine_ID FROM C_InvoiceLine il INNER JOIN C_Invoice inv ON inv.C_Invoice_ID = il.C_Invoice_ID WHERE inv.IsActive = 'Y' AND inv.IsSOTrx='N' AND inv.DocStatus NOT IN ('VO', 'RE') AND inv.C_ProvisionalInvoice_ID=i.C_ProvisionalInvoice_ID) pi) ",o;e>0&&(u=n.dataContext.getJSONData("VCreateFrom/GetConversionWhere",{columns:"",forInvoices:!1,recordID:e,Table:"i"},null));u!=null&&u!=""&&(f+=u);f+=")";o=n.MLookupFactory.get(n.Env.getCtx(),this.windowNo,0,n.DisplayType.Search,"C_ProvisionalInvoice_ID",0,!1,f);this.cmbProvisionalInvoice=new n.Controls.VTextBoxButton("C_ProvisionalInvoice_ID",!0,!1,!0,n.DisplayType.Search,o)};i.prototype.getOrdersForProvisional=function(t,i,r){var e="m.C_InvoiceLine_ID",o=n.Env.getCtx().getContextAsInt(this.windowNo,"AD_Org_ID"),c="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsDropShip")),l="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx")),s=n.context.getWindowContextAsInt(this.windowNo,"C_ProvisionalInvoice_ID",!0),f="",u=" C_Order.IsSOTrx ='"+(l?"Y":"N")+"' AND C_Order.IsBlanketTrx='N' AND C_Order.ISSALESQUOTATION='N' AND C_Order.DocStatus IN ('CL', 'CO')",h;o>0&&(u+=" AND C_Order.AD_Org_ID = "+o);i>0&&(u+=" AND (C_Order.C_BPartner_ID = "+i+" OR C_Order.Bill_BPartner_ID = "+i+")");s>0&&(f=n.dataContext.getJSONData("VCreateFrom/GetConversionWhere",{columns:e,forInvoices:!1,recordID:s,Table:"C_Order"},null));f!=null&&f!=""&&(u+=f);u+="AND C_Order.IsReturnTrx='"+(r?"Y":"N")+"' AND C_Order.IsDropShip='"+(c?"Y":"N")+"'  AND C_Order.C_Order_ID IN (SELECT C_Order_ID FROM (SELECT ol.C_Order_ID,ol.C_OrderLine_ID,ol.QtyOrdered, (SELECT SUM(m.qty) FROM m_matchPO m WHERE ol.C_OrderLine_ID = m.C_OrderLine_ID AND NVL("+e+", 0) != 0 AND m.ISACTIVE = 'Y') AS Qty, (SELECT SUM(IL.QtyInvoiced)  FROM C_INVOICELINE IL INNER JOIN C_Invoice I ON I.C_INVOICE_ID = IL.C_INVOICE_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyInvoiced, (SELECT SUM(IL.QtyInvoiced)  FROM C_ProvisionalInvoiceLine IL INNER JOIN C_ProvisionalInvoice I ON I.C_ProvisionalInvoice_ID = IL.C_ProvisionalInvoice_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyProvisional FROM C_OrderLine ol ";n.Utility.Util.getValueOfString(n.Env.getCtx().getContext("$AllowNonItem"))=="N"&&(u+=" INNER JOIN M_Product p ON ol.M_Product_ID = p.M_Product_ID AND p.ProductType = 'I'");u+=") t GROUP BY C_Order_ID,C_OrderLine_ID,QtyOrdered  HAVING QtyOrdered > SUM(nvl(Qty,0)) AND QtyOrdered > SUM(NVL(QtyInvoiced,0)) AND QtyOrdered > SUM(NVL(QtyProvisional, 0)))";h=n.MLookupFactory.get(n.Env.getCtx(),this.windowNo,0,n.DisplayType.Search,"C_Order_ID",0,!1,u);this.cmbOrder=new n.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,n.DisplayType.Search,h)};i.prototype.jbInit=function(){this.init();this.lblBankAccount.getControl().text(n.Msg.getMsg("BankAcctCurrency"));this.lblBPartner.getControl().text(n.Msg.getMsg("BusinessPartner"));this.lblOrder.getControl().text(n.Msg.getMsg("Order"));this.lblInvoice.getControl().text(n.Msg.getMsg("Invoice"));this.lblShipment.getControl().text(n.Msg.getMsg("Shipment/Receipt"));this.lblLocator.getControl().text(n.Msg.getMsg("M_Locator_ID"));this.lblDeliveryDate.getControl().text(n.Msg.getMsg("DeliveryDate"));this.lblProduct.getControl().text(n.Msg.getMsg("ProductName"));this.lblDocumentNoRef.getControl().text(n.Msg.getMsg("DocumentNo"));this.lblDocumentNo.getControl().text(n.Msg.getMsg("DocumentNo"));this.lblDate.getControl().text(n.Msg.getMsg("DateAcct"));this.lblAmount.getControl().text(n.Msg.getMsg("Amount"));this.lblDepositSlip.getControl().text(n.Msg.getMsg("DepositSlipNo"));this.lblAuthCode.getControl().text(n.Msg.getMsg("AuthCode"));this.lblCheckNo.getControl().text(n.Msg.getMsg("CheckNo"));this.lblProvisionalInvoice.getControl().text(n.Msg.getMsg("ProvisionalInvoice"));var e=t("<div class='VIS_Pref_show'>"),u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>");this.topDiv.append(e);e.append(u);u.append(r);r.append(i);r.append(f);this.vBPartner!=null&&(this.cmbBankAccount!=null?(i.append(this.vBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append(this.vBPartner.getBtn(0)),f.append(this.vBPartner.getBtn(1))):(i.append(this.vBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append(this.vBPartner.getBtn(0))),i.append(this.lblBPartner.getControl().addClass("VIS_Pref_Label_Font")));u=t("<div class='VIS_Pref_dd'>");r=t("<div class='input-group vis-input-wrap'><\/div>");i=t("<div class='vis-control-wrap'><\/div>");f=t("<div class='input-group-append'>");e.append(u);u.append(r);r.append(i);r.append(f);this.cmbBankAccount!=null?(i.append(this.cmbBankAccount.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblBankAccount.getControl().addClass("VIS_Pref_Label_Font"))):this.DocumentNoRef!=null?(i.append(this.DocumentNoRef.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblDocumentNoRef.getControl().addClass("VIS_Pref_Label_Font"))):this.cmbProvisionalInvoice!=null&&$self.mTab.keyColumnName=="C_Invoice_ID"&&"N".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx"))&&(i.append(this.cmbProvisionalInvoice.getControl().attr("data-placeholder","").attr("placeholder"," ")),f.append(this.cmbProvisionalInvoice.getBtn(0)),f.append(this.cmbProvisionalInvoice.getBtn(1)),i.append(this.lblProvisionalInvoice.getControl().addClass("VIS_Pref_Label_Font")));e=t("<div class='VIS_Pref_show'>");u=t("<div class='VIS_Pref_dd'>");r=t("<div class='input-group vis-input-wrap'><\/div>");i=t("<div class='vis-control-wrap'><\/div>");f=t("<div class='input-group-append'>");this.Amount!=null;this.topDiv.append(e);e.append(u);u.append(r);r.append(i);r.append(f);this.DocumentNo!=null&&(u.append(r),i.append(this.DocumentNo.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblDocumentNo.getControl().addClass("VIS_Pref_Label_Font")));this.cmbOrder!=null&&(u.append(r),i.append(this.cmbOrder.getControl()),f.append(this.cmbOrder.getBtn(0)),f.append(this.cmbOrder.getBtn(1)),i.append(this.lblOrder.getControl().addClass("VIS_Pref_Label_Font")));this.Amount!=null&&(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),e.append(u),u.append(r),r.append(i),i.append(this.Amount.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblAmount.getControl().addClass("VIS_Pref_Label_Font")));this.Amount!=null?(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>")):(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>"));e.append(u);u.append(r);r.append(i);r.append(f);this.cmbInvoice!=null&&(i.append(this.cmbInvoice.getControl().attr("data-placeholder","").attr("placeholder"," ")),f.append(this.cmbInvoice.getBtn(0)),f.append(this.cmbInvoice.getBtn(1)),i.append(this.lblInvoice.getControl().addClass("VIS_Pref_Label_Font")));this.cmbShipment!=null&&(i.append(this.cmbShipment.getControl().attr("data-placeholder","").attr("placeholder"," ")),f.append(this.cmbShipment.getBtn(0)),f.append(this.cmbShipment.getBtn(1)),i.append(this.lblShipment.getControl().addClass("VIS_Pref_Label_Font")));this.Date!=null&&(i.append(this.Date.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblDate.getControl().addClass("VIS_Pref_Label_Font")));(this.locatorField!=null||this.cmbContainer!=null)&&(this.middelDiv.css("height","48.5%"),e=t("<div class='VIS_Pref_show'>"),u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>"),this.topDiv.append(e),e.append(u),u.append(r),r.append(i),r.append(f),this.locatorField!=null&&(i.append(this.locatorField.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append(this.locatorField.getBtn(0)),i.append(this.lblLocator.getControl().addClass("VIS_Pref_Label_Font"))),u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>"),e.append(u),u.append(r),r.append(i),r.append(f),this.cmbContainer!=null&&(u.css("visibility","hidden"),n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"]!=undefined&&n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"].equals("Y",!0)&&(u.css("visibility","visible"),this.ContainerTree.removeClass("VIS_Tree-Container-disabled")),i.append(this.cmbContainer.getControl().attr("disabled",!0).attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append(this.ContainerTree),i.append(this.lblContainer.getControl().addClass("VIS_Pref_Label_Font"))));e=t("<div class='VIS_Pref_show'>");this.CheckNo!=null?(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>")):(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>"));$self.mTab.keyColumnName=="C_ProvisionalInvoice_ID"&&this.middelDiv.css("height","64%");this.topDiv.append(e);e.append(u);u.append(r);r.append(i);r.append(f);this.DepositSlip!=null&&(i.append(this.DepositSlip.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblDepositSlip.getControl().addClass("VIS_Pref_Label_Font")));this.deliveryDate!=null&&(i.append(this.deliveryDate.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblDeliveryDate.getControl().addClass("VIS_Pref_Label_Font")));this.CheckNo!=null&&(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),e.append(u),u.append(r),r.append(i),i.append(this.CheckNo.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblCheckNo.getControl().addClass("VIS_Pref_Label_Font")));this.CheckNo!=null?(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>")):(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>"));e.append(u);u.append(r);r.append(i);r.append(f);this.vProduct!=null&&(i.append(this.vProduct.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append(this.vProduct.getBtn(0)),f.append(this.vProduct.getBtn(1)),i.append(this.lblProduct.getControl().addClass("VIS_Pref_Label_Font")));this.AuthCode!=null&&(i.append(this.AuthCode.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblAuthCode.getControl().addClass("VIS_Pref_Label_Font")));this.relatedToOrg!=null&&(e=t("<div class='VIS_Pref_show'>"),u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),this.topDiv.append(e),e.append(u),u.append(r),r.append(i),i.append(this.relatedToOrg.getControl()))};i.prototype.init=function(){this.createPageSettings();this.divPaging.append(this.ulPaging);this.$root.append(this.topDiv).append(this.middelDiv).append(this.divPaging).append(this.bottomDiv);this.bottomDiv.append(this.selectAllButton);this.bottomDiv.append(this.btnRefresh);this.bottomDiv.append(this.cancelbtn);this.bottomDiv.append(this.Applybtn);this.bottomDiv.append(this.Okbtn);this.bottomDiv.append(this.divPaging);this.middelDiv.append(this.dGrid);$self=this;this.Okbtn.on("click",function(){var r;if($self.isApplied){$self.$root.dialog("close");return}$self.setBusy(!0);var u=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),f=n.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt($self.cmbShipment.getValue()),o=n.Utility.Util.getValueOfInt($self.cmbProvisionalInvoice.getValue()),i=null;if($self.dGrid!=null&&(i=$self.dGrid.getSelection()),i==null||i.length==0){n.ADialog.info("RecordSelectionRequired");$self.setBusy(!1);return}if($self.locatorField!=null){if($self.dGrid!=null&&u>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.get(i[item]).C_Order_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));else if($self.dGrid!=null&&f>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Invoice_ID_K==$self.dGrid.get(i[item]).C_Invoice_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));$self.MergeItemsForSave();n.VCreateFromShipment.prototype.saveMInOut(!1)}else if($self.cmbBankAccount!=null){if($self.dGrid!=null)for(item in i){if($self.dGrid.get(i[item]).Date=="")return n.ADialog.error("VIS_PLAccountDate"),!1;r=t.grep($self.multiValues,function(n){return n.C_Payment_ID_K==$self.dGrid.get(i[item]).C_Payment_ID_K});r.length>0||$self.multiValues.push($self.dGrid.get(i[item]))}n.VCreateFromStatement.prototype.saveStatment();$self.middelDiv.css("height","61%")}else{if($self.dGrid!=null&&u>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.get(i[item]).C_Order_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));if($self.dGrid!=null&&e>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_InOut_ID_K&&n.M_InOut_ID_K==$self.dGrid.get(i[item]).M_InOut_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));if($self.dGrid!=null&&o>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Invoice_ID_K==$self.dGrid.get(i[item]).C_Invoice_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));$self.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.saveProvisionalInvoice():n.VCreateFromInvoice.prototype.saveInvoice()}});this.Applybtn.on("click",function(){var r;$self.setBusy(!0);var u=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),f=n.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt($self.cmbShipment.getValue()),i=null;if($self.dGrid!=null&&(i=$self.dGrid.getSelection()),i==null||i.length==0){n.ADialog.info("RecordSelectionRequired");$self.setBusy(!1);return}if($self.locatorField!=null){if($self.dGrid!=null&&u>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.get(i[item]).C_Order_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));else if($self.dGrid!=null&&f>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Invoice_ID_K==$self.dGrid.get(i[item]).C_Invoice_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));$self.MergeItemsForSave();n.VCreateFromShipment.prototype.saveMInOut(!0)}else if($self.cmbBankAccount!=null){if($self.dGrid!=null)for(item in i){if($self.dGrid.get(i[item]).Date=="")return n.ADialog.error("VIS_PLAccountDate"),!1;r=t.grep($self.multiValues,function(n){return n.C_Payment_ID_K==$self.dGrid.get(i[item]).C_Payment_ID_K});r.length>0||$self.multiValues.push($self.dGrid.get(i[item]))}n.VCreateFromStatement.prototype.saveStatment();$self.middelDiv.css("height","61%")}else{if($self.dGrid!=null&&u>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.get(i[item]).C_Order_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));if($self.dGrid!=null&&e>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_InOut_ID_K&&n.M_InOut_ID_K==$self.dGrid.get(i[item]).M_InOut_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));n.VCreateFromInvoice.prototype.saveInvoice()}});i.prototype.callBackSave=function(t){if(t==!1)$self.setBusy(!1);else{$self.isApplied=!0;n.ADialog.info("VIS_SuccessFullyInserted",null,null,null);var i=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),r=n.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt($self.cmbShipment.getValue()),u=$self.vProduct.getValue(),f=$self.deliveryDate.getValue();(i>0||r>0)&&($self.locatorField!=null?($self.dGrid.selectNone(),i>0&&($self.multiValues=[],$self.loadOrders(i,u,f,!1,1)),r>0&&($self.multiValues=[],n.VCreateFromShipment.prototype.loadInvoices(r,u,1)),$self.dGrid.selectNone(),$self.editedItems=[]):($self.dGrid.selectNone(),i>0&&($self.multiValues=[],$self.loadOrders(i,u,f,!0,1)),r>0&&($self.multiValues=[],n.VCreateFromShipment.prototype.loadInvoices(r,u,1)),$self.dGrid.selectNone(),$self.editedItems=[]))}};this.cancelbtn.on("click",function(){$self.setBusy(!1);$self.$root.dialog("close")});this.selectAllButton.on("click",function(){});if(this.relatedToOrg)this.relatedToOrg.getControl().on("click",function(){var i,r,u,t;$self.isApplied=!1;$self.setBusy(!0);$self.multiValues=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);i=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue());r=n.Utility.Util.getValueOfInt($self.cmbProvisionalInvoice.getValue());i>0?($self.cmbInvoice.setValue(-1),$self.cmbShipment.setValue(-1),t=$self.vProduct.getValue(),u=$self.deliveryDate.getValue(),$self.loadOrders(i,t,u,!1,1)):r>0?($self.cmbOrder.setValue(-1),$self.cmbInvoice.setValue(-1),$self.cmbShipment.setValue(-1),t=$self.vProduct.getValue(),n.VCreateFromInvoice.prototype.loadProvisionalInvoices(r,t,1)):$self.setBusy(!1)});if(this.btnRefresh)this.btnRefresh.on("click",function(){var t;if($self.cmbBankAccount!=null&&($self.setBusy(!0),t=$self.cmbBankAccount.getControl().find("option:selected").val(),t)){var i=$self.Date.getValue(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(t,r,i,f,u,e,o,s,$self.cmbPage.val())}});if(this.cmbBankAccount&&this.cmbBankAccount.getControl().change(function(){var t;if($self.editedItems=[],$self.setBusy(!0),t=$self.cmbBankAccount.getControl().find("option:selected").val(),t){n.VCreateFromStatement.prototype.initBPartner(t);$self.Date.setValue("");$self.DepositSlip.setValue("");$self.DocumentNo.setValue("");$self.AuthCode.setValue("");var i=$self.vBPartner.getValue(),r=$self.Date.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(t,i,r,f,u,e,o,s,1)}}),this.Date&&this.Date.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.DocumentNo&&this.DocumentNo.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.DepositSlip&&this.DepositSlip.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.AuthCode&&this.AuthCode.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.CheckNo&&this.CheckNo.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.Amount&&this.Amount.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.deliveryDate&&this.deliveryDate.getControl().change(function(){$self.isApplied=!1;$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),i=$self.vProduct.getValue(),r=$self.deliveryDate.getValue();$self.locatorField!=null?$self.loadOrders(t,i,r,!1,1):$self.loadOrders(t,i,r,!0,1)}),this.ContainerTree)this.ContainerTree.on("click",function(){var i,t;(n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"]==undefined||n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"].equals("Y",!0))&&(i=$self.locatorField.getValue(),i>0&&(t=new n.productContainerTree(0,i,0),t!=null&&(t.showDialog(),t.onClosing=function(n,t){$self.cmbContainer.getControl().empty();$self.cmbContainer.getControl().append(" <option value="+n+">"+t+"<\/option>")}),t=null),i=null)})};i.prototype.isInitOK=function(){return this.initOK};i.prototype.loadOrders=function(t,i,r,u,f){var e=this.getOrdersData(n.Env.getCtx(),t,i,r,u,f)};i.prototype.getOrdersData=function(i,r,u,f,e,o){var s,v,y,h;if($self.dGrid!=null){s=$self.dGrid.getSelection();for(item in s)v=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(s[item]).M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.get(s[item]).C_Order_ID_K}),v.length>0||$self.multiValues.push($self.dGrid.get(s[item]))}if($self.mTab.keyColumnName=="M_InOut_ID"?$self.record_ID=$self.mTab.getValue("M_InOut_ID"):$self.mTab.keyColumnName=="C_Invoice_ID"?$self.record_ID=$self.mTab.getValue("C_Invoice_ID"):$self.mTab.keyColumnName=="C_ProvisionalInvoice_ID"&&($self.record_ID=$self.mTab.getValue("C_ProvisionalInvoice_ID")),$self.relatedToOrg!=null&&$self.relatedToOrg.getValue()){var c="",l="",a="",p="";o||(o=1);c=n.Env.isBaseLanguage(i,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i).concat("')");u!=null&&(l=" AND l.M_Product_ID="+u);f!=null&&(h=n.DB.to_date(f,!0),p=h,a=" AND l.DatePromised <= "+h);y=$self.mTab.getValue("AD_Org_ID");t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetOrdersDataCommon",dataType:"json",type:"POST",data:{keyColumnName:$self.mTab.keyColumnName,tableName:"C_OrderLine",recordID:$self.record_ID,pageNo:o,forInvoicees:e,C_Ord_IDs:r,isBaseLangess:c,MProductIDss:l,DelivDates:a,adOrgIDSs:y},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));$self.setBusy(!1);$self.log.info(t);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);$self.setBusy(!1);return}$self.resetPageCtrls(i.pSetting);$self.loadGrid(i.data);$self.setBusy(!1)}})}else{var c="",l="",a="",p="";c=n.Env.isBaseLanguage(i,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"') INNER JOIN C_UOM uom1 ON uom1.C_UOM_ID = uom.C_UOM_ID ";u>0&&(l=" AND l.M_Product_ID="+u);f!=null&&(h=n.DB.to_date(f,!0),a=" AND l.DatePromised <= "+h);o||(o=1);t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetOrdersDataCommonOrg",dataType:"json",type:"POST",data:{keyColumnName:$self.mTab.keyColumnName,tableName:"C_OrderLine",recordID:$self.record_ID,pageNo:o,forInvoicees:e,C_Ord_IDs:r,isBaseLangess:c,MProductIDss:l,DelivDates:a},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));$self.setBusy(!1);$self.log.info(t);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);$self.setBusy(!1);return}$self.resetPageCtrls(i.pSetting);$self.loadGrid(i.data);$self.setBusy(!1)}})}return[]};i.prototype.loadOrder=function(t,i){var r=null;r=this.getOrderData(n.Env.getCtx(),t,i);this.loadGrid(r)};i.prototype.getOrderData=function(i,r,u){var e=[],s,f,o;return $self.relatedToOrg.getValue()?(f="",f=n.Env.isBaseLanguage(i,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"')",s=$self.mTab.getValue($self.windowNo,"AD_Org_ID"),o=n.Env.getAD_Language(i),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetOrderDataCommons",dataType:"json",type:"POST",async:!1,data:{forInvoices:u,isBaseLangs:f,C_OrderID:r,orggetVals:s,langs:o},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));$self.setBusy(!1);$self.log.info(t);return},success:function(n){var i=JSON.parse(n),u,r,t;if(i&&i!=null&&i.length>0)for(u=1,r=0;r<i.length;r++)t={},t.Quantity=i[r].quantity,t.QuantityEntered=i[r].quantityentered,t.C_UOM_ID=i[r].c_uom_id,t.M_Product_ID=i[r].m_product_id,t.M_AttributeSetInstance_ID=i[r].m_attributesetinstance_id,t.C_Order_ID=i[r].c_order_id,t.M_InOut_ID=null,t.C_Invoice_ID=null,t.C_UOM_ID_K=i[r].c_uom_id_k,t.M_Product_ID_K=i[r].m_product_id_k,t.M_AttributeSetInstance_ID_K=i[r].m_attributesetinstance_id_k,t.C_Order_ID_K=i[r].c_order_id_k,t.M_InOut_ID_K=null,t.C_Invoice_ID_K=null,t.C_PaymentTerm_ID=i[r].C_PaymentTerm_ID,t.PaymentTermName=i[r].PaymentTermName,t.IsAdvance=i[r].IsAdvance,t.C_InvoicePaymentTerm_ID=i[r].C_InvoicePaymentTerm_ID,t.IsInvoicePTAdvance=i[r].IsInvoicePTAdvance,t.recid=u,e.push(t);$self.setBusy(!1)}}),e):(f="",f=n.Env.isBaseLanguage(i,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"')",o=n.Env.getAD_Language(i),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetOrderDataCommonsNotOrg",dataType:"json",type:"POST",async:!1,data:{forInvoices:u,isBaseLangs:f,C_OrderID:r,langs:o},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));$self.setBusy(!1);$self.log.info(t);return},success:function(n){var i=JSON.parse(n),u,r,t;if(i&&i!=null&&i.length>0)for(u=1,r=0;r<i.length;r++)t={},t.Quantity=i[r].quantity,t.QuantityEntered=i[r].quantityentered,t.C_UOM_ID=i[r].c_uom_id,t.M_Product_ID=i[r].m_product_id,t.M_AttributeSetInstance_ID=i[r].m_attributesetinstance_id,t.C_Order_ID=i[r].c_order_id,t.M_InOut_ID=null,t.C_Invoice_ID=null,t.C_UOM_ID_K=i[r].c_uom_id_k,t.M_Product_ID_K=i[r].m_product_id_k,t.M_AttributeSetInstance_ID_K=i[r].m_attributesetinstance_id_k,t.C_Order_ID_K=i[r].c_order_id_k,t.M_InOut_ID_K=null,t.C_Invoice_ID_K=null,t.C_PaymentTerm_ID=i[r].C_PaymentTerm_ID,t.PaymentTermName=i[r].PaymentTermName,t.IsAdvance=i[r].IsAdvance,t.C_InvoicePaymentTerm_ID=i[r].C_InvoicePaymentTerm_ID,t.IsInvoicePTAdvance=i[r].IsInvoicePTAdvance,$self.mTab.keyColumnName=="C_ProvisionalInvoice_ID"&&(t.POPrice=i[r].POPrice,t.ProvisionalPrice=i[r].ProvisionalPrice),t.recid=u,e.push(t);$self.setBusy(!1)}}),e)};i.prototype.loadGrid=function(i){function a(){for(var n=0;n<$self.dGrid.records.length;n++)$self.NonEditableRecord.indexOf(n+1)>=0&&($self.dGrid.unselect(n+1),t("#grid_"+$self.dGrid.name+"_rec_"+(n+1)+"  input").attr("disabled",!0))}function s(n,i){var u=$self.dGrid.records[i].M_Product_ID_K,s=t.grep($self.editedItems,function(n){return e>0?n.M_Product_ID_K==u&&n.C_Order_ID_K==$self.dGrid.records[i].C_Order_ID_K:o>0?n.M_Product_ID_K==u&&n.C_Invoice_ID_K==$self.dGrid.records[i].C_Invoice_ID_K:c>0?n.M_Product_ID_K==u&&n.M_InOut_ID_K==$self.dGrid.records[i].M_InOut_ID_K:n.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K}),f,r;if(s.length>0)$self.editedItems.splice($self.editedItems.indexOf(s[0]),1),$self.editedItems.push($self.dGrid.records[i]);else{for(f=0,r=0;r<$self.editedItems.length;r++)if($self.editedItems[r].recid==$self.dGrid.records[i].recid){f=1;break}f==0&&$self.editedItems.push($self.dGrid.records[i])}}function w(n,i,r){var u=null;return t.ajax({url:p,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(n)}).done(function(n){u=n;r&&r(n)}),u}var f=n.DisplayType.GetNumberFormat(n.DisplayType.Amount),r=n.Env.isDecimalPoint(),l,h,v,u;this.dGrid!=null&&(this.dGrid.destroy(),this.dGrid=null);l="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx"));this.arrListColumns.length!=0&&($self.mTab.keyColumnName!="C_Invoice_ID"||l)||(this.arrListColumns=[],this.arrListColumns.push({field:"Select",caption:n.Msg.getMsg("Select"),sortable:!1,size:"50px",hidden:!1,render:function(){return'<div><input type=checkbox disabled="true"><\/div>'}}),this.arrListColumns.push({field:"Quantity",caption:n.Msg.getMsg("QtyPending"),sortable:!1,size:"150px",hidden:!1,render:function(n){var t=n.Quantity;return parseFloat(t).toLocaleString(undefined,{minimumFractionDigits:4})}}),this.arrListColumns.push({field:"QuantityPending",caption:n.Msg.getMsg("Quantity"),sortable:!1,size:"150px",render:"number:4",hidden:!0}),n.Utility.Util.getValueOfInt($self.cmbProvisionalInvoice.getValue())>0&&!l?(this.arrListColumns.push({field:"QuantityEntered",caption:n.Msg.getMsg("QtyEntered"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"POPrice",caption:n.Msg.getMsg("POPrice"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"ProvisionalPrice",caption:n.Msg.getMsg("ProvisionalPrice"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"InvoicePrice",caption:n.Msg.getMsg("InvoicePrice"),editable:{type:"number",style:"background-color: #f8f8f8;"},sortable:!1,size:"150px",hidden:!1,render:function(n){var t=n.InvoicePrice;return t=$self.checkcommaordot(event,t),parseFloat(t).toLocaleString(undefined,{minimumFractionDigits:4})},style:"background-color: #d1d1d14a"})):this.arrListColumns.push({field:"QuantityEntered",caption:n.Msg.getMsg("QtyEntered"),editable:{type:"number",style:"background-color: #f8f8f8;"},sortable:!1,size:"150px",hidden:!1,render:function(n){var t=n.QuantityEntered;return t=$self.checkcommaordot(event,t),parseFloat(t).toLocaleString(undefined,{minimumFractionDigits:4})},style:"background-color: #d1d1d14a"}),this.arrListColumns.push({field:"C_UOM_ID",caption:n.Msg.getMsg("UomName"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_Product_SearchKey",caption:n.Msg.getMsg("ProductSearchKey"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_Product_ID",caption:n.Msg.getMsg("ProductName"),sortable:!0,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_AttributeSetInstance_ID",caption:n.Msg.getMsg("ASI"),sortable:!1,size:"150px",editable:{type:"custom",ctrl:$self.$productAttribute,showAll:!0,style:"background-color: #f8f8f8;"},render:function(n){var t=$self.pattrLookup,i=n.M_AttributeSetInstance_ID,r;return n.changes&&typeof n.changes.M_AttributeSetInstance_ID!="undefined"&&(i=n.changes.M_AttributeSetInstance_ID),t&&(r=t.getDisplay(i,!0)),r},style:"background-color: #d1d1d14a"}),this.arrListColumns.push({field:"C_PaymentTerm_ID",caption:n.Msg.getMsg("C_PaymentTerm_ID"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"PaymentTermName",caption:n.Msg.getMsg("PaymentTermName"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"IsAdvance",caption:n.Msg.getMsg("IsAdvance"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_InvoicePaymentTerm_ID",caption:n.Msg.getMsg("C_InvoicePaymentTerm_ID"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"IsInvoicePTAdvance",caption:n.Msg.getMsg("IsInvoicePTAdvance"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_Order_ID",caption:n.Msg.getMsg("OrderLine"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_InOut_ID",caption:n.Msg.getMsg("Shipment/Receipt"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"C_Invoice_ID",caption:n.Msg.getMsg("Invoice"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"C_UOM_ID_K",caption:n.Msg.getMsg("UomName"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"M_Product_ID_K",caption:n.Msg.getMsg("ProductName"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_Order_ID_K",caption:n.Msg.getMsg("Order"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"M_InOut_ID_K",caption:n.Msg.getMsg("Shipment/Receipt"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_Invoice_ID_K",caption:n.Msg.getMsg("Invoice"),sortable:!1,size:"150px",hidden:!0}));w2utils.encodeTags(i);h="gridCreateForm"+this.windowNo;h=h.replace(".","");this.dGrid=t(this.middelDiv).w2grid({name:h,recordHeight:30,show:{selectColumn:!0},multiSelect:!0,columns:this.arrListColumns,records:i,onSelect:function(n){n.onComplete=function(){a()}},onEditField:function(n){var i;id=n.recid;n.column==3&&($self.dGrid.records[n.index].QuantityEntered=$self.checkcommaordot(n,$self.dGrid.records[n.index].QuantityEntered),i=f.GetFormatAmount($self.dGrid.records[n.index].QuantityEntered,"init",r),$self.dGrid.records[n.index].QuantityEntered=f.GetConvertedString(i,r),t("#grid_"+$self.dGrid.name+"_rec_"+id).keydown(function(n){if(r||n.keyCode!=190&&n.keyCode!=110){if(r&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)?n.target.value.indexOf(".")>-1&&(n.target.value=n.target.value.replace(".","")):n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&n.target.value.indexOf(",")>-1&&(n.target.value=n.target.value.replace(",","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0}));n.column==4&&$self.dGrid.columns[n.column].field=="ProvisionalPrice"&&($self.dGrid.records[n.index].ProvisionalPrice=$self.checkcommaordot(n,$self.dGrid.records[n.index].ProvisionalPrice),i=f.GetFormatAmount($self.dGrid.records[n.index].ProvisionalPrice,"init",r),$self.dGrid.records[n.index].ProvisionalPrice=f.GetConvertedString(i,r),$self.dGrid.refreshRow(n.index+1),t("#grid_"+$self.dGrid.name+"_rec_"+id).keydown(function(n){if(r||n.keyCode!=190&&n.keyCode!=110){if(r&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)?n.target.value.indexOf(".")>-1&&(n.target.value=n.target.value.replace(".","")):n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&n.target.value.indexOf(",")>-1&&(n.target.value=n.target.value.replace(",","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0}));n.column==6&&$self.dGrid.columns[n.column].field=="InvoicePrice"&&($self.dGrid.records[n.index].InvoicePrice=$self.checkcommaordot(n,$self.dGrid.records[n.index].InvoicePrice),i=f.GetFormatAmount($self.dGrid.records[n.index].InvoicePrice,"init",r),$self.dGrid.records[n.index].InvoicePrice=f.GetConvertedString(i,r),$self.dGrid.refreshRow(n.index+1),t("#grid_"+$self.dGrid.name+"_rec_"+id).keydown(function(n){if(r||n.keyCode!=190&&n.keyCode!=110){if(r&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)?n.target.value.indexOf(".")>-1&&(n.target.value=n.target.value.replace(".","")):n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&n.target.value.indexOf(",")>-1&&(n.target.value=n.target.value.replace(",","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0}))},onChange:function(i){window.setTimeout(function(){if($self.dGrid.getChanges(i.recid)!=undefined&&i.column==0&&$self.dGrid.columns[i.column].field=="Date"){var r=n.context.getContextAsInt($self.windowNo,"AD_Org_ID"),u=$self.dGrid.records[i.index].Amount,f=$self.dGrid.records[i.index].C_Currency_ID_K,e=$self.dGrid.records[i.index].C_ConversionType_ID,o=$self.dGrid.records[i.index].Date,s=$self.dGrid.records[i.index].Type,h=$self.dGrid.records[i.index].C_Payment_ID_K;t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetConvertedAmount",dataType:"json",type:"POST",data:{_paymentId:h,amount:u,currencyId:f,convsion_Id:e,date:o,paymentType:s,_org_id:r},error:function(){n.ADialog.info("ErrorWhileGettingData",null,"","");self.$super.setBusy(!1);return},success:function(t){t=JSON.parse(t);n.Utility.Util.getValueOfString(t._message)=="Success"?(_convertedAmt=n.Utility.Util.getValueOfDecimal(t.convtAmt),$self.dGrid.records[i.index].changes.ConvertedAmount=_convertedAmt,$self.dGrid.records[i.index].ConvertedAmount=_convertedAmt,$self.dGrid.refreshRow(i.index+1)):n.ADialog.info(t._message,null,"","")}})}},100)}});this.dGrid.selectNone();var e=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),o=n.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),c=n.Utility.Util.getValueOfInt($self.cmbShipment.getValue());for(itm in $self.multiValues)for(item in $self.dGrid.records)v=t.grep($self.multiValues,function(n){return e>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.records[item].C_Order_ID_K:o>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.C_Invoice_ID_K==$self.dGrid.records[item].C_Invoice_ID_K:c>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.M_InOut_ID_K==$self.dGrid.records[item].M_InOut_ID_K:n.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K}),v.length>0&&$self.dGrid.select(parseInt(item)+1);if(this.dGrid.records.length>0)for($self.NonEditableRecord=[],u=0;u<$self.dGrid.records.length;u++)t(t("#grid_"+$self.dGrid.name+"_rec_"+(u+1)).find("input[type=checkbox]")[1]).prop("checked",i[u].Select),$self.dGrid.records[u].C_InvoicePaymentTerm_ID==$self.dGrid.records[u].C_PaymentTerm_ID||$self.dGrid.records[u].C_InvoicePaymentTerm_ID==0||$self.dGrid.records[u].C_InvoicePaymentTerm_ID!=$self.dGrid.records[u].C_PaymentTerm_ID&&$self.dGrid.records[u].IsAdvance==!1&&$self.dGrid.records[u].IsInvoicePTAdvance==!1||(t("#grid_"+$self.dGrid.name+"_rec_"+(u+1)+"  input").attr("disabled",!0),$self.NonEditableRecord.push(u+1));this.dGrid.on("change",function(t){var i;if(a(),$self.dGrid.columns[t.column].field=="QuantityEntered"){if(i=f.GetConvertedNumber(t.value_new,r),$self.fromInvoice){if($self.dGrid.records[t.index].QuantityPending<i.toFixed(4)){n.ADialog.error("InvoiceQtyGreater");t.value_new=t.value_original;return}}else if($self.dGrid.records[t.index].QuantityPending<i.toFixed(4)){n.ADialog.error("QtyCanNotbeGreater");t.value_new=t.value_original;return}$self.dGrid.records[t.index].QuantityEntered=i.toFixed(4);(e>0||o>0)&&s("QuantityEntered",t.index,i.toFixed(4))}if($self.dGrid.columns[t.column].field=="ProvisionalPrice"){if(i=f.GetConvertedNumber(t.value_new,r),i<0){n.ADialog.error("PriceCantNegative");t.value_new=t.value_original;return}$self.dGrid.records[t.index].ProvisionalPrice=i.toFixed(4);s("ProvisionalPrice",t.index,i.toFixed(4))}else if($self.dGrid.columns[t.column].field=="InvoicePrice"){if(i=f.GetConvertedNumber(t.value_new,r),i<0){n.ADialog.error("PriceCantNegative");t.value_new=t.value_original;return}$self.dGrid.records[t.index].InvoicePrice=i.toFixed(4);s("InvoicePrice",t.index,i.toFixed(4))}else $self.dGrid.columns[t.column].field=="M_AttributeSetInstance_ID"?($self.dGrid.records[t.index].M_AttributeSetInstance_ID=t.value_new,(e>0||o>0)&&s("M_AttributeSetInstance_ID",t.index,t.value_new)):$self.dGrid.columns[t.column].field=="Date"&&(t.value_new!=""?$self.dGrid.records[t.index].Date=t.value_new:t.value_previous!=""?$self.dGrid.records[t.index].Date=t.value_previous:t.value_original!=""&&($self.dGrid.records[t.index].Date=t.value_original),$self.dGrid.records[t.index].Date!=""&&s("Date",t.index,$self.dGrid.records[t.index].Date))});this.dGrid.on("click",function(t){t.preventDefault;a();n.Env.getCtx().setContext($self.windowNo,"M_Product_ID",n.Utility.Util.getValueOfInt($self.dGrid.records[t.recid-1].M_Product_ID_K))});var b=function(t,i,r){var f=r?!0:!1,e={sql:t,page:1,pageSize:0},u=null;return w(e,f,function(t){i=(new n.DB.DataSet).toJson(t);var i=(new n.DB.DataSet).toJson(t);u=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null;i.dispose();i=null;f&&r(u)}),u},y=n.Application.contextUrl,p=y+"JsonData/JDataSet",k=y+"JsonData/ExecuteNonQuer";this.dGrid.on("unselect",function(n){if(n.all)n.onComplete=function(){for(item in $self.dGrid.records){var n=t.grep($self.multiValues,function(n){return e>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.records[item].C_Order_ID_K:o>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.C_Invoice_ID_K==$self.dGrid.records[item].C_Invoice_ID_K:c>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.M_InOut_ID_K==$self.dGrid.records[item].M_InOut_ID_K:n.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K});n.length>0&&$self.multiValues.splice($self.multiValues.indexOf(n[0]),1)}};else{var i=w2ui[n.target].records[n.index].M_Product_ID_K,r=t.grep($self.multiValues,function(t){return e>0?t.M_Product_ID_K==i&&t.C_Order_ID_K==w2ui[n.target].records[n.index].C_Order_ID_K:o>0?t.M_Product_ID_K==i&&t.C_Invoice_ID_K==w2ui[n.target].records[n.index].C_Invoice_ID_K:c>0?t.M_Product_ID_K==i&&t.M_InOut_ID_K==w2ui[n.target].records[n.index].M_InOut_ID_K:t.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K});r.length>0&&$self.multiValues.splice($self.multiValues.indexOf(r[0]),1)}})};n.VCreateFrom=i}(VIS,jQuery),function(n,t){function i(t){function f(){var t,r;return i.title=n.Msg.getMsg("Invoice")+" .. "+n.Msg.getMsg("CreateFrom"),i.lblInvoice!=null&&i.lblInvoice.getControl().css("display","none"),i.cmbInvoice!=null&&i.cmbInvoice.getControl().css("display","none"),i.lblLocator!=null&&i.lblLocator.getControl().css("display","none"),i.locatorField!=null&&i.locatorField.getControl().css("display","none"),i.deliveryDate=new n.Controls.VDate("DeliveryDate",!1,!1,!0,n.DisplayType.Date,"DeliveryDate"),t=n.MLookupFactory.getMLookUp(n.Env.getCtx(),i.windowNo,2221,n.DisplayType.Search),i.vProduct=new n.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,n.DisplayType.Search,t),r=i.initBPartner(!0),i.vBPartner.setReadOnly(!0),o(r),i.fromInvoice=!0,!0}function e(t,u){var h="Y".equals(n.Env.getCtx().getWindowContext(r.windowNo,"IsDropShip")),e="Y".equals(n.Env.getCtx().getWindowContext(r.windowNo,"IsSOTrx")),c=n.dataContext.getJSONRecord("MDocType/GetDocType",n.Env.getCtx().getContextAsInt(r.windowNo,"C_DocTypeTarget_ID").toString()),o=n.Utility.Util.getValueOfBoolean(c.IsReturnTrx),f=" M_InOut_ID IN (SELECT s.M_InOut_ID FROM M_InOut s WHERE s.C_BPartner_ID = "+u+" AND s.IsSOTrx = '"+(e?"Y":"N")+"' AND s.DocStatus IN('CL', 'CO') AND s.IsDropShip='"+(h?"Y":"N")+"'",s;o!=null&&(f+=" AND S.IsReturnTrx='"+(o==!0?"Y":"N")+"'");e||(f+=" AND s.M_InOut_ID NOT IN (SELECT DISTINCT OL.M_InOut_ID FROM C_ProvisionalInvoice PI INNER JOIN C_ProvisionalInvoiceLine IL ON IL.C_ProvisionalInvoice_ID = PI.C_ProvisionalInvoice_ID INNER JOIN M_InOutLine OL ON OL.M_InOutLine_ID = IL.M_InOutLine_ID AND S.M_InOut_ID = OL.M_InOut_ID WHERE  PI.IsActive = 'Y' AND pi.DocStatus NOT IN('VO', 'RE')) ");f+=" AND s.M_InOut_ID IN (SELECT t.M_InOut_ID FROM (SELECT sl.M_InOut_ID, sl.M_InOutLine_ID, sl.MovementQty,  (SELECT SUM(NVL(il.QtyInvoiced, 0)) FROM C_InvoiceLine il INNER JOIN C_Invoice I ON I.C_INVOICE_ID = il.C_INVOICE_ID WHERE i.DocStatus NOT IN ('VO', 'RE') AND sl.M_InOutLine_ID = il.M_InOutLine_ID) AS QtyInvoiced FROM M_InOutLine sl) t GROUP BY t.M_InOut_ID, t.M_InOutLine_ID, t.MovementQty HAVING t.MovementQty > SUM(NVL(t.QtyInvoiced, 0))))";s=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,0,n.DisplayType.Search,"M_InOut_ID",0,!1,f);i.cmbShipment=new n.Controls.VTextBoxButton("M_InOut_ID",!0,!1,!0,n.DisplayType.Search,s)}function o(t){e(n.Env.getCtx(),t)}var i=this.$super,r,u;i.constructor(t);r=this;f();i.jbInit();i.initOK=!0;u=t.getWindowNo();this.log=n.Logging.VLogger.getVLogger("VCreateFromInvoice");this.disposeComponent=function(){i=null;r=null;this.disposeComponent=null}}n.Utility.inheritPrototype(i,n.VCreateFrom);i.prototype.saveInvoice=function(){var u,t,i;if(this.$super.dGrid==null||(u={},t=this.$super.multiValues,t==null)||t.length<=0)return!1;for(i=0;i<t.length;i++)u[i]=t[i];var f=this.$super.mTab.getValue("C_Invoice_ID"),e=n.Utility.Util.getValueOfInt(this.$super.cmbOrder.getValue()),o=n.Utility.Util.getValueOfInt(this.$super.cmbShipment.getValue()),r=n.Utility.Util.getValueOfInt(this.$super.cmbProvisionalInvoice.getValue());return(r==undefined||r=="")&&(r=0),this.saveData(u,"",e,o,f,r)};i.prototype.loadShipments=function(t,i,r){var u=this.getShipmentsData(n.Env.getCtx(),t,i,r)};i.prototype.getShipmentsData=function(i,r,u,f){var e=this,o,c,s,h;if(this.$super.record_ID=$self.mTab.getValue("C_Invoice_ID"),e.$super.dGrid!=null){o=e.$super.dGrid.getSelection();for(item in o)c=t.grep(e.$super.multiValues,function(n){return n.M_Product_ID_K==e.$super.dGrid.get(o[item]).M_Product_ID_K&&n.M_InOut_ID_K==e.$super.dGrid.get(o[item]).M_InOut_ID_K}),c.length>0||e.$super.multiValues.push(e.$super.dGrid.get(o[item]))}return s="",h="",s=n.Env.isBaseLanguage(i,"C_UOM")?"FROM C_UOM uom INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom Left join C_UOM uom1 on (uom1.C_UOM_ID=uom.C_UOM_ID)  INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"') ",u!=null&&(h=" AND l.M_Product_ID="+u),f||(f=1),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetDataVCreateFrom",dataType:"json",type:"POST",data:{keyColumnName:e.$super.mTab.keyColumnName,tableName:"M_InOutLine",recordID:e.$super.record_ID,pageNo:f,mInOutId:r,isBaseLanguages:s,mProductIDD:h},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));e.$super.setBusy(!1);selfChild.log.info(t);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);e.$super.setBusy(!1);return}e.$super.resetPageCtrls(i.pSetting);e.$super.loadGrid(i.data);e.$super.setBusy(!1)}}),[]};i.prototype.loadShipment=function(t){var i=this.getShipmentData(n.Env.getCtx(),t);this.$super.loadGrid(i)};i.prototype.getShipmentData=function(i,r){var u="";return u=n.Env.isBaseLanguage(i,"C_UOM")?"FROM C_UOM uom INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"') ",t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetShipmentDatas",type:"POST",async:!1,data:{MInOutIDs:r,isBaseLanguageUmos:u},success:function(n){var i=JSON.parse(n),r,u;if(i&&i.length>0)for(r=1,u=0;u<i.length;u++){var t={},f=dr.getDecimal(0),e=dr.getDecimal(1);t.Quantity=f;t.QuantityEntered=e;t.C_UOM_ID=dr.getString(3);t.M_Product_ID=dr.getString(5);t.C_Order_ID=".";t.M_InOut_ID=dr.getString(7);t.C_Invoice_ID=null;t.C_UOM_ID_K=dr.getString(2);t.M_Product_ID_K=dr.getInt(4);t.C_Order_ID_K=dr.getInt(8);t.M_InOut_ID_K=dr.getInt(6);t.C_Invoice_ID_K=null;t.recid=r;r++;n.push(t)}},error:function(){}}),[]};i.prototype.loadProvisionalInvoices=function(t,i,r){var u=this.getProvisionalInvoicesData(n.Env.getCtx(),t,i,r)};i.prototype.getProvisionalInvoicesData=function(i,r,u,f){var e=this,o,l,s,h,c;if(this.$super.record_ID=$self.mTab.getValue("C_Invoice_ID"),e.$super.dGrid!=null){o=e.$super.dGrid.getSelection();for(item in o)l=t.grep(e.$super.multiValues,function(n){return n.M_Product_ID_K==e.$super.dGrid.get(o[item]).M_Product_ID_K&&n.C_Invoice_ID_K==e.$super.dGrid.get(o[item]).C_Invoice_ID_K}),l.length>0||e.$super.multiValues.push(e.$super.dGrid.get(o[item]))}return s="",h="",s=n.Env.isBaseLanguage(i,"C_UOM")?"FROM C_UOM uom INNER JOIN C_ProvisionalInvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom Left join C_UOM uom1 on (uom1.C_UOM_ID=uom.C_UOM_ID) INNER JOIN C_ProvisionalInvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"') ",u!=null&&(h=" AND l.M_Product_ID = "+u),f||(f=1),c=null,e.$super.relatedToOrg!=null&&e.$super.relatedToOrg.getValue()&&(c=e.$super.mTab.getValue("AD_Org_ID")),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetProvisionalInvoicesDataVCreate",dataType:"json",type:"POST",data:{keyColumnName:e.$super.mTab.keyColumnName,tableName:"C_ProvisionalInvoiceLine",recordID:e.$super.record_ID,pageNo:f,isBaseLangss:s,cInvoiceID:r,mProductIDs:h,orgId:c},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));selfChild.log.info(t);e.$super.setBusy(!1);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);e.$super.setBusy(!1);return}e.$super.resetPageCtrls(i.pSetting);e.$super.loadGrid(i.data);e.$super.setBusy(!1)}}),[]};i.prototype.saveData=function(i,r,u,f,e,o){var s=this;t.ajax({type:"POST",url:n.Application.contextUrl+"Common/SaveInvoice",dataType:"json",data:{model:i,selectedItems:r,C_Order_ID:u,C_Invoice_ID:e,M_inout_id:f,C_ProvisionalInvoice_ID:o},success:function(n){if(returnValue=n.result,returnValue){s.dispose();s.$super.$root.dialog("close");s.$super.setBusy(!1);return}s.$super.setBusy(!1);alert(returnValue)},error:function(n,t,i){console.log(t);s.$super.setBusy(!1);alert(i)}})};i.prototype.dispose=function(){this.disposeComponent!=null&&this.disposeComponent()};n.VCreateFromInvoice=i}(VIS,jQuery),function(n,t){function i(t){function u(){var o,t,r,u,f;i.title=n.Msg.getElement(n.Env.getCtx(),"M_InOut_ID",!1)+" .. "+n.Msg.translate(n.Env.getCtx(),"CreateFrom");i.lblShipment!=null&&i.lblShipment.getControl().css("display","none");i.cmbShipment!=null&&i.cmbShipment.getControl().css("display","none");i.Applybtn&&i.Applybtn.css("display","block");o=3537;t=new n.MLocatorLookup(n.Env.getCtx(),i.windowNo);i.locatorField=new n.Controls.VLocator("M_Locator_ID",!0,!1,!0,n.DisplayType.Locator,t);i.deliveryDate=new n.Controls.VDate("DeliveryDate",!1,!1,!0,n.DisplayType.Date,"DeliveryDate");r=n.MLookupFactory.getMLookUp(n.Env.getCtx(),i.windowNo,2221,n.DisplayType.Search);i.vProduct=new n.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,n.DisplayType.Search,r);i.DocumentNoRef=new n.Controls.VTextBox("DocumentNo",!1,!0,!0,50,100,null,null,!1);i.lblContainer=new n.Controls.VLabel;i.cmbContainer=new n.Controls.VComboBox("",!1,!1,!0);i.lblContainer.getControl().text(n.Msg.getMsg("VIS_Container"));i.lblContainer!=null&&i.lblContainer.getControl().css("display","block");i.cmbContainer!=null&&i.cmbContainer.getControl().css("display","block");u=n.Env.getCtx().getContext(i.windowNo,"DocumentNo");i.DocumentNoRef.setValue(u);f=i.initBPartner(!1);i.vBPartner.setReadOnly(!0);e(f)}function f(t,u,f){var s="Y".equals(n.Env.getCtx().getWindowContext(r.windowNo,"IsDropShip")),e=" C_Invoice.C_Invoice_ID IN (SELECT i.C_Invoice_ID FROM C_Invoice i INNER JOIN C_DocType d ON (i.C_DocType_ID = d.C_DocType_ID) WHERE i.C_BPartner_ID="+u+" AND i.IsSOTrx='N' AND i.IsDropShip='"+(s?"Y":"N")+"' AND d.IsReturnTrx='"+(f?"Y":"N")+"' AND i.DocStatus IN ('CL','CO') AND i.TreatAsDiscount = 'N' AND i.C_Invoice_ID IN (SELECT C_Invoice_ID FROM (SELECT il.C_Invoice_ID,il.C_InvoiceLine_ID,il.QtyInvoiced,mi.Qty FROM C_InvoiceLine il  LEFT OUTER JOIN M_MatchInv mi ON (il.C_InvoiceLine_ID=mi.C_InvoiceLine_ID) ",o;e+=n.Utility.Util.getValueOfString(n.Env.getCtx().getContext("$AllowNonItem"))=="N"?" INNER JOIN M_Product Mp On Mp.M_Product_ID = il.M_Product_ID WHERE Mp.ProductType = 'I' AND":" LEFT JOIN M_Product Mp On Mp.M_Product_ID = il.M_Product_ID WHERE";e+=" (il.QtyInvoiced <> nvl(mi.Qty,0) AND mi.C_InvoiceLine_ID IS NOT NULL And Mp.Iscostadjustmentonlost = 'N')  OR (NVL(Mi.Qty,0) = 0 AND Mi.C_Invoiceline_Id IS NOT NULL AND Mp.Iscostadjustmentonlost = 'Y')  OR mi.C_InvoiceLine_ID IS NULL ) t GROUP BY C_Invoice_ID,C_InvoiceLine_ID,QtyInvoiced  HAVING QtyInvoiced > SUM(nvl(Qty,0))))";o=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,0,n.DisplayType.Search,"C_Invoice_ID",0,!1,e);i.cmbInvoice=new n.Controls.VTextBoxButton("C_Invoice_ID",!0,!1,!0,n.DisplayType.Search,o)}function e(t){var r="Y".equals(n.Env.getCtx().getWindowContext(i.windowNo,"IsReturnTrx"));f(n.Env.getCtx(),t,r)}var i=this.$super,r;i.constructor(t);r=this;u();i.jbInit();i.initOK=!0;this.log=n.Logging.VLogger.getVLogger("VCreateFromShipment");this.disposeComponent=function(){i=null;r=null;this.disposeComponent=null}}n.Utility.inheritPrototype(i,n.VCreateFrom);i.prototype.saveMInOut=function(t){var u,i,r,f,e;if(this.$super.dGrid==null||(u={},i=this.$super.multiValues,i==null)||i.length<=0)return this.$super.setBusy(!1),!1;for(r=0;r<i.length;r++)u[r]=i[r];if(f=this.$super.locatorField.getValue(),f==null||f==0)return n.ADialog.info("Error",!0,n.Msg.translate(n.Env.getCtx(),"VIS_locfieldMandatory"),""),this.$super.setBusy(!1),!1;if(u.length==0)return this.$super.setBusy(!1),!1;e=this.$super.cmbContainer.getValue();e===undefined&&(e=0);var o=f,s=this.$super.mTab.getValue("M_InOut_ID"),h=n.Utility.Util.getValueOfInt(this.$super.cmbInvoice.getValue()),c=n.Utility.Util.getValueOfInt(this.$super.cmbOrder.getValue());return this.saveData(u,"",c,h,o,s,e,t)};i.prototype.loadInvoices=function(t,i,r){var u=this.getInvoicesData(n.Env.getCtx(),t,i,r)};i.prototype.getInvoicesData=function(i,r,u,f){var e=this,o,c,s,h;if(this.$super.record_ID=$self.mTab.getValue("M_InOut_ID"),e.$super.dGrid!=null){o=e.$super.dGrid.getSelection();for(item in o)c=t.grep(e.$super.multiValues,function(n){return n.M_Product_ID_K==e.$super.dGrid.get(o[item]).M_Product_ID_K&&n.C_Invoice_ID_K==e.$super.dGrid.get(o[item]).C_Invoice_ID_K}),c.length>0||e.$super.multiValues.push(e.$super.dGrid.get(o[item]))}return s="",h="",s=n.Env.isBaseLanguage(i,"C_UOM")?"FROM C_UOM uom INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom Left join C_UOM uom1 on (uom1.C_UOM_ID=uom.C_UOM_ID) INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"') ",u!=null&&(h=" AND l.M_Product_ID = "+u),f||(f=1),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetInvoicesDataVCreate",dataType:"json",type:"POST",data:{keyColumnName:e.$super.mTab.keyColumnName,tableName:"C_InvoiceLine",recordID:e.$super.record_ID,pageNo:f,isBaseLangss:s,cInvoiceID:r,mProductIDs:h},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));selfChild.log.info(t);e.$super.setBusy(!1);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);e.$super.setBusy(!1);return}e.$super.resetPageCtrls(i.pSetting);e.$super.loadGrid(i.data);e.$super.setBusy(!1)}}),[]};i.prototype.initContainerDetails=function(){this.$super.cmbContainer.getControl().html("")};i.prototype.loadInvoice=function(t){var i=this.getInvoiceData(n.Env.getCtx(),t);this.$super.loadGrid(i)};i.prototype.getInvoiceData=function(t,i){var o=[],f="SELECT round((l.QtyInvoiced-SUM(COALESCE(mi.Qty,0))) * (CASE WHEN l.QtyInvoiced=0 THEN 0 ELSE l.QtyEntered/l.QtyInvoiced END ),2) as QUANTITY,round((l.QtyInvoiced-SUM(COALESCE(mi.Qty,0))) * (CASE WHEN l.QtyInvoiced=0 THEN 0 ELSE l.QtyEntered/l.QtyInvoiced END ),2) as QTYENTER, l.C_UOM_ID,COALESCE(uom.UOMSymbol,uom.Name), l.M_Product_ID,p.Name, l.C_InvoiceLine_ID,l.Line, l.C_OrderLine_ID ",u,e;f=n.Env.isBaseLanguage(t,"C_UOM")?f.concat("FROM C_UOM uom ").concat("INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID) "):f.concat("FROM C_UOM_Trl uom ").concat("INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='").concat(n.Env.getAD_Language(t)).concat("') ");f=f.concat("INNER JOIN M_Product p ON (l.M_Product_ID=p.M_Product_ID) ").concat("LEFT OUTER JOIN M_MatchInv mi ON (l.C_InvoiceLine_ID=mi.C_InvoiceLine_ID) ").concat("WHERE l.C_Invoice_ID="+i+" GROUP BY l.QtyInvoiced,l.QtyEntered,l.C_UOM_ID,COALESCE(uom.UOMSymbol,uom.Name),l.M_Product_ID,p.Name, l.C_InvoiceLine_ID,l.Line,l.C_OrderLine_ID ORDER BY l.Line");u=null;try{for(u=n.DB.executeReader(f.toString(),null,null),e=1;u.read();){var r={},s=u.getDecimal(0),h=u.getDecimal(1);r.Quantity=s;r.QuantityEntered=h;r.C_UOM_ID=u.getString(3);r.M_Product_ID=u.getString(5);r.C_Order_ID=".";r.M_InOut_ID=null;r.C_Invoice_ID=u.getString(7);r.C_UOM_ID_K=u.getString(2);r.M_Product_ID_K=u.getInt(4);r.C_Order_ID_K=u.getInt(8);r.M_InOut_ID_K=null;r.C_Invoice_ID_K=u.getInt(6);r.recid=e;e++;o.push(r)}u.close()}catch(c){}return o};i.prototype.saveData=function(i,r,u,f,e,o,s,h){var c=this;console.log(e);t.ajax({type:"POST",url:n.Application.contextUrl+"Common/SaveShipment",dataType:"json",data:{model:i,selectedItems:r,C_Order_ID:u,C_Invoice_ID:f,M_Locator_ID:e,M_InOut_ID:o,Container_ID:s},success:function(n){if(returnValue=n.result,returnValue){h?c.$super.callBackSave(returnValue):(c.dispose(),c.$super.setBusy(!1),c.$super.$root.dialog("close"));return}},error:function(n,t,i){console.log(t);c.$super.setBusy(!1);alert(i)}})};i.prototype.dispose=function(){this.disposeComponent!=null&&this.disposeComponent()};n.VCreateFromShipment=i}(VIS,jQuery),function(n,t){function i(t){function f(){var f,e,t;return i.mTab.getValue("C_BankStatement_ID")==null?(n.ADialog.error(n.Msg.getMsg("SaveErrorRowNotFound",!0)),!1):(i.title=n.Msg.getElement(n.Env.getCtx(),"C_BankStatement_ID",!1)+" .. "+n.Msg.getMsg("CreateFrom"),i.relatedToOrg=null,i.lblOrder!=null&&i.lblOrder.getControl().css("display","none"),i.cmbOrder!=null&&i.cmbOrder.getControl().css("display","none"),i.lblShipment!=null&&i.lblShipment.getControl().css("display","none"),i.cmbShipment!=null&&i.cmbShipment.getControl().css("display","none"),i.lblInvoice!=null&&i.lblInvoice.getControl().css("display","none"),i.cmbInvoice!=null&&i.cmbInvoice.getControl().css("display","none"),f=4917,e=n.MLookupFactory.getMLookUp(n.Env.getCtx(),u,f,n.DisplayType.TableDir),i.cmbBankAccount=new n.Controls.VComboBox("C_BankAccount_ID",!0,!0,!0,e,150,n.DisplayType.TableDir,0),i.Date=new n.Controls.VDate("Date",!1,!1,!0,n.DisplayType.Date,"Date"),i.DocumentNo=new n.Controls.VTextBox("DocumentNo",!1,!1,!0,50,100,null,null,!1),i.Amount=new n.Controls.VAmountTextBox("Amount",!1,!1,!0,50,100,n.DisplayType.Amount,n.Msg.getMsg("Amount")),i.DepositSlip=new n.Controls.VTextBox("DepositSlip",!1,!1,!0,50,100,null,null,!1),i.AuthCode=new n.Controls.VTextBox("AuthCode",!1,!1,!0,50,100,null,null,!1),i.CheckNo=new n.Controls.VTextBox("CheckNo",!1,!1,!0,50,100,null,null,!1),i.cmbBankAccount.getControl().prop("selectedIndex",0),t=n.Env.getCtx().getContextAsInt(u,"C_BankAccount_ID"),i.cmbBankAccount.setValue(t),r.initBPartner(t),r.loadBankAccounts(t,0,"","","","","","0",1),i.btnRefresh&&i.btnRefresh.css("display","black"),!0)}var i=this.$super,r,u;i.constructor(t);r=this;u=t.getWindowNo();f();i.jbInit();i.initOK=!0;i.middelDiv.css("height","61%");this.disposeComponent=function(){this.disposeComponent=null}}function u(n,i,r){var u=null;return t.ajax({url:e,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(n)}).done(function(n){u=n;r&&r(n)}),u}var f,o;n.Utility.inheritPrototype(i,n.VCreateFrom);i.prototype.initBPartner=function(t){var i=this.$super,r=" C_BPartner.C_BPartner_ID IN (SELECT  p.C_BPartner_ID as C_BPartner_ID FROM C_Payment p WHERE p.Processed='Y' AND p.IsReconciled='N' AND p.DocStatus IN ('CO','CL','RE','VO') AND p.PayAmt<>0 AND p.C_BankAccount_ID = "+t+" AND NOT EXISTS (SELECT * FROM C_BankStatementLine l WHERE p.C_Payment_ID=l.C_Payment_ID AND l.StmtAmt <> 0) )",u=n.MLookupFactory.get(n.Env.getCtx(),this.windowNo,5398,n.DisplayType.Search,"C_BPartner_ID",0,!1,r);i.vBPartner=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,u)};i.prototype.getTableFieldVOs=function(){var t=this.$super,i;t.arrListColumns=[];t.arrListColumns.push({field:"Date",caption:n.Msg.getMsg("DateAcct"),sortable:!0,size:"100px",hidden:!1,editable:{type:"date"},render:function(n){var t=n.Date;return new Date(t).toLocaleDateString()}});t.arrListColumns.push({field:"C_Payment_ID",caption:n.Msg.getMsg("Payment"),sortable:!0,size:"100px",hidden:!1});t.arrListColumns.push({field:"C_Currency_ID",caption:n.Msg.getMsg("Currency"),sortable:!0,size:"80px",hidden:!1});i=n.Utility.Util.getValueOfInt(f("VIS_145"));i>0&&t.arrListColumns.push({field:"VA034_DepositSlipNo",caption:n.Msg.getMsg("DepositSlipNo"),sortable:!0,size:"100px",hidden:!1});t.arrListColumns.push({field:"AuthCode",caption:n.Msg.getMsg("AuthCode"),sortable:!0,size:"100px",hidden:!1});t.arrListColumns.push({field:"CheckNo",caption:n.Msg.getMsg("CheckNo"),sortable:!0,size:"80px",hidden:!1});t.arrListColumns.push({field:"Amount",caption:n.Msg.getMsg("Amount"),sortable:!0,size:"80px",hidden:!1,render:function(t){var i=n.Utility.Util.getValueOfDecimal(t.Amount);return i.toLocaleString()}});t.arrListColumns.push({field:"ConvertedAmount",caption:n.Msg.getMsg("ConvertedAmount"),sortable:!0,size:"80px",hidden:!1,render:function(t){var i=n.Utility.Util.getValueOfDecimal(t.ConvertedAmount);return i.toLocaleString()}});t.arrListColumns.push({field:"Description",caption:n.Msg.getMsg("Description"),sortable:!0,size:"250px",hidden:!1});t.arrListColumns.push({field:"C_BPartner_ID",caption:n.Msg.getMsg("BusinessPartner"),sortable:!0,size:"150px",hidden:!1});t.arrListColumns.push({field:"Type",caption:n.Msg.getMsg("Type"),sortable:!0,size:"80px",hidden:!0});t.arrListColumns.push({field:"C_Payment_ID_K",caption:n.Msg.getMsg("Payment"),sortable:!0,size:"150px",hidden:!0});t.arrListColumns.push({field:"C_Currency_ID_K",caption:n.Msg.getMsg("Currency"),sortable:!0,size:"150px",hidden:!0})};i.prototype.loadBankAccounts=function(t,i,r,u,f,e,o,s,h){var c=this.$super,l=c.mTab.getValue("StatementDate"),a=this.getBankAccountsData(n.Env.getCtx(),t,i,r,l,u,f,e,o,s,h);this.getTableFieldVOs()};i.prototype.getBankAccountsData=function(i,r,u,f,e,o,s,h,c,l,a){var v=this,y,p,nt,tt;if(v.$super.dGrid!=null){y=v.$super.dGrid.getSelection();for(item in y)p=t.grep(v.$super.multiValues,function(n){return n.C_Payment_ID_K==v.$super.dGrid.get(y[item]).C_Payment_ID_K}),p.length>0||v.$super.multiValues.push(v.$super.dGrid.get(y[item]))}e==null&&(e=DateTime.Today.Date);var it=n.DB.to_date(e,!0),w="",b="",k="0",d="",g="";return u>0&&(k=" AND p.C_BPartner_ID = "+u),o!=""&&(d=" AND p.DocumentNo LIKE '"+o+"'"),f!=""&&f!=null&&(nt=n.DB.to_date(f,!0),w=" AND p.DateAcct = "+nt),o!=""&&(g=" AND cs.DocumentNo LIKE '"+o+"'"),f!=""&&f!=null&&(tt=n.DB.to_date(f,!0),b=" AND cs.DateAcct = "+tt),a||(a=1),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetBankAccountsData",dataType:"json",type:"POST",data:{pageNo:a,dates:it,trxDatess:w,trxDatesUnions:b,cBPartnerIDs:k,DocumentNos:d,DocumentNoUnions:g,DepositSlips:s,AuthCodes:h,CheckNos:c,Amounts:l,cBankAccountId:r},error:function(){alert(n.Msg.getMsg("ErrorWhileGettingData"));v.$super.setBusy(!1);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);v.$super.setBusy(!1);return}v.$super.resetPageCtrls(i.pSetting);v.$super.loadGrid(i.data);v.$super.setBusy(!1)}}),[]};i.prototype.loadBankAccount=function(t){var i=this.$super,r=i.mTab.getValue("StatementDate"),u=this.getBankAccountData(n.Env.getCtx(),t,r);this.getTableFieldVOs();setTimeout(function(){i.loadGrid(u)},10)};i.prototype.getBankAccountData=function(i,r,u){var s=[],f,o,e;try{for(u==null&&(u=DateTime.Today.Date),f=null,t.ajax({url:n.Application.contextUrl+"Form/GetBankAccontData",async:!1,data:{C_BankAccount_ID:r,ts:u}}).done(function(t){f=(new n.DB.DataReader).toJson(t)}),o=1;f.read();)e={},e.Date=f.getString(0),e.C_Payment_ID=f.getString(2),e.C_Currency_ID=f.getString(4),e.Amount=f.getDecimal(5),e.ConvertedAmount=f.getDecimal(6),e.C_BPartner_ID=f.getString(7),e.Type=f.getString(8),e.C_Payment_ID_K=f.getString(1),e.C_Currency_ID_K=f.getInt(3),e.recid=o,o++,s.push(e)}catch(h){}return s};var r=n.Application.contextUrl,e=r+"JsonData/JDataSetWithCode",s=r+"JsonData/ExecuteNonQuer";f=function(t,i,r){var e=r?!0:!1,o={sql:t,page:1,pageSize:0},f=null;return u(o,e,function(t){i=(new n.DB.DataSet).toJson(t);var i=(new n.DB.DataSet).toJson(t);f=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null;i.dispose();i=null;e&&r(f)}),f};o=function(t,i,r){var o=r?!0:!1,e={sql:t,page:1,pageSize:0},f;return i&&(e.param=i),f=null,u(e,o,function(t){f=(new n.DB.DataReader).toJson(t);r&&r(f)}),f};i.prototype.saveStatment=function(){var n;if(this.$super.dGrid==null)return!1;var r=this.$super.mTab.getValue("C_BankStatement_ID"),i={},t=this.$super.multiValues;if(t==null||t.length<=0)return!1;for(n=0;n<t.length;n++)i[n]=t[n];return this.saveData(i,"",r)};i.prototype.saveData=function(i,r,u){var f=this;t.ajax({type:"POST",url:n.Application.contextUrl+"Common/SaveStatment",dataType:"json",data:{model:i,selectedItems:r,C_BankStatement_ID:u},success:function(n){if(returnValue=n.result,returnValue){f.dispose();f.$super.$root.dialog("close");f.$super.setBusy(!1);return}f.$super.setBusy(!1);alert(returnValue)},error:function(n,t,i){console.log(t);f.$super.setBusy(!1);alert(i)}})};i.prototype.dispose=function(){this.disposeComponent!=null&&this.disposeComponent()};n.VCreateFromStatement=i}(VIS,jQuery),function(n,t){function i(t){function f(){var t,u;return i.title=n.Msg.getMsg("ProvisionalInvoice")+" .. "+n.Msg.getMsg("CreateFrom"),i.relatedToOrg=null,i.fromInvoice=!1,i.ProvisionalInvoice=!0,i.lblInvoice!=null&&i.lblInvoice.getControl().css("display","none"),i.cmbInvoice!=null&&i.cmbInvoice.getControl().css("display","none"),i.lblLocator!=null&&i.lblLocator.getControl().css("display","none"),i.locatorField!=null&&i.locatorField.getControl().css("display","none"),i.deliveryDate=new n.Controls.VDate("DeliveryDate",!1,!1,!0,n.DisplayType.Date,"DeliveryDate"),t=n.MLookupFactory.getMLookUp(n.Env.getCtx(),i.windowNo,2221,n.DisplayType.Search),i.vProduct=new n.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,n.DisplayType.Search,t),u=i.initBPartnerForProvisional(),i.vBPartner.setReadOnly(!0),e(u),r.getTableFieldVOs(),!0}function e(t){o(n.Env.getCtx(),t)}function o(t,u){var s="Y".equals(n.Env.getCtx().getWindowContext(r.windowNo,"IsDropShip")),h="Y".equals(n.Env.getCtx().getWindowContext(r.windowNo,"IsSOTrx")),c=n.dataContext.getJSONRecord("MDocType/GetDocType",n.Env.getCtx().getContextAsInt(r.windowNo,"C_DocType_ID").toString()),e=n.Utility.Util.getValueOfBoolean(c.IsReturnTrx),f=" M_InOut_ID IN (SELECT s.M_InOut_ID FROM M_InOut s WHERE s.C_BPartner_ID = "+u+" AND s.IsSOTrx = '"+(h?"Y":"N")+"' AND s.DocStatus IN('CL', 'CO') AND s.IsDropShip='"+(s?"Y":"N")+"'",o;e!=null&&(f+=" AND S.IsReturnTrx='"+(e==!0?"Y":"N")+"'");f+=" AND s.M_InOut_ID IN (SELECT t.M_InOut_ID FROM (SELECT sl.M_InOut_ID, sl.M_InOutLine_ID, sl.MovementQty,  (SELECT SUM(NVL(il.QtyInvoiced, 0)) FROM C_InvoiceLine il INNER JOIN C_Invoice I ON I.C_INVOICE_ID = il.C_INVOICE_ID WHERE i.DocStatus NOT IN ('VO', 'RE') AND sl.M_InOutLine_ID = il.M_InOutLine_ID) AS QtyInvoiced FROM M_InOutLine sl) t GROUP BY t.M_InOut_ID, t.M_InOutLine_ID, t.MovementQty HAVING t.MovementQty > SUM(NVL(t.QtyInvoiced, 0))))";o=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,0,n.DisplayType.Search,"M_InOut_ID",0,!1,f);i.cmbShipment=new n.Controls.VTextBoxButton("M_InOut_ID",!0,!1,!0,n.DisplayType.Search,o)}var i=this.$super,r,u;i.constructor(t);r=this;f();i.jbInit();i.initOK=!0;u=t.getWindowNo();this.log=n.Logging.VLogger.getVLogger("VCreateFormProvisionalInvoice");this.disposeComponent=function(){i=null;r=null;this.disposeComponent=null}}n.Utility.inheritPrototype(i,n.VCreateFrom);i.prototype.getTableFieldVOs=function(){var t=this.$super,i=this;t.arrListColumns=[];t.arrListColumns.push({field:"Quantity",caption:n.Msg.getMsg("QtyPending"),sortable:!1,size:"150px",hidden:!1,render:function(n){var t=n.Quantity;return parseFloat(t).toLocaleString(undefined,{minimumFractionDigits:4})}});t.arrListColumns.push({field:"QuantityPending",caption:n.Msg.getMsg("Quantity"),sortable:!1,size:"150px",render:"number:4",hidden:!0});t.arrListColumns.push({field:"QuantityEntered",caption:n.Msg.getMsg("QtyEntered"),sortable:!1,size:"150px",hidden:!1,render:function(n){var i=n.QuantityEntered;return i=t.checkcommaordot(event,i),parseFloat(i).toLocaleString(undefined,{minimumFractionDigits:4})}});t.arrListColumns.push({field:"POPrice",caption:n.Msg.getMsg("POPrice"),sortable:!1,size:"150px",hidden:!1,render:function(n){var t=n.POPrice;return parseFloat(t).toLocaleString(undefined,{minimumFractionDigits:4})}});t.arrListColumns.push({field:"ProvisionalPrice",caption:n.Msg.getMsg("ProvisionalPrice"),sortable:!1,size:"150px",hidden:!1,render:function(n){var t=n.ProvisionalPrice;return parseFloat(t).toLocaleString(undefined,{minimumFractionDigits:4})}});t.arrListColumns.push({field:"C_UOM_ID",caption:n.Msg.getMsg("UomName"),sortable:!1,size:"150px",hidden:!1});t.arrListColumns.push({field:"M_Product_SearchKey",caption:n.Msg.getMsg("ProductSearchKey"),sortable:!1,size:"150px",hidden:!1});t.arrListColumns.push({field:"M_Product_ID",caption:n.Msg.getMsg("ProductName"),sortable:!0,size:"150px",hidden:!1});t.arrListColumns.push({field:"M_AttributeSetInstance_ID",caption:n.Msg.getMsg("ASI"),sortable:!1,size:"150px",editable:{type:"custom",ctrl:i.$productAttribute,showAll:!0,style:"background-color: #f8f8f8;"},render:function(n){var t=i.pattrLookup,r=n.M_AttributeSetInstance_ID,u;return n.changes&&typeof n.changes.M_AttributeSetInstance_ID!="undefined"&&(r=n.changes.M_AttributeSetInstance_ID),t&&(u=t.getDisplay(r,!0)),u},style:"background-color: #d1d1d14a"});t.arrListColumns.push({field:"C_PaymentTerm_ID",caption:n.Msg.getMsg("C_PaymentTerm_ID"),sortable:!1,size:"150px",hidden:!0});t.arrListColumns.push({field:"PaymentTermName",caption:n.Msg.getMsg("PaymentTermName"),sortable:!1,size:"150px",hidden:!1});t.arrListColumns.push({field:"IsAdvance",caption:n.Msg.getMsg("IsAdvance"),sortable:!1,size:"150px",hidden:!0});t.arrListColumns.push({field:"C_InvoicePaymentTerm_ID",caption:n.Msg.getMsg("C_InvoicePaymentTerm_ID"),sortable:!1,size:"150px",hidden:!0});t.arrListColumns.push({field:"IsInvoicePTAdvance",caption:n.Msg.getMsg("IsInvoicePTAdvance"),sortable:!1,size:"150px",hidden:!0});t.arrListColumns.push({field:"C_Order_ID",caption:n.Msg.getMsg("OrderLine"),sortable:!1,size:"150px",hidden:!1});t.arrListColumns.push({field:"M_InOut_ID",caption:n.Msg.getMsg("Shipment/Receipt"),sortable:!1,size:"150px",hidden:!1});t.arrListColumns.push({field:"C_Invoice_ID",caption:n.Msg.getMsg("Invoice"),sortable:!1,size:"150px",hidden:!1});t.arrListColumns.push({field:"C_UOM_ID_K",caption:n.Msg.getMsg("UomName"),sortable:!1,size:"150px",hidden:!0});t.arrListColumns.push({field:"M_Product_ID_K",caption:n.Msg.getMsg("ProductName"),sortable:!1,size:"150px",hidden:!0});t.arrListColumns.push({field:"C_Order_ID_K",caption:n.Msg.getMsg("Order"),sortable:!1,size:"150px",hidden:!0});t.arrListColumns.push({field:"M_InOut_ID_K",caption:n.Msg.getMsg("Shipment/Receipt"),sortable:!1,size:"150px",hidden:!0});t.arrListColumns.push({field:"C_Invoice_ID_K",caption:n.Msg.getMsg("Invoice"),sortable:!1,size:"150px",hidden:!0});t.arrListColumns.push({field:"Select",caption:n.Msg.getMsg("Select"),sortable:!1,size:"50px",hidden:!0,render:function(){return'<div><input type=checkbox disabled="true"><\/div>'}})};i.prototype.saveProvisionalInvoice=function(){var r,t,i;if(this.$super.dGrid==null||(r={},t=this.$super.multiValues,t==null)||t.length<=0)return!1;for(i=0;i<t.length;i++)r[i]=t[i];var u=this.$super.mTab.getValue("C_ProvisionalInvoice_ID"),f=n.Utility.Util.getValueOfInt(this.$super.cmbOrder.getValue()),e=n.Utility.Util.getValueOfInt(this.$super.cmbShipment.getValue());return this.saveData(r,"",f,e,u)};i.prototype.saveData=function(i,r,u,f,e){var o=this;t.ajax({type:"POST",url:n.Application.contextUrl+"Common/SaveProvisionalInvoice",dataType:"json",data:{model:i,selectedItems:r,C_Order_ID:u,C_ProvisionalInvoice_ID:e,M_inout_id:f},success:function(n){if(returnValue=n.result,returnValue){o.dispose();o.$super.$root.dialog("close");o.$super.setBusy(!1);return}o.$super.setBusy(!1);alert(returnValue)},error:function(n,t,i){console.log(t);o.$super.setBusy(!1);alert(i)}})};i.prototype.loadShipments=function(t,i,r){var u=this.getShipmentsData(n.Env.getCtx(),t,i,r)};i.prototype.getShipmentsData=function(i,r,u,f){var e=this,o,c,s,h;if(this.$super.record_ID=$self.mTab.getValue("C_ProvisionalInvoice_ID"),e.$super.dGrid!=null){o=e.$super.dGrid.getSelection();for(item in o)c=t.grep(e.$super.multiValues,function(n){return n.M_Product_ID_K==e.$super.dGrid.get(o[item]).M_Product_ID_K&&n.M_InOut_ID_K==e.$super.dGrid.get(o[item]).M_InOut_ID_K}),c.length>0||e.$super.multiValues.push(e.$super.dGrid.get(o[item]))}return s="",h="",s=n.Env.isBaseLanguage(i,"C_UOM")?"FROM C_UOM uom INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom Left join C_UOM uom1 on (uom1.C_UOM_ID=uom.C_UOM_ID)  INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"') ",u!=null&&(h=" AND l.M_Product_ID="+u),f||(f=1),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetDataVCreateFrom",dataType:"json",type:"POST",data:{keyColumnName:e.$super.mTab.keyColumnName,tableName:"M_InOutLine",recordID:e.$super.record_ID,pageNo:f,mInOutId:r,isBaseLanguages:s,mProductIDD:h},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));e.$super.setBusy(!1);selfChild.log.info(t);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);e.$super.setBusy(!1);return}e.$super.resetPageCtrls(i.pSetting);e.$super.loadGrid(i.data);e.$super.setBusy(!1)}}),[]};i.prototype.dispose=function(){this.disposeComponent!=null&&this.disposeComponent()};n.VCreateFormProvisionalInvoice=i}(VIS,jQuery),function(n,t){function i(i,r,u){var f,e;this.windowNo=i;this.AD_Client_ID=r;this.AD_Org_ID=0;this.DateFrom=null;this.DateTo=null;f=this;this.ASchemas=[];this.ASchema=[];this.log=n.Logging.VLogger.getVLogger("AccountViewer");this.dataByData=null;this._elements=[];this.documentQuery=!1;this.C_AcctSchema_ID=0;this.PostingType="";this.AD_Table_ID=u;this.Record_ID=0;this.whereInfo=[];this.tableInfo=[];this.displayQty=!1;this.displaySourceAmt=!1;this.displayDocumentInfo=!1;this.sortBy1="";this.sortBy2="";this.sortBy3="";this.sortBy4="";this.group1=!1;this.group2=!1;this.group3=!1;this.group4=!1;this._leadingColumns=0;this._ref1=null;this._ref2=null;this.TABLE_ALIAS="zz";this.FUNCTION_COUNT="Count";this.FUNCTION_SUM="Sum";this.onLoaded=null;this.HasOrgUnit=null;this.AD_Client_ID==0&&(this.AD_Client_ID=n.Env.getCtx().getContextAsInt(this.windowNo,"AD_Client_ID"));this.AD_Client_ID==0&&(this.AD_Client_ID=n.Env.getCtx().ctx.AD_Client_ID);this.AD_Org_ID==0&&(this.AD_Org_ID=Number(n.context.getWindowTabContext(this.windowNo,0,"AD_Org_ID")));e=["AmtAcctCr","AmtAcctDr","AmtSourceCr","AmtSourceDr",];n.translatedTexts=n.Msg.translate(n.Env.getCtx(),e,!0);this.ELEMENTTYPE_AD_Reference_ID=181;this.ELEMENTTYPE_Account="AC";this.ELEMENTTYPE_Activity="AY";this.ELEMENTTYPE_BPartner="BP";this.ELEMENTTYPE_LocationFrom="LF";this.ELEMENTTYPE_LocationTo="LT";this.ELEMENTTYPE_Campaign="MC";this.ELEMENTTYPE_Organization="OO";this.ELEMENTTYPE_OrgTrx="OT";this.ELEMENTTYPE_Project="PJ";this.ELEMENTTYPE_Product="PR";this.ELEMENTTYPE_SubAccount="SA";this.ELEMENTTYPE_SalesRegion="SR";this.ELEMENTTYPE_UserList1="U1";this.ELEMENTTYPE_UserList2="U2";this.ELEMENTTYPE_UserElement1="X1";this.ELEMENTTYPE_UserElement2="X2";this.getClientAcctSchema=function(i,r){var e=[],u=this;return t.ajax({url:n.Application.contextUrl+"AcctViewerData/GetClientAcctSchema",type:"POST",async:!0,data:{ad_client_id:i,ad_org_id:r},success:function(t){var r,f,o,i,s;if(t.result&&t.result.AcctSchemas)for(r=t.result.AcctSchemas,i=0;i<r.length;i++)f={},c_acctschema_id=r[i].Key,f.Key=c_acctschema_id,f.Name=n.Utility.encodeText(r[i].Name),e.push(f);if(t.result&&t.result.OtherAcctSchemas)for(o=t.result.OtherAcctSchemas,i=0;i<o.length;i++)s={},s.Key=o[i].Key,s.Name=n.Utility.encodeText(o[i].Name),e.push(s);u.ASchemas=e;u.ASchema=e[0];u.onLoaded&&u.onLoaded()},error:function(n){f.log.info(n);u.onLoaded&&u.onLoaded()}}),e};this.getClientAcctSchema(this.AD_Client_ID,this.AD_Org_ID)}function r(r,u,f,e,o){function wf(){uf.getControl().text(n.Msg.getMsg("Selection"));wr.getControl().text(n.Msg.translate(n.Env.getCtx(),cr));li.getControl().text(n.Msg.translate(n.Env.getCtx(),cr));br.getControl().text(n.Msg.translate(n.Env.getCtx(),yu));et.find("label").text(n.Msg.getMsg(pu));gr.getControl().text(n.Msg.translate(n.Env.getCtx(),lr));nu.getControl().text(n.Msg.translate(n.Env.getCtx(),wi));kr.getControl().text(n.Msg.translate(n.Env.getCtx(),wu));dr.getControl().text(n.Msg.translate(n.Env.getCtx(),"AcctDateTo"));tu.getControl().text(n.Msg.translate(n.Env.getCtx(),vr));iu.getControl().text(n.Msg.translate(n.Env.getCtx(),yr));ru.getControl().text(n.Msg.translate(n.Env.getCtx(),"Project"));ku.getControl().text(n.Msg.translate(n.Env.getCtx(),pr));rf.getControl().text(n.Msg.translate(n.Env.getCtx(),"OrganizationUnit"));ff.getControl().text(n.Msg.getMsg("Display"));tr.find("label").text(n.Msg.getMsg("DisplayQty"));ur.find("label").text(n.Msg.getMsg("DisplaySourceInfo"));rr.find("label").text(n.Msg.getMsg("DisplayDocumentInfo"));uu.getControl().text(n.Msg.getMsg("SortBy"));fu.getControl().text(n.Msg.getMsg("GroupBy"));lt.getControl().css("color","rgba(var(--v-c-primary), 1)");v.text(n.Msg.getMsg("RePost"));notShowPosted?(v.hide(),tt.find("label").text(n.Msg.getMsg("Force")),tt.hide()):(v.show(),tt.find("label").text(n.Msg.getMsg("Force")),tt.show())}function cu(){hi.css("color","rgba(var(--v-c-on-secondary), 1)");si.css("font-size","1rem").css("color","rgba(var(--v-c-primary), 1)");wt.show();b.show();ulPaging.css("display","none");divPaging.css("display","none");ii.css("display","none");v.hide();tt.hide();it.show();lt.getControl().show();ir.hide();li.getControl().hide();nt.getControl().hide();b.find("#btnSelctDoc_"+h).attr("name",b.find("#btnSelctDoc_"+h).parent().find("select").val()+"_ID");b.find("#btnSelctDocClear_"+h).attr("name",b.find("#btnSelctDocClear_"+h).parent().find("select").val()+"_ID")}function or(){si.css("color","rgba(var(--v-c-on-secondary), 1)");hi.css("font-size","1rem").css("color","rgba(var(--v-c-primary), 1)");wt.hide();b.hide();ulPaging.css("display","block");divPaging.css("display","block");ir.show();it.hide();lt.getControl().hide();divPaging.append(ulPaging);at.append(divPaging);ii.css("display","block");notShowPosted?(v.hide(),tt.hide()):(v.show(),tt.show());li.getControl().show();nt.getControl().show()}function bf(){divPaging=t('<div class="vis-info-pagingwrp" style="text-align: right; flex: 1;">');ulPaging=t('<ul class="vis-statusbar-ul">');liFirstPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="'+n.Msg.getMsg("FirstPage")+'" style="opacity: 0.6;"><\/i><\/div><\/li>');liPrevPage=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="'+n.Msg.getMsg("PageUp")+'" style="opacity: 0.6;"><\/i><\/div><\/li>');cmbPage=t("<select>");liCurrPage=t("<li>").append(cmbPage);liNextPage=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="'+n.Msg.getMsg("PageDown")+'" style="opacity: 0.6;"><\/i><\/div><\/li>');liLastPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="'+n.Msg.getMsg("LastPage")+'" style="opacity: 0.6;"><\/i><\/div><\/li>');ulPaging.append(liFirstPage).append(liPrevPage).append(liCurrPage).append(liNextPage).append(liLastPage);kf()}function kf(){liFirstPage.on("click",function(){t(this).css("opacity")=="1"&&(l(!0),s.Query(r,ri,ui,1))});liPrevPage.on("click",function(){t(this).css("opacity")=="1"&&(l(!0),s.Query(r,ri,ui,parseInt(cmbPage.val())-1))});liNextPage.on("click",function(){t(this).css("opacity")=="1"&&(l(!0),s.Query(r,ri,ui,parseInt(cmbPage.val())+1))});liLastPage.on("click",function(){t(this).css("opacity")=="1"&&(l(!0),s.Query(r,ri,ui,parseInt(cmbPage.find("Option:last").val())))});cmbPage.on("change",function(){l(!0);s.Query(r,ri,ui,cmbPage.val())})}function l(n){hr.css("display",n?"block":"none")}function df(i){var e,s,o,u,f,r,l;for(c.dGrid!=null&&(c.dGrid.destroy(),c.dGrid=null),c.arrListColumns=[],e=[],s=1,o=0;o<i.Data.length;o++){for(u=i.Data[o],ir.text(i.DebitandCredit),f={},r=0;r<i.Columns.length;r++)c.arrListColumns.length!=i.Columns.length&&(u[r]!=null&&typeof u[r]=="number"&&(n.translatedTexts.AmtAcctCr==i.Columns[r]||n.translatedTexts.AmtAcctDr==i.Columns[r]||n.translatedTexts.AmtSourceCr==i.Columns[r]||n.translatedTexts.AmtSourceDr==i.Columns[r])?c.arrListColumns.push({field:i.Columns[r],caption:n.Msg.translate(n.Env.getCtx(),i.Columns[r]),sortable:!0,size:"16%",hidden:!1,style:"text-align: right"}):c.arrListColumns.push({field:i.Columns[r],caption:n.Msg.translate(n.Env.getCtx(),i.Columns[r]),sortable:!0,size:"16%",hidden:!1})),u[r]!=null&&typeof u[r]=="object"?f[i.Columns[r]]=u[r].Name:u[r]!=null&&i.Columns[r].indexOf("Date")>0?u[r]!=""&&(l=new Date(parseInt(u[r].substr(6))),e!=null&&(f[i.Columns[r]]=l.toLocaleDateString())):f[i.Columns[r]]=u[r]!=null&&typeof u[r]=="number"&&(n.translatedTexts.AmtAcctCr==i.Columns[r]||n.translatedTexts.AmtAcctDr==i.Columns[r]||n.translatedTexts.AmtSourceCr==i.Columns[r]||n.translatedTexts.AmtSourceDr==i.Columns[r])?parseFloat(u[r]).toLocaleString(undefined,{minimumFractionDigits:i.Precision,maximumFractionDigits:i.Precision}):u[r];f.recid=s;s++;e.push(f)}setTimeout(10);w2utils.encodeTags(e);c.dGrid=t(ii).w2grid({name:"gridAccViewer"+h,recordHeight:37,columns:c.arrListColumns,records:e})}function vt(n){var i=n.attr("name"),t;return n.find("span").text(" "),s.whereInfo.length>0&&(t=s.whereInfo.map(function(n){return n.Key==i}).indexOf(!0),s.whereInfo.splice(t,1)),n.width=44,0}function gf(){if(si!=null)si.on(n.Events.onTouchStartOrClick,function(){cu()});if(hi!=null)hi.on(n.Events.onTouchStartOrClick,function(){c.dGrid.refresh();or()});if(yt!=null&&yt.getControl().change(function(){ef()}),nt!=null&&nt.getControl().change(function(){l(!0);s.C_AcctSchema_ID=nt.getControl().find("option:selected").val();setTimeout(function(){s.Query(r,ri,ui,1)},2)}),it!=null)it.on("click",function(){l(!0);nt.setValue(yt.getControl().find("option:selected").val());sr();l(!1)});if(et!=null&&et.change(function(){of()}),pt!=null&&pt.getControl().change(function(){sf();s.Record_ID=f;s.AD_Table_ID}),v!=null)v.on("click",function(){l(!0);var n=re();setTimeout(function(){n?ne(s.Record_ID):l(!1)},5)});if(a!=null)a.on("click",function(){fi(a)});if(k!=null)k.on("click",function(){fi(k)});if(y!=null)y.on("click",function(){fi(y)});if(p!=null)p.on("click",function(){fi(p)});if(w!=null)w.on("click",function(){fi(w)});if(d!=null)d.on("click",function(){fi(d)});if(g!=null)g.on("click",function(){fi(g)});if(ot!=null)ot.on("click",function(){vt(a)});if(st!=null)st.on("click",function(){vt(k)});if(rt!=null)rt.on("click",function(){vt(y)});if(ut!=null)ut.on("click",function(){vt(p)});if(ft!=null)ft.on("click",function(){vt(w)});if(ht!=null)ht.on("click",function(){vt(d)});if(ct!=null)ct.on("click",function(){vt(g)})}function ne(i){t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerRePost",type:"POST",async:!0,data:{dataRecID:i},success:function(){},error:function(n){$selfObj.log.info(n);l(!1)}})}function te(){var u,f;notShowPosted=n.Env.getCtx().getContext("#SHOW_REPOST").equals("N");fr=t("<div id='topDiv_"+h+"' style='float: left; width: 100%;'><div id='queryDiv_"+h+"'style='display: inline-block; margin-right: 15px; margin-top: 5px' ><label id='lblquery_"+h+"' class='VIS_Pref_Label_Font' style='cursor: pointer;font-size: 1rem;color: rgba(var(--v-c-primary), 1);'>"+n.Msg.getMsg("ViewerQuery")+"<\/label><\/div><div id='resulttopDiv_"+h+"' style='display: inline-block; width: 160px;'><label id='lblresult_"+h+"' class='VIS_Pref_Label_Font' style='vertical-align: middle; cursor: pointer;'>"+n.Msg.getMsg("ViewerResult")+"<\/label><\/div><\/div><\/div>");var l=t("<div id='resultTopFilterDiv_"+h+"' style='float: right;width: 50%;'>"),d=t('<div class="input-group vis-input-wrap">'),ht=t('<div class="vis-control-wrap">');l.append(d);d.append(ht);ht.append(nt.getControl()).append(li.getControl());fr.append(l);b=t("<div class='vis-leftsidebarouterwrap' id='leftSideDiv_"+h+"' style='float: left;background-color: rgba(var(--v-c-secondary), 1);overflow: auto;padding: 10px;'>");n.Application.isRTL&&b.css("float","right");b.css("width","50%");b.css("height",er);ti=t("<div style='float: left;width: 100%;height: 100%;' id='parameterLeftDiv_"+h+"'>");b.append(ti);var e=t("<table style='width: 100%;height: 100%;'>"),r=t("<tr>"),i=t("<td>"),u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">');ti.append(e);e.append(r);r.append(i);i.append(u);u.append(f);f.append(yt.getControl()).append(wr.getControl());r=t("<tr>");u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);f.append(bi.getControl()).append(br.getControl());r=t("<tr>");i=t("<td>");u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');e.append(r);r.append(i);i.append(u);u.append(f);f.append(et);r=t("<tr>");i=t("<td>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');e.append(r);r.append(i);i.append(u);u.append(f);u.append(o);f.append(pt.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," "));o.append(a).append(ot);r=t("<tr>");u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);f.append(ai).append(kr.getControl());r=t("<tr>");u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);f.append(vi).append(dr.getControl());r=t("<tr>");u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);f.append(oi.getControl()).append(gr.getControl());r=t("<tr>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">'),s=t('<input type="text" readonly data-hasbtn=" ">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);u.append(o);f.append(s).append(nu.getControl());o.append(k).append(st);r=t("<tr>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">'),s=t('<input type="text" readonly data-hasbtn=" ">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);u.append(o);f.append(s).append(rf.getControl());o.append(g).append(ct);r=t("<tr>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">'),s=t('<input type="text" readonly data-hasbtn=" ">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);u.append(o);f.append(s).append(tu.getControl());o.append(y).append(rt);r=t("<tr>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">'),s=t('<input type="text" readonly data-hasbtn=" ">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);u.append(o);f.append(s).append(iu.getControl());o.append(p).append(ut);r=t("<tr>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">'),s=t('<input type="text" readonly data-hasbtn=" ">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);u.append(o);f.append(s).append(ru.getControl());o.append(w).append(ft);wt=t("<div id='rightSideDiv_"+h+"' style='float: right;margin-bottom: 3px; margin-right: 0px; '>");wt.css("width","50%");wt.css("height",er);ti=t("<div style='float: left;width: 100%;height: 100%;' id='parameterRightDiv_"+h+"'>");wt.append(ti);e=t("<table style='width: 100%;height: 100%;'>");r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");ti.append(e);e.append(r);r.append(i);i.append(rr);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(ur);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(tr);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(uu.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));i=t("<td style='padding: 0px 15px 0px;'>");r.append(i);i.append(fu.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(kt.getControl().css("display","inline-block").css("width","100%").css("height","32px"));i=t("<td style='padding: 0px 15px 0px;'>");r.append(i);i.append(eu);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(dt.getControl().css("display","inline-block").css("width","100%").css("height","32px"));i=t("<td style='padding: 0px 15px 0px;'>");r.append(i);i.append(ou);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(gt.getControl().css("display","inline-block").css("width","100%").css("height","32px"));i=t("<td style='padding: 0px 15px 0px;'>");r.append(i);i.append(su);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(ni.getControl().css("display","inline-block").css("width","100%").css("height","32px"));i=t("<td style='padding: 0px 15px 0px;'>");r.append(i);i.append(hu);at=t("<div class='vis-acctviewerbottdiv'>");c.getIsMenu()||(at.append(v),at.append(tt).append(ir));at.append(lt.getControl().addClass("VIS_Pref_Label_Font"));at.append(it);at.append(ci);ii=t("<div id='resultDiv_"+h+"' style='float: left; width: 100%; display: none;'>");ii.css("height",er);bt.append(fr).append(b).append(wt).append(ii).append(at);bt.append(hr)}function ie(t,u){s=new i(h,r,t);s.onLoaded=function(){pi(yt.getControl(),s.getAcctSchema());nt.getControl().append("<option value='-1' ><\/option>");pi(nt.getControl(),s.getAcctSchema());ef();pi(pt.getControl(),s.getTable());pi(bi.getControl(),s.getPostingType());pi(oi.getControl(),s.getOrg());a.find("span").text("");k.attr("Name",wi);st.attr("Name",wi);k.find("span").text("");y.attr("Name",vr);rt.attr("Name",vr);y.find("span").text("");p.attr("Name",yr);ut.attr("Name",yr);p.find("span").text("");w.attr("Name",bu);ft.attr("Name",bu);w.find("span").text("");d.attr("Name",pr);ht.attr("Name",pr);d.find("span").text("");g.attr("Name",ar);ct.attr("Name",ar);g.find("span").text("");var i=t!=0&&u!=0;i&&et.find("input").prop("checked",!0);of();sf();lt.getControl().text(n.Msg.getMsg("VIS_EnterSelctionAndDisplayToQueryFind"));lt.getControl().css("color","rgba(var(--v-c-primary), 1)");i&&(s.AD_Table_ID=t,s.Record_ID=u);sr()}}function ef(){var o=yt.getControl().find("option:selected").val(),e,r,t,i,u;if(o!=null){for(s.C_AcctSchema_ID=o,e=s.getAcctSchemaElements(s.C_AcctSchema_ID),kt.getControl().empty(),dt.getControl().empty(),gt.getControl().empty(),ni.getControl().empty(),yi({Key:"",Name:""}),yi({Key:"DateAcct",Name:n.Msg.translate(n.Env.getCtx(),"DateAcct")}),yi({Key:"DateTrx",Name:n.Msg.translate(n.Env.getCtx(),"DateTrx")}),yi({Key:"C_Period_ID",Name:n.Msg.translate(n.Env.getCtx(),"C_Period_ID")}),r=[],r.push(du),r.push(gu),r.push(nf),r.push(tf),t=[],t.push(y),t.push(p),t.push(w),t.push(d),t.push(rt),t.push(ut),t.push(ft),t.push(ht),t.push(ki),t.push(di),t.push(gi),t.push(nr),t.push(g),t.push(ct),i=0,u=0;u<e.length&&i<r.length;u++){var f=e[u][0],h=s.getColumnName(f.elementtype),c=s.getColumnName(f.elementtype);yi({Key:h,Name:n.Msg.translate(n.Env.getCtx(),c)});f.elementtype=="OO"||f.elementtype=="AC"||(r[i].getControl().text(n.Msg.translate(n.Env.getCtx(),c)),r[i].getControl().show(),t[i].attr("Name",h),t[i].find("span").text(""),t[i].show(),i++)}while(i<r.length)r[i].getControl().hide(),i++;kt.getControl().prop("selectedIndex",0);dt.getControl().prop("selectedIndex",0);gt.getControl().prop("selectedIndex",0);ni.getControl().prop("selectedIndex",0)}}function yi(n){kt.getControl().append(" <option selected value='"+n.Key+"' >"+n.Name+"<\/option>");dt.getControl().append(" <option selected value='"+n.Key+"' >"+n.Name+"<\/option>");gt.getControl().append(" <option selected value='"+n.Key+"' >"+n.Name+"<\/option>");ni.getControl().append(" <option selected value='"+n.Key+"' >"+n.Name+"<\/option>")}function sr(){var t="",i,u,f,e;if(s.C_AcctSchema_ID=0,s.AD_Org_ID=0,i=yt.getControl().find("option:selected").val(),i!=null&&(s.C_AcctSchema_ID=i),t=t.concat("C_AcctSchema_ID=").concat(s.C_AcctSchema_ID),i=bi.getControl().find("option:selected").val(),i!=null&&i!="0"&&(s.PostingType=i),t=t.concat(", PostingType=").concat(s.PostingType),s.documentQuery=et.find("input").prop("checked"),t=t.concat(", DocumentQuery=").concat(s.documentQuery),et.find("input").prop("checked")){if(s.AD_Table_ID==0||s.Record_ID==0)return;t=t.concat(", AD_Table_ID=").concat(s.AD_Table_ID).concat(", Record_ID=").concat(s.Record_ID)}else if(s.DateFrom=ai.val(),s.DateFrom!=""&&(t=t.concat(", DateFrom=").concat(s.DateFrom)),s.DateTo=vi.val(),s.DateTo!=""&&(t=t.concat(", DateTo=").concat(s.DateTo)),i=oi.getControl().find("option:selected").val(),i!=null&&(s.AD_Org_ID=i),t=t.concat(", AD_Org_ID=").concat(s.AD_Org_ID),u=s.whereInfo,u!=null)for(f=0;f<u.length;f++)t=t.concat(", ").concat(u[f].Value);s.displayQty=tr.prop("checked");t=t.concat(", - Display Qty=").concat(s.displayQty);s.displaySourceAmt=ur.prop("checked");t=t.concat(", Source=").concat(s.displaySourceAmt);s.displayDocumentInfo=rr.prop("checked");t=t.concat(", Doc=").concat(s.displayDocumentInfo);kt.getControl().find("option:selected").val()!=null&&(s.sortBy1=kt.getControl().find("option:selected").val());s.group1=eu.prop("checked");t=t.concat(" - Sorting: ").concat(s.sortBy1).concat("/").concat(s.group1);dt.getControl().find("option:selected").val()!=null&&(s.sortBy2=dt.getControl().find("option:selected").val());s.group2=ou.prop("checked");t=t.concat(", ").concat(s.sortBy2).concat("/").concat(s.group2);gt.getControl().find("option:selected").val()!=null&&(s.sortBy3=gt.getControl().find("option:selected").val());s.group3=su.prop("checked");t=t.concat(", ").concat(s.sortBy3).concat("/").concat(s.group3);ni.getControl().find("option:selected").val()!=null&&(s.sortBy4=ni.getControl().find("option:selected").val());s.group4=hu.prop("checked");t=t.concat(", ").concat(s.sortBy4).concat("/").concat(s.group4);it.Enabled=!1;lt.getControl().text(n.Msg.translate(n.Env.getCtx(),"Processing"));c.getIsMenu()?vu?(c.dGrid.refresh(),or()):cu():or();vu=!0;e=1;s.Query(r,ri,ui,e);s.C_AcctSchema_ID>0&&nt.setValue(s.C_AcctSchema_ID);it.Enabled=!0;lt.getControl().text(n.Msg.getMsg("VIS_EnterSelctionAndDisplayToQueryFind"))}function ri(n){n!=null&&df(n);l(!1)}function ui(n){if(cmbPage.empty(),n.TotalPage>0){for(var i=0;i<n.TotalPage;i++)cmbPage.append(t("<option value="+(i+1)+">"+(i+1)+"<\/option>"));cmbPage.val(n.CurrentPage);n.TotalPage>n.CurrentPage?(liNextPage.css("opacity","1"),liLastPage.css("opacity","1")):(liNextPage.css("opacity","0.6"),liLastPage.css("opacity","0.6"));n.CurrentPage>1?(liFirstPage.css("opacity","1"),liPrevPage.css("opacity","1")):(liFirstPage.css("opacity","0.6"),liPrevPage.css("opacity","0.6"));n.TotalPage==1&&(liFirstPage.css("opacity","0.6"),liPrevPage.css("opacity","0.6"),liNextPage.css("opacity","0.6"),liLastPage.css("opacity","0.6"))}else liFirstPage.css("opacity","0.6"),liPrevPage.css("opacity","0.6"),liNextPage.css("opacity","0.6"),liLastPage.css("opacity","0.6")}function of(){var n=et.find("input").prop("checked");n?(pt.getControl().removeAttr("disabled"),a.removeAttr("disabled"),ot.removeAttr("disabled"),ai.attr("disabled","disabled"),vi.attr("disabled","disabled"),oi.getControl().attr("disabled","disabled"),k.attr("disabled","disabled"),y.attr("disabled","disabled"),p.attr("disabled","disabled"),w.attr("disabled","disabled"),d.attr("disabled","disabled"),g.attr("disabled","disabled"),st.attr("disabled","disabled"),rt.attr("disabled","disabled"),ut.attr("disabled","disabled"),ft.attr("disabled","disabled"),ht.attr("disabled","disabled"),ct.attr("disabled","disabled"),ki.attr("disabled","disabled"),di.attr("disabled","disabled"),gi.attr("disabled","disabled"),nr.attr("disabled","disabled")):(pt.getControl().attr("disabled","disabled"),a.attr("disabled","disabled"),ot.attr("disabled","disabled"),ai.removeAttr("disabled"),vi.removeAttr("disabled"),oi.getControl().removeAttr("disabled"),k.removeAttr("disabled"),y.removeAttr("disabled"),p.removeAttr("disabled"),w.removeAttr("disabled"),d.removeAttr("disabled"),g.removeAttr("disabled"),st.removeAttr("disabled"),rt.removeAttr("disabled"),ut.removeAttr("disabled"),ft.removeAttr("disabled"),ht.removeAttr("disabled"),ct.removeAttr("disabled"),ki.removeAttr("disabled"),di.removeAttr("disabled"),gi.removeAttr("disabled"),nr.removeAttr("disabled"))}function sf(){var n=pt.getControl().find("option:selected").val();n!=null&&jQuery.grep(s.tableInfo,function(t){return t.Name==n})[0]!=null&&(s.AD_Table_ID=jQuery.grep(s.tableInfo,function(t){return t.Name==n})[0].Key);a.find("span").text("");a.attr("Name",n+"_ID");ot.attr("Name",n+"_ID")}function fi(t){var u,o,f;s.HasOrgUnit==null&&fe();var r=t.attr("name"),e="IsSummary='N'",i=r;r.equals("Account_ID")?(i="C_ElementValue_ID",u=s.getAcctSchemaElement("AC"),u!=null&&(e+=" AND C_Element_ID="+u.c_element_id)):r.equals("User1_ID")?(i="C_ElementValue_ID",u=s.getAcctSchemaElement("U1"),u!=null&&(e+=" AND C_Element_ID="+u.c_element_id)):r.equals("User2_ID")?(i="C_ElementValue_ID",u=s.getAcctSchemaElement("U2"),u!=null&&(e+=" AND C_Element_ID="+u.c_element_id)):et.find("input").prop("checked")&&(e="");o=i.substring(0,i.length-3);r=="M_Product_ID"?f=new n.InfoWindow(101,"",s.windowNo,"",!1):r=="C_BPartner_ID"?f=new n.InfoWindow(100,"",s.windowNo,"",!1):r==ar?(i=lr,o=i.substring(0,i.length-3),s.HasOrgUnit&&(e+=" AND (IsCostCenter='Y' OR IsProfitCenter='Y')"),f=new n.infoGeneral(!0,s.windowNo,"",o,i,!1,e)):f=new n.infoGeneral(!0,s.windowNo,"",o,i,!1,e);f.onClose=function(){var u=null,n=f.getSelectedValues();return(n!=null&&n.length>0&&(u=i+"="+n.toString()),f=null,u==null||u.length==0||n.length==0)?(vt(t),0):(t==a?s.Record_ID=n:(vt(t),s.whereInfo.push({Key:r,Value:r+"="+n})),t.find("span").text(s.getButtonText(o,i,u)),t.find("span").text()!=""?t.AutoSize=!0:t.Width=44,n)};f.show()}function re(){n.ADialog.confirm("PostImmediate?",!0,"","Confirm",function(i){if(i){if(l(!0),s.documentQuery&&s.AD_Table_ID!=0&&s.Record_ID!=0){var r=tt.prop("checked");ue(function(i){var u=!1,f,e;i=="Yes"&&(u=!0);window.FRPT&&u?(f=Number(n.context.getWindowTabContext(h,0,"AD_Org_ID")),e=Number(n.context.getWindowTabContext(h,0,"C_DocType_ID")),t.ajax({url:n.Application.contextUrl+"FRPT/PostingLogicFRPT/PostImediateFRPT",dataType:"json",async:!0,data:{AD_Client_ID:s.AD_Client_ID,AD_Table_ID:s.AD_Table_ID,Record_ID:s.Record_ID,force:r,OrgID:f,AD_Window_ID:cf,DocTypeID:e},error:function(){l(!1);n.ADialog.info(n.Msg.getMsg("ERRORGettingPostingServer"))},success:function(t){t.result&&(n.ADialog.info("",!0,t.result,null),sr());l(!1)}})):t.ajax({url:n.Application.contextUrl+"Posting/PostImmediate",dataType:"json",data:{AD_Client_ID:s.AD_Client_ID,AD_Table_ID:s.AD_Table_ID,Record_ID:s.Record_ID,force:r},error:function(){l(!1);n.ADialog.info(n.Msg.getMsg("ERRORGettingPostingServer"))},success:function(n){n.result=="OK"&&sr();l(!1)}})})}return!0}return l(!1),!1})}function ue(i){t.ajax({url:n.Application.contextUrl+"Posting/PostByNewLogic",dataType:"json",async:!0,data:{AD_Client_ID:n.context.getAD_Client_ID()},error:function(){alert(n.Msg.getMsg("ERRORGettingPostingServer"))},success:function(n){i&&i(n.result)}})}function fe(){t.ajax({url:n.Application.contextUrl+"AcctViewerData/HasOrganizationUnit",dataType:"json",async:!1,error:function(){alert(n.Msg.getMsg("ERROR"))},success:function(n){n!=null&&(s.HasOrgUnit=n.result)}})}function pi(t,i){for(var r=0;r<i.length;r++)t.append(" <option selected value='"+i[r].Key+"' >"+n.Utility.decodeText(i[r].Name)+"<\/option>");t.prop("selectedIndex",0)}var bt=t("<div style='position:relative;'>"),hr=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>'),c=this,hf=r,lu=u,au=f,h=e,cf=o;this.arrListColumns=[];this.dGrid=null;this.menuForm=!1;var vu=!1,cr="C_AcctSchema_ID",lf="DocumentType",yu="PostingType",lr="AD_Org_ID",ar="AD_OrgTrx_ID",wi="Account_ID",pu="SelectDocument",wu="AcctDateFrom",vr="M_Product_ID",yr="C_BPartner_ID",bu="C_Project_ID",pr="C_Campaign_ID",ei=n.Application.contextUrl+"Areas/VIS/Images/base/Find24.gif",ee=n.Application.contextUrl+"Areas/VIS/Images/cancel-18.png",af=n.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png",vf=n.Application.contextUrl+"Areas/VIS/Images/base/Print24.PNG",it=t("<button id='btnRefresh_"+h+"'style='margin-top: 0;' class='VIS_Pref_btn-2'><i class='vis vis-refresh'><\/i><\/button>"),ci=t("<button class='VIS_Pref_btn-2' id='btnPrint_"+h+"' style='margin-top: 0px; margin-left: 10px;'><i class='vis vis-print'><\/button>"),v=t("<button class='VIS_Pref_btn-2' id='btnRePost_"+h+"' style='margin-top: 10px;'><img src='"+ei+"'/><\/button>"),a=t("<button class='input-group-text' Name='btnSelctDoc' id='btnSelctDoc_"+h+"'><i class='vis vis-find'><\/i><\/button>"),k=t("<button class='input-group-text' Name='btnAccount' id='btnAccount_"+h+"'><i class='vis vis-find'><\/i><\/button>"),y=t("<button class='input-group-text' Name='btnProduct' id='btnProduct_"+h+"'><i class='vis vis-find'><\/i><\/button>"),p=t("<button class='input-group-text' Name='btnBPartner' id='btnBPartner_"+h+"'><i class='vis vis-find'><\/i><\/button>"),w=t("<button class='input-group-text'Name='btnProject' id='btnProject_"+h+"'><i class='vis vis-find'><\/i><\/button>"),d=t("<button class='input-group-text' Name='btnCampaning' id='btnCampaning_"+h+"'><i class='vis vis-find'><\/i><\/button>"),g=t("<button class='input-group-text' Name='btnOrgUnit' id='btnOrgUnit_"+h+"'><i class='vis vis-find'><\/i><\/button>"),ot=t("<button Name='btnSelctDocClear' id='btnSelctDocClear_"+h+"' class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),st=t("<button  Name='btnAccountClear' id='btnAccountClear_"+h+"'   class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),rt=t("<button  Name='btnProductClear' id='btnProductClear_"+h+"'   class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),ut=t("<button Name='btnBPartnerClear' id='btnBPartnerClear_"+h+"' class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),ft=t("<button  Name='btnProjectClear' id='btnProjectClear_"+h+"'   class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),ht=t("<button Name='btnCampaningClear' id='btnCampaningClear_"+h+"' class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),ct=t("<button Name='btnOrgUnitClear' id='btnOrgUnitClear_"+h+"' class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),yt=new n.Controls.VComboBox("",!1,!1,!0),nt=new n.Controls.VComboBox("",!1,!1,!0),bi=new n.Controls.VComboBox("",!1,!1,!0),oi=new n.Controls.VComboBox("",!1,!1,!0),pt=new n.Controls.VComboBox("",!1,!1,!0),kt=new n.Controls.VComboBox("",!1,!1,!0),dt=new n.Controls.VComboBox("",!1,!1,!0),gt=new n.Controls.VComboBox("",!1,!1,!0),ni=new n.Controls.VComboBox("",!1,!1,!0),wr=new n.Controls.VLabel,li=new n.Controls.VLabel,br=new n.Controls.VLabel,kr=new n.Controls.VLabel,dr=new n.Controls.VLabel,gr=new n.Controls.VLabel,nu=new n.Controls.VLabel,tu=new n.Controls.VLabel,iu=new n.Controls.VLabel,ru=new n.Controls.VLabel,ku=new n.Controls.VLabel,uu=new n.Controls.VLabel,fu=new n.Controls.VLabel,du=new n.Controls.VLabel,gu=new n.Controls.VLabel,nf=new n.Controls.VLabel,tf=new n.Controls.VLabel,rf=new n.Controls.VLabel,ki=t("<button id='btnSel5_"+h+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+ei+"' /><span><\/span><\/button>"),di=t("<button id='btnSel6_"+h+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+ei+"' /><span><\/span><\/button>"),gi=t("<button id='btnSel7_"+h+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+ei+"' /><span><\/span><\/button>"),nr=t("<button id='btnSel8_"+h+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+ei+"' /><span><\/span><\/button>"),lt=new n.Controls.VLabel,uf=new n.Controls.VLabel,ff=new n.Controls.VLabel,si=null,hi=null,et=t("<label id='lblSelectDoc_"+h+"' class='VIS_Pref_Label_Font vis-ec-col-lblchkbox'><input id='chkSelectDoc_"+h+"' type='checkbox' checked class='VIS_Pref_automatic'>SelectDoc<\/label>"),tr=t("<input id='chkQty_"+h+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblQty_"+h+"' class='VIS_Pref_Label_Font'>chkQty<\/label><\/span>"),tt=t("<input id='chkforcePost_"+h+"' type='checkbox' class='VIS_Pref_automatic' style='display: inline-block;margin-left: 20px; margin-top: 0;'><span><label id='lblforcePost_"+h+"' class='VIS_Pref_Label_Font'>chkforcePost<\/label><\/span>"),ir=t("<span style='margin-left: 20px;'><label id='lblDrAndCR_"+h+"' class='VIS_Pref_Label_Font'><\/label><\/span>"),rr=t("<input id='chkDisDocinfo_"+h+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblDisDocinfo_"+h+"' class='VIS_Pref_Label_Font'>chkDisDocinfo<\/label><\/span>"),ur=t("<input id='chkDisSouce_"+h+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblDisSouce_"+h+"' class='VIS_Pref_Label_Font'>chkDisSouce<\/label><\/span>"),eu=t("<input id='chkSumriz1_"+h+"' type='checkbox' class='VIS_Pref_automatic'>"),ou=t("<input id='chkSumriz2_"+h+"' type='checkbox' class='VIS_Pref_automatic'>"),su=t("<input id='chkSumriz3_"+h+"' type='checkbox' class='VIS_Pref_automatic'>"),hu=t("<input id='chkSumriz4_"+h+"' type='checkbox' class='VIS_Pref_automatic'>"),ai=t("<input id='vdtpkAccDateFrom_"+h+"' type='date' name='DateOrdered'>"),vi=t("<input id='vdtpkAccDateTo_"+h+"' type='date' name='DateOrdered'>"),fr=null,b=null,wt=null,ti=null,at=null,ii=null,yf=t(window).width()/2,pf=t(window).width()/2,er=t(window).height()-200,s=null;bf();this.showDialog=function(){te();l(!0);si=bt.find("#lblquery_"+h);hi=bt.find("#lblresult_"+h);c.getIsMenu()?cu():or();v.hide();tt.hide();ci.hide();wf();gf();ie(lu,au);bt.dialog({modal:!0,resizable:!1,title:n.Msg.getMsg("AcctViewer"),width:t(window).width()/2+t(window).width()/4,position:{at:"center top",of:window},close:function(){c.dGrid!=null&&(c.dGrid.destroy(),c.dGrid=null);c.dispose();c=null;bt.dialog("destroy");bt=null}})};this.disposeComponent=function(){it&&it.off("click");ci&&ci.off("click");v&&v.off("click");a&&a.off("click");k&&k.off("click");y&&y.off("click");p&&p.off("click");w&&w.off("click");d&&d.off("click");ot&&ot.off("click");st&&st.off("click");rt&&rt.off("click");ut&&ut.off("click");ft&&ft.off("click");ht&&ht.off("click");ct&&ct.off("click");g&&g.off("click");hf=null;lu=null;au=null;h=null;this.arrListColumns=null;this.dGrid=null;cr=null;lf=null;yu=null;lr=null;wi=null;pu=null;wu=null;ei=null;af=null;vf=null;it=null;ci=null;v=null;a=null;k=null;y=null;p=null;w=null;d=null;ot=null;st=null;rt=null;ut=null;ft=null;ht=null;yt=null;nt=null;bi=null;oi=null;pt=null;kt=null;dt=null;gt=null;ni=null;wr=null;li=null;br=null;kr=null;dr=null;gr=null;nu=null;tu=null;iu=null;ru=null;ku=null;uu=null;fu=null;du=null;gu=null;nf=null;tf=null;ki=null;di=null;gi=null;nr=null;lt=null;uf=null;ff=null;si=null;hi=null;et=null;tr=null;tt=null;rr=null;ur=null;eu=null;ou=null;su=null;hu=null;ai=null;vi=null;fr=null;b=null;wt=null;ti=null;at=null;ii=null;yf=null;pf=null;er=null;s=null;hr=null;this.disposeComponent=null}}i.prototype.getAcctSchema=function(){return this.ASchemas};i.prototype.getTable=function(){var i=[],r=null,u=this;return t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerGetTabelData",type:"POST",async:!1,success:function(t){var o,f;if((this.tableInfo==undefined||this.tableInfo==null)&&(this.tableInfo=[]),t.result)for(i.push({Key:"",Name:""}),o=t.result,f=0;f<o.length;f++){var s=o[f].AD_Table_ID,e=n.Utility.encodeText(o[f].TableName),h="";h=e=="C_Order"?n.Msg.getMsg("Order"):n.Msg.translate(n.Env.getCtx(),e+"_ID");i.push({Key:e,Name:h});u.tableInfo.push({Key:s,Name:e});s==this.AD_Table_ID&&(r=e)}},error:function(n){$selfObj.log.info(n)}}),i};i.prototype.getOrg=function(){var i=[],r=this.AD_Client_ID;return t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerGetOrgData",type:"POST",async:!1,data:{client_id:r},success:function(t){var u=t.result,r;if(u)for(i.push({Key:0,Name:""}),r=0;r<u.length;r++)i.push({Key:u[r].AD_Org_ID,Name:n.Utility.encodeText(u[r].OrgName)})},error:function(n){$selfObj.log.info(n)}}),i};i.prototype.getPostingType=function(){var i=[];return t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerGetPostingType",type:"POST",async:!1,data:{reference_id:125},success:function(t){var u=t.result,r;if(u)for(i.push({Key:0,Name:""}),r=0;r<u.length;r++)i.push({Key:u[r].PostingValue,Name:n.Utility.encodeText(u[r].PostingName)})},error:function(n){$selfObj.log.info(n)}}),i};i.prototype.getAcctSchemaElements=function(i){this._elements=[];var r=this._elements;return t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerGetAcctSchElements",type:"POST",async:!0,data:{keys:i},success:function(t){var u=t.result,i,f;if(u)for(i=0;i<u.length;i++)f=[],f.push({c_acctschema_element_id:u[i].C_AcctSchema_Element_ID,name:n.Utility.encodeText(u[i].ElementName),elementtype:u[i].ElementType,c_elementvalue_id:u[i].C_ElementValue_ID,seqno:u[i].SeqNo,detail:u[i].Detail,c_element_id:u[i].C_Element_ID}),r.push(f)},error:function(n){$selfObj.log.info(n)}}),r};i.prototype.getAcctSchemaElement=function(n){var t,i;for(this._elements==null&&this.getAcctSchemaElements(),t=0;t<this._elements.length;t++)if(i=this._elements[t][0],i.elementtype.equals(n))return i;return null};i.prototype.getColumnName=function(n){return n.equals(this.ELEMENTTYPE_Organization)?"AD_Org_ID":n.equals(this.ELEMENTTYPE_Account)?"Account_ID":n.equals(this.ELEMENTTYPE_BPartner)?"C_BPartner_ID":n.equals(this.ELEMENTTYPE_Product)?"M_Product_ID":n.equals(this.ELEMENTTYPE_Activity)?"C_Activity_ID":n.equals(this.ELEMENTTYPE_LocationFrom)?"C_LocFrom_ID":n.equals(this.ELEMENTTYPE_LocationTo)?"C_LocTo_ID":n.equals(this.ELEMENTTYPE_Campaign)?"C_Campaign_ID":n.equals(this.ELEMENTTYPE_OrgTrx)?"AD_OrgTrx_ID":n.equals(this.ELEMENTTYPE_Project)?"C_Project_ID":n.equals(this.ELEMENTTYPE_SalesRegion)?"C_SalesRegion_ID":n.equals(this.ELEMENTTYPE_UserList1)?"User1_ID":n.equals(this.ELEMENTTYPE_UserList2)?"User2_ID":n.equals(this.ELEMENTTYPE_UserElement1)?"UserElement1_ID":n.equals(this.ELEMENTTYPE_UserElement2)?"UserElement2_ID":""};i.prototype.getButtonText=function(i,r,u){var e=n.Env.getAD_Language(n.Env.getCtx()),o=n.MLookupFactory.getLookup_TableDirEmbed(e,r,"avd",r),f="<"+u+">";return t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerGetButtonText",type:"POST",async:!1,data:{lookupDirEmbeded:o,tName:i,wheres:" avd WHERE avd.",selectSQLs:u},success:function(n){var t=n.result;t!=""&&(f=t)},error:function(n){$selfObj.log.info(n)}}),f};i.prototype.Query=function(t,i,r,u){var f="",o,s,h,e;if(this.C_AcctSchema_ID!=0&&(f=f.concat(this.TABLE_ALIAS).concat(".C_AcctSchema_ID=").concat(this.C_AcctSchema_ID)),this.PostingType!=null&&this.PostingType.length>0&&(f.length>0&&(f=f.concat(" AND ")),f=f.concat(this.TABLE_ALIAS).concat(".PostingType='").concat(this.PostingType).concat("'")),this.documentQuery)f.length>0&&(f=f.concat(" AND ")),f=f.concat(this.TABLE_ALIAS).concat(".AD_Table_ID=").concat(this.AD_Table_ID).concat(" AND ").concat(this.TABLE_ALIAS).concat(".Record_ID=").concat(this.Record_ID);else{if(o=this.whereInfo,o!=null)for(s=0;s<o.length;s++)h=o[s].Value,h!=null&&h.length>0&&(f.length>0&&(f=f.concat(" AND ")),f=f.concat(this.TABLE_ALIAS).concat(".").concat(h));(!this.DateFrom!=null||this.DateTo!=null)&&(f.length>0&&(this.DateFrom!=""||this.DateTo!="")&&(f=f.concat(" AND ")),this.DateFrom!=""&&this.DateTo!=""?f=f.concat("TRUNC(").concat(this.TABLE_ALIAS).concat(".DateAcct,'DD') BETWEEN ").concat(n.DB.to_date(this.DateFrom)).concat(" AND ").concat(n.DB.to_date(this.DateTo)):this.DateFrom!=""?f=f.concat("TRUNC(").concat(this.TABLE_ALIAS).concat(".DateAcct,'DD') >= ").concat(n.DB.to_date(this.DateFrom)):this.DateTo!=""&&(f=f.concat("TRUNC(").concat(this.TABLE_ALIAS).concat(".DateAcct,'DD') <= ").concat(n.DB.to_date(this.DateTo))));this.AD_Org_ID!=0&&(f.length>0&&(f=f.concat(" AND ")),f=f.concat(this.TABLE_ALIAS).concat(".AD_Org_ID=").concat(this.AD_Org_ID))}e="";this.sortBy1.length>0&&(e=e.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy1));this.sortBy2.length>0&&(e.length>0&&(e=e.concat(",")),e=e.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy2));this.sortBy3.length>0&&(e.length>0&&(e=e.concat(",")),e=e.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy3));this.sortBy4.length>0&&(e.length>0&&(e=e.concat(",")),e=e.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy4));e.length==0&&(e=e.concat(this.TABLE_ALIAS).concat(".Fact_Acct_ID"));u||(u=1);this.getDataModel(t,f,e,this.group1,this.group2,this.group3,this.group4,this.sortBy1,this.sortBy2,this.sortBy3,this.sortBy4,this.displayDocumentInfo,this.displaySourceAmt,this.displayQty,i,r,u)};i.prototype.getDataModel=function(i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){var d=this;t.ajax({url:n.Application.contextUrl+"Common/GetDataQuery",async:!0,dataType:"json",type:"POST",data:{AD_Client_ID:i,whereClause:r,orderClause:u,gr1:f,gr2:e,gr3:o,gr4:s,sort1:h,sort2:c,sort3:l,sort4:a,displayDocInfo:v,displaySrcAmt:y,displayqty:p,pageNo:k},success:function(n){d.dataByData=n.result;b(n.result.pSetting);w(n.result)}})};r.prototype.dispose=function(){this.disposeComponent()};r.prototype.setIsMenu=function(n){n!=null&&n!=undefined&&(this.menuForm=n)};r.prototype.getIsMenu=function(){return this.menuForm};n.AcctViewer=r}(VIS,jQuery);VIS=window.VIS||{},function(n,t){n.AcctViewerMenu=function(){function e(){r.on("click",function(){i.frame.dispose()})}this.frame;this.windowNo;var f,i=this,r="",u=t("<div>");this.initalize=function(){u.append('<a id="VIS_btnResult_'+i.windowNo+'">button<\/a>');r=u.find("#VIS_btnResult_"+i.windowNo);e()};this.openAccountViewer=function(){var t=new n.AcctViewer(n.context.getAD_Client_ID(),1,1,this.windowNo,1);t!=null&&(t.setIsMenu(!0),t.showDialog());r.trigger("click")};this.getRoot=function(){return u}};n.AcctViewerMenu.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.initalize();this.openAccountViewer();this.frame.getContentGrid().append(this.getRoot())};n.AcctViewerMenu.prototype.dispose=function(){this.disposeComponent();this.frame=null}}(VIS,jQuery),function(n,t){function i(){function g(){var rt="topDiv_"+i.windowNo,p="btnSpaceDiv_"+i.windowNo,ut="btnSpace_"+i.windowNo,ft="spnSelect_"+i.windowNo,et="spnGenerate_"+i.windowNo,w="lblGenerate_"+i.windowNo,b="lblSelect_"+i.windowNo,k,d,u,f,g,nt,tt,a,it,v,y;o=t('<div class="input-group-append"><button id = "btnClearBP_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" tabindex="-1" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button><\/div>');s=t('<div class="input-group-append"><button id = "btnClearOrd_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" tabindex="-1" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button><\/div>');i.topDiv=t("<div id='"+rt+"' class='vis-archive-l-s-head vis-frm-ls-top' style='padding: 0;'><div id='"+p+"' class='vis-l-s-headwrp'><button id='"+ut+"'  class='vis-archive-sb-t-button'><i class='vis vis-arrow-left'><\/i><\/button><\/div><div id='"+ft+"'style='display: inline-block;  padding-left: 15px;margin-right: 15px;' ><label id='"+b+"' class='VIS_Pref_Label_Font' style='vertical-align: middle;font-size: 28px;color: rgba(var(--v-c-primary), 1);'>"+n.Msg.translate(n.Env.getCtx(),"Select")+"<\/label><\/div><div id='"+et+"' style='display: inline-block; width: 160px;'><label id='"+w+"' class='VIS_Pref_Label_Font' style='vertical-align: middle;font-size: 17px;'>"+n.Msg.translate(n.Env.getCtx(),"Generate")+"<\/label><\/div><\/div>");k="sideDiv_"+i.windowNo;d="parameterDiv_"+i.windowNo;i.btnSpaceDiv=i.topDiv.find("#"+p);this.lblGenrate=i.topDiv.find("#"+w);this.lblSelect=i.topDiv.find("#"+b);i.sideDiv=t("<div id='"+k+"' class='vis-archive-l-s-content vis-leftsidebarouterwrap'>");i.sideDiv.css("width",r);i.sideDiv.css("height","calc(100% - 103px)");i.div=t("<div class='vis-archive-l-s-content-inner' id='"+d+"'>");i.sideDiv.append(i.div);var c=t("<table style='width: 100%;'>"),e=t("<tr>"),h=t("<td style='padding: 10px 10px 0px;'>");i.div.append(c);u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');c.append(e);e.append(h);h.append(u);u.append(f);f.append(i.cmbWarehouse.getControl());f.append(i.lblWarehouse.getControl().addClass("VIS_Pref_Label_Font"));e=t("<tr>");h=t("<td style='padding: 0px 10px 0px;'>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),l=t('<div class="input-group-append">');c.append(e);e.append(h);h.append(u);u.append(f);f.append(i.vSearchBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));f.append(i.lblBPartner.getControl().addClass("VIS_Pref_Label_Font"));u.append(l);l.append(i.vSearchBPartner.getBtn(0));u.append(o);g=n.Msg.translate(n.Env.getCtx(),"SalesOrder_No");e=t("<tr>");h=t("<td style='padding: 0px 10px 0px;'>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),l=t('<div class="input-group-append">');c.append(e);e.append(h);h.append(u);u.append(f);f.append(i.vSearchOrder.getControl(0).attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));f.append("<label>"+g+"<\/label>");u.append(l);l.append(i.vSearchOrder.getBtn(0));u.append(s);nt="gridSelectDiv_"+i.windowNo;tt="gridGenerateDiv_"+i.windowNo;i.gridSelectDiv=t("<div id='"+nt+"' class='vis-frm-grid-outerwrp'>");i.gridGenerateDiv=t("<div id='"+tt+"' style='height: 85%; float: right; display: none; background-color: rgba(var(--v-c-secondary), .8); margin-left: 15px;margin-right: 15px;'>");i.gridGenerateDiv.css("width",t(window).width()-30);a="btnOk_"+i.windowNo;i.okBtn=t("<input id='"+a+"' class='VIS_Pref_btn-2' style='margin-top: 0px;width: 70px;height: 38px;' type='button' value='Ok'>");a="btnRefresh_"+i.windowNo;i.btnRefresh=t("<button id='"+a+"' style='margin-top: 0px;' class='VIS_Pref_btn-2'><i class='vis vis-refresh'><\/i><\/button>");it="discriptionDiv_"+i.windowNo;i.bottumDiv=t("<div class='vis-info-btmcnt-wrap vis-p-t-10'>");v=t("<div id='"+it+"' style='flex: 1;padding: 0 10px;'>");v.append(i.lblStatusInfo.getControl().addClass("VIS_Pref_Label_Font"));y=t("<div>");y.append(i.okBtn);i.bottumDiv.append(i.btnRefresh).append(v).append(y);i.$root.append(i.$busyDiv);i.$busyDiv[0].style.visibility="hidden";i.$root.append(i.topDiv).append(i.sideDiv).append(i.gridSelectDiv).append(i.gridGenerateDiv).append(i.bottumDiv)}function nt(){i.lblWarehouse.getControl().text(n.Msg.translate(n.Env.getCtx(),"M_Warehouse_ID"));i.lblBPartner.getControl().text(n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID"));i.tabSelect.getControl().text(n.Msg.getMsg("Select",!1,!1));i.tabGenrate.getControl().text(n.Msg.getMsg("Generate",!1,!1));i.lblStatusInfo.getControl().text(n.Msg.getMsg("VIS_OrderGenShip",!1,!1))}function tt(){var u=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2223,n.DisplayType.TableDir,"M_Warehouse_ID",0,!1,"M_Warehouse.IsActive='Y'"),t,r;i.cmbWarehouse=new n.Controls.VComboBox("M_Warehouse_ID",!0,!1,!0,u,150,n.DisplayType.TableDir,0);t=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2762,n.DisplayType.Search,"C_BPartner_ID",0,!1,"C_BPartner.IsActive ='Y' And C_Bpartner.Issummary ='N'");i.vSearchBPartner=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,t);r=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2161,n.DisplayType.Search,"C_Order_ID",0,!1,"DocStatus='CO'");i.vSearchOrder=new n.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,n.DisplayType.Search,r)}function p(r){i.dGrid!=null&&(i.dGrid.destroy(),i.dGrid=null);i.arrListColumns.length==0&&(i.arrListColumns.push({field:"AD_Org_ID",caption:n.Msg.translate(n.Env.getCtx(),"AD_Org_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"C_DocType_ID",caption:n.Msg.translate(n.Env.getCtx(),"C_DocType_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"DocumentNo",caption:n.Msg.getElement(n.Env.getCtx(),"DocumentNo"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"C_BPartner_ID",caption:n.Msg.getElement(n.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"DateOrdered",caption:n.Msg.getElement(n.Env.getCtx(),"DateOrdered"),sortable:!0,size:"16%",min:150,hidden:!1,render:function(n){var t;return t=n.changes==undefined||n.changes.DateOrdered==undefined?n.DateOrdered:n.changes.DateOrdered,new Date(t).toLocaleDateString()}}),i.arrListColumns.push({field:"C_Order_ID",caption:n.Msg.translate(n.Env.getCtx(),"C_UOM_ID"),sortable:!0,size:"150px",hidden:!0}));setTimeout(10);w2utils.encodeTags(r);i.dGrid=t(i.gridSelectDiv).w2grid({name:"gridGenShipForm"+i.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:i.arrListColumns,records:r})}function y(){var r=[],s=n.Env.getCtx().getAD_Client_ID(),u="",f="",o="";e!=null&&e.toString()!="-1"&&(u=" AND ic.M_Warehouse_ID="+e);l!=null&&(f=" AND ic.C_BPartner_ID="+l);v!=null&&(o=" AND C_Order_ID="+v);t(i.$root[0]).addClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="visible";t.ajax({url:n.Application.contextUrl+"VCreateFrom/ExecuteQueryVinoutgen",type:"POST",data:{adClientID:s,mWarehouseIDs:u,cBPartnerIDs:f,cOrderIDSearchs:o},success:function(u){var f=JSON.parse(u),s,e,o;if(f&&f.length>0)try{for(s=1,e=0;e<f.length;e++)o={},o.C_Order_ID=f[e].c_order_id,o.AD_Org_ID=f[e].ord,o.C_DocType_ID=f[e].doctype,o.DocumentNo=n.Utility.encodeText(f[e].documentno),o.C_BPartner_ID=f[e].bpname,o.DateOrdered=f[e].dateordered,o.recid=s,s++,r.push(o)}catch(h){}else n.ADialog.info("NoDataFound"),i.okBtn.attr("disabled","disabled");p(r);t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="hidden"},error:function(){t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="hidden"}})}function it(){var r,u,f,e,n,t;if(i.dGrid==null)return!1;if((r=[],u=i.dGrid.getSelection(),u!=null)&&!(u.length<=0)){for(f=u.toString().split(","),t=0;t<f.length;t++)r[t]=i.dGrid.get(f[t]).C_Order_ID;if(r.length==0)return"";for(e="C_Order_ID",n=e,n=r.length>1?n.concat(" IN ("):n.concat("="),t=0;t<r.length;t++)t>0&&(n=n.concat(",")),n=e.endsWith("_ID")?n.concat(r[t].toString()):n.concat("'").concat(r[t].toString());return r.length>1&&(n=n.concat(")")),n.toString()}}function rt(r){var u=i;i.$busyDiv[0].style.visibility="visible";t.ajax({url:n.Application.contextUrl+"Common/GenerateShipments",dataType:"json",data:{whereClause:r,M_Warehouse_ID:e},success:function(r){r.DocumentText!=null&&(ut(!0),u.gridGenerateDiv.html(r.DocumentText),u.lblStatusInfo.getControl().text(r.lblStatusInfo));r.ErrorMsg!=null&&n.ADialog.info("",null,r.ErrorMsg,null);u.$busyDiv[0].style.visibility="hidden";t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")},error:function(){u.$busyDiv[0].style.visibility="hidden";t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")}})}function ut(n){n&&(i.btnRefresh.hide(),i.okBtn.hide(),i.btnToggel.animate({borderSpacing:0},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),n=!1,i.gridSelectDiv.animate({width:f},"fast"),i.sideDiv.animate({width:"toggle",height:"toggle"},"slow"));i.gridSelectDiv.css("display","none");i.sideDiv.css("display","none");i.gridGenerateDiv.css("display","block");i.btnToggel.hide();lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary), 1)");lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")}var i;this.frame;this.windowNo;i=this;this.arrListColumns=[];this.dGrid=null;var c=null,e=null,l=null,w=!1,b=!1,u=!1,v=null;this.lblWarehouse=new n.Controls.VLabel;this.lblBPartner=new n.Controls.VLabel;this.lblStatusInfo=new n.Controls.VLabel;this.tabSelect=new n.Controls.VLabel;this.tabGenrate=new n.Controls.VLabel;this.cmbWarehouse=new n.Controls.VComboBox("",!1,!1,!0);this.vSearchBPartner=null;this.vSearchOrder=null;this.$root=t("<div style='width: 100%; height: 100%; background-color: white;'>");this.$busyDiv=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');this.topDiv=null;this.sideDiv=null;this.gridSelectDiv=null;this.gridGenerateDiv=null;this.bottumDiv=null;this.div=null;this.okBtn=null;this.cancelBtn=null;this.btnRefresh=null;this.btnToggel=null;this.spnSelect=null;this.spnGenerate=null;this.btnSpaceDiv=null;this.lblGenrate=null;this.lblSelect=null;var o=null,s=null,r=260,h=50,f=t(window).width()-(r+20),a=t(window).width()-(20+h),k=f+r+5,d=t(window).height()-210;this.vetoablechange=function(){l=i.vSearchBPartner.getValue();v=i.vSearchOrder.getValue();i.okBtn.removeAttr("disabled");y()};this.sizeChanged=function(n,t){f=t-(r+20);a=t-(20+h);u==!0?(i.btnSpaceDiv.animate({width:h},"slow"),i.sideDiv.animate({width:h},"slow"),i.div.css("display","none"),i.gridSelectDiv.animate({width:a},"slow",null,function(){i.dGrid.resize()})):(i.btnSpaceDiv.animate({width:r},"slow"),i.gridSelectDiv.animate({width:f},"slow"),i.div.css("display","block"),i.sideDiv.animate({width:r},"slow",null,function(){i.dGrid.resize()}))};this.Initialize=function(){if(tt(),nt(),g(),this.btnToggel=this.$root.find("#btnSpace_"+i.windowNo),this.spnSelect=this.$root.find("#spnSelect_"+i.windowNo),this.spnGenerate=this.$root.find("#spnGenerate_"+i.windowNo),this.okBtn!=null)this.okBtn.on(n.Events.onTouchStartOrClick,function(){var r=i;if(i.cmbWarehouse.getControl().find("option:selected").val()==undefined){n.ADialog.error("SelectWarehouseFirst");return}i.$busyDiv[0].style.visibility="visible";t(i.$root[0]).addClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv");i.okBtn.attr("disabled","disabled");c=it();c!=null&&c.length>0?rt(c):(n.ADialog.error("PlzSelectatLeast1Inv"),i.$busyDiv[0].style.visibility="hidden");i.okBtn.removeAttr("disabled")});if(this.cancelBtn!=null)this.cancelBtn.on(n.Events.onTouchStartOrClick,function(){i.$root.dialog("close")});if(this.btnRefresh!=null)this.btnRefresh.on(n.Events.onTouchStartOrClick,function(){i.okBtn.removeAttr("disabled");e=i.cmbWarehouse.getControl().find("option:selected").val();l=i.vSearchBPartner.getValue();y()});if(this.btnToggel!=null)this.btnToggel.on(n.Events.onTouchStartOrClick,function(){var e=0;u?(e=n.Application.isRTL?180:0,i.btnToggel.animate({borderSpacing:e},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!1,i.btnSpaceDiv.animate({width:r},"slow"),i.gridSelectDiv.animate({width:f},"slow"),i.div.css("display","block"),i.sideDiv.animate({width:r},"slow",null,function(){i.dGrid.resize()})):(e=n.Application.isRTL?0:180,i.btnToggel.animate({borderSpacing:e},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!0,i.btnSpaceDiv.animate({width:h},"slow"),i.sideDiv.animate({width:h},"slow"),i.div.css("display","none"),i.gridSelectDiv.animate({width:a},"slow",null,function(){i.dGrid.resize()}))});if(this.spnGenerate!=null)this.spnGenerate.on(n.Events.onTouchStartOrClick,function(){i.btnRefresh.hide();i.okBtn.hide();u&&(i.btnToggel.animate({borderSpacing:0},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!1,i.gridSelectDiv.animate({width:f},"fast"),i.sideDiv.animate({width:r},"fast"),i.btnSpaceDiv.animate({width:r},"fast"));i.gridSelectDiv.css("display","none");i.sideDiv.css("display","none");i.gridGenerateDiv.css("display","block");i.btnToggel.hide();lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary), 1)");lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")});if(this.spnSelect!=null)this.spnSelect.on(n.Events.onTouchStartOrClick,function(){u||(i.btnRefresh.show(),i.okBtn.show(),i.gridGenerateDiv.css("display","none"),i.gridSelectDiv.css("display","block"),i.sideDiv.css("display","block"),i.div.css("display","block"),i.gridSelectDiv.animate({width:f},"fast"),i.btnToggel.show(),lblSelect.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)"),lblGenrate.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary), 1)"))});if(this.cmbWarehouse!=null&&this.cmbWarehouse.getControl().change(function(){i.okBtn.removeAttr("disabled");e=i.cmbWarehouse.getControl().find("option:selected").val();y()}),this.vSearchBPartner!=null&&this.vSearchBPartner.addVetoableChangeListener(this),this.vSearchOrder!=null&&this.vSearchOrder.addVetoableChangeListener(this),o!=null)o.on(n.Events.onTouchStartOrClick,function(){i.vSearchBPartner.isReadOnly||i.vSearchBPartner.setValue(null,!1,!0)});if(s!=null)s.on(n.Events.onTouchStartOrClick,function(){i.vSearchOrder.isReadOnly||i.vSearchOrder.setValue(null,!1,!0)})};this.display=function(){p(null)};this.getRoot=function(){return this.$root};this.refreshUI=function(){this.dGrid.resize()};this.disposeComponent=function(){this.okBtn&&this.okBtn.off(n.Events.onTouchStartOrClick);this.cancelBtn&&this.cancelBtn.off(n.Events.onTouchStartOrClick);o&&o.off(n.Events.onTouchStartOrClick);s&&s.off(n.Events.onTouchStartOrClick);i=null;this.frame=null;this.windowNo=null;this.arrListColumns=null;this.dGrid=null;c=null;e=null;l=null;w=null;b=null;u=null;this.lblWarehouse=null;this.lblBPartner=null;this.lblStatusInfo=null;this.tabSelect=null;this.tabGenrate=null;this.cmbWarehouse=null;this.vSearchBPartner=null;this.$root=null;this.$busyDiv=null;this.topDiv=null;this.sideDiv=null;this.gridSelectDiv=null;this.gridGenerateDiv=null;this.bottumDiv=null;this.okBtn=null;this.cancelBtn=null;this.btnRefresh=null;this.btnToggel=null;this.spnSelect=null;this.spnGenerate=null;r=null;f=null;a=null;k=null;d=null;this.getRoot=null;this.disposeComponent=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(t,i){this.frame=i;this.windowNo=t;n.Env.getCtx().setContext(this.windowNo,"IsSOTrx","Y");try{var r=this.Initialize()}catch(u){}this.frame.getContentGrid().append(this.getRoot());this.display();this.cmbWarehouse.getControl().focus()};i.prototype.refresh=function(){this.refreshUI()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VInOutGen=i}(VIS,jQuery),function(n,t){function i(){function g(){var it="topDiv_"+i.windowNo,v="btnSpaceDiv_"+i.windowNo,rt="btnSpace_"+i.windowNo,ut="spnSelect_"+i.windowNo,ft="spnGenerate_"+i.windowNo,y="lblGenerate_"+i.windowNo,p="lblSelect_"+i.windowNo,b,k,e,f,u,d,g,nt,c,w,tt,l,a;o=t('<button id = "btnClearBP_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button>');s=t('<button id = "btnClearOrd_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button>');w=n.Application.contextUrl+"Areas/VIS/Images/base/arrow-left.png";i.topDiv=t("<div id='"+it+"' class='vis-archive-l-s-head vis-frm-ls-top' style='padding: 0;'><div id='"+v+"' class='vis-l-s-headwrp'><button id='"+rt+"' class='vis-archive-sb-t-button' ><i class='vis vis-arrow-left'><\/i><\/button><\/div><div id='"+ut+"'style='display: inline-block;  padding-left: 15px;margin-right: 15px;' ><label id='"+p+"' class='VIS_Pref_Label_Font' style='vertical-align: middle;font-size: 28px;color: rgba(var(--v-c-primary), 1);'>"+n.Msg.translate(n.Env.getCtx(),"Select")+"<\/label><\/div><div id='"+ft+"' style='display: inline-block; width: 160px;'><label id='"+y+"' class='VIS_Pref_Label_Font' style='vertical-align: middle; font-size: 17px;'>"+n.Msg.translate(n.Env.getCtx(),"Generate")+"<\/label><\/div><\/div>");b="sideDiv_"+i.windowNo;k="parameterDiv_"+i.windowNo;i.btnSpaceDiv=i.topDiv.find("#"+v);this.lblGenrate=i.topDiv.find("#"+y);this.lblSelect=i.topDiv.find("#"+p);i.sideDiv=t("<div id='"+b+"' class='vis-archive-l-s-content vis-leftsidebarouterwrap'>");i.sideDiv.css("width",r);i.sideDiv.css("height","calc(100% - 103px)");i.div=t("<div class='vis-archive-l-s-content-inner' id='"+k+"'>");i.sideDiv.append(i.div);e=t("<table style='width: 100%;'>");i.div.append(e);tr=t("<tr>");td=t("<td style='padding: 10px 10px 0px;'>");f=t('<div class="input-group vis-input-wrap">');u=t('<div class="vis-control-wrap">');e.append(tr);tr.append(td);td.append(f);f.append(u);u.append(i.cmbOrg.getControl());u.append(i.lblOrg.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");var f=t('<div class="input-group vis-input-wrap">'),u=t('<div class="vis-control-wrap">'),h=t('<div class="input-group-append">');e.append(tr);tr.append(td);td.append(f);f.append(u);u.append(i.vSearchBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));h.append(i.vSearchBPartner.getBtn(0));h.append(o);u.append(i.lblBPartner.getControl().addClass("VIS_Pref_Label_Font"));f.append(h);d=n.Msg.translate(n.Env.getCtx(),"DocumentNo");tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");var f=t('<div class="input-group vis-input-wrap">'),u=t('<div class="vis-control-wrap">'),h=t('<div class="input-group-append">');e.append(tr);tr.append(td);td.append(f);f.append(u);u.append(i.vSearchOrderShipment.getControl(0).attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));h.append(i.vSearchOrderShipment.getBtn(0));h.append(s);u.append("<label>"+d+"<\/label>");f.append(h);tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;font-size:12px;'>");e.append(tr);tr.append(td);td.append("("+n.Msg.getMsg("SalesOrderNo",!1,!1)+")");g="gridSelectDiv_"+i.windowNo;nt="gridGenerateDiv_"+i.windowNo;i.gridSelectDiv=t("<div id='"+g+"' class='vis-frm-grid-outerwrp'>");i.gridGenerateDiv=t("<div id='"+nt+"' style='height: 85%; float: right; display: none; background-color: #F1F1F1; margin-left: 15px;;margin-right: 15px;'>");i.gridGenerateDiv.css("width",t(window).width()-30);c="btnOk_"+i.windowNo;i.okBtn=t("<input id='"+c+"' class='VIS_Pref_btn-2' style='margin-top: 0px; float: right;width: 70px;height: 38px;' type='button' value='Ok'>");c="btnRefresh_"+i.windowNo;w=n.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png";i.btnRefresh=t("<button id='"+c+"' style='margin-top: 0px; float: left;height: 38px; ' class='VIS_Pref_btn-2'><i class='vis vis-refresh'><\/i><\/button>");tt="discriptionDiv_"+i.windowNo;i.bottumDiv=t("<div class='vis-info-btmcnt-wrap vis-p-t-10'>");l=t("<div id='"+tt+"' style='flex: 1;padding: 0 10px;'>");l.append(i.lblStatusInfo.getControl().addClass("VIS_Pref_Label_Font"));a=t("<div>");a.append(i.okBtn);i.bottumDiv.append(i.btnRefresh).append(l).append(a);i.$root.append(i.$busyDiv);i.$busyDiv[0].style.visibility="hidden";i.$root.append(i.topDiv).append(i.sideDiv).append(i.gridSelectDiv).append(i.gridGenerateDiv).append(i.bottumDiv)}function nt(){i.lblOrg.getControl().text(n.Msg.translate(n.Env.getCtx(),"AD_Org_ID"));i.lblBPartner.getControl().text(n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID"));i.tabSelect.getControl().text(n.Msg.getMsg("Select",!1,!1));i.tabGenrate.getControl().text(n.Msg.getMsg("Generate",!1,!1));i.lblStatusInfo.getControl().text(n.Msg.getMsg("VIS_OrderGenInv",!1,!1))}function tt(){var u=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2163,n.DisplayType.TableDir,"AD_Org_ID",0,!1,"AD_Org.AD_Org_ID <> 0 AND AD_Org.IsSummary='N' AND AD_Org.IsActive='Y' AND AD_Org.IsCostCenter='N' AND AD_Org.IsProfitCenter='N' "),t,r;i.cmbOrg=new n.Controls.VComboBox("AD_Org_ID",!0,!1,!0,u,150,n.DisplayType.TableDir,0);t=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2762,n.DisplayType.Search,"C_BPartner_ID",0,!1,"C_BPartner.IsActive ='Y' And C_Bpartner.Issummary ='N'");i.vSearchBPartner=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,t,0);r=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2161,n.DisplayType.Search,"C_Order_ID",0,!1,"DocStatus='CO'");i.vSearchOrderShipment=new n.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,n.DisplayType.Search,r,0)}function p(r){i.dGrid!=null&&(i.dGrid.destroy(),i.dGrid=null);i.arrListColumns.length==0&&(i.arrListColumns.push({field:"AD_Org_ID",caption:n.Msg.translate(n.Env.getCtx(),"AD_Org_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"C_DocType_ID",caption:n.Msg.translate(n.Env.getCtx(),"C_DocType_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"DocumentNo",caption:n.Msg.getElement(n.Env.getCtx(),"DocumentNo"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"C_BPartner_ID",caption:n.Msg.getElement(n.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"DateOrdered",caption:n.Msg.getElement(n.Env.getCtx(),"DateOrdered"),sortable:!0,size:"16%",min:150,hidden:!1,render:function(n){var t;return t=n.changes==undefined||n.changes.DateOrdered==undefined?n.DateOrdered:n.changes.DateOrdered,new Date(t).toLocaleDateString()}}),i.arrListColumns.push({field:"TotalLines",caption:n.Msg.getElement(n.Env.getCtx(),"TotalLines"),sortable:!0,size:"20%",min:150,hidden:!1,align:"right",render:function(n){var t=n.TotalLines;return parseFloat(t).toLocaleString()}}),i.arrListColumns.push({field:"C_Order_ID",caption:n.Msg.translate(n.Env.getCtx(),"C_UOM_ID"),sortable:!0,size:"150px",hidden:!0}));w2utils.encodeTags(r);i.dGrid=t(i.gridSelectDiv).w2grid({name:"gridGenForm"+i.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:i.arrListColumns,records:r})}function y(){var r=[],s=n.Env.getCtx().getAD_Client_ID(),u="",f="",o="";e!=null&&e.toString()!="-1"&&(u=" AND ic.AD_Org_ID="+e);l!=null&&(f=" AND ic.C_BPartner_ID="+l);a!=null&&(o=" AND C_Order_ID="+a);t(i.$root[0]).addClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="visible";t.ajax({url:n.Application.contextUrl+"VCreateFrom/ExecuteQueryVInvoiceGen",type:"POST",data:{adClientID:s,adOrgIDs:u,cBPartnerIDs:f,ordShipmentids:o},success:function(u){var f=JSON.parse(u),s,e,o;if(f&&f.length>0)try{for(s=1,e=0;e<f.length;e++)o={},o.C_Order_ID=f[e].c_order_id,o.AD_Org_ID=f[e].ord,o.C_DocType_ID=f[e].doctype,o.DocumentNo=f[e].documentno,o.C_BPartner_ID=f[e].bpname,o.DateOrdered=f[e].dateordered,o.TotalLines=f[e].tLines,o.recid=s,s++,r.push(o)}catch(h){}else n.ADialog.info("NoDataFound"),i.okBtn.attr("disabled","disabled");p(r);t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="hidden"},error:function(){t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="hidden"}})}function it(){var r,u,f,t,n;if(i.dGrid==null)return!1;if((r=[],u=i.dGrid.getSelection(),u!=null)&&!(u.length<=0)){for(f=u.toString().split(","),n=0;n<f.length;n++)r[n]=i.dGrid.get(f[n]).C_Order_ID;if(r.length==0)return"";for(t="",n=0;n<r.length;n++)n>0&&(t=t.concat(",")),t=t.concat(r[n].toString());return t.toString()}}function rt(r){var u=i;i.$busyDiv[0].style.visibility="visible";t.ajax({url:n.Application.contextUrl+"Common/GenerateInvoices",dataType:"json",data:{whereClause:r},success:function(r){r.DocumentText!=null&&(ut(!0),u.gridGenerateDiv.html(r.DocumentText),u.lblStatusInfo.getControl().text(r.lblStatusInfo));r.ErrorMsg!=null&&n.ADialog.info("",null,r.ErrorMsg,null);u.$busyDiv[0].style.visibility="hidden";t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")},error:function(){u.$busyDiv[0].style.visibility="hidden";t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")}})}function ut(n){n&&(i.btnRefresh.hide(),i.okBtn.hide(),i.btnToggel.animate({borderSpacing:0},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),n=!1,i.gridSelectDiv.animate({width:f},"fast"),i.sideDiv.animate({width:"toggle",height:"toggle"},"slow"));i.gridSelectDiv.css("display","none");i.sideDiv.css("display","none");i.gridGenerateDiv.css("display","block");i.btnToggel.hide();lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary),1)");lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")}var i,a;this.frame;this.windowNo;i=this;this.arrListColumns=[];this.dGrid=null;var c=null,e=null,l=null,w=!1,b=!1,u=!1;this.lblOrg=new n.Controls.VLabel;this.lblBPartner=new n.Controls.VLabel;this.lblStatusInfo=new n.Controls.VLabel;this.tabSelect=new n.Controls.VLabel;this.tabGenrate=new n.Controls.VLabel;this.cmbOrg=new n.Controls.VComboBox("",!1,!1,!0);this.vSearchBPartner=null;this.vSearchOrderShipment=null;a=null;this.$root=t("<div style='width: 100%; height: 100%; background-color: white;'>");this.$busyDiv=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');this.topDiv=null;this.sideDiv=null;this.gridSelectDiv=null;this.gridGenerateDiv=null;this.bottumDiv=null;this.div=null;this.okBtn=null;this.cancelBtn=null;this.btnRefresh=null;this.btnToggel=null;this.spnSelect=null;this.spnGenerate=null;this.btnSpaceDiv=null;this.lblGenrate=null;this.lblSelect=null;var o=null,s=null,r=260,h=50,f=t(window).width()-(r+20+5),v=t(window).width()-(20+h),k=f+r+5,d=t(window).height()-210;this.vetoablechange=function(){l=i.vSearchBPartner.getValue();a=i.vSearchOrderShipment.getValue();i.okBtn.removeAttr("disabled");y()};this.sizeChanged=function(n,t){f=t-(r+20);v=t-(20+h);u==!0?(i.btnSpaceDiv.animate({width:h},"slow"),i.sideDiv.animate({width:h},"slow"),i.div.css("display","none"),i.gridSelectDiv.animate({width:v},"slow",null,function(){i.dGrid.resize()})):(i.btnSpaceDiv.animate({width:r},"slow"),i.gridSelectDiv.animate({width:f},"slow"),i.div.css("display","block"),i.sideDiv.animate({width:r},"slow",null,function(){i.dGrid.resize()}))};this.Initialize=function(){if(tt(),nt(),g(),this.btnToggel=this.$root.find("#btnSpace_"+i.windowNo),this.spnSelect=this.$root.find("#spnSelect_"+i.windowNo),this.spnGenerate=this.$root.find("#spnGenerate_"+i.windowNo),this.okBtn!=null)this.okBtn.on(n.Events.onTouchStartOrClick,function(){i.$busyDiv[0].style.visibility="visible";t(i.$root[0]).addClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv");i.okBtn.attr("disabled","disabled");c=it();c!=null&&c.length>0?rt(c):(i.$busyDiv[0].style.visibility="hidden",n.ADialog.error("PlzSelectatLeast1Inv"));i.okBtn.removeAttr("disabled")});if(this.cancelBtn!=null)this.cancelBtn.on(n.Events.onTouchStartOrClick,function(){i.$root.dialog("close")});if(this.btnRefresh!=null)this.btnRefresh.on(n.Events.onTouchStartOrClick,function(){i.okBtn.removeAttr("disabled");e=i.cmbOrg.getControl().find("option:selected").val();l=i.vSearchBPartner.getValue();y()});if(this.btnToggel!=null)var a=0;this.btnToggel.on(n.Events.onTouchStartOrClick,function(){u?(a=n.Application.isRTL?180:0,i.btnToggel.animate({borderSpacing:a},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!1,i.btnSpaceDiv.animate({width:r},"slow"),i.gridSelectDiv.animate({width:f},"slow"),i.div.css("display","block"),i.sideDiv.animate({width:r},"slow",null,function(){i.dGrid.resize()})):(a=n.Application.isRTL?0:180,i.btnToggel.animate({borderSpacing:a},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!0,i.btnSpaceDiv.animate({width:h},"slow"),i.sideDiv.animate({width:h},"slow"),i.div.css("display","none"),i.gridSelectDiv.animate({width:v},"slow",null,function(){i.dGrid.resize()}))});if(this.spnGenerate!=null)this.spnGenerate.on(n.Events.onTouchStartOrClick,function(){i.btnRefresh.hide();i.okBtn.hide();u&&(i.btnToggel.animate({borderSpacing:0},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!1,i.gridSelectDiv.animate({width:f},"fast"),i.sideDiv.animate({width:r},"fast"),i.btnSpaceDiv.animate({width:r},"fast"));i.gridSelectDiv.css("display","none");i.sideDiv.css("display","none");i.gridGenerateDiv.css("display","block");i.btnToggel.hide();lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary),1)");lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")});if(this.spnSelect!=null)this.spnSelect.on(n.Events.onTouchStartOrClick,function(){u||(i.btnRefresh.show(),i.okBtn.show(),i.gridGenerateDiv.css("display","none"),i.gridSelectDiv.css("display","block"),i.sideDiv.css("display","block"),i.div.css("display","block"),i.gridSelectDiv.animate({width:f},"fast"),i.btnToggel.show(),lblSelect.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)"),lblGenrate.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary),1)"))});if(this.cmbOrg!=null&&this.cmbOrg.getControl().change(function(){i.okBtn.removeAttr("disabled");e=i.cmbOrg.getControl().find("option:selected").val();y()}),this.vSearchBPartner!=null&&this.vSearchBPartner.addVetoableChangeListener(this),this.vSearchOrderShipment!=null&&this.vSearchOrderShipment.addVetoableChangeListener(this),o!=null)o.on(n.Events.onTouchStartOrClick,function(){i.vSearchBPartner.isReadOnly||i.vSearchBPartner.setValue(null,!1,!0)});if(s!=null)s.on(n.Events.onTouchStartOrClick,function(){i.vSearchOrderShipment.isReadOnly||i.vSearchOrderShipment.setValue(null,!1,!0)})};this.display=function(){p(null)};this.getRoot=function(){return this.$root};this.refreshUI=function(){this.dGrid.resize()};this.disposeComponent=function(){this.okBtn&&this.okBtn.off(n.Events.onTouchStartOrClick);this.cancelBtn&&this.cancelBtn.off(n.Events.onTouchStartOrClick);o&&o.off(n.Events.onTouchStartOrClick);s&&s.off(n.Events.onTouchStartOrClick);i=null;this.frame=null;this.windowNo=null;this.arrListColumns=null;this.dGrid=null;c=null;e=null;l=null;w=null;b=null;u=null;this.lblOrg=null;this.lblBPartner=null;this.lblStatusInfo=null;this.tabSelect=null;this.tabGenrate=null;this.cmbOrg=null;this.vSearchBPartner=null;this.$root=null;this.$busyDiv=null;this.topDiv=null;this.sideDiv=null;this.gridSelectDiv=null;this.gridGenerateDiv=null;this.bottumDiv=null;this.okBtn=null;this.cancelBtn=null;this.btnRefresh=null;this.btnToggel=null;this.spnSelect=null;this.spnGenerate=null;r=null;f=null;v=null;k=null;d=null;this.getRoot=null;this.disposeComponent=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(t,i){this.frame=i;this.windowNo=t;n.Env.getCtx().setContext(this.windowNo,"IsSOTrx","Y");try{var r=this.Initialize()}catch(u){}this.frame.getContentGrid().append(this.getRoot());this.display();this.cmbOrg.getControl().focus()};i.prototype.refresh=function(){this.refreshUI()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VInvoiceGen=i}(VIS,jQuery),function(n,t){function i(){function ci(){var tt=n.Application.contextUrl+"Areas/VIS/Images/base/arrow-left.png",e,f,u,r,h;d=t('<button id = "btnClearBP_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button>');g=t('<button id = "btnClearOrd_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button>');i.topDiv=t("<div id='topDiv_"+i.windowNo+"'  class='vis-archive-l-s-head vis-frm-ls-top' style='padding: 0;'><div id='btnSpaceDiv_"+i.windowNo+"' class='vis-l-s-headwrp'><button id='btnToggelDiv_"+i.windowNo+"' class='vis-archive-sb-t-button' ><i class='vis vis-arrow-left'><\/i><\/button><\/div><\/div>");e=t("<div class='vis-frm-contenthead'>");e.append(i.lblInvoice.getControl().addClass("VIS_Pref_Label_Font"));e.append(chkSameBPartnerDiv);e.append(chkSameProductDiv);e.append(chkSameQtyDiv);i.topDiv.append(e);i.invoiceTopDiv=e;i.btnSpaceDiv=i.topDiv.find("#btnSpaceDiv_"+i.windowNo);i.sideDiv=t("<div id='sideDiv_"+i.windowNo+"' class='vis-archive-l-s-content vis-mi-ls-wrp vis-leftsidebarouterwrap'>");i.sideDiv.css("width",v);i.div=t("<div class='vis-archive-l-s-content-inner' id='parameterDiv_"+i.windowNo+"'>");i.sideDiv.append(i.div);f=t("<table style='width: 100%;height: 100%;'>");i.div.append(f);tr=t("<tr>");td=t("<td style='padding: 10px 10px 0px;'>");u=t('<div class="input-group vis-input-wrap">');r=t('<div class="vis-control-wrap">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.cmbMatchFrom.getControl());r.append(i.lblMatchFrom.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");u=t('<div class="input-group vis-input-wrap">');r=t('<div class="vis-control-wrap">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.cmbMatchTo.getControl());r.append(i.lblMatchTo.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");u=t('<div class="input-group vis-input-wrap">');r=t('<div class="vis-control-wrap">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.cmbMatchMode.getControl());r.append(i.lblMatchMode.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");var u=t('<div class="input-group vis-input-wrap">'),r=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.onlyVendor.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));r.append(i.lblBPartner.getControl().addClass("VIS_Pref_Label_Font"));o.append(i.onlyVendor.getBtn(0));o.append(d);u.append(o);tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");var u=t('<div class="input-group vis-input-wrap">'),r=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.onlyProduct.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));r.append(i.lblProduct.getControl().addClass("VIS_Pref_Label_Font"));o.append(i.onlyProduct.getBtn(0));o.append(g);u.append(o);tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");u=t('<div class="input-group vis-input-wrap">');r=t('<div class="vis-control-wrap">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.dtpFrom);r.append(i.lblDateFrom.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");u=t('<div class="input-group vis-input-wrap">');r=t('<div class="vis-control-wrap">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.dtpTo);r.append(i.lblDateTo.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");f.append(tr);tr.append(td);td.append(chkIsReturnTrxDiv);i.divForGrid=t("<div id='divForGrid_"+i.windowNo+"' class='vis-mi-main-contntwrp'>");i.gridInvoiceDiv=t("<div id='gridInvoiceDiv_"+i.windowNo+"' style='width: 100%;flex: 1; '>");i.invoicegrd=t("<div style='float: left; width: 100%;height: 100%;'>");i.gridInvoiceDiv.append(i.invoicegrd);i.gridReciptDiv=t("<div id='gridReciptDiv_"+i.windowNo+"' style='width: 100%;flex: 1;'>");h=t("<div style='float: left; width: 100%; margin-top: 0px;'>");h.append(i.lblReceipt.getControl().css("display","inline-block").css("font-size","24px").css("color","rgba(var(--v-c-primary), 1)").addClass("VIS_Pref_Label_Font"));i.reciptgrd=t("<div style='float: left; width: 100%;height: 100%;'>");i.gridReciptDiv.append(i.reciptgrd);var s=t("<div class='vis-info-btnfileds-wrap'>"),y=t("<div class='vis-info-botdatafield'>"),p=t("<div class='input-group vis-input-wrap'>"),c=t("<div class='vis-control-wrap'>");y.append(p);p.append(c);c.append(i.txtMatched.getControl());c.append(i.lblMatched.getControl().addClass("VIS_Pref_Label_Font"));s.append(y);var w=t("<div class='vis-info-botdatafield' style='padding-left: 15px;'>"),b=t("<div class='input-group vis-input-wrap'>"),l=t("<div class='vis-control-wrap'>");w.append(b);b.append(l);l.append(i.txtMatchedTo.getControl());l.append(i.lblMatchedTo.getControl().addClass("VIS_Pref_Label_Font"));s.append(w);var k=t("<div class='vis-info-botdatafield' style='padding-left: 15px;'>"),nt=t("<div class='input-group vis-input-wrap'>"),a=t("<div class='vis-control-wrap'>");k.append(nt);nt.append(a);a.append(i.txtDifference.getControl());a.append(i.lblDifference.getControl().addClass("VIS_Pref_Label_Font"));s.append(k);i.bottumButtonDiv=t("<div class='vis-info-btmcnt-wrap'>");i.searchBtnWrap=t("<div class='vis-info-searchbtn-wrap'>");i.bottumButtonDiv.append(i.searchBtnWrap);i.searchBtnWrap.append(i.btnSearch);i.bottumButtonDiv.append(s);i.bottumButtonDiv.append(i.btnProcess);i.bottumDiv=t("<div class='vis-mi-bot-div'>");i.bottumDiv.append(i.lblStatusInfo.getControl().addClass("VIS_Pref_Label_Font"));i.bottumDiv.append(i.lblStatusCount.getControl().css("float","right").addClass("VIS_Pref_Label_Font"));i.divForGrid.append(i.gridInvoiceDiv).append(h).append(i.gridReciptDiv);i.$root.append(i.topDiv).append(i.sideDiv).append(i.divForGrid).append(i.bottumButtonDiv).append(i.bottumDiv);i.$root.append(i.$busyDiv)}function li(){var r=n.Application.contextUrl+"Areas/VIS/Images/base/arrow-left.png";i.dtpFrom=t("<input id='dateFrom_"+i.windowNo+"' type='date' name='DateOrdered'>");i.dtpTo=t("<input id='dateTo_"+i.windowNo+"' type='date' name='DateOrdered'>");this.chkIsReturnTrxDiv=t("<div>");i.chkIsReturnTrx=t("<input id='chkIsReturnTrx_"+i.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblIsReturnTrx_"+i.windowNo+"' class='VIS_Pref_Label_Font'>Return Transaction<\/label><\/span>");this.chkIsReturnTrxDiv.append(i.chkIsReturnTrx);this.chkSameBPartnerDiv=t("<div class='vis-matchpoTopcheckwrap'>");i.chkSameBPartner=t("<input id='chkSameBPartner_"+i.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblSameBPartner_"+i.windowNo+"' class='VIS_Pref_Label_Font'>Same BPartner<\/label><\/span>");this.chkSameBPartnerDiv.append(i.chkSameBPartner);this.chkSameProductDiv=t("<div class='vis-matchpoTopcheckwrap'>");i.chkSameProduct=t("<input id='chkSameProduct_"+i.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblSameProduct_"+i.windowNo+"' class='VIS_Pref_Label_Font'>Same Product<\/label><\/span>");this.chkSameProductDiv.append(i.chkSameProduct);this.chkSameQtyDiv=t("<div class='vis-matchpoTopcheckwrap'>");i.chkSameQty=t("<input id='chkSameQty_"+i.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblSameQty_"+i.windowNo+"' class='VIS_Pref_Label_Font'>Same Quantity<\/label><\/span>");this.chkSameQtyDiv.append(i.chkSameQty);i.btnSearch=t("<input id='btnSearch_"+i.windowNo+"' class='VIS_Pref_btn-2' style='margin-top: 0px;' type='button' value='Search'>");i.btnProcess=t("<Button id='btnProcess_"+i.windowNo+"' style='margin-top: 0px;' class='VIS_Pref_btn-2'>"+n.Msg.getMsg("Match")+"<\/Button>");i.lblInvoice.getControl().text(n.Msg.translate(n.Env.getCtx(),"Invoice"));i.lblReceipt.getControl().text(n.Msg.translate(n.Env.getCtx(),"Receipt"));i.lblMatchFrom.getControl().text(n.Msg.translate(n.Env.getCtx(),"MatchFrom"));i.lblMatchTo.getControl().text(n.Msg.translate(n.Env.getCtx(),"MatchTo"));i.lblMatchMode.getControl().text(n.Msg.translate(n.Env.getCtx(),"MatchMode"));i.lblBPartner.getControl().text(n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID"));i.lblProduct.getControl().text(n.Msg.translate(n.Env.getCtx(),"M_Product_ID"));i.lblDateFrom.getControl().text(n.Msg.translate(n.Env.getCtx(),"DateFrom"));i.lblDateTo.getControl().text(n.Msg.translate(n.Env.getCtx(),"DateTo"));i.lblMatched.getControl().text(n.Msg.translate(n.Env.getCtx(),"ToBeMatched"));i.lblMatchedTo.getControl().text(n.Msg.translate(n.Env.getCtx(),"Matching"));i.lblDifference.getControl().text(n.Msg.translate(n.Env.getCtx(),"Difference"));i.chkIsReturnTrx.prop("checked",!1);i.btnProcess.attr("disabled","disabled");i.chkSameProduct.prop("checked",!0);i.chkSameBPartner.prop("checked",!0);i.chkSameQty.prop("checked",!1);i.chkIsReturnTrx.next("label").text(n.Msg.translate(n.Env.getCtx(),"isReturnTrx"));i.chkSameProduct.next("label").text(n.Msg.translate(n.Env.getCtx(),"SameProduct"));i.chkSameBPartner.next("label").text(n.Msg.translate(n.Env.getCtx(),"SameBPartner"));i.chkSameQty.next("label").text(n.Msg.translate(n.Env.getCtx(),"SameQty"));i.lblSearch.getControl().text(n.Msg.translate(n.Env.getCtx(),"Search"));i.btnSearch.text(n.Msg.translate(n.Env.getCtx(),"Search"))}function wt(){ri();bt();i.lblStatusInfo.getControl().text("");i.lblStatusCount.getControl().text(0)}function ai(){var t=n.MLookupFactory.getMLookUp(n.Env.getCtx(),i.windowNo,3499,n.DisplayType.Search);i.onlyVendor=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,t);t=n.MLookupFactory.getMLookUp(n.Env.getCtx(),i.windowNo,3840,n.DisplayType.Search);i.onlyProduct=new n.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,n.DisplayType.Search,t)}function bt(){i.cmbMatchTo.getControl().empty();var n=null;i.cmbMatchFrom.getControl().find("option").length>0&&(n=i.cmbMatchFrom.getControl().find("option:selected").val(),n.equals(r[o])?i.cmbMatchTo.getControl().append(" <option value='"+r[f]+"'>"+r[f]+"<\/option>"):n.equals(r[u])?i.cmbMatchTo.getControl().append(" <option value='"+r[f]+"'>"+r[f]+"<\/option>"):(i.cmbMatchTo.getControl().append(" <option value='"+r[o]+"'>"+r[o]+"<\/option>"),i.cmbMatchTo.getControl().append(" <option value='"+r[u]+"'>"+r[u]+"<\/option>")),i.cmbMatchTo.getControl().prop("selectedIndex",0),i.lblInvoice.getControl().text(n));kt()}function kt(){selection=i.cmbMatchTo.getControl().find("option:selected").val();i.lblReceipt.getControl().text(selection)}function et(){var v=i.cmbMatchFrom.getControl()[0].selectedIndex,c=i.cmbMatchTo.getControl().find("option:selected").val(),h=o,l,a,t,e;c.equals(r[f])?h=f:c.equals(r[u])&&(h=u);yt=h;ti(v,h);ft="";i.vdgvReceipt!=null&&i.vdgvReceipt.clear();i.onlyProduct.getValue()!=null&&(l=i.onlyProduct.getValue(),at=" AND lin.M_Product_ID="+l);i.onlyVendor.getValue()!=null&&(a=i.onlyVendor.getValue(),vt=" AND hdr.C_BPartner_ID="+a);t=i.dtpFrom.val();e=i.dtpTo.val();t!=""&&e!=""?ht=" AND "+s+" BETWEEN "+n.DB.to_date(t)+" AND "+n.DB.to_date(e):t!=""?ct=" AND "+s+" >= "+n.DB.to_date(t):e!=""&&(lt=" AND "+s+" <= "+n.DB.to_date(e));ii(i.vdgvInvoice);i.txtMatched.getControl().val(0);i.lblStatusInfo.getControl().text(i.cmbMatchFrom.getControl().find("option:selected").val()+"# = "+i.vdgvInvoice.records.length+" -"+i.cmbMatchTo.getControl().find("option:selected").val()+"# = "+i.vdgvReceipt.records.length);i.lblStatusCount.getControl().text(0)}function c(n){var t,s,h,e,c,v,p,a,w;nt="";tt="";it="";t=-1;n!=null?t=n:i.vdgvInvoice.getSelection().length>0&&(t=Number(i.vdgvInvoice.getSelection().toString()));s=0;t<0?i.$busyDiv[0].style.visibility="hidden":(h=i.cmbMatchTo.getControl().find("option:selected").val(),e=o,h.equals(r[f])?e=f:h.equals(r[u])&&(e=u),c=i.cmbMatchFrom.getControl()[0].selectedIndex,yt=c,ti(e,c),v={key:i.vdgvInvoice.get(t).C_BPartner_ID_K,value:i.vdgvInvoice.get(t).C_BPartner_ID},p={key:i.vdgvInvoice.get(t).M_Product_ID_K,value:i.vdgvInvoice.get(t).M_Product_ID},i.chkSameBPartner.prop("checked")&&(nt=" AND hdr.C_BPartner_ID="+v.key),i.chkSameProduct.prop("checked")&&(tt=" AND lin.M_Product_ID="+p.key),a=i.vdgvInvoice.get(t).Qty,w=i.vdgvInvoice.get(t).Matched,s=a-w,i.chkSameQty.prop("checked")&&(it=" AND "+y+"="+a),ft=i.vdgvInvoice.get(t).Line_K,ii(i.vdgvReceipt));l=s;i.txtMatched.setValue(l);i.txtMatchedTo.setValue(0);i.txtDifference.setValue(l);i.lblStatusInfo.getControl().text(i.cmbMatchFrom.getControl().find("option:selected").val()+"# = "+i.vdgvInvoice.records.length+" -"+i.cmbMatchTo.getControl().find("option:selected").val()+"# = "+i.vdgvReceipt.records.length);i.lblStatusCount.getControl().text(0)}function vi(){var n=-1,o,h,c;if(i.vdgvInvoice.getSelection().length>0&&(n=Number(i.vdgvInvoice.getSelection().toString())),n<0){e=!1;i.$busyDiv[0].style.visibility="hidden";return}var b={key:i.vdgvInvoice.get(n).C_BPartner_ID_K,value:i.vdgvInvoice.get(n).C_BPartner_ID},a={key:i.vdgvInvoice.get(n).Line_K,value:i.vdgvInvoice.get(n).Line},v={key:i.vdgvInvoice.get(n).M_Product_ID_K,value:i.vdgvInvoice.get(n).M_Product_ID},y=l,k=i.vdgvInvoice.get(n).Matched,f=i.vdgvReceipt.getSelection().toString();if(f==null){e=!1;i.$busyDiv[0].style.visibility="hidden";return}if(f.length<=0){e=!1;i.$busyDiv[0].style.visibility="hidden";return}o=!0;(i.cmbMatchFrom.getControl().find("option:selected").val().equals(r[u])||i.cmbMatchTo.getControl().find("option:selected").val().equals(r[u]))&&(o=!1);var p=i.cmbMatchMode.getControl()[0].selectedIndex,w=i.cmbMatchFrom.getControl()[0].selectedIndex,s=[],t=f.toString().split(",");for(n=0;n<t.length;n++)if(h=i.vdgvReceipt.get(t[n])._ID,h!=null){if(c={key:i.vdgvReceipt.get(t[n]).M_Product_ID_K,value:i.vdgvReceipt.get(t[n]).M_Product_ID},v.key!=c.key)continue;s.push(i.vdgvReceipt.get(t[n]))}else continue;if(s.length>0)yi(o,p,w,a.key,y,s);else{e=!1;i.$busyDiv[0].style.visibility="hidden";return}}function ti(n){nt="";tt="";it="";ht="";ct="";lt="";at="";vt="";ni=i.cmbMatchMode.getControl()[0].selectedIndex==pt;ot="";dt=i.chkIsReturnTrx.prop("checked");st="";gt=!1;matchToTypeMATCH_ORDER="matchToTypeMATCH_ORDER";n==o?(ot="displayMATCH_INVOICE",s="hdr.DateInvoiced",y="lin.QtyInvoiced"):n==u?(st="displayMATCH_ORDER",s="hdr.DateOrdered",y="lin.QtyOrdered"):(s="hdr.MovementDate",y="lin.MovementQty")}function ii(r){var e=[],o={displayMATCH_INVOICEs:ot,chkIsReturnTrxProps:dt,displayMATCH_ORDERs:st,matchToTypeMATCH_SHIPMENTs:gt,matchedsss:ni,chkSameBPartnerss:nt,chkSameProductss:tt,chkSameQtyss:it,from_ss:ht,fromIfs:ct,to_Dats:lt,matchToTypes:yt,MATCH_SHIPMENTs:f,MATCH_ORDERs:u,onlyProduct_ss:at,onlyVendor_ss:vt,MatchToID:ft};t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetTableLoadVmatch",dataType:"json",data:o,success:function(n){var t=JSON.parse(n),o,u,f,s,h;if(t&&t!=null)for(o=1,u=0;u<t.length;u++)f={},f._ID=t[u]._ID,f.DocumentNo=t[u].DocNo,s=t[u].Date,h=new Date(s),t[u].Date=h.toLocaleDateString(),f.Date=t[u].Date,f.C_BPartner_ID=t[u].CBPartnerIDK,f.C_BPartner_ID_K=t[u].CBPartnerID,f.Line=t[u].Line,f.Line_K=t[u].Line_K,f.M_Product_ID=t[u].MProductIDK,f.M_Product_ID_K=t[u].MProductID,f.Qty=t[u].Qty,f.Matched=t[u].Matched,f.recid=o,o++,e.push(f);e.length<1?(ri(r.name.contains("vdgvReceipt")),i.$busyDiv[0].style.visibility="hidden"):r.name.contains("vdgvReceipt")?(wi(i.arrListColumns,e),i.$busyDiv[0].style.visibility="hidden"):r.name.contains("vdgvInvoice")&&(pi(i.arrListColumns,e),c())},error:function(n){console.log(n);i.$busyDiv[0].style.visibility="hidden"}})}function yi(r,u,f,o,s,h){var c=i;t.ajax({url:n.Application.contextUrl+"Common/CreateMatchRecord",dataType:"json",data:{invoice:r,MatchMode:u,MatchFrom:f,LineMatched:o,ToMatchQty:s,SelectedItems:JSON.stringify(h)},success:function(t){et();i.vdgvReceipt.delete(!0);var r=JSON.parse(t);r.Msg!=""?n.ADialog.info("",null,r.Msg,null):r.MatchedPO_ID>0?n.ADialog.info("Matched",null,n.Msg.getMsg("PurchaseOrder")+" - "+r.MatchedPO_ID,null):r.MatchedInv_ID>0&&n.ADialog.info("Matched",null,n.Msg.getMsg("Invoice")+" - "+r.MatchedInv_ID,null);e=!1;i.$busyDiv[0].style.visibility="hidden"},error:function(n,t){console.log(t);e=!1;i.$busyDiv[0].style.visibility="hidden"}})}function ri(r){i.arrListColumns.length==0&&(i.arrListColumns.push({field:"_ID",caption:"_ID",sortable:!0,size:"11%",hidden:!0}),i.arrListColumns.push({field:"DocumentNo",caption:n.Msg.translate(n.Env.getCtx(),"DocumentNo"),sortable:!0,size:"11%",hidden:!1}),i.arrListColumns.push({field:"Date",caption:n.Msg.translate(n.Env.getCtx(),"Date"),sortable:!0,size:"11%",hidden:!1}),i.arrListColumns.push({field:"C_BPartner_ID",caption:n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"11%",hidden:!1}),i.arrListColumns.push({field:"C_BPartner_ID_K",caption:n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"11%",hidden:!0}),i.arrListColumns.push({field:"Line",caption:n.Msg.translate(n.Env.getCtx(),"Line"),sortable:!0,size:"11%",hidden:!1}),i.arrListColumns.push({field:"Line_K",caption:n.Msg.translate(n.Env.getCtx(),"Line"),sortable:!0,size:"11%",hidden:!0}),i.arrListColumns.push({field:"M_Product_ID",caption:n.Msg.translate(n.Env.getCtx(),"M_Product_ID"),sortable:!0,size:"11%",hidden:!1}),i.arrListColumns.push({field:"M_Product_ID_K",caption:n.Msg.translate(n.Env.getCtx(),"M_Product_ID"),sortable:!0,size:"11%",hidden:!0}),i.arrListColumns.push({field:"Qty",caption:n.Msg.translate(n.Env.getCtx(),"Qty"),sortable:!0,size:"11%",hidden:!1,render:function(t){var i=n.Utility.Util.getValueOfDecimal(t.Qty);return i.toLocaleString()}}),i.arrListColumns.push({field:"Matched",caption:n.Msg.translate(n.Env.getCtx(),"Matched"),sortable:!0,size:"11%",hidden:!1}));r==null?(i.vdgvInvoice!=null&&(i.vdgvInvoice.destroy(),i.vdgvInvoice=null),i.vdgvInvoice=t(i.invoicegrd).w2grid({name:"vdgvInvoice"+i.windowNo,recordHeight:30,show:{selectColumn:!1},onSelect:function(n){c(n.recid)},multiSelect:!1,columns:i.arrListColumns,records:null}),i.vdgvReceipt!=null&&(i.vdgvReceipt.destroy(),i.vdgvReceipt=null),i.vdgvReceipt=t(i.reciptgrd).w2grid({name:"vdgvReceipt"+i.windowNo,recordHeight:30,show:{selectColumn:!0},onSelect:function(n){this.multiSelect=!0;a(n.recid,!0)},onUnselect:function(n){a(n.recid,!1)},multiSelect:!1,columns:i.arrListColumns,records:null})):r?r&&(i.vdgvReceipt!=null&&(i.vdgvReceipt.destroy(),i.vdgvReceipt=null),i.vdgvReceipt=t(i.reciptgrd).w2grid({name:"vdgvReceipt"+i.windowNo,recordHeight:30,show:{selectColumn:!0},onSelect:function(n){this.multiSelect=!0;a(n.recid,!0)},onUnselect:function(n){a(n.recid,!1)},multiSelect:!1,columns:i.arrListColumns,records:null})):(i.vdgvInvoice!=null&&(i.vdgvInvoice.destroy(),i.vdgvInvoice=null),i.vdgvInvoice=t(i.invoicegrd).w2grid({name:"vdgvInvoice"+i.windowNo,recordHeight:30,show:{selectColumn:!1},onSelect:function(n){c(n.recid)},multiSelect:!1,columns:i.arrListColumns,records:null}))}function pi(n,r){i.vdgvInvoice!=null&&(i.vdgvInvoice.destroy(),i.vdgvInvoice=null);w2utils.encodeTags(r);i.vdgvInvoice=t(i.invoicegrd).w2grid({name:"vdgvInvoice"+i.windowNo,recordHeight:30,show:{selectColumn:!1},onSelect:function(n){c(n.recid)},multiSelect:!1,columns:n,records:r})}function wi(n,r){i.vdgvReceipt!=null&&(i.vdgvReceipt.destroy(),i.vdgvReceipt=null);w2utils.encodeTags(r);i.vdgvReceipt=t(i.reciptgrd).w2grid({name:"vdgvReceipt"+i.windowNo,recordHeight:30,show:{selectColumn:!0},onSelect:function(n){this.multiSelect=!0;a(n.recid,!0)},onUnselect:function(n){a(n.recid,!1)},multiSelect:!1,columns:n,records:r})}function a(n,t){var o,s,r,u,c,a;if(!(i.vdgvInvoice.records.length<1)){if(!i.chkSameProduct.prop("checked")){setTimeout(function(){i.vdgvReceipt.unselect(Number(n))},10);return}o=-1;s=null;i.vdgvInvoice.getSelection().length>0&&(o=Number(i.vdgvInvoice.getSelection().toString()),s={key:i.vdgvInvoice.get(o).M_Product_ID_K,value:i.vdgvInvoice.get(o).M_Product_ID});var f=0,h=0,e=n+","+i.vdgvReceipt.getSelection().toString().replace(n,"");if(t&&e!=null&&e.length>0)for(e=e.replace(/,$/,""),r=e.toString().split(","),u=0;u<r.length;u++)if(c=i.vdgvReceipt.get(r[0])._ID,c!=null){if(a={key:i.vdgvReceipt.get(r[u]).M_Product_ID_K,value:i.vdgvReceipt.get(r[u]).M_Product_ID},s.key!=a.key){setTimeout(function(){i.vdgvReceipt.unselect(Number(n))},10);return}i.cmbMatchMode.getControl()[0].selectedIndex==b&&(f=f+Number(i.vdgvReceipt.get(r[u]).Qty));f=f-Number(i.vdgvReceipt.get(r[u]).Matched);h++}k=f;i.txtMatchedTo.setValue(k.toString());i.txtDifference.setValue(l-k);h<=0&&i.btnProcess.removeAttr("disabled");i.lblStatusCount.getControl().text(h)}}var i,h;this.frame;this.windowNo;i=this;this.arrListColumns=[];this.vdgvInvoice=null;this.vdgvReceipt=null;this.lblMatchFrom=new n.Controls.VLabel;this.lblMatchTo=new n.Controls.VLabel;this.lblMatchMode=new n.Controls.VLabel;this.lblBPartner=new n.Controls.VLabel;this.lblProduct=new n.Controls.VLabel;this.lblDateFrom=new n.Controls.VLabel;this.lblDateTo=new n.Controls.VLabel;this.lblInvoice=new n.Controls.VLabel;this.lblReceipt=new n.Controls.VLabel;this.lblMatched=new n.Controls.VLabel;this.lblMatchedTo=new n.Controls.VLabel;this.lblDifference=new n.Controls.VLabel;this.lblStatusInfo=new n.Controls.VLabel;this.lblStatusCount=new n.Controls.VLabel;this.lblSearch=new n.Controls.VLabel;this.cmbMatchFrom=new n.Controls.VComboBox("",!1,!1,!0);this.cmbMatchTo=new n.Controls.VComboBox("",!1,!1,!0);this.cmbMatchMode=new n.Controls.VComboBox("",!1,!1,!0);this.chkIsReturnTrx=null;this.chkSameBPartner=null;this.chkSameProduct=null;this.chkSameQty=null;this.onlyVendor=null;this.onlyProduct=null;this.dtpFrom=null;this.dtpTo=null;this.btnSearch=null;this.btnProcess=null;this.btnToggel=null;this.txtMatched=new n.Controls.VTextBox("",!1,!0,!1);this.txtMatchedTo=new n.Controls.VTextBox("",!1,!0,!1);this.txtDifference=new n.Controls.VTextBox("",!1,!0,!1);this.$root=t("<div style='width: 100%; height: 100%; background-color: white;'>");this.$busyDiv=t("<div id='testBesy' class='vis-busyindicatorouterwrap'><div class='vis-busyindicatorinnerwrap'><i class='vis-busyindicatordiv'><\/i><\/div><\/div>");this.sideDiv=null;this.gridSelectDiv=null;this.gridInvoiceDiv=null;this.gridReciptDiv=null;this.processlDiv=null;this.bottumDiv=null;this.bottumButtonDiv=null;this.btnSpaceDiv=null;this.topDiv=null;this.div=null;this.divForGrid=null;this.invoicegrd=null;this.reciptgrd=null;this.invoiceTopDiv=null;var p=!1,v=260,w=50,rt=t(window).width()-v,ut=t(window).width()-w,ui=t(window).height()-240,fi=n.Env.getCtx().getAD_Client_ID(),ei=n.Env.getCtx().getAD_Org_ID(),oi=n.Env.getCtx().getAD_User_ID(),o=0,f=1,u=2,b=0,pt=1,si=null,s="",y="",hi="",l=0,k=0,ft="",d=null,g=null,e=!1,r=[];r.push(n.Msg.getElement3(n.Env.getAD_Language(n.Env.getCtx()),"C_Invoice_ID",!1));r.push(n.Msg.getElement3(n.Env.getAD_Language(n.Env.getCtx()),"M_InOut_ID",!1));r.push(n.Msg.getElement3(n.Env.getAD_Language(n.Env.getCtx()),"C_Order_ID",!1));h=[];h.push(n.Msg.getMsg("NotMatched"));h.push(n.Msg.getMsg("Matched"));var ot="",dt="",st="",gt=!1,ni="",nt="",tt="",it="",ht="",ct="",lt="",at="",vt="",yt="";this.Initialize=function(){for(var u=0;u<r.length;u++)this.cmbMatchFrom.getControl().append(" <option value='"+r[u]+"'>"+r[u]+"<\/option>");for(u=0;u<h.length;u++)this.cmbMatchMode.getControl().append(" <option value='"+h[u]+"'>"+h[u]+"<\/option>");if(this.cmbMatchFrom.getControl().prop("selectedIndex",0),this.cmbMatchMode.getControl().prop("selectedIndex",0),ai(),li(),ci(),this.btnToggel=this.$root.find("#btnToggelDiv_"+i.windowNo),this.gridSelectDiv=this.$root.find("#divForGrid_"+i.windowNo),this.cmbMatchFrom.getControl()!=null&&this.cmbMatchFrom.getControl().change(function(){i.$busyDiv[0].style.visibility="visible";wt();bt();i.$busyDiv[0].style.visibility="hidden"}),this.cmbMatchTo.getControl()!=null&&this.cmbMatchTo.getControl().change(function(){i.$busyDiv[0].style.visibility="visible";kt();i.$busyDiv[0].style.visibility="hidden"}),this.cmbMatchMode.getControl()!=null&&this.cmbMatchMode.getControl().change(function(){i.cmbMatchMode.getControl()[0].selectedIndex==b?i.btnProcess.text(n.Msg.getMsg("Match")):i.btnProcess.text(n.Msg.getMsg("Unmatch"))}),this.btnSearch!=null)this.btnSearch.on(n.Events.onTouchStartOrClick,function(){i.$busyDiv[0].style.visibility="visible";et()});if(this.btnProcess!=null)this.btnProcess.on(n.Events.onTouchStartOrClick,function(){e||(i.$busyDiv[0].style.visibility="visible",e=!0,vi())});if(this.btnToggel!=null)this.btnToggel.on(n.Events.onTouchStartOrClick,function(){p?(i.btnToggel.animate({borderSpacing:0},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),p=!1,i.btnSpaceDiv.animate({width:v},"slow"),i.gridSelectDiv.animate({width:rt},"slow"),i.invoiceTopDiv.animate({width:rt},"slow"),i.div.css("display","block"),i.sideDiv.animate({width:v},"slow",null,function(){i.vdgvInvoice.resize();i.vdgvReceipt.resize()})):(i.btnToggel.animate({borderSpacing:180},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),p=!0,i.btnSpaceDiv.animate({width:w},"slow"),i.sideDiv.animate({width:w},"slow"),i.div.css("display","none"),i.invoiceTopDiv.animate({width:ut},"slow"),i.gridSelectDiv.animate({width:ut},"slow",null,function(){i.vdgvInvoice.resize();i.vdgvReceipt.resize()}))});if(this.chkSameBPartner.change(function(){i.$busyDiv[0].style.visibility="visible";c()}),this.chkSameQty.change(function(){i.$busyDiv[0].style.visibility="visible";c()}),this.chkSameProduct.change(function(){i.$busyDiv[0].style.visibility="visible";c()}),d!=null)d.on(n.Events.onTouchStartOrClick,function(){i.onlyVendor.isReadOnly||i.onlyVendor.setValue(null,!1,!0)});if(g!=null)g.on(n.Events.onTouchStartOrClick,function(){i.onlyProduct.isReadOnly||i.onlyProduct.setValue(null,!1,!0)});i.$busyDiv[0].style.visibility="hidden"};this.display=function(){wt()};this.getRoot=function(){return this.$root};this.refreshUI=function(){this.vdgvInvoice.refresh();this.vdgvReceipt.refresh()};this.callConsolidate=function(){t.ajax({url:n.Application.contextUrl+"Common/Consolidate",dataType:"json",async:!0,success:function(){}});i.vdgvReceipt.multiSelect=!0;var r="vdgvReceipt"+i.windowNo;w2ui[r].multiSelect=!0};this.disposeComponent=function(){this.btnSearch&&this.btnSearch.off(n.Events.onTouchStartOrClick);this.btnProcess&&this.btnProcess.off(n.Events.onTouchStartOrClick);this.btnToggel&&this.btnToggel.off(n.Events.onTouchStartOrClick);this.frame=null;this.windowNo=null;this.arrListColumns=null;this.vdgvInvoice=null;this.vdgvReceipt=null;this.lblMatchFrom=null;this.lblMatchTo=null;this.lblMatchMode=null;this.lblBPartner=null;this.lblProduct=null;this.lblDateFrom=null;this.lblDateTo=null;this.lblInvoice=null;this.lblReceipt=null;this.lblMatched=null;this.lblMatchedTo=null;this.lblDifference=null;this.lblStatusInfo=null;this.lblStatusCount=null;this.lblSearch=null;this.cmbMatchFrom=null;this.cmbMatchTo=null;this.cmbMatchMode=null;this.chkIsReturnTrx=null;this.chkSameBPartner=null;this.chkSameProduct=null;this.chkSameQty=null;this.onlyVendor=null;this.onlyProduct=null;this.dtpFrom=null;this.dtpTo=null;this.btnSearch=null;this.btnProcess=null;this.btnToggel=null;this.txtMatched=null;this.txtMatchedTo=null;this.txtDifference=null;this.$root=null;this.$busyDiv=null;this.sideDiv=null;this.gridSelectDiv=null;this.gridInvoiceDiv=null;this.gridReciptDiv=null;this.processlDiv=null;this.bottumDiv=null;this.btnSpaceDiv=null;p=null;v=null;w=null;rt=null;ut=null;ui=null;fi=null;ei=null;oi=null;o=null;f=null;u=null;b=null;pt=null;si=null;s=null;y=null;hi=null;l=null;k=null;i=null;r=null;h=null;this.disposeComponent=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(t,i){this.frame=i;this.windowNo=t;n.Env.getCtx().setContext(this.windowNo,"IsSOTrx","Y");try{var r=this.Initialize()}catch(u){}this.frame.getContentGrid().append(this.getRoot());this.display();this.callConsolidate()};i.prototype.refresh=function(){this.refreshUI()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VMatch=i}(VIS,jQuery),function(n,t){function i(){function dt(){var g,w,s,d;setBusy(!0);v.setValue(!0);g=n.Application.contextUrl+"Areas/VIS/Images/base/arrow-left.png";u=t("<div id='sideDiv_"+i.windowNo+"' class='vis-archive-left-sidebar vis-leftsidebarouterwrap'>");ht=t("<div id='btnSpaceDiv_"+i.windowNo+"' class='vis-archive-l-s-head'><button id='btnSpace_"+i.windowNo+"' class='vis-archive-sb-t-button'><i class='vis vis-arrow-left'><\/i><\/button><\/div><\/div>");p=t("<div class='vis-archive-l-s-content' id='parameterDiv_"+i.windowNo+"'>");u.append(ht).append(p);g=n.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png";e=t("<button id='btnRefresh_"+i.windowNo+"' style='margin-left: 12px;' class='VIS_Pref_btn-2 vis-frm-button vis-pull-left'><i class='vis vis-refresh'><\/i><\/button>");y=t("<input id='btnCreateCharge_"+i.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' type='button' value='"+n.Msg.getMsg("CreateNew",!1,!1)+"'>");a=t("<input id='btnCancel_"+i.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' type='button' value='"+n.Msg.getMsg("Cancel",!1,!1)+"'>");l=t("<input id='btnAccount_"+i.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' type='button' value='"+n.Msg.getMsg("ChargeFromAccount",!1,!1)+"'>");var b=t("<table style='width: 100%;'>"),r=t("<tr>"),o=t("<td style='padding: 0px 10px 0px;'>");p.append(b);r=t("<tr>");o=t("<td style='padding: 0px 10px 0px;'>");w=t('<div class="input-group vis-input-wrap">');s=t('<div class="vis-control-wrap">');b.append(r);r.append(o);o.append(w);w.append(s);s.append(h.getControl().attr("data-placeholder","").attr("placeholder"," "));s.append(tt.getControl().addClass("VIS_Pref_Label_Font"));r=t("<tr>");o=t("<td style='padding: 0px 10px 0px;'>");w=t('<div class="input-group vis-input-wrap">');s=t('<div class="vis-control-wrap">');b.append(r);r.append(o);o.append(w);w.append(s);s.append(c.getControl().attr("data-placeholder","").attr("placeholder"," "));s.append(it.getControl().addClass("VIS_Pref_Label_Font"));r=t("<tr>");o=t("<td style='padding: 0px 10px 0px;'>");b.append(r);r.append(o);o.append(v.getControl());ut=t("<div class='vis-frm-bot-btn-wrp'>");d=t("<div class='vis-frm-bttsec'>");d.append(l).append(a);ut.append(y).append(e);f=t("<div id='rightSideGridDiv_"+i.windowNo+"' class='vis-frm-grid-wrap'>");rt=t("<div id='gridDiv_"+i.windowNo+"' class='vis-frm-grid-inn'>");f.append(rt);f.append(d);u.append(ut);k.append(st);k.append(u).append(f)}function gt(u){r!=null&&(r.destroy(),r=null);s.length==0&&(s.push({field:"C_ElementValue_ID",caption:n.Msg.getMsg("C_ELEMENTVALUE_ID"),sortable:!0,size:"16%",min:150,hidden:!0}),s.push({field:"Value",caption:n.Msg.getMsg("SearchKey"),sortable:!0,size:"25%",min:150,hidden:!1}),s.push({field:"Name",caption:n.Msg.getMsg("Name"),sortable:!0,size:"25%",min:150,hidden:!1}),s.push({field:"Expense",caption:n.Msg.getMsg("Expense"),sortable:!0,size:"25%",min:150,hidden:!1,editable:{type:"checkbox"}}));w2utils.encodeTags(u);r=t(rt).w2grid({name:"gridAccountElement"+i.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:s,records:u})}function at(){var r=[];nt=n.Env.getCtx().getContextAsInt("$C_AcctSchema_ID");ct=n.Env.getCtx().getAD_Client_ID();lt=n.Env.getCtx().getAD_Org_ID();t.ajax({url:n.Application.contextUrl+"VCharge/VChargeLodGrideData",dataType:"json",data:{mcAcctSchemaID:nt,mADClientId:ct},success:function(n){var e,u,f,t,i;if(n.result.meID!=0){if(n.result&&n.result.VchargeMCElemTaxCatID){if(e=n.result.VchargeMCElemTaxCatID,et=n.result.VchargeMCElemTaxCatID[0].mCElementID,et==0)return;ot=n.result.VchargeMCElemTaxCatID[0].mCTaxCategoryID}if(n.result&&n.result.VchargeCElementValue){for(u=n.result.VchargeCElementValue,f=1,t=0;t<u.length;t++)i={},i.C_ElementValue_ID=u[t].C_ElementValue_ID,i.Value=u[t].Value,i.Name=u[t].Name,i.Expense=u[t].Expense=="false"?!1:!0,i.recid=f,f++,r.push(i);gt(r);setBusy(!1)}}},error:function(n){setBusy(!1);i.log.info(n)}})}function ni(i,r,u,f,e){t.ajax({url:n.Application.contextUrl+"VCharge/CreateCharge",dataType:"json",data:{m_C_AcctSchema_ID:i,m_C_TaxCategory_ID:r,name:u,C_ElementValue_ID:f,expense:e},success:function(t){if(t.ID==0){n.ADialog.info("ChargeNotCreated",!0,null);setBusy(!1);return}h.ctrl.val("");c.ctrl.val("");var i=t.ID;n.ADialog.info("ChargeCreated",!0,null);at()}})}function ti(i,r,u,f,e){t.ajax({url:n.Application.contextUrl+"VCharge/CreateChargeByList",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({AcctSchemaID:i,TaxCategoryID:r,namepara:u,ElementValuID:f,expense:e}),success:function(t){t.listCreatedP&&n.ADialog.info("ChargeCreated",!0,null);t.listRejectedP&&n.ADialog.info("ChargeNotCreated",!0,null);setBusy(!1)}})}this.frame;this.windowNo;var i=this,s=[],r=null;this.log=n.Logging.VLogger.getVLogger("VCharge");var vt=!1,yt=!1,b=!1,tt=new n.Controls.VLabel(n.Msg.getMsg("SearchKey",!1,!1),"SearchKey",!1,!0),it=new n.Controls.VLabel(n.Msg.getMsg("Name",!1,!1),"Name",!1,!0),h=new n.Controls.VTextBox("SearchKey",!0,!1,!0,50,100,null,null,!1),c=new n.Controls.VTextBox("Name",!1,!1,!0,50,100,null,null,!1),v=new n.Controls.VCheckBox("Expense",!1,!1,!0,n.Msg.getMsg("Expense",!1,!1),null),pt=new n.Controls.VCheckBox("SelectAll",!1,!1,!0,n.Msg.getMsg("SelectAll",!1,!1),null),y=null,l=null,wt=new n.Controls.VLabel;this.log=n.Logging.VLogger.getVLogger("VCharge");var k=t("<div style='width: 100%; height: 100%; background-color: white; '>"),st=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>'),u=null,f=null,ht=null,p=null,rt=null,ut=null,a=null,e=null,o=null,w=260,d=50,g=t(window).width()-(w+20+5),ft=t(window).width()-(20+d),bt=g+w+5,kt=t(window).height()-210,et=0,nt=0,ot=0,ct=0,lt=0;setBusy=function(n){st.css("display",n?"block":"none")};this.Initialize=function(){if(dt(),o=k.find("#btnSpace_"+i.windowNo),a!=null)a.on(n.Events.onTouchStartOrClick,function(){i.dispose()});if(e!=null)e.on(n.Events.onTouchStartOrClick,function(){h.ctrl.val("");c.ctrl.val("");setBusy(!0);at()});if(o!=null)o.on(n.Events.onTouchStartOrClick,function(){var i=0;b?(i=n.Application.isRTL?180:0,y.show(),e.show(),tt.getControl().show(),it.getControl().show(),h.getControl().show(),c.getControl().show(),v.getControl().show(),o.animate({borderSpacing:i},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),b=!1,f.animate({width:g},"slow"),p.css("display","block"),u.animate({width:w},"slow",null,function(){r.resize()})):(i=n.Application.isRTL?0:180,y.hide(),e.hide(),tt.getControl().hide(),it.getControl().hide(),h.getControl().hide(),c.getControl().hide(),v.getControl().hide(),o.animate({borderSpacing:i},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),b=!0,u.animate({width:d},"slow"),p.css("display","none"),f.animate({width:ft},"slow",null,function(){r.resize()}))});if(this.sizeChanged=function(n,t){g=t-(w+1);ft=t-(d+1);b==!0?(u.animate({width:d},"slow"),f.animate({width:ft},"slow",null,function(){r.resize()})):(f.animate({width:g},"slow"),u.animate({width:w},"slow",null,function(){r.resize()}))},l!=null)l.on(n.Events.onTouchStartOrClick,function(){var i,t,n;setBusy(!0);var u=[],f=[],e=[];if(r){if(i=r.getSelection(),!i){setBusy(!1);return}if(i.length<=0){setBusy(!1);return}for(t=i.toString().split(","),n=0;n<t.length;n++)u[n]=r.get(t[n]).C_ElementValue_ID,f[n]=r.get(t[n]).Name,e[n]=r.get(t[n]).Expense;if(u.length==0)return setBusy(!1),"";ti(nt,ot,f,u,e)}});if(y!=null)y.on(n.Events.onTouchStartOrClick,function(){var u,f,r;if(setBusy(!0),u=v.getValue(),f=h.getValue().trim(),f.length==0){n.ADialog.warn("SearchKeyMandatory",!0,null);setBusy(!1);return}if(r=c.getValue().trim(),r.length==0){n.ADialog.warn("NameMandatory",!0,null);setBusy(!1);return}t.ajax({url:n.Application.contextUrl+"VCharge/CreateElementValue",dataType:"json",data:{m_AD_Org_ID:lt,value:f,name:r,expense:u,m_C_Element_ID:et},success:function(t){if(t.ID==0){i.log.saveError("ChargeNotCreated",t.Msg);n.ADialog.warn(t.Msg,!0,null);setBusy(!1);return}ni(nt,ot,r,t.ID,u)}})})};this.display=function(){setTimeout(at(),5)};this.getRoot=function(){return k};this.refreshUI=function(){r&&r.resize()};this.disposeComponent=function(){a&&a.off(n.Events.onTouchStartOrClick);e&&e.off(n.Events.onTouchStartOrClick);o&&o.off(n.Events.onTouchStartOrClick);l&&l.off(n.Events.onTouchStartOrClick);i.windowNo=null;s=null;r=null;vt=null;yt=null;b=null;tt=null;it=null;h=null;c=null;v=null;pt=null;btnCreateCharg=null;l=null;wt=null;i.log=null;k=null;st=null;u=null;f=null;ht=null;p=null;rt=null;ut=null;a=null;e=null;o=null;w=null;d=null;g=null;ft=null;bt=null;kt=null;et=null;nt=null;ot=null;ct=null;lt=null;i=null;this.getRoot=null;this.disposeComponent=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.Initialize();this.frame.getContentGrid().append(this.getRoot());this.display()};i.prototype.refresh=function(){this.refreshUI()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VCharge=i}(VIS,jQuery),function(n,t){function i(){function ti(){var k,y,o,u,p;setBusy(!0);k=n.Application.contextUrl+"Areas/VIS/Images/base/arrow-left.png";s=t("<div id='sideDiv_"+i.windowNo+"' class='vis-archive-left-sidebar'>");v=t("<div id='btnSpaceDiv_"+i.windowNo+"'  class='vis-archive-l-s-head'><button id='btnSpace_"+i.windowNo+"' class='vis-archive-sb-t-button'><i class='vis vis-arrow-left'><\/i><\/button><\/div><\/div>");l=t("<div class='vis-archive-l-s-content vis-leftsidebarouterwrap' id='parameterDiv_"+i.windowNo+"'>");s.append(v).append(l);k=n.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png";f=t("<button id='btnRefresh_"+i.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button'><i class='vis vis-refresh'><\/i><\/button>");c=t("<input id='btnOk_"+i.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' style='min-width: 70px;' type='button' value='"+n.Msg.getMsg("OK",!1,!1)+"'>");y=t("<table style='width: 100%;'>");l.append(y);tr=t("<tr>");td=t("<td style='padding: 10px 10px 0px'>");o=t('<div class="input-group vis-input-wrap">');u=t('<div class="vis-control-wrap">');y.append(tr);tr.append(td);td.append(o);o.append(u);u.append(b.getControl().css("display","inline-block"));u.append(r.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");o=t('<div class="input-group vis-input-wrap">');u=t('<div class="vis-control-wrap">');y.append(tr);tr.append(td);td.append(o);o.append(u);u.append(it.getControl().css("display","inline-block"));u.append(w.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px'>");o=t('<div class="input-group vis-input-wrap">');u=t('<div class="vis-control-wrap">');y.append(tr);tr.append(td);td.append(o);o.append(u);u.append(rt.getControl().css("display","inline-block"));u.append(kt.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px'>");o=t('<div class="input-group vis-input-wrap">');u=t('<div class="vis-control-wrap">');y.append(tr);tr.append(td);td.append(o);o.append(u);u.append(ut.getControl().css("display","inline-block"));u.append(dt.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));g=t("<div class='vis-frm-bot-btn-wrp'>");p=t("<div class='vis-frm-bot-btn-wrp'>");p.append(c);g.append(f);h=t("<div id='rightSideGridDiv_"+i.windowNo+"' class='vis-frm-grid-wrap'>");d=t("<div id='gridDiv_"+i.windowNo+"' class='vis-frm-grid-inn'>");d.append(e);h.append(d);h.append(p);s.append(g);a.append(ft);a.append(s).append(h)}function ii(){st.push({Key:"0",Name:n.Msg.getMsg("ModeView",!1,!1)});ui();ri()}function ri(){t.ajax({url:n.Application.contextUrl+"Common/GetDataQueryAttribute",type:"GET",dataType:"json",async:!1,success:function(n){if(n.lst){u=n.lst;for(var t=0;t<u.length;t++)at(b.getControl(),u[t].GetKeyNamePair,t),at(it.getControl(),u[t].GetKeyNamePair,t)}n.priceList&&ot(rt.getControl(),n.priceList);n.whList&&ot(ut.getControl(),n.whList);setBusy(!1)}})}function ui(){ot(k.getControl(),st)}function ot(n,t){for(var i=0;i<t.length;i++)n.append(" <option selected value='"+t[i].Key+"' >"+t[i].Name+"<\/option>");n.prop("selectedIndex",0)}function at(n,t,i){i==0&&n.append(" <option selected value='0' ><\/option>");n.append(" <option selected value='"+t.Key+"' >"+t.Name+"<\/option>");n.prop("selectedIndex",0)}function fi(i,r){var s,h,o,f,u;for(r=r<2?2:r,i+=1,row=0;row<i;row++)for(s=t("<tr id='row_"+row+"' >"),e.append(s),col=0;col<r;col++)h=t("<td id='col_"+col+"'  style='padding: 4px 15px 2px;'>"),s.append(h);o=new n.Controls.VLabel;o.getControl().text("Mode");f=e.find("#row_0");r==2?(u=f.find("#col_"+(r-1)),u.append(k.getControl().css("display","inline-block").css("width","236px").css("height","30px")),u=f.find("#col_"+(r-2)),u.append(o.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))):(u=f.find("#col_2"),u.append(k.getControl().css("display","inline-block").css("width","236px").css("height","30px")),u=f.find("#col_1"),u.append(o.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")))}function ei(r,u){var f=0,e=0,o=0,s=0;r&&(f=r.GetM_Attribute_ID,e=r.GetM_AttributeValue_ID);u&&(o=u.GetM_Attribute_ID,s=u.GetM_AttributeValue_ID);t.ajax({url:n.Application.contextUrl+"Common/GetGridElement",dataType:"json",data:{xM_Attribute_ID:f,xM_AttributeValue_ID:e,yM_Attribute_ID:o,yM_AttributeValue_ID:s,M_PriceList_Version_ID:ht,M_Warehouse_ID:ct,windowNo:i.windowNo},async:!1,success:function(){setBusy(!1)}})}function oi(){var h,c,a,t,f,p,w;if(b!=null&&!tt){if(h=b.getControl()[0].selectedIndex,c=it.getControl()[0].selectedIndex,h==c){i.log.warning("Same Attribute Selected");return}tt=!0;ht=rt.getControl().find("option:selected").val();ct=ut.getControl().find("option:selected").val();var v=2,o=[],s=[],l=null,y=null;for(h>0&&(o=u[h-1].GetMAttributeValues),o!=null&&(v=o.length+1,i.log.info("X - "+u[h-1].GetName+" #"+o.length)),a=2,c>0&&(s=u[c-1].GetMAttributeValues),s.length>0&&(a=s.length+1,i.log.info("Y - "+u[c-1].GetName+" #"+s.length)),i.log.info("Rows="+a+" - Cols="+v),fi(a,v),t=null,f=null,row=0;row<a;row++)for(col=0;col<v;col++)o!=null&&(l=o[col]),s!=null&&(y=s[row]),row==0&&col==0?(p=new n.Controls.VLabel,w=new n.Controls.VLabel,o!=null&&(p.getControl().text(u[h-1].GetName),t=e.find("#row_1"),f=t.find("#col_"+col),f.append(p.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))),s.length>0&&(w.getControl().text(u[c-1].GetName),t=e.find("#row_1"),f=t.find("#col_"+col),f.append(w.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))),l!=null&&(r=new n.Controls.VLabel,r.getControl().text(l.Name),t=e.find("#row_1"),f=t.find("#col_"+(col+1)),f.append(r.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")))):row==0?l!=null&&(r=new n.Controls.VLabel,r.getControl().text(l.Name),t=e.find("#row_1"),f=t.find("#col_"+(col+1)),f.append(r.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))):col==0?y!=null&&(r=new n.Controls.VLabel,r.getControl().text(y.Name),t=e.find("#row_"+row+1),f=t.find("#col_"+col),f.append(r.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))):ei(l,y,col,row+1);tt=!1}}function si(){var n=k.getControl().find("option:selected").val();n!=wt&&n!=bt&&n==pt}this.frame;this.windowNo;var i=this,vt=!1,yt=!1,p=!1,tt=!1,st=[],pt=0,wt=0,bt=0,ht=0,ct=0,u=[],r=new n.Controls.VLabel(n.Msg.getElement(n.Env.getCtx(),"M_Attribute_ID"),"M_Attribute_ID",!1,!0),w=new n.Controls.VLabel(n.Msg.getElement(n.Env.getCtx(),"M_Attribute_ID"),"M_Attribute_ID",!1,!0),kt=new n.Controls.VLabel(n.Msg.getElement(n.Env.getCtx(),"M_PriceList_ID"),"M_PriceList_ID",!1,!0),dt=new n.Controls.VLabel(n.Msg.getElement(n.Env.getCtx(),"M_Warehouse_ID"),"M_Warehouse_ID",!1,!0),hi=new n.Controls.VLabel(n.Msg.getMsg("Mode",!1,!1),"Mode",!1,!0),b=new n.Controls.VComboBox("",!1,!1,!0),it=new n.Controls.VComboBox("",!1,!1,!0),rt=new n.Controls.VComboBox("",!1,!1,!0),ut=new n.Controls.VComboBox("",!1,!1,!0),k=new n.Controls.VComboBox("",!1,!1,!0);this.log=n.Logging.VLogger.getVLogger("VAttributeGrid");var a=t("<div class='vis-forms-container' style='width: 100%; height: 100%; background-color: white; '>"),ft=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>'),s=null,h=null,v=null,l=null,d=null,g=null,c=null,f=null,o=null,y=260,nt=50,et=t(window).width()-y,lt=t(window).width()-nt,gt=et+y+5,ni=t(window).height()-210,e=t("<table style='width: 100%;'>");setBusy=function(n){ft.css("display",n?"block":"none")};this.Initialize=function(){if(ti(),o=a.find("#btnSpace_"+i.windowNo),c!=null)c.on(n.Events.onTouchStartOrClick,function(){si();i.dispose()});if(f!=null)f.on(n.Events.onTouchStartOrClick,function(){setBusy(!0);e.empty();oi();setBusy(!1)});if(o!=null)var u=0;o.on(n.Events.onTouchStartOrClick,function(){p?(f.show(),r.getControl().show(),w.getControl().show(),u=n.Application.isRTL?180:0,o.animate({borderSpacing:u},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),p=!1,h.animate({width:et},"slow"),l.css("display","block"),v.animate({width:y},"slow"),s.animate({width:y},"slow")):(u=n.Application.isRTL?0:180,f.hide(),r.getControl().hide(),w.getControl().hide(),o.animate({borderSpacing:u},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),p=!0,h.animate({width:lt},"slow"),s.animate({width:nt},"slow"),v.animate({width:nt},"slow"),l.css("display","none"))})};this.display=function(){setTimeout(ii(),5)};this.getRoot=function(){return a};this.disposeComponent=function(){c&&c.off(n.Events.onTouchStartOrClick);f&&f.off(n.Events.onTouchStartOrClick);o&&o.off(n.Events.onTouchStartOrClick);i.windowNo=null;vt=null;yt=null;p=null;r=null;w=null;i.log=null;a=null;ft=null;s=null;h=null;v=null;l=null;d=null;g=null;c=null;f=null;o=null;y=null;nt=null;et=null;lt=null;gt=null;ni=null;i=null;this.getRoot=null;this.disposeComponent=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.Initialize();this.frame.getContentGrid().append(this.getRoot());this.display()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VAttributeGrid=i}(VIS,jQuery);VIS=window.VIS||{},function(n,t){function r(){function dt(){w=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');w[0].style.visibility="hidden";b.append(w)}function o(n){w[0].style.visibility=n?"visible":"hidden"}function gt(){var f=t(window).height()*(94/100),i,u;k=t("<div class='vis-mainContainer'>");i=" <div class='vis-pSelectInfo vis-leftsidebarouterwrap'><div class='vis-pSelectInner'> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <select id='VIS_cmbBankAccount_"+r.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"C_BankAccount_ID")+" <\/label><\/div><\/div> <\/div> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtCurrentBal_"+r.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.getMsg("CurrentBalance")+' <\/label><\/div><\/div>  <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbbusinessPartner_'+r.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID")+' <\/label><\/div><\/div>  <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <input  id=\'VIS_cmbPayDate_'+r.windowNo+"'type='date' data-placeholder='' placeholder=' '> <label>"+n.Msg.translate(n.Env.getCtx(),"PayDate")+' <\/label><\/div><\/div>  <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbPaymentMethod_'+r.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"PaymentRule")+" <\/label><\/div><\/div>  <\/div> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='number' id='VIS_txtPaymentAmount_"+r.windowNo+"' disabled MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.getMsg("PaymentAmount")+" <\/label><\/div><\/div>  <\/div> <div class='vis-paymentselect-field'> <input type='checkbox' id='VIS_chkOnlyDue_"+r.windowNo+"' data-placeholder='' placeholder=' '> <label for='VIS_chkOnlyDue_"+r.windowNo+"'>"+n.Msg.getMsg("OnlyDue")+" <\/label>  <\/div> <div class='vis-paymentselect-field'> <label for='VIS_lblShowDetail_"+r.windowNo+"'><\/label> <\/div> <\/div> <div class='vis-paymentselect-field'> <button class='VIS_Pref_btn-2' disabled id='VIS_btnRefresh_"+r.windowNo+"' style='margin-top: 0px;'><i class='vis vis-refresh'><\/i><\/button> <\/div> <\/div>";d=t("<div class='vis-pSelectIionGrid'>");u=" <div class='vis-pSelectProcess'> <div class='vis-paymentselect-field'> <input id='VIS_btnCancel_"+r.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("Cancel")+"' ><\/input> <input id='VIS_btnOK_"+r.windowNo+"' disabled class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("OK")+"' ><\/input> <\/div> <\/div>";k.append(t(i)).append(d).append(t(u));b.append(k);ni()}function ni(){f=t("#VIS_cmbBankAccount_"+r.windowNo);s=t("#VIS_cmbbusinessPartner_"+r.windowNo);h=t("#VIS_cmbPaymentMethod_"+r.windowNo);tt=t("#VIS_txtCurrentBal_"+r.windowNo);y=t("#VIS_chkOnlyDue_"+r.windowNo);a=t("#VIS_txtPaymentAmount_"+r.windowNo);ut=t("#VIS_lblShowDetail_"+r.windowNo);p=t("#VIS_btnRefresh_"+r.windowNo);v=t("#VIS_cmbPayDate_"+r.windowNo);g=t("#VIS_btnOK_"+r.windowNo);it=t("#VIS_btnCancel_"+r.windowNo);var n=new Date,i=("0"+n.getDate()).slice(-2),u=("0"+(n.getMonth()+1)).slice(-2),e=n.getFullYear()+"-"+u+"-"+i;v.val(e);ft();ti();ri();l.BankAccount.length>0&&et()}function ti(){p.on("click",function(){o(!0);ei()&&window.setTimeout(function(){ii();o(!1)},20)});g.on("click",function(){var t,i;if(e.getSelection().length<=0)return n.ADialog.info("PleaseSelectRecord"),!1;if(t=e.getSelection(),t.length>0){for(i=0;i<t.length;i++)rt[t[i]].SELECT=!0;o(!0);window.setTimeout(function(){oi()},20)}});it.on("click",function(){r.dispose()});f.on("change",function(){o(!0);window.setTimeout(function(){fi();et();o(!1)},20)});y.on("click",function(){p.trigger("click")})}function ft(){try{e!=null&&(e.destroy(),e=null)}catch(t){}u.length==0&&(u.push({field:"SELECT",caption:n.Msg.getMsg("SELECT"),sortable:!0,size:"100px",hidden:!0}),u.push({field:"C_INVOICE_ID",caption:n.Msg.getMsg("Invoice"),sortable:!0,size:"100px"}),u.push({field:"DUEDATE",caption:n.Msg.getMsg("DueDate"),sortable:!0,size:"100px",render:function(n){var t;return t=n.changes==undefined||n.changes.DUEDATE==undefined?n.DUEDATE:n.changes.DUEDATE,new Date(t).toLocaleDateString()}}),u.push({field:"BUSINESSPARTNER",caption:n.Msg.getMsg("BusinessPartner"),sortable:!0,size:"100px"}),u.push({field:"DOCUMENTNO",caption:n.Msg.getMsg("Document_No"),sortable:!0,size:"100px"}),u.push({field:"CURRENCY",caption:n.Msg.getMsg("Currency"),sortable:!0,size:"100px"}),u.push({field:"GRANDTOTAL",caption:n.Msg.getMsg("GrandTotal"),sortable:!0,size:"100px",render:function(n){var t=n.GRANDTOTAL;return parseFloat(t).toLocaleString()}}),u.push({field:"DISCOUNTAMOUNT",caption:n.Msg.getMsg("DiscountAmt"),sortable:!0,size:"100px",render:function(n){var t=n.DISCOUNTAMOUNT;return parseFloat(t).toLocaleString()}}),u.push({field:"DISCOUNTDATE",caption:n.Msg.getMsg("DiscountDate"),sortable:!0,size:"100px",render:function(n){var t;return t=n.changes==undefined||n.changes.DISCOUNTDATE==undefined?n.DISCOUNTDATE:n.changes.DISCOUNTDATE,new Date(t).toLocaleDateString()}}),u.push({field:"AMOUNTDUE",caption:n.Msg.getMsg("AmountDue"),sortable:!0,size:"100px",render:function(n){var t=n.AMOUNTDUE;return parseFloat(t).toLocaleString()}}),u.push({field:"PAYMENTAMOUNT",caption:n.Msg.getMsg("PaymentAmount"),sortable:!0,size:"100px",render:function(n){var t=n.PAYMENTAMOUNT;return parseFloat(t).toLocaleString()}}));e=d.w2grid({name:"gridPaymentSelection_"+r.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:u,records:c});e.on("select",function(t){nt+=n.Utility.Util.getValueOfDecimal(c[t.index].PAYMENTAMOUNT);a.val(nt);var i=e.getSelection();g.removeAttr("disabled")});e.on("unselect",function(t){nt-=n.Utility.Util.getValueOfDecimal(c[t.index].PAYMENTAMOUNT);a.val(nt);var i=e.getSelection()})}function ii(){var u,r,e;c=[];u=0;r=[];r.push(f.val());l!=null?(e=jQuery.grep(l.BankAccount,function(t){return t.ID==n.Utility.Util.getValueOfInt(f.val())}),e.length>0?r.push(e[0].Currency_ID):r.push(0)):r.push(0);r.push(s.val());r.push(v.val());r.push(h.val());r.push(a.val());r.push(y.prop("checked"));t.ajax({url:n.Application.contextUrl+"VPaySelect/GetGridRecords",async:!1,datatype:"Json",type:"POST",cache:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify(r),success:function(n){var t=JSON.parse(n),r;if(c=[],t!=null||t!=undefined)for(rt=t,i=0;i<t.length;i++)r={},r.SELECT=t[i].SELECT,r.C_INVOICE_ID=t[i].C_INVOICE_ID,r.DUEDATE=t[i].DUEDATE,r.BUSINESSPARTNER=t[i].BUSINESSPARTNER,r.DOCUMENTNO=t[i].DOCUMENTNO,r.CURRENCY=t[i].CURRENCY,r.GRANDTOTAL=t[i].GRANDTOTAL,r.DISCOUNTAMOUNT=t[i].DISCOUNTAMOUNT,r.DISCOUNTDATE=t[i].DISCOUNTDATE,r.AMOUNTDUE=t[i].AMOUNTDUE,r.PAYMENTAMOUNT=t[i].PAYMENTAMOUNT,r.recid=u,u++,c.push(r)},error:function(n){console.log(n)}});ft()}function ri(){t.ajax({url:n.Application.contextUrl+"VPaySelect/GetDetail",async:!1,datatype:"Json",type:"GET",cache:!1,success:function(n){var t=JSON.parse(n);l=t;(t!=null||t!=undefined)&&t.BankAccount.length>0&&(p.removeAttr("disabled"),ui(t));o(!1)},error:function(n){console.log(n);o(!1)}})}function ui(n){var i;if(n.BankAccount!=null||n.BankAccount.length>0){f.empty();for(i in n.BankAccount)f.append(t('<Option value="'+n.BankAccount[i].ID+'">'+n.BankAccount[i].Value+"<\/option>"))}if(n.BusinessPartner!=null||n.BusinessPartner.length>0){s.empty();s.append(t('<Option value="-1"><\/option>'));for(i in n.BusinessPartner)s.append(t('<Option value="'+n.BusinessPartner[i].ID+'">'+n.BusinessPartner[i].Value+"<\/option>"))}if(n.PaymentMethod!=null||n.PaymentMethod.length>0){h.empty();for(i in n.PaymentMethod)h.append(t('<Option value="'+n.PaymentMethod[i].ID+'">'+n.PaymentMethod[i].Value+"<\/option>"))}o(!1)}function fi(){t.ajax({url:n.Application.contextUrl+"VPaySelect/GetPaymentMethod",async:!1,datatype:"Json",type:"GET",cache:!1,data:{C_BankAccount_ID:parseInt(f.val())},success:function(n){var i=JSON.parse(n),r;if((i!=null||i!=undefined)&&(i!=null||i.length>0)){h.empty();for(r in i)h.append(t('<Option value="'+i[r].ID+'">'+i[r].Value+"<\/option>"))}},error:function(n){console.log(n)}})}function et(){var t=jQuery.grep(l.BankAccount,function(t){return t.ID==n.Utility.Util.getValueOfInt(f.val())});t.length>0&&tt.val(t[0].CurrentBalance+" "+t[0].ISOCode)}function ei(){return s!=null&&s.val()<=0?(n.ADialog.info("SelectBusinessPartnerFirst"),o(!1),!1):!0}function oi(){var i=[],u;i.push(f.val());l!=null?(u=jQuery.grep(l.BankAccount,function(t){return t.ID==n.Utility.Util.getValueOfInt(f.val())}),i.push(u[0].Currency_ID)):i.push(0);i.push(s.val());i.push(v.val());i.push(h.val());i.push(a.val());i.push(y.prop("checked"));i.push(JSON.stringify(rt));t.ajax({url:n.Application.contextUrl+"VPaySelect/GeneratePaymentSelection",async:!1,datatype:"Json",type:"POST",cache:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify(i),success:function(t){var f=JSON.parse(t),i,u;(f!=null||f!=undefined)&&(r.dispose(),i=new n.CFrame,u=new n.Apps.AForms.VPayPrint,i.setName(n.Msg.getMsg("Payment Print/Export")),i.setTitle(n.Msg.getMsg("Payment Print/Export")),i.hideHeader(!1),i.setContent(u),i.show(),u.initialize())},error:function(n){console.log(n)}})}this.windowNo;var b=t("<div style='width: 100%; height: 100%; background-color: white;'>"),r=this,k=null,ot=null,st=null,ht=null,ct=null,lt=null,at=null,vt=null,d=null,yt=null,pt=null,wt=null,bt=null,f=null,s=null,h=null,v=null,kt=null,y=null,tt=null,ut=null,a=null,u=[],e=null,p=null,g=null,it=null,c=[],rt=null,l=null,nt=0,w=null;this.initialize=function(){dt();o(!0);window.setTimeout(function(){gt()},20)};this.getRoot=function(){return b};this.disposeComponent=function(){windowNo=null;b=null;r=this;k=null;ot=null;st=null;ht=null;ct=null;lt=null;at=null;vt=null;d=null;yt=null;pt=null;wt=null;bt=null;f=null;s=null;h=null;v=null;kt=null;y=null;tt=null;ut=null;a=null;u=null;e=null;p=null;g=null;it=null;c=null}}n.Apps.AForms=n.Apps.AForms||{};r.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.frame.getContentGrid().append(this.getRoot());this.initialize()};r.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VPaySelect=r}(VIS,jQuery);VIS=window.VIS||{},function(n,t){function i(){function ut(){h=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');h[0].style.visibility="hidden";c.append(h)}function r(n){h[0].style.visibility=n?"visible":"hidden"}function ft(){a=t("<div class='vis-mainContainer vis-formouterwrpdiv'>");var r=" <div class='vis-pPrintInfo'> <div class='vis-paymentselect-field' style='margin-top: 8px;'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <div class='vis-paymentPrintChk-field'> <input type='checkbox' id='VIS_chkShowPrintPayment_"+i.windowNo+"' data-placeholder='' placeholder=' '> <label for='VIS_chkOnlyDue_"+i.windowNo+"'>"+n.Msg.getMsg("ShowPrintedPayments")+" <\/label> <\/div> <select id='VIS_PaySelection_"+i.windowNo+"'><\/select> <label style='top: 11px;'>"+n.Msg.translate(n.Env.getCtx(),"C_PaySelection_ID")+" <\/label><\/div><\/div> <\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' name='vis-name vis-fieldreadonly' class='vis-fieldreadonly' disabled id='VIS_txtBankAccount_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.translate(n.Env.getCtx(),"C_BankAccount_ID")+" <\/label> <\/div><\/div><\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtCurrentBal_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.getMsg("CurrentBalance")+" <\/label> <\/div><\/div><\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <select name='vis-name' id='VIS_cmbPaymentMethod_"+i.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"PaymentRule")+" <\/label> <\/div><\/div><\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtCurrency_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.translate(n.Env.getCtx(),"C_Currency_ID")+" <\/label> <\/div><\/div><\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='number' name='vis-name'  id='VIS_txtCheckNo_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.getMsg("CheckNo")+" <\/label> <\/div><\/div><\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtNoOfPayments_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.getMsg("NoOfPayments")+" <\/label> <\/div><\/div><\/div> <\/div>",u=" <div class='vis-pPrintProcess'> <div class='vis-paymentPrint-field'> <input id='VIS_btnCancel_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("Cancel")+"' > <input id='VIS_btnPrint_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("Print")+"' ><\/input> <\/div> <\/div>";a.append(t(r)).append(t(u));c.append(a);ut();et()}function et(){u=t("#VIS_PaySelection_"+i.windowNo);p=t("#VIS_txtBankAccount_"+i.windowNo);w=t("#VIS_txtCurrentBal_"+i.windowNo);f=t("#VIS_cmbPaymentMethod_"+i.windowNo);b=t("#VIS_txtCurrency_"+i.windowNo);e=t("#VIS_txtCheckNo_"+i.windowNo);v=t("#VIS_txtNoOfPayments_"+i.windowNo);l=t("#VIS_chkShowPrintPayment_"+i.windowNo);l.attr("disabled",!0);k=t("#VIS_btnPrint_"+i.windowNo);d=t("#VIS_btnExport_"+i.windowNo);g=t("#VIS_btnCancel_"+i.windowNo);y(!0);st()}function y(i){var f=null;f=i?0:u.val();r(!0);t.ajax({url:n.Application.contextUrl+"VPayPrint/GetDetail",async:!1,datatype:"Json",type:"GET",cache:!1,data:{showPrintedPayment:l.prop("checked"),C_PaymentSelect_ID:f,isFirstTime:i},success:function(n){var t=JSON.parse(n);controlsData=t;(t!=null||t!=undefined)&&(ot(t),nt(),r(!1))},error:function(n){r(!1);console.log(n)}})}function nt(){t.ajax({url:n.Application.contextUrl+"VPayPrint/LoadPaymentRuleInfo",async:!1,datatype:"Json",type:"GET",cache:!1,data:{paymentMethod_ID:f.val(),C_PaySelection_ID:u.val(),m_C_BankAccount_ID:o,PaymentRule:f.text()},success:function(n){var t=JSON.parse(n);r(!1);(t!=null||t!=undefined)&&(e.val(t.CheckNo),v.val(t.NoOfPayments))},error:function(n){console.log(n)}})}function ot(i){var c,l,y,a,h;try{if(c=u.val(),l=0,i.PaymentSelection!=null||i.PaymentSelection.length>0){u.empty();for(h in i.PaymentSelection)u.append(t('<Option value="'+i.PaymentSelection[h].ID+'">'+i.PaymentSelection[h].Value+"<\/option>"))}if(c>0&&(u.val(c),y="VIS_135",a=[],a[0]=new n.DB.SqlParam("@pSelectID",c),l=n.Utility.Util.getValueOfInt(s(y,a))),i.PaymentMethod!=null||i.PaymentMethod.length>0){f.empty();for(h in i.PaymentMethod)f.append(t('<Option value="'+i.PaymentMethod[h].ID+'">'+i.PaymentMethod[h].Value+"<\/option>"))}l>0&&f.val(l);(i.PSelectInfo!=null||i.PSelectInfo.length>0)&&(p.val(i.PSelectInfo[0].BankAccount),e.val(i.PSelectInfo[0].CheckNo),w.val(parseFloat(i.PSelectInfo[0].CurrentBalance).toLocaleString()),b.val(i.PSelectInfo[0].Currency),v.val(i.PSelectInfo[0].NoOfPayments),o=i.PSelectInfo[0].BankAccount_ID)}catch(k){return n.ADialog.info("VPayPrintNoRecords"),r(!1),!1}if(u.val()==null)return n.ADialog.info("VPayPrintNoRecords"),!1}function st(){k.on("click",function(){tt()&&ht()});d.on("click",function(){tt()&&vt()});g.on("click",function(){i.dispose()});u.on("change",function(){r(!0);window.setTimeout(function(){y(!1);r(!1)},20)});f.on("change",function(){r(!0);window.setTimeout(function(){nt();r(!1)},20)});l.on("click",function(){r(!0);window.setTimeout(function(){y(!1);r(!1)},20)})}function tt(){try{if(u==null||u.val()<=-1||o<=-1||f.val()<=-1||e.val().length<=0)return n.ADialog.info("VPayPrintNoRecords"),!1}catch(t){return n.ADialog.info("VPayPrintNoRecords"),!1}return!0}function ht(){r(!0);t.ajax({url:n.Application.contextUrl+"VPayPrint/Cmd_Print",async:!1,datatype:"Json",type:"GET",cache:!1,data:{paymentMethod_ID:f.val(),C_PaySelection_ID:u.val(),m_C_BankAccount_ID:o,PaymentRule:f.text(),checkNo:e.val()},success:function(t){r(!1);var u=JSON.parse(t);if(u!=null||u!=undefined)n.ADialog.confirm("ContinueCheckPrint?",!0,"","Confirm",function(n){n?(r(!0),window.setTimeout(function(){ct(u)},20)):i.dispose()});else return n.ADialog.info("VPayPrintNoRecords"),!1},error:function(n){console.log(n)}})}function ct(h){var l=h.check_ID[0],c=[];c.push(f.val());c.push(u.val());c.push(o);c.push(f.text());c.push(e.val());c.push(JSON.stringify(h.check_ID));c.push(JSON.stringify(h.m_batch));c.push(JSON.stringify(h.m_checks));t.ajax({url:n.Application.contextUrl+"VPayPrint/ContinueCheckPrint",async:!1,datatype:"Json",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(c),success:function(t){var h="VIS_152",c=[],l,a,v,e,y,f;c[0]=new n.DB.SqlParam("@BankAcct_ID",o);l=s(h,c);h="VIS_150";a=s(h);v=new n.APrint(l,a,parseInt(u.val()),i.windowNo);v.startPdf(null);r(!1);e=JSON.parse(t);(e!=null||e!=undefined)&&(y=e.join(),f=lt(y),f=f!=null?n.Msg.getMsg("VIS_PaymentCreated")+f:f,n.ADialog.confirm("VPayPrintPrintRemittance?",!0,f,"Confirm",function(n){n?(r(!0),window.setTimeout(function(){at(t)},20)):i.dispose()}))},error:function(n){r(!1);console.log(n)}})}function lt(i){var r=null;return t.ajax({url:n.Application.contextUrl+"VPayPrint/GetDocumentNo",async:!1,datatype:"Json",type:"GET",contentType:"application/json; charset=utf-8",data:{paymentId:i},success:function(n){r=JSON.parse(n);r=r!=null?r.join():r},error:function(n){console.log(n)}}),r}function at(f){var e=JSON.parse(f);t.ajax({url:n.Application.contextUrl+"VPayPrint/VPayPrintRemittance",async:!1,datatype:"Json",type:"POST",contentType:"application/json; charset=utf-8",data:f,success:function(t){var l,f,o,h,c;r(!1);l=JSON.parse(t);e!=null||e!=undefined?(f="VIS_151",o=s(f),f="VIS_150",h=s(f),c=new n.APrint(o,h,parseInt(u.val()),i.windowNo),c.startPdf(null),i.dispose()):n.ADialog.info("PaymentNotProcessed")},error:function(n){console.log(n)}})}function vt(){r(!0);t.ajax({url:n.Application.contextUrl+"VPayPrint/Cmd_Export",async:!1,datatype:"Json",type:"POST",cache:!1,data:{paymentMethod_ID:f.val(),C_PaySelection_ID:u.val(),m_C_BankAccount_ID:o,PaymentRule:f.text(),checkNo:e.val()},success:function(t){r(!1);var i=JSON.parse(t);if(i!=null||i!=undefined)n.ADialog.confirm("VPayPrintSuccess?",!0,"","Confirm",function(t){if(t){r(!0);window.setTimeout(function(){yt(i)},20);var u=n.Application.contextUrl+"TempDownload/"+i.filepath;window.open(u,"_blank")}});else return n.ADialog.info("VPayPrintNoRecords"),!1},error:function(n){console.log(n)}})}function yt(i){var u=[];u.push(JSON.stringify(i.check_ID));u.push(JSON.stringify(i.m_batch));u.push(JSON.stringify(i.m_checks));t.ajax({url:n.Application.contextUrl+"VPayPrint/VPayPrintSuccess",async:!1,datatype:"Json",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(u),success:function(n){r(!1);var t=JSON.parse(n);t!=null||t!=undefined},error:function(n){console.log(n)}})}function pt(n,i,r){var u=null;return t.ajax({url:rt,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(n)}).done(function(n){u=n;r&&r(n)}),u}var s;this.windowNo=n.Env.getWindowNo();var c=t("<div style='width: 100%; height: 100%; background-color: white;'>"),i=this,a=null,u=null,p=null,w=null,f=null,b=null,e=null,v=null,l=null,k=null,d=null,g=null,o=null,h=null,it=n.Application.contextUrl,rt=it+"JsonData/JDataSetWithCode";this.initialize=function(){ft()};this.getRoot=function(){return c};s=function(t,i,r){var f=r?!0:!1,e={sql:t,page:1,pageSize:0},u=null;return i&&(e.param=i),pt(e,f,function(t){i=(new n.DB.DataSet).toJson(t);var i=(new n.DB.DataSet).toJson(t);u=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null;i.dispose();i=null;f&&r(u)}),u};this.lockUI=function(){};this.unlockUI=function(){};this.disposeComponent=function(){windowNo=null;c=null;i=this}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.frame.getContentGrid().append(this.getRoot());this.initialize()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VPayPrint=i}(VIS,jQuery);VIS=window.VIS||{},function(n,t){function i(){function ut(){l=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');l[0].style.visibility="hidden";v.append(l)}function h(n){l[0].style.visibility=n?"visible":"hidden"}function ft(){var e=t(window).height()*(92/100),u,f;y=t("<div class='vis-mainContainer'>");u=" <div class='vis-pSelectInfo vis-leftsidebarouterwrap'><div class='vis-pSelectInner'> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <select id='VIS_cmbProduct_"+i.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"M_Product_ID")+' <\/label><\/div><\/div> <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbinvoice_'+i.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"C_Invoice_ID")+' <\/label><\/div><\/div> <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbOrder_'+i.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"C_Order_ID")+' <\/label><\/div><\/div> <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbOpportunity_'+i.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"C_Project_ID")+" <\/label><\/div><\/div> <\/div> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input data-placeholder='' placeholder=' ' type='number' id='VIS_txtQuantity_"+i.windowNo+"' min='0' MaxLength='50'> <label>"+n.Msg.translate(n.Env.getCtx(),"Qty")+"<\/label><\/div><\/div> <\/div> <\/div> <div class='vis-paymentselect-field'> <button class='VIS_Pref_btn-2'  id='VIS_btnRefresh_"+i.windowNo+"' style='margin-top: 0px;'><i class='vis vis-refresh'><\/i><\/button> <\/div> <\/div>";r=t("<div class='vis-pSelectIionGrid'>");f=" <div class='vis-pSelectProcess'> <div class='vis-paymentselect-field'> <input id='VIS_btnCancel_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("Cancel")+"' ><\/input> <input id='VIS_btnOK_"+i.windowNo+"' disabled class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("OK")+"' ><\/input> <\/div> <\/div>";y.append(t(u)).append(r).append(t(f));v.append(y);et()}function et(){u=t("#VIS_cmbProduct_"+i.windowNo);f=t("#VIS_cmbinvoice_"+i.windowNo);e=t("#VIS_cmbOrder_"+i.windowNo);o=t("#VIS_cmbOpportunity_"+i.windowNo);a=t("#VIS_txtQuantity_"+i.windowNo);p=t("#VIS_btnCancel_"+i.windowNo);s=t("#VIS_btnOK_"+i.windowNo);w=t("#VIS_btnRefresh_"+i.windowNo);b();ot()}function ot(){w.on("click",function(){h(!0);r.empty();window.setTimeout(function(){b();h(!1)},20)});s.on("click",function(){lt()});p.on("click",function(){i.dispose()});u.on("change",function(){u.val()>0?s.removeAttr("disabled"):s.attr("disabled",!0);h(!0);window.setTimeout(function(){ht()},20)});f.on("change",function(){f.val()>0?(u.val()>0&&s.removeAttr("disabled"),e.attr("disabled",!0),o.attr("disabled",!0)):(s.attr("disabled",!0),e.removeAttr("disabled"),o.removeAttr("disabled"))});e.on("change",function(){e.val()>0?(u.val()>0&&s.removeAttr("disabled"),f.attr("disabled",!0),o.attr("disabled",!0)):(s.attr("disabled",!0),f.removeAttr("disabled"),o.removeAttr("disabled"))});o.on("change",function(){o.val()>0?(u.val()>0&&s.removeAttr("disabled"),e.attr("disabled",!0),f.attr("disabled",!0)):(s.attr("disabled",!0),e.removeAttr("disabled"),f.removeAttr("disabled"))});a.on("change",function(){for(var i,n=0;n<t(r[0]).children().length;n++)i=c[n].BOMQty,t(t(t(t(r[0]).children()[n]).children()[0]).children()[1]).attr("Value",i*a.val())})}function b(){t.ajax({url:n.Application.contextUrl+"VBOMDrop/GetDetail",async:!1,datatype:"Json",type:"GET",cache:!1,success:function(n){var t=JSON.parse(n);controlsData=t;(t!=null||t!=undefined)&&st(t);h(!1)},error:function(n){console.log(n);h(!1)}})}function st(n){var i;if(n.Product!=null||n.Product.length>0){u.empty();u.append(t('<Option value="-1"><\/option>'));for(i in n.Product)u.append(t('<Option value="'+n.Product[i].ID+'">'+n.Product[i].Value+"<\/option>"))}if(n.Invoice!=null||n.Invoice.length>0){f.empty();f.append(t('<Option value="-1"><\/option>'));for(i in n.Invoice)f.append(t('<Option value="'+n.Invoice[i].ID+'">'+n.Invoice[i].Value+"<\/option>"))}if(n.Order!=null||n.Order.length>0){e.empty();e.append(t('<Option value="-1"><\/option>'));for(i in n.Order)e.append(t('<Option value="'+n.Order[i].ID+'">'+n.Order[i].Value+"<\/option>"))}if(n.Opportunity!=null||n.Opportunity.length>0){o.empty();o.append(t('<Option value="-1"><\/option>'));for(i in n.Opportunity)o.append(t('<Option value="'+n.Opportunity[i].ID+'">'+n.Opportunity[i].Value+"<\/option>"))}h(!1)}function ht(){a.val("");t.ajax({url:n.Application.contextUrl+"VBOMDrop/GetBOMLines",async:!1,datatype:"Json",type:"GET",cache:!1,data:{productID:parseInt(u.val())},success:function(n){var t=JSON.parse(n);controlsData=t;t!=null||t!=undefined?ct(t):r.empty();h(!1)},error:function(n){console.log(n);h(!1)}})}function ct(n){var e="",i;r.empty();var u="",f="";for(c=n,i=0;i<n.length;i++){e="";n[i].BOMType=="P"?(u="<input type='checkbox' checked disabled id='VIS_chkBOMLine_"+i+"' style='height: 15px;width: auto;'><\/input>",f="<input type='number' id='VIS_qtyBOMLine_"+i+"' style='background: pink;width:200%;' min='0' value='"+n[i].BOMQty+"'><\/input>"):n[i].BOMType=="O"?(u="<input type='checkbox' id='VIS_chkBOMLine_"+i+"' style='height: 15px;width: auto;'><\/input>",f="<input type='number' disabled id='VIS_qtyBOMLine_"+i+"' style='background: #FFF5FF;width:200%;'  min='0' value='"+n[i].BOMQty+"'><\/input>"):(u=" <input type='radio' name='vis-radiolist' checked id='VIS_chkBOMLine_"+i+"' style='height: 15px;width: auto;'><\/input>",f="<input type='number' id='VIS_qtyBOMLine_"+i+"' style='background: pink;width:200%;' min='0' value='"+n[i].BOMQty+"'><\/input>");e+="<div class='vis-bomlinesdata'> <div style='float:left;width: 50%;'> <label style='margin: 5px;width:100%;'>"+n[i].ProductName+"<\/label>"+f+" <\/div> <div style='float:right;'>"+u+" <label style='margin-right:5px;'>"+n[i].BOMTypeName+"<\/label> <\/div> <\/div>";r.append(t(e));t("#VIS_chkBOMLine_"+i).on("click",function(){var n=t(t(t(t(this).parent()).parent().children()[0]).children()[1]);t(this).prop("checked")?(n.css("background","pink"),n.removeAttr("disabled")):(n.css("background","#FFF5FF"),n.attr("disabled",!0))})}}function lt(){var l=[],s,a;for(l.push(u.val()),l.push(f.val()),l.push(e.val()),l.push(o.val()),s=0;s<t(r[0]).children().length;s++)a=t(t(t(t(r[0]).children()[s]).children()[1]).children()[0]).prop("checked"),a?(c[s].IsSelected=!0,c[s].BOMQty=t(t(t(t(r[0]).children()[s]).children()[0]).children()[1]).val()):c[s].IsSelected=!1;l.push(JSON.stringify(c));t.ajax({url:n.Application.contextUrl+"VBOMDrop/SaveRecord",async:!1,datatype:"Json",type:"POST",cache:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify(l),success:function(t){JSON.parse(t)?i.dispose():n.ADialog.info("RecordNotSaved")},error:function(n){console.log(n);h(!1)}})}this.windowNo=null;var v=t("<div style='width: 100%; height: 100%; background-color: white;'>"),i=this,y=null,k=null,r=null,d=null,g=null,nt=null,tt=null,it=null,rt=null,u=null,f=null,e=null,o=null,a=null,s=null,p=null,l=null,c=[],w=null;this.initialize=function(){ut();h(!0);window.setTimeout(function(){ft()},20)};this.getRoot=function(){return v};this.disposeComponent=function(){v=null;i=null;y=null;k=null;r=null;d=null;g=null;nt=null;tt=null;it=null;rt=null;u=null;f=null;e=null;o=null;a=null;s=null;p=null;l=null;c=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.frame.getContentGrid().append(this.getRoot());this.initialize()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VBOMDrop=i}(VIS,jQuery);VIS=window.VIS||{},function(n,t){function i(){function at(){e=t('<div class="vis-busyindicatorouterwrap" style="visibility: hidden;"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');e[0].style.visibility="hidden";o.append(e)}function l(n){e[0].style.visibility=n?"visible":"hidden"}function vt(){var ti=t(window).height()*(96/100),dt=n.MLookupFactory.get(n.Env.getCtx(),0,0,n.DisplayType.TableDir,"AD_Org_ID",0,!1," AD_Org.AD_Org_ID <> 0 AND AD_Org.IsSummary='N' AND AD_Org.IsActive='Y' AND AD_Org.IsCostCenter='N' AND AD_Org.IsProfitCenter='N' "),et,e,r,nt,tt,ut,ft,kt;a=new n.Controls.VComboBox("AD_Org_ID",!1,!1,!0,dt,50);et=n.MLookupFactory.get(n.Env.getCtx(),0,0,n.DisplayType.List,"MovementType",189,!1,null);v=new n.Controls.VComboBox("MovementType",!1,!1,!0,et,29);var c=t("<div class='input-group vis-input-wrap'>"),y=t("<div class='vis-control-wrap'>"),p=t("<div class='input-group-append'>"),gt=n.MLookupFactory.get(n.context,0,0,n.DisplayType.Search,"M_Locator_ID",0,!1,"");u=new n.Controls.VTextBoxButton("M_Locator_ID",!1,!1,!0,n.DisplayType.Search,gt);c.append(y);y.append(u.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));c.append(p);p.append(u.getBtn(0));p.append(u.getBtn(1));u.getBtn(0).addClass("vis-lookupButtons");u.getBtn(1).addClass("vis-lookupButtons");var w=t("<div class='input-group vis-input-wrap'>"),b=t("<div class='vis-control-wrap'>"),k=t("<div class='input-group-append'>"),ni=n.MLookupFactory.get(n.context,0,0,n.DisplayType.Search,"M_Product_ID",0,!1,"");f=new n.Controls.VTextBoxButton("M_Product_ID",!1,!1,!0,n.DisplayType.Search,ni);w.append(b);b.append(f.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));w.append(k);k.append(f.getBtn(0));k.append(f.getBtn(1));f.getBtn(0).addClass("vis-lookupButtons");f.getBtn(1).addClass("vis-lookupButtons");s=t("<div class='vis-mainContainer'>");e=t("<div class='vis-pSelectInfo vis-leftsidebarouterwrap'>");r=t("<div class='vis-pSelectInner'>");e.append(r);var ot=t("<div class='vis-paymentselect-field'>"),st=t("<div class='input-group vis-input-wrap'>"),d=t("<div class='vis-control-wrap'>");ot.append(st);st.append(d);d.append(a.getControl());d.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"AD_Org_ID")+" <\/label>"));r.append(ot);var ht=t("<div class='vis-paymentselect-field'>"),ct=t("<div class='input-group vis-input-wrap'>"),g=t("<div class='vis-control-wrap'>");ht.append(ct);ct.append(g);g.append(v.getControl());g.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"MovementType")+" <\/label>"));r.append(ht);nt=t("<div class='vis-paymentselect-field'>");nt.append(c);y.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"M_Locator_ID")+" <\/label>"));r.append(nt);tt=t("<div class='vis-paymentselect-field'>");tt.append(w);b.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"Product")+" <\/label>"));r.append(tt);var lt=t("<div class='vis-paymentselect-field'>"),at=t("<div class='input-group vis-input-wrap'>"),it=t("<div class='vis-control-wrap'>");it.append(t("<input  id='VIS_dtpFromDate"+i.windowNo+"'type='date'>"));it.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"DateFrom")+" <\/label>"));lt.append(at);at.append(it);r.append(lt);var vt=t("<div class='vis-paymentselect-field'>"),bt=t("<div class='input-group vis-input-wrap'>"),rt=t("<div class='vis-control-wrap'>");rt.append(t("<input  id='VIS_dtpToDate"+i.windowNo+"'type='date'>"));rt.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"DateTo")+" <\/label>"));vt.append(bt);bt.append(rt);r.append(vt);ut=t("<div class='vis-paymentselect-field'>");ut.append(t("<button class='VIS_Pref_btn-2' id='VIS_btnRefresh_"+i.windowNo+"' style='margin-top: 0px;'><i class='vis vis-refresh'><\/i><\/button>"));e.append(ut);ft=t("<div class='vis-paymentselect-field'>");ft.append(t("<button class='VIS_Pref_btn-2' id='VIS_btnZoom_"+i.windowNo+"' style='margin-top: 0px;'><i class='vis vis-find'><\/i><\/button>"));e.append(ft);h=t("<div class='vis-pSelectIionGrid'>");kt=" <div class='vis-pSelectProcess'> <div class='vis-paymentselect-field'> <input id='VIS_btnCancel_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("Cancel")+"' ><\/input> <input id='VIS_btnOK_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("OK")+"' ><\/input> <\/div> <\/div>";s.append(e).append(h).append(t(kt));o.append(s);yt();window.setTimeout(function(){wt()},20);pt();l(!0)}function yt(){k=t("#VIS_dtpFromDate"+i.windowNo);d=t("#VIS_dtpToDate"+i.windowNo);y=t("#VIS_btnRefresh_"+i.windowNo);g=t("#VIS_btnZoom_"+i.windowNo);p=t("#VIS_btnOK_"+i.windowNo);w=t("#VIS_btnCancel_"+i.windowNo);var n=new Date,r=("0"+n.getDate()).slice(-2),u=("0"+(n.getMonth()+1)).slice(-2),f=n.getFullYear()+"-"+u+"-"+r}function pt(){y.on("click",function(){nt()});g.on("click",function(){bt()});p.on("click",function(){nt()});w.on("click",function(){i.dispose()})}function wt(){n.AEnv.getGridWindow(i.windowNo,223,function(u){var e,f;if(u.error!=null){n.ADialog.error(u.error);self.dispose();self=null;return}(e=t.parseJSON(u.result),n.context.setContextOfWindow(t.parseJSON(u.wCtx),i.windowNo),f=new n.GridWindow(e),f!=null)&&(b=f.getTabs()[0],r=new n.GridController(!1),r.initGrid(!0,i.windowNo,i,b),r.setVisible(!0),window.innerHeight>700?r.sizeChanged(window.innerHeight-230,window.innerWidth):r.sizeChanged(window.innerHeight-215,window.innerWidth),h.append(r.getRoot()),r.activate(),c=new n.Query,c.addRestriction("AD_Client_ID",n.Query.prototype.EQUAL,n.context.getAD_Client_ID()))})}function nt(){var e=null,t,i;e=c!=null?jQuery.extend(!0,{},c):new n.Query;t=a.getValue();(t==null||t.toString()=="-1"||t.toString().trim().length==0)&&(t=null);t!=null&&t.toString().length>0&&e.addRestriction("AD_Org_ID",n.Query.prototype.EQUAL,t);t=u.getValue();t!=null&&t.toString().length>0&&e.addRestriction("M_Locator_ID",n.Query.prototype.EQUAL,t);t=f.getValue();t!=null&&t.toString().length>0&&e.addRestriction("M_Product_ID",n.Query.prototype.EQUAL,t);t=v.getValue();(t==null||t.toString()=="-1"||t.toString().trim().length==0)&&(t=null);t!=null&&t.toString().length>0&&e.addRestriction("MovementType",n.Query.prototype.EQUAL,t);i=k.val().toString();i!=null&&i.length>0&&(i=new Date(i),e.addRestriction("TRUNC(MovementDate,'DD')",n.Query.prototype.GREATER_EQUAL,i));i=d.val().toString();i!=null&&i.length>0&&(i=new Date(i),e.addRestriction("TRUNC(MovementDate,'DD')",n.Query.prototype.LESS_EQUAL,i));b.setQuery(e);r.query(0,0,!1)}function bt(){var u=0,f=null,e=null,o=[],t=n.context.getContextAsInt(i.windowNo,"M_InOutLine_ID"),s,h;if(t!=0?(n.context.getContext(i.windowNo,"MovementType").equals("C-")?u=169:n.context.getContext(i.windowNo,"MovementType").equals("C+")?u=409:n.context.getContext(i.windowNo,"MovementType").equals("V+")?u=184:n.context.getContext(i.windowNo,"MovementType").equals("V-")&&(u=411),f="M_InOut_ID",e="VIS_140",o[0]=new n.DB.SqlParam("@lineID",t)):(t=n.context.getContextAsInt(i.windowNo,"M_InventoryLine_ID"),t!=0?(u=168,f="M_Inventory_ID",e="VIS_141",o[0]=new n.DB.SqlParam("@lineID",t)):(t=n.context.getContextAsInt(i.windowNo,"M_MovementLine_ID"),t!=0?(u=170,f="M_Movement_ID",e="VIS_142",o[0]=new n.DB.SqlParam("@lineID",t)):(t=n.context.getContextAsInt(i.windowNo,"M_ProductionLine_ID"),t!=0&&(u=191,f="M_Production_ID",e="VIS_143",o[0]=new n.DB.SqlParam("@lineID",t))))),u!=0)if(s=0,h=0,h=r.getSelectedRows(),h.length>0)s=n.Utility.Util.getValueOfInt(tt(e,null,null)),dt(f,t,u,s);else return alert(n.Msg.getMsg("NoRecordSelected"))}function kt(n,i,r){var u=null;return t.ajax({url:lt,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(n)}).done(function(n){u=n;r&&r(n)}),u}function dt(t,i,r,u){var f=new n.Query;f.addRestriction(t,n.Query.prototype.EQUAL,u);n.viewManager.startWindow(r,f)}var tt;this.windowNo=null;var o=t("<div style='width: 100%; height: 100%; background-color: white;'>"),i=this,s=null,it=null,h=null,rt=null,ut=null,ft=null,et=null,a=null,v=null,k=null,d=null,ot=[],st=null,y=null,g=null,p=null,w=null,ht=[],e=null,u=null,f=null,r=null,c=null,b=null,ct=n.Application.contextUrl,lt=ct+"JsonData/JDataSetWithCode";this.initialize=function(){at();l(!0);window.setTimeout(function(){vt();l(!1)},20)};tt=function(t,i,r){var f=r?!0:!1,e={sql:t,page:1,pageSize:0},u=null;return kt(e,f,function(t){i=(new n.DB.DataSet).toJson(t);var i=(new n.DB.DataSet).toJson(t);u=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null;i.dispose();i=null;f&&r(u)}),u};this.getRoot=function(){return o};this.refreshUI=function(){r&&r.vTable.resize()};this.dataStatusChanged=function(){};this.setBusy=function(n){l(n)};this.disposeComponent=function(){windowNo=null;o=null;i=this;s=null;it=null;$divBankAccount=null;$divCurrentBalance=null;$divBusinessPartner=null;$divOnlyDueInvoice=null;$divPaymentDate=null;$divPaymentMethod=null;h=null;rt=null;ut=null;ft=null;et=null;$cmbBankAccount=null;$cmbBusinessPartner=null;$cmbPaymentMethod=null;$cmbPaymentDate=null;$lblCurrentBal=null;$chkOnlyDueInvoice=null;$txtCurrentBal=null;$lblMsg=null;$txtPaymentAmount=null;ot=null;st=null;y=null;p=null;w=null;ht=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.frame.getContentGrid().append(this.getRoot());this.initialize()};i.prototype.refresh=function(){this.refreshUI()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VTrxMaterial=i}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutDocumentType")}function u(){n.CalloutEngine.call(this,"VIS.CalloutRecurring")}function r(){n.CalloutEngine.call(this,"VIS.CalloutProfitLoss")}function f(){n.CalloutEngine.call(this,"VIS.CalloutProfitTax")}function e(){n.CalloutEngine.call(this,"VIS.CalloutUOMConversion")}function o(){n.CalloutEngine.call(this,"VIS.CalloutIncoTerm")}function s(){n.CalloutEngine.call(this,"VIS.CalloutLocatorPC")}function h(){n.CalloutEngine.call(this,"VIS.CalloutLandedCost")}function c(){n.CalloutEngine.call(this,"VIS.CalloutRFQ")}function l(){n.CalloutEngine.call(this,"VIS.CalloutPaymentTerm")}var a=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.SetSalesQuotation=function(n,i,r,u,f){if(this.isCalloutActive()||f==null||f.toString()=="")return"";try{this.setCalloutActive(!0);t.getValueOfString(r.getValue("DocSubTypeSO"))=="OB"||t.getValueOfString(r.getValue("DocSubTypeSO"))=="ON"?r.setValue("IsSalesQuotation",!0):r.setValue("IsSalesQuotation",!1)}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),""};i.prototype.Organization=function(t,i,r,u,f){var o,e;if(this.isCalloutActive()||f==null||f.toString()=="")return"";try{this.setCalloutActive(!0);o="";r.getField("M_Warehouse_ID")!=null&&(e=n.dataContext.getJSONRecord("MDocType/GetWarehouse",f.toString()),e>0?r.getTableName()=="M_Movement"&&r.getField("DTD001_MWarehouseSource_ID")!=null?r.setValue("DTD001_MWarehouseSource_ID",e):r.setValue("M_Warehouse_ID",e):r.getTableName()=="M_Movement"&&r.getField("DTD001_MWarehouseSource_ID")!=null?r.setValue("DTD001_MWarehouseSource_ID",0):r.setValue("M_Warehouse_ID",0))}catch(s){return this.setCalloutActive(!1),s}return this.setCalloutActive(!1),""};n.Model.CalloutDocumentType=i;n.Utility.inheritPrototype(u,n.CalloutEngine);u.prototype.SetMaxRunZero=function(n,t,i,r,u,f){if(u==null||u.toString()=="")return"";this.setCalloutActive(!0);var e=i.getValue("RunsMax");return e!=""&&e>0&&i.setValue("RunsRemaining",0),this.setCalloutActive(!1),n=t=i=r=u=f=null,""};n.Model.CalloutRecurring=u;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.SetDateFromAndDateTo=function(i,r,u,f,e,o){var h,s,c,l;if(e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{h=e.toString()+","+i.getAD_Client_ID().toString();s=n.dataContext.getJSONRecord("Common/GetPeriodFromYear",h);s!=null&&(c=t.getValueOfDate(s.STARTDATE),l=t.getValueOfDate(s.ENDDATE),u.setValue("DateFrom",c),u.setValue("DateTo",l))}catch(a){this.setCalloutActive(!1);this.log.severe(a.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};r.prototype.SetCurrency=function(i,r,u,f,e,o){var h,s,c;if(e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{h=e.toString()+","+i.getAD_Client_ID().toString();s=n.dataContext.getJSONRecord("Common/GetCurrencyFromAccountingSchema",h);s!=null&&(c=t.getValueOfInt(s.CurrencyID),u.setValue("C_Currency_ID",c))}catch(l){this.setCalloutActive(!1);this.log.severe(l.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutProfitLoss=r;n.Utility.inheritPrototype(f,n.CalloutEngine);f.prototype.SetProfitBeforeTax=function(i,r,u,f,e,o){if(e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";this.setCalloutActive(!0);try{var s=n.dataContext.getJSONRecord("MProfitTax/GetProfitLossDetails",e.toString());Object.keys(s).length>0&&(u.setValue("ProfitBeforeTax",t.getValueOfDecimal(s.ProfitBeforeTax)),u.setValue("C_Year_ID",t.getValueOfInt(s.C_Year_ID)),u.setValue("C_ProfitAndLoss_ID",t.getValueOfInt(s.C_ProfitAndLoss_ID)))}catch(h){this.setCalloutActive(!1);this.log.severe(h.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutProfitTax=f;n.Utility.inheritPrototype(e,n.CalloutEngine);e.prototype.SetMultiplyRate=function(n,t,i,r,u){if(this.isCalloutActive()||u==null||u.toString()=="")return i.setValue("MultiplyRate",0),"";this.setCalloutActive(!0);var f=i.getValue("C_UOM_ID"),e=i.getValue("C_UOM_To_ID");return f==e&&(i.setValue("DivideRate",1),i.setValue("MultiplyRate",1)),this.setCalloutActive(!1),""};n.Model.CalloutUOMConversion=e;n.Utility.inheritPrototype(o,n.CalloutEngine);o.prototype.CheckIncoTerm=function(i,r,u,f,e){if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);var s=i.isSOTrx(r),h=0,o="";try{if(u.getTableName().startsWith("C_Order")?s&&t.getValueOfInt(u.getValue("C_Order_Quotation"))>0?(o=s+","+u.getTableName()+",C_Order_Quotation,"+t.getValueOfInt(u.getValue("C_Order_Quotation")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):!s&&t.getValueOfInt(u.getValue("Ref_Order_ID"))>0?(o=s+","+u.getTableName()+",Ref_Order_ID,"+t.getValueOfInt(u.getValue("Ref_Order_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):t.getValueOfInt(u.getValue("C_Order_Blanket"))>0&&(o=s+","+u.getTableName()+",C_Order_Blanket,"+t.getValueOfInt(u.getValue("C_Order_Blanket")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):u.getTableName().startsWith("C_Invoice")?s&&t.getValueOfInt(u.getValue("C_Order_ID"))>0?(o=s+","+u.getTableName()+",C_Order_ID,"+t.getValueOfInt(u.getValue("C_Order_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):!s&&t.getValueOfInt(u.getValue("C_Order_ID"))>0?(o=s+","+u.getTableName()+",C_Order_ID,"+t.getValueOfInt(u.getValue("C_Order_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):!s&&t.getValueOfInt(u.getValue("M_InOut_ID"))>0&&(o=s+","+u.getTableName()+",M_InOut_ID,"+t.getValueOfInt(u.getValue("M_InOut_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):u.getTableName().startsWith("M_InOut")&&(s&&t.getValueOfInt(u.getValue("C_Order_ID"))>0?(o=s+","+u.getTableName()+",C_Order_ID,"+t.getValueOfInt(u.getValue("C_Order_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):!s&&t.getValueOfInt(u.getValue("C_Order_ID"))>0?(o=s+","+u.getTableName()+",C_Order_ID,"+t.getValueOfInt(u.getValue("C_Order_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):!s&&t.getValueOfInt(u.getValue("C_Invoice_ID"))>0&&(o=s+","+u.getTableName()+",C_Invoice_ID,"+t.getValueOfInt(u.getValue("C_Invoice_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o))),h>0&h!=e)return this.setCalloutActive(!1),n.ADialog.warn("IncoTermChanged"),""}catch(c){this.setCalloutActive(!1);this.log.severe(c.toString())}return this.setCalloutActive(!1),""};n.Model.CalloutIncoTerm=o;n.Utility.inheritPrototype(s,n.CalloutEngine);s.prototype.SetLocatorPC=function(n,t,i,r,u,f){return this.isCalloutActive()||u==null||u.toString()==""?"":(this.setCalloutActive(!0),r.getColumnName()=="M_Warehouse_ID"?u!=f&&(i.setValue("M_Locator_ID",""),i.setValue("Ref_M_Container_ID","")):r.getColumnName()=="M_Locator_ID"&&u!=f&&i.setValue("Ref_M_Container_ID",""),this.setCalloutActive(!1),n=t=i=r=u=f=null,"")};n.Model.CalloutLocatorPC=s;n.Utility.inheritPrototype(h,n.CalloutEngine);h.prototype.Product=function(n,t,i,r,u){return this.isCalloutActive()||u==null||u.toString()==""?"":(this.setCalloutActive(!0),i.getField("M_AttributeSetInstance_ID")!=null&&i.setValue("M_AttributeSetInstance_ID",null),this.setCalloutActive(!1),"")};n.Model.CalloutLandedCost=h;n.Utility.inheritPrototype(c,n.CalloutEngine);c.prototype.Comparedates=function(t,i,r,u,f){if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);var e=new Date(r.getValue("DateWorkStart")),o=new Date(r.getValue("DateWorkComplete"));if(u.getColumnName()=="DateWorkStart"){if(e>=o&&r.getValue("DateWorkComplete")!=null)return r.setValue("DateWorkStart",""),this.setCalloutActive(!1),n.ADialog.info("DateWorkGreater")}else if(e>=o&&r.getValue("DateWorkStart")!=null)return r.setValue("DateWorkComplete",""),this.setCalloutActive(!1),n.ADialog.info("DateWorkGreater");return this.setCalloutActive(!1),""};n.Model.CalloutRFQ=c;n.Utility.inheritPrototype(l,n.CalloutEngine);l.prototype.ClearWeekDay=function(t,i,r,u,f){return this.isCalloutActive()||f==null||f.toString()==""?"":(this.setCalloutActive(!0),f==!0&&(r.setValue("NetDay",""),r.setValue("WeekOffset",n.Env.ZERO)),this.setCalloutActive(!1),"")};n.Model.CalloutPaymentTerm=l}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutAssignment")}var r=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Product=function(i,u,f,e,o,s){var c,h,v;if(o==null||o.toString()==""||this.isCalloutActive()||o==null||(c=t.getValueOfInt(o),c==0))return"";this.setCalloutActive(!0);var l=0,a=null,y=null,p=null;try{h=n.dataContext.getJSONRecord("MProduct/GetResourceAssignmntDet",c.toString());h!=null&&(l=t.getValueOfInt(h.M_Product_ID),a=t.getValueOfString(h.Name),y=t.getValueOfString(h.Description),p=t.getValueOfDecimal(h.Qty))}catch(w){this.setCalloutActive(!1);this.log.log(r.SEVERE,"product",w)}return this.log.fine("S_ResourceAssignment_ID="+c+" - M_Product_ID="+l),l!=0&&(f.setValue("M_Product_ID",t.getValueOfInt(l)),y!=null&&(a+=" ("+y+")"),"."!=a&&f.setValue("Description",a),v="Qty",f.getTableName().startsWith("C_Order")?v="QtyOrdered":f.getTableName().startsWith("C_Invoice")&&(v="QtyInvoiced"),p!=null&&f.setValue(v,p)),this.setCalloutActive(!1),i=u=f=e=o=s=null,""};n.Model.CalloutAssignment=i}(VIS,jQuery),function(n){function t(){n.CalloutEngine.call(this,"VIS.CalloutBankStatement")}var i=n.Logging.Level,r=n.Utility.Util;n.Utility.inheritPrototype(t,n.CalloutEngine);t.prototype.BankAccount=function(t,r,u,f,e,o){if(e==null||e.toString()=="")return"";try{var l=e,h=e.toString(),s;s=n.dataContext.getJSONRecord("MBankStatement/GetCurrentBalance",h);u.setValue("BeginningBalance",s)}catch(c){this.setCalloutActive(!1);this.log.log(i.SEVERE,"",c)}return t=r=u=f=e=o=null,""};t.prototype.Amount=function(n,t,i,r,u,f){var s,h,o,e,c;return u==null||u.toString()==""?"":this.isCalloutActive()?"":(this.setCalloutActive(!0),s=i.getValue("StmtAmt"),s==null&&(s=0),h=i.getValue("TrxAmt"),h==null&&(h=0),e=i.getValue("ChargeAmt"),e==null&&(e=0),o=s-h,r.getColumnName()=="ChargeAmt"?(e=u,e==null&&(e=0),o=o-e,i.setValue("InterestAmt",o)):(c=i.getValue("InterestAmt"),c==null&&(c=0),o=o-c,i.setValue("ChargeAmt",o)),this.setCalloutActive(!1),n=t=i=r=u=f=null,"")};t.prototype.Payment=function(t,r,u,f,e,o){var h,c,a,s;if(this.isCalloutActive()||e==null||e.toString()==""||(this.setCalloutActive(!0),h=u.getValue("C_Payment_ID"),h==null||h==0))return u.setValue("StmtAmt",0),u.setValue("TrxAmt",0),u.setValue("ChargeAmt",0),u.setValue("C_BPartner_ID",0),u.setValue("C_Invoice_ID",0),u.findColumn("C_ConversionType_ID")>=0&&u.setValue("C_ConversionType_ID",0),this.setCalloutActive(!1),"";c=u.getValue("StmtAmt");c==null&&(c=0);var y=u.getValue("C_Currency_ID"),l=u.getValue("DateAcct"),p=u.getValue("AD_Org_ID");if(l==null)return u.setValue("C_Payment_ID",0),this.setCalloutActive(!1),"PlzSelectStmtDate";try{if(a=h.toString()+","+y.toString()+","+l+","+p.toString(),s=n.dataContext.getJSONRecord("MBankStatement/GetPayment",a),s!=null&&s.length>0){if(s[0].ConvertedAmt!="")return u.setValue("C_Payment_ID",0),this.setCalloutActive(!1),s[0].ConvertedAmt;u.setValue("TrxAmt",s[0].payAmt);u.setValue("StmtAmt",s[0].payAmt);u.findColumn("C_ConversionType_ID")>=0&&u.setValue("C_ConversionType_ID",s[0].C_ConversionType_ID);u.findColumn("VA009_PaymentMethod_ID")>=0&&u.getValue("VA009_PaymentMethod_ID")>0?u.setValue("VA009_PaymentMethod_ID",s[0].VA009_PaymentMethod_ID):u.findColumn("VA009_PaymentMethod_ID")>=0&&u.setValue("VA009_PaymentMethod_ID",null);u.getValue("EFTCheckNo")==null&&s[0].EFTCheckNo!=null&&u.setValue("EFTCheckNo",s[0].EFTCheckNo);s[0].EFTValutaDate!=null&&u.setValue("EFTValutaDate",s[0].EFTValutaDate);u.findColumn("TenderType")>=0&&s[0].TenderType!=null&&u.setValue("TenderType",s[0].TenderType)}}catch(v){return this.setCalloutActive(!1),this.log.log(i.SEVERE,"BankStmt_Payment",v),v.toString()}return this.setCalloutActive(!1),this.Amount(t,r,u,f,e),t=r=u=f=e=o=null,""};t.prototype.SetConvertedAmt=function(t,u,f,e,o,s){var h,a,c,v,l;if(this.isCalloutActive()||o==null||o.toString()==""||(h=r.getValueOfInt(f.getValue("C_Payment_ID")),h==0))return"";if(a=f.getValue("C_Currency_ID"),c=f.getValue("DateAcct"),c==null)return"PlzSelectStmtDate";try{v=h.toString()+","+a.toString()+","+c.toString();l=n.dataContext.getJSONRecord("MBankStatement/GetConvertedAmt",v);f.setValue("StmtAmt",l);f.setValue("TrxAmt",l)}catch(y){return this.setCalloutActive(!1),this.log.log(i.SEVERE,"BankStmt_DateAcct",y),y.toString()}return this.Amount(t,u,f,e,o),t=u=f=e=o=s=null,""};n.Model.CalloutBankStatement=t}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutBPartner")}function r(){n.CalloutEngine.call(this,"VIS.CalloutSetBP")}var u=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.BPGroup=function(i,r,u,f,e,o){if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{var s=n.dataContext.getJSONRecord("MBPartner/GetBPGroup",e.toString()),h=u.getValue("IsCustomer"),c=u.getValue("IsVendor");h&&s!=null&&Object.keys(s).length>0&&(u.setValue("M_ReturnPolicy_ID",t.getValueOfInt(s.M_ReturnPolicy_ID)),u.setValue("M_DiscountSchema_ID",t.getValueOfInt(s.M_DiscountSchema_ID)),u.setValue("M_PRICELIST_ID",t.getValueOfInt(s.M_PriceList_ID)));c&&s!=null&&Object.keys(s).length>0&&(u.setValue("PO_ReturnPolicy_ID",t.getValueOfInt(s.PO_ReturnPolicy_ID)),u.setValue("PO_DiscountSchema_ID",t.getValueOfInt(s.PO_DiscountSchema_ID)),u.setValue("PO_PriceList_ID",t.getValueOfInt(s.PO_PriceList_ID)))}catch(l){this.setCalloutActive(!1);this.log.severe(l.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutBPartner=i;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.SetBP=function(n,i,r,u,f,e){if(f==null||f.toString()==""||t.getValueOfInt(f)==0||this.isCalloutActive())return"";try{this.setCalloutActive(!0);r.setValue("C_BPartner_ID",t.getValueOfInt(f));this.setCalloutActive(!1)}catch(o){this.setCalloutActive(!1)}return n=i=r=u=f=e=null,""};n.Model.CalloutSetBP=r}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutCashJournal")}function r(){n.CalloutEngine.call(this,"VIS.CalloutSetReadOnly")}function u(){n.CalloutEngine.call(this,"VIS.CalloutCashJournalLine")}var f=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Invoice=function(i,r,u,e,o,s){var l,v,g,d;if(this.isCalloutActive())return"";if(o==null||o.toString()=="")return e.getColumnName()=="C_Invoice_ID"&&(this.setCalloutActive(!0),u.setValue("C_BPartner_ID",null),u.setValue("C_BPartner_Location_ID",null),u.setValue("C_InvoicePaySchedule_ID",null),i.setContext(r,"InvTotalAmt",""),i.setContext("InvTotalAmt",""),u.setValue("ConvertedAmt",n.Env.ZERO),u.setValue("Amount",n.Env.ZERO),u.setValue("DiscountAmt",n.Env.ZERO),u.setValue("WriteOffAmt",n.Env.ZERO),u.setValue("OverUnderAmt",n.Env.ZERO),this.setCalloutActive(!1)),"";this.setCalloutActive(!0);var a=t.getValueOfInt(o),p=0,w=0,b=0,c=null;try{c=n.dataContext.getJSONRecord("MInvoice/GetInvPaySchedDetail",a.toString());c!=null&&(w=t.getValueOfInt(c.C_InvoicePaySchedule_ID),u.setValue("C_InvoicePaySchedule_ID",w),p=t.getValueOfDecimal(c.dueAmount),b=1)}catch(y){return c!=null&&(c=null),this.log.log(f.SEVERE,"CalloutCashJournal.Invoice -"+a,y.message),y.toString()}if(a==null||a==0)return u.setValue("C_Currency_ID",null),this.setCalloutActive(!1),"";var k=new Date(i.getContext(r,"DateAcct")),nt="TO_DATE( '"+(Number(k.getMonth())+1)+"-"+k.getDate()+"-"+k.getFullYear()+"', 'MM-DD-YYYY')",tt=a.toString()+","+nt.toString()+","+w.toString(),h=null;try{h=n.dataContext.getJSONRecord("MInvoice/GetInvoiceDetails",tt);h!=null&&(l=0,u.setValue("C_BPartner_ID",t.getValueOfInt(h.C_BPartner_ID)),u.setValue("C_Currency_ID",t.getValueOfInt(h.C_Currency_ID)),u.setValue("C_ConversionType_ID",t.getValueOfInt(h.C_ConversionType_ID)),u.setValue("C_BPartner_Location_ID",t.getValueOfInt(h.C_BPartner_Location_ID)),l=b==0?t.getValueOfDecimal(h.invoiceOpen):p,v=t.getValueOfDecimal(h.paymentTermDiscount),g="Y"==h.IsSOTrx,g||(l=b==0?l*-1:p*-1,v=v*-1),d=t.getValueOfString(h.docbaseType),"ARC"==d||"API"==d?u.setValue("VSS_PAYMENTTYPE","P"):u.setValue("VSS_PAYMENTTYPE","R"),i.setContext("InvTotalAmt",l.toString()),u.setValue("Amount",l-v),u.setValue("DiscountAmt",v),u.setValue("WriteOffAmt",n.Env.ZERO))}catch(y){return idr!=null&&(idr.close(),idr=null),this.log.log(f.SEVERE,"invoice",y),this.setCalloutActive(!1),y.toString()}return this.setCalloutActive(!1),i=r=u=e=o=s=null,""};i.prototype.SetAmount=function(i,r,u,f,e){var l,y,p,o,w,a,v,s,c,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";if(this.setCalloutActive(!0),e==null||e.toString()=="")return t.getValueOfInt(u.getValue("C_Invoice_ID"))>0?(l=t.getValueOfDecimal(n.dataContext.getJSONRecord("MCashBook/GetPaySheduleAmt",u.getValue("C_Invoice_ID").toString())),i.setContext(r,"InvTotalAmt",l.toString()),u.setValue("Amount",l),this.setCalloutActive(!1),""):"";if(u.setValue("DiscountAmt",n.Env.ZERO),u.setValue("WriteOffAmt",n.Env.ZERO),u.setValue("OverUnderAmt",n.Env.ZERO),y=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),y.VA009_){if(i.setContext("InvTotalAmt",""),s=t.getValueOfInt(e),s==null||s==0)return i.setContext(r,"InvTotalAmt",null),u.getTableName()=="C_Payment"?(u.setValue("PayAmt",null),u.setValue("PaymentAmount",null)):u.setValue("Amount",null),u.setValue("DiscountAmt",0),u.setValue("WriteOffAmt",n.Env.ZERO),i.setContext("InvTotalAmt",0),this.setCalloutActive(!1),"";p=s.toString()+","+u.getValue("C_Cash_ID")+","+u.getValue("C_Invoice_ID");o=n.dataContext.getJSONRecord("MCashBook/GetPaySheduleData",p);o!=null&&(u.getTableName()=="C_Payment"?(w=o.IsReturnTrx,w=="Y"?(u.setValue("PayAmt",t.getValueOfDecimal(o.DueAmt)*-1),u.setValue("PaymentAmount",t.getValueOfDecimal(o.DueAmt)*-1)):(u.setValue("PayAmt",t.getValueOfDecimal(o.DueAmt)),u.setValue("PaymentAmount",t.getValueOfDecimal(o.DueAmt)))):(u.setValue("Amount",t.getValueOfDecimal(o.DueAmt)),i.setContext(r,"InvTotalAmt",t.getValueOfDecimal(u.getValue("Amount"))),u.setValue("WriteOffAmt",0),u.setValue("OverUnderAmt",0),a=t.getValueOfDate(o.accountDate),v=t.getValueOfString(o.isSoTrx),t.getValueOfDate(o.DiscountDate)>=a?(v=="N"?u.setValue("DiscountAmt",-1*t.getValueOfDecimal(o.DiscountAmt)):u.setValue("DiscountAmt",t.getValueOfDecimal(o.DiscountAmt)),u.setValue("Amount",t.getValueOfDecimal(o.DueAmt)-t.getValueOfDecimal(o.DiscountAmt))):t.getValueOfDate(o.DiscountDays2)>=a?(v=="N"?u.setValue("DiscountAmt",-1*t.getValueOfDecimal(o.Discount2)):u.setValue("DiscountAmt",t.getValueOfDecimal(o.Discount2)),u.setValue("Amount",t.getValueOfDecimal(o.DueAmt)-t.getValueOfDecimal(o.Discount2))):u.setValue("DiscountAmt",0)))}else{if(s=t.getValueOfInt(e),s==null||s==0)return i.setContext(r,"InvTotalAmt",null),u.getTableName()=="C_Payment"?(u.setValue("PayAmt",null),u.setValue("PaymentAmount",null)):u.setValue("Amount",null),this.setCalloutActive(!1),"";c=n.dataContext.getJSONRecord("MCashBook/GetInvSchedDueAmt",s.toString());c!=null&&(h=c.DueAmt,u.getTableName()=="C_Payment"?c.IsReturnTrx=="Y"?(u.setValue("PayAmt",h*-1),u.setValue("PaymentAmount",h*-1)):(u.setValue("PayAmt",h),u.setValue("PaymentAmount",h)):(u.setValue("Amount",h),i.setContext(r,"InvTotalAmt",t.getValueOfDecimal(u.getValue("Amount")))))}return this.setCalloutActive(!1),""};i.prototype.Amounts=function(i,r,u,f,e,o){var y,c,p,s,b,nt;if(this.isCalloutActive())return"";if(y=0,c=0,"I"==u.getValue("CashType")){if(y=i.getContext("InvTotalAmt"),(y==null||y.toString().length==0)&&(y=i.getContext(r,"InvTotalAmt")),y==null||y.toString().length==0)return"";c=t.getValueOfDecimal(y)}if(this.setCalloutActive(!0),p=0,s=t.getValueOfDecimal(u.getValue("Amount")),"I"==u.getValue("CashType")){var a=t.getValueOfDecimal(u.getValue("DiscountAmt")),l=t.getValueOfDecimal(u.getValue("WriteOffAmt")),h=t.getValueOfDecimal(u.getValue("OverUnderAmt")),w=f.getColumnName(),v=u.getValue("VSS_PaymentType");v=="P"?(s>0&&(s=s*-1,u.setValue("PayAmt",s)),a>0&&(a=a*-1),l>0&&(l=l*-1,u.setValue("WriteOffAmt",l)),h>0&&(h=h*-1,u.setValue("OverUnderAmt",h)),c>0&&(c=c*-1)):(s<0&&(s=s*-1,u.setValue("PayAmt",s)),a<0&&(a=a*-1),l<0&&(l=l*-1,u.setValue("WriteOffAmt",l)),h<0&&(h=h*-1,u.setValue("OverUnderAmt",h)),c<0&&(c=c*-1));this.log.fine(w+" - Invoice="+c+" - Amount="+s+", Discount="+a+", WriteOff="+l);w=="Amount"?(b=c-s,h=b-a-l,(v=="R"&&h>0||v=="P"&&h<0)&&n.ADialog.info("LessScheduleAmount"),(v=="P"&&h>0||v=="R"&&h<0)&&(n.ADialog.info("MoreScheduleAmount"),s=c-a-l,h=c-s-a-l,u.setValue("PayAmt",s)),u.setValue("DiscountAmt",a),u.setValue("OverUnderAmt",h)):(b=c-a,s=b-l-h,(v=="P"&&s>0||v=="R"&&s<0)&&(n.ADialog.info("MoreScheduleAmount"),w=="OverUnderAmt"&&(s=c-a-l,h=c-s-a-l,u.setValue("OverUnderAmt",h)),w=="DiscountAmt"&&(s=c-h-l,a=c-s-h-l,u.setValue("DiscountAmt",a)),w=="WriteOffAmt"&&(s=c-a-h,l=c-s-a-h,u.setValue("WriteOffAmt",l))),u.setValue("Amount",s),(v=="R"&&h>0||v=="P"&&h<0)&&n.ADialog.info("LessScheduleAmount"))}var k=u.getValue("C_Cash_ID").toString(),d=n.dataContext.getJSONRecord("MCashBook/GetCashJournal",k),it=d.DateAcct,g=d.C_Currency_ID,tt=d.C_Currency_ID;return u.getValue("C_Currency_ID")!=null&&(g=u.getValue("C_Currency_ID").toString()),nt=0,u.getField("C_ConversionType_ID")!=null&&(nt=t.getValueOfInt(u.getValue("C_ConversionType_ID"))),g!=tt?(k=s.toString()+","+g+","+tt+","+it+","+nt.toString()+","+i.getAD_Client_ID().toString()+","+i.getAD_Org_ID().toString(),p=n.dataContext.getJSONRecord("MConversionRate/CurrencyConvert",k),t.getValueOfDecimal(u.getValue("Amount"))!=0&&p==0&&n.ADialog.info("NoCurrencyConversion")):p=s,u.setValue("convertedAmt",p),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.BeginningBalCalc=function(i,r,u,e,o,s){var h;if(o==null||o.toString()==""||this.isCalloutActive())return"";if(this.setCalloutActive(!0),h=t.getValueOfInt(o),h==null||h==0)return u.setValue("BeginningBalance",0),this.setCalloutActive(!1),"";var a=t.getValueOfInt(u.getValue("C_CashBook_ID")),v=t.getValueOfInt(u.getValue("AD_Client_ID")),y=t.getValueOfInt(u.getValue("AD_Org_ID")),w=i.getContext("DateAcct"),p=a.toString()+","+v.toString()+","+y.toString(),c=n.dataContext.getJSONRecord("MCashJournal/GetBeginningBalCalc",p);try{c>0?u.setValue("BeginningBalance",c):u.setValue("BeginningBalance",0);idr.close()}catch(l){return idr!=null&&idr.close(),this.log.log(f.SEVERE,"Beginning balance",l),this.setCalloutActive(!1),l.toString()}return this.setCalloutActive(!1),i=r=u=e=o=s=null,""};i.prototype.SetCurrency=function(i,r,u,f,e,o){var s,h,c,w,l,b,p;if((e==null||e.toString()=="")&&f.getColumnName()!="C_ConversionType_ID"||this.isCalloutActive())return"";if(this.setCalloutActive(!0),s="",h=t.getValueOfDecimal(u.getValue("Amount")),f.getColumnName()=="C_CashBook_ID"){if(c=t.getValueOfInt(e),c==null||c==0)return u.setValue("C_Currency_ID",0),this.setCalloutActive(!1),"";s=c.toString();w=n.dataContext.getJSONRecord("MCashBook/GetCashBook",s);u.setValue("C_Currency_ID",w.C_Currency_ID)}else if(f.getColumnName()=="C_BankAccount_ID"){if(l=t.getValueOfInt(e),l==null||l==0)return u.setValue("C_Currency_ID",0),this.setCalloutActive(!1),"";s=l.toString();b=t.getValueOfInt(n.dataContext.getJSONRecord("MPayment/GetBankAcctCurrency",s));u.setValue("C_Currency_ID",b)}if(h!=0){s=u.getValue("C_Cash_ID").toString();var a=0,v=n.dataContext.getJSONRecord("MCashBook/GetCashJournal",s),d=v.DateAcct,y=v.C_Currency_ID,k=v.C_Currency_ID;u.getValue("C_Currency_ID")!=null&&(y=u.getValue("C_Currency_ID").toString());p=0;u.getField("C_ConversionType_ID")!=null&&(p=t.getValueOfInt(u.getValue("C_ConversionType_ID")));y!=k?(s=h.toString()+","+y+","+k+","+d+","+p.toString()+","+i.getAD_Client_ID().toString()+","+i.getAD_Org_ID().toString(),a=n.dataContext.getJSONRecord("MConversionRate/CurrencyConvert",s),a==0&&n.ADialog.info("NoCurrencyConversion")):a=h;u.setValue("convertedAmt",a)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.ConvertedAmt=function(i,r,u,f,e,o){if(e==null||e.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);try{if(e>0){if(t.getValueOfInt(u.getValue("C_ConversionType_ID"))<=0)return u.setValue("C_CashLine_ID_1",""),n.ADialog.info("VIS_SelectConversion"),this.setCalloutActive(!1),"";var h=e.toString()+","+u.getValue("C_Cash_ID").toString()+","+u.getValue("AD_Org_ID").toString()+","+u.getValue("C_ConversionType_ID").toString(),s=n.dataContext.getJSONRecord("MCashJournal/ConvertedAmt",h);if(t.getValueOfInt(s.currTo)==0)return this.setCalloutActive(!1),"";t.getValueOfDecimal(s.amt)!=0&&t.getValueOfDecimal(s.transferdAmt)==0&&n.ADialog.info("NoCurrencyConversion");u.setValue("ConvertedAmt",t.getValueOfDecimal(s.transferdAmt));u.setValue("Amount",t.getValueOfDecimal(s.amt))}else u.setValue("ConvertedAmt",0),u.setValue("Amount",0)}catch(c){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.GetBeginBal=function(t,i,r,u,f){if(f==null||f==""||this.isCalloutActive())return"";this.setCalloutActive(!0);var e=n.dataContext.getJSONRecord("MCashBook/GetBegiBalance",f.toString());return r.setValue("BeginningBalance",e),this.setCalloutActive(!1),""};n.Model.CalloutCashJournal=i;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.SetReadnly=function(n,i,r,u,f){return f==null||f.toString()==""||f.toString()=="E"?(this.setCalloutActive(!1),f!=null&&f.toString()=="E"&&(r.getField("VSS_PAYMENTTYPE").setReadOnly(!0),r.setValue("VSS_PAYMENTTYPE","P")),""):(this.setCalloutActive(!0),t.getValueOfString(r.getValue("CashType"))=="A"||t.getValueOfString(r.getValue("CashType"))=="E"?(r.setValue("VSS_PAYMENTTYPE","P"),r.getField("VSS_PAYMENTTYPE").setReadOnly(!0)):t.getValueOfString(r.getValue("CashType"))=="F"||t.getValueOfString(r.getValue("CashType"))=="R"?(r.setValue("VSS_PAYMENTTYPE","R"),r.getField("VSS_PAYMENTTYPE").setReadOnly(!0)):t.getValueOfString(r.getValue("CashType"))=="I"||t.getValueOfString(r.getValue("CashType"))=="O"?r.getField("VSS_PAYMENTTYPE").setReadOnly(!0):r.getField("VSS_PAYMENTTYPE").setReadOnly(!1),t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="P"||t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="E"?t.getValueOfDecimal(r.getValue("amount"))>0&&r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount"))):(t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="R"||t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="A")&&t.getValueOfDecimal(r.getValue("amount"))<0&&r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount"))),this.setCalloutActive(!1),"")};r.prototype.SetAmountValue=function(n,i,r,u,f){if(f==null||f.toString()=="")return r.getField("VSS_PAYMENTTYPE").setReadOnly(!1),this.setCalloutActive(!1),"";if(this.setCalloutActive(!0),t.getValueOfString(r.getValue("CashType"))!="B")t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="P"?t.getValueOfDecimal(r.getValue("amount"))>0&&r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount"))):t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="R"&&t.getValueOfDecimal(r.getValue("amount"))<0&&r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount")));else if(t.getValueOfString(r.getValue("CashType"))=="B"){var e=t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"));(e=="P"||e=="E")&&t.getValueOfDecimal(r.getValue("amount"))>0?(r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount"))),r.setValue("ConvertedAmount",0-t.getValueOfDecimal(r.getValue("ConvertedAmount")))):(e=="R"||e=="A")&&t.getValueOfDecimal(r.getValue("amount"))<0&&(r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount"))),r.setValue("ConvertedAmount",0-t.getValueOfDecimal(r.getValue("ConvertedAmount"))))}return this.setCalloutActive(!1),""};n.Model.CalloutSetReadOnly=r;n.Utility.inheritPrototype(u,n.CalloutEngine);u.prototype.SetBPLocation=function(i,r,u,f,e){var o,c,s,l,h;if(this.isCalloutActive()||e==null||e.toString()=="")return u.setValue("C_BPartner_Location_ID",null),"";this.setCalloutActive(!0);try{if(u.getValue("CashType")=="B"||u.getValue("CashType")=="C"){if(o=u.getValue("C_BPartner_ID"),o==null||o=="")return u.setValue("C_BPartner_Location_ID",null),this.setCalloutActive(!1),"";if(c=o.toString()+","+i.getAD_Client_ID().toString(),s=n.dataContext.getJSONRecord("MCashJournal/GetBPLocation",c),s!=null){if(l=t.getValueOfInt(s.CreditStatusSettingOn),h=t.getValueOfInt(s.C_BPartner_Location_ID),l=="CL"&&h==0)return this.setCalloutActive(!1),n.Msg.getMsg("LocationNew");u.setValue("C_BPartner_Location_ID",h)}}}catch(a){this.setCalloutActive(!1);this.log.severe(a.toString())}return this.setCalloutActive(!1),""};u.prototype.setAccountNo=function(i,r,u,f,e){if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{var o=n.dataContext.getJSONRecord("MCashJournal/GetBankAccountData",e);o!=null&&(u.setValue("RoutingNo",t.getValueOfString(o.RoutingNo)),u.setValue("AccountNo",t.getValueOfString(o.AccountNo)))}catch(s){this.setCalloutActive(!1);this.log.severe(s.toString())}return this.setCalloutActive(!1),""};n.Model.CalloutCashJournalLine=u}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutCheckInOut")}var r=n.Logging.Level,t=n.Utility.Util;i.prototype.TypeSelection=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=t.getValueOfBoolean(f);return o==null?"":(o==!0?r.setValue("flag1",!0):r.setValue("flag1",!1),n=i=r=u=f=e=null,"")};i.prototype.RecordSort=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=t.getValueOfBoolean(f);return o==null?"":(o==!0?r.setValue("flag2",!0):r.setValue("flag2",!1),n=i=r=u=f=e=null,"")};i.prototype.EndDate=function(i,r,u,f,e,o){var s,h,c;if(e==null||e.toString()==""||(s=t.getValueOfDateTime(e),s==null||s.equals(0)))return"";h=t.getValueOfDateTime(e);c=t.getValueOfDateTime(u.getValue("DATE_FROM"));try{h=t.getValueOfDateTime(u.getValue("TILL_DATE"));h.compareTo(c)<0&&(n.ADialog.info("EndAndStartDate"),u.setValue("TILL_DATE",c))}catch(l){this.setCalloutActive(!1)}return i=r=u=f=e=o=null,""};i.prototype.StartDate=function(n,i,r,u,f,e){var s,o,h;if(f==null||f.toString()==""||(s=t.getValueOfDateTime(f),s==null||s.equals(0)))return"";o=t.getValueOfDateTime(r.getValue("DATE_FROM"));h=t.getValueOfDateTime(r.getValue("TILL_DATE"));try{o=t.getValueOfDateTime(r.getValue("DATE_FROM"));o.compareTo(h)>0&&r.setValue("TILL_DATE",o)}catch(c){this.setCalloutActive(!1)}return n=i=r=u=f=e=null,""};n.Model.CalloutCheckInOut=i}(VIS,jQuery),function(n){function r(){n.CalloutEngine.call(this,"VIS.CalloutContract")}function f(){n.CalloutEngine.call(this,"VIS.CalloutContractQty")}function o(){n.CalloutEngine.call(this,"VIS.CalloutContractProduct")}function i(){n.CalloutEngine.call(this,"VIS.CalloutOrderContract")}function s(){n.CalloutEngine.call(this,"VIS.CalloutSetContract")}function h(){n.CalloutEngine.call(this,"VIS.CalloutSetDate ")}function c(){n.CalloutEngine.call(this,"VIS.CalloutSetDates")}var l=n.Logging.Level,t=n.Utility.Util,u=!1,a=0;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.InvoiceCount=function(i,r,u,f,e,o){if(e==null||e.toString()==""||t.getValueOfInt(e)==0)return"";var s=t.getValueOfDateTime(u.getValue("StartDate")),h=u.getValue("EndDate"),c=n.dataContext.getJSONRecord("MOrderLine/GetNoOfDays",t.getValueOfString(u.getValue("C_Frequency_ID"))),l=(h-s).Days,a=l/c;return u.setValue("TotalInvoice",a),i=r=u=f=e=o=null,""};r.prototype.EndDate=function(i,r,u,f,e,o){var h=new Date(u.getValue("StartDate")),c=new Date(u.getValue("StartDate")),l=n.dataContext.getJSONRecord("MOrderLine/GetNoOfMonths",t.getValueOfString(u.getValue("C_Frequency_ID"))),a=t.getValueOfInt(u.getValue("TotalInvoice")),s=h.setMonth(h.getMonth()+l*a);return s=new Date(h.setDate(h.getDate()-1)),u.setValue("EndDate",s),s=new Date(s),s=s.toISOString(),h=c.toISOString(),s<h&&u.setValue("EndDate",c),i=r=u=f=e=o=null,""};r.prototype.BillStartDate=function(t,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=new Date(r.getValue("StartDate")),s=new Date(r.getValue("BillStartDate"));return s.toISOString()<o.toISOString()&&(n.ADialog.info("StartDateShouldBeLessThanBillStartDate"),r.setValue("BillStartDate",r.getValue("StartDate"))),t=i=r=u=f=e=null,""};r.prototype.StartDate=function(i,r,u,f,e,o){if(e==null||e.toString()=="")return"";var h=new Date(u.getValue("StartDate")),c=n.dataContext.getJSONRecord("MOrderLine/GetNoOfDays",t.getValueOfString(u.getValue("C_Frequency_ID"))),l=t.getValueOfInt(u.getValue("TotalInvoice")),a=l*c,s=new Date(h.setDate(h.getDay()+t.getValueOfDouble(a)));return s=s.toISOString(),u.setValue("EndDate",s),i=r=u=f=e=o=null,""};r.prototype.StartDateChange=function(i,r,u,f,e,o){if(e==null||e.toString()=="")return"";var c=n.dataContext.getJSONRecord("MOrderLine/GetNoOfMonths",t.getValueOfString(u.getValue("C_Frequency_ID"))),l=t.getValueOfInt(u.getValue("TotalInvoice")),s=new Date(e),a=new Date(e),h=s.setMonth(s.getMonth()+c*l);return h=new Date(s.setDate(s.getDate()-1)),u.setValue("EndDate",h.toISOString()),h=h.toISOString(),s=a.toISOString(),h<s&&u.setValue("EndDate",s),u.setValue("BillStartDate",u.getValue("StartDate")),i=r=u=f=e=o=null,""};n.Model.CalloutContract=r;n.Utility.inheritPrototype(f,n.CalloutEngine);f.prototype.Qty=function(i,r,u,f,e,o){var c,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";var y=t.getValueOfDecimal(u.getValue("PriceActual")),p=t.getValueOfDecimal(u.getValue("QtyEntered")),l=0,w=n.Env.ZERO,s=n.Env.ZERO;if(u.setValue("LineNetAmt",y*p),l=t.getValueOfInt(u.getValue("C_Tax_ID")),u.getField("SurchargeAmt")!=null){var b=0,a=!1,v=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",u.getValue("M_PriceList_ID").toString());v!=null&&(b=v.StdPrecision,a="Y"==v.IsTaxIncluded);h=t.getValueOfDecimal(u.getValue("LineNetAmt"));c=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",l.toString()+","+h.toString()+","+b.toString()+","+a.toString());s=c.TaxAmt;u.setValue("TaxAmt",s);u.setValue("SurchargeAmt",c.SurchargeAmt);a?u.setValue("GrandTotal",h):u.setValue("GrandTotal",h+s+c.SurchargeAmt)}else w=n.dataContext.getJSONRecord("MTax/GetTaxRate",l.toString()),h=t.getValueOfDecimal(u.getValue("LineNetAmt")),s=t.getValueOfDecimal(t.getValueOfDecimal(h)*t.getValueOfDecimal(w)/100),s=s.toFixed(2),u.setValue("taxamt",s),u.setValue("GrandTotal",y*p+t.getValueOfDecimal(u.getValue("TaxAmt")));return i=r=u=f=e=o=null,""};n.Model.CalloutContractQty=f;n.Utility.inheritPrototype(o,n.CalloutEngine);o.prototype.ContractProduct=function(n,i,r,u,f,e){if(f==null||f.toString()==""||t.getValueOfInt(f)==0)return"";var o=t.getValueOfInt(r.getValue("M_Proudct_ID"));return o!=0&&t.getValueOfBoolean(f)&&(r.setValue("PriceList",0),r.setValue("PriceLimit",0),r.setValue("PriceActual",0),r.setValue("PriceEntered",0)),n=i=r=u=f=e=null,""};n.Model.CalloutContractProduct=o;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.DocType=function(i,r,u,f,o,s){var ot="O",st="S",ot="O",st="S",tt="F",d="PR",p="WR",ft="",b,k,y,ut,c,h,nt;try{if(o==null||o.toString()==""||(b=o,b==null||b==0))return"";k=u.getValue("DocumentNo");y=k==null;!y&&k.toString().startsWith("<")&&k.toString().endsWith(">")&&(y=!0);var it=u.getValue("C_DocType_ID"),rt=0,a=null;if(y||it==0)a=n.dataContext.getJSONRecord("MDocType/GetDocTypeData",b.toString());else for(a=n.dataContext.getJSONRecord("MDocType/GetDocTypeData",it.toString()),c=0;c<Object.keys(a).length;c++)rt=t.getValueOfInt(a[c].AD_Sequence_ID);var v="",w=!0,g=!1;for(c=0;c<Object.keys(a).length;c++)if(v=t.getValueOfString(a[c].DocSubTypeSO),v==null&&(v="--"),i.setContext(r,"OrderType",v),v.toString().equals("SO")||u.setValue("IsDropShip","N"),"N".toString().equals(t.getValueOfString(a[c].IsSOTrx))&&(w=!1),g="Y".toString().equals(t.getValueOfString(a[c].IsReturnTrx)),g?v.toString().equals(p)?u.setValue("DeliveryRule",tt):u.setValue("DeliveryRule","M"):(v.toString().equals(p)?u.setValue("DeliveryRule",tt):v.toString().equals(d)?u.setValue("DeliveryRule","R"):u.setValue("DeliveryRule","A"),v.toString().equals(p)||v.toString().equals(d)||v.toString().equals("WI")?u.setValue("InvoiceRule","I"):u.setValue("InvoiceRule","D"),v.toString().equals(p)?u.setValue("PaymentRule",PAYMENTRULE_Cash):u.setValue("PaymentRule",PAYMENTRULE_OnCredit),i.setContext(r,"HasCharges",t.getValueOfString(a[c].HasCharges))),a[c].CurrentNext.toString().equals("Y")&&(y||rt==t.getValueOfInt(a.AD_Sequence_ID)||(y=!0),y))try{u.setValue("DocumentNo","<"+t.getValueOfString(a[c].CurrentNext)+">")}catch(et){this.setCalloutActive(!1)}if(g)return"";if(!v.toString().equals(p)&&!v.toString().equals(d))for(ut=i.getContextAsInt(r,"C_BPartner_ID"),a=n.dataContext.getJSONRecord("MBPartner/GetBPDocTypeData",ut.toString()),c=0;c<Object.keys(a).length;c++)h=t.getValueOfString(w?a[c].paymentrule:a[c].paymentrulepo),h!=null&&h.toString().length!=0&&(w&&(h.toString().equals("B")||h.toString().equals("S")||h.toString().equals("U"))&&(h="P"),!w&&h.toString().equals("B")&&(h="P"),u.setValue("PaymentRule",h)),nt=t.getValueOfInt(w?a[c].c_paymentterm_id:a[c].po_paymentterm_id),nt!=null&&u.setValue("C_PaymentTerm_ID",nt),h=a[c].InvoiceRule.toString(),h!=null&&h.length!=0&&u.setValue("InvoiceRule",h),h=a[c].DeliveryRule.toString(),h!=null&&h.length!=0&&u.setValue("DeliveryRule",h),h=a[c].FreightCostRule.toString(),h!=null&&h.length!=0&&u.setValue("FreightCostRule",h),h=a[c].DeliveryViaRule.toString(),h!=null&&h.length!=0&&u.setValue("DeliveryViaRule",h)}catch(et){return this.setCalloutActive(!1),this.log.log(l.SEVERE,ft,et),e.message}return i=r=u=f=o=s=null,""};i.prototype.BPartner=function(i,r,u,f,o,s){var et="O",ot="S",et="O",ot="S",ut="",a,tt,v,c,b,y,k,p,d,w,g,it,rt,h,nt;try{if(o==null||o==0||o.toString()==""||(a=0,o!=null&&(a=t.getValueOfInt(o.toString())),a==0)||(tt=u.getValue("IsReturnTrx"),tt))return"";if(this.setCalloutActive(!0),v=i.getWindowContext(r,"IsSOTrx",!0)=="Y",c=n.dataContext.getJSONRecord("MBPartner/LoadBPartnerOrderData",a.toString()),c!=null&&Object.keys(c).length>0)for(b=0;b<Object.keys(c).length;b++)y=t.getValueOfInt(v?c.m_pricelist_id:c.po_pricelist_id),y!=0&&u.setValue("M_PriceList_ID",y),u.setValue("Bill_BPartner_ID",a),k=t.getValueOfInt(c.bill_location_id),k==0?u.setValue("Bill_Location_ID",null):u.setValue("Bill_Location_ID",k),p=t.getValueOfInt(c.c_bpartner_location_id),a.toString().equals(i.getContext("C_BPartner_ID"))&&(d=i.getContext("C_BPartner_Location_ID"),d.toString().length>0&&(p=int.Parse(d))),p==0?u.setValue("C_BPartner_Location_ID",null):(u.setValue("C_BPartner_Location_ID",p),"Y".toString().equals(t.getValueOfString(c.isshipto))&&u.setValue("Bill_Location_ID",p)),w=t.getValueOfInt(c.ad_user_id.toString()),a.toString().toString().equals(i.getContext("C_BPartner_ID"))&&(g=i.getContext("AD_User_ID"),g.toString().length>0&&(w=t.getValueOfInt(g))),w==0?u.setValue("AD_User_ID",null):(u.setValue("AD_User_ID",w),u.setValue("Bill_User_ID",w)),v&&(it=t.getValueOfDouble(c.so_creditlimit),it!=0&&(rt=t.getValueOfDouble(c.creditavailable),rt<0)),h=c.poreference.toString(),h!=null&&h.toString().length!=0&&u.setValue("POReference",h),h=t.getValueOfString(c.so_description),h!=null&&h.toString().trim().length!=0&&u.setValue("Description",h),h=t.getValueOfString(c.isdiscountprinted),h!=null&&h.toString().length!=0?u.setValue("IsDiscountPrinted",h):u.setValue("IsDiscountPrinted","N"),nt=i.getContext("OrderType"),u.setValue("InvoiceRule","D"),u.setValue("DeliveryRule","A"),u.setValue("PaymentRule",PAYMENTRULE_OnCredit),nt.toString().equals("PR")?(u.setValue("InvoiceRule","I"),u.setValue("DeliveryRule","R")):nt.toString().equals(MOrder.DocSubTypeSO_POS)?u.setValue("PaymentRule",PAYMENTRULE_Cash):(h=v?c.PaymentRule:c.PaymentRulePO.toString(),h!=null&&h.length!=0&&(h.toString().equals("B")&&(h="P"),v&&(h.toString().equals("S")||h.toString().equals("U"))&&(h="P"),u.setValue("PaymentRule",h)),y=t.getValueOfInt(v?c.c_paymentterm_id:c.po_paymentterm_id),y!=0&&u.setValue("C_PaymentTerm_ID",y),h=t.getValueOfString(c.invoicerule),h!=null&&h.length!=0&&u.setValue("InvoiceRule",h),h=t.getValueOfString(c.deliveryrule),h!=null&&h.length!=0&&u.setValue("DeliveryRule",h),h=t.getValueOfString(c.freightcostrule),h!=null&&h.length!=0&&u.setValue("FreightCostRule",h),h=t.getValueOfString(c.deliveryviarule),h!=null&&h.length!=0&&u.setValue("DeliveryViaRule",h))}catch(ft){return this.log.log(l.SEVERE,ut,ft),this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),i=r=u=f=o=s=null,""};i.prototype.Product=function(i,r,f,e,o){var c,b,p,nt,tt,s,h,it,v,y,et;if(o==null||o==0||o.toString()=="")return"";try{if((c=o,c==null||c==0)||(b="Y".toString().equals(i.getContext("IsReturnTrx")),b))return"";this.setCalloutActive(!0);u&&this.log.warning("init");f.setValue("C_Charge_ID",null);f.setValue("M_AttributeSetInstance_ID",null);var p=i.getContextAsInt(r,"C_BPartner_ID"),ot=t.getValueOfDecimal(f.getValue("QtyEntered")),k=i.getWindowContext(r,"IsSOTrx",!0)=="Y",d=i.getContextAsInt(r,"M_PriceList_ID"),st=d.toString().concat(",",t.getValueOfString(f.getValue("StartDate")),",",t.getValueOfString(f.getValue("M_Product_ID")),",",t.getValueOfInt(f.getValue("C_UOM_ID")),",",t.getValueOfInt(f.getValue("M_AttributeSetInstance_ID"))),g=n.dataContext.getJSONRecord("MPriceListVersion/GetM_PriceList_Version_ID_On_Transaction_Date",st),ct=f.getValue("DateOrdered"),ht=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","ED011_"),w=0;if(ht.ED011_&&(p=t.getValueOfInt(f.getValue("C_BPartner_ID")),h=p.toString()+","+c.toString(),w=n.dataContext.getJSONRecord("MProduct/GetPOUOM",h),w>0&&k==!1?f.setValue("C_UOM_ID",w):(h=c.toString(),nt=n.dataContext.getJSONRecord("MProduct/GetUOMID",h),f.setValue("C_UOM_ID",nt))),tt=t.getValueOfInt(f.getValue("C_UOM_ID")),h=c.toString().concat(",",p.toString(),",",ot.toString(),",",k,",",d.toString(),",",g.toString(),",",null,",",null,",",null,",",tt,",",a),t.getValueOfInt(g)>0&&(s=null,s=n.dataContext.getJSONRecord("MProductPricing/GetProductPricing",h),f.setValue("PriceList",s.PriceList),f.setValue("PriceLimit",s.PriceLimit),f.setValue("PriceActual",s.PriceActual),f.setValue("PriceEntered",s.PriceEntered),t.getValueOfInt(s.C_Currency_ID)>0&&f.setValue("C_Currency_ID",t.getValueOfInt(s.C_Currency_ID)),f.setValue("Discount",s.Discount),f.setValue("C_UOM_ID",t.getValueOfInt(s.C_UOM_ID)),f.setValue("QtyOrdered",f.getValue("QtyEntered")),i.setContext(r,"EnforcePriceLimit",s.IsEnforcePriceLimit?"Y":"N"),i.setContext(r,"DiscountSchema",s.IsDiscountSchema?"Y":"N")),i.getWindowContext(r,"IsSOTrx",!0)=="Y"&&(h=c.toString()+",0",it=n.dataContext.getJSONRecord("MProduct/GetProduct",h),it)){var rt=t.getValueOfDecimal(f.getValue("QtyEntered")),ut=i.getContextAsInt(r,"M_Warehouse_ID"),ft=i.getContextAsInt(r,"M_AttributeSetInstance_ID"),h=ut+","+c+","+ft,l=n.dataContext.getJSONRecord("MStorage/GetQtyAvailable",h);l==null&&(l=n.Env.ZERO);l==0||l.toString().compareTo(rt)<0||(v=0,f.getValue("C_OrderLine_ID")!=null&&(v=t.getValueOfInt(f.getValue("C_OrderLine_ID"))),v==null&&(v=0),h=ut.toString()+","+c.toString()+","+ft.toString()+","+v.toString(),y=t.getValueOfDecimal(n.dataContext.getJSONRecord("MOrderLine/GetNotReserved",h)),y==null&&(y=n.Env.ZERO),et=l-y,et.toString().compareTo(rt)<0)}this.setCalloutActive(!1);u&&this.log.warning("fini")}catch(lt){this.setCalloutActive(!1)}return this.Tax(i,r,f,e,o)};i.prototype.Tax=function(i,r,u,f,e){var o=0,s=n.Env.ZERO,h=n.Env.ZERO,a="",c,l;return o=t.getValueOfInt(u.getValue("C_Tax_ID")),c="select rate from c_tax WHERE c_tax_id="+o+"",s=t.getValueOfDecimal(n.DB.executeScalar(c,null,null)),a=this.Amt(i,r,u,f,e),l=t.getValueOfDecimal(u.getValue("LineNetAmt")),h=t.getValueOfDecimal(t.getValueOfDecimal(l)*t.getValueOfDecimal(s)/100),u.setValue("taxamt",h),this.Amt(i,r,u,f,e)};i.prototype.Amt=function(i,r,f,e,o,s){var tt,ot,st,l,y,g;if(this.isCalloutActive()||o==null||o.toString()=="")return"";this.setCalloutActive(!0);try{u&&this.log.warning("init");var d=i.getContextAsInt(r,"C_UOM_ID"),p=i.getContextAsInt(r,"M_Product_ID"),it=i.getContextAsInt(r,"M_PriceList_ID"),ct=it.toString(),y=n.dataContext.getJSONRecord("MPriceList/GetPriceList",ct),nt=t.getValueOfInt(y.StdPrecision),k,h,c,w,v,b;if(k=t.getValueOfDecimal(f.getValue("QtyEntered")),k=t.getValueOfDecimal(f.getValue("QtyEntered")),this.log.fine("QtyEntered="+k+", Ordered="+k+", UOM="+d),h=t.getValueOfDecimal(f.getValue("PriceEntered")),c=t.getValueOfDecimal(f.getValue("PriceActual")),v=t.getValueOfDecimal(f.getValue("Discount")),w=t.getValueOfDecimal(f.getValue("PriceLimit")),b=t.getValueOfDecimal(f.getValue("PriceList")),this.log.fine("PriceList="+b+", Limit="+w+", Precision="+nt),this.log.fine("PriceEntered="+h+", Actual="+c+", Discount="+v),(e.getColumnName().toString().equals("QtyEntered")||e.getColumnName().toString().equals("QtyEntered")||e.getColumnName().toString().equals("M_Product_ID"))&&!"N".toString().equals(i.getContext("DiscountSchema"))){tt=i.getContextAsInt(r,"C_BPartner_ID");e.getColumnName().toString().equals("QtyEntered")&&(l=p.toString()+","+d.toString()+","+k.toString(),k=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",l)));var ft=i.getWindowContext(r,"IsSOTrx",!0)=="Y",lt=it.toString().concat(",",t.getValueOfString(f.getValue("StartDate")),",",t.getValueOfString(f.getValue("M_Product_ID")),",",t.getValueOfInt(f.getValue("C_UOM_ID")),",",t.getValueOfInt(f.getValue("M_AttributeSetInstance_ID"))),et=n.dataContext.getJSONRecord("MPriceListVersion/GetM_PriceList_Version_ID_On_Transaction_Date",lt),at=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","ED011_"),rt=0;at>0&&(tt=t.getValueOfInt(f.getValue("C_BPartner_ID")),l=tt.toString()+","+p.toString(),rt=n.dataContext.getJSONRecord("MProduct/GetPOUOM",l),rt>0&&ft==!1?f.setValue("C_UOM_ID",rt):(l=p.toString(),ot=n.dataContext.getJSONRecord("MProduct/GetUOMID",l),f.setValue("C_UOM_ID",ot)));st=t.getValueOfInt(f.getValue("C_UOM_ID"));l=p.toString().concat(",",tt.toString(),",",k.toString(),",",ft,",",it.toString(),",",et.toString(),",",null,",",null,",",null,",",st,",",a);t.getValueOfInt(et)>0&&(y=null,y=n.dataContext.getJSONRecord("MProductPricing/GetProductPricing",l),l=p.toString()+","+d.toString()+","+y.PriceStd.toString(),h=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",l)),(h==null||h==0)&&(h=y.PriceStd),this.log.fine("QtyChanged -> PriceActual="+y.PriceStd+", PriceEntered="+h+", Discount="+y.Discount),c=y.PriceStd,f.setValue("PriceActual",y.PriceActual),f.setValue("Discount",y.Discount),f.setValue("PriceEntered",y.PriceEntered),i.setContext(r,"DiscountSchema",y.DiscountSchema?"Y":"N"))}else e.getColumnName().toString().equals("PriceActual")?(c=t.getValueOfDecimal(o),l=p.toString()+","+d.toString()+","+c.toString(),h=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",l)),(h==null||h==0)&&(h=c),this.log.fine("PriceActual="+c+" -> PriceEntered="+h),f.setValue("PriceEntered",h)):e.getColumnName().toString().equals("PriceEntered")&&(h=t.getValueOfDecimal(o),l=p.toString()+","+d.toString()+","+h.toString(),c=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",l)),(c==null||h==0)&&(c=h),this.log.fine("PriceEntered="+h+" -> PriceActual="+c),f.setValue("PriceActual",c));e.getColumnName().toString().equals("Discount")?(c=t.getValueOfDecimal((100-t.getValueOfDouble(v))/100*t.getValueOfDouble(b)),t.scale(c)>nt&&(c=c.toFixed(nt)),l=p.toString()+","+d.toString()+","+c.toString(),h=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",l)),(h==null||h==0)&&(h=c),f.setValue("PriceActual",c),f.setValue("PriceEntered",h)):(v=b==0?n.Env.ZERO:t.getValueOfDecimal((b-c)/b*100),t.scale(v)>2&&(v=v.toFixed(2)),f.setValue("Discount",v));this.log.fine("PriceEntered="+h+", Actual="+c+", Discount="+v);var ht=i.getContext("EnforcePriceLimit"),ut=i.getWindowContext(r,"IsSOTrx",!0)=="Y"&&ht!=null&&ht.toString().equals("Y"),vt="Y".toString().equals(i.getContext("IsReturnTrx"));ut&&(n.MRole.getDefault().getIsOverwritePriceLimit()||vt)&&(ut=!1);ut&&t.getValueOfDouble(w)!=0&&c.toString().compare(w)<0&&(c=w,l=p.toString()+","+d.toString()+","+w.toString(),h=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",l)),(h==null||h==0)&&(h=w),this.log.fine("(under) PriceEntered="+h+", Actual"+w),f.setValue("PriceActual",w),f.setValue("PriceEntered",h),n.ADialog.info("UnderLimitPrice"),b!=0&&(v=t.getValueOfDecimal((b-c)/b*100),t.scale(v)>2&&(v=v.toFixed(2)),f.setValue("Discount",v)));g=k*c;t.scale(g)>nt&&(g=g.toFixed(nt));this.log.info("LineNetAmt="+g);f.setValue("LineNetAmt",g);f.setValue("GrandTotal",t.getValueOfDecimal(f.getValue("TaxAmt"))+g)}catch(yt){}return this.setCalloutActive(!1),i=r=f=e=o=s=null,""};i.prototype.BPartnerContract=function(i,r,u,f,e,o){var h=null,s=null,at,yt,ft,et,w,ot,st,c,nt,p,ht,b,ct,tt,vt,k,it,rt,pt,y;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{var a=0,v="N",ut="N",lt=t.getValueOfString(u.getValue("ContractType"));if(lt==""||(e!=null&&(a=t.getValueOfInt(e.toString())),a==0)||(at=t.getValueOfBoolean(u.getValue("IsReturnTrx")),at))return"";this.setCalloutActive(!0);var d=!1,p="VA009_",g=lt=="ASR"?!0:!1,s=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix",p);if(s!=null&&(d=s.VA009_),p=d.toString()+","+a,s=n.dataContext.getJSONRecord("MBPartner/GetBPartnerOrderData",p),s!=null){if(yt=t.getValueOfInt(u.getValue("M_PriceList_ID")),y=t.getValueOfInt(g?s.M_PriceList_ID:s.PO_PriceList_ID),y!=0?u.setValue("M_PriceList_ID",y):u.setValue("M_PriceList_ID",null),u.setValue("Bill_BPartner_ID",a),ft=t.getValueOfInt(s.Bill_Location_ID),ft==0?(et=t.getValueOfInt(s.Bill_BPartner_ID),et>0&&u.setValue("Bill_BPartner_ID",et)):u.setValue("Bill_Location_ID",ft),w=t.getValueOfInt(s.C_BPartner_Location_ID),a.toString()==i.getContext("C_BPartner_ID")&&(ot=i.getContext("C_BPartner_Location_ID"),ot.length>0&&(w=t.getValueOfInt(ot))),w==0?u.setValue("C_BPartner_Location_ID",null):(u.setValue("C_BPartner_Location_ID",w),"Y"==t.getValueOfString(s.IsShipTo)&&u.setValue("Bill_Location_ID",w)),st=t.getValueOfInt(s.SalesRep_ID),st>0&&u.setValue("SalesRep_ID",st),d){var l=t.getValueOfInt(s.VA009_PaymentMethod_ID);nt<=0&&(c=n.dataContext.getJSONRecord("MBPartner/GetBPDetails",a),c!=null&&(v=t.getValueOfString(c.IsVendor),ut=t.getValueOfString(c.IsCustomer),g?v=="Y"?(l=0,h=null,ut=="Y"&&(l=t.getValueOfInt(c.VA009_PaymentMethod_ID),h=t.getValueOfString(c.VA009_PAYMENTBASETYPE))):ut=="Y"&&(l=t.getValueOfInt(c.VA009_PaymentMethod_ID),h=t.getValueOfString(c.VA009_PAYMENTBASETYPE)):v=="Y"?(l=t.getValueOfInt(c.VA009_PO_PaymentMethod_ID),h=t.getValueOfString(c.VA009_PAYMENTBASETYPEPO)):(l=0,h=null)));l==0?(nt=t.getValueOfInt(u.getValue("C_Order_Blanket")),nt>0&&(p=d.toString()+","+nt.toString(),s=n.dataContext.getJSONRecord("MOrder/GetPaymentMethod",p),s!=null&&(ht=t.getValueOfInt(s.VA009_PaymentMethod_ID),ht>0&&(u.setValue("VA009_PaymentMethod_ID",ht),h=t.getValueOfString(s.VA009_PaymentBaseType),h!="W"&&h!=null&&(u.setValue("PaymentMethod",h),v=="N"?u.setValue("PaymentRule",h):u.setValue("PaymentRulePO",h)))))):l==0?u.setValue("VA009_PaymentMethod_ID",null):(u.setValue("VA009_PaymentMethod_ID",l),h!="W"&&h!=null?(u.setValue("PaymentMethod",h),v=="N"?u.setValue("PaymentRule",h):u.setValue("PaymentRulePO",h)):(u.setValue("PaymentMethod","T"),v=="N"?u.setValue("PaymentRule","T"):u.setValue("PaymentRulePO","T")))}b=t.getValueOfInt(s.AD_User_ID);a.toString()==i.getContext("C_BPartner_ID")&&(ct=i.getContext("AD_User_ID"),ct.length>0&&(b=t.getValueOfInt(ct)));b==0?u.setValue("AD_User_ID",null):(u.setValue("AD_User_ID",b),u.setValue("Bill_User_ID",b));g&&(tt=t.getValueOfString(s.CreditStatusSettingOn),tt=="CH"?(it=t.getValueOfDouble(s.SO_CreditLimit),it!=0&&(rt=t.getValueOfDouble(s.CreditAvailable),rt<=0&&n.ADialog.info("CreditOver"))):(vt=t.getValueOfInt(u.getValue("C_BPartner_Location_ID")),k=n.dataContext.getJSONRecord("MBPartner/GetLocationData",vt.toString()),k!=null&&(tt=t.getValueOfString(k.CreditStatusSettingOn),tt=="CL"&&(it=t.getValueOfDouble(k.SO_CreditLimit),it!=0&&(rt=t.getValueOfDouble(k.CreditAvailable),rt<=0&&n.ADialog.info("CreditOver"))))));pt=t.getValueOfInt(u.getValue("C_PaymentTerm_ID"));y=t.getValueOfInt(g?s.C_PaymentTerm_ID:s.PO_PaymentTerm_ID);y!=0?u.setValue("C_PaymentTerm_ID",y):u.setValue("C_PaymentTerm_ID",null)}}catch(wt){return this.setCalloutActive(!1),wt}this.setCalloutActive(!1);o=null};i.prototype.UpdateIsSOTrx=function(n,t,i,r,u){if(this.isCalloutActive()||u==null||u.toString()==""||u==!1)return"";this.setCalloutActive(!0);n.setIsSOTrx(t,u=="ASR"?!0:!1);this.setCalloutActive(!1)};n.Model.CalloutOrderContract=i;n.Utility.inheritPrototype(s,n.CalloutEngine);s.prototype.SetContract=function(i,r,u,f,e){if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{var s=i.getContextAsInt(r,"M_Product_ID"),h=s.toString().concat(","),o=i.getWindowContext(r,"ProductType",!0);t.getValueOfString(o)==""&&(o=n.dataContext.getJSONRecord("MProduct/GetProductType",h));o=="S"?u.getField("IsContract").setReadOnly(!1):(u.getValue("IsContract",!1),u.getField("IsContract").setReadOnly(!0))}catch(c){this.log.severe(c.toString())}return this.setCalloutActive(!1),""};n.Model.CalloutSetContract=s;n.Utility.inheritPrototype(h,n.CalloutEngine);h.prototype.SetDate=function(i,r,u,f,e,o){var h,s,c;if(e==null||e.toString()=="")return"";if(u.getValue("StartDate")==null||u.getValue("NoofCycle")==null)return this.setCalloutActive(!1),"";try{this.setCalloutActive(!0);h="";h=n.dataContext.getJSONRecord("MOrderLine/GetNoOfMonths",t.getValueOfString(u.getValue("C_Frequency_ID")));s=new Date(u.getValue("StartDate"));c=s.setMonth(s.getMonth()+h*t.getValueOfInt(u.getValue("NoofCycle")));c=new Date(s.setDate(s.getDate()-1));u.setValue("EndDate",c.toISOString());i=r=u=f=e=o=null;this.setCalloutActive(!1)}catch(l){}return""};n.Model.CalloutSetDate=h;n.Utility.inheritPrototype(c,n.CalloutEngine);c.prototype.SetDates=function(n,t,i,r,u,f){return this.isCalloutActive()||u==null||u.toString()==""?"":(this.setCalloutActive(!0),r.getColumnName()=="C_Frequency_ID"&&u!=f&&(i.setValue("StartDate",""),i.setValue("EndDate","")),this.setCalloutActive(!1),"")};n.Model.CalloutSetDates=c}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutProductToOpportunity")}function r(){n.CalloutEngine.call(this,"VIS.CalloutPriceListOpp")}function u(){n.CalloutEngine.call(this,"VIS.CalloutMCampaign")}function f(){n.CalloutEngine.call(this,"VIS.CalloutLead")}var e=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.ProductInfo=function(i,r,u,f,e,o){var y,s,h,c,p,l;if(e==null||e.toString()=="")return t.getValueOfInt(u.getValue("M_Product_ID"))==0&&(u.setValue("PriceList",0),u.setValue("PlannedPrice",0),u.setValue("Discount",0),u.setValue("PlannedMarginAmt",0),u.setValue("PlannedAmt",0)),"";if(t.getValueOfInt(u.getValue("M_Product_ID"))==0)return u.setValue("PriceList",0),u.setValue("PlannedPrice",0),u.setValue("Discount",0),u.setValue("PlannedMarginAmt",0),u.setValue("PlannedAmt",0),"";var w=t.getValueOfInt(u.getValue("C_ProjectTask_ID")),b=t.getValueOfInt(u.getValue("C_ProjectPhase_ID")),k=t.getValueOfInt(u.getValue("C_Project_ID")),d=t.getValueOfInt(u.getValue("M_Product_ID")),a=0,v=0;if(u.findColumn("M_AttributeSetInstance_ID")>0&&(a=t.getValueOfInt(u.getValue("M_AttributeSetInstance_ID"))),u.findColumn("C_UOM_ID")>0&&(v=t.getValueOfInt(u.getValue("C_UOM_ID"))),y=w.toString()+","+b.toString()+","+k.toString()+","+d.toString()+","+a.toString()+","+v.toString(),s=n.dataContext.getJSONRecord("MProject/GetProjectDetail",y),s!=null){h=t.getValueOfDecimal(s.PriceList);u.setValue("PriceList",h);c=t.getValueOfDecimal(s.PriceStd);u.setValue("PlannedPrice",c);u.setValue("PlannedQty",1);p=t.getValueOfDecimal(s.PriceLimit);try{if(l=(h-c)*100/h,isNaN(l))return this.setCalloutActive(!1),n.Msg.getMsg("PriceNotDefined")}catch(g){return this.setCalloutActive(!1),"PriceListNotSelected"}u.setValue("Discount",l.toFixed(2));u.setValue("PlannedMarginAmt",c-p);t.getValueOfInt(u.getValue("C_UOM_ID"))==0&&u.setValue("C_UOM_ID",s.C_UOM_ID)}else u.setValue("PriceList",0),u.setValue("PlannedPrice",0),u.setValue("Discount",0),u.setValue("PlannedMarginAmt",0),u.setValue("PlannedAmt",0);return i=r=u=f=e=o=null,""};i.prototype.SetQty=function(i,r,u,f,e,o){var h,s;if(this.isCalloutActive()||e==null||e.toString()==""||t.getValueOfInt(e)==0)return"";if(this.setCalloutActive(!0),h=u.getValue("C_UOM_ID"),s=u.getValue("PlannedQty"),u.getValue("M_Product_ID")!=null){var l=u.getValue("M_Product_ID"),a=l.toString().concat(",",h.toString(),",",s.toString()),c=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",a);c!=null?u.setValue("BaseQty",c):u.setValue("BaseQty",s)}else u.setValue("BaseQty",s);return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutProductToOpportunity=i;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.PriceList=function(i,r,u,f,e,o){var h,s;if(e==null||e.toString()=="")return"";h="";try{s=n.dataContext.getJSONRecord("MPriceList/GetM_PriceList",t.getValueOfInt(e));s!=null&&Object.keys(s).length>0&&s.M_PriceList_ID!=0&&(u.setValue("M_PriceList_ID",s.M_PriceList_ID),s.C_Currency_id!=0?u.setValue("C_Currency_ID",s.C_Currency_id):n.ADialog.info("CurrencyNotDefinedForThePriceList"))}catch(c){this.setCalloutActive(!1);this.log.saveError(h,h)}return i=r=u=f=e=o=null,""};n.Model.CalloutPriceListOpp=r;n.Utility.inheritPrototype(u,n.CalloutEngine);u.prototype.DateRequired=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);try{var s,o;s=new Date(r.getValue("DateContract"));o=new Date(r.getValue("DateFinish"));o.toISOString()<s.toISOString()&&(r.setValue("DateFinish",""),this.setCalloutActive(!1),n.ADialog.info("DateInvalid",null,"",""));this.log.fine("DateFinish="+o)}catch(h){return n.ADialog.info("DateError"+h,null,"",""),this.setCalloutActive(!1),h}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};n.Model.CalloutMCampaign=u;n.Utility.inheritPrototype(f,n.CalloutEngine);f.prototype.SetFullName=function(n,t,i,r,u,f){if((this.isCalloutActive()||u==null||u.toString()=="")&&r.getColumnName()!="LastName")return"";this.setCalloutActive(!0);var e="";return i.getValue("Firstname")!=null&&(e=i.getValue("Firstname")),i.getValue("LastName")!=null&&i.getValue("LastName")!=""&&(e=e==""?i.getValue("LastName"):e+" "+i.getValue("LastName")),e!=""&&i.setValue("ContactName",e),this.setCalloutActive(!1),n=t=i=r=u=f=null,""};n.Model.CalloutLead=f}(VIS,jQuery),function(n){function r(){n.CalloutEngine.call(this,"VIS.CalloutKPI")}function t(){n.CalloutEngine.call(this,"VIS.CalloutDashboard")}function u(){n.CalloutEngine.call(this,"VIS.CalloutDashboardView")}function o(){n.CalloutEngine.call(this,"VIS.CalloutService")}function e(){n.CalloutEngine.call(this,"VIS.CallOutWorkflow ")}function s(){n.CalloutEngine.call(this,"VIS.CalloutDisplayButton ")}function f(){n.CalloutEngine.call(this,"VIS.CalloutModuleMgmt")}function h(){n.CalloutEngine.call(this,"VIS.CalloutAzureBlob")}var c=n.Logging.Level,i=n.Utility.Util;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.CalculationSelection=function(n,t,i,r,u){return this.isCalloutActive()||u==null||u.toString()==""||u==!1?"":(this.setCalloutActive(!0),r.getColumnName()=="IsSum"?(i.setValue("IsMaximum",!1),i.setValue("IsCount",!1),i.setValue("IsMinimum",!1)):r.getColumnName()=="IsMaximum"?(i.setValue("IsSum",!1),i.setValue("IsMinimum",!1),i.setValue("IsCount",!1)):r.getColumnName()=="IsCount"?(i.setValue("IsMaximum",!1),i.setValue("IsSum",!1),i.setValue("IsMinimum",!1)):r.getColumnName()=="IsMinimum"&&(i.setValue("IsSum",!1),i.setValue("IsCount",!1),i.setValue("IsMaximum",!1)),this.setCalloutActive(!1),"")};r.prototype.UpdateKPITableInContext=function(n,t,i,r,u){return this.isCalloutActive()||u==null||u.toString()==""?"":(this.setCalloutActive(!0),u==!0?(i.setValue("AD_Table_ID",-1),i.setValue("AD_Tab_ID",-1),n.setContext(t,"AD_Table_ID",-1),n.setContext(t,"AD_Tab_ID",-1)):(i.setValue("TableView_ID",-1),n.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1),"")};r.prototype.UpdateTabIDContext=function(n,t,i,r,u){return this.isCalloutActive()?"":(this.setCalloutActive(!0),u<1||u==null||u.toString()==""?(i.setValue("AD_Tab_ID",-1),n.setContext(t,"AD_Tab_ID",-1)):n.setContext(t,"AD_Tab_ID",u),this.setCalloutActive(!1),"")};n.Model.CalloutKPI=r;n.Utility.inheritPrototype(t,n.CalloutEngine);t.prototype.UpdateTableInContext=function(n,t,i,r,u){return this.isCalloutActive()?"":(this.setCalloutActive(!0),u==!0?(i.setValue("AD_Table_ID",-1),i.setValue("AD_Tab_ID",-1),n.setContext(t,"AD_Table_ID",-1),n.setContext(t,"AD_Tab_ID",-1)):(i.setValue("TableView_ID",-1),n.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1),"")};t.prototype.UpdateTabIDContext=function(n,t,i,r,u){return this.isCalloutActive()?"":(this.setCalloutActive(!0),u<1||u==null||u.toString()==""?(i.setValue("AD_Tab_ID",-1),n.setContext(t,"AD_Tab_ID",-1)):(n.setContext(t,"AD_Tab_ID",u),i.setValue("TableView_ID",-1),n.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1),"")};t.prototype.UpdateTableViewIDOnTableContext=function(n,t,i,r,u){return this.isCalloutActive()||u==null||u.toString()==""?"":(this.setCalloutActive(!0),u>0&&(i.setValue("TableView_ID",-1),n.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1),"")};t.prototype.SelectFunctionOnDashboard=function(n,t,r,u,f){if(this.isCalloutActive()||f==null||f.toString()==""||f==!1)return"";this.setCalloutActive(!0);var e=i.getValueOfBoolean(f);return u.getColumnName()=="IsSum"?(r.setValue("IsAvg",!1),r.setValue("IsCount",!1),r.setValue("IsNone",!1)):u.getColumnName()=="IsAvg"?(r.setValue("IsSum",!1),r.setValue("IsCount",!1),r.setValue("IsNone",!1)):u.getColumnName()=="IsCount"?(r.setValue("IsSum",!1),r.setValue("IsAvg",!1),r.setValue("IsNone",!1)):u.getColumnName()=="IsNone"&&(r.setValue("IsSum",!1),r.setValue("IsCount",!1),r.setValue("IsAvg",!1)),this.setCalloutActive(!1),""};t.prototype.ValueCheck=function(n,t,i,r,u,f){if(this.isCalloutActive())return"";this.setCalloutActive(!0);var e=i.getValue("LastNValue");return e>60&&i.setValue("LastNValue",1),this.setCalloutActive(!1),n=t=i=r=u=f=null,""};n.Model.CalloutDashboard=t;n.Utility.inheritPrototype(u,n.CalloutEngine);u.prototype.UpdateTabIDContext=function(n,t,i,r,u){return this.isCalloutActive()?"":(this.setCalloutActive(!0),u<1||u==null||u.toString()==""?(i.setValue("AD_Tab_ID",-1),n.setContext(t,"AD_Tab_ID",-1)):n.setContext(t,"AD_Tab_ID",u),this.setCalloutActive(!1),"")};u.prototype.GroupByChecked=function(t,i,r,u,f){if(this.isCalloutActive()||f==null)return"";this.setCalloutActive(!0);var e=r.getValue("RC_View_ID").toString()+","+r.getValue("RC_ViewColumn_ID").toString();return n.dataContext.getJSONRecord("MFramework/UpdateGroupByChecked",e),this.setCalloutActive(!1),""};u.prototype.IsViewChecked=function(n,t,i,r,u){return this.isCalloutActive()||u==null?"":(this.setCalloutActive(!0),u?(i.setValue("AD_Tab_ID",-1),i.setValue("AD_Table_ID",-1),n.setContext(t,"AD_Tab_ID",-1),n.setContext(t,"AD_Table_ID",-1)):(i.setValue("TableView_ID",-1),n.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1),"")};n.Model.CalloutDashboardView=u;n.Utility.inheritPrototype(o,n.CalloutEngine);o.prototype.StatisticGroup=function(n,t,i,r,u){return u==null||u.toString()==""?"":(i.setValue("FO_STATISTICSUBGROUP_ID",0),"")};n.Model.CalloutService=o;n.Utility.inheritPrototype(e,n.CalloutEngine);e.prototype.WorkflowType=function(t,r,u,f,e){var s,o;if(e==null||e.toString()=="")return"";if(this.setCalloutActive(!0),s=i.getValueOfString(e.toString()),s=="R"){if(o=n.dataContext.getJSONRecord("MFramework/GetWorkflowType",null),o==0)return n.ADialog.info("No_VADMS",null,"",""),n.Msg.getMsg("No_VADMS");u.setValue("AD_Table_ID",o)}return this.setCalloutActive(!1),""};e.prototype.SetSelectedColumn=function(t,r,u,f,e){if(e==null||e.toString()=="")return"";this.setCalloutActive(!0);var o=n.dataContext.getJSONRecord("MFramework/GetIsGenericAttribute",i.getValueOfInt(e));return o.toLower()=="C_GenAttributeSetInstance_ID".toLower()?t.setContext(r,"IsGenericAttribute","Y"):t.setContext(r,"IsGenericAttribute","N"),this.setCalloutActive(!1),""};n.Model.CallOutWorkflow=e;n.Utility.inheritPrototype(s,n.CalloutEngine);s.prototype.DisplayButton=function(t,r,u,f,e){if(e==null||e.toString()=="")return"";if(i.getValueOfInt(u.getValue("C_DocTypeTarget_ID"))!=0){var o=n.dataContext.getJSONRecord("MDocType/GetDocSubType",e.toString());o=="WR"||o=="WI"?u.setValue("InvoicePrint","Y"):u.setValue("InvoicePrint","N")}else return this.setCalloutActive(!1),"";return this.setCalloutActive(!1),""};n.Model.CalloutDisplayButton=s;n.Utility.inheritPrototype(f,n.CalloutEngine);f.prototype.GenerateMenuItemExportID=function(n,t,i,r,u){var f,e,o;return u==null||u.toString()==""?"":(f=n.getContext(t,"Prefix"),i.getValue("MenuItemExport_ID")==null&&i.getValue("IsMenuItem").toString()=="true"&&(e=new Date,o=f+e.getTime(),i.setValue("MenuItemExport_ID",o)),this.setCalloutActive(!1),"")};f.prototype.GenerateVersionID=function(n,t,i,r,u){if(u==null||u.toString()=="")return"";var f=n.getContext(t,"VersionNo"),e=f.replace(".","");return i.setValue("VersionID",e),this.setCalloutActive(!1),""};f.prototype.CheckBoxValidation=function(n,t,r,u,f){var o,e;return f==null||f.toString()==""?"":(o=i.getValueOfBoolean(f),o==!0&&(e=u.getColumnName(),e=="IsProfessionalFree"?(r.setValue("IsProfessionalPaid",!1),r.setValue("IsFree",!1),r.setValue("IsPaid",!1)):e=="IsProfessionalPaid"?(r.setValue("IsProfessionalFree",!1),r.setValue("IsFree",!1),r.setValue("IsPaid",!1)):e=="IsFree"?(r.setValue("IsProfessionalPaid",!1),r.setValue("IsProfessionalFree",!1),r.setValue("IsPaid",!1)):e=="IsPaid"&&(r.setValue("IsProfessionalPaid",!1),r.setValue("IsFree",!1),r.setValue("IsProfessionalFree",!1))),this.setCalloutActive(!1),"")};n.Model.CalloutModuleMgmt=f;n.Utility.inheritPrototype(h,n.CalloutEngine);h.prototype.CheckModule=function(t,r,u,f,e){var o,s;return this.isCalloutActive()||e==null||e.toString()==""?"":(this.setCalloutActive(!0),o=i.getValueOfString(u.getValue("SaveAttachmentOn")),o=="AB"&&(s=n.dataContext.getJSONRecord("VIS/ModulePrefix/GetModulePrefix","VA090_"),!s.VA090_))?(u.setValue("SaveAttachmentOn",null),this.setCalloutActive(!1),n.Msg.getMsg("VIS_VA090NotInstalled")):(this.setCalloutActive(!1),"")};n.Model.CalloutAzureBlob=h}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutGLJournal")}var r=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Period=function(i,r,u,f,e,o){var s,h,a,l;if(this.isCalloutActive()||e==null||e.toString()=="")return"";s=f.getColumnName();this.setCalloutActive(!0);var y=i.getContextAsInt(r,"AD_Client_ID",!1),p=t.getValueOfInt(u.getValue("AD_Org_ID")),c=new Date;if(c=s=="DateAcct"?e:u.getValue("DateAcct"),h=0,s=="C_Period_ID"&&(h=t.getValueOfInt(e)),s=="DateDoc")u.setValue("DateAcct",e);else if(s=="DateAcct"||s=="AD_Org_ID")a=y+","+c+","+p,h=t.getValueOfInt(n.dataContext.getJSONRecord("MPeriod/GetPeriod",a)),h!=0&&u.setValue("C_Period_ID",h);else if(l=n.dataContext.getJSONRecord("MPeriod/GetPeriodDetail",h.toString()),l!=null){var w=l.PeriodType,b=l.StartDate,v=l.EndDate;w=="S"&&(c==null||c<b||c>v)&&u.setValue("DateAcct",v)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.Rate=function(i,u,f,o,s,h){var a;if(s==null||s.toString()=="")return"";try{var v=t.getValueOfInt(f.getValue("C_Currency_ID")),y=t.getValueOfInt(v),p=t.getValueOfInt(f.getValue("C_ConversionType_ID")),w=t.getValueOfInt(p),l=f.getValue("DateAcct");l==null&&(a=new Date,l=a.toGMTString());var b=t.getValueOfInt(i.getContextAsInt(u,"C_AcctSchema_ID",!1)),k=b,d=n.dataContext.getJSONRecord("MAcctSchema/GetAcctSchema",k),g=t.getValueOfInt(i.getContextAsInt(u,"AD_Client_ID",!1)),nt=t.getValueOfInt(i.getContextAsInt(u,"AD_Org_ID",!1)),tt=y+","+d.C_Currency_ID+","+l+","+w+","+g+","+nt,c=n.dataContext.getJSONRecord("MConversionRate/GetRate",tt);this.log.fine("rate = "+c);c==null&&(c=0);f.setValue("CurrencyRate",c)}catch(it){return this.log.log(r.SEVERE,sql,e),this.setCalloutActive(!1),e.message}return i=u=f=o=s=h=null,""};i.prototype.Amt=function(i,r,u,f,e,o){var h,c,l,a;if(e==null||e.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);var y=t.getValueOfInt(i.getContextAsInt(r,"C_AcctSchema_ID")),p=y.toString(),w=n.dataContext.getJSONRecord("MAcctSchema/GetAcctSchema",p),v=w.StdPrecision,s=u.getValue("CurrencyRate");return s==null&&(s=1,u.setValue("CurrencyRate",s)),h=u.getValue("AmtSourceDr"),h==null&&(h=0),c=u.getValue("AmtSourceCr"),c==null&&(c=0),l=h*s,l.toFixed(v),u.setValue("AmtAcctDr",l),a=c*s,a.toFixed(v),u.setValue("AmtAcctCr",a),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutGLJournal=i}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutInOut")}function u(){n.CalloutEngine.call(this,"VIS.CalloutShipReceiptConfirmLine")}var r=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Order=function(i,r,u,f,e,o){var h,c;if(e==null||e.toString()=="")return"";try{if((h=t.getValueOfInt(e.toString()),h==null||h==0)||this.isCalloutActive())return"";var l=h.toString(),s=n.dataContext.getJSONRecord("MOrder/GetOrder",l),a=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA077_");t.getValueOfInt(s.ID)!=0&&(u.setValue("DateOrdered",s.DateOrdered),u.setValue("POReference",s.POReference),u.getValue("AD_Org_ID")!=t.getValueOfInt(s.AD_Org_ID)&&u.setValue("AD_Org_ID",t.getValueOfInt(s.AD_Org_ID)),u.setValue("DeliveryRule",s.DeliveryRule),u.setValue("DeliveryViaRule",s.DeliveryViaRule),u.setValue("M_Shipper_ID",t.getValueOfInt(s.M_Shipper_ID)),u.setValue("FreightCostRule",s.FreightCostRule),u.setValue("FreightAmt",s.FreightAmt),u.setValue("C_BPartner_ID",t.getValueOfInt(s.C_BPartner_ID)),u.setValue("C_BPartner_Location_ID",t.getValueOfInt(s.C_BPartner_Location_ID)),u.setValue("AD_OrgTrx_ID",t.getValueOfInt(s.AD_OrgTrx_ID)),u.setValue("C_Activity_ID",t.getValueOfInt(s.C_Activity_ID)),u.setValue("C_Campaign_ID",t.getValueOfInt(s.C_Campaign_ID)),u.setValue("C_Project_ID",t.getValueOfInt(s.C_Project_ID)),u.setValue("User1_ID",t.getValueOfInt(s.User1_ID)),u.setValue("User2_ID",t.getValueOfInt(s.User2_ID)),u.getField("C_IncoTerm_ID")!=null&&u.setValue("C_IncoTerm_ID",t.getValueOfInt(s.C_IncoTerm_ID)),c=u.getValue("IsReturnTrx"),c&&(u.setValue("Orig_Order_ID",s.Orig_Order_ID),u.setValue("Orig_InOut_ID",s.Orig_InOut_ID),t.getValueOfString(s.IsDropShip)=="Y"?u.setValue("IsDropShip",!0):u.setValue("IsDropShip",!1)),u.setValue("M_Warehouse_ID",t.getValueOfInt(s.M_Warehouse_ID)),a.VA077_&&(s.VA077_HistoricContractDate!=""&&u.setValue("VA077_HistoricContractDate",Dateoffset(s.VA077_HistoricContractDate)),s.VA077_ChangeStartDate!=""&&u.setValue("VA077_ChangeStartDate",Dateoffset(s.VA077_ChangeStartDate)),s.VA077_ContractCPStartDate!=""&&u.setValue("VA077_ContractCPStartDate",Dateoffset(s.VA077_ContractCPStartDate)),s.VA077_ContractCPEndDate!=""&&u.setValue("VA077_ContractCPEndDate",Dateoffset(s.VA077_ContractCPEndDate)),u.setValue("VA077_PartialAmtCatchUp",t.getValueOfDecimal(s.VA077_PartialAmtCatchUp)),u.setValue("VA077_OldAnnualContractTotal",t.getValueOfDecimal(s.VA077_OldAnnualContractTotal)),u.setValue("VA077_AdditionalAnnualCharge",t.getValueOfDecimal(s.VA077_AdditionalAnnualCharge)),u.setValue("VA077_NewAnnualContractTotal",t.getValueOfDecimal(s.VA077_NewAnnualContractTotal)),u.setValue("VA077_SalesCoWorker",t.getValueOfDecimal(s.VA077_SalesCoWorker)),u.setValue("VA077_SalesCoWorkerPer",t.getValueOfDecimal(s.VA077_SalesCoWorkerPer)),u.setValue("VA077_TotalMarginAmt",t.getValueOfDecimal(s.VA077_TotalMarginAmt)),u.setValue("VA077_TotalPurchaseAmt",t.getValueOfDecimal(s.VA077_TotalPurchaseAmt)),u.setValue("VA077_TotalSalesAmt",t.getValueOfDecimal(s.VA077_TotalSalesAmt)),u.setValue("VA077_MarginPercent",t.getValueOfDecimal(s.VA077_MarginPercent))))}catch(v){this.setCalloutActive(!1);this.log.severe(v.toString())}return i=r=u=f=e=o=null,""};i.prototype.DocType=function(i,u,f,e,o,s){var c,v,h,l,a;if(o==null||o.toString()==""||(c=t.getValueOfInt(o.toString()),c==null||c==0))return"";v=c.toString();h=n.dataContext.getJSONRecord("MInOut/GetDocTypeData",v);try{i.setContext(u,"C_DocTypeTarget_ID",c);h!=null&&(l=t.getValueOfString(h.docBaseType),a=h.IsReturnTrx=="Y",l.equals("MMS")&&!a?f.setValue("MovementType","C-"):l.equals("MMS")&&a?f.setValue("MovementType","C+"):l.equals("MMR")&&!a?f.setValue("MovementType","V+"):l.equals("MMR")&&a&&f.setValue("MovementType","V-"),h.IsDocNoControlled=="Y"&&f.setValue("DocumentNo","<"+t.getValueOfString(h.CurrentNext)+">"))}catch(y){return this.setCalloutActive(!1),h!=null&&(h.close(),h=null),this.log.log(r.SEVERE,sql,y),y.message}return i=u=f=e=o=s=null,""};i.prototype.BPartner=function(i,r,u,f,e,o){var s=null,c=null,l,h,y,a,w,b,v;if(e==null||e.toString()=="")return"";try{if(l=t.getValueOfInt(e.toString()),l==null||l==0)return"";var k=u.getValue("IsReturnTrx"),p=u.getValue("IsSOTrx"),d=u.getValue("C_Order_ID"),g=(!0).toString()+","+l,s=n.dataContext.getJSONRecord("MBPartner/GetBPartnerOrderData",g);s!=null&&(h=s.C_BPartner_Location_ID,d==null&&(h==0?u.setValue("C_BPartner_Location_ID",null):u.setValue("C_BPartner_Location_ID",h)),h=s.AD_User_ID,h==0?u.setValue("AD_User_ID",null):u.setValue("AD_User_ID",h),y=p?s.C_IncoTerm_ID:s.C_IncoTermPO_ID,y>0&&u.setValue("C_IncoTerm_ID",y),p&!k&&(a=s.CreditStatusSettingOn,v=s.CreditAvailable,a=="CH"?s.SOCreditStatus!=null&&(s.SOCreditStatus.equals("X")||v<=0&&n.ADialog.info("CreditLimitOver")):(w=t.getValueOfInt(u.getValue("C_BPartner_Location_ID")),c=n.dataContext.getJSONRecord("MBPartner/GetLocationData",w.toString()),c!=null&&(a=t.getValueOfString(c.CreditStatusSettingOn),a=="CL"&&(b=t.getValueOfDouble(c.SO_CreditLimit),b!=0&&(v=t.getValueOfDouble(c.CreditAvailable),v<=0&&n.ADialog.info("CreditOver")))))))}catch(nt){return this.setCalloutActive(!1),nt}return i=r=u=f=e=o=null,""};i.prototype.Warehouse=function(i,u,f,e,o,s){var l,h,c,a;if(o==null||o.toString()==""||this.isCalloutActive()||(l=t.getValueOfInt(o),l==null||l==0))return"";this.setCalloutActive(!0);h=n.dataContext.getJSONRecord("MInOut/GetWarehouse",o.toString());try{h!=null&&(c=t.getValueOfInt(h.AD_Org_ID),a=i.getContextAsInt(u,"AD_Org_ID"),a!=c&&f.setValue("AD_Org_ID",c),c=t.getValueOfInt(h.M_Locator_ID),c==0?i.setContext(u,0,"M_Locator_ID",null):(this.log.config("M_Locator_ID="+c),i.setContext(u,"M_Locator_ID",c)))}catch(v){return this.setCalloutActive(!1),h!=null&&(h.close(),h=null),this.log.log(r.SEVERE,sql,v),this.setCalloutActive(!1),v.message}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};i.prototype.OrderLine=function(i,r,u,f,e,o){var h,a,c,l,y;if(e==null||e.toString()=="")return"";if(this.setCalloutActive(!0),h=t.getValueOfInt(e.toString()),h==null||h==0)return this.setCalloutActive(!1),"";try{var l=h.toString(),v=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA077_"),s=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",l);t.getValueOfInt(s.GetID)!=0&&(t.getValueOfInt(s.M_Product_ID)>0?(u.setValue("M_Product_ID",t.getValueOfInt(s.M_Product_ID)),u.setValue("C_Charge_ID",null)):(u.setValue("C_Charge_ID",t.getValueOfInt(s.C_Charge_ID)),u.setValue("M_Product_ID",null)),u.setValue("PrintDescription",s.PrintDescription.toString()),u.setValue("M_AttributeSetInstance_ID",t.getValueOfInt(s.M_AttributeSetInstance_ID)),u.setValue("C_UOM_ID",t.getValueOfInt(s.C_UOM_ID)),a=t.getValueOfDecimal(s.QtyOrdered)-t.getValueOfDecimal(s.QtyDelivered),u.setValue("MovementQty",a),c=a,t.getValueOfDecimal(s.QtyEntered).toString().compareTo(t.getValueOfDecimal(s.QtyOrdered))!=t.getValueOfDecimal(s.QtyOrdered)&&(c=c*t.getValueOfDecimal(s.QtyEntered)/t.getValueOfDecimal(s.QtyOrdered).toFixed(12)),u.setValue("QtyEntered",c),u.setValue("C_Activity_ID",t.getValueOfInt(s.C_Activity_ID)),u.setValue("C_Campaign_ID",t.getValueOfInt(s.C_Campaign_ID)),u.setValue("C_Project_ID",t.getValueOfInt(s.C_Project_ID)),u.setValue("C_ProjectPhase_ID",t.getValueOfInt(s.C_ProjectPhase_ID)),u.setValue("C_ProjectTask_ID",t.getValueOfInt(s.C_ProjectTask_ID)),u.setValue("AD_OrgTrx_ID",t.getValueOfInt(s.AD_OrgTrx_ID)),u.setValue("User1_ID",t.getValueOfInt(s.User1_ID)),u.setValue("User2_ID",t.getValueOfInt(s.User2_ID)),t.getValueOfBoolean(s.IsReturnTrx)&&(u.setValue("Orig_OrderLine_ID",t.getValueOfInt(s.Orig_OrderLine_ID)),l=s.Orig_InOutLine_ID,y=n.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",l)),t.getValueOfString(s.IsDropShip)=="Y"?u.setValue("IsDropShip",!0):u.setValue("IsDropShip",!1),v.VA077_&&(u.setValue("VA077_CNAutodesk",t.getValueOfString(s.VA077_CNAutodesk)),u.setValue("VA077_Duration",t.getValueOfString(s.VA077_Duration)),u.setValue("VA077_MarginAmt",t.getValueOfDecimal(s.VA077_MarginAmt)),u.setValue("VA077_MarginPercent",t.getValueOfDecimal(s.VA077_MarginPercent)),u.setValue("VA077_OldSN",t.getValueOfString(s.VA077_OldSN)),u.setValue("VA077_ProductInfo",t.getValueOfString(s.VA077_ProductInfo)),u.setValue("VA077_PurchasePrice",t.getValueOfDecimal(s.VA077_PurchasePrice)),u.setValue("VA077_RegEmail",t.getValueOfString(s.VA077_RegEmail)),u.setValue("VA077_SerialNo",t.getValueOfString(s.VA077_SerialNo)),u.setValue("VA077_UpdateFromVersn",t.getValueOfString(s.VA077_UpdateFromVersn)),u.setValue("VA077_UserRef_ID",t.getValueOfInt(s.VA077_UserRef_ID)),u.setValue("VA077_ServiceContract_ID",t.getValueOfInt(s.VA077_ServiceContract_ID)),s.VA077_StartDate!=""&&u.setValue("VA077_StartDate",Dateoffset(s.VA077_StartDate)),s.VA077_EndDate!=""&&u.setValue("VA077_EndDate",Dateoffset(s.VA077_EndDate)),t.getValueOfBoolean(s.VA077_LicenceTracked)?u.setValue("VA077_LicenceTracked",!0):u.setValue("VA077_LicenceTracked",!1)))}catch(p){this.setCalloutActive(!1);this.log.severe(p.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.Product=function(i,r,u,f,e,o){var h,y,a,c,v,s,l;if(this.isCalloutActive()||e==null||e.toString()==""||(h=t.getValueOfInt(e),h==0))return"";this.setCalloutActive(!0);try{if(y=0,u.setValue("M_AttributeSetInstance_ID",null),a=i.getWindowContext(r,"IsSOTrx",!0)=="Y",a)return this.setCalloutActive(!1),"";c=t.getValueOfDecimal(u.getValue("QtyEntered"));u.setValue("MovementQty",c);v=u.getValue("M_InOut_ID").toString()+","+h.toString()+","+c.toString()+","+i.getContextAsInt(r,"C_BPartner_ID").toString();s=n.dataContext.getJSONRecord("MInOut/GetUOMConv",v);s!=null&&(s.C_UOM_ID!=s.uom&&s.uom!=0?(u.setValue("QtyEntered",s.qtyentered),u.setValue("C_UOM_ID",s.uom)):u.setValue("C_UOM_ID",s.C_UOM_ID));l=n.dataContext.getJSONRecord("MProduct/GetProduct",h.toString());l!=null&&u.setValue("PrintDescription",l.DocumentNote)}catch(p){this.setCalloutActive(!1);this.log.severe(p.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.Qty=function(i,u,f,e,o,s){var v,c,h,l,w,nt,p,b,y,tt,it,k,d,a;if(this.isCalloutActive()||o==null||o.toString()=="")return"";this.setCalloutActive(!0);try{if(v=i.getContextAsInt(u,"M_Product_ID"),this.log.log(r.WARNING,"qty - init - M_Product_ID="+v),l="",w=0,v==0)h=t.getValueOfDecimal(f.getValue("QtyEntered")),f.setValue("MovementQty",h);else if(e.getColumnName().toString().equals("C_UOM_ID"))a=o,h=t.getValueOfDecimal(f.getValue("QtyEntered")),l=a.toString(),w=n.dataContext.getJSONRecord("MUOM/GetPrecision",l),p=t.getValueOfDecimal(h.toFixed(w)),h.compareTo(p)!=0&&(this.log.fine("Corrected qtyEntered Scale UOM="+a+"; qtyEntered="+h+"->"+p),h=p,f.setValue("QtyEntered",h)),l=v.toString().concat(",",a.toString(),",",h.toString()),c=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",l),c==null&&(c=h),y=h.compareTo(c)!=0,this.log.fine("UOM="+a+", qtyEntered="+h+" -> "+y+" movementQty="+c),i.setContext(u,"UOMConversion",y?"Y":"N"),f.setValue("MovementQty",c);else if(i.getContextAsInt(u,"C_UOM_ID")==0)h=t.getValueOfDecimal(f.getValue("QtyEntered")),f.setValue("MovementQty",h);else if(e.getColumnName().toString().equals("QtyEntered")){if(t.getValueOfInt(f.getValue("M_InOutLine_ID"))>0&&(nt=n.dataContext.getJSONRecord("MInOutLine/GetInvoiceLine",f.getValue("M_InOutLine_ID").toString()),nt>0))return f.setValue("QtyEntered",s),this.setCalloutActive(!1),"VIS_CantChangeQty";a=i.getContextAsInt(u,"C_UOM_ID");h=t.getValueOfDecimal(o);l=v.toString();w=n.dataContext.getJSONRecord("MProduct/GetUOMPrecision",l);p=t.getValueOfDecimal(h.toFixed(w));h.compareTo(p)!=0&&(this.log.fine("Corrected qtyEntered Scale UOM="+a+"; qtyEntered="+h+"->"+p),h=p,f.setValue("QtyEntered",h));l=v.toString().concat(",",a.toString(),",",h.toString());c=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",l);c==null&&(c=h);y=h.compareTo(c)!=0;this.log.fine("UOM="+a+", qtyEntered="+h+" -> "+y+" movementQty="+c);i.setContext(u,"UOMConversion",y?"Y":"N");f.setValue("MovementQty",c)}else e.getColumnName().toString().equals("MovementQty")&&(a=i.getContextAsInt(u,"C_UOM_ID"),c=t.getValueOfDecimal(o),l=v.toString(),w=n.dataContext.getJSONRecord("MProduct/GetUOMPrecision",l),b=t.getValueOfDecimal(c.toFixed(w)),c.compareTo(b)!=0&&(this.log.fine("Corrected movementQty "+c+"->"+b),c=b,f.setValue("MovementQty",c)),l=v.toString().concat(",",a.toString(),",",c.toString()),h=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",l),h==null&&(h=c),y=c.compareTo(h)!=0,this.log.fine("UOM="+a+", movementQty="+c+" -> "+y+" qtyEntered="+h),i.setContext(u,"UOMConversion",y?"Y":"N"),f.setValue("QtyEntered",h));if(tt="Y".equals(i.getContext("IsReturnTrx")),v!=0&&tt&&(it=t.getValueOfInt(f.getValue("C_OrderLine_ID")),l=it.toString(),k=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",l),k.Get_ID()!=0&&(d=k.Orig_InOutLine_ID,d!=0))){var l=d.toString(),rt=n.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",l),g=rt.MovementQty;c=t.getValueOfDecimal(f.getValue("MovementQty"));g.toString().compareTo(c)<0&&(i.getWindowContext(u,"IsSOTrx",!0)=="Y"?n.ADialog.info("QtyShippedAndReturned"):n.ADialog.info("QtyRecievedAndReturnd"),f.setValue("MovementQty",g),c=g,a=i.getContextAsInt(u,"C_UOM_ID"),l=v.toString().concat(",",a.toString(),",",c.toString()),h=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",l),h==null&&(h=c),f.setValue("QtyEntered",h),f.setValue("MovementQty",c),this.log.fine("qtyEntered : "+h.toString()+"movementQty : "+c.toString()))}}catch(ut){this.setCalloutActive(!1);this.log.severe(ut.toString())}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};i.prototype.Asi=function(i,r,u,f,e,o){var s,a,h;if(this.isCalloutActive()||e==null||e.toString()==""||(s=t.getValueOfInt(e),s==null||s==0))return"";this.setCalloutActive(!0);try{if(t.getValueOfInt(u.getValue("M_Locator_ID"))==0){var v=i.getContextAsInt(r,"M_Product_ID"),c=i.getContextAsInt(r,"M_Warehouse_ID"),y=c.toString(),l=n.dataContext.getJSONRecord("MInOut/GetDefaultLocatorID",y);i.setContext(r,"M_Locator_ID",l);this.log.fine("M_Product_ID="+v+", M_ASI_ID="+s+" - M_Warehouse_ID="+c+", M_Locator_ID="+l);a=i.getContextAsInt(r,"M_AttributeSetInstance_ID");s==a&&(h=i.getContextAsInt(r,"M_Locator_ID"),h!=0&&(this.log.fine("Selected M_Locator_ID="+h),u.setValue("M_Locator_ID",h)))}}catch(p){this.setCalloutActive(!1);this.log.severe(p.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.Charge=function(i,r,u,f,e,o){var s,h;if(this.isCalloutActive()||e==null||e.toString()==""||(s=t.getValueOfInt(u.getValue("C_Charge_ID")),s==null||s==0))return"";this.setCalloutActive(!0);try{h=n.dataContext.getJSONRecord("MCharge/GetChargeDetails",s.toString());h!=null&&u.setValue("PrintDescription",h.PrintDescription)}catch(c){this.setCalloutActive(!1);this.log.severe(c.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutInOut=i;n.Utility.inheritPrototype(u,n.CalloutEngine);u.prototype.SetQty=function(n,i,r,u,f){if(this.isCalloutActive()||f==null||f.toString()=="")return"";if(this.setCalloutActive(!0),t.getValueOfDecimal(r.getValue("TargetQty"))<t.getValueOfDecimal(r.getValue("ConfirmedQty")))return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";if(u.getColumnName()=="ConfirmedQty"){if(t.getValueOfDecimal(r.getValue("ConfirmedQty"))<0)return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";r.setValue("ScrappedQty",0);r.setValue("DifferenceQty",t.getValueOfDecimal(r.getValue("TargetQty"))-(t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty"))))}else if(u.getColumnName()=="ScrappedQty"){if(t.getValueOfDecimal(r.getValue("ScrappedQty"))<0||t.getValueOfDecimal(r.getValue("TargetQty"))<t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty")))return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";r.setValue("DifferenceQty",t.getValueOfDecimal(r.getValue("TargetQty"))-(t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty"))))}return this.setCalloutActive(!1),""};n.Model.CalloutShipReceiptConfirmLine=u}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutInventory")}var r=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Product=function(i,r,u,f,e,o){var c,a,k,d,ut,s,v,y,h,tt,l,it,p,rt,nt;if(this.isCalloutActive()||f.getColumnName()!="M_ProductContainer_ID"||e!=null&&e.toString()!=""||(e=0),this.isCalloutActive()||e==null||e.toString()=="")return"";c=0;a=i.getContext(r,"AttrCode");a!=null&&a!=""&&f.getColumnName()!="M_ProductContainer_ID"&&(v=e.toString()+","+a.toString(),c=n.dataContext.getJSONRecord("MInventoryLine/GetProductAttribute",v));var w=t.getValueOfInt(u.getValue("M_InventoryLine_ID")),st=t.getValueOfInt(u.getValue("M_Inventory_ID")),b=null,ht=st.toString();if(b=n.dataContext.getJSONRecord("MInventory/GetMInventory",ht),k=b.MovementDate,d=b.AD_Org_ID,f.getColumnName()=="M_Product_ID"&&(ut=n.dataContext.getJSONRecord("MInventoryLine/GetProductUOM",e.toString()),u.setValue("C_UOM_ID",t.getValueOfInt(ut))),s=null,v=w.toString(),w!=null&&w!=0){y=null;y=n.dataContext.getJSONRecord("MInventoryLine/GetMInventoryLine",v);var h=y.M_Product_ID,l=y.M_Locator_ID,g=t.getValueOfInt(u.getValue("M_Product_ID")),ft=t.getValueOfInt(u.getValue("M_Locator_ID")),nt=t.getValueOfInt(u.getValue("M_ProductContainer_ID")),et=0;if(g!=h||ft!=l||f.getColumnName()=="M_ProductContainer_ID"){this.setCalloutActive(!0);c>0&&u.setValue("M_AttributeSetInstance_ID",c);g==h?et=t.getValueOfInt(u.getValue("M_AttributeSetInstance_ID")):u.setValue("M_AttributeSetInstance_ID",null);try{s=this.SetQtyBook(d,et,g,ft,t.getValueOfDate(k),nt);u.setValue("QtyBook",s)}catch(ot){return this.setCalloutActive(!1),this.log.severe(ot.toString()),u.setValue("QtyBook",s)}}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""}if((h=0,tt=t.getValueOfInt(u.getValue("M_Product_ID")),tt!=null&&(h=tt),h==0)||(l=0,it=t.getValueOfInt(u.getValue("M_Locator_ID")),it!=null&&(l=it),l==0))return"";this.setCalloutActive(!0);c>0&&u.setValue("M_AttributeSetInstance_ID",c);p=0;rt=t.getValueOfInt(u.getValue("M_AttributeSetInstance_ID"));rt!=null&&(p=rt);u.setValue("M_AttributeSetInstance_ID",null);nt=t.getValueOfInt(u.getValue("M_ProductContainer_ID"));try{s=this.SetQtyBook(d,p,h,l,t.getValueOfDate(k),nt);u.setValue("QtyBook",s)}catch(ot){return this.setCalloutActive(!1),this.log.severe(ot.toString()),u.setValue("QtyBook",s)}return this.log.info("M_Product_ID="+h+", M_Locator_ID="+l+", M_AttributeSetInstance_ID="+p+" - QtyBook="+s),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.AttributeSetInstance=function(i,r,u,f,e,o){var s,v,l,y,w;if(this.isCalloutActive())return"";var tt=t.getValueOfInt(u.getValue("M_InventoryLine_ID")),b=t.getValueOfInt(u.getValue("M_Inventory_ID")),a=null,k=b.toString();a=n.dataContext.getJSONRecord("MInventory/GetMInventory",k);var d=a.MovementDate,g=a.AD_Org_ID,h=null,c=0,p=t.getValueOfInt(u.getValue("M_Product_ID"));if((p!=null&&(c=p),c==0)||(s=0,v=t.getValueOfInt(u.getValue("M_Locator_ID")),v!=null&&(s=v),s==0))return"";this.setCalloutActive(!0);l=0;y=t.getValueOfInt(u.getValue("M_AttributeSetInstance_ID"));y!=null&&(l=y);w=t.getValueOfInt(u.getValue("M_ProductContainer_ID"));try{h=this.SetQtyBook(g,l,c,s,t.getValueOfDate(d),w);u.setValue("QtyBook",h)}catch(nt){return this.setCalloutActive(!1),this.log.severe(nt.toString()),u.setValue("QtyBook",h)}return this.log.info("M_Product_ID="+c+", M_Locator_ID="+s+", M_AttributeSetInstance_ID="+l+" - QtyBook="+h),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.SetDiff=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=0,s=0,h=0;this.setCalloutActive(!0);try{u.getColumnName().equals("DifferenceQty")?(s=t.getValueOfDecimal(r.getValue("OpeningStock")),h=t.getValueOfDecimal(r.getValue("DifferenceQty")),o=s-h,r.setValue("AsOnDateCount",o),r.setValue("QtyCount",0)):u.getColumnName().equals("AsOnDateCount")&&(s=t.getValueOfDecimal(r.getValue("OpeningStock")),o=t.getValueOfDecimal(r.getValue("AsOnDateCount")),h=s-o,r.setValue("DifferenceQty",h),r.setValue("QtyCount",0))}catch(c){return this.setCalloutActive(!1),this.log.severe(c.toString()),c.message}return this.setCalloutActive(!1),n=i=r=u=f=e=null,""};i.prototype.SetQtyBook=function(t,i,r,u,f,e){var o=!1;n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"]!=undefined&&(o=n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"].equals("Y",!0));var s=Number(f.getMonth())+1+"-"+f.getDate()+"-"+f.getFullYear(),h=o.toString()+","+s.toString()+","+r.toString()+","+u.toString()+","+i.toString()+","+e.toString()+","+t.toString();return n.dataContext.getJSONRecord("MInventory/GetCurrentQty",h)};i.prototype.SetUOMQty=function(i,r,u,f,e,o){var l,h,a,c,v,y;if(e==null||e.toString()==""||this.isCalloutActive())return"";var p=0,w=0,b=0,s=0;this.setCalloutActive(!0);try{if(l=t.getValueOfDecimal(u.getValue("M_Product_ID")),l==0)return this.setCalloutActive(!1),"";u.getValue("IsInternalUse")==!1||u.getValue("IsInternalUse")==null?(f.getColumnName()=="C_UOM_ID"?(h=t.getValueOfInt(e),QtyEntered=t.getValueOfDecimal(u.getValue("QtyEntered")),l=t.getValueOfInt(u.getValue("M_Product_ID")),paramStr=h.toString().concat(","),a=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),c=QtyEntered.toFixed(t.getValueOfInt(a)),QtyEntered!=c&&(this.log.fine("Corrected QtyEntered Scale UOM="+h+"; QtyEntered="+QtyEntered+"->"+c),QtyEntered=c,u.setValue("QtyEntered",QtyEntered)),paramStr=l.toString().concat(",").concat(h.toString()).concat(",").concat(QtyEntered.toString()),v=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),s=v,s==null&&(s=QtyEntered)):f.getColumnName()=="QtyEntered"&&(h=i.getContextAsInt(r,"C_UOM_ID"),QtyEntered=t.getValueOfDecimal(e),paramStr=h.toString().concat(","),a=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),c=QtyEntered.toFixed(t.getValueOfInt(a)),QtyEntered!=c&&(this.log.fine("Corrected QtyEntered Scale UOM="+h+"; QtyEntered="+QtyEntered+"->"+c),QtyEntered=c,u.setValue("QtyEntered",QtyEntered)),paramStr=l.toString().concat(",",h.toString(),",",QtyEntered.toString()),v=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),s=v,s==null&&(s=QtyEntered),y=QtyEntered!=s,this.log.fine("UOM="+h+", QtyEntered="+QtyEntered+" -> "+y+" QtyOrdered="+s),i.setContext(r,"UOMConversion",y?"Y":"N")),u.getValue("AdjustmentType").toString()=="D"?(w=t.getValueOfDecimal(u.getValue("OpeningStock")),b=s,p=w-b,u.setValue("DifferenceQty",s),u.setValue("AsOnDateCount",p)):u.getValue("AdjustmentType").toString()=="A"&&(w=t.getValueOfDecimal(u.getValue("OpeningStock")),p=s,b=w-p,u.setValue("AsOnDateCount",s),u.setValue("DifferenceQty",b))):u.getValue("IsInternalUse")==!0&&(f.getColumnName()=="C_UOM_ID"?(h=t.getValueOfInt(e),QtyEntered=t.getValueOfDecimal(u.getValue("QtyEntered")),l=t.getValueOfInt(u.getValue("M_Product_ID")),paramStr=h.toString().concat(","),a=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),c=QtyEntered.toFixed(t.getValueOfInt(a)),QtyEntered!=c&&(this.log.fine("Corrected QtyEntered Scale UOM="+h+"; QtyEntered="+QtyEntered+"->"+c),QtyEntered=c,u.setValue("QtyEntered",QtyEntered)),paramStr=l.toString().concat(",").concat(h.toString()).concat(",").concat(QtyEntered.toString()),v=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),s=v,s==null&&(s=QtyEntered),u.setValue("QtyInternalUse",s)):f.getColumnName()=="QtyEntered"&&(h=i.getContextAsInt(r,"C_UOM_ID"),QtyEntered=t.getValueOfDecimal(e),paramStr=h.toString().concat(","),a=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),c=QtyEntered.toFixed(t.getValueOfInt(a)),QtyEntered!=c&&(this.log.fine("Corrected QtyEntered Scale UOM="+h+"; QtyEntered="+QtyEntered+"->"+c),QtyEntered=c,u.setValue("QtyEntered",QtyEntered)),paramStr=l.toString().concat(",",h.toString(),",",QtyEntered.toString()),v=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),s=v,s==null&&(s=QtyEntered),y=QtyEntered!=s,this.log.fine("UOM="+h+", QtyEntered="+QtyEntered+" -> "+y+" QtyOrdered="+s),i.setContext(r,"UOMConversion",y?"Y":"N"),u.setValue("QtyInternalUse",s)))}catch(k){return this.setCalloutActive(!1),this.log.severe(k.toString()),k.message}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutInventory=i}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutInvoice")}function f(){n.CalloutEngine.call(this,"VIS.ProvisionalInvoice")}var r=n.Logging.Level,t=n.Utility.Util,u=0;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.DocType=function(i,u,f,e,o,s){var l,a,h,c;if(o==null||o.toString()==""||(l=o,l==null||l==0))return"";a=l.toString();h=n.dataContext.getJSONRecord("MDocType/GetDocTypeData",a);try{h!=null&&(i.setContext(u,"HasCharges",t.getValueOfString(h.HasCharges)),h.IsDocNoControlled=="Y"&&f.setValue("DocumentNo","<"+t.getValueOfString(h.CurrentNext)+">"),c=t.getValueOfString(h.DocBaseType),i.setContext(u,"DocBaseType",c),c.startsWith("AP")?f.setValue("PaymentRule","S"):c.endsWith("C")&&f.setValue("PaymentRule","P"),f.getField("TreatAsDiscount")!=null&&(c.equals("APC")?f.setValue("TreatAsDiscount",t.getValueOfBoolean(h.TreatAsDiscount)):f.setValue("TreatAsDiscount",!1)),f.getField("IsReturnTrx")!=null&&f.setValue("IsReturnTrx",t.getValueOfBoolean(h.IsReturnTrx)))}catch(v){return this.setCalloutActive(!1),h!=null&&h.close(),this.log.log(r.SEVERE,sql,v),v.message}return i=u=f=e=o=s=null,""};i.prototype.BPartner=function(i,u,f,e,o,s){var v,w,et,h,lt,at,vt,d,g,nt,tt,it,yt,rt,ut;if(o==null||o.toString()=="")return"";try{if(v=t.getValueOfInt(o),v==null||v==0)return"";var b="N",ft="N",st=!1,ht=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix",ct);ht!=null&&(st=ht.VA009_);var ct=st.toString()+","+v.toString(),y=i.isSOTrx(u),c=null,k=null;try{if(c=n.dataContext.getJSONRecord("MBPartner/GetBPartnerData",ct),c!=null){if(w=t.getValueOfInt(c[y?"M_PriceList_ID":"PO_PriceList_ID"]),w>0&&f.setValue("M_PriceList_ID",w),et=t.getValueOfInt(c[y?"C_IncoTerm_ID":"C_IncoTermPO_ID"]),et>0&&f.setValue("C_IncoTerm_ID",et),h=t.getValueOfString(c[y?"PaymentRule":"PaymentRulePO"]),h!=null&&h.length!=0&&(i.getContext("DocBaseType").toString().endsWith("C")?h="P":y&&(h.toString().equals("S")||h.toString().equals("U"))&&(h="P"),f.setValue("PaymentRule",h)),lt=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),lt.VA009_){var p=t.getValueOfInt(c.VA009_PaymentMethod_ID),l=t.getValueOfString(c.VA009_PaymentBaseType),b="N",a=n.dataContext.getJSONRecord("MBPartner/GetBPDetails",v);a!=null&&(b=t.getValueOfString(a.IsVendor),ft=t.getValueOfString(a.IsCustomer),y?b=="Y"?(p=0,l=null,ft=="Y"&&(p=t.getValueOfInt(a.VA009_PaymentMethod_ID),l=t.getValueOfString(a.VA009_PAYMENTBASETYPE))):ft=="Y"&&(p=t.getValueOfInt(a.VA009_PaymentMethod_ID),l=t.getValueOfString(a.VA009_PAYMENTBASETYPE)):b=="Y"?(p=t.getValueOfInt(a.VA009_PO_PaymentMethod_ID),l=t.getValueOfString(a.VA009_PAYMENTBASETYPEPO)):(p=0,l=null));p==0?f.setValue("VA009_PaymentMethod_ID",null):(f.setValue("VA009_PaymentMethod_ID",p),l!=null?(f.setValue("PaymentMethod",l),b=="N"?f.setValue("PaymentRule",l):f.setValue("PaymentRule",l)):(f.setValue("PaymentMethod","T"),b=="N"?f.setValue("PaymentRule","T"):f.setValue("PaymentRule","T")))}at=t.getValueOfInt(f.getValue("C_PaymentTerm_ID"));vt=t.getValueOfDecimal(f.getValue("C_Order_Blanket"));at>0&&vt>0||(w=t.getValueOfInt(c[y?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"]),w>0&&f.setValue("C_PaymentTerm_ID",w));d=t.getValueOfInt(c.C_BPartner_Location_ID);v.toString().equals(i.getContext("C_BPartner_ID"))&&(g=i.getContext("C_BPartner_Location_ID"),g&&g.toString().length>0&&(d=parseInt(g)));d==0?f.setValue("C_BPartner_Location_ID",null):f.setValue("C_BPartner_Location_ID",d);nt=t.getValueOfInt(c.AD_User_ID);v.toString().equals(i.getContext("C_BPartner_ID"))&&(tt=i.getContext("AD_User_ID"),tt&&tt.toString().length>0&&(nt=parseInt(tt)));nt==0?f.setValue("AD_User_ID",null):f.setValue("AD_User_ID",nt);y&&(it=c.CreditStatusSettingOn,it=="CH"?(rt=t.getValueOfDouble(c.SO_CreditLimit),rt!=0&&(ut=t.getValueOfDouble(c.CreditAvailable),c!=null&&ut<=0&&n.ADialog.info("CreditOver"))):(yt=t.getValueOfInt(f.getValue("C_BPartner_Location_ID")),dr1=n.dataContext.getJSONRecord("MBPartner/GetLocationData",yt.toString()),k!=null&&(it=k.CreditStatusSettingOn,it=="CL"&&(rt=t.getValueOfDouble(k.SO_CreditLimit),rt!=0&&(ut=t.getValueOfDouble(k.CreditAvailable),c!=null&&ut<=0&&n.ADialog.info("CreditOver"))))));h=t.getValueOfString(c.POReference);h!=null&&h.length!=0?f.setValue("POReference",h):f.setValue("POReference",null);h=t.getValueOfString(c.SO_Description);h!=null&&h.toString().trim().length!=0&&f.setValue("Description",h);h=t.getValueOfString(c.IsDiscountPrinted);h!=null&&h.toString().trim().length!=0?f.setValue("IsDiscountPrinted",h):f.setValue("IsDiscountPrinted","N")}}catch(ot){return this.setCalloutActive(!1),this.log.log(r.SEVERE,"bPartner",ot),ot.message}}catch(ot){this.setCalloutActive(!1);this.log.severe(ot.toString())}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};i.prototype.PaymentTerm=function(t,i,r,u,f,e){var o,h,c,l,s,a;if(f==null||f.toString()=="")return"";try{if(o=f,h=t.getContextAsInt(i,"C_Invoice_ID",!1),o==null||o==0||h==0)return"";if(l=o.toString().concat(",",h.toString()),s=n.dataContext.getJSONRecord("MPaymentTerm/GetPaymentTerm",l),s!=null){if(c=s.Get_ID,a=s.Apply,c==0)return"PaymentTerm not found";r.setValue("IsPayScheduleValid",a?!0:!1)}}catch(v){this.setCalloutActive(!1);this.log.severe(v.toString())}return t=i=r=u=f=e=null,""};i.prototype.Product=function(i,r,f,e,o,s){var l,a,c;if(this.isCalloutActive()||o==null||o.toString()=="")return f.setValue("VA038_AmortizationTemplate_ID",0),"";if(l=o,l==null||l==0)return"";this.setCalloutActive(!0);try{f.setValue("C_Charge_ID",null);f.setValue("M_AttributeSetInstance_ID",null);var v=f.getValue("QtyInvoiced"),y=i.getContextAsInt(r,"M_AttributeSetInstance_ID"),p=f.getValue("C_Invoice_ID").toString().concat(",",l.toString(),",",y.toString(),",",v.toString()),h=n.dataContext.getJSONRecord("MInvoice/GetInvoiceProductInfo",p);u=t.getValueOfInt(h.countEd011);a=t.getValueOfString(h.IsSOTrx)=="Y";c=0;u>0&&(c=t.getValueOfInt(h.purchasingUom),c>0&&a==!1?f.setValue("C_UOM_ID",c):f.setValue("C_UOM_ID",t.getValueOfInt(h.headerUom)));f.findColumn("C_RevenueRecognition_ID")>-1&&f.setValue("C_RevenueRecognition_ID",t.getValueOfInt(h.C_RevenueRecognition_ID));f.setValue("PriceList",t.getValueOfDecimal(h.PriceList));f.setValue("PriceLimit",t.getValueOfDecimal(h.PriceLimit));f.setValue("PriceActual",t.getValueOfDecimal(h.PriceActual));f.setValue("PriceEntered",t.getValueOfDecimal(h.PriceEntered));f.setValue("C_Currency_ID",t.getValueOfInt(h.C_Currency_ID));f.setValue("PrintDescription",t.getValueOfString(h.DocumentNote));u>0&&c>0&&a==!1&&f.setValue("QtyInvoiced",t.getValueOfDecimal(h.QtyInvoiced));i.setContext(r,"EnforcePriceLimit",t.getValueOfString(h.EnforcePriceLimit)?"Y":"N");i.setContext(r,"DiscountSchema",t.getValueOfString(h.DiscountSchema)?"Y":"N")}catch(w){this.setCalloutActive(!1);this.log.severe(w.toString())}return this.setCalloutActive(!1),s=null,this.Tax(i,r,f,e,o)};i.prototype.Charge=function(i,r,u,f,e,o){var h,c,l,s;if(e==null||e.toString()=="")return u.setValue("VA038_AmortizationTemplate_ID",0),"";s=null;try{if(h=e,h==null||h==0)return"";if(u.getValue("M_Product_ID")!=null)return u.setValue("C_Charge_ID",null),"ChargeExclusively";u.setValue("M_AttributeSetInstance_ID",null);u.setValue("S_ResourceAssignment_ID",null);c=i.getContextAsInt("#C_UOM_ID");c>0?u.setValue("C_UOM_ID",c):u.setValue("C_UOM_ID",100);i.setContext(r,"DiscountSchema","N");l=n.dataContext.getJSONRecord("MInvoice/GetPercision",u.getValue("C_Invoice_ID").toString());s=n.dataContext.getJSONRecord("MCharge/GetChargeDetails",h.toString());s!=null&&(u.setValue("PriceEntered",t.getValueOfDecimal(s.ChargeAmt).toFixed(l)),u.setValue("PrintDescription",t.getValueOfString(s.PrintDescription)),u.setValue("PriceActual",t.getValueOfDecimal(s.ChargeAmt).toFixed(l)),u.setValue("PriceLimit",0),u.setValue("PriceList",0),u.setValue("Discount",0));u.setValue("PriceLimit",n.Env.ZERO);u.setValue("PriceList",n.Env.ZERO);u.setValue("Discount",n.Env.ZERO)}catch(a){return this.setCalloutActive(!1),a.message}return o=null,this.Tax(i,r,u,f,e)};i.prototype.Tax=function(i,r,u,f,e,o){var y,p,l,h,c,w,a,b,k,d,nt,v;if(e==null||e.toString()==""||t.getValueOfInt(u.getValue("C_Charge_ID"))==0&&t.getValueOfInt(u.getValue("M_Product_ID"))==0)return"";y=f.getColumnName();try{var g="",tt=t.getValueOfString(u.getValue("C_Invoice_ID")).concat(",",t.getValueOfString(u.getValue("M_Product_ID"))+","+t.getValueOfString(u.getValue("C_Charge_ID"))),s=n.dataContext.getJSONRecord("MInvoice/GetTax",tt),it=t.getValueOfInt(s._CountVATAX),ut=i.getWindowContext(r,"IsSOTrx",!0)=="Y";if(it>0&&(g=t.getValueOfString(s.taxRule)),g=="T")if(p=t.getValueOfInt(s.taxId),p>0)u.setValue("C_Tax_ID",p);else{if(t.getValueOfInt(u.getValue("M_Product_ID"))>0)return u.setValue("M_Product_ID",""),this.setCalloutActive(!1),s.TaxExempt=="Y"?n.ADialog.info("TaxNoExemptFound"):n.ADialog.info("VATAX_DefineTax");if(t.getValueOfInt(u.getValue("C_Charge_ID"))>0)return u.setValue("C_Charge_ID",""),this.setCalloutActive(!1),s.TaxExempt=="Y"?n.ADialog.info("TaxNoExemptFound"):n.ADialog.info("VATAX_DefineChargeTax")}else{if((l=0,l=y.toString()=="M_Product_ID"?e:i.getContextAsInt(r,"M_Product_ID"),h=0,h=y.toString()=="C_Charge_ID"?e:i.getContextAsInt(r,"C_Charge_ID"),this.log.fine("Product="+l+", C_Charge_ID="+h),l==0&&h==0)||(c=i.getContextAsInt(r,"C_BPartner_Location_ID"),c==0))return this.Amt(i,r,u,f,e);this.log.fine("Ship BP_Location="+c);w=c;this.log.fine("Bill BP_Location="+w);a=i.getContext("DateInvoiced");this.log.fine("Bill Date="+a);b=a;this.log.fine("Ship Date="+b);k=i.getContextAsInt(r,"AD_Org_ID");this.log.fine("Org="+k);d=i.getContextAsInt("#M_Warehouse_ID");this.log.fine("Warehouse="+d);nt=h.toString().concat(",",a.toString(),b.toString(),",",k.toString(),",",d.toString(),",",w.toString(),",",c.toString(),",",i.getWindowContext(r,"IsSOTrx",!0).equals("Y"));v=t.getValueOfInt(n.dataContext.getJSONRecord("MTax/Get",nt));this.log.info("Tax ID="+v);v==0||u.setValue("C_Tax_ID",v)}}catch(rt){this.setCalloutActive(!1);this.log.severe(rt.toString())}return o=null,this.Amt(i,r,u,f,e)};i.prototype.Amt=function(i,u,f,e,o,s){var b,g,h,c,v,nt,y,ht,ct,lt,l,ut,ft,tt,a,k,et;if(this.isCalloutActive()||o==null||o.toString()==""||t.getValueOfInt(f.getValue("C_Charge_ID"))==0&&t.getValueOfInt(f.getValue("M_Product_ID"))==0)return"";this.setCalloutActive(!0);try{this.log.log(r.WARNING,"amt - init");var st=i.getContextAsInt(u,"C_UOM_ID"),at=i.getContextAsInt(u,"M_Product_ID"),vt=i.getContextAsInt(u,"M_PriceList_ID"),yt=i.getWindowContext(u,"IsSOTrx",!0)=="Y",pt=vt.toString(),p=n.dataContext.getJSONRecord("MPriceList/GetPriceList",pt);var d=2,w=2,it="Y",rt="N";if(p!=null&&(w=p.StdPrecision,d=p.PriceListPrecision,it=t.getValueOfString(p.EnforcePriceLimit),rt=t.getValueOfString(p.IsTaxIncluded)),ct=t.getValueOfInt(f.getValue("C_OrderLine_ID")),b=f.getValue("QtyEntered"),g=f.getValue("QtyInvoiced"),this.log.fine("QtyEntered="+b+", Invoiced="+g+", UOM="+st),h=f.getValue("PriceEntered"),c=f.getValue("PriceActual"),v=f.getValue("PriceLimit"),y=f.getValue("PriceList"),this.log.fine("PriceList="+y+", Limit="+v+", Precision="+d),this.log.fine("PriceEntered="+h+", Actual="+c),e.getColumnName()=="QtyEntered",(e.getColumnName()=="QtyInvoiced"||e.getColumnName()=="QtyEntered"||e.getColumnName()=="M_Product_ID")&&!1==i.getContext("DiscountSchema")?(lt=i.getContextAsInt(u,"C_BPartner_ID"),g==null&&(g=b),ct==0&&(ot=at.toString().concat(",",f.getValue("C_Invoice_ID").toString()+","+t.getValueOfString(f.getValue("M_AttributeSetInstance_ID"))+","+st.toString()+","+i.getAD_Client_ID().toString()+","+lt.toString()+","+b.toString()),l=n.dataContext.getJSONRecord("MInvoice/GetPrices",ot),ut="N",l!=null&&((e.getColumnName()=="M_Product_ID"||t.getValueOfDecimal(l.PriceList)!=0&&f.getValue("PriceList")==0)&&(y=l.PriceList,f.setValue("PriceList",y)),h=l.PriceEntered,ht=t.getValueOfString(l.DiscountSchema),ut=t.getValueOfString(l.IsDiscountApplied),(e.getColumnName()=="M_Product_ID"||t.getValueOfDecimal(l.PriceLimit)!=0&&f.getValue("PriceLimit")==0)&&f.setValue("PriceLimit",l.PriceLimit)),this.log.fine("amt - QtyChanged -> PriceActual="+h+", PriceEntered="+h),c=h,(e.getColumnName()=="M_Product_ID"||h!=0&&f.getValue("PriceEntered")==0||ut.equals("Y")&&h!=0)&&(f.setValue("PriceActual",c),f.setValue("PriceEntered",h))),i.setContext(u,"DiscountSchema",ht?"Y":"N")):e.getColumnName()=="PriceActual"?(c=t.getValueOfDecimal(o.toFixed(d)),h=c,this.log.fine("amt - PriceActual="+c+" -> PriceEntered="+h),f.setValue("PriceEntered",h),f.SetValue("PriceActual",c)):e.getColumnName()=="PriceEntered"&&(h=t.getValueOfDecimal(o.toFixed(d)),c=h,c==null&&(c=h),this.log.fine("amt - PriceEntered="+h+"-> PriceActual="+c),f.setValue("PriceActual",c),f.setValue("PriceEntered",h)),ft=!1,tt=yt&&it!=null&&it=="Y",ft=n.MRole.getDefault().getIsOverwritePriceLimit(),tt&&ft&&(tt=!1),tt&&t.getValueOfDouble(v)!=0&&c.compareTo(v)<0&&(c=v,h=c,h==null&&(h=v),this.log.fine("amt =(under) PriceEntered="+h+", Actual"+v),f.setValue("PriceActual",v),f.setValue("PriceEntered",h),n.ADialog.info("UnderLimitPrice"),t.getValueOfInt(y)!=0&&(nt=(y-c)/y*100,t.scale(nt)>2&&(nt=nt.toFixed(2)))),h=t.getValueOfDecimal(f.getValue("PriceEntered")),a=b*h,t.scale(a)>w&&(a=t.getValueOfDecimal(a.toFixed(w))),this.log.info("amt = LineNetAmt="+a),f.setValue("LineNetAmt",a),k=n.Env.ZERO,e.getColumnName()=="TaxAmt")k=f.getValue("TaxAmt");else if(et=f.getValue("C_Tax_ID"),et!=null){var wt=et,rt=this.IsTaxIncluded(u,i),ot=wt.toString().concat(",",a.toString(),",",rt,",",w.toString()),p=null;k=n.dataContext.getJSONRecord("MTax/CalculateTax",ot);f.setValue("TaxAmt",k);f.getField("SurchargeAmt")!=null&&f.setValue("SurchargeAmt",0)}rt?f.setValue("LineTotalAmt",t.getValueOfDecimal(a)):f.setValue("LineTotalAmt",t.getValueOfDecimal((a+k).toFixed(w)))}catch(bt){this.setCalloutActive(!1);this.log.severe(bt.toString())}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};i.prototype.IsTaxIncluded=function(t,i){var r=i.getContext("IsTaxIncluded"),u;try{if(r.toString().length==0){if(u=i.getContextAsInt(t,"M_PriceList_ID"),u==0)return!1;r=n.dataContext.getJSONRecord("MPriceList/GetTaxIncluded",u.toString());r==null&&(r="N");i.setContext(t,"IsTaxIncluded",r)}}catch(f){this.setCalloutActive(!1);this.log.severe(f.toString())}return i=t=mTab=mField=value=oldValue=null,"Y"==r};i.prototype.Qty=function(i,f,e,o,s,h){var y,w,l,c,nt,b,it,ot,k,rt,ut,ft,et,v,d,a,p;if(this.isCalloutActive()||s==null||s.toString()==""||t.getValueOfInt(e.getValue("C_Charge_ID"))==0&&t.getValueOfInt(e.getValue("M_Product_ID"))==0)return"";this.setCalloutActive(!0);try{if(y="",w=i.getContextAsInt(f,"M_Product_ID"),this.log.log(r.WARNING,"qty - init - M_Product_ID="+w),w==0)c=e.getValue("QtyEntered"),e.setValue("QtyInvoiced",c);else if(o.getColumnName().toString().equals("C_UOM_ID")||o.getColumnName().toString().equals("M_AttributeSetInstance_ID"))a=t.getValueOfInt(e.getValue("C_UOM_ID")),c=e.getValue("QtyEntered"),it=i.getContextAsInt(f,"C_BPartner_ID",!1),ot=n.dataContext.getJSONRecord("MBPartner/GetBPartner",it.toString()),y=w.toString().concat(",",e.getValue("C_Invoice_ID").toString()+","+t.getValueOfString(e.getValue("M_AttributeSetInstance_ID"))+","+a.toString()+","+i.getAD_Client_ID().toString()+","+it.toString()+","+c.toString()),k=n.dataContext.getJSONRecord("MInvoice/GetPrices",y),k!=null&&(u=k.countEd011,rt=k.countVAPRC,u<=0&&rt<=0?(v=null,c!=null&&(y=a.toString(),d=n.dataContext.getJSONRecord("MUOM/GetPrecision",y),v=c.toFixed(d)),c!=v&&(this.log.fine("Corrected QtyEntered Scale UOM="+a+"; QtyEntered="+c+"->"+v),c=v,e.setValue("QtyEntered",c)),y=w.toString().concat(",",a.toString(),",",c.toString()),l=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",y),l==null&&(l=c),p=c!=l,nt=e.getValue("PriceActual"),y=w.toString().concat(",",a.toString(),",",nt.toString()),b=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",y),b==null&&(b=nt),this.log.fine("qty - UOM="+a+", QtyEntered/PriceActual="+c+"/"+nt+" -> "+p+" QtyInvoiced/PriceEntered="+l+"/"+b),i.setContext(f,"UOMConversion",p?"Y":"N"),e.setValue("QtyInvoiced",l),e.setValue("PriceEntered",b)):(ut=k.PriceList,e.setValue("PriceList",ut),b=k.PriceEntered,e.setValue("PriceLimit",k.PriceLimit),e.setValue("PriceActual",b),e.setValue("PriceEntered",b),y=a.toString().concat(","),ft=n.dataContext.getJSONRecord("MUOM/GetPrecision",y),v=c.toFixed(t.getValueOfInt(ft)),c!=v&&(this.log.fine("Corrected QtyEntered Scale UOM="+a+"; QtyEntered="+c+"->"+v),c=v,e.setValue("QtyEntered",c)),y=w.toString().concat(",",a.toString(),",",c.toString()),et=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",y),l=et,p=!1,l!=null&&(p=c!=l),l==null&&(p=!1,l=1),p?e.setValue("QtyInvoiced",l):e.setValue("QtyInvoiced",l*v)));else if(o.getColumnName().equals("QtyEntered"))a=i.getContextAsInt(f,"C_UOM_ID"),c=s,v=null,c!=null&&(d=n.dataContext.getJSONRecord("MUOM/GetPrecision",a.toString()),v=c.toFixed(d)),c!=v&&(this.log.fine("Corrected QtyEntered Scale UOM="+a+"; QtyEntered="+c+"->"+v),c=v,e.setValue("QtyEntered",c)),g=w.toString().concat(",",a.toString(),",",c.toString()),l=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",g),l==null&&(l=c),p=c!=l,this.log.fine("qty - UOM="+a+", QtyEntered="+c+" -> "+p+" QtyInvoiced="+l),i.setContext(f,"UOMConversion",p?"Y":"N"),e.setValue("QtyInvoiced",l);else if(o.getColumnName().equals("QtyInvoiced")){a=i.getContextAsInt(f,"C_UOM_ID");l=s;var g=w.toString(),d=n.dataContext.getJSONRecord("MProduct/GetUOMPrecision",g),tt=null;l!=null&&(tt=t.getValueOfDecimal(l.toFixed(d)));l!=tt&&(this.log.fine("Corrected QtyInvoiced Scale "+l+"->"+tt),l=tt,e.setValue("QtyInvoiced",l));g=w.toString().concat(",",a.toString(),",",l.toString());c=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",g);c==null&&(c=l);p=l!=c;this.log.fine("qty - UOM="+a+", QtyInvoiced="+l+" -> "+p+" QtyEntered="+c);i.setContext(f,"UOMConversion",p?"Y":"N");e.setValue("QtyEntered",c)}}catch(st){this.setCalloutActive(!1);this.log.severe(st.toString())}finally{this.setCalloutActive(!1)}return i=f=e=o=s=h=null,""};i.prototype.PriceList=function(i,u,f,e,o,s){var h=null,c,l,a;try{if(o==null||o.toString()==""||(c=t.getValueOfInt(o.toString()),c==null||c==0))return"";h=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",o.toString());h!=null&&(f.setValue("IsTaxIncluded",Boolean("Y".equals(h.IsTaxIncluded))),i.setContext(u,"EnforcePriceLimit",h.EnforcePriceLimit),l=t.getValueOfInt(h.C_Currency_ID),f.setValue("C_Currency_ID",l),a=h.M_PriceList_Version_ID,i.setContext(u,"M_PriceList_Version_ID",a))}catch(v){return this.setCalloutActive(!1),this.log.log(r.severe,null,v),v.message}return i=u=f=e=o=s=null,""};i.prototype.CheckDueDate=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()=="")return"";if(r.getValue("DateInvoiced")==null||r.getValue("DateInvoiced")=="")return this.setCalloutActive(!1),"";try{if(this.setCalloutActive(!0),r.getValue("DateInvoiced")!=null&&r.getValue("DueDate")!=null){var o=new Date(r.getValue("DateInvoiced")),s=new Date(r.getValue("DueDate"));s<o&&(n.ADialog.error("DueDateLessThanInvoiceDate"),r.setValue("DueDate",""))}t=i=r=u=f=e=null;this.setCalloutActive(!1)}catch(h){return this.setCalloutActive(!1),h}return""};n.Model.CalloutInvoice=i;n.Utility.inheritPrototype(f,n.CalloutEngine);f.prototype.DateAcct=function(n,t,i,r,u,f){if(u==null||u.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);try{i.setValue("DateAcct",u)}catch(e){this.setCalloutActive(!1);this.log.severe(e.toString())}return this.setCalloutActive(!1),n=t=i=r=u=f=null,""};f.prototype.PriceList=function(i,u,f,e,o,s){var c,h,l,a;if(this.isCalloutActive()||o==null||o.toString()=="")return"";try{if(c=o.toString(),t.getValueOfInt(c)==0)return"";this.setCalloutActive(!0);steps&&this.log.warning("init");h=n.dataContext.getJSONRecord("MPriceList/GetPriceListDataForProvisionalInvoice",c);h!=null&&(f.setValue("IsTaxIncluded","Y"==h.IsTaxIncluded),i.setContext(u,"EnforcePriceLimit",h.EnforcePriceLimit),l=t.getValueOfInt(h.C_Currency_ID),f.setValue("C_Currency_ID",l),a=t.getValueOfInt(h.M_PriceList_Version_ID),i.setContext(u,"M_PriceList_Version_ID",a))}catch(v){return this.setCalloutActive(!1),this.log(r.SEVERE,"",v),v}return steps&&this.log.warning("finish"),this.setCalloutActive(!1),i=u=f=e=o=s=null,""};f.prototype.BPartner=function(i,r,u,f,e,o){var h,l,s,c,b,a,v,y,p,w;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(h=t.getValueOfInt(e),h==null||h==0)return"";this.isCalloutActive(!0);l=i.isSOTrx(r);s=n.dataContext.getJSONRecord("MBPartner/GetBPDataForProvisionalInvoice",h);s!=null&&(c=t.getValueOfInt(s[l?"M_PriceList_ID":"PO_PriceList_ID"]),c>0&&u.setValue("M_PriceList_ID",c),b=s.countVA009,b>0&&(a=0,a=l||t.getValueOfString(s.IsVendor)!="Y"?l&&t.getValueOfString(s.IsCustomer)=="Y"?t.getValueOfInt(s.VA009_PaymentMethod_ID):0:t.getValueOfInt(s.VA009_PO_PaymentMethod_ID),a==0?u.setValue("VA009_PaymentMethod_ID",null):u.setValue("VA009_PaymentMethod_ID",a)),c=t.getValueOfInt(s[l?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"]),c>0&&u.setValue("C_PaymentTerm_ID",c),v=t.getValueOfInt(s.C_BPartner_Location_ID),h.toString().equals(i.getContext("C_BPartner_ID"))&&(y=i.getContext("C_BPartner_Location_ID"),y&&y.toString().length>0&&(v=parseInt(y))),v==0?u.setValue("C_BPartner_Location_ID",null):u.setValue("C_BPartner_Location_ID",v),p=t.getValueOfInt(s.AD_User_ID),h.toString().equals(i.getContext("C_BPartner_ID"))&&(w=i.getContext("AD_User_ID"),w&&w.toString().length>0&&(p=parseInt(w))),p==0?u.setValue("AD_User_ID",null):u.setValue("AD_User_ID",p))}catch(k){this.setCalloutActive(!1);this.log.severe(k.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.ProvisionalInvoice=f}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutInvoiceBatch")}var r=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Date=function(n,t,i,r,u,f){return u==null||u.toString()==""?"":(i.setValue("DateAcct",u),this.SetDocumentNo(n,t,i),n=t=i=r=u=f=null,"")};i.prototype.BPartner=function(i,r,u,f,e,o){var c,l,s,b,h,y,a,p,v,w,k,d;if(e==null||e.toString()==""||(c=t.getValueOfInt(e),c==null||c==0))return"";l=i.isSOTrx();s=null;try{b=(!0).toString()+","+c.toString();s=n.dataContext.getJSONRecord("MBPartner/GetBPartnerData",b);s!=null&&(h=t.getValueOfString(s[l?"PaymentRule":"PaymentRulePO"]),h!=null&&h.length!=0&&(i.getContext("DocBaseType").endsWith("C")?h="P":(this.isSOTrx&&h=="S"||h=="U")&&(h="P")),y=t.getValueOfInt(s[l?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"]),y>0&&u.setValue("C_PaymentTerm_ID",y),a=t.getValueOfInt(s.C_BPartner_Location_ID),c.toString().equals(i.getContext("C_BPartner_ID"))&&(p=i.getContext("C_BPartner_Location_ID"),p.toString().length>0&&(a=t.getValueOfInt(p))),a==0?u.setValue("C_BPartner_Location_ID",null):u.setValue("C_BPartner_Location_ID",t.getValueOfInt(a)),v=t.getValueOfInt(s.AD_User_ID),c.toString().equals(i.getContext("C_BPartner_ID"))&&(w=i.getContext("AD_User_ID"),w.toString().length>0&&(v=t.getValueOfInt(w))),v==0?u.setValue("AD_User_ID",null):u.setValue("AD_User_ID",t.getValueOfInt(v)),l&&(k=t.getValueOfDouble(s.SO_CreditLimit),k!=0&&(d=t.getValueOfDouble(s.CreditAvailable),s==null&&d<0&&n.ADialog.info("CreditLimitOver"))))}catch(g){return this.setCalloutActive(!1),g.message}return this.SetDocumentNo(i,r,u),o=null,this.Tax(i,r,u,f,e)};i.prototype.DocType=function(n,t,i,r,u,f){return this.SetDocumentNo(n,t,i),n=t=i=r=u=f=null,""};i.prototype.SetDocumentNo=function(i,r,u,f,e,o){var y=i.getContextAsInt(r,"C_InvoiceBatch_ID"),p=y.toString(),s=null,l,a,c,h,v;(s=n.dataContext.getJSONRecord("MInvoiceBatchLine/GetInvoiceBatchLineDetail",p),s!=null)&&(l=i.getContextAsInt(r,"C_DocType_ID"),a=i.getContextAsInt(r,"C_BPartner_ID"),l!=s.C_DocType_ID||a!=s.C_BPartner_ID)&&(c=s.DocumentNo,c!=null)&&(h=0,h=t.getValueOfInt(c),h!=0)&&(v=t.getValueOfString(h+1),u.setValue("DocumentNo",v),i=r=u=f=e=o=null)};i.prototype.Charge=function(i,u,f,e,o,s){var h,c;if(o==null||o.toString()==""||(h=t.getValueOfInt(o),h==null||t.getValueOfInt(h)==0))return"";try{c=n.dataContext.getJSONRecord("MCharge/GetCharge",h.toString());f.setValue("PriceEntered",t.getValueOfDecimal(c))}catch(l){return this.setCalloutActive(!1),this.log.log(r.severe,null,l),l.message}return s=null,this.Tax(i,u,f,e,o)};i.prototype.Tax=function(i,r,u,f,e){var p=f.getColumnName(),o,s,h,c,l,a,y,v;return e==null||e.toString()==""?"":(o=0,o=p.equals("C_Charge_ID")?t.getValueOfInt(e):i.getContextAsInt(r,"C_Charge_ID"),this.log.fine("C_Charge_ID="+o),o==0)?this.Amt(i,r,u,f,e):(s=i.getContextAsInt(r,"C_BPartner_Location_ID"),s==0)?this.Amt(i,r,u,f,e):(this.log.fine("BP_Location="+s),h=t.getValueOfDate(i.getContext("DateInvoiced")),this.log.fine("Bill Date="+h),c=h,this.log.fine("Ship Date="+c),l=i.getContextAsInt(r,"AD_Org_ID"),this.log.fine("Org="+l),a=i.getContextAsInt("#M_Warehouse_ID"),this.log.fine("Warehouse="+a),y=o.toString().concat(",",h.toString(),c.toString(),",",l.toString(),",",a.toString(),",",s.toString(),",",s.toString(),",",i.getWindowContext(r,"IsSOTrx",!0).equals("Y")),v=n.dataContext.getJSONRecord("MTax/Get",y),v==0||u.setValue("C_Tax_ID",t.getValueOfInt(v)),this.Amt(i,r,u,f,e))};i.prototype.Amt=function(i,r,u,f,e,o){var s,v,h,y;if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);var a=i.getStdPrecision(),c=t.getValueOfDecimal(u.getValue("QtyEntered")),l=t.getValueOfDecimal(u.getValue("PriceEntered"));if(this.log.fine("QtyEntered="+c+", PriceEntered="+l),c==null&&(c=n.Env.ZERO),l==null&&(l=n.Env.ZERO),s=c*l,t.scale(s)>a&&(s=s.toFixed(a)),v="Y"==i.getContext("IsTaxIncluded"),h=null,f.getColumnName().equals("TaxAmt"))h=u.getValue("TaxAmt");else if(y=u.getValue("C_Tax_ID"),y!=null){var p=t.getValueOfInt(y),w=p.toString().concat(",",s.toString(),",",v.toString(),",",a.toString());h=n.dataContext.getJSONRecord("MTax/CalculateTax",w);u.setValue("TaxAmt",h);u.getField("SurchargeAmt")!=null&&u.setValue("SurchargeAmt",0)}return v?(u.setValue("LineTotalAmt",s),u.setValue("LineNetAmt",t.getValueOfDecimal(s)*t.getValueOfDecimal(h))):(u.setValue("LineNetAmt",s),u.setValue("LineTotalAmt",t.getValueOfDecimal(s)+t.getValueOfDecimal(h))),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutInvoiceBatch=i}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutMasterForecast")}var r=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Currency=function(i,u,f,e,o,s){if(this.isCalloutActive()||o==null||o.toString()==""||t.getValueOfInt(o)==0)return f.getValue("M_PriceList_ID")==null&&f.setValue("C_Currency_ID",t.getValueOfInt(i.getContext("$C_Currency_ID"))),"";try{this.setCalloutActive(!0);var h=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",t.getValueOfString(f.getValue("M_PriceList_ID")));h.C_Currency_ID!=null&&f.setValue("C_Currency_ID",h.C_Currency_ID)}catch(c){return this.log.log(r.SEVERE,sql,c),c.message}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};i.prototype.Product=function(i,u,f,e,o,s){var c;if(this.isCalloutActive()||o==null||o.toString()==""||t.getValueOfInt(o)==0)return f.getValue("M_Product_ID")==null&&(f.setValue("Price",0),f.setValue("PlannedRevenue",0),f.setValue("ForcastQty",0),f.setValue("TotalQty",0)),"";try{if(this.setCalloutActive(!0),i.getContextAsInt(u,"M_PriceList_ID")>0){var a=n.dataContext.getJSONRecord("MCurrency/GetCurrency",t.getValueOfString(i.getContextAsInt(u,"C_Currency_ID"))),v=t.getValueOfString(f.getValue("M_Product_ID")).concat(",",t.getValueOfString(f.getValue("M_AttributeSetInstance_ID")),",",t.getValueOfString(i.getContextAsInt(u,"M_PriceList_ID")),",",t.getValueOfString(f.getValue("C_UOM_ID"))),h=n.dataContext.getJSONRecord("MProductPricing/GetProductdata",v);h!=null&&(f.setValue("Price",h.PriceStd),f.setValue("PlannedRevenue",(h.PriceStd*t.getValueOfDecimal(f.getValue("TotalQty"))).toFixed(t.getValueOfInt(a.StdPrecision))),t.getValueOfInt(f.getValue("C_UOM_ID"))==0&&f.setValue("C_UOM_ID",h.C_UOM_ID),f.findColumn("IsBOM")>0&&f.setValue("IsBOM",h.IsBOM));c=n.dataContext.getJSONRecord("MTeamForcast/GetBOMdetails",t.getValueOfString(f.getValue("M_Product_ID")));c!=null&&(f.setValue("BOMUse",c.BOMUse),f.setValue("VAMFG_M_Routing_ID",c.VAMFG_M_Routing_ID),f.setValue("M_BOM_ID",c.M_BOM_ID))}}catch(l){return this.log.log(r.SEVERE,sql,l),l.message}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};i.prototype.CalculatePrice=function(i,u,f,e,o,s){var h,c,l;if(this.isCalloutActive()||o==null||o.toString()==""||t.getValueOfInt(o)<=0)return"";try{this.setCalloutActive(!0);h=n.dataContext.getJSONRecord("MCurrency/GetCurrency",t.getValueOfString(i.getContextAsInt(u,"C_Currency_ID")));c=t.getValueOfDecimal(f.getValue("ForcastQty"))+t.getValueOfDecimal(f.getValue("SalesOrderQty"))+t.getValueOfDecimal(f.getValue("OppQty"));f.setValue("TotalQty",c);l=t.getValueOfDecimal(f.getValue("Price"))*t.getValueOfDecimal(f.getValue("TotalQty"));f.setValue("PlannedRevenue",l.toFixed(t.getValueOfInt(h.StdPrecision)))}catch(a){return this.log.log(r.SEVERE,sql,a),a.message}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};n.Model.CalloutMasterForecast=i}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutMovement")}function r(){n.CalloutEngine.call(this,"VIS.CalloutInventoryMove")}function u(){n.CalloutEngine.call(this,"VIS.CalloutshipLine")}function f(){n.CalloutEngine.call(this,"VIS.CalloutMoveConfirmLine")}var e=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Product=function(i,r,u,f,o,s){var h,c,l,v,y,a;if(o==null||o.toString()=="")return u.setValue("MovementQty",1),u.setValue("QtyEntered",1),"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);try{if(h=o,h==null||h==0)return"";u.setValue("M_AttributeSetInstance_ID",null);c=n.dataContext.getJSONRecord("MProduct/GetC_UOM_ID",h.toString());u.setValue("C_UOM_ID",c);o!=s&&(u.setValue("MovementQty",1),u.setValue("QtyEntered",1));c=t.getValueOfDecimal(u.getValue("C_UOM_ID"));l=t.getValueOfDecimal(u.getValue("QtyEntered"));h=t.getValueOfInt(u.getValue("M_Product_ID"));v=h.toString().concat(",").concat(c.toString()).concat(",").concat(l.toString());y=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",v);QtyOrdered=y;a=!1;QtyOrdered!=null&&(a=l!=QtyOrdered);QtyOrdered==null&&(a=!1,QtyOrdered=1);a?u.setValue("MovementQty",QtyOrdered):u.setValue("MovementQty",QtyOrdered*l)}catch(p){return this.setCalloutActive(!1),this.log.log(e.severe,sql,p),p.message}return this.setCalloutActive(!1),i=r=u=f=o=s=null,""};n.Model.CalloutMovement=i;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.UOM=function(i,r,u,f,e,o){var c,s,v,a,l,h;if(e==0||e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";this.setCalloutActive(!0);try{if(c=t.getValueOfDecimal(u.getValue("M_Product_ID")),c==0)return QtyEntered=1,QtyOrdered=QtyEntered,u.setValue("QtyOrdered",QtyOrdered),u.setValue("QtyEntered",QtyEntered),this.setCalloutActive(!1),i=r=u=f=e=o=null,"";f.getColumnName()=="C_UOM_ID"?(s=t.getValueOfInt(e),QtyEntered=t.getValueOfDecimal(u.getValue("QtyEntered")),c=t.getValueOfInt(u.getValue("M_Product_ID")),paramStr=c.toString().concat(",").concat(s.toString()).concat(",").concat(QtyEntered.toString()),l=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),QtyOrdered=l,h=!1,QtyOrdered!=null&&(h=QtyEntered!=QtyOrdered),QtyOrdered==null&&(h=!1,QtyOrdered=1),h?u.setValue("MovementQty",QtyOrdered):u.setValue("MovementQty",QtyOrdered*QtyEntered)):f.getColumnName()=="QtyEntered"&&(s=i.getContextAsInt(r,"C_UOM_ID"),QtyEntered=t.getValueOfDecimal(e),paramStr=s.toString().concat(","),v=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),a=QtyEntered.toFixed(t.getValueOfInt(v)),QtyEntered!=a&&(this.log.fine("Corrected QtyEntered Scale UOM="+s+"; QtyEntered="+QtyEntered+"->"+a),QtyEntered=a,u.setValue("QtyEntered",QtyEntered)),paramStr=c.toString().concat(",",s.toString(),",",QtyEntered.toString()),l=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),QtyOrdered=l,QtyOrdered==null&&(QtyOrdered=QtyEntered),h=QtyEntered!=QtyOrdered,this.log.fine("UOM="+s+", QtyEntered="+QtyEntered+" -> "+h+" QtyOrdered="+QtyOrdered),i.setContext(r,"UOMConversion",h?"Y":"N"),u.setValue("MovementQty",QtyOrdered))}catch(y){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutInventoryMove=r;n.Utility.inheritPrototype(u,n.CalloutEngine);u.prototype.DocType=function(i,r,u,f,e,o){if(e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";this.setCalloutActive(!0);try{var c=e.toString()+","+u.getValue("M_Package_ID").toString()+","+u.getValue("M_InOutLine_ID").toString(),s=n.dataContext.getJSONRecord("MInOut/GetProductDetails",c),h=0;s!=null&&Object.keys(s).length>0&&(h=t.getValueOfDecimal(s.Movementqty),u.setValue("M_Product_ID",t.getValueOfInt(s.M_Product_ID)),u.setValue("Qty",h-t.getValueOfInt(s.totalConfirmedAndScrapped)),u.setValue("M_AttributeSetInstance_ID",t.getValueOfInt(s.M_AttributeSetInstance_ID)),u.setValue("DTD001_IsConfirm",!0))}catch(l){this.setCalloutActive(!1);this.log.severe(l.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutshipLine=u;n.Utility.inheritPrototype(f,n.CalloutEngine);f.prototype.SetQty=function(n,i,r,u,f){if(this.isCalloutActive()||f==null||f.toString()=="")return"";if(this.setCalloutActive(!0),t.getValueOfDecimal(r.getValue("TargetQty"))<t.getValueOfDecimal(r.getValue("ConfirmedQty")))return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";if(u.getColumnName()=="ConfirmedQty"){if(t.getValueOfDecimal(r.getValue("ConfirmedQty"))<0)return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";r.setValue("ScrappedQty",0);r.setValue("DifferenceQty",t.getValueOfDecimal(r.getValue("TargetQty"))-(t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty"))))}else if(u.getColumnName()=="DifferenceQty"){if(t.getValueOfDecimal(r.getValue("TargetQty"))<t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("DifferenceQty")))return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";r.setValue("ScrappedQty",t.getValueOfDecimal(r.getValue("TargetQty"))-(t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("DifferenceQty"))))}else if(u.getColumnName()=="ScrappedQty"){if(t.getValueOfDecimal(r.getValue("ScrappedQty"))<0||t.getValueOfDecimal(r.getValue("TargetQty"))<t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty")))return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";r.setValue("DifferenceQty",t.getValueOfDecimal(r.getValue("TargetQty"))-(t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty"))))}return this.setCalloutActive(!1),""};n.Model.CalloutMoveConfirmLine=f}(VIS,jQuery),function(n){function u(){n.CalloutEngine.call(this,"VIS.CalloutObjectData")}function i(){n.CalloutEngine.call(this,"VIS.CalloutOffer")}function r(){n.CalloutEngine.call(this,"VIS.copyname")}var f=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(u,n.CalloutEngine);u.prototype.Objectchk=function(i,r,u,f,o,s){var y,a,v,c,w,h,p,l;if(o==null||o.toString()==""||o==null||(y=t.getValueOfInt(u.getValue("FO_OBJECT_DATA_ID")),c=t.getValueOfDateTime(u.getValue("TODAYDATE")),y==null))return"";w="select FO_RES_ACCOMODATION_ID,DATE_FROM,TILL_DATE from FO_RES_ACCOMODATION where FO_OBJECT_DATA_ID=@FO_OBJ_DATA_ID";h=null;try{for(p=[],p[0]=new n.DB.SqlParam("@FO_OBJ_DATA_ID",y),h=n.DB.executeReader(w,p,null);h.read();){if((a=t.getValueOfDateTime(h[1]),v=t.getValueOfDateTime(h[2]),l=a,c.compareTo(v)>0)||c.compareTo(a)<0)return u.setValue("RES_STATUS",!1),"";if(c.compareTo(a)>0&&c.compareTo(v)<0)while(!(l.compareTo(v)==0))c.compareTo(l)==0&&u.setValue("RES_STATUS",!0),l=l.AddDays(1)}h.close()}catch(b){this.setCalloutActive(!1);h!=null&&h.close();this.log.severe(e.toString())}finally{h!=null&&h.close()}return i=r=u=f=o=s=null,""};n.Model.CalloutObjectData=u;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Datechk=function(i,r,u,f,e,o){var c,v,y,p,h,w;if(e==null||e.toString()==""||(c=t.getValueOfDateTime(e),c==null||c==0))return"";var b=u.getValue("AD_ORG_ID"),l=0,k="select  DAYSPAYABLE2 from FO_SETTINGS where AD_ORG_ID="+b,s=null;try{for(s=n.DB.executeReader(k,null,null);s.read();)l=t.getValueOfInt(s[0].toString());s.close()}catch(a){this.setCalloutActive(!1);s!=null&&s.close();this.log.severe(a.toString())}v=t.getValueOfDateTime(u.getValue("DATE1"));y=v.AddDays(l);u.setValue("DATE2",y);h=100;w="select max(OFFERNO)from FO_OFFER";try{for(s=n.DB.executeReader(w,null,null);s.read();)h=t.getValueOfInt(s[0].toString());s.close()}catch(a){this.setCalloutActive(!1);s!=null&&s.close();this.log.severe(a.toString())}finally{s!=null&&s.close()}return p=h==null|h==0?100:h+1,u.setValue("OFFERNO",p),i=r=u=f=e=o=null,""};i.prototype.guestpricelist=function(i,r,u,f,e,o){var h;if(e==null||(h=t.getValueOfInt(e),h==null||h==0))return"";var l="select FO_PRICE_LIST_ID from FO_ADDRESS_PRICE where FO_ADDRESS_ID="+h,c=0,s=null;try{for(s=n.DB.executeReader(l,null,null);s.read();)c=t.getValueOfInt(s[0]);s.close()}catch(a){this.setCalloutActive(!1);s!=null&&s.close();this.log.severe(a.toString())}finally{s!=null&&s.close()}return u.setValue("FO_PRICE_LIST_ID",c),i=r=u=f=e=o=null,""};n.Model.CalloutOffer=i;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.product=function(n,t,i,r,u,f){return i.setValue("Help",i.getValue("Name")),n=t=i=r=u=f=null,""};r.prototype.product2=function(n,t,i,r,u,f){return i.setValue("Description",i.getValue("Help")),n=t=i=r=u=f=null,""};n.Model.copyname=r}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutOfferSerIncluded")}var r=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.CalculatePrice=function(n,t,i){return Decimal.Subtract(Decimal.Multiply(n,t),i)};i.prototype.CalculateRebate=function(n,t,i){return Decimal.Multiply(Decimal.Multiply(n,t),Decimal.Multiply(new Decimal(.01),i))};i.prototype.OfferServices=function(i,r,u,f,e,o){var it,ht,kt,st;if(e==null||e.toString()==""||(it=24,ht=t.getValueOfInt(e),ht==null||ht==0))return"";var ct=0,lt=new Decimal(0),at=new Decimal(0),vt=new Decimal(0),s,l,a,v,h,k,d,pt,wt,ut=null;try{for(st=[],st[0]=new n.DB.SqlParam("@FO_SERVICE_ID",ht),ut=n.DB.executeReader("select uom.FO_HOTEL_UOM_ID,s.DESCRIPTION from FO_HOTEL_UOM uom inner join FO_SERVICE s ON(uom.FO_HOTEL_UOM_ID= s.FO_HOTEL_UOM_ID) where s.FO_SERVICE_ID=@FO_SERVICE_ID ",st,null);ut.read();)ct=t.getValueOfInt(ut[0]),u.setValue("AUOM_ID",ct),u.setValue("CG1UOM_ID",ct),u.setValue("CG2UOM_ID",ct),u.setValue("DESCRIPTION",t.getValueOfString(ut[1]));ut.close()}catch(bt){this.setCalloutActive(!1);ut!=null&&ut.close();this.log.severe(bt.toString())}kt="select PRICE,CHILDGROUP1,CHILDGROUP2,UOM1,UOM2 from FO_SERVICE_PRICE_PRICELINE where CREATED=(select max(CREATED) from FO_SERVICE_PRICE_PRICELINE where FO_SERVICE_ID=@FO_SERVICE_ID)";try{for(st=[],st[0]=new n.DB.SqlParam("@FO_SERVICE_ID",ht),ut=n.DB.executeReader(kt,st,null);ut.read();)lt=t.getValueOfDecimal(ut[0]),at=t.getValueOfDecimal(ut[1]),vt=t.getValueOfDecimal(ut[2]),pt=ut[3].toString(),wt=ut[4].toString(),pt.equals("Y")&&(at=Decimal.Multiply(Decimal.Multiply(lt,at),new Decimal(.01))),wt.equals("Y")&&(vt=Decimal.Multiply(Decimal.Multiply(lt,vt),new Decimal(.01))),u.setValue("APRICE",lt),u.setValue("CG1PRICE",at),u.setValue("CG2PRICE",vt);ut.close()}catch(bt){this.setCalloutActive(!1);this.log.severe(bt.toString())}var dt=u.getValue("AUOM_ID").toString(),g=t.getValueOfInt(u.getValue("ANUM")),p=t.getValueOfDecimal(u.getValue("AP0RICE")),b=t.getValueOfDecimal(u.getValue("AREBATE")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1P0RICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),gt=t.getValueOfDateTime(u.getValue("ADATETO")),ni=t.getValueOfDateTime(u.getValue("ADATEFROM")),c=Utility.timeUtil.getDaysBetween(ni,gt),yt=ni.Subtract(gt),ft,rt,ti=c/30,ri=c%30,ii=c/7,ui=c%7;ft=ri==0?ti:ti+1;rt=ui==0?ii:ii+1;var fi=yt.TotalMilliseconds,et=yt.TotalSeconds,ot=yt.TotalMinutes;if(t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(dt)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(rt),p,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(it*c),p,h);l=CalculatePrice(new Decimal(it*c),y,h);a=CalculatePrice(new Decimal(it*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(ot),p,h);l=CalculatePrice(new Decimal(ot),y,h);a=CalculatePrice(new Decimal(ot),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(et),p,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}}else switch(int.Parse(dt)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(rt),p,b);s=CalculatePrice(new Decimal(rt),p,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),w,b);a=CalculatePrice(new Decimal(rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(it*c),p,b);s=CalculatePrice(new Decimal(it*c),p,h);k=CalculateRebate(new Decimal(it*c),y,b);l=CalculatePrice(new Decimal(it*c),y,k);d=CalculateRebate(new Decimal(it*c),w,b);a=CalculatePrice(new Decimal(it*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(ot),p,b);s=CalculatePrice(new Decimal(ot),p,h);k=CalculateRebate(new Decimal(ot),y,b);l=CalculatePrice(new Decimal(ot),y,k);d=CalculateRebate(new Decimal(ot),w,b);a=CalculatePrice(new Decimal(ot),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(et),p,b);s=CalculatePrice(new Decimal(et),p,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),w,b);a=CalculatePrice(new Decimal(et),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};i.prototype.tochkdate=function(i,r,u,f,e,o){var it,s,l,a,h,k,d,v,ct,vt,yt,at,st;if(e==null||e.toString()==""||(it=24,ct=t.getValueOfDateTime(e),ct==null||ct.equals(0)))return"";var ot=t.getValueOfDateTime(e),ht=t.getValueOfDateTime(u.getValue("ADATEFROM")),g=t.getValueOfInt(u.getValue("CG1NUM")),nt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),p=t.getValueOfDecimal(u.getValue("CG2PRICE"));try{if(ot=t.getValueOfDateTime(u.getValue("ADATETO")),vt=Utility.timeUtil.getDaysBetween(ht,ot),vt<=0)yt=Utility.TimeUtil.AddDays(ht,1),u.setValue("ADATETO",yt);else if(ot.compareTo(ht)>0){var lt=ot.Subtract(ht),c=Utility.timeUtil.getDaysBetween(ht,ot),gt=lt.TotalMilliseconds,ft=lt.TotalMinutes,et=lt.TotalMinutes,ut,rt,pt=c/30,bt=c%30,wt=c/7,kt=c%7;ut=bt==0?pt:pt+1;rt=kt==0?wt:wt+1;at=t.getValueOfDateTime(u.getValue("ADATEFROM"));u.setValue("CG1DATETO",ot);u.setValue("CG2DATETO",ot);u.setValue("CG1DATEFROM",at);u.setValue("CG2DATEFROM",at);st=u.getValue("AUOM_ID").toString();(st==""||st.toString().trim().length==0)&&(st="0");var w=t.getValueOfDecimal(u.getValue("APRICE")),tt=t.getValueOfInt(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE"));if(t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(st)){case 1000003:s=w;l=y;a=p;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),w,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ut),w,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(rt),w,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),w,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(it*c),w,h);l=CalculatePrice(new Decimal(it*c),y,h);a=CalculatePrice(new Decimal(it*c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),w,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),w,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(tt*rt),w,h);l=CalculatePrice(new Decimal(g*rt),y,h);a=CalculatePrice(new Decimal(nt*rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(tt*rt),w,h);l=CalculatePrice(new Decimal(g*rt),y,h);a=CalculatePrice(new Decimal(nt*rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(tt*(c+1)),w,h);l=CalculatePrice(new Decimal(g*(c+1)),y,h);a=CalculatePrice(new Decimal(nt*(c+1)),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*tt),w,h);l=CalculatePrice(new Decimal((c+1)*g),y,h);a=CalculatePrice(new Decimal((c+1)*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(it*c*tt),w,h);l=CalculatePrice(new Decimal(it*c*g),y,h);a=CalculatePrice(new Decimal(it*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(it*c*tt),w,h);l=CalculatePrice(new Decimal(it*c*g),y,h);a=CalculatePrice(new Decimal(it*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}}else switch(int.Parse(st)){case 1000003:s=w;l=y;a=p;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),w,b);s=CalculatePrice(new Decimal(c),w,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),p,b);a=CalculatePrice(new Decimal(c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ut),w,b);s=CalculatePrice(new Decimal(ut),w,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),p,b);a=CalculatePrice(new Decimal(ut),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(rt),w,b);s=CalculatePrice(new Decimal(rt),w,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),p,b);a=CalculatePrice(new Decimal(rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),w,b);s=CalculatePrice(new Decimal(c+1),w,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),p,b);a=CalculatePrice(new Decimal(c+1),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(it*c),w,b);s=CalculatePrice(new Decimal(it*c),w,h);k=CalculateRebate(new Decimal(it*c),y,b);l=CalculatePrice(new Decimal(it*c),y,k);d=CalculateRebate(new Decimal(it*c),p,b);a=CalculatePrice(new Decimal(it*c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),w,b);s=CalculatePrice(new Decimal(et),w,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),p,b);a=CalculatePrice(new Decimal(et),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),w,b);s=CalculatePrice(new Decimal(ft),w,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),p,b);a=CalculatePrice(new Decimal(ft),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(tt*rt),w,b);s=CalculatePrice(new Decimal(tt*rt),w,h);k=CalculateRebate(new Decimal(g*rt),y,b);l=CalculatePrice(new Decimal(g*rt),y,k);d=CalculateRebate(new Decimal(nt*rt),p,b);a=CalculatePrice(new Decimal(nt*rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(tt*rt),w,b);s=CalculatePrice(new Decimal(tt*rt),w,h);k=CalculateRebate(new Decimal(g*rt),y,b);l=CalculatePrice(new Decimal(g*rt),y,k);d=CalculateRebate(new Decimal(nt*rt),p,b);a=CalculatePrice(new Decimal(nt*rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal(tt*(c+1)),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal((c+1)*tt),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(it*c*tt),w,b);s=CalculatePrice(new Decimal(it*c*tt),w,h);k=CalculateRebate(new Decimal(it*c*g),y,b);l=CalculatePrice(new Decimal(it*c*g),y,k);d=CalculateRebate(new Decimal(it*c*nt),p,b);a=CalculatePrice(new Decimal(it*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(it*c*tt),w,b);s=CalculatePrice(new Decimal(it*c*tt),w,h);k=CalculateRebate(new Decimal(it*c*g),y,b);l=CalculatePrice(new Decimal(it*c*g),y,k);d=CalculateRebate(new Decimal(it*c*nt),p,b);a=CalculatePrice(new Decimal(it*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}tt==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0));g==0&&u.setValue("CG1TOTAL_AMOUNT",0);nt==0&&u.setValue("CG2TOTAL_AMOUNT",0)}}catch(dt){this.setCalloutActive(!1);this.log.severe(dt.toString())}return i=r=u=f=e=o=null,""};i.prototype.fromchkdate=function(i,r,u,f,e,o){var it,s,l,a,h,k,d,v,ct,vt,at,ht;if(e==null||e.toString()==""||(it=24,ct=t.getValueOfDateTime(e),ct==null||ct.equals(0)))return"";var ot=t.getValueOfDateTime(u.getValue("ADATEFROM")),st=t.getValueOfDateTime(u.getValue("ADATETO")),g=t.getValueOfInt(u.getValue("CG1NUM")),nt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),p=t.getValueOfDecimal(u.getValue("CG2PRICE"));try{if(ot=t.getValueOfDateTime(u.getValue("ADATEFROM")),ot.compareTo(st)>0)u.setValue("CG1DATEFROM",ot),u.setValue("CG2DATEFROM",ot),vt=Utility.timeUtil.addDays(ot,1),u.setValue("ADATETO",vt);else if(st.compareTo(ot)>0){var lt=st.Subtract(ot),c=Utility.timeUtil.getDaysBetween(ot,st),dt=lt.TotalMilliseconds,ft=lt.TotalSeconds,et=lt.TotalMinutes,ut,rt,yt=c/30,wt=c%30,pt=c/7,bt=c%7;ut=wt==0?yt:yt+1;rt=bt==0?pt:pt+1;at=t.getValueOfDateTime(u.getValue("ADATEFROM"));u.setValue("CG1DATETO",st);u.setValue("CG2DATETO",st);u.setValue("CG1DATEFROM",at);u.setValue("CG2DATEFROM",at);ht=u.getValue("AUOM_ID").toString();(ht==""||ht.toString().trim().length==0)&&(ht="0");var w=t.getValueOfDecimal(u.getValue("APRICE")),tt=t.getValueOfInt(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE"));if(t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(ht)){case 1000003:s=w;l=y;a=p;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),w,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ut),w,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(rt),w,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),w,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(it*c),w,h);l=CalculatePrice(new Decimal(it*c),y,h);a=CalculatePrice(new Decimal(it*c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),w,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),w,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(tt*rt),w,h);l=CalculatePrice(new Decimal(g*rt),y,h);a=CalculatePrice(new Decimal(nt*rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(tt*rt),w,h);l=CalculatePrice(new Decimal(g*rt),y,h);a=CalculatePrice(new Decimal(nt*rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(tt*(c+1)),w,h);l=CalculatePrice(new Decimal(g*(c+1)),y,h);a=CalculatePrice(new Decimal(nt*(c+1)),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*tt),w,h);l=CalculatePrice(new Decimal((c+1)*g),y,h);a=CalculatePrice(new Decimal((c+1)*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(it*c*tt),w,h);l=CalculatePrice(new Decimal(it*c*g),y,h);a=CalculatePrice(new Decimal(it*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(it*c*tt),w,h);l=CalculatePrice(new Decimal(it*c*g),y,h);a=CalculatePrice(new Decimal(it*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}}else switch(int.Parse(ht)){case 1000003:s=w;l=y;a=p;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),w,b);s=CalculatePrice(new Decimal(c),w,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),p,b);a=CalculatePrice(new Decimal(c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ut),w,b);s=CalculatePrice(new Decimal(ut),w,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),p,b);a=CalculatePrice(new Decimal(ut),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(rt),w,b);s=CalculatePrice(new Decimal(rt),w,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),p,b);a=CalculatePrice(new Decimal(rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),w,b);s=CalculatePrice(new Decimal(c+1),w,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),p,b);a=CalculatePrice(new Decimal(c+1),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(it*c),w,b);s=CalculatePrice(new Decimal(it*c),w,h);k=CalculateRebate(new Decimal(it*c),y,b);l=CalculatePrice(new Decimal(it*c),y,k);d=CalculateRebate(new Decimal(it*c),p,b);a=CalculatePrice(new Decimal(it*c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),w,b);s=CalculatePrice(new Decimal(et),w,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),p,b);a=CalculatePrice(new Decimal(et),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),w,b);s=CalculatePrice(new Decimal(ft),w,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),p,b);a=CalculatePrice(new Decimal(ft),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(tt*rt),w,b);s=CalculatePrice(new Decimal(tt*rt),w,h);k=CalculateRebate(new Decimal(g*rt),y,b);l=CalculatePrice(new Decimal(g*rt),y,k);d=CalculateRebate(new Decimal(nt*rt),p,b);a=CalculatePrice(new Decimal(nt*rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(tt*rt),w,b);s=CalculatePrice(new Decimal(tt*rt),w,h);k=CalculateRebate(new Decimal(g*rt),y,b);l=CalculatePrice(new Decimal(g*rt),y,k);d=CalculateRebate(new Decimal(nt*rt),p,b);a=CalculatePrice(new Decimal(nt*rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal(tt*(c+1)),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal((c+1)*tt),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(it*c*tt),w,b);s=CalculatePrice(new Decimal(it*c*tt),w,h);k=CalculateRebate(new Decimal(it*c*g),y,b);l=CalculatePrice(new Decimal(it*c*g),y,k);d=CalculateRebate(new Decimal(it*c*nt),p,b);a=CalculatePrice(new Decimal(it*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(it*c*tt),w,b);s=CalculatePrice(new Decimal(it*c*tt),w,h);k=CalculateRebate(new Decimal(it*c*g),y,b);l=CalculatePrice(new Decimal(it*c*g),y,k);d=CalculateRebate(new Decimal(it*c*nt),p,b);a=CalculatePrice(new Decimal(it*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}tt==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0));g==0&&u.setValue("CG1TOTAL_AMOUNT",0);nt==0&&u.setValue("CG2TOTAL_AMOUNT",0)}}catch(kt){this.setCalloutActive(!1);this.log.severe(kt.toString())}return i=r=u=f=e=o=null,""};i.prototype.UOMSelected=function(i,r,u,f,e,o){var it,s,l,a,h,k,d,v,ot;if(e==null||e.toString()==""||(it=24,ot=t.getValueOfInt(e),ot=t.getValueOfInt(u.getValue("AUOM_ID")),ot==null))return"";u.setValue("CG1UOM_ID",ot);u.setValue("CG2UOM_ID",ot);var ht=u.getValue("AUOM_ID").toString(),p=t.getValueOfDecimal(u.getValue("APRICE")),g=t.getValueOfInt(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),ct=t.getValueOfDateTime(u.getValue("ADATETO")),lt=t.getValueOfDateTime(u.getValue("ADATEFROM")),st=ct.Subtract(lt),c=Utility.timeUtil.getDaysBetween(lt,ct),wt=st.TotalMilliseconds,ft=st.TotalSeconds,et=st.TotalMinutes,ut,rt,at=c/30,yt=c%30,vt=c/7,pt=c%7;if(ut=yt==0?at:at+1,rt=pt==0?vt:vt+1,t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(ht)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ut),p,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(rt),p,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(it*c),p,h);l=CalculatePrice(new Decimal(it*c),y,h);a=CalculatePrice(new Decimal(it*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),p,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}}else switch(int.Parse(ht)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ut),p,b);s=CalculatePrice(new Decimal(ut),p,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),w,b);a=CalculatePrice(new Decimal(ut),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(rt),p,b);s=CalculatePrice(new Decimal(rt),p,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),w,b);a=CalculatePrice(new Decimal(rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(it*c),p,b);s=CalculatePrice(new Decimal(it*c),p,h);k=CalculateRebate(new Decimal(it*c),y,b);l=CalculatePrice(new Decimal(it*c),y,k);d=CalculateRebate(new Decimal(it*c),w,b);a=CalculatePrice(new Decimal(it*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),p,b);s=CalculatePrice(new Decimal(et),p,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),w,b);a=CalculatePrice(new Decimal(et),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};i.prototype.AVALSelected=function(i,r,u,f,e,o){var it,s,l,a,h,k,d,v,ot;if(e==null||e.toString()=="")return"";it=24;ot=null;try{ot=u.getValue("AUOM_ID").toString()}catch(pt){return this.setCalloutActive(!1),""}var p=t.getValueOfDecimal(u.getValue("APRICE")),b=t.getValueOfDecimal(u.getValue("AREBATE")),g=t.getValueOfInt(u.getValue("ANUM")),ht=t.getValueOfDateTime(u.getValue("ADATETO")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),ct=t.getValueOfDateTime(u.getValue("ADATEFROM")),st=ht.Subtract(ct),c=Utility.timeUtil.getDaysBetween(ct,ht),wt=st.TotalMilliseconds,ft=st.TotalSeconds,et=st.TotalMinutes,ut,rt,lt=c/30,vt=c%30,at=c/7,yt=c%7;if(ut=vt==0?lt:lt+1,rt=yt==0?at:at+1,t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(ot)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ut),p,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(rt),p,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(it*c),p,h);l=CalculatePrice(new Decimal(it*c),y,h);a=CalculatePrice(new Decimal(it*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),p,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}}else switch(int.Parse(ot)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ut),p,b);s=CalculatePrice(new Decimal(ut),p,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),w,b);a=CalculatePrice(new Decimal(ut),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(rt),p,b);s=CalculatePrice(new Decimal(rt),p,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),w,b);a=CalculatePrice(new Decimal(rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(it*c),p,b);s=CalculatePrice(new Decimal(it*c),p,h);k=CalculateRebate(new Decimal(it*c),y,b);l=CalculatePrice(new Decimal(it*c),y,k);d=CalculateRebate(new Decimal(it*c),w,b);a=CalculatePrice(new Decimal(it*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),p,b);s=CalculatePrice(new Decimal(et),p,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),w,b);a=CalculatePrice(new Decimal(et),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};n.Model.CalloutOfferSerIncluded=i}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutOfferServices")}var r=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.CalculatePrice=function(n,t,i){return Decimal.Subtract(Decimal.Multiply(n,t),i)};i.prototype.CalculateRebate=function(n,t,i){return Decimal.Multiply(Decimal.Multiply(n,t),Decimal.Multiply(new Decimal(.01),i))};i.prototype.OfferServices=function(i,r,u,f,e,o){var st,wt,ot,ft,et;if(e==null||e.toString()==""||(st=t.getValueOfInt(e),st==null||st==0))return"";var ht=0,ct=new Decimal(0),lt=new Decimal(0),at=new Decimal(0),s,l,a,v,h,k,d,vt,yt,rt=null;try{for(ot=[],ot[0]=new n.DB.SqlParam("@FO_SERVICE_ID",st),rt=n.DB.executeReader("select uom.FO_HOTEL_UOM_ID,s.DESCRIPTION from FO_HOTEL_UOM uom inner join FO_SERVICE s ON(uom.FO_HOTEL_UOM_ID= s.FO_HOTEL_UOM_ID) where s.FO_SERVICE_ID=@FO_SERVICE_ID ",ot,null);rt.read();)ht=t.getValueOfInt(rt[0]),u.setValue("AUOM_ID",ht),u.setValue("CG1UOM_ID",ht),u.setValue("CG2UOM_ID",ht),u.setValue("DESCRIPTION",t.getValueOfString(rt[1]));rt.close()}catch(pt){this.setCalloutActive(!1);rt!=null&&rt.close();this.log.severe(pt.toString())}finally{rt!=null&&rt.close()}wt="select PRICE,CHILDGROUP1,CHILDGROUP2,UOM1,UOM2 from FO_SERVICE_PRICE_PRICELINE where CREATED=(select max(CREATED) from FO_SERVICE_PRICE_PRICELINE where FO_SERVICE_ID=@FO_SERVICE_ID)";try{for(ot=[],ot[0]=new SqlParameter("@FO_SERVICE_ID",st),rt=n.DB.executeReader(wt,ot,null);rt.read();)ct=t.getValueOfDecimal(rt[0]),lt=t.getValueOfDecimal(rt[1]),at=t.getValueOfDecimal(rt[2]),vt=rt[3].toString(),yt=rt[4].toString(),vt=="Y"&&(lt=Decimal.Multiply(Decimal.Multiply(ct,lt),new Decimal(.01))),yt=="Y"&&(at=Decimal.Multiply(Decimal.Multiply(ct,at),new Decimal(.01))),u.setValue("APRICE",ct),u.setValue("CG1PRICE",lt),u.setValue("CG2PRICE",at)}catch(pt){this.setCalloutActive(!1);this.log.severe(pt.toString())}finally{rt!=null&&rt.close()}var bt=u.getValue("AUOM_ID").toString(),g=t.getValueOfInt(u.getValue("ANUM")),p=t.getValueOfDecimal(u.getValue("APRICE")),b=t.getValueOfDecimal(u.getValue("AREBATE")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),kt=t.getValueOfDateTime(u.getValue("ADATETO")),dt=t.getValueOfDateTime(u.getValue("ADATEFROM")),c=Utility.timeUtil.getDaysBetween(dt,kt),gt=dt.Subtract(kt),ut,it,ni=c/30,ii=c%30,ti=c/7,ri=c%7;if(ut=ii==0?ni:ni+1,it=ri==0?ti:ti+1,ft=gt.Seconds,et=gt.Minutes,t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(bt)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ut),p,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(it),p,h);l=CalculatePrice(new Decimal(it),y,h);a=CalculatePrice(new Decimal(it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(24*c),p,h);l=CalculatePrice(new Decimal(24*c),y,h);a=CalculatePrice(new Decimal(24*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),p,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}}else switch(int.Parse(bt)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ut),p,b);s=CalculatePrice(new Decimal(ut),p,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),w,b);a=CalculatePrice(new Decimal(ut),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(it),p,b);s=CalculatePrice(new Decimal(it),p,h);k=CalculateRebate(new Decimal(it),y,b);l=CalculatePrice(new Decimal(it),y,k);d=CalculateRebate(new Decimal(it),w,b);a=CalculatePrice(new Decimal(it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(24*c),p,b);s=CalculatePrice(new Decimal(24*c),p,h);k=CalculateRebate(new Decimal(24*c),y,b);l=CalculatePrice(new Decimal(24*c),y,k);d=CalculateRebate(new Decimal(24*c),w,b);a=CalculatePrice(new Decimal(24*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),p,b);s=CalculatePrice(new Decimal(et),p,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),w,b);a=CalculatePrice(new Decimal(et),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};i.prototype.tochkdate=function(i,r,u,f,e,o){var s,l,a,h,k,d,v,ht,ut,at,vt,lt,ot;if(e==null||e.toString()==""||(ht=t.getValueOfDateTime(e),ht==null||ht.equals(0)))return"";ut=t.getValueOfDateTime(e);ut=t.getValueOfDateTime(u.getValue("ADATETO"));var st=t.getValueOfDateTime(u.getValue("ADATEFROM")),g=t.getValueOfInt(u.getValue("CG1NUM")),nt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),p=t.getValueOfDecimal(u.getValue("CG2PRICE"));try{if(ut=t.getValueOfDateTime(u.getValue("ADATETO")),at=Utility.TimeUtil.getDaysBetween(st,ut),at<=0)vt=Utility.TimeUtil.AddDays(st,1),u.setValue("ADATETO",vt);else if(ut.compareTo(st)>0){var ct=ut.Subtract(st),c=Utility.TimeUtil.getDaysBetween(st,ut),dt=ct.Milliseconds,ft=ct.Seconds,et=ct.Minutes,rt,it,yt=c/30,wt=c%30,pt=c/7,bt=c%7;rt=wt==0?yt:yt+1;it=bt==0?pt:pt+1;lt=t.getValueOfDateTime(u.getValue("ADATEFROM"));u.setValue("CG1DATETO",ut);u.setValue("CG2DATETO",ut);u.setValue("CG1DATEFROM",lt);u.setValue("CG2DATEFROM",lt);ot=u.getValue("AUOM_ID").toString();(ot==""||ot.Trim().Length==0)&&(ot="0");var w=t.getValueOfDecimal(u.getValue("APRICE")),tt=System.Convert.ToInt16(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE"));if(t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(ot)){case 1000003:s=w;l=y;a=p;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),w,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(rt),w,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(it),w,h);l=CalculatePrice(new Decimal(it),y,h);a=CalculatePrice(new Decimal(it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),w,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(24*c),w,h);l=CalculatePrice(new Decimal(24*c),y,h);a=CalculatePrice(new Decimal(24*c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),w,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),w,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(tt*it),w,h);l=CalculatePrice(new Decimal(g*it),y,h);a=CalculatePrice(new Decimal(nt*it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(tt*it),w,h);l=CalculatePrice(new Decimal(g*it),y,h);a=CalculatePrice(new Decimal(nt*it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(tt*(c+1)),w,h);l=CalculatePrice(new Decimal(g*(c+1)),y,h);a=CalculatePrice(new Decimal(nt*(c+1)),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*tt),w,h);l=CalculatePrice(new Decimal((c+1)*g),y,h);a=CalculatePrice(new Decimal((c+1)*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(24*c*tt),w,h);l=CalculatePrice(new Decimal(24*c*g),y,h);a=CalculatePrice(new Decimal(24*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(24*c*tt),w,h);l=CalculatePrice(new Decimal(24*c*g),y,h);a=CalculatePrice(new Decimal(24*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}}else switch(int.Parse(ot)){case 1000003:s=w;l=y;a=p;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),w,b);s=CalculatePrice(new Decimal(c),w,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),p,b);a=CalculatePrice(new Decimal(c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(rt),w,b);s=CalculatePrice(new Decimal(rt),w,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),p,b);a=CalculatePrice(new Decimal(rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(it),w,b);s=CalculatePrice(new Decimal(it),w,h);k=CalculateRebate(new Decimal(it),y,b);l=CalculatePrice(new Decimal(it),y,k);d=CalculateRebate(new Decimal(it),p,b);a=CalculatePrice(new Decimal(it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),w,b);s=CalculatePrice(new Decimal(c+1),w,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),p,b);a=CalculatePrice(new Decimal(c+1),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(24*c),w,b);s=CalculatePrice(new Decimal(24*c),w,h);k=CalculateRebate(new Decimal(24*c),y,b);l=CalculatePrice(new Decimal(24*c),y,k);d=CalculateRebate(new Decimal(24*c),p,b);a=CalculatePrice(new Decimal(24*c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),w,b);s=CalculatePrice(new Decimal(et),w,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),p,b);a=CalculatePrice(new Decimal(et),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),w,b);s=CalculatePrice(new Decimal(ft),w,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),p,b);a=CalculatePrice(new Decimal(ft),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(tt*it),w,b);s=CalculatePrice(new Decimal(tt*it),w,h);k=CalculateRebate(new Decimal(g*it),y,b);l=CalculatePrice(new Decimal(g*it),y,k);d=CalculateRebate(new Decimal(nt*it),p,b);a=CalculatePrice(new Decimal(nt*it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(tt*it),w,b);s=CalculatePrice(new Decimal(tt*it),w,h);k=CalculateRebate(new Decimal(g*it),y,b);l=CalculatePrice(new Decimal(g*it),y,k);d=CalculateRebate(new Decimal(nt*it),p,b);a=CalculatePrice(new Decimal(nt*it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal(tt*(c+1)),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal((c+1)*tt),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(24*c*tt),w,b);s=CalculatePrice(new Decimal(24*c*tt),w,h);k=CalculateRebate(new Decimal(24*c*g),y,b);l=CalculatePrice(new Decimal(24*c*g),y,k);d=CalculateRebate(new Decimal(24*c*nt),p,b);a=CalculatePrice(new Decimal(24*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(24*c*tt),w,b);s=CalculatePrice(new Decimal(24*c*tt),w,h);k=CalculateRebate(new Decimal(24*c*g),y,b);l=CalculatePrice(new Decimal(24*c*g),y,k);d=CalculateRebate(new Decimal(24*c*nt),p,b);a=CalculatePrice(new Decimal(24*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}tt==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0));g==0&&u.setValue("CG1TOTAL_AMOUNT",0);nt==0&&u.setValue("CG2TOTAL_AMOUNT",0)}}catch(kt){this.setCalloutActive(!1);this.log.severe(kt.toString())}return i=r=u=f=e=o=null,""};i.prototype.fromchkdate=function(i,r,u,f,e,o){var s,l,a,h,k,d,v,ht,at,lt,st;if(e==null||e.toString()==""||(ht=t.getValueOfDateTime(e),ht==null||ht.equals(0)))return"";var et=t.getValueOfDateTime(u.getValue("ADATEFROM")),ot=t.getValueOfDateTime(u.getValue("ADATETO")),g=t.getValueOfInt(u.getValue("CG1NUM")),nt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),p=t.getValueOfDecimal(u.getValue("CG2PRICE"));try{if(et=t.getValueOfDateTime(u.getValue("ADATEFROM")),et.compareTo(ot)>0)u.setValue("CG1DATEFROM",et),u.setValue("CG2DATEFROM",et),at=et.addDays(1),u.setValue("ADATETO",at);else if(ot.compareTo(et)>0){var ct=et.subtract(ot),c=Utility.TimeUtil.getDaysBetween(et,ot),kt=ct.Milliseconds,ut=ct.Seconds,ft=ct.Minutes,rt,it,vt=c/30,pt=c%30,yt=c/7,wt=c%7;rt=pt==0?vt:vt+1;it=wt==0?yt:yt+1;lt=t.getValueOfDateTime(u.getValue("ADATEFROM"));u.setValue("CG1DATETO",ot);u.setValue("CG2DATETO",ot);u.setValue("CG1DATEFROM",lt);u.setValue("CG2DATEFROM",lt);st=u.getValue("AUOM_ID").toString();(st==""||st.Trim().Length==0)&&(st="0");var w=t.getValueOfDecimal(u.getValue("APRICE")),tt=t.getValueOfInt(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE"));if(t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(st)){case 1000003:s=w;l=y;a=p;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),w,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(rt),w,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(it),w,h);l=CalculatePrice(new Decimal(it),y,h);a=CalculatePrice(new Decimal(it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),w,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(24*c),w,h);l=CalculatePrice(new Decimal(24*c),y,h);a=CalculatePrice(new Decimal(24*c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(ft),w,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ut),w,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(tt*it),w,h);l=CalculatePrice(new Decimal(g*it),y,h);a=CalculatePrice(new Decimal(nt*it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(tt*it),w,h);l=CalculatePrice(new Decimal(g*it),y,h);a=CalculatePrice(new Decimal(nt*it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(tt*(c+1)),w,h);l=CalculatePrice(new Decimal(g*(c+1)),y,h);a=CalculatePrice(new Decimal(nt*(c+1)),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*tt),w,h);l=CalculatePrice(new Decimal((c+1)*g),y,h);a=CalculatePrice(new Decimal((c+1)*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(24*c*tt),w,h);l=CalculatePrice(new Decimal(24*c*g),y,h);a=CalculatePrice(new Decimal(24*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(24*c*tt),w,h);l=CalculatePrice(new Decimal(24*c*g),y,h);a=CalculatePrice(new Decimal(24*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}}else switch(int.Parse(st)){case 1000003:s=w;l=y;a=p;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),w,b);s=CalculatePrice(new Decimal(c),w,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),p,b);a=CalculatePrice(new Decimal(c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(rt),w,b);s=CalculatePrice(new Decimal(rt),w,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),p,b);a=CalculatePrice(new Decimal(rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(it),w,b);s=CalculatePrice(new Decimal(it),w,h);k=CalculateRebate(new Decimal(it),y,b);l=CalculatePrice(new Decimal(it),y,k);d=CalculateRebate(new Decimal(it),p,b);a=CalculatePrice(new Decimal(it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),w,b);s=CalculatePrice(new Decimal(c+1),w,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),p,b);a=CalculatePrice(new Decimal(c+1),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(24*c),w,b);s=CalculatePrice(new Decimal(24*c),w,h);k=CalculateRebate(new Decimal(24*c),y,b);l=CalculatePrice(new Decimal(24*c),y,k);d=CalculateRebate(new Decimal(24*c),p,b);a=CalculatePrice(new Decimal(24*c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(ft),w,b);s=CalculatePrice(new Decimal(ft),w,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),p,b);a=CalculatePrice(new Decimal(ft),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ut),w,b);s=CalculatePrice(new Decimal(ut),w,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),p,b);a=CalculatePrice(new Decimal(ut),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(tt*it),w,b);s=CalculatePrice(new Decimal(tt*it),w,h);k=CalculateRebate(new Decimal(g*it),y,b);l=CalculatePrice(new Decimal(g*it),y,k);d=CalculateRebate(new Decimal(nt*it),p,b);a=CalculatePrice(new Decimal(nt*it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(tt*it),w,b);s=CalculatePrice(new Decimal(tt*it),w,h);k=CalculateRebate(new Decimal(g*it),y,b);l=CalculatePrice(new Decimal(g*it),y,k);d=CalculateRebate(new Decimal(nt*it),p,b);a=CalculatePrice(new Decimal(nt*it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal(tt*(c+1)),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal((c+1)*tt),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(24*c*tt),w,b);s=CalculatePrice(new Decimal(24*c*tt),w,h);k=CalculateRebate(new Decimal(24*c*g),y,b);l=CalculatePrice(new Decimal(24*c*g),y,k);d=CalculateRebate(new Decimal(24*c*nt),p,b);a=CalculatePrice(new Decimal(24*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(24*c*tt),w,b);s=CalculatePrice(new Decimal(24*c*tt),w,h);k=CalculateRebate(new Decimal(24*c*g),y,b);l=CalculatePrice(new Decimal(24*c*g),y,k);d=CalculateRebate(new Decimal(24*c*nt),p,b);a=CalculatePrice(new Decimal(24*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}tt==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0));g==0&&u.setValue("CG1TOTAL_AMOUNT",0);nt==0&&u.setValue("CG2TOTAL_AMOUNT",0)}}catch(bt){this.setCalloutActive(!1);this.log.severe(bt.toString())}return i=r=u=f=e=o=null,""};i.prototype.UOMSelected=function(i,r,u,f,e,o){var s,l,a,h,k,d,v,et;if(e==null||e.toString()==""||(et=t.getValueOfInt(e),et=t.getValueOfInt(u.getValue("AUOM_ID")),et==null))return"";u.setValue("CG1UOM_ID",et);u.setValue("CG2UOM_ID",et);var ct=u.getValue("AUOM_ID").toString(),p=t.getValueOfDecimal(u.getValue("APRICE")),g=t.getValueOfInt(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),ot=t.getValueOfDateTime(u.getValue("ADATETO")),st=t.getValueOfDateTime(u.getValue("ADATEFROM")),ht=st.compareTo(ot)>0?st.Subtract(ot):ot.Subtract(st);var c=Utility.timeUtil.getDaysBetween(st,ot),pt=ht.Milliseconds,ut=ht.Seconds,ft=ht.Minutes,rt,it,lt=c/30,vt=c%30,at=c/7,yt=c%7;if(rt=vt==0?lt:lt+1,it=yt==0?at:at+1,t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(ct)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(rt),p,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(it),p,h);l=CalculatePrice(new Decimal(it),y,h);a=CalculatePrice(new Decimal(it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(24*c),p,h);l=CalculatePrice(new Decimal(24*c),y,h);a=CalculatePrice(new Decimal(24*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ut),p,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}}else switch(int.Parse(ct)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(rt),p,b);s=CalculatePrice(new Decimal(rt),p,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),w,b);a=CalculatePrice(new Decimal(rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(it),p,b);s=CalculatePrice(new Decimal(it),p,h);k=CalculateRebate(new Decimal(it),y,b);l=CalculatePrice(new Decimal(it),y,k);d=CalculateRebate(new Decimal(it),w,b);a=CalculatePrice(new Decimal(it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(24*c),p,b);s=CalculatePrice(new Decimal(24*c),p,h);k=CalculateRebate(new Decimal(24*c),y,b);l=CalculatePrice(new Decimal(24*c),y,k);d=CalculateRebate(new Decimal(24*c),w,b);a=CalculatePrice(new Decimal(24*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ut),p,b);s=CalculatePrice(new Decimal(ut),p,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),w,b);a=CalculatePrice(new Decimal(ut),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};i.prototype.AVALSelected=function(i,r,u,f,e,o){var s,l,a,h,k,d,v,et;if(e==null||e.toString()=="")return"";et=null;try{et=u.getValue("AUOM_ID").toString()}catch(yt){return this.setCalloutActive(!1),""}var p=t.getValueOfDecimal(u.getValue("APRICE")),b=t.getValueOfDecimal(u.getValue("AREBATE")),g=t.getValueOfInt(u.getValue("ANUM")),st=t.getValueOfDateTime(u.getValue("ADATETO")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),ht=t.getValueOfDateTime(u.getValue("ADATEFROM")),ot=ht.Subtract(st),c=Utility.TimeUtil.getDaysBetween(ht,st),pt=ot.Milliseconds,ut=ot.Seconds,ft=ot.Minutes,rt,it,ct=c/30,at=c%30,lt=c/7,vt=c%7;if(rt=at==0?ct:ct+1,it=vt==0?lt:lt+1,t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(et)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(rt),p,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(it),p,h);l=CalculatePrice(new Decimal(it),y,h);a=CalculatePrice(new Decimal(it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(24*c),p,h);l=CalculatePrice(new Decimal(24*c),y,h);a=CalculatePrice(new Decimal(24*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ut),p,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}}else switch(int.Parse(et)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(rt),p,b);s=CalculatePrice(new Decimal(rt),p,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),w,b);a=CalculatePrice(new Decimal(rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(it),p,b);s=CalculatePrice(new Decimal(it),p,h);k=CalculateRebate(new Decimal(it),y,b);l=CalculatePrice(new Decimal(it),y,k);d=CalculateRebate(new Decimal(it),w,b);a=CalculatePrice(new Decimal(it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(24*c),p,b);s=CalculatePrice(new Decimal(24*c),p,h);k=CalculateRebate(new Decimal(24*c),y,b);l=CalculatePrice(new Decimal(24*c),y,k);d=CalculateRebate(new Decimal(24*c),w,b);a=CalculatePrice(new Decimal(24*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ut),p,b);s=CalculatePrice(new Decimal(ut),p,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),w,b);a=CalculatePrice(new Decimal(ut),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};n.Model.CalloutOfferServices=i}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutOrder")}function e(){n.CalloutEngine.call(this,"VIS.CalloutSalesQuotation ")}function o(){n.CalloutEngine.call(this,"VIS.CalloutBlanketOrderRef")}function f(n){var t=new Date(n);return t.setMinutes(-t.getTimezoneOffset()+t.getMinutes()),t.toISOString()}var u=n.Logging.Level,t=n.Utility.Util,r=!1,s=0;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.DocType=function(i,r,f,e,o,s){var k="PR",y="WR",tt="F",w,b,v,d,nt,a,h,ft;if(this.isCalloutActive()||o==null||o.toString()==""||(w=t.getValueOfInt(o),w==null||w==0))return"";this.setCalloutActive(!0);b=t.getValueOfString(f.getValue("DocumentNo"));v=b==null;!v&&b.startsWith("<")&&b.endsWith(">")&&(v=!0);var it=t.getValueOfInt(f.getValue("C_DocType_ID")),c=null,rt=[];try{d=0;v||t.getValueOfInt(it)==0||(c=n.dataContext.getJSONRecord("MDocType/GetDocTypeData",it.toString()),c!=null&&(d=t.getValueOfInt(c.CurrentNextSys)));c=n.dataContext.getJSONRecord("MDocType/GetDocTypeData",w.toString());rt.length=0;rt=null;var l="",p=!0,g=!1,ut="";if(c!=null&&(l=c.DocSubTypeSO,ut=c.Value,l==null&&(l="--"),i.setContext(r,"OrderType",l),i.setContext(r,"DocTypeValue",ut),l=="BO"?(i.setContext(r,"BlanketOrderType",l),f.setValue("BlanketOrderType",l)):t.getValueOfString(c.IsReleaseDocument).equals("Y")?f.setValue("BlanketOrderType","BO"):(i.setContext(r,"BlanketOrderType","OO"),f.setValue("BlanketOrderType","OO"),f.setValue("C_Order_Blanket",null)),!l=="SO"&&f.setValue("IsDropShip","N"),"N"==c.IsSOTrx&&(p=!1),g=c.IsReturnTrx=="Y"?!0:!1,g?l==y?f.setValue("DeliveryRule",tt):f.setValue("DeliveryRule","M"):(l==y?f.setValue("DeliveryRule",tt):l==k?f.setValue("DeliveryRule","R"):f.setValue("DeliveryRule","A"),l==y||l==k||l=="WI"?f.setValue("InvoiceRule","I"):f.setValue("InvoiceRule","D"),l==y?f.setValue("PaymentRule","B"):f.setValue("PaymentRule","P"),i.setContext(r,"HasCharges",t.getValueOfString(c.HasCharges))),c.IsDocNoControlled=="Y"&&(v||d==t.getValueOfInt(c.AD_Sequence_ID)||(v=!0),v&&(n.Ini.getLocalStorage(n.IniConstants.P_VIENNASYS)&&i.getAD_Client_ID()<1e6?f.setValue("DocumentNo","<"+t.getValueOfInt(c.CurrentNextSys)+">"):f.setValue("DocumentNo","<"+t.getValueOfString(c.CurrentNext)+">")))),g)return this.setCalloutActive(!1),"";l==y||l==k||(nt=i.getContextAsInt(r,"C_BPartner_ID"),a=null,nt!=0&&(a=n.dataContext.getJSONRecord("MBPartner/GetBPDocTypeData",nt.toString())),a!=null&&(h=a[p?"PaymentRule":"PaymentRulePO"],h!=null&&h.length!=0&&((p&&h=="B"||h=="S"||h=="U")&&(h="P"),p||h!="B"||(h="P"),f.setValue("PaymentRule",h)),ft=a[p?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"],f.setValue("C_PaymentTerm_ID",ft),h=a.InvoiceRule,h!=null&&h.length!=0&&f.setValue("InvoiceRule",h),h=a.DeliveryRule,h!=null&&h.length!=0&&f.setValue("DeliveryRule",h),h=a.FreightCostRule,h!=null&&h.length!=0&&f.setValue("FreightCostRule",h),h=a.DeliveryViaRule,h!=null&&h.length!=0&&f.setValue("DeliveryViaRule",h)))}catch(et){return this.setCalloutActive(!1),c!=null&&(c.close(),c=null),this.log.log(u.SEVERE,sql,et),et}return this.setCalloutActive(!1),i=r=f=e=o=s=null,""};i.prototype.BlanketOrderLine=function(i,r,u,f,e,o){var s=null,y,nt,rt,p,ut,ft,g;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(y=0,e!=null&&(y=t.getValueOfInt(e.toString())),y==0)return"";if(this.setCalloutActive(!0),nt=y.toString(),s=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",nt),s!=null){var l=t.getValueOfInt(s.M_Product_ID),et=t.getValueOfInt(s.C_Charge_ID),a=t.getValueOfInt(s.Qty),h=t.getValueOfInt(s.QtyOrdered),v=t.getValueOfInt(s.QtyReleased),tt=t.getValueOfDouble(s.PriceList),w=t.getValueOfDouble(s.PriceActual),c=t.getValueOfDouble(s.C_UOM_ID),it=t.getValueOfDouble(s.Discount),b=t.getValueOfDouble(s.PriceEntered),k=t.getValueOfInt(s.M_AttributeSetInstance_ID),d=t.getValueOfDouble(s.C_Tax_ID);QtyEntered=t.getValueOfDecimal(a);paramStr=c.toString().concat(",");rt=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr);p=QtyEntered.toFixed(t.getValueOfInt(rt));QtyEntered!=p&&(this.log.fine("Corrected QtyEntered Scale UOM="+c+"; QtyEntered="+QtyEntered+"->"+p),QtyEntered=p);paramStr=l.toString().concat(",",c.toString(),",",QtyEntered.toString());ut=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr);h=ut;h==null&&(h=QtyEntered);ft=QtyEntered!=h;ft&&(paramStr=l.toString().concat(",",c.toString(),",",v.toString()),g=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",paramStr),g!=null&&(v=g));l!=0&&l!=null?u.setValue("M_Product_ID",l):u.setValue("C_Charge_ID",et);a!=0&&a!=null&&u.setValue("QtyEntered",a);tt!=null&&u.setValue("PriceList",tt);w!=null&&(u.setValue("PriceActual",w),u.setValue("LineNetAmt",w*a));b!=null&&(u.setValue("PriceEntered",b),u.setValue("PriceEntered",b));it!=null&&u.setValue("Discount",it);c!=0&&c!=null&&u.setValue("C_UOM_ID",c);h!=0&&h!=null&&v!=null&&u.setValue("QtyBlanket",h+v-v);k!=0&&k!=null&&u.setValue("M_AttributeSetInstance_ID",k);d!=0&&d!=null&&u.setValue("C_Tax_ID",d)}}catch(ot){return this.setCalloutActive(!1),ot}return this.setCalloutActive(!1),o=null,this.Qty(i,r,u,f,u.getValue("QtyEntered"))};i.prototype.BlanketOrder=function(i,r,u,f,e,o){var s=null,h,rt,it;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(h=0,e!=null&&(h=t.getValueOfInt(e.toString())),h==0)return"";if(this.setCalloutActive(!0),rt=i.isSOTrx(r),it=h.toString(),s=n.dataContext.getJSONRecord("MOrder/GetOrder",it),s!=null){var l=t.getValueOfDouble(s.C_BPartner_ID),a=t.getValueOfDouble(s.M_PriceList_ID),v=t.getValueOfDouble(s.M_Warehouse_ID),y=t.getValueOfDouble(s.C_PaymentTerm_ID),p=t.getValueOfDouble(s.PaymentRule),w=t.getValueOfDouble(s.C_Payment_ID),b=t.getValueOfDouble(s.VA009_PaymentMethod_ID),k=t.getValueOfDouble(s.C_Currency_ID),d=t.getValueOfDouble(s.C_Project_ID),g=t.getValueOfDouble(s.C_Campaign_ID);c;var c=t.getValueOfDouble(s.C_ProjectRef_ID),nt=t.getValueOfDouble(s.SalesRep_ID),tt=t.getValueOfDouble(s.PriorityRule);l!=0&&l!=null&&u.setValue("C_BPartner_ID",l);a!=0&&a!=null&&u.setValue("M_PriceList_ID",a);v!=0&&v!=null&&u.setValue("M_Warehouse_ID",v);y!=0&&y!=null&&u.setValue("C_PaymentTerm_ID",y);p!=0&&p!=null&&u.setValue("PaymentRule",p);w!=0&&w!=null&&u.setValue("C_Payment_ID",w);b!=0&&b!=null&&u.setValue("VA009_PaymentMethod_ID",b);k!=0&&k!=null&&u.setValue("C_Currency_ID",k);d!=0&&d!=null&&u.setValue("C_Project_ID",d);g!=0&&g!=null&&u.setValue("C_Campaign_ID",g);c!=0&&c!=null&&u.setValue("C_ProjectRef_ID",c);nt!=0&&nt!=null&&u.setValue("SalesRep_ID",nt);tt!=0&&tt!=null&&u.setValue("PriorityRule",tt);u.getField("C_IncoTerm_ID")!=null&&u.setValue("C_IncoTerm_ID",t.getValueOfInt(s.C_IncoTerm_ID))}}catch(ut){return this.setCalloutActive(!1),ut}return this.setCalloutActive(!1),o=null,this.BPartner(i,r,u,f,u.getValue("C_BPartner_ID"))};i.prototype.BPartner=function(i,r,u,f,e,o){var c=null,h=null,yt,pt,k,et,ot,st,g,ht,ct,a,d,lt,nt,at,it,wt,tt,rt,ut,s,vt,bt,v,kt;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{var p=0,l="N",ft="N";if((e!=null&&(p=t.getValueOfInt(e.toString())),p==0)||(yt=t.getValueOfBoolean(u.getValue("IsReturnTrx")),yt))return"";this.setCalloutActive(!0);var w=!1,d="VA009_",b=i.isSOTrx(r),h=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix",d);if(h!=null&&(w=h.VA009_),d=w.toString()+","+p,h=n.dataContext.getJSONRecord("MBPartner/GetBPartnerOrderData",d),h!=null){if(pt=t.getValueOfInt(u.getValue("M_PriceList_ID")),v=t.getValueOfDecimal(u.getValue("C_Order_Blanket")),pt>0&&v>0||(k=t.getValueOfInt(b?h.M_PriceList_ID:h.PO_PriceList_ID),k!=0&&u.setValue("M_PriceList_ID",k)),et=t.getValueOfInt(b?h.C_IncoTerm_ID:h.C_IncoTermPO_ID),et>0&&u.setValue("C_IncoTerm_ID",et),u.setValue("Bill_BPartner_ID",p),ot=t.getValueOfInt(h.Bill_Location_ID),ot==0?(st=t.getValueOfInt(h.Bill_BPartner_ID),st>0&&u.setValue("Bill_BPartner_ID",st)):u.setValue("Bill_Location_ID",ot),g=t.getValueOfInt(h.C_BPartner_Location_ID),p.toString()==i.getContext("C_BPartner_ID")&&(ht=i.getContext("C_BPartner_Location_ID"),ht.length>0&&(g=t.getValueOfInt(ht))),g==0?u.setValue("C_BPartner_Location_ID",null):(u.setValue("C_BPartner_Location_ID",g),"Y"==t.getValueOfString(h.IsShipTo)&&u.setValue("Bill_Location_ID",g)),ct=t.getValueOfInt(h.SalesRep_ID),ct>0&&u.setValue("SalesRep_ID",ct),w){var y=t.getValueOfInt(h.VA009_PaymentMethod_ID);v<=0&&(a=n.dataContext.getJSONRecord("MBPartner/GetBPDetails",p),a!=null&&(l=t.getValueOfString(a.IsVendor),ft=t.getValueOfString(a.IsCustomer),b?l=="Y"?(y=0,c=null,ft=="Y"&&(y=t.getValueOfInt(a.VA009_PaymentMethod_ID),c=t.getValueOfString(a.VA009_PAYMENTBASETYPE))):ft=="Y"&&(y=t.getValueOfInt(a.VA009_PaymentMethod_ID),c=t.getValueOfString(a.VA009_PAYMENTBASETYPE)):l=="Y"?(y=t.getValueOfInt(a.VA009_PO_PaymentMethod_ID),c=t.getValueOfString(a.VA009_PAYMENTBASETYPEPO)):(y=0,c=null)));y==0?(v=t.getValueOfInt(u.getValue("C_Order_Blanket")),v>0&&(d=w.toString()+","+v.toString(),h=n.dataContext.getJSONRecord("MOrder/GetPaymentMethod",d),h!=null&&(lt=t.getValueOfInt(h.VA009_PaymentMethod_ID),lt>0&&(u.setValue("VA009_PaymentMethod_ID",lt),c=t.getValueOfString(h.VA009_PaymentBaseType),c!="W"&&c!=null&&(u.setValue("PaymentMethod",c),l=="N"?u.setValue("PaymentRule",c):u.setValue("PaymentRulePO",c)))))):y==0?u.setValue("VA009_PaymentMethod_ID",null):(u.setValue("VA009_PaymentMethod_ID",y),c!="W"&&c!=null?(u.setValue("PaymentMethod",c),l=="N"?u.setValue("PaymentRule",c):u.setValue("PaymentRulePO",c)):(u.setValue("PaymentMethod","T"),l=="N"?u.setValue("PaymentRule","T"):u.setValue("PaymentRulePO","T")))}nt=t.getValueOfInt(h.AD_User_ID);p.toString()==i.getContext("C_BPartner_ID")&&(at=i.getContext("AD_User_ID"),at.length>0&&(nt=t.getValueOfInt(at)));nt==0?u.setValue("AD_User_ID",null):(u.setValue("AD_User_ID",nt),u.setValue("Bill_User_ID",nt));b&&(it=t.getValueOfString(h.CreditStatusSettingOn),it=="CH"?(rt=t.getValueOfDouble(h.SO_CreditLimit),rt!=0&&(ut=t.getValueOfDouble(h.CreditAvailable),ut<=0&&n.ADialog.info("CreditOver"))):(wt=t.getValueOfInt(u.getValue("C_BPartner_Location_ID")),tt=n.dataContext.getJSONRecord("MBPartner/GetLocationData",wt.toString()),tt!=null&&(it=t.getValueOfString(tt.CreditStatusSettingOn),it=="CL"&&(rt=t.getValueOfDouble(tt.SO_CreditLimit),rt!=0&&(ut=t.getValueOfDouble(tt.CreditAvailable),ut<=0&&n.ADialog.info("CreditOver"))))));s=t.getValueOfString(h.POReference);s!=null&&s.length!=0&&u.setValue("POReference",s);s=t.getValueOfString(h.SO_Description);s!=null&&s.trim().length!=0&&u.setValue("Description",s);s=t.getValueOfString(h.IsDiscountPrinted);s!=null&&s.length!=0?u.setValue("IsDiscountPrinted",s):u.setValue("IsDiscountPrinted","N");vt=i.getContext("OrderType");u.setValue("InvoiceRule","D");u.setValue("DeliveryRule","A");w?c!="W"&&c!=null?l=="N"?u.setValue("PaymentRule",c):u.setValue("PaymentRulePO",c):(l=="N"?u.setValue("PaymentRule","T"):u.setValue("PaymentRulePO","T"),u.setValue("PaymentMethod","T")):u.setValue("PaymentRule","P");vt=="PR"?(u.setValue("InvoiceRule","I"),u.setValue("DeliveryRule","R")):vt=="WR"?w?c!="W"&&c!=null?l=="N"?u.setValue("PaymentRule",c):u.setValue("PaymentRulePO",c):(l=="N"?u.setValue("PaymentRule","T"):u.setValue("PaymentRulePO","T"),u.setValue("PaymentMethod","T")):u.setValue("PaymentRule","B"):(w?c!="W"&&c!=null?l=="N"?u.setValue("PaymentRule",c):u.setValue("PaymentRulePO",c):(l=="N"?u.setValue("PaymentRule","T"):u.setValue("PaymentRulePO","T"),u.setValue("PaymentMethod","T")):(s=t.getValueOfString(b?h.PaymentRule:h.PaymentRulePO),s!=null&&s.length!=0&&(s=="B"&&(s="P"),(b&&s=="S"||s=="U")&&(s="P"),u.setValue("PaymentRule",s))),bt=t.getValueOfInt(u.getValue("C_PaymentTerm_ID")),v=t.getValueOfDecimal(u.getValue("C_Order_Blanket")),bt>0&&v>0||(k=t.getValueOfInt(b?h.C_PaymentTerm_ID:h.PO_PaymentTerm_ID),kt=this.checkAdvancePaymentTerm(t.getValueOfInt(u.getValue("C_DocTypeTarget_ID")),k),kt?k!=0&&u.setValue("C_PaymentTerm_ID",k):u.setValue("C_PaymentTerm_ID",null)),s=t.getValueOfString(h.InvoiceRule),s!=null&&s.length!=0&&u.setValue("InvoiceRule",s),s=t.getValueOfString(h.DeliveryRule),s!=null&&s.length!=0&&u.setValue("DeliveryRule",s),s=t.getValueOfString(h.FreightCostRule),s!=null&&s.length!=0&&u.setValue("FreightCostRule",s),s=t.getValueOfString(h.DeliveryViaRule),s!=null&&s.length!=0&&u.setValue("DeliveryViaRule",s))}}catch(dt){return this.setCalloutActive(!1),dt}return this.setCalloutActive(!1),o=null,this.BPartnerBill(i,r,u,f,u.getValue("Bill_BPartner_ID"))};i.prototype.BPartnerLoc=function(i,r,f,e,o,s){var h=null,b="",c,l,a,v,y,p;if(this.isCalloutActive()||o==null||o.toString()=="")return"";try{if((c=0,o!=null&&(c=t.getValueOfInt(o.toString())),c==0)||(l=t.getValueOfBoolean(f.getValue("IsReturnTrx")),l))return"";this.setCalloutActive(!0);a=i.isSOTrx(r);a&&(h=n.dataContext.getJSONRecord("MBPartner/GetLocationData",c.toString()),h!=null&&(v=t.getValueOfString(h.CreditStatusSettingOn),v=="CL"&&(y=t.getValueOfDouble(h.SO_CreditLimit),y!=0&&(p=t.getValueOfDouble(h.CreditAvailable),h!=null&&p<=0&&n.ADialog.info("CreditOver",null,"","")))))}catch(w){return h!=null&&(h.close(),h=null),this.log.log(u.SEVERE,b,w),this.setCalloutActive(!1),w}this.setCalloutActive(!1);s=null};i.prototype.BPartnerBill=function(i,r,f,e,o){var h,c,b,l,a,y,v,p,k,d,s,w,g,nt,tt;if(this.isCalloutActive()||o==null||o.toString()=="")return"";h=null;try{if(c=t.getValueOfInt(o.toString()),c==null||c==0)return"";if(this.setCalloutActive(!0),b=t.getValueOfBoolean(f.getValue("IsReturnTrx")),b)return this.setCalloutActive(!1),"";h=n.dataContext.getJSONRecord("MBPartner/GetBPartnerBillData",c.toString());l="Y"==i.getWindowContext(r,"IsSOTrx",!0);h!=null&&(a=t.getValueOfInt(h.Bill_Location_ID),c.toString()==i.getContext("C_BPartner_ID")&&(y=i.getContext("C_BPartner_Location_ID"),y.length>0&&(a=t.getValueOfInt(y))),a==0?f.setValue("Bill_Location_ID",null):f.setValue("Bill_Location_ID",t.getValueOfInt(a)),v=t.getValueOfInt(h.AD_User_ID),c.toString()==i.getContext("C_BPartner_ID")&&(p=i.getContext("AD_User_ID"),p.length>0&&(v=t.getValueOfInt(p))),v==0?f.setValue("Bill_User_ID",null):f.setValue("Bill_User_ID",t.getValueOfInt(v.toString())),l&&(k=0,k!=0&&(d=0,h!=null&&d<0&&n.ADialog.info("CreditLimitOver",null,"",""))),s=h.POReference,s=h.SO_Description,s!=null&&s.toString().trim().length!=0&&f.setValue("Description",s),s=h.IsDiscountPrinted,s!=null&&s.toString().length!=0?f.setValue("IsDiscountPrinted",s):f.setValue("IsDiscountPrinted","N"),w=i.getContext("OrderType"),f.setValue("InvoiceRule","D"),f.setValue("PaymentRule","P"),w=="PR"?f.setValue("InvoiceRule","I"):w=="WR"?f.setValue("PaymentRule","B"):(s=h[l?"PaymentRule":"PaymentRulePO"],s!=null&&s.toString().length!=0&&(s=="B"&&(s="P"),l&&(s=="S"||s=="U")&&(s="P"),f.setValue("PaymentRule",s)),g=t.getValueOfInt(f.getValue("C_PaymentTerm_ID")),nt=t.getValueOfDecimal(f.getValue("C_Order_Blanket")),g>0&&nt>0||(ii=h[l?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"],tt=this.checkAdvancePaymentTerm(t.getValueOfInt(f.getValue("C_DocTypeTarget_ID")),ii),tt?h!=null&&f.setValue("C_PaymentTerm_ID",ii):f.setValue("C_PaymentTerm_ID",null)),s=h.InvoiceRule,s!=null&&s.toString().length!=0&&f.setValue("InvoiceRule",s)))}catch(it){return this.setCalloutActive(!1),h!=null&&(h.close(),h=null),this.log(u.SEVERE,"bPartnerBill",it),it}return this.setCalloutActive(!1),this.PriceList(i,r,f,e,f.getValue("M_PriceList_ID"))};i.prototype.PriceList=function(i,f,e,o,s,h){var y="",c=null,l,a;if(this.isCalloutActive()||s==null||s.toString()=="")return"";try{if(l=t.getValueOfInt(s.toString()),l==null||l==0)return"";if(this.setCalloutActive(!0),r&&this.log.warning("init"),c=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",s.toString()),c!=null){e.setValue("IsTaxIncluded","Y"==c.IsTaxIncluded);i.setContext(f,"EnforcePriceLimit",c.EnforcePriceLimit);var p=c.C_Currency_ID,w=t.getValueOfInt(e.getValue("C_Currency_ID")),b=t.getValueOfDecimal(e.getValue("C_Order_Blanket"));w>0&&b>0||e.setValue("C_Currency_ID",p);a=c.M_PriceList_Version_ID;i.setContext(f,"M_PriceList_Version_ID",a)}}catch(v){return this.setCalloutActive(!1),c!=null&&c.close(),this.log(u.SEVERE,y,v),v}return r&&this.log.warning("finish"),this.setCalloutActive(!1),i=f=e=o=s=h=null,""};i.prototype.Product=function(i,u,f,e,o,h){var a,c,nt,w,ut,v,l,p,k,tt,ot;if(this.isCalloutActive()||o==null||o.toString()==""||(a=t.getValueOfInt(o),a==null||a==0)||"Y"==i.getWindowContext(u,"IsReturnTrx",!0))return"";this.setCalloutActive(!0);try{r&&this.log.warning("init");f.setValue("C_Charge_ID",null);f.setValue("M_AttributeSetInstance_ID",null);var d=i.getWindowContext(u,"IsSOTrx",!0)=="Y",vt=i.getWindowContext(u,"IsReturnTrx",!0)=="Y",rt=i.getContextAsInt(u,"C_BPartner_ID",!1),st=t.getValueOfDecimal(f.getValue("QtyOrdered")),ht=i.getContextAsInt(u,"M_PriceList_ID",!1),ct=i.getContextAsInt(u,"M_PriceList_Version_ID",!1),g=i.getContextAsInt(u,"M_AttributeSetInstance_ID",!1),lt=f.getValue("DateOrdered"),at=2,y=2,p=a.toString().concat(",",rt.toString(),",",st.toString(),",",d,",",ht.toString(),",",ct.toString(),",",lt.toString(),",",null,",",g.toString());try{if(c=n.dataContext.getJSONRecord("MOrderLine/GetProductInfo",p),c!=null&&(f.setValue("PrintDescription",c.DocumentNote),nt=c.productType.toString(),i.setContext(u,"ProductType",nt),nt=="S"?f.setValue("IsContract",!0):(f.setValue("IsContract",!1),f.setValue("NoofCycle",null),f.setValue("QtyPerCycle",null),f.setValue("StartDate",null),f.setValue("C_Contract_ID",0),f.setValue("EndDate",null),f.setValue("C_Frequency_ID",0)),c.IsDropShip.toString()=="Y"?f.setValue("IsDropShip",!0):f.setValue("IsDropShip",!1),s=t.getValueOfInt(c.countEd011),w=t.getValueOfInt(c.purchasingUom),w>0&&!d?f.setValue("C_UOM_ID",w):f.setValue("C_UOM_ID",t.getValueOfInt(c.headerUom)),at=t.getValueOfInt(c.StdPrecision),y=t.getValueOfInt(c.PriceListPrecision),w>0&&!d?(ut=f.getValue("M_Product_ID").toString().concat(","+i.getAD_Client_ID().toString()+","+f.getValue("C_Order_ID").toString()+","+rt.toString()+","+f.getValue("QtyEntered").toString()+","+t.getValueOfString(w)),v=n.dataContext.getJSONRecord("MOrderLine/GetPricesOnProductChange",ut),PriceList=t.getValueOfDecimal(v.PriceList),f.setValue("PriceList",PriceList),PriceEntered=t.getValueOfDecimal(v.PriceEntered),f.setValue("PriceEntered",PriceEntered),PriceActual=t.getValueOfDecimal(v.PriceEntered.toFixed(y)),f.setValue("PriceActual",PriceActual),f.setValue("QtyOrdered",t.getValueOfDecimal(v.QtyOrdered.toFixed(v.UOMStdPrecision)))):(f.setValue("PriceList",c.PriceList),f.setValue("PriceLimit",c.PriceLimit),f.setValue("PriceActual",t.getValueOfDecimal(c.PriceActual.toFixed(y))),f.setValue("PriceEntered",t.getValueOfDecimal(c.PriceEntered.toFixed(y))),f.setValue("C_Currency_ID",t.getValueOfInt(c.C_Currency_ID)),f.setValue("Discount",t.getValueOfDecimal(c.Discount.toFixed(y))),f.setValue("QtyOrdered",f.getValue("QtyEntered"))),i.setContext(u,"EnforcePriceLimit",c.EnforcePriceLimit?"Y":"N"),i.setContext(u,"DiscountSchema",c.DiscountSchema?"Y":"N"),d)){var ft=t.getValueOfDecimal(f.getValue("QtyOrdered")),et=i.getContextAsInt(u,"M_Warehouse_ID"),g=i.getContextAsInt(u,"M_AttributeSetInstance_ID"),b=0;f.getValue("C_OrderLine_ID")!=null&&(b=t.getValueOfInt(f.getValue("C_OrderLine_ID")));b==null&&(b=0);p=a.toString().concat(",",et.toString(),",",g.toString(),",",b.toString());l=n.dataContext.getJSONRecord("MStorage/GetQtyAvailable",p);l==null&&(l=n.Env.ZERO);l==0||l.toString().compareTo(ft)<0||(p=et.toString()+","+a.toString()+","+g.toString()+","+b.toString(),k=n.dataContext.getJSONRecord("MOrderLine/GetNotReserved",p),k==null&&(k=n.Env.ZERO),tt=l-k,tt.compareTo(ft)<0&&(ot=n.Msg.parseTranslation(i,"@QtyAvailable@="+l+" - @QtyNotReserved@="+k+" = "+tt),n.ADialog.info("InsufficientQtyAvailable",!0,ot,"")))}r&&this.log.warning("fini")}catch(it){return this.log.saveError("calloutorder",it.toString()),this.setCalloutActive(!1),it.message}this.setCalloutActive(!1)}catch(it){this.setCalloutActive(!1);this.log.saveError("calloutorder",it.toString())}return this.setCalloutActive(!1),h=null,this.Tax(i,u,f,e,o)};i.prototype.Charge=function(i,r,f,e,o,s){var c,v,l,a,h;try{if(this.isCalloutActive()||o==null||o.toString()=="")return"";if((this.setCalloutActive(!0),c=t.getValueOfInt(o),c==null||c==0)||(v="Y"==i.getContext("IsReturnTrx"),v))return this.setCalloutActive(!1),"";f.getValue("M_Product_ID")!=null&&f.setValue("M_Product_ID",null);f.setValue("M_AttributeSetInstance_ID",null);f.setValue("S_ResourceAssignment_ID",null);l=i.getContextAsInt("#C_UOM_ID");l>0?f.setValue("C_UOM_ID",l):f.setValue("C_UOM_ID",100);i.setContext(r,"DiscountSchema","N");a=n.dataContext.getJSONRecord("MOrder/GetPrecision",f.getValue("C_Order_ID").toString());h=n.dataContext.getJSONRecord("MCharge/GetChargeDetails",c.toString());h!=null&&(f.setValue("PriceEntered",t.getValueOfDecimal(h.ChargeAmt).toFixed(a)),f.setValue("PrintDescription",t.getValueOfString(h.PrintDescription)),f.setValue("PriceActual",t.getValueOfDecimal(h.ChargeAmt).toFixed(a)));f.setValue("PriceLimit",n.Env.ZERO);f.setValue("PriceList",n.Env.ZERO);f.setValue("Discount",n.Env.ZERO)}catch(y){return this.setCalloutActive(!1),this.log.log(u.SEVERE,y.toString()),y}return this.setCalloutActive(!1),s=null,this.Tax(i,r,f,e,o)};i.prototype.Tax=function(i,u,f,e,o,s){var w,y,l,a,c,b,k,d,g,v,h;if(this.isCalloutActive()||o==null||o.toString()==""||(console.log("Before Charge Or Product"),t.getValueOfInt(f.getValue("C_Charge_ID"))==0&&t.getValueOfInt(f.getValue("M_Product_ID"))==0))return"";this.setCalloutActive(!0);try{var nt="",tt="",it=t.getValueOfString(f.getValue("M_Product_ID")).concat(",",t.getValueOfString(f.getValue("C_Order_ID"))+","+t.getValueOfString(f.getValue("C_Charge_ID"))),h=n.dataContext.getJSONRecord("MOrderLine/GetTaxId",it),rt=t.getValueOfInt(h._CountVATAX),ot=i.getWindowContext(u,"IsSOTrx",!0)=="Y",ut=i.getWindowContext(u,"IsReturnTrx",!0)=="Y";if(rt>0&&(nt=t.getValueOfString(h.taxRule)),nt!="T"||ut){if(y=e.getColumnName(),o==null)return"";if((r&&this.log.warning("init"),l=0,l=y=="M_Product_ID"?t.getValueOfInt(o):t.getValueOfInt(i.getContextAsInt(u,"M_Product_ID")),a=0,a=y=="C_Charge_ID"?t.getValueOfInt(o):t.getValueOfInt(i.getContextAsInt(u,"C_Charge_ID")),this.log.fine("Product="+l+", C_Charge_ID="+a),l==0&&a==0)||(c=0,c=y=="C_BPartner_Location_ID"?t.getValueOfInt(o):t.getValueOfInt(i.getContextAsInt(u,"C_BPartner_Location_ID")),c==0))return this.setCalloutActive(!1),this.Amt(i,u,f,e,o);this.log.fine("Ship BP_Location="+c);b=i.getContext("DateOrdered");this.log.fine("Bill Date="+b);k=i.getContext("DatePromised");this.log.fine("Ship Date="+k);d=i.getContextAsInt(u,"AD_Org_ID");this.log.fine("Org="+d);g=i.getContextAsInt(u,"M_Warehouse_ID");this.log.fine("Warehouse="+g);v=i.getContextAsInt(u,"Bill_Location_ID");v==0&&(v=c);this.log.fine("Bill BP_Location="+v);var ft="Y"==i.getWindowContext(u,"IsSOTrx",!0),tt=l.toString()+","+a.toString()+","+b.toString()+","+k.toString()+","+d.toString()+","+g.toString()+","+v.toString()+","+c.toString()+","+ft.toString(),p=n.dataContext.getJSONRecord("MTax/Get_Tax_ID",tt);this.log.info("Tax ID="+p);p==0||(f.setValue("C_Tax_ID",t.getValueOfInt(p)),f.findColumn("C_TaxExemptReason_ID")>-1&&f.findColumn("IsTaxExempt")>-1&&(h=n.dataContext.getJSONRecord("MTax/GetTaxExempt",p),h!=null&&(f.setValue("C_TaxExemptReason_ID",t.getValueOfInt(h.C_TaxExemptReason_ID)),f.setValue("IsTaxExempt",t.getValueOfString(h.IsTaxExempt).equals("Y")?!0:!1))));r&&this.log.warning("fini")}else if(w=t.getValueOfInt(h.taxId),t.getValueOfInt(w)>0)f.setValue("C_Tax_ID",w),f.findColumn("C_TaxExemptReason_ID")>-1&&f.findColumn("IsTaxExempt")>-1&&(f.setValue("C_TaxExemptReason_ID",t.getValueOfInt(h.C_TaxExemptReason_ID)),f.setValue("IsTaxExempt",t.getValueOfString(h.IsTaxExempt).equals("Y")?!0:!1));else{if(t.getValueOfInt(f.getValue("M_Product_ID"))>0)return f.setValue("M_Product_ID",""),this.setCalloutActive(!1),h.TaxExempt=="Y"?n.ADialog.info("TaxNoExemptFound"):n.ADialog.info("VATAX_DefineTax");if(t.getValueOfInt(f.getValue("C_Charge_ID"))>0)return f.setValue("C_Charge_ID",""),this.setCalloutActive(!1),h.TaxExempt=="Y"?n.ADialog.info("TaxNoExemptFound"):n.ADialog.info("VATAX_DefineChargeTax")}}catch(et){return this.setCalloutActive(!1),et}return this.setCalloutActive(!1),s=null,this.Amt(i,u,f,e,o)};i.prototype.Amt=function(i,u,f,e,o,s){var w,v,d,it,h,c,b,l,a,lt,et,at,nt,ot,rt,vt,y,st,tt,ht;if(this.isCalloutActive()||o==null||o.toString()==""||(console.log("Before Charge Or Product"),t.getValueOfInt(f.getValue("C_Charge_ID"))==0&&t.getValueOfInt(f.getValue("M_Product_ID"))==0))return"";console.log("After Charge Or Product");this.setCalloutActive(!0);try{r&&this.log.Warning("init");var yt=i.getContextAsInt(u,"C_UOM_ID"),pt=i.getContextAsInt(u,"M_Product_ID"),wt=i.getContextAsInt(u,"M_PriceList_ID"),bt=i.getWindowContext(u,"IsSOTrx",!0)=="Y",g=t.getValueOfInt(f.getValue("C_OrderLine_Blanket_ID"))>0?!0:!1,ct=t.getValueOfInt(f.getValue("C_Quotation_Line_ID"))>0?!0:!1;ct&&(g=ct);w=t.getValueOfDecimal(f.getValue("QtyDelivered"))>0?!0:!1;w||(w=t.getValueOfDecimal(f.getValue("QtyInvoiced"))>0?!0:!1);v=n.dataContext.getJSONRecord("MPriceList/GetPriceList",wt.toString());var k=2,p=2,ut="Y",ft="N";if(v!=null&&(k=t.getValueOfInt(v.StdPrecision),p=t.getValueOfInt(v.PriceListPrecision),ut=t.getValueOfString(v.EnforcePriceLimit),ft=t.getValueOfString(v.IsTaxIncluded)),d=t.getValueOfDecimal(f.getValue("QtyEntered")),it=t.getValueOfDecimal(f.getValue("QtyOrdered")),this.log.fine("QtyEntered="+d+", Ordered="+it+", UOM="+yt),h=t.getValueOfDecimal(f.getValue("PriceEntered")),c=t.getValueOfDecimal(f.getValue("PriceActual")),l=t.getValueOfDecimal(f.getValue("Discount")),b=t.getValueOfDecimal(f.getValue("PriceLimit")),a=t.getValueOfDecimal(f.getValue("PriceList")),this.log.fine("PriceList="+a+", Limit="+b+", Precision="+p),this.log.fine("PriceEntered="+h+", Actual="+c+", Discount="+l),et=i.getContextAsInt(u,"C_BPartner_ID",!1),e.getColumnName()=="QtyEntered"&&t.getValueOfInt(f.getValue("Orig_OrderLine_ID"))<=0,e.getColumnName()!="QtyOrdered"&&e.getColumnName()!="QtyEntered"&&e.getColumnName()!="M_Product_ID"||"N"==i.getContext("DiscountSchema")?e.getColumnName()=="PriceActual"?(c=t.getValueOfDecimal(o.toFixed(p)),h=c,this.log.fine("PriceActual="+c+" -> PriceEntered="+h),f.setValue("PriceEntered",h),f.setValue("PriceActual",c)):e.getColumnName()=="PriceEntered"&&(h=t.getValueOfDecimal(o.toFixed(p)),c=h,this.log.fine("PriceEntered="+h+" -> PriceActual="+c),f.setValue("PriceActual",c),f.setValue("PriceEntered",h)):(it==null&&(it=d),t.getValueOfInt(f.getValue("Orig_OrderLine_ID"))<=0&&(et=i.getContextAsInt(u,"C_BPartner_ID",!1),g||w||(at=pt.toString().concat(",",f.getValue("C_Order_ID").toString()+","+t.getValueOfString(f.getValue("M_AttributeSetInstance_ID"))+","+t.getValueOfString(f.getValue("C_UOM_ID"))+","+i.getAD_Client_ID().toString()+","+et.toString()+","+f.getValue("QtyEntered").toString()+",1,1"),nt=n.dataContext.getJSONRecord("MOrderLine/GetPricesOnChange",at),lt=t.getValueOfString(nt.DiscountSchema),(e.getColumnName()=="M_Product_ID"||t.getValueOfDecimal(nt.PriceList)!=0&&f.getValue("PriceList")==0)&&(a=t.getValueOfDecimal(nt.PriceList),f.setValue("PriceList",t.getValueOfDecimal(nt.PriceList)),h=t.getValueOfDecimal(nt.PriceEntered))),this.log.fine("QtyChanged -> PriceActual="+h+", PriceEntered="+h+", Discount="+l),c=t.getValueOfDecimal(h.toFixed(p)),g||w||e.getColumnName()!="M_Product_ID"&&(h==0||f.getValue("PriceEntered")!=0)||(f.setValue("PriceActual",h),c=h,f.setValue("Discount",(t.getValueOfDecimal(f.getValue("PriceList"))-h)/t.getValueOfDecimal(f.getValue("PriceList"))*100)),f.setValue("PriceEntered",h),i.setContext(u,"DiscountSchema",lt))),e.getColumnName()=="Discount")c=t.getValueOfDecimal((100-l)/100*a),t.scale(c)>p&&(c=c.toFixed(p)),h=c,h==null&&(h=c),f.setValue("PriceActual",c),f.setValue("PriceEntered",h);else{if(a==0)l=n.Env.ZERO;else if(l=t.getValueOfDecimal((a-c)/a*100),isNaN(l))return this.setCalloutActive(!1),"PriceListNotSelected";l=t.getValueOfDecimal(l.toFixed(p));f.setValue("PriceList",t.getValueOfDecimal(a.toFixed(p)));g||w||f.setValue("Discount",l)}if(this.log.fine("PriceEntered="+h+", Actual="+c+", Discount="+l),ot=!1,rt=bt&&ut!=null&&ut=="Y",ot=n.MRole.getDefault().getIsOverwritePriceLimit(),vt="Y"==i.getWindowContext(u,"IsReturnTrx",!0),rt&&(ot||vt)&&(rt=!1),rt&&b!=0&&c.compareTo(b)<0&&(c=b,h=c,h==null&&(h=b),this.log.fine("(under) PriceEntered="+h+", Actual"+b),g||w||(f.setValue("PriceActual",b),f.setValue("PriceEntered",h)),n.ADialog.info("UnderLimitPrice",!0,"",""),a!=0&&(l=t.getValueOfDecimal((a-c)/a*100),l=l.toFixed(2),g||w||f.setValue("Discount",l))),h=t.getValueOfDecimal(f.getValue("PriceEntered")),y=d*h,d>0&&y==0&&(st=t.getValueOfDecimal(f.getValue("C_OrderLine_Blanket_ID")),st>0&&(v=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",st.toString()),v!=null))){var a=t.getValueOfDouble(v.PriceList),c=t.getValueOfDouble(v.PriceActual),h=t.getValueOfDouble(v.PriceEntered),l=t.getValueOfDouble(v.Discount);h!=null&&(f.setValue("PriceEntered",h),f.setValue("LineNetAmt",h*d),y=h*d);a!=null&&f.setValue("PriceList",a);l!=null&&f.setValue("Discount",l);c!=null&&f.setValue("PriceActual",c)}if(t.scale(y)>k&&(y=t.getValueOfDecimal(y.toFixed(k))),this.log.info("LineNetAmt="+y),f.setValue("LineNetAmt",y),tt=n.Env.ZERO,e.getColumnName()=="TaxAmt")tt=f.getValue("TaxAmt");else if(ht=f.getValue("C_Tax_ID"),ht!=null){var kt=ht,dt=kt.toString().concat(",",y.toString(),",",ft=="Y",",",k.toString()),v=null;tt=n.dataContext.getJSONRecord("MTax/CalculateTax",dt);f.setValue("TaxAmt",tt);f.getField("SurchargeAmt")!=null&&f.setValue("SurchargeAmt",0)}ft=="Y"?f.setValue("LineTotalAmt",t.getValueOfDecimal(y.toFixed(k))):f.setValue("LineTotalAmt",t.getValueOfDecimal(y.toFixed(k))+t.getValueOfDecimal(tt.toFixed(k)))}catch(gt){return this.setCalloutActive(!1),gt}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};i.prototype.IsTaxIncluded=function(t,i){var r=i.getContext("IsTaxIncluded"),u;try{if(r.toString().length==0){if(u=i.getContextAsInt(t,"M_PriceList_ID"),u==0)return!1;r=n.dataContext.getJSONRecord("MPriceList/GetTaxIncluded",u.toString());r==null&&(r="N");i.setContext(t,"IsTaxIncluded",r)}}catch(f){this.setCalloutActive(!1);this.log.severe(f.toString())}return i=t=mTab=mField=value=oldValue=null,"Y"==r};i.prototype.Qty=function(i,u,f,e,o,s){var l="",a,ot,st,p,nt,y,ht,ct,w,it,v,at,d,g,rt,vt;if(this.isCalloutActive()||o==null||o.toString()==""||(console.log("Before Charge Or Product"),t.getValueOfInt(f.getValue("C_Charge_ID"))==0&&t.getValueOfInt(f.getValue("M_Product_ID"))==0))return"";console.log("After Charge Or Product");this.setCalloutActive(!0);try{a=i.getContextAsInt(u,"M_Product_ID");r&&this.log.Warning("init - M_Product_ID="+a+" - ");var h=n.Env.ZERO,c=n.Env.ZERO,gt=n.Env.ZERO,ut="Y"==i.getContext("IsReturnTrx"),ft=t.getValueOfInt(f.getValue("C_OrderLine_Blanket_ID"))>0?!0:!1,et=t.getValueOfInt(f.getValue("C_Quotation_Line_ID"))>0?!0:!1;if(et&&(ft=et),ot=i.getContextAsInt(u,"C_BPartner_ID",!1),a==0)c=t.getValueOfDecimal(f.getValue("QtyEntered")),h=c,f.setValue("QtyOrdered",h);else if(e.getColumnName()=="C_UOM_ID"||e.getColumnName()=="M_AttributeSetInstance_ID"||e.getColumnName()=="StartDate")v=t.getValueOfInt(f.getValue("C_UOM_ID")),c=t.getValueOfDecimal(f.getValue("QtyEntered")),st=a.toString().concat(",",f.getValue("C_Order_ID").toString()+","+t.getValueOfString(f.getValue("M_AttributeSetInstance_ID"))+","+t.getValueOfString(f.getValue("C_UOM_ID"))+","+i.getAD_Client_ID().toString()+","+t.getValueOfString(ot)+","+c.toString()+",1,1"),p=n.dataContext.getJSONRecord("MOrderLine/GetPricesOnChange",st),ft||(f.setValue("PriceList",t.getValueOfDecimal(p.PriceList)),f.setValue("PriceLimit",t.getValueOfDecimal(p.PriceLimit)),f.setValue("PriceActual",t.getValueOfDecimal(p.PriceEntered)),f.setValue("PriceEntered",t.getValueOfDecimal(p.PriceEntered))),y=c.toFixed(t.getValueOfInt(p.UOMPrecision)),c!=y&&(this.log.fine("Corrected QtyEntered Scale UOM="+v+"; QtyEntered="+c+"->"+y),c=y,f.setValue("QtyEntered",c)),h=p.QtyOrdered,h==null&&(h=c),f.setValue("QtyOrdered",h);else if(e.getColumnName()=="QtyEntered")v=i.getContextAsInt(u,"C_UOM_ID"),c=t.getValueOfDecimal(o),l=v.toString().concat(","),nt=n.dataContext.getJSONRecord("MUOM/GetPrecision",l),y=c.toFixed(t.getValueOfInt(nt)),c!=y&&(this.log.fine("Corrected QtyEntered Scale UOM="+v+"; QtyEntered="+c+"->"+y),c=y,f.setValue("QtyEntered",c)),l=a.toString().concat(",",v.toString(),",",c.toString()),ht=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",l),h=ht,h==null&&(h=c),w=c!=h,this.log.fine("UOM="+v+", QtyEntered="+c+" -> "+w+" QtyOrdered="+h),i.setContext(u,"UOMConversion",w?"Y":"N"),f.setValue("QtyOrdered",h);else if(e.getColumnName()=="QtyOrdered"){v=i.getContextAsInt(u,"C_UOM_ID");h=t.getValueOfDecimal(o);l=a.toString().concat(",");var nt=n.dataContext.getJSONRecord("MProduct/GetUOMPrecision",l),yt=nt,tt=h.toFixed(yt);h!=tt&&(this.log.fine("Corrected QtyOrdered Scale "+h+"->"+tt),h=tt,f.setValue("QtyOrdered",h));l=a.toString().concat(",",v.toString(),",",h.toString());ct=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",l);c=ct;c==null&&(c=h);w=h!=c;this.log.fine("UOM="+v+", QtyOrdered="+h+" -> "+w+" QtyEntered="+c);i.setContext(u,"UOMConversion",w?"Y":"N");f.setValue("QtyEntered",c)}else h=t.getValueOfDecimal(f.getValue("QtyOrdered"));if(a!=0&&ut&&(it=t.getValueOfInt(f.getValue("Orig_InOutLine_ID")),it!=0)){l=it.toString();var lt=n.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",l),pt=lt.MovementQty,k=t.getValueOfDecimal(pt);h=t.getValueOfDecimal(f.getValue("QtyOrdered"));k<h&&(i.isSOTrx()?n.ADialog.info("QtyShippedAndReturned",null,k.toString(),""):n.ADialog.info("QtyRecievedAndReturnd",null,k.toString(),""),f.setValue("QtyOrdered",k),h=k,v=i.getContextAsInt(u,"C_UOM_ID"),l=a.toString().concat(",",v.toString(),",",h.toString()),c=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",l),c==null&&(c=h),f.setValue("QtyEntered",c),this.log.fine("QtyEntered : "+c.toString()+"QtyOrdered : "+h.toString()))}if(a!=0&&i.isSOTrx()&&h>0&&!ut&&(at=n.dataContext.getJSONRecord("MProduct/GetProduct",a.toString()),d=0,t.getValueOfBoolean(at.IsStocked))){var wt=i.getContextAsInt(u,"M_Warehouse_ID"),bt=i.getContextAsInt(u,"M_AttributeSetInstance_ID"),kt=a.toString().concat(",",wt.toString(),",",bt.toString(),",",d.toString()),lt=null,b=n.dataContext.getJSONRecord("MStorage/GetQtyAvailable",kt);b==null&&(b=n.Env.ZERO);b==0||b.toString().compareTo(h)<0||(d=f.getValue("C_OrderLine_ID")==""?0:t.getValueOfInt(f.getValue("C_OrderLine_ID")),d==null&&(d=0),g=lt.notReserved,g==null&&(g=n.Env.ZERO),rt=b-g,rt<h&&(vt=n.Msg.parseTranslation(i,"@QtyAvailable@="+b+"  -  @QtyNotReserved@="+g+"  =  "+rt),n.ADialog.info("InsufficientQtyAvailable",null,vt,"")))}}catch(dt){return this.setCalloutActive(!1),dt}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};i.prototype.Orig_Order=function(i,r,u,f,e,o){var h,s,l,y,a,p,v,c;if(this.isCalloutActive()||e==null||e.toString()==""||(h=t.getValueOfInt(e),h==null||h==0))return"";this.setCalloutActive(!0);try{s=n.dataContext.getJSONRecord("MOrder/GetOrder",h.toString());l=n.dataContext.getJSONRecord("MBPartner/GetBPartner",s.C_BPartner_ID.toString());u.setValue("Orig_InOut_ID",null);u.setValue("C_BPartner_ID",t.getValueOfInt(s.C_BPartner_ID));u.setValue("C_BPartner_Location_ID",t.getValueOfInt(s.C_BPartner_Location_ID));u.setValue("Bill_BPartner_ID",t.getValueOfInt(s.Bill_BPartner_ID));u.setValue("Bill_Location_ID",t.getValueOfInt(s.Bill_Location_ID));s.AD_User_ID!=0&&u.setValue("AD_User_ID",t.getValueOfInt(s.AD_User_ID));s.Bill_User_ID!=0&&u.setValue("Bill_User_ID",t.getValueOfInt(s.Bill_User_ID));i.isSOTrx()?u.setValue("M_ReturnPolicy_ID",t.getValueOfInt(l.M_ReturnPolicy_ID)):u.setValue("M_ReturnPolicy_ID",t.getValueOfInt(l.PO_ReturnPolicy_ID));!0&&(this.setCalloutActive(!1),u.setValue("M_PriceList_ID",t.getValueOfInt(s.M_PriceList_ID)),this.setCalloutActive(!0));u.setValue("PaymentRule",s.PaymentRule);y=this.checkAdvancePaymentTerm(t.getValueOfInt(u.getValue("C_DocTypeTarget_ID")),t.getValueOfInt(s.C_PaymentTerm_ID));y?u.setValue("C_PaymentTerm_ID",t.getValueOfInt(s.C_PaymentTerm_ID)):u.setValue("C_PaymentTerm_ID",null);u.setValue("Bill_Location_ID",t.getValueOfInt(s.Bill_Location_ID));u.setValue("InvoiceRule",s.InvoiceRule);u.setValue("PaymentRule",s.PaymentRule);u.setValue("DeliveryViaRule",s.DeliveryViaRule);u.setValue("FreightCostRule",s.FreightCostRule);a=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_");a.VA009_&&(p=a.VA009_.toString()+","+h.toString(),dr=n.dataContext.getJSONRecord("MOrder/GetPaymentMethod",p),dr!=null&&(v=t.getValueOfInt(dr.VA009_PaymentMethod_ID),v>0&&(u.setValue("VA009_PaymentMethod_ID",v),c=t.getValueOfString(dr.VA009_PaymentBaseType),c!="W"&&c!=null&&(u.setValue("PaymentMethod",c),u.setValue("PaymentRule",c)))))}catch(w){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.Orig_InOut=function(i,r,u,f,e,o){var h,s;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(h=t.getValueOfInt(e),h==null||h==0)return"";this.setCalloutActive(!0);s=n.dataContext.getJSONRecord("MInOut/GetInOut",h.toString());u.setValue("C_Project_ID",t.getValueOfInt(s.C_Project_ID));u.setValue("C_Campaign_ID",t.getValueOfInt(s.C_Campaign_ID));u.setValue("C_Activity_ID",t.getValueOfInt(s.C_Activity_ID));u.setValue("AD_OrgTrx_ID",t.getValueOfInt(s.AD_OrgTrx_ID));u.setValue("User1_ID",t.getValueOfInt(s.User1_ID));u.setValue("User2_ID",t.getValueOfInt(s.User2_ID));t.getValueOfString(s.IsDropShip)=="Y"?(u.setValue("M_Warehouse_ID",t.getValueOfInt(s.M_Warehouse_ID)),u.setValue("IsDropShip",!0)):(u.setValue("IsDropShip",!1),u.setValue("M_Warehouse_ID",null))}catch(c){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.Orig_OrderLine=function(i,r,u,f,e,o){var c,s,a,v,l,y,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(c=t.getValueOfInt(e),c==null||c==0)return"";this.setCalloutActive(!0);s=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",c.toString());u.setValue("Orig_InOutLine_ID",null);u.setValue("C_Tax_ID",t.getValueOfInt(s.C_Tax_ID));u.setValue("PriceList",t.getValueOfDecimal(s.PriceList));u.setValue("PriceLimit",t.getValueOfDecimal(s.PriceLimit));u.setValue("PriceActual",t.getValueOfDecimal(s.PriceActual));u.setValue("PriceEntered",t.getValueOfDecimal(s.PriceEntered));u.setValue("C_Currency_ID",t.getValueOfInt(s.C_Currency_ID));u.setValue("Discount",t.getValueOfDecimal(s.Discount));a=i.getContextAsInt(r,"M_PriceList_ID");v=n.dataContext.getJSONRecord("MPriceList/GetPriceList",a.toString());l=t.getValueOfInt(v.StdPrecision);y=t.getValueOfDecimal(u.getValue("QtyOrdered"));h=y*t.getValueOfDecimal(s.PriceActual);t.scale(h)>l&&(h=h.toFixed(l));this.log.info("LineNetAmt="+h);u.setValue("LineNetAmt",h)}catch(p){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.Orig_InOutLine=function(i,r,u,f,e,o){var h,s,c;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(h=t.getValueOfInt(e),h==null||h==0)return"";if(this.setCalloutActive(!0),s=n.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",h.toString()),s!=null){u.setValue("C_Project_ID",t.getValueOfInt(s.C_Project_ID));u.setValue("C_Campaign_ID",t.getValueOfInt(s.C_Campaign_ID));u.setValue("M_Product_ID",t.getValueOfInt(s.M_Product_ID));u.setValue("M_AttributeSetInstance_ID",t.getValueOfInt(s.M_AttributeSetInstance_ID));u.setValue("C_UOM_ID",t.getValueOfInt(s.C_UOM_ID));c=t.getValueOfDecimal(s.QtyEntered);u.setValue("QtyEntered",c);var a=s.M_Product_ID.toString().concat(",",s.C_UOM_ID.toString(),",",c.toString()),v=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",a),l=v;l==null&&(l=c);u.setValue("QtyOrdered",l);t.getValueOfString(s.IsDropShip)=="Y"?(u.setValue("IsDropShip",!0),i.setContext(r,"IsDropShip",t.getValueOfString(s.IsDropShip))):u.setValue("IsDropShip",!1)}}catch(y){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.checkAdvancePaymentTerm=function(i,r){var u=!0,f=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),e;return f!=null&&!f.VA009_?u:(t.getValueOfInt(i)!=0&&t.getValueOfInt(r)!=0&&(e=i.toString()+","+r.toString(),u=n.dataContext.getJSONRecord("MOrder/checkAdvancePaymentTerm",e)),u)};n.Model.CalloutOrder=i;n.Utility.inheritPrototype(e,n.CalloutEngine);e.prototype.GetPaymentNote=function(t,i,r,u,f){if(f==null||f.toString()==""||f==""||this.isCalloutActive())return"";this.setCalloutActive(!0);var e=n.dataContext.getJSONRecord("MPaymentTerm/GetPaymentNote",f.toString());return e!=null&&r.setValue("description",e.DocumentNote),this.setCalloutActive(!1),""};n.Model.CalloutSalesQuotation=e;n.Utility.inheritPrototype(o,n.CalloutEngine);o.prototype.BlanketOrderRef=function(t,i,r,u,e){var s,h,o;return this.isCalloutActive()||e==null||e.toString()==""?"":(this.setCalloutActive(!0),u.getColumnName()=="Blanket_Ref_Order_ID"&&(s=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),h=s.VA009_?e.toString()+","+s.VA009_:e.toString()+",false",o=n.dataContext.getJSONRecord("MOrder/GetOrderHeader",h),o!=null&&(r.setValue("AD_Client_ID",o.AD_Client_ID),r.setValue("AD_Org_ID",o.AD_Org_ID),r.setValue("Description",o.Description),r.setValue("C_DocTypeTarget_ID",o.C_DocTypeTarget_ID),r.setValue("DateOrdered",f(o.DateOrdered)),r.setValue("DatePromised",f(o.DatePromised)),r.setValue("OrderValidFrom",f(o.OrderValidFrom)),r.setValue("OrderValidTo",f(o.OrderValidTo)),r.setValue("C_BPartner_ID",o.C_BPartner_ID),r.setValue("Bill_BPartner_ID",o.Bill_BPartner_ID),r.setValue("C_BPartner_Location_ID",o.C_BPartner_Location_ID),r.setValue("Bill_Location_ID",o.Bill_Location_ID),r.setValue("AD_User_ID",o.AD_User_ID),r.setValue("Bill_User_ID",o.Bill_User_ID),r.setValue("M_Warehouse_ID",o.M_Warehouse_ID),r.setValue("PriorityRule",o.PriorityRule),r.setValue("M_PriceList_ID",o.M_PriceList_ID),r.setValue("C_IncoTerm_ID",o.C_IncoTerm_ID),r.setValue("C_Currency_ID",o.C_Currency_ID),r.setValue("C_ConversionType_ID",o.C_ConversionType_ID),r.setValue("SalesRep_ID",o.SalesRep_ID),s.VA009_&&r.setValue("VA009_PaymentMethod_ID",o.VA009_PaymentMethod_ID),r.setValue("C_PaymentTerm_ID",o.C_PaymentTerm_ID),r.setValue("C_Campaign_ID",o.C_Campaign_ID),r.setValue("C_Activity_ID",o.C_Activity_ID),r.setValue("AD_OrgTrx_ID",o.AD_OrgTrx_ID),r.setValue("User1_ID",o.User1_ID),r.setValue("User2_ID",o.User2_ID),r.setValue("TotalLines",o.TotalLines),r.setValue("GrandTotal",o.GrandTotal))),this.setCalloutActive(!1),"")};n.Model.CalloutBlanketOrderRef=o}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutOrderLine")}function r(){n.CalloutEngine.call(this,"VIS.CalloutOrderlineRecording")}var u=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.EndDate=function(i,r,u,f,e,o){if(e==null||e.toString()=="")return"";var h=new Date(u.getValue("StartDate")),c=n.dataContext.getJSONRecord("MOrderLine/GetNoOfMonths",t.getValueOfString(u.getValue("C_Frequency_ID"))),l=t.getValueOfInt(u.getValue("NoofCycle")),s=h.getDate()+"/"+(h.getMonth()+c*l)+"/"+h.getFullYear();return s=s<=0?new Date:new Date(s),s=s.toISOString(),u.setValue("EndDate",s),i=r=u=f=e=o=null,""};i.prototype.Qty=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var s=t.getValueOfDecimal(f),h=t.getValueOfDecimal(r.getValue("QtyPerCycle")),o=s*h;return r.setValue("QtyEntered",o),r.setValue("QtyOrdered",o),n=i=r=u=f=e=null,""};i.prototype.QtyPerCycle=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var s=t.getValueOfDecimal(f),h=t.getValueOfDecimal(r.getValue("NoofCycle")),o=h*s;return r.setValue("QtyEntered",o),r.setValue("QtyOrdered",o),n=i=r=u=f=e=null,""};n.Model.CalloutOrderLine=i;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.Orderline=function(i,r,u,f,e,o){if(e==null||e.toString()==""||t.getValueOfInt(e)==0||this.isCalloutActive())return"";try{this.setCalloutActive(!0);var h=t.getValueOfInt(e),s=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",h);u.setValue("M_Product_ID",s.M_Product_ID);u.setValue("Qty",s.Qty);u.setValue("C_UOM_ID",s.C_UOM_ID);u.setValue("C_BPartner_ID",s.C_BPartner_ID);u.setValue("PlannedHours",s.PlannedHours);this.setCalloutActive(!1)}catch(c){this.setCalloutActive(!1)}return i=r=u=f=e=o=null,""};n.Model.CalloutOrderlineRecording=r}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutPayment")}function e(i){var r=t.getValueOfInt(i.getValue("C_BankAccount_ID")),u=t.getValueOfInt(i.getValue("VA009_PaymentMethod_ID")),o=t.getValueOfString(i.getValue("CheckNo")),f=!1,e;r>0&&u>0&&o!=""&&t.getValueOfString(i.getValue("TenderType"))=="K"&&(e=r.toString()+","+u.toString(),f=t.getValueOfBoolean(n.dataContext.getJSONRecord("MPayment/GetAutoCheckControl",e.toString())));i.setValue("IsOverrideAutoCheck",f)}function u(){n.CalloutEngine.call(this,"VIS.CalloutPaymentAllocate")}function f(){n.CalloutEngine.call(this,"VIS.CalloutPaymentTypeSO")}var r=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Invoice=function(i,u,f,e,o){var c,g,p,nt,s,tt,y,l;if(o==null||o.toString()==""||(c=t.getValueOfInt(o.toString()),this.isCalloutActive()||c==null||c==0))return"";this.setCalloutActive(!0);f.setValue("C_Order_ID",null);f.setValue("C_Charge_ID",null);f.setValue("IsPrepayment",!1);f.setValue("DiscountAmt",n.Env.ZERO);f.setValue("WriteOffAmt",n.Env.ZERO);f.setValue("IsOverUnderPayment",!1);f.setValue("OverUnderAmt",n.Env.ZERO);var a=0,b="",k=!1,it=f.getField("IsInDispute")!=null,v=0,d=0,h=null;try{h=n.dataContext.getJSONRecord("MInvoice/GetInvPaySchedDetail",c.toString());h!=null&&(a=t.getValueOfInt(h.C_InvoicePaySchedule_ID),v=t.getValueOfDecimal(h.dueAmount),b=t.getValueOfString(h.IsReturnTrx),"Y"==b&&(v=v*-1),f.setValue("C_InvoicePaySchedule_ID",a),f.setValue("PayAmt",v),f.setValue("PaymentAmount",v),d=1,g=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),g.VA009_&&(t.getValueOfString(h.VA009_PaymentBaseType)!="B"&&t.getValueOfString(h.VA009_PaymentBaseType)!="C"&&t.getValueOfString(h.VA009_PaymentBaseType)!="P"?f.setValue("VA009_PaymentMethod_ID",t.getValueOfInt(h.VA009_PaymentMethod_ID)):f.setValue("VA009_PaymentMethod_ID",null)))}catch(w){return this.setCalloutActive(!1),this.log.log(r.SEVERE,"CalloutPayment.Invoice -"+c,w.message),w.toString()}i.getContextAsInt(u,"C_Invoice_ID")==c&&i.getContextAsInt(u,"C_InvoicePaySchedule_ID")!=0&&(a=i.getContextAsInt(u,"C_InvoicePaySchedule_ID"));p=new Date(f.getValue("DateTrx"));p==null&&(p=new Date);nt=c.toString()+","+a.toString()+","+p.toString();s=null;try{s=n.dataContext.getJSONRecord("MPayment/GetInvoiceData",nt);s!=null&&(f.setValue("C_BPartner_ID",t.getValueOfInt(s.C_BPartner_ID)),f.setValue("C_Bpartner_Location_Id",t.getValueOfInt(s.C_Bpartner_Location_Id)),tt=t.getValueOfInt(s.C_Currency_ID),f.setValue("C_Currency_ID",tt),f.setValue("C_ConversionType_ID",s.C_ConversionType_ID),y=t.getValueOfDecimal(s.invoiceOpen),y==null&&(y=n.Env.ZERO),l=t.getValueOfDecimal(s.invoiceDiscount),l==null&&(l=n.Env.ZERO),d==0&&(f.setValue("PayAmt",y-l),f.setValue("PaymentAmount",y-l)),f.setValue("C_InvoicePaySchedule_ID",a),f.setValue("DiscountAmt",l),i.setContext(u,"C_Invoice_ID",c.toString()),k=t.getValueOfString(s.IsInDispute)=="Y",it&&(k?(f.setValue("IsInDispute",!0),n.ADialog.info("DiscrepancyInvoice")):f.setValue("IsInDispute",!1)))}catch(w){return this.setCalloutActive(!1),w.message}return this.setCalloutActive(!1),this.DocType(i,u,f,e,o)};i.prototype.Order=function(i,u,f,e,o){var c,l,h,v;if(o==null||o.toString()==""||(c=o,this.isCalloutActive()||c==null||c==0))return"";this.setCalloutActive(!0);f.setValue("C_Invoice_ID",null);f.setValue("C_Charge_ID",null);f.setValue("IsPrepayment",!0);f.setValue("DiscountAmt",n.Env.ZERO);f.setValue("WriteOffAmt",n.Env.ZERO);f.setValue("IsOverUnderPayment",!1);f.setValue("OverUnderAmt",n.Env.ZERO);l=f.getValue("DateTrx");l==null&&(l=new Date);var a=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),p=a.VA009_+","+c.toString(),s=null;try{s=n.dataContext.getJSONRecord("MPayment/GetOrderData",p);s!=null&&(f.setValue("C_BPartner_ID",t.getValueOfInt(s.C_BPartner_ID)),f.setValue("C_Bpartner_Location_Id",t.getValueOfInt(s.C_BPartner_Location_ID)),f.setValue("C_Currency_ID",t.getValueOfInt(s.C_Currency_ID)),f.setValue("C_ConversionType_ID",t.getValueOfInt(s.C_ConversionType_ID)),h=t.getValueOfDecimal(s.GrandTotal),h==null&&(h=n.Env.ZERO),a.VA009_&&(v=t.getValueOfInt(s.VA009_PaymentMethod_ID),f.setValue("VA009_PaymentMethod_ID",v)),f.setValue("PaymentAmount",h),f.setValue("PayAmt",h),s.IsPrePayOrder==!0?f.getField("PaymentAmount").setReadOnly(!0):f.getField("PaymentAmount").setReadOnly(!1))}catch(y){return s!=null&&(s=null),this.log.log(r.SEVERE,sql,y),this.setCalloutActive(!1),y.message}return this.setCalloutActive(!1),this.DocType(i,u,f,e,o)};i.prototype.Charge=function(t,i,r,u,f){if(f==null||f.toString()=="")return""};i.prototype.DocType=function(i,r,u,f,e,o){var c=i.getContextAsInt(r,"C_Invoice_ID"),v=i.getContextAsInt(r,"C_Order_ID"),l=i.getContextAsInt(r,"C_DocType_ID"),y,p;this.log.fine("Payment_DocType - C_Invoice_ID="+c+", C_DocType_ID="+l);var s=l.toString(),a=n.dataContext.getJSONRecord("MDocType/GetDocType",s),h=t.getValueOfBoolean(a.IsSOTrx);return(l!=0&&(i.setWindowContext(r,"IsSOTrx",h?"Y":"N"),u.setValue("IsReceipt",h?"Y":"N")),c!=0&&(s=c.toString(),y=n.dataContext.getJSONRecord("MInvoice/GetInvoice",s),a!=null&&t.getValueOfBoolean(y.IsSOTrx)!=h))?n.Msg.getMsg("DocTypeInvInconsistent"):v!=0&&(s=v.toString(),p=n.dataContext.getJSONRecord("MOrder/GetOrder",s),a!=null&&t.getValueOfBoolean(p.IsSOTrx)!=h)?n.Msg.getMsg("DocTypeOrdInconsistent"):(i=r=u=f=e=o=null,"")};i.prototype.AmountCurrencyType=function(t,i,r,u,f){var h;if(this.isCalloutActive()||f==null||f.toString()=="")return r.setValue("OutStandingAmount",""),"";this.setCalloutActive(!0);var e="",o=r.getValue("C_BPartner_ID"),s=r.getValue("AsOnDate");if(s==""||s==null||o==""||o==null)return r.setValue("OutStandingAmount",e),this.setCalloutActive(!1),"";h="N,"+o.toString()+","+s.toString();try{e=n.dataContext.getJSONRecord("MPayment/GetOutStandingAmt",h);r.setValue("OutStandingAmount",e)}catch(c){this.setCalloutActive(!1)}return this.setCalloutActive(!1),""};i.prototype.Amounts=function(i,u,f,e,o,s){var k,it,w,ft,rt,st,g,at,vt,yt;if(this.isCalloutActive()||(k=i.getContextAsInt(u,"C_Invoice_ID"),i.getContextAsInt(u,"C_Payment_ID")==0&&i.getContextAsInt(u,"C_BPartner_ID")==0&&k==0)||(it=f.getValue("C_Currency_ID"),it==null))return"";if(k!=0){this.setCalloutActive(!0);w=e.getColumnName();ft=0;i.getContextAsInt(u,"C_Invoice_ID")==k&&f.getValue("C_InvoicePaySchedule_ID")!=null&&(ft=f.getValue("C_InvoicePaySchedule_ID"));var a=n.Env.ZERO,l=n.Env.ZERO,d=0,et=0,b="N",ot=!0;k!=0&&(rt=f.getValue("DateTrx"),rt==null&&(rt=new Date),st=k.toString()+","+ft.toString()+","+rt.toString(),g=n.dataContext.getJSONRecord("MPayment/GetInvoiceData",st),g!=null&&(d=t.getValueOfInt(g.C_Currency_ID),et=t.getValueOfInt(g.C_ConversionType_ID),a=t.getValueOfDecimal(g.invoiceOpen),a==null&&(a=n.Env.ZERO),l=t.getValueOfDecimal(g.invoiceDiscount),b=g.IsReturnTrx));this.log.fine("Open="+a+" Discount= "+l+", C_Invoice_ID="+k+", C_Currency_ID="+d);w=="PaymentAmount"&&f.setValue("PayAmt",f.getValue("PaymentAmount"));var h=t.getValueOfDecimal(f.getValue("PayAmt")==null?n.Env.ZERO:f.getValue("PayAmt")),v=t.getValueOfDecimal(f.getValue("WriteOffAmt")==null?n.Env.ZERO:f.getValue("WriteOffAmt")),c=t.getValueOfDecimal(f.getValue("OverUnderAmt")==null?n.Env.ZERO:f.getValue("OverUnderAmt")),y=t.getValueOfDecimal(f.getValue("DiscountAmt")==null?n.Env.ZERO:f.getValue("DiscountAmt"));b=="Y"?(h>0?(h=h*-1,f.setValue("PayAmt",h),f.setValue("PaymentAmount",h)):f.setValue("PaymentAmount",h),y>0&&(y=y*-1),l>0&&(l=l*-1),v>0&&(v=v*-1,f.setValue("WriteOffAmt",v)),c>0&&(c=c*-1,f.setValue("OverUnderAmt",c)),a>0&&(a=a*-1)):(h<0?(h=h*-1,f.setValue("PayAmt",h),f.setValue("PaymentAmount",h)):f.setValue("PaymentAmount",h),y<0&&(y=y*-1),l<0&&(l=l*-1),v<0&&(v=v*-1,f.setValue("WriteOffAmt",v)),c<0&&(c=c*-1,f.setValue("OverUnderAmt",c)),a<0&&(a=a*-1));this.log.fine("Pay="+h+", Discount="+y+", WriteOff="+v+", OverUnderAmt="+c);var tt=t.getValueOfInt(it),st=tt.toString(),ut=n.dataContext.getJSONRecord("MCurrency/GetCurrency",st),p=ut.StdPrecision,ct=f.getValue("DateAcct"),ht=0,lt=t.getValueOfInt(f.getValue("C_ConversionType_ID"));lt!=null&&(ht=lt);var wt=i.getContextAsInt(u,"AD_Client_ID"),bt=i.getContextAsInt(u,"AD_Org_ID"),nt=n.Env.ONE;if(tt>0&&d>0&&tt!=d||w=="C_Currency_ID"||w=="C_ConversionType_ID"){if(this.log.fine("InvCurrency="+d+", PayCurrency="+tt+", Date="+ct+", Type="+ht),at=d+","+tt+","+ct+","+ht+","+wt+","+bt,nt=n.dataContext.getJSONRecord("MConversionRate/GetRate",at),nt==null||nt.toString()==0){if(this.setCalloutActive(!1),d==0)return"";if(f.setValue("C_Currency_ID",d),w=="C_ConversionType_ID"){if(et==0)return"";f.setValue("C_ConversionType_ID",et)}return"NoCurrencyConversion"}a=t.getValueOfDecimal((a*nt).toFixed(ut.StdPrecision));y!=0&&(l=y);l=t.getValueOfDecimal((l*nt).toFixed(ut.StdPrecision));this.log.fine("Rate="+nt+", InvoiceOpenAmt="+a+", DiscountAmt="+l)}w=="C_Currency_ID"||w=="C_ConversionType_ID"?(v=0,f.setValue("WriteOffAmt",v),c=0,f.setValue("OverUnderAmt",c),y=0,f.setValue("DiscountAmt",y),l=y,h=a-l-v-c,f.setValue("PayAmt",t.getValueOfDecimal(h.toFixed(p))),f.setValue("PaymentAmount",t.getValueOfDecimal(h.toFixed(p)))):k==0?(n.Env.ZERO!=l&&f.setValue("DiscountAmt",n.Env.ZERO),n.Env.ZERO!=v&&f.setValue("WriteOffAmt",n.Env.ZERO),n.Env.ZERO!=c&&f.setValue("OverUnderAmt",n.Env.ZERO)):w=="PayAmt"||w=="PaymentAmount"?(y!=0&&(l=y),c=a-h-l-v,(b=="N"&&c>0||b=="Y"&&c<0)&&n.ADialog.info("LessScheduleAmount"),(b=="Y"&&c>0||b=="N"&&c<0)&&(n.ADialog.info("MoreScheduleAmount"),h=a-l-v,c=a-h-l-v,ot?(f.setValue("PayAmt",t.getValueOfDecimal(h.toFixed(p))),f.setValue("PaymentAmount",t.getValueOfDecimal(h.toFixed(p)))):(f.setValue("PayAmt",h),f.setValue("PaymentAmount",h))),ot?(f.setValue("DiscountAmt",t.getValueOfDecimal(l.toFixed(p))),f.setValue("OverUnderAmt",t.getValueOfDecimal(c.toFixed(p)))):(f.setValue("DiscountAmt",l),f.setValue("OverUnderAmt",c))):(l=y,h=a-l-v-c,(b=="Y"&&h>0||b=="N"&&h<0)&&(n.ADialog.info("MoreScheduleAmount"),w=="OverUnderAmt"&&(h=a-l-v,c=a-h-l-v),w=="DiscountAmt"&&(h=a-c-v,l=a-h-c-v),w=="WriteOffAmt"&&(h=a-l-c,v=a-h-l-c)),ot?(f.setValue("PayAmt",t.getValueOfDecimal(h.toFixed(p))),f.setValue("PaymentAmount",t.getValueOfDecimal(h.toFixed(p))),f.setValue("DiscountAmt",t.getValueOfDecimal(l.toFixed(p))),f.setValue("WriteOffAmt",t.getValueOfDecimal(v.toFixed(p))),f.setValue("OverUnderAmt",t.getValueOfDecimal(c.toFixed(p)))):(f.setValue("PayAmt",h),f.setValue("PaymentAmount",h),f.setValue("DiscountAmt",l),f.setValue("WriteOffAmt",v),f.setValue("OverUnderAmt",c)),(b=="N"&&c>0||b=="Y"&&c<0)&&n.ADialog.info("LessScheduleAmount"));this.setCalloutActive(!1)}else{this.setCalloutActive(!0);try{if((t.getValueOfInt(f.getValue("C_Order_ID"))>0&&t.getValueOfInt(f.getValue("VA009_OrderPaySchedule_ID"))==0||t.getValueOfInt(f.getValue("C_Order_ID"))==0&&t.getValueOfInt(f.getValue("VA009_OrderPaySchedule_ID"))==0&&t.getValueOfInt(f.getValue("C_Invoice_ID"))==0&&t.getValueOfInt(f.getValue("C_InvoicePaySchedule_ID"))==0)&&f.setValue("PayAmt",t.getValueOfDecimal(f.getValue("PaymentAmount"))),vt=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA026_"),vt.VA026_&&e.getColumnName()=="PaymentAmount"&&(yt=n.dataContext.getJSONRecord("MDocType/GetDocType",f.getValue("C_DocType_ID")),!t.getValueOfBoolean(yt.IsSOTrx))){var ut=n.dataContext.getJSONRecord("MCurrency/GetCurrency",it),p=ut.StdPrecision,kt=t.getValueOfDecimal(f.getValue("PaymentAmount"))/t.getValueOfDecimal(f.getValue("VA026_Interest")/100+1).toString();f.setValue("VA026_InterestAmt",t.getValueOfDecimal(kt.toFixed(p)));f.setValue("VA026_InterestAmount",t.getValueOfDecimal((f.getValue("PaymentAmount")-f.getValue("VA026_InterestAmt")).toFixed(p)))}this.setCalloutActive(!1)}catch(pt){return this.setCalloutActive(!1),this.log.log(r.SEVERE,sql,pt),pt}}return i=u=f=e=o=s=null,""};i.prototype.BankAccount=function(i,r,u,f,o,s){var h,c;if(o==null||o.toString()==""||(h=o,this.isCalloutActive()))return"";this.setCalloutActive(!0);try{c=t.getValueOfInt(n.dataContext.getJSONRecord("MPayment/GetBankAcctCurrency",h.toString()));u.setValue("C_Currency_ID",c);e(u)}catch(l){return this.setCalloutActive(!1),l.message}return this.setCalloutActive(!1),i=u=f=o=s=null,""};i.prototype.SetOverrideAutoCheck=function(n,t,i,r,u,f){if(u==null||u.toString()=="")return i.setValue("IsOverrideAutoCheck",!1),"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);try{e(i)}catch(o){return this.setCalloutActive(!1),o.message}return this.setCalloutActive(!1),n=i=r=u=f=null,""};i.prototype.ProvisionalInvoice=function(i,r,u,f,e,o){var s,h;if(e==null||e.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);try{s=n.dataContext.getJSONRecord("MPayment/GetProvisionalInvoiceData",t.getValueOfInt(u.getValue("C_ProvisionalInvoice_ID")));s!=null&&(u.setValue("C_BPartner_ID",s.C_BPartner_ID),u.setValue("C_BPartner_Location_ID",s.C_BPartner_Location_ID),u.setValue("PaymentAmount",s.GrandTotal),u.setValue("PayAmt",s.GrandTotal),u.setValue("C_Currency_ID",s.C_Currency_ID),u.setValue("C_ConversionType_ID",s.C_ConversionType_ID),h=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),h.VA009_)}catch(c){this.setCalloutActive(!1);this.log.severe(c.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutPayment=i;n.Utility.inheritPrototype(u,n.CalloutEngine);u.prototype.Invoice=function(i,u,f,e,o,s){var h,c,b,k,a,v,y;if(o==null||o.toString()==""||(h=t.getValueOfInt(o),this.isCalloutActive()||h==null||h==0))return"";var nt=i.getContextAsInt(u,"C_Payment_ID"),k=nt.toString(),p=null;if(p=n.dataContext.getJSONRecord("MPayment/GetPayment",k),p.C_Charge_ID!=0||p.C_Invoice_ID!=0||p.C_Order_ID!=0)return n.Msg.getMsg("PaymentIsAllocated");this.setCalloutActive(!0);f.setValue("DiscountAmt",n.Env.ZERO);f.setValue("WriteOffAmt",n.Env.ZERO);f.setValue("OverUnderAmt",n.Env.ZERO);c=0;i.getContextAsInt(u,"C_Invoice_ID")==h&&i.getContextAsInt(u,"C_InvoicePaySchedule_ID")!=0&&(c=i.getContextAsInt(u,"C_InvoicePaySchedule_ID"));var w=0,g=0,l=null;try{l=n.dataContext.getJSONRecord("MInvoice/GetInvPaySchedDetail",h);l!=null&&(c=t.getValueOfInt(l.C_InvoicePaySchedule_ID),w=t.getValueOfDecimal(l.dueAmount),IsReturnTrx=l.IsReturnTrx,"Y"==IsReturnTrx&&(w=w*-1),f.setValue("C_InvoicePaySchedule_ID",c),f.setValue("Amount",w),g=1)}catch(d){return this.setCalloutActive(!1),this.log.log(r.SEVERE,"PaymentAllocate.Invoice -"+h,d.message),d.toString()}b=t.getValueOfDate(i.getContextAsTime(u,"DateTrx"));b==null&&(b=new Date);k=h.toString()+","+c.toString()+","+b.toString();a=null;try{a=n.dataContext.getJSONRecord("MPayment/GetInvoiceData",k);a!=null&&(v=t.getValueOfDecimal(a.invoiceOpen),v==null&&(v=n.Env.ZERO),y=t.getValueOfDecimal(a.invoiceDiscount),y==null&&(y=n.Env.ZERO),f.setValue("InvoiceAmt",v),g==0&&f.setValue("Amount",v-y),f.setValue("DiscountAmt",y),i.setContext(u,"C_Invoice_ID",h.toString()))}catch(d){return this.setCalloutActive(!1),d.message}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};u.prototype.Amounts=function(i,r,u,f,e,o){var d,g,b,k,p,w,it,y;if(this.isCalloutActive()||(d=i.getContextAsInt(r,"C_Invoice_ID"),d==0))return"";this.setCalloutActive(!0);g=0;u.getValue("C_InvoicePaySchedule_ID")!=null&&(g=u.getValue("C_InvoicePaySchedule_ID"));var a=n.Env.ZERO,v="N",tt=0,nt=!0,h=t.getValueOfDecimal(u.getValue("Amount")),c=t.getValueOfDecimal(u.getValue("DiscountAmt")),l=t.getValueOfDecimal(u.getValue("WriteOffAmt")),s=t.getValueOfDecimal(u.getValue("OverUnderAmt")),rt=t.getValueOfDecimal(u.getValue("InvoiceAmt"));return this.log.fine("Amt="+h+", Discount="+c+", WriteOff="+l+", OverUnder="+s+", Invoice="+rt),b=i.getContext(r,"DateTrx"),b==null&&(b=new Date),k=d.toString()+","+g.toString()+","+b.toString(),p=n.dataContext.getJSONRecord("MPayment/GetInvoiceData",k),p!=null&&(tt=t.getValueOfInt(p.C_Currency_ID),a=t.getValueOfDecimal(p.invoiceOpen),a==null&&(a=n.Env.ZERO),n.Env.ZERO==c&&(c=t.getValueOfDecimal(p.invoiceDiscount)),v=p.IsReturnTrx),v=="Y"?(h>0&&(h=h*-1,u.setValue("Amount",h)),c>0&&(c=c*-1),l>0&&(l=l*-1,u.setValue("WriteOffAmt",l)),s>0&&(s=s*-1,u.setValue("OverUnderAmt",s)),a>0&&(a=a*-1)):(h<0&&(h=h*-1,u.setValue("Amount",h)),c<0&&(c=c*-1),l<0&&(l=l*-1,u.setValue("WriteOffAmt",l)),s<0&&(s=s*-1,u.setValue("OverUnderAmt",s)),a<0&&(a=a*-1)),w=f.getColumnName(),k=tt.toString(),it=n.dataContext.getJSONRecord("MCurrency/GetCurrency",k),y=it.StdPrecision,w=="Amount"?(s=a-h-c-l,(v=="N"&&s>0||v=="Y"&&s<0)&&n.ADialog.info("LessScheduleAmount"),(v=="Y"&&s>0||v=="N"&&s<0)&&(n.ADialog.info("MoreScheduleAmount"),h=a-c-l,s=a-h-c-l,nt?u.setValue("Amount",h.toFixed(y)):u.setValue("Amount",h)),nt?(u.setValue("DiscountAmt",c.toFixed(y)),u.setValue("OverUnderAmt",s.toFixed(y))):(u.setValue("DiscountAmt",c),u.setValue("OverUnderAmt",s))):(h=a-c-l-s,(v=="Y"&&h>0||v=="N"&&h<0)&&(n.ADialog.info("MoreScheduleAmount"),w=="OverUnderAmt"&&(h=a-c-l,s=a-h-c-l),w=="DiscountAmt"&&(h=a-s-l,c=a-h-s-l),w=="WriteOffAmt"&&(h=a-c-s,l=a-h-c-s)),nt?(u.setValue("Amount",h.toFixed(y)),u.setValue("DiscountAmt",c.toFixed(y)),u.setValue("WriteOffAmt",l.toFixed(y)),u.setValue("OverUnderAmt",s.toFixed(y))):(u.setValue("Amount",h),u.setValue("DiscountAmt",c),u.setValue("WriteOffAmt",l),u.setValue("OverUnderAmt",s)),(v=="N"&&s>0||v=="Y"&&s<0)&&n.ADialog.info("LessScheduleAmount")),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutPaymentAllocate=u;n.Utility.inheritPrototype(f,n.CalloutEngine);f.prototype.SetPaymentType=function(n,t,i,r,u){if(this.isCalloutActive()||u==null||u.toString()=="")return"";try{if(this.setCalloutActive(!0),r.getColumnName()=="PaymentRule")if(i.getValue("PaymentRule")==null)i.setValue("PaymentMethod",null);else{var f=i.getValue("PaymentRule");i.setValue("PaymentMethod",f)}}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),""};n.Model.CalloutPaymentTypeSO=f}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutPaySelection")}var r=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.PayAmt=function(n,i,r,u,f,e){var o,h,s;if(this.isCalloutActive()||f==null||f==""||(o=t.getValueOfInt(r.getValue("C_Invoice_ID")),o==null)||(h=o,h==0))return"";var c=t.getValueOfDecimal(r.getValue("OpenAmt")),l=t.getValueOfDecimal(r.getValue("PayAmt")),a=t.getValueOfDecimal(r.getValue("DiscountAmt"));return this.setCalloutActive(!0),s=c-l-a,this.log.fine(" - OpenAmt="+c+" - PayAmt="+l+", Discount="+a+", Difference="+s),r.setValue("DifferenceAmt",s),this.setCalloutActive(!1),n=i=r=u=f=e=null,""};i.prototype.Invoice=function(i,r,u,f,e,o){var h,v;if(this.isCalloutActive()||e==null||e==""||(h=t.getValueOfInt(e),h==0))return"";this.setCalloutActive(!0);var a=i.getContextAsInt(r,"C_BankAccount_ID"),y=i.getContext("PayDate"),c=n.Env.ZERO,l=n.Env.ZERO,s=null;try{v=h.toString()+", "+a.toString()+","+y.toString();s=n.dataContext.getJSONRecord("MInvoice/GetInvoiceOpenDetail",v);s!=null&&Object.keys(s).length>0&&(c=t.getValueOfDecimal(s.OpenAmt),l=t.getValueOfDecimal(s.DiscountAmt),IsSOTrx="Y"==t.getValueOfString(s.IsSOTrx))}catch(p){this.setCalloutActive(!1)}return this.log.fine(" - OpenAmt="+c+" (Invoice="+h+",BankAcct="+a+")"),u.setValue("OpenAmt",c),u.setValue("PayAmt",c-l),u.setValue("DiscountAmt",l),u.setValue("DifferenceAmt",n.Env.ZERO),u.setValue("IsSOTrx",!1),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutPaySelection=i}(VIS,jQuery),function(n){function t(){n.CalloutEngine.call(this,"VIS.CalloutCurrency")}function i(){n.CalloutEngine.call(this,"VIS.CalloutPriclistUOM")}var r=n.Logging.Level,u=n.Utility.Util;n.Utility.inheritPrototype(t,n.CalloutEngine);t.prototype.Currency=function(t,i,r,u,f,e){if(f==null||f.toString()=="")return"";try{var o=n.dataContext.getJSONRecord("MPriceList/GetPriceList",f.toString());o!=null&&r.setValue("C_Currency_ID",o.C_Currency_ID)}catch(s){this.setCalloutActive(!1)}return t=i=r=u=f=e=null,""};n.Model.CalloutCurrency=t;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.SetUOM=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);r.getField("M_AttributeSetInstance_ID")!=null&&r.setValue("M_AttributeSetInstance_ID",null);try{var o=n.dataContext.getJSONRecord("MProduct/GetC_UOM_ID",f.toString());r.setValue("C_UOM_ID",o)}catch(s){this.setCalloutActive(!1);this.log.severe(s.toString())}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};n.Model.CalloutPriclistUOM=i}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutProduct")}function r(){n.CalloutEngine.call(this,"VIS.CalloutProdCatVal")}function u(){n.CalloutEngine.call(this,"VIS.CalloutProdTypeVal")}var f=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.ProductCategory=function(i,r,u,f,e,o){var s,c,h,l;return e==null||e.toString()==""?"":(s=t.getValueOfInt(e),s==null||t.getValueOfInt(s)==0||s==0)?"":(c=t.getValueOfInt(e),h=null,h=n.dataContext.getJSONRecord("MProductCategory/GetProductCategory",c),l=h.IsPurchasedToOrder,u.setValue("IsPurchasedToOrder",l),pc=null,i=r=u=f=e=o=null,"")};i.prototype.UOM=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()==""||r.getValue("M_Product_id")==null)return"";this.setCalloutActive(!0);var o=r.getValue("M_Product_ID").toString(),s=n.dataContext.getJSONRecord("MProduct/GetTransactionCount",o);return s>0&&(n.ADialog.info("Can't change UOM due to Transactions happens based on existing UOM"),r.setValue("C_UOM_ID",e)),this.setCalloutActive(!1),t=i=r=u=f=e=null,""};i.prototype.ResourceGroup=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=t.getValueOfString(f);return o==null||o.length==0?"":("O"==o?r.setValue("BasisType",null):r.setValue("BasisType","I"),n=i=r=u=f=e=null,"")};i.prototype.Organization=function(i,r,u,f,e,o){var h,s,c;return e==null||e.toString()==""?"":(h=t.getValueOfInt(e),h==null)?"":(s=null,s=n.dataContext.getJSONRecord("MLocator/GetLocator",paramString),c=s.Default_Locator_ID,u.setValue("M_Locator_ID",c),i=r=u=f=e=o=null,"")};n.Model.CalloutProduct=i;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.SetProdCatValues=function(i,r,u,f,e,o){var s,l,a;if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{var h="SELECT IsActive ",v=t.getValueOfInt(n.DB.executeScalar("SELECT COUNT(AD_MODULEINFO_ID) FROM AD_MODULEINFO WHERE PREFIX='VA038_' ")),c=t.getValueOfInt(n.DB.executeScalar("SELECT COUNT(AD_MODULEINFO_ID) FROM AD_MODULEINFO WHERE PREFIX='DTD001_' "));c>0&&(h+=" , producttype ");c>0&&(h+=" , m_attributeset_id, c_taxcategory_id ");h+=" FROM M_Product_Category WHERE m_product_category_id="+t.getValueOfInt(e);s=n.DB.executeDataSet(h);s!=null&&s.tables[0].rows.length>0&&(t.getValueOfInt(n.DB.executeScalar("SELECT COUNT(AD_MODULEINFO_ID) FROM AD_MODULEINFO WHERE PREFIX='DTD001_' "))>0&&(s.tables[0].rows[0].cells.producttype!=null||t.getValueOfString(s.tables[0].rows[0].cells.producttype)!=""?u.setValue("PRODUCTTYPE",s.tables[0].rows[0].cells.producttype):u.setValue("PRODUCTTYPE","")),c>0&&(s.tables[0].rows[0].cells.m_attributeset_id!=null||t.getValueOfString(s.tables[0].rows[0].cells.m_attributeset_id)!=""?u.setValue("M_AttributeSet_ID",t.getValueOfInt(s.tables[0].rows[0].cells.m_attributeset_id)):u.setValue("M_AttributeSet_ID",0),s.tables[0].rows[0].cells.c_taxcategory_id!=null||t.getValueOfString(s.tables[0].rows[0].cells.c_taxcategory_id)!=""?u.setValue("C_TaxCategory_ID",t.getValueOfInt(s.tables[0].rows[0].cells.c_taxcategory_id)):u.setValue("C_TaxCategory_ID",0)));v>0&&(t.getValueOfString(s.tables[0].rows[0].cells.producttype)=="E"||t.getValueOfString(s.tables[0].rows[0].cells.producttype)=="S"?(l=t.getValueOfInt(n.DB.executeScalar("SELECT A_Asset_Group_ID FROM M_Product_Category WHERE M_Product_Category_ID="+t.getValueOfInt(e))),l>0?(a=t.getValueOfInt(n.DB.executeScalar("SELECT VA038_AmortizationTemplate_ID FROM A_Asset_Group WHERE A_Asset_Group_ID="+l)),a>0?u.setValue("VA038_AmortizationTemplate_ID",a):u.setValue("VA038_AmortizationTemplate_ID",0)):u.setValue("VA038_AmortizationTemplate_ID",0)):u.setValue("VA038_AmortizationTemplate_ID",0))}catch(y){this.setCalloutActive(!1);this.log.severe(y.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutProdCatVal=r;n.Utility.inheritPrototype(u,n.CalloutEngine);u.prototype.SetProdTypeValues=function(n,t,i,r,u,f){if(this.isCalloutActive()||u==null||u.toString()=="")return"";this.setCalloutActive(!0);try{u!="I"&&i.setValue("IsStocked",!1)}catch(e){this.setCalloutActive(!1);this.log.severe(e.toString())}return this.setCalloutActive(!1),n=t=i=r=u=f=null,""};n.Model.CalloutProdTypeVal=u}(VIS,jQuery),function(n){function t(){n.CalloutEngine.call(this,"VIS.CalloutProduction")}function i(){n.CalloutEngine.call(this,"VIS.CalloutProductionLine")}var r=n.Logging.Level,u=n.Utility.Util;n.Utility.inheritPrototype(t,n.CalloutEngine);t.prototype.Product=function(n,t,i,r,u,f){if(u==null||u.toString()=="")return"";var e=u;return e==null||e==0?"":(i.setValue("M_AttributeSetInstance_ID",null),n=t=i=r=u=f=null,"")};t.prototype.SetAttributeSetInstance=function(t,i,r,u,f,e){if(f==null||f.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);try{var o=f.toString(),s=n.dataContext.getJSONRecord("MProductionLine/GetAttributeSetInstance",o);r.setValue("M_AttributeSetInstance_ID",s)}catch(h){this.setCalloutActive(!1);this.log.severe(h.toString())}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};t.prototype.SetBOM=function(t,i,r,u,f,e){var o,s;if(f==null||f.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);try{u.getColumnName().equals("M_Product_ID")?(r.setValue("M_AttributeSetInstance_ID",0),o=f.toString().concat(",",0)):u.getColumnName().equals("M_AttributeSetInstance_ID")&&(o=r.getValue("M_Product_ID").toString().concat(",",f.toString()));s=n.dataContext.getJSONRecord("MProductionLine/GetBOM",o);r.setValue("M_BOM_ID",s)}catch(h){this.setCalloutActive(!1);this.log.severe(h.toString())}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};n.Model.CalloutProduction=t;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.SetChargeAmount=function(t,i,r,u,f,e){if(f==null||f.toString()=="")return"";this.setCalloutActive(!0);try{var s=f.toString(),o=n.dataContext.getJSONRecord("MProductionLine/GetChargeAmt",s);o!=null&&(r.setValue("Amt",o.ChargeAmt),r.setValue("M_Product_ID",null))}catch(h){this.setCalloutActive(!1);this.log.severe(h.toString())}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};n.Model.CalloutProductionLine=i}(VIS,jQuery),function(n){function r(){n.CalloutEngine.call(this,"VIS.CalloutProject")}function i(){n.CalloutEngine.call(this,"VIS.CalloutProjectLine")}function i(){n.CalloutEngine.call(this,"VIS.CalloutProjectLine")}function u(){n.CalloutEngine.call(this,"VIS.CalloutProjectCBPartner")}var f=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.Planned=function(i,r,u,f,e,o){var g,a,k,v,w;if(e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";this.setCalloutActive(!0);var y,s,c,h,b=0,p=i.getStdPrecision(),l=p,d=i.getContextAsInt(r,"M_PriceList_Version_ID");return d!=0&&(a=n.dataContext.getJSONRecord("MProject/GetPriceListPrecision",d.toString()),a!=null&&(p=t.getValueOfInt(a.StdPrecision),l=t.getValueOfInt(a.PriceListPrecision)),a=null),g=t.getValueOfInt(u.getValue("C_ProjectTask_ID")),a=n.dataContext.getJSONRecord("MProject/GetProjectDetail",g.toString()),a!=null&&(PriceLimit=t.getValueOfDecimal(a.PriceLimit)),y=t.getValueOfDecimal(u.getValue("PlannedQty")),y==null&&(y=Envs.ONE),s=t.getValueOfDecimal(u.getValue("PlannedPrice")),s=s==null?n.Env.ZERO:s.toFixed(l),c=t.getValueOfDecimal(u.getValue("PriceList")),c=c==null?s:c.toFixed(l),h=t.getValueOfDecimal(u.getValue("Discount")),h=h==null?n.Env.ZERO:h.toFixed(l),k=f.getColumnName(),k=="PlannedPrice"?(c==0?h=n.Env.ZERO:(v=(s*n.Env.ONEHUNDRED/c).toFixed(10),h=n.Env.ONEHUNDRED-v),u.setValue("Discount",h.toFixed(l)),u.setValue("PlannedPrice",s),this.log.fine("PriceList="+c+" - Discount="+h+" -> [PlannedPrice="+s+"] (Precision="+l+")")):k=="PriceList"?(n.Env.signum(c)==0?h=n.Env.ZERO:(v=s*n.Env.ONEHUNDRED/c,h=n.Env.ONEHUNDRED-v),u.setValue("Discount",h.toFixed(l)),u.setValue("PriceList",c),this.log.fine("[PriceList="+c+"] - Discount="+h+" -> PlannedPrice="+s+" (Precision="+l+")")):k=="Discount"&&(v=(h/n.Env.ONEHUNDRED).toFixed(10),v=n.Env.ONE-v,s=c*v,t.scale(s)>l&&(s=s.toFixed(l)),u.setValue("PlannedPrice",s),u.setValue("Discount",h),this.log.fine("PriceList="+c+" - [Discount="+h+"] -> PlannedPrice="+s+" (Precision="+l+")")),w=y*s,t.scale(w)>p&&(w=w.toFixed(p)),y!=null&&(b=(t.getValueOfDecimal(u.getValue("PlannedPrice"))-PriceLimit)*t.getValueOfDecimal(u.getValue("PlannedQty")),b=b.toFixed(p)),this.log.fine("PlannedQty="+y+" * PlannedPrice="+s+" -> PlannedAmt="+w+" (Precision="+p+")"),u.setValue("PlannedAmt",w),u.setValue("PlannedMarginAmt",b),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};r.prototype.Product=function(i,r,u,f,e,o){var c,l,a,h,p;if(e==null||e.toString()==""||(c=t.getValueOfInt(e),l=i.getContextAsInt(r,"M_PriceList_Version_ID"),c==null||t.getValueOfInt(c)==0||l==0))return"";this.setCalloutActive(!0);var v=i.getContextAsInt(r,"C_BPartner_ID"),y=t.getValueOfDecimal(u.getValue("PlannedQty")),s=t.getValueOfDateTime(u.getValue("PlannedDate"));return s==null?(s=t.getValueOfDateTime(u.getValue("DateContract")),s==null&&(s=t.getValueOfDateTime(u.getValue("DateFinish")),s==null&&(s=new Date)),a=c.toString().concat(",",v.toString(),",",y.toString(),",",isSOTrx,",",M_PriceList_ID.toString(),",",l.toString(),",",s.toString(),",",null),h=null,h=n.dataContext.getJSONRecord("MProductPricing/GetProductPricing",a),p=null,u.setValue("PriceList",h.PriceList),u.setValue("PlannedPrice",h.PriceActual),u.setValue("Discount",h.Discount),u.setValue("PlannedAmt",h.LineAmt),""):(i=r=u=f=e=o=null,"")};n.Model.CalloutProject=r;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Charge=function(t,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=r.getValue("C_Charge_ID").toString(),s=n.dataContext.getJSONRecord("MCharge/GetCharge",o);return r.setValue("PlannedQty",1),r.setValue("PlannedPrice",s),t=i=r=u=f=e=null,""};n.Model.CalloutProjectLine=i;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Charge=function(t,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=r.getValue("C_Charge_ID").toString(),s=n.dataContext.getJSONRecord("MCharge/GetCharge",o);return r.setValue("PlannedQty",1),r.setValue("PlannedPrice",s),t=i=r=u=f=e=null,""};n.Model.CalloutProjectLine=i;n.Utility.inheritPrototype(u,n.CalloutEngine);u.prototype.SetAddress=function(i,r,u,f,e){var o,s,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{this.setCalloutActive(!0);f.getColumnName()=="C_BPartner_ID"?(u.getField("Ref_BPartner_ID")!=null&&u.setValue("Ref_BPartner_ID",e),o=null,o=n.dataContext.getJSONRecord("MBPartner/GetBPData",t.getValueOfString(u.getValue("C_BPartner_ID"))),o!=null&&(s=n.Utility.Util.getValueOfInt(o.C_BPartner_Location_ID),s==0?u.setValue("C_BPartner_Location_ID",null):u.setValue("C_BPartner_Location_ID",s),h=n.Utility.Util.getValueOfInt(o.AD_User_ID),h==0?u.setValue("AD_User_ID",null):u.setValue("AD_User_ID",h))):f.getColumnName()=="C_BPartnerSR_ID"&&(u.getField("Ref_BPartner_ID")!=null&&u.setValue("Ref_BPartner_ID",e),o=null,o=n.dataContext.getJSONRecord("MBPartner/GetBPData",t.getValueOfString(u.getValue("C_BPartnerSR_ID"))),o!=null&&(s=n.Utility.Util.getValueOfInt(o.C_BPartner_Location_ID),s==0?u.setValue("C_BPartner_Location_ID",null):u.setValue("C_BPartner_Location_ID",s),h=n.Utility.Util.getValueOfInt(o.AD_User_ID),h==0?u.setValue("AD_User_ID",null):u.setValue("AD_User_ID",h)))}catch(c){return this.setCalloutActive(!1),c}return this.setCalloutActive(!1),""};n.Model.CalloutProjectCBPartner=u}(VIS,jQuery),function(n){function t(){n.CalloutEngine.call(this,"VIS.CalloutRequest")}function i(){n.CalloutEngine.call(this,"VIS.CalloutMRequest")}var r=n.Logging.Level,u=n.Utility.Util;n.Utility.inheritPrototype(t,n.CalloutEngine);t.prototype.CopyMail=function(t,i,u,f,e,o){var h=f.getColumnName(),s;if(this.log.info(h+"="+e),e==null||e.toString()=="")return"";try{s=n.dataContext.getJSONRecord("MRequestType/GetMailText",e.toString());s=n.Env.parseContext(t,i,s,!1,!0);u.setValue("Result",s)}catch(c){this.setCalloutActive(!1);this.log.log(r.SEVERE,sql,c)}return t=i=u=f=e=o=null,""};t.prototype.CopyResponse=function(t,i,u,f,e,o){var h=f.getColumnName(),s;if(this.log.info(h+"="+e),e==null||e.toString()=="")return"";try{s=n.dataContext.getJSONRecord("MRequestType/GetResponseText",e.toString());s=n.Env.parseContext(t,i,s,!1,!0);u.setValue("Result",s)}catch(c){this.setCalloutActive(!1);this.log.log(r.SEVERE,sql,c)}return t=i=u=f=e=o=null,""};t.prototype.Type=function(t,i,r,f,e,o){var l=f.getColumnName(),s,c,h;return(this.log.info(l+"="+e),r.setValue("R_Status_ID",null),e==null||e.toString()=="")?"":(s=u.getValueOfInt(e),s==0)?"":(c=s.toString(),h=n.dataContext.getJSONRecord("MRequestType/GetDefaultR_Status_ID",c),h!=0&&r.setValue("R_Status_ID",u.getValueOfInt(h)),t=i=r=f=e=o=null,"")};n.Model.CalloutRequest=t;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.DateRequired=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);try{var s,o;s=new Date(r.getValue("StartDate"));o=new Date(r.getValue("CloseDate"));o.toISOString()<s.toISOString()&&(r.setValue("CloseDate",""),this.setCalloutActive(!1),n.ADialog.info("CloseDateInvalid",null,"",""));this.log.fine("CloseDate="+o)}catch(h){return n.ADialog.info("error in Date"+h,null,"",""),this.setCalloutActive(!1),h}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};i.prototype.PlanDateRequired=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);try{var s,o;s=new Date(r.getValue("DateStartPlan"));o=new Date(r.getValue("DateCompletePlan"));o.toISOString()<s.toISOString()&&(r.setValue("DateCompletePlan",""),this.setCalloutActive(!1),n.ADialog.info("CmpDateInvalid",null,"",""));this.log.fine("DateCompletePlan="+o)}catch(h){return n.ADialog.info("error in Date"+h,null,"",""),this.setCalloutActive(!1),h}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};n.Model.CalloutMRequest=i}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutRequisition")}var u=n.Logging.Level,t=n.Utility.Util,r=!1;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Product=function(i,r,u,f,e,o){var h,s,v,c;try{if(this.isCalloutActive()||e==null||e.toString()==""||(h=e,h==null||h==0))return"";this.setCalloutActive(!0);u.setValue("M_AttributeSetInstance_ID",null);var y=i.getContextAsInt(r,"C_BPartner_ID"),p=u.getValue("Qty"),w=i.getContextAsInt(r,"M_PriceList_ID"),b=i.getContextAsInt(r,"M_PriceList_Version_ID"),k=i.getContext(r,"DateDoc"),l,a=n.dataContext.getJSONRecord("MProduct/GetC_UOM_ID",h);l=h.toString().concat(",",y,",",p,",",!1,",",w,",",b,",",k,",",null,",",a,",",1);s=null;s=n.dataContext.getJSONRecord("MProductPricing/GetProductPricing",l);u.setValue("PriceActual",s.PriceActual);u.setValue("PrintDescription",t.getValueOfString(s.DocumentNote));i.setContext(r,"EnforcePriceLimit",s.EnforcePriceLimit?"Y":"N");i.setContext(r,"DiscountSchema",s.DiscountSchema?"Y":"N");u.setValue("C_UOM_ID",a);v=u.getValue("M_Requisition_ID").toString()+","+i.getAD_Client_ID().toString()+","+e.toString();c=n.dataContext.getJSONRecord("MOrderLine/GetReqOrderLine",v);c>0&&u.setValue("C_OrderLine_ID",c)}catch(d){return this.setCalloutActive(!1),d.message}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.Charge=function(i,r,u,f,e,o){var s,c,h;try{if(this.isCalloutActive()||e==null||e.toString()=="")return"";if(this.setCalloutActive(!0),s=t.getValueOfInt(e),s==null||s==0)return this.setCalloutActive(!1),"";u.getValue("M_Product_ID")!=null&&u.setValue("M_Product_ID",null);u.setValue("M_AttributeSetInstance_ID",null);c=i.getContextAsInt("#C_UOM_ID");c>0?u.setValue("C_UOM_ID",c):u.setValue("C_UOM_ID",100);h=n.dataContext.getJSONRecord("MCharge/GetChargeDetails",s.toString());h!=null&&(u.setValue("PriceActual",t.getValueOfDecimal(h.ChargeAmt)),u.setValue("PrintDescription",t.getValueOfString(h.PrintDescription)))}catch(l){return this.setCalloutActive(!1),l.message}return this.setCalloutActive(!1),o=null,""};i.prototype.Amt=function(i,r,u,f,e,o){var y,a,h;if(e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";try{this.setCalloutActive(!0);var c=i.getStdPrecision(),l=c,v=i.getContextAsInt(r,"M_PriceList_ID"),s;if(v!=0&&(s=n.dataContext.getJSONRecord("MPriceList/GetPriceList",v.toString()),s!=null&&(c=t.getValueOfInt(s.StdPrecision),l=t.getValueOfInt(s.PriceListPrecision))),f.getColumnName()=="Qty"&&"Y"==i.getContext("DiscountSchema")){var p=i.getContextAsInt(r,"M_Product_ID"),w=i.getContextAsInt(r,"C_BPartner_ID"),b=e,k=i.getContextAsInt(r,"M_PriceList_Version_ID"),d=u.getValue("DateInvoiced"),g=p.concat(",",w,",",b,",",!1,",",v,",",k,",",d,",",null),s=null;s=n.dataContext.getJSONRecord("MProductPricing/GetProductPricing",g);u.setValue("PriceActual",t.getValueOfDecimal(s.PriceActual.toFixed(l)))}y=u.getValue("QtyEntered");a=u.getValue("PriceActual");this.log.fine("amt - Qty="+y+", Price="+a+", Precision="+l);h=y*a;t.scale(h)>c&&(h=h.toFixed(c));u.setValue("LineNetAmt",h);u.setValue("PriceActual",t.getValueOfDecimal(a.toFixed(l)));this.log.info("amt - LineNetAmt="+h)}catch(nt){this.setCalloutActive(!1);this.log.saveError("CalloutRequisation",nt)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.Qty=function(i,u,f,e,o,s){var p="",y,it,ut,a,w,l,rt,nt,k,d,v;if(this.isCalloutActive()||o==null||o.toString()==""||(console.log("Before Charge Or Product"),t.getValueOfInt(f.getValue("M_Product_ID"))==0&&t.getValueOfInt(f.getValue("C_Charge_ID"))==0))return"";console.log("After Charge Or Product");this.setCalloutActive(!0);try{y=i.getContextAsInt(u,"M_Product_ID");r&&this.log.Warning("init - M_Product_ID="+y+" - ");var h=n.Env.ZERO,c=n.Env.ZERO,tt,g=i.getContextAsInt(u,"M_PriceList_ID");if(y==0)h=t.getValueOfDecimal(f.getValue("QtyEntered")),c=h,f.setValue("Qty",c);else if(e.getColumnName()=="C_UOM_ID"||e.getColumnName()=="M_AttributeSetInstance_ID"){a=t.getValueOfInt(f.getValue("C_UOM_ID"));h=t.getValueOfDecimal(f.getValue("QtyEntered"));it=i.getContextAsInt(u,"C_BPartner_ID");ut=e.getColumnName()=="M_AttributeSetInstance_ID"?t.getValueOfInt(f.getValue("M_AttributeSetInstance_ID")):i.getContextAsInt(u,"M_AttributeSetInstance_ID");var ot=i.getContext(u,"DateDoc"),w=2,ft=y.toString().concat(",",f.getValue("M_Requisition_ID").toString()+","+t.getValueOfString(f.getValue("M_AttributeSetInstance_ID"))+","+t.getValueOfString(f.getValue("C_UOM_ID"))+","+i.getAD_Client_ID().toString()+","+t.getValueOfString(it)+","+h.toString()+","+g.toString()),b=n.dataContext.getJSONRecord("MProductPricing/GetPricesOnChange",ft);b!=null&&(f.setValue("PriceActual",t.getValueOfDecimal(b.PriceEntered)),w=t.getValueOfInt(b.UOMPrecision),c=b.QtyOrdered);l=h.toFixed(t.getValueOfInt(w));h!=l&&(this.log.fine("Corrected QtyEntered Scale UOM="+a+"; QtyEntered="+h+"->"+l),h=l,f.setValue("QtyEntered",h));c==null&&(c=h);f.setValue("Qty",c)}else e.getColumnName()=="QtyEntered"&&(a=i.getContextAsInt(u,"C_UOM_ID"),h=t.getValueOfDecimal(o),p=a.toString().concat(","),w=n.dataContext.getJSONRecord("MUOM/GetPrecision",p),l=h.toFixed(t.getValueOfInt(w)),h!=l&&(this.log.fine("Corrected QtyEntered Scale UOM="+a+"; QtyEntered="+h+"->"+l),h=l,f.setValue("QtyEntered",h)),p=y.toString().concat(",",a.toString(),",",h.toString()),rt=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",p),c=rt,c==null&&(c=h),nt=h!=c,this.log.fine("UOM="+a+", QtyEntered="+h+" -> "+nt+" Qty="+c),i.setContext(u,"UOMConversion",nt?"Y":"N"),f.setValue("Qty",c));tt=t.getValueOfDecimal(f.getValue("PriceActual"));k=i.getStdPrecision();g>0&&(d=n.dataContext.getJSONRecord("MPriceList/GetPriceList",g.toString()),d!=null&&(k=t.getValueOfInt(d.StdPrecision)),d=null);v=h*tt;t.scale(v)>k&&(v=v.toFixed(k));f.setValue("LineNetAmt",v);this.log.info("amt - LineNetAmt="+v)}catch(et){return this.setCalloutActive(!1),et}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};n.Model.CalloutRequisition=i}(VIS,jQuery),function(n){function t(){n.CalloutEngine.call(this,"VIS.CalloutSetAttributeCode")}var r=n.Logging.Level,i=n.Utility.Util;n.Utility.inheritPrototype(t,n.CalloutEngine);t.prototype.FillAttribute=function(t,r,u,f,e){var o,c,l,s,a,h;return this.isCalloutActive()||e==null||e.toString()==""?"":(o=t.getContext(r,"AttrCode"),this.setCalloutActive(!0),o!=null&&o!=""&&(c=n.dataContext.getJSONRecord("MProduct/GetAttributeSet",e.toString()),c>0&&(l=o.toString()+","+e.toString(),s=n.dataContext.getJSONRecord("MProduct/GetProductAttribute",l),s>0?u.setValue("M_AttributeSetInstance_ID",s):o.indexOf("(01)")>=0&&(a=o+","+i.getValueOfInt(e)+","+r,h=n.dataContext.getJSONRecord("MInOut/GetASIID",a),h!=0&&u.setValue("M_AttributeSetInstance_ID",h)))),this.setCalloutActive(!1),"")};t.prototype.FillUPC=function(t,r,u,f,e){var s=0,o;if(this.isCalloutActive()||e==null||e.toString()=="")return"";if(o=t.getContext(r,"AttrCode"),this.setCalloutActive(!0),i.getValueOfString(o)!=""){if(s=n.dataContext.getJSONRecord("MProduct/GetManufacturer",null),s>0)return this.setCalloutActive(!1),n.Msg.getMsg("Attribute Code Already Exist");u.setValue("UPC",o)}return this.setCalloutActive(!1),""};n.Model.CalloutSetAttributeCode=t}(VIS,jQuery),function(n){function r(){n.CalloutEngine.call(this,"VIS.CalloutTax")}function u(){n.CalloutEngine.call(this,"VIS.CalloutTaxAmt")}function i(){n.CalloutEngine.call(this,"VIS.CalloutTaxAmount")}var f=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.Tax=function(i,r,u,f,e,o){var c,h;if(e==null||e==0||e.toString()=="")return"";var l=0,y=n.Env.ZERO,s=n.Env.ZERO;if(l=t.getValueOfInt(u.getValue("C_Tax_ID")),u.getField("SurchargeAmt")!=null){var p=0,a=!1,v=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",u.getValue("M_PriceList_ID").toString());v!=null&&(p=v.StdPrecision,a="Y"==v.IsTaxIncluded);h=t.getValueOfDecimal(u.getValue("LineNetAmt"));c=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",l.toString()+","+h.toString()+","+p.toString()+","+a.toString());s=c.TaxAmt;u.setValue("TaxAmt",s);u.setValue("SurchargeAmt",c.SurchargeAmt);a?u.setValue("GrandTotal",h):u.setValue("GrandTotal",h+s+c.SurchargeAmt)}else y=n.dataContext.getJSONRecord("MTax/GetTaxRate",l.toString()),h=t.getValueOfDecimal(u.getValue("LineNetAmt")),s=t.getValueOfDecimal(h*y/100),s=t.getValueOfDecimal(s.toFixed(2)),u.setValue("GrandTotal",s+h),u.setValue("taxamt",s);return i=r=u=f=e=o=null,""};r.prototype.SetTaxExemptReason=function(i,r,u,e,o,s){if(o==null||o==0||o.toString()==""||this.isCalloutActive())return"";try{this.setCalloutActive(!0);var h=n.dataContext.getJSONRecord("MTax/GetTaxExempt",t.getValueOfString(u.getValue("C_Tax_ID")));h!=null&&(u.setValue("IsTaxExempt",t.getValueOfString(h.IsTaxExempt).equals("Y")?!0:!1),u.setValue("C_TaxExemptReason_ID",t.getValueOfInt(h.C_TaxExemptReason_ID)))}catch(c){return this.log.log(f.SEVERE,sql,c),this.setCalloutActive(!1),c.message}return this.setCalloutActive(!1),i=r=u=e=o=s=null,""};n.Model.CalloutTax=r;n.Utility.inheritPrototype(u,n.CalloutEngine);u.prototype.TaxID=function(i,r,u,f,e,o){var h,s;if(e==null||e.toString()==""||t.getValueOfInt(e)==0||this.isCalloutActive())return"";try{this.setCalloutActive(!0);h=n.dataContext.getJSONRecord("MTax/GetTaxRate",t.getValueOfInt(e));h!=0?(s=t.getValueOfDecimal(u.getValue("ApprovedExpenseAmt"))*h/100,s=s.toFixed(2),u.setValue("TaxAmt",s)):u.setValue("TaxAmt",n.Env.ZERO);this.setCalloutActive(!1)}catch(c){this.setCalloutActive(!1)}return i=r=u=f=e=o=null,""};u.prototype.ExpenseAmt=function(i,r,u,f,e,o){var h,s;if(e==null||e.toString()==""||t.getValueOfInt(e)==0||this.isCalloutActive())return"";try{this.setCalloutActive(!0);h=n.dataContext.getJSONRecord("MTax/GetTaxRate",t.getValueOfInt(u.getValue("C_Tax_ID")));h!=0?(s=t.getValueOfDecimal(e)*h/100,s=s.toFixed(2),u.setValue("TaxAmt",s)):u.setValue("TaxAmt",n.Env.ZERO);this.setCalloutActive(!1)}catch(c){this.setCalloutActive(!1)}return i=r=u=f=e=o=null,""};n.Model.CalloutTaxAmt=u;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.PaymentTaxAmount=function(i,r,u,f,e,o){var a,l,s,c,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{if(a=n.dataContext.getJSONRecord("MCurrency/GetCurrency",u.getValue("C_Currency_ID").toString()),l=a.StdPrecision,f.getColumnName()=="C_Tax_ID"){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",e.toString()+","+u.getValue("PayAmt").toString()+","+l.toString()),u.setValue("TaxAmount",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",e.toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("PayAmt"))-t.getValueOfDecimal(u.getValue("PayAmt"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmount",h);else return u.setValue("TaxAmount",0),this.setCalloutActive(!1),""}else if(t.getValueOfInt(u.getValue("C_Tax_ID"))>0){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",u.getValue("C_Tax_ID").toString()+","+u.getValue("PayAmt").toString()+","+l.toString()),u.setValue("TaxAmount",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",u.getValue("C_Tax_ID").toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("PayAmt"))-t.getValueOfDecimal(u.getValue("PayAmt"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmount",h);else return u.setValue("TaxAmount",0),this.setCalloutActive(!1),""}else return this.setCalloutActive(!1),""}catch(v){this.setCalloutActive(!1);this.log.severe(v.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.CashLineTaxAmount=function(i,r,u,f,e,o){var a,l,s,c,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{if(a=n.dataContext.getJSONRecord("MCurrency/GetCurrency",i.getContext(r,"C_Currency_ID").toString()),l=a.StdPrecision,f.getColumnName()=="C_Tax_ID")if(t.getValueOfDecimal(u.getValue("Amount"))!=0){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",e.toString()+","+u.getValue("Amount").toString()+","+l.toString()),u.setValue("TaxAmt",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",e.toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("Amount"))-t.getValueOfDecimal(u.getValue("Amount"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmt",h);else return u.setValue("TaxAmt",0),this.setCalloutActive(!1),""}else return this.setCalloutActive(!1),"";else if(t.getValueOfInt(u.getValue("C_Tax_ID"))>0){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",u.getValue("C_Tax_ID").toString()+","+u.getValue("Amount").toString()+","+l.toString()),u.setValue("TaxAmt",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",u.getValue("C_Tax_ID").toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("Amount"))-t.getValueOfDecimal(u.getValue("Amount"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmt",h);else return u.setValue("TaxAmt",0),this.setCalloutActive(!1),""}else return this.setCalloutActive(!1),""}catch(v){this.setCalloutActive(!1);this.log.severe(v.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.BankStatementLineTaxAmount=function(i,r,u,f,e,o){var a,v,l,s,c,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);a="";try{if(a=u.getValue("C_Currency_ID").toString(),v=n.dataContext.getJSONRecord("MCurrency/GetCurrency",a),l=v.StdPrecision,f.getColumnName()=="C_Tax_ID")if(t.getValueOfDecimal(u.getValue("ChargeAmt"))!=0){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",e.toString()+","+u.getValue("ChargeAmt").toString()+","+l.toString()),u.setValue("TaxAmt",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",e.toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("ChargeAmt"))-t.getValueOfDecimal(u.getValue("ChargeAmt"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmt",h);else return u.setValue("TaxAmt",0),this.setCalloutActive(!1),i=r=u=f=e=o=null,""}else return this.setCalloutActive(!1),i=r=u=f=e=o=null,"";else if(t.getValueOfInt(u.getValue("C_Tax_ID"))>0){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",u.getValue("C_Tax_ID").toString()+","+u.getValue("ChargeAmt").toString()+","+l.toString()),u.setValue("TaxAmt",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",u.getValue("C_Tax_ID").toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("ChargeAmt"))-t.getValueOfDecimal(u.getValue("ChargeAmt"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmt",h);else return u.setValue("TaxAmt",0),this.setCalloutActive(!1),i=r=u=f=e=o=null,""}else return this.setCalloutActive(!1),i=r=u=f=e=o=null,""}catch(y){this.setCalloutActive(!1);this.log.severe(y.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutTaxAmount=i}(VIS,jQuery),function(n){function i(){n.CalloutEngine.call(this,"VIS.CalloutTeamForcast")}var r=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.ProductInfo=function(i,r,u,f,e,o){var s,c,l,a,h;return e==null||e.toString()==""||t.getValueOfInt(e)==0?"":(s=e,s==null||s==0)?"":(s=i.getContextAsInt(r,"M_Product_ID"),s==null||s==0)?"":(c=i.getContextAsInt(r,"M_PriceList_ID"),l=i.getContextAsInt(r,"M_AttributeSetInstance_ID"),c!=0?(a=s.toString()+", "+c.toString()+","+l.toString(),h=n.dataContext.getJSONRecord("MTeamForcast/GetProductPrice",a),h!=0&&(u.setValue("PriceStd",h),u.setValue("UnitPrice",h),u.setValue("PriceStd",h*t.getValueOfDecimal(u.getValue("QtyEntered"))),u.setValue("TotalPrice",h*t.getValueOfDecimal(u.getValue("QtyEntered"))))):n.ADialog.info("PriceLisetNotFound"),i=r=u=f=e=o=null,"")};i.prototype.Charge=function(n,t,i,u,f,e){try{if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);i.getValue("M_Product_ID")!=null&&(i.setValue("M_Product_ID",null),i.setValue("M_AttributeSetInstance_ID",null));var o=n.getContextAsInt("#C_UOM_ID");o>0?i.setValue("C_UOM_ID",o):i.setValue("C_UOM_ID",100)}catch(s){return this.setCalloutActive(!1),this.log.log(r.SEVERE,sql,s),s}this.setCalloutActive(!1);e=null};i.prototype.CalculatePrice=function(i,r,u,f,e,o){if(this.isCalloutActive()||e==null||e.toString()==""||t.getValueOfInt(e)<=0)return"";this.setCalloutActive(!0);var s=n.dataContext.getJSONRecord("MCurrency/GetCurrency",t.getValueOfString(i.getContextAsInt(r,"C_Currency_ID"))),h=t.getValueOfDecimal(u.getValue("UnitPrice"))*t.getValueOfDecimal(u.getValue("BaseQty"));return u.setValue("PriceStd",h.toFixed(t.getValueOfInt(s.StdPrecision))),u.setValue("TotalPrice",h.toFixed(t.getValueOfInt(s.StdPrecision))),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.Qty=function(i,r,u,f,e,o){var h,s,c;if(this.isCalloutActive()||e==null||e.toString()==""||t.getValueOfInt(e)==0)return"";if(this.setCalloutActive(!0),h=u.getValue("C_UOM_ID"),h==null&&(h=i.getContextAsInt(r,"C_UOM_ID")),s=u.getValue("BaseQty"),c=n.dataContext.getJSONRecord("MCurrency/GetCurrency",t.getValueOfString(i.getContextAsInt(r,"C_Currency_ID"))),u.getValue("M_Product_ID")!=null){var a=u.getValue("M_Product_ID"),v=a.toString().concat(",",h.toString(),",",s.toString()),l=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",v);l!=null?u.setValue("QtyEntered",l):u.setValue("QtyEntered",s)}else u.setValue("QtyEntered",s);return t.getValueOfDecimal(u.getValue("UnitPrice"))!=0&&s!=0&&(u.setValue("PriceStd",(s*u.getValue("UnitPrice")).toFixed(t.getValueOfInt(c.StdPrecision))),u.setValue("TotalPrice",(s*u.getValue("UnitPrice")).toFixed(t.getValueOfInt(c.StdPrecision)))),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.Currency=function(i,r,u,f,e,o){if(this.isCalloutActive()||e==null||e.toString()==""||t.getValueOfInt(e)==0)return"";this.setCalloutActive(!0);var s=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",t.getValueOfString(u.getValue("M_PriceList_ID")));return s.C_Currency_ID!=null&&u.setValue("C_Currency_ID",s.C_Currency_ID),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.ProductPrice=function(i,r,u,f,e,o){var h;if(this.isCalloutActive()||e==null||e.toString()==""||t.getValueOfInt(e)==0)return u.getValue("M_Product_ID")==null&&(u.setValue("PriceStd",0),u.setValue("TotalPrice",0),u.setValue("UnitPrice",0),u.setValue("QtyEntered",1),u.setValue("BaseQty",1)),"";if(this.setCalloutActive(!0),i.getContextAsInt(r,"M_PriceList_ID")>0){var c=n.dataContext.getJSONRecord("MCurrency/GetCurrency",t.getValueOfString(i.getContextAsInt(r,"C_Currency_ID"))),l=t.getValueOfString(u.getValue("M_Product_ID")).concat(",",t.getValueOfString(u.getValue("M_AttributeSetInstance_ID")),",",t.getValueOfString(i.getContextAsInt(r,"M_PriceList_ID")),",",t.getValueOfString(u.getValue("C_UOM_ID"))),s=n.dataContext.getJSONRecord("MProductPricing/GetProductdata",l);s!=null&&(u.setValue("PriceStd",s.PriceStd),u.setValue("UnitPrice",s.PriceStd),u.setValue("PriceStd",(s.PriceStd*t.getValueOfDecimal(u.getValue("BaseQty"))).toFixed(t.getValueOfInt(c.StdPrecision))),u.setValue("TotalPrice",(s.PriceStd*t.getValueOfDecimal(u.getValue("BaseQty"))).toFixed(t.getValueOfInt(c.StdPrecision))),t.getValueOfInt(u.getValue("C_UOM_ID"))==0&&u.setValue("C_UOM_ID",s.C_UOM_ID),u.findColumn("IsBOM")>0&&u.setValue("IsBOM",s.IsBOM))}return h=n.dataContext.getJSONRecord("MTeamForcast/GetBOMdetails",t.getValueOfString(u.getValue("M_Product_ID"))),h!=null&&(u.setValue("BOMUse",h.BOMUse),u.setValue("VAMFG_M_Routing_ID",h.VAMFG_M_Routing_ID),u.setValue("M_BOM_ID",h.M_BOM_ID)),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.AccountDate=function(i,u,f,e,o,s){if(this.isCalloutActive()||o==null||o.toString()=="")return"";try{this.setCalloutActive(!0);var l=t.getValueOfString(f.getValue("AD_Client_ID")).concat(",",t.getValueOfString(f.getValue("DateAcct")),",",t.getValueOfString(f.getValue("AD_Org_ID"))),h=n.dataContext.getJSONRecord("MPeriod/GetPeriod",l);h!=null&&f.setValue("C_Period_ID",h)}catch(c){return this.log.log(r.SEVERE,sql,c),c.message}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};i.prototype.SuperVisor=function(i,u,f,e,o,s){if(this.isCalloutActive()||o==null||o.toString()==""||t.getValueOfInt(o)==0)return"";try{this.setCalloutActive(!0);var h=n.dataContext.getJSONRecord("MTeamForcast/GetSuperVisor",t.getValueOfString(o));h!=null&&f.setValue("Supervisor_ID",h)}catch(c){return this.log.log(r.SEVERE,sql,c),c.message}return this.setCalloutActive(!1),i=u=f=e=o=s=null,""};n.Model.CalloutTeamForcast=i}(VIS,jQuery),function(n){function r(){n.CalloutEngine.call(this,"VIS.CalloutUserTimeRec")}function i(){n.CalloutEngine.call(this,"VIS.CalloutTimeExpense")}var u=n.Logging.Level,t=n.Utility.Util;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.IsInternal=function(i,r,u,f,e,o){if(e==null||e.toString()==""||this.isCalloutActive())return"";try{this.setCalloutActive(!0);var h="select ProfileType from S_Resource where AD_User_ID = "+t.getValueOfInt(e),s=t.getValueOfString(n.DB.executeScalar(h,null,null));s!=""&&(s.toUpper()=="I"?u.setValue("IsInternal",!0):s.toUpper()=="E"&&u.setValue("IsInternal",!1));this.setCalloutActive(!1)}catch(c){this.setCalloutActive(!1)}return i=r=u=f=e=o=null,""};n.Model.CalloutUserTimeRec=r;n.Utility.inheritPrototype(i,n.CalloutEngine);i.prototype.Product=function(i,r,f,o,s,h){var c=s,w,v;if(c==null||t.getValueOfInt(c)==0)return"";this.setCalloutActive(!0);var l=null,g=i.getContext(r,"DateExpense"),p=null,a=null;try{w=!0;v=n.dataContext.getJSONRecord("MProduct/GetProduct",c.toString());f.setValue("C_UOM_ID",t.getValueOfInt(v.C_UOM_ID));uom=f.getValue("C_UOM_ID");var b=paramStr=c.toString().concat(",").concat(f.getValue("S_TimeExpense_ID").toString()).concat(",").concat(f.getValue("C_UOM_ID").toString().concat(",").concat(f.getValue("DateExpense").toString())),y=n.dataContext.getJSONRecord("MExpenseReport/GetstandardPrice",b),l=y.PriceActual,k=y.C_Currency_ID;f.setValue("ExpenseAmt",l);f.setValue("C_Currency_ID",k);f.setValue("ConvertedAmt",l)}catch(d){return a!=null&&a.close(),this.log.log(u.SEVERE,p,d),this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),i=r=f=o=s=h=null,""};i.prototype.Amount=function(i,r,u,f,e,o){var a,s;if(this.isCalloutActive())return"";this.setCalloutActive(!0);var l=u.getValue("ExpenseAmt"),h=0,c=u.getValue("C_Currency_ID");if(h=n.dataContext.getJSONRecord("MExpenseReport/GetPriceListCurrency",u.getValue("S_TimeExpense_ID")),a=i.getContext(r,"DateExpense"),this.log.fine("Amt="+l+", C_Currency_ID="+c),s=l.toString(),!s.equals(n.Env.ZERO)&&h!=t.getValueOfInt(c)){var v=i.getContextAsInt(r,"AD_Client_ID"),y=i.getContextAsInt(r,"AD_Org_ID"),p=s.toString()+","+c.toString()+","+h.toString()+","+a+",0,"+v.toString()+","+y.toString();s=n.dataContext.getJSONRecord("MConversionRate/CurrencyConvert",p)}return u.setValue("ConvertedAmt",s),this.log.fine("= ConvertedAmt="+s),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};i.prototype.SetPrice=function(i,r,u,f,e){var o,l,s,h,c;if(e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";this.setCalloutActive(!0);try{if(o="",l=i.getContextAsInt(r,"M_Product_ID"),o=l.toString().concat(",").concat(u.getValue("S_TimeExpense_ID").toString()).concat(",").concat(t.getValueOfString(u.getValue("C_UOM_ID"))),s=n.dataContext.getJSONRecord("MExpenseReport/GetPrices",o),s!=null&&(h=s.PriceStd,u.setValue("ExpenseAmt",h),u.setValue("ConvertedAmt",h)),u.getValue("C_Charge_ID")>0){c=i.getContextAsInt("#C_UOM_ID");c>0?u.setValue("C_UOM_ID",c):u.setValue("C_UOM_ID",100);var v=n.Utility.Util.getValueOfInt(u.getValue("C_Charge_ID")),y=v.toString(),a=n.dataContext.getJSONRecord("MExpenseReport/GetChargeAmount",y);u.setValue("ExpenseAmt",a);u.setValue("ConvertedAmt",a)}this.setCalloutActive(!1);return}catch(p){this.setCalloutActive(!1);this.log.severe(p.toString())}return this.setCalloutActive(!1),""};n.Model.CalloutTimeExpense=i}(VIS,jQuery)
