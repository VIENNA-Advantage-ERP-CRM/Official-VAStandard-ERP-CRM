/*version 1.0.0.8*/(function(n,t){function i(i){var o,s,h,u,f;this.onClose=null;this.dGrid=null;o="SelectDeselectAll";s=!0;this.arrListColumns=[];this.log=n.Logging.VLogger.getVLogger("VCreateFrom");this.divPaging=null;this.ulPaging=null;this.liFirstPage=null;this.liPrevPage=null;this.liCurrPage=null;this.liNextPage=null;this.liLastPage=null;this.cmbPage=null;h=[];this.multiValues=[];this.editedItems=[];this.NonEditableRecord=[];var r=this,e=n.Application.contextUrl,c=e+"JsonData/JDataSet",l=e+"JsonData/ExecuteNonQuer";this.$root=t("<div style='position:relative'>");this.log=n.Logging.VLogger.getVLogger("VCreateFrom");this.$busyDiv=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');this.topDiv=t("<div class='vis-locatormainwrap vis-formouterwrpdiv'>");this.middelDiv=t("<div class='vis-crtfrm-datawrp'>");this.bottomDiv=t("<div class='vis-ctrfrm-btnwrp'>");this.divPaging=t("<div>");this.record_ID=0;this.windowNo=i.getWindowNo();this.mTab=i;this.initOK=!1;this.isApplied=!1;u="btnOk_"+this.windowNo;this.Okbtn=t("<input id='"+u+"' class='VIS_Pref_btn-2' type='button' value='"+n.Msg.getMsg("OK")+"'>");u="btnCancel_"+this.windowNo;this.cancelbtn=t("<input id='"+u+"' class='VIS_Pref_btn-2' type='button' value='"+n.Msg.getMsg("Cancel")+"'>");u="btnDelete_"+this.windowNo;f=n.Application.contextUrl+"Areas/VIS/Images/base/uncheck-icon.png";this.selectAllButton=t("<button type='button' id='"+u+"' style='margin-bottom:0px;margin-top:0px;display: none;float: left;padding: 0px;border: 0px;' value='Ok' role='button' aria-disabled='false'><img src='"+f+"'><\/button>");u="btnRefresh_"+this.windowNo;f=n.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png";this.btnRefresh=t("<button id='"+u+"' style='margin-bottom: 1px; margin-top: 0px;display: none; float: left; margin-left: 0px;height: 38px; ' class='VIS_Pref_btn-2'><img src='"+f+"'><\/button>");u="btnApply_"+this.windowNo;this.Applybtn=t("<input id='"+u+"' class='VIS_Pref_btn-2' style='display: none;' type='button' value='"+n.Msg.getMsg("Apply")+"'>");this.lblBankAccount=new n.Controls.VLabel;this.lblBPartner=new n.Controls.VLabel;this.lblOrder=new n.Controls.VLabel;this.lblInvoice=new n.Controls.VLabel;this.lblShipment=new n.Controls.VLabel;this.lblLocator=new n.Controls.VLabel;this.lblDeliveryDate=new n.Controls.VLabel;this.lblProduct=new n.Controls.VLabel;this.lblDocumentNoRef=new n.Controls.VLabel;this.lblDocumentNo=new n.Controls.VLabel;this.lblDate=new n.Controls.VLabel;this.lblAmount=new n.Controls.VLabel;this.lblDepositSlip=new n.Controls.VLabel;this.lblAuthCode=new n.Controls.VLabel;this.lblCheckNo=new n.Controls.VLabel;this.lblContainer=null;f=n.Application.contextUrl+"Areas/VIS/Images/pallet-icon.png";this.ContainerTree=t("<button class='input-group-text VIS_Tree-Container-disabled'><i id='ContainerTree_"+this.windowNo+"' class='fa fa-cubes'><\/i><\/button>");this.lblProvisionalInvoice=new n.Controls.VLabel;this.cmbProvisionalInvoice=new n.Controls.VComboBox("",!1,!1,!0);this.DocumentNo=null;this.Date=null;this.Amount=null;this.DepositSlip=null;this.AuthCode=null;this.CheckNo=null;this.fromInvoice=!1;this.ProvisionalInvoice=!1;this.deliveryDate=null;this.cmbOrder=new n.Controls.VComboBox("",!1,!1,!0);this.cmbInvoice=new n.Controls.VComboBox("",!1,!1,!0);this.cmbShipment=new n.Controls.VComboBox("",!1,!1,!0);this.cmbContainer=null;this.DocumentNoRef=null;this.vProduct=null;this.cmbBankAccount=null;this.vBPartner=null;this.locatorField=null;this.child=null;this.relatedToOrg=new n.Controls.VCheckBox("Related To My Organization",!1,!1,!0,"Related To My Organization",null);this.pattrLookup=new n.MPAttributeLookup(n.context,r.windowNo);this.$productAttribute=new n.Controls.VPAttribute("M_AttributeSetInstance_ID",!1,!1,!0,n.DisplayType.PAttribute,r.pattrLookup,r.windowNo,!1,!1,!1,!0);this.title="";this.vetoablechange=function(t){var f,u,e,s,o,i,h;if(t.propertyName=="M_Product_ID"){r.isApplied=!1;r.setBusy(!0);r.multiValues=[];r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null);var u=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),o=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),f=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),i=r.vProduct.getValue(),e=r.deliveryDate.getValue();u>0?r.locatorField!=null?r.loadOrders(u,i,e,!1,1):r.loadOrders(u,i,e,!0,1):o>0?n.VCreateFromShipment.prototype.loadInvoices(o,i,1):f>0?r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(f,i,1):n.VCreateFromInvoice.prototype.loadShipments(f,i,1):s>0?n.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,i,1):r.setBusy(!1)}else if(t.propertyName=="C_BPartner_ID"){r.setBusy(!0);r.multiValues=[];r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null);var c=r.cmbBankAccount.getControl().find("option:selected").val(),l=r.Date.getValue(),a=r.vBPartner.getValue(),v=r.DepositSlip.getValue(),y=r.DocumentNo.getValue(),p=r.AuthCode.getValue(),w=r.CheckNo.getValue(),b=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(c,a,l,y,v,p,w,b,1)}else t.propertyName=="M_InOut_ID"?(r.setBusy(!0),r.editedItems=[],r.multiValues=[],r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null),f=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),i=r.vProduct.getValue(),r.cmbOrder.setValue(-1),r.cmbInvoice.setValue(-1),r.cmbProvisionalInvoice.setValue(-1),r.lblDeliveryDate.setVisible(!1),r.deliveryDate.setVisible(!1),r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(f,i,1):n.VCreateFromInvoice.prototype.loadShipments(f,i,1)):t.propertyName=="C_Order_ID"?(r.isApplied=!1,r.setBusy(!0),r.editedItems=[],r.multiValues=[],r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null),u=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),r.cmbInvoice.setValue(-1),r.cmbShipment.setValue(-1),r.cmbProvisionalInvoice.setValue(-1),r.lblDeliveryDate.setVisible(!0),r.deliveryDate.setVisible(!0),i=r.vProduct.getValue(),e=r.deliveryDate.getValue(),r.locatorField!=null?r.loadOrders(u,i,e,!1,1):r.loadOrders(u,i,e,!0,1)):t.propertyName=="C_ProvisionalInvoice_ID"?(r.isApplied=!1,r.setBusy(!0),r.editedItems=[],r.multiValues=[],r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null),s=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),i=r.vProduct.getValue(),r.cmbOrder.setValue(-1),r.cmbShipment.setValue(-1),r.cmbInvoice.setValue(-1),r.lblDeliveryDate.setVisible(!1),r.deliveryDate.setVisible(!1),n.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,i,1)):t.propertyName=="C_Invoice_ID"?(r.isApplied=!1,r.setBusy(!0),r.editedItems=[],r.multiValues=[],r.dGrid!=null&&(r.dGrid.destroy(),r.dGrid=null),o=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),i=r.vProduct.getValue(),r.cmbOrder.setValue(-1),r.cmbShipment.setValue(-1),r.cmbProvisionalInvoice.setValue(-1),r.lblDeliveryDate.setVisible(!1),r.deliveryDate.setVisible(!1),n.VCreateFromShipment.prototype.loadInvoices(o,i,1)):t.propertyName=="M_Locator_ID"?r.locatorField!=null&&(r.isApplied=!1,h=parseInt(r.locatorField.getValue()),h>0&&n.VCreateFromShipment.prototype.initContainerDetails(h)):this.locatorField.setBackground("")};this.createPageSettings=function(){this.ulPaging=t('<ul class="vis-statusbar-ul">');this.liFirstPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="First Page" style="opacity: 0.6;"><\/i><\/div><\/li>');this.liPrevPage=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="Page Up" style="opacity: 0.6;"><\/i><\/div><\/li>');this.cmbPage=t("<select>");this.liCurrPage=t("<li>").append(this.cmbPage);this.liNextPage=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="Page Down" style="opacity: 0.6;"><\/i><\/div><\/li>');this.liLastPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="Last Page" style="opacity: 0.6;"><\/i><\/div><\/li>');this.ulPaging.append(this.liFirstPage).append(this.liPrevPage).append(this.liCurrPage).append(this.liNextPage).append(this.liLastPage);this.pageEvents()};this.pageEvents=function(){this.liFirstPage.on("click",function(){var i,u;if(t(this).css("opacity")=="1"){r.setBusy(!0);var f=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),h=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),o=null;if(r.cmbBankAccount!=null&&(o=r.cmbBankAccount.getControl().find("option:selected").val()),i=null,u=null,r.vProduct!=null&&(i=r.vProduct.getValue()),r.deliveryDate!=null&&(u=r.deliveryDate.getValue()),f>0)r.locatorField!=null?r.loadOrders(f,i,u,!1,1):r.loadOrders(f,i,u,!0,1);else if(s>0)n.VCreateFromShipment.prototype.loadInvoices(s,i,1);else if(e>0)r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(e,i,1):n.VCreateFromInvoice.prototype.loadShipments(e,i,1);else if(o!=null){var c=r.Date.getValue(),l=r.vBPartner.getValue(),a=r.DepositSlip.getValue(),v=r.DocumentNo.getValue(),y=r.AuthCode.getValue(),p=r.CheckNo.getValue(),w=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(o,l,c,v,a,y,p,w,1)}else h>0&&n.VCreateFromInvoice.prototype.loadProvisionalInvoices(h,i,1)}});this.liPrevPage.on("click",function(){var i,u;if(t(this).css("opacity")=="1"){r.setBusy(!0);var f=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),h=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),o=null;if(r.cmbBankAccount!=null&&(o=r.cmbBankAccount.getControl().find("option:selected").val()),i=null,u=null,r.vProduct!=null&&(i=r.vProduct.getValue()),r.deliveryDate!=null&&(u=r.deliveryDate.getValue()),f>0)r.locatorField!=null?r.loadOrders(f,i,u,!1,parseInt(r.cmbPage.val())-1):r.loadOrders(f,i,u,!0,parseInt(r.cmbPage.val())-1);else if(s>0)n.VCreateFromShipment.prototype.loadInvoices(s,i,parseInt(r.cmbPage.val())-1);else if(e>0)r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.val())-1):n.VCreateFromInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.val())-1);else if(o!=null){var c=r.Date.getValue(),l=r.vBPartner.getValue(),a=r.DepositSlip.getValue(),v=r.DocumentNo.getValue(),y=r.AuthCode.getValue(),p=r.CheckNo.getValue(),w=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(o,l,c,v,a,y,p,w,parseInt(r.cmbPage.val())-1)}else h>0&&n.VCreateFromInvoice.prototype.loadProvisionalInvoices(h,i,parseInt(r.cmbPage.val())-1)}});this.liNextPage.on("click",function(){var i,u;if(t(this).css("opacity")=="1"){r.setBusy(!0);var f=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),h=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),o=null;if(r.cmbBankAccount!=null&&(o=r.cmbBankAccount.getControl().find("option:selected").val()),i=null,u=null,r.vProduct!=null&&(i=r.vProduct.getValue()),r.deliveryDate!=null&&(u=r.deliveryDate.getValue()),f>0)r.locatorField!=null?r.loadOrders(f,i,u,!1,parseInt(r.cmbPage.val())+1):r.loadOrders(f,i,u,!0,parseInt(r.cmbPage.val())+1);else if(s>0)n.VCreateFromShipment.prototype.loadInvoices(s,i,parseInt(r.cmbPage.val())+1);else if(e>0)r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.val())+1):n.VCreateFromInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.val())+1);else if(o!=null){var c=r.Date.getValue(),l=r.vBPartner.getValue(),a=r.DepositSlip.getValue(),v=r.DocumentNo.getValue(),y=r.AuthCode.getValue(),p=r.CheckNo.getValue(),w=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(o,l,c,v,a,y,p,w,parseInt(r.cmbPage.val())+1)}else h>0&&n.VCreateFromInvoice.prototype.loadProvisionalInvoices(h,i,parseInt(r.cmbPage.val())+1)}});this.liLastPage.on("click",function(){var i,u;if(t(this).css("opacity")=="1"){r.setBusy(!0);var f=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),h=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),o=null;if(r.cmbBankAccount!=null&&(o=r.cmbBankAccount.getControl().find("option:selected").val()),i=null,u=null,r.vProduct!=null&&(i=r.vProduct.getValue()),r.deliveryDate!=null&&(u=r.deliveryDate.getValue()),f>0)r.locatorField!=null?r.loadOrders(f,i,u,!1,parseInt(r.cmbPage.find("Option:last").val())):r.loadOrders(f,i,u,!0,parseInt(r.cmbPage.find("Option:last").val()));else if(s>0)n.VCreateFromShipment.prototype.loadInvoices(s,i,parseInt(r.cmbPage.find("Option:last").val()));else if(e>0)r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.find("Option:last").val())):n.VCreateFromInvoice.prototype.loadShipments(e,i,parseInt(r.cmbPage.find("Option:last").val()));else if(o!=null){var c=r.Date.getValue(),l=r.vBPartner.getValue(),a=r.DepositSlip.getValue(),v=r.DocumentNo.getValue(),y=r.AuthCode.getValue(),p=r.CheckNo.getValue(),w=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(o,l,c,v,a,y,p,w,parseInt(r.cmbPage.find("Option:last").val()))}else h>0&&n.VCreateFromInvoice.prototype.loadProvisionalInvoices(h,i,parseInt(r.cmbPage.find("Option:last").val()))}});this.cmbPage.on("change",function(){var t,i;r.setBusy(!0);var u=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),o=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),f=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbProvisionalInvoice.getValue()),e=null;if(r.cmbBankAccount!=null&&(e=r.cmbBankAccount.getControl().find("option:selected").val()),t=null,i=null,r.vProduct!=null&&(t=r.vProduct.getValue()),r.deliveryDate!=null&&(i=r.deliveryDate.getValue()),u>0)r.locatorField!=null?r.loadOrders(u,t,i,!1,r.cmbPage.val()):r.loadOrders(u,t,i,!0,r.cmbPage.val());else if(o>0)n.VCreateFromShipment.prototype.loadInvoices(o,t,r.cmbPage.val());else if(f>0)r.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.loadShipments(f,t,r.cmbPage.val()):n.VCreateFromInvoice.prototype.loadShipments(f,t,r.cmbPage.val());else if(e!=null){var h=r.Date.getValue(),c=r.vBPartner.getValue(),l=r.DepositSlip.getValue(),a=r.DocumentNo.getValue(),v=r.AuthCode.getValue(),y=r.CheckNo.getValue(),p=r.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(e,c,h,a,l,v,y,p,r.cmbPage.val())}else s>0&&n.VCreateFromInvoice.prototype.loadProvisionalInvoices(s,t,r.cmbPage.val())})};this.resetPageCtrls=function(n){if(this.cmbPage.empty(),n.TotalPage>0){for(var i=0;i<n.TotalPage;i++)this.cmbPage.append(t("<option value="+(i+1)+">"+(i+1)+"<\/option>"));this.cmbPage.val(n.CurrentPage);n.TotalPage>n.CurrentPage?(this.liNextPage.css("opacity","1"),this.liLastPage.css("opacity","1")):(this.liNextPage.css("opacity","0.6"),this.liLastPage.css("opacity","0.6"));n.CurrentPage>1?(this.liFirstPage.css("opacity","1"),this.liPrevPage.css("opacity","1")):(this.liFirstPage.css("opacity","0.6"),this.liPrevPage.css("opacity","0.6"));n.TotalPage==1&&(this.liFirstPage.css("opacity","0.6"),this.liPrevPage.css("opacity","0.6"),this.liNextPage.css("opacity","0.6"),this.liLastPage.css("opacity","0.6"))}else this.liFirstPage.css("opacity","0.6"),this.liPrevPage.css("opacity","0.6"),this.liNextPage.css("opacity","0.6"),this.liLastPage.css("opacity","0.6")};this.setBusy=function(n){this.$busyDiv.css("display",n?"block":"none")};this.MergeItemsForSave=function(){var e=n.Utility.Util.getValueOfInt(r.cmbOrder.getValue()),o=n.Utility.Util.getValueOfInt(r.cmbInvoice.getValue()),s=n.Utility.Util.getValueOfInt(r.cmbShipment.getValue()),i,u,f;if(r.editedItems.length>0)for(i in r.editedItems)u=r.editedItems[i].M_Product_ID_K,f=t.grep(r.multiValues,function(n){return e>0?n.M_Product_ID_K==u&&n.C_Order_ID_K==r.editedItems[i].C_Order_ID_K:o>0?n.M_Product_ID_K==u&&n.C_Invoice_ID_K==r.editedItems[i].C_Invoice_ID_K:s>0?n.M_Product_ID_K==u&&n.M_InOut_ID_K==r.editedItems[i].M_InOut_ID_K:n.C_Payment_ID_K==r.editedItems[i].C_Payment_ID_K}),f.length>0||r.multiValues.push(r.editedItems[i])};this.showDialog=function(){this.locatorField&&(this.locatorField.setBackground(!1),this.locatorField.addVetoableChangeListener(this));this.vProduct&&this.vProduct.addVetoableChangeListener(this);this.vBPartner&&this.vBPartner.addVetoableChangeListener(this);this.cmbShipment&&this.cmbShipment.addVetoableChangeListener(this);this.cmbOrder&&this.cmbOrder.addVetoableChangeListener(this);this.cmbProvisionalInvoice&&this.cmbProvisionalInvoice.addVetoableChangeListener(this);this.cmbInvoice&&this.cmbInvoice.addVetoableChangeListener(this);var n=this;this.$root.append(this.$busyDiv);this.setBusy(!1);this.$root.dialog({modal:!0,title:this.title,width:900,height:600,resizable:!1,position:{at:"center top",of:window},close:function(){n.dispose();n.dGrid!=null&&n.dGrid.destroy();r=null;n.$root.dialog("destroy");n.$root=null}})};this.checkcommaordot=function(t,i){var f=!1,u,r;if(t.value_new=n.Utility.Util.getValueOfString(i),t.value_new.contains(".")){for(f=!0,u=[],r=0;r<t.value_new.length;r++)t.value_new[r]==="."&&u.push(r);u.length>1&&(t.value_new=removeAllButLast(t.value_new,"."))}if(t.value_new.contains(","))if(f)t.value_new=removeAllButLast(t.value_new,",");else{for(u=[],r=0;r<t.value_new.length;r++)t.value_new[r]===","&&u.push(r);t.value_new=u.length>1?removeAllButLast(t.value_new,","):t.value_new.replace(",",".")}return t.value_new==""&&(t.value_new="0"),t.value_new};this.removeAllButLast=function(n,t){var i=n.split(t);return n=i.slice(0,-1).join("")+"."+i.slice(-1),n.indexOf(".")==n.length-1&&(n=n.replace(".","")),n};this.disposeComponent=function(){r=null;this.Okbtn&&this.Okbtn.off("click");this.cancelbtn&&this.cancelbtn.off("click");this.selectAllButton&&this.selectAllButton.off("click");this.btnRefresh&&this.btnRefresh.off("click");this.Applybtn&&this.Applybtn.off("click");this.disposeComponent=null}}i.prototype.dispose=function(){this.disposeComponent()};i.prototype.create=function(t){var r=n.Env.getCtx().getContextAsInt(t.getWindowNo(),"BaseTable_ID"),i=null;if(r==392)i=new n.VCreateFromStatement(t);else if(r==318)i=new n.VCreateFromInvoice(t);else if(r==319)i=new n.VCreateFromShipment(t);else{if(r==426)return null;if(t.keyColumnName=="C_ProvisionalInvoice_ID")i=new n.VCreateFormProvisionalInvoice(t);else return null}return i};i.prototype.initBPDetails=function(n){return n};i.prototype.initBPartner=function(t){var r=n.MLookupFactory.getMLookUp(n.Env.getCtx(),this.windowNo,3499,n.DisplayType.Search),i;return this.vBPartner=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,r),i=n.Env.getCtx().getContextAsInt(this.windowNo,"C_BPartner_ID"),this.vBPartner.setValue(i),this.initBPartnerOIS(i,t)};i.prototype.initBPartnerOIS=function(i,r){var o=this.cmbOrder,u,f,e;return t(o).html(""),u=!1,r?(f=n.dataContext.getJSONRecord("MDocType/GetDocType",n.Env.getCtx().getContextAsInt(this.windowNo,"C_DocTypeTarget_ID").toString()),u=n.Utility.Util.getValueOfBoolean(f.IsReturnTrx),e="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx")),u||e||this.getProvisionlInvoices(n.Env.getCtx(),i,u)):u="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsReturnTrx")),this.getOrders(n.Env.getCtx(),i,u,r),this.initBPDetails(i)};i.prototype.initBPartnerForProvisional=function(){var f=n.MLookupFactory.getMLookUp(n.Env.getCtx(),this.windowNo,3499,n.DisplayType.Search),i,r,u;return this.vBPartner=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,f),i=n.Env.getCtx().getContextAsInt(this.windowNo,"C_BPartner_ID"),this.vBPartner.setValue(i),r=this.cmbOrder,t(r).html(""),u="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsReturnTrx")),this.getOrdersForProvisional(n.Env.getCtx(),i,u),this.initBPDetails(i)};i.prototype.getOrders=function(t,i,r,u){var o="m.M_InOutLine_ID",l;u&&(o="m.C_InvoiceLine_ID");var s=n.Env.getCtx().getContextAsInt(this.windowNo,"AD_Org_ID"),a="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsDropShip")),h="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx")),c=n.context.getWindowContextAsInt(this.windowNo,"C_Invoice_ID",!0),e="",f=" C_Order.IsSOTrx ='"+(h?"Y":"N")+"' AND C_Order.IsBlanketTrx='N' AND C_Order.ISSALESQUOTATION='N' AND C_Order.DocStatus IN ('CL', 'CO')";s>0&&(f+=" AND C_Order.AD_Org_ID = "+s);i>0&&(f+=u?" AND (C_Order.C_BPartner_ID = "+i+" OR C_Order.Bill_BPartner_ID = "+i+")":"AND C_Order.C_BPartner_ID = "+i);c>0&&(e=n.dataContext.getJSONData("VCreateFrom/GetConversionWhere",{columns:o,forInvoices:u,recordID:c,Table:"C_Order"},null));e!=null&&e!=""&&(f+=e);u&&!h&&(f+=" AND C_Order.C_Order_ID NOT IN(SELECT DISTINCT OL.C_Order_ID FROM C_ProvisionalInvoice PI INNER JOIN C_ProvisionalInvoiceLine IL ON IL.C_ProvisionalInvoice_ID = PI.C_ProvisionalInvoice_ID INNER JOIN C_OrderLine OL ON OL.C_OrderLine_ID = IL.C_OrderLine_ID AND OL.C_Order_ID = C_Order.C_Order_ID WHERE  PI.IsActive = 'Y' AND pi.DocStatus  NOT IN('VO', 'RE'))");f+="AND C_Order.IsReturnTrx='"+(r?"Y":"N")+"' AND C_Order.IsDropShip='"+(a?"Y":"N")+"'  AND C_Order.C_Order_ID IN (SELECT C_Order_ID FROM (SELECT ol.C_Order_ID,ol.C_OrderLine_ID,ol.QtyOrdered, (SELECT SUM(m.qty) FROM m_matchPO m WHERE ol.C_OrderLine_ID = m.C_OrderLine_ID AND NVL("+o+", 0) != 0 AND m.ISACTIVE = 'Y') AS Qty, (SELECT SUM(IL.QtyInvoiced)  FROM C_INVOICELINE IL INNER JOIN C_Invoice I ON I.C_INVOICE_ID = IL.C_INVOICE_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyInvoiced, (SELECT SUM(IL.QtyInvoiced)  FROM C_ProvisionalInvoiceLine IL INNER JOIN C_ProvisionalInvoice I ON I.C_ProvisionalInvoice_ID = IL.C_ProvisionalInvoice_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyProvisional FROM C_OrderLine ol ";u||n.Utility.Util.getValueOfString(n.Env.getCtx().getContext("$AllowNonItem"))!="N"||(f+=" INNER JOIN M_Product p ON ol.M_Product_ID = p.M_Product_ID AND p.ProductType = 'I'");f+=") t GROUP BY C_Order_ID,C_OrderLine_ID,QtyOrdered  HAVING QtyOrdered > SUM(nvl(Qty,0)) AND QtyOrdered > SUM(NVL(QtyInvoiced,0)))";l=n.MLookupFactory.get(n.Env.getCtx(),this.windowNo,0,n.DisplayType.Search,"C_Order_ID",0,!1,f);this.cmbOrder=new n.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,n.DisplayType.Search,l)};i.prototype.getProvisionlInvoices=function(t,i,r){var s=n.Env.getCtx().getContextAsInt(this.windowNo,"AD_Org_ID"),e=n.context.getWindowContextAsInt(this.windowNo,"C_Invoice_ID",!0),u="",f=" C_ProvisionalInvoice.C_ProvisionalInvoice_ID IN (SELECT DISTINCT i.C_ProvisionalInvoice_ID FROM C_ProvisionalInvoice i INNER JOIN C_DocType d ON (i.C_DocType_ID = d.C_DocType_ID) INNER JOIN C_ProvisionalInvoiceLine pil ON i.C_ProvisionalInvoice_ID = pil.C_ProvisionalInvoice_ID WHERE i.C_BPartner_ID = "+i+" AND i.IsSOTrx = 'N' AND d.IsReturnTrx = '"+(r?"Y":"N")+"' AND i.DocStatus IN('CL', 'CO') AND NVL(pil.C_ProvisionalInvoiceLine_ID, 0) NOT IN (SELECT NVL(C_ProvisionalInvoiceLine_ID, 0) FROM (SELECT NVL(il.C_ProvisionalInvoiceLine_ID, 0) AS C_ProvisionalInvoiceLine_ID FROM C_InvoiceLine il INNER JOIN C_Invoice inv ON inv.C_Invoice_ID = il.C_Invoice_ID WHERE inv.IsActive = 'Y' AND inv.IsSOTrx='N' AND inv.DocStatus NOT IN ('VO', 'RE') AND inv.C_ProvisionalInvoice_ID=i.C_ProvisionalInvoice_ID) pi) ",o;e>0&&(u=n.dataContext.getJSONData("VCreateFrom/GetConversionWhere",{columns:"",forInvoices:!1,recordID:e,Table:"i"},null));u!=null&&u!=""&&(f+=u);f+=")";o=n.MLookupFactory.get(n.Env.getCtx(),this.windowNo,0,n.DisplayType.Search,"C_ProvisionalInvoice_ID",0,!1,f);this.cmbProvisionalInvoice=new n.Controls.VTextBoxButton("C_ProvisionalInvoice_ID",!0,!1,!0,n.DisplayType.Search,o)};i.prototype.getOrdersForProvisional=function(t,i,r){var e="m.C_InvoiceLine_ID",o=n.Env.getCtx().getContextAsInt(this.windowNo,"AD_Org_ID"),c="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsDropShip")),l="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx")),s=n.context.getWindowContextAsInt(this.windowNo,"C_ProvisionalInvoice_ID",!0),f="",u=" C_Order.IsSOTrx ='"+(l?"Y":"N")+"' AND C_Order.IsBlanketTrx='N' AND C_Order.ISSALESQUOTATION='N' AND C_Order.DocStatus IN ('CL', 'CO')",h;o>0&&(u+=" AND C_Order.AD_Org_ID = "+o);i>0&&(u+=" AND (C_Order.C_BPartner_ID = "+i+" OR C_Order.Bill_BPartner_ID = "+i+")");s>0&&(f=n.dataContext.getJSONData("VCreateFrom/GetConversionWhere",{columns:e,forInvoices:!1,recordID:s,Table:"C_Order"},null));f!=null&&f!=""&&(u+=f);u+="AND C_Order.IsReturnTrx='"+(r?"Y":"N")+"' AND C_Order.IsDropShip='"+(c?"Y":"N")+"'  AND C_Order.C_Order_ID IN (SELECT C_Order_ID FROM (SELECT ol.C_Order_ID,ol.C_OrderLine_ID,ol.QtyOrdered, (SELECT SUM(m.qty) FROM m_matchPO m WHERE ol.C_OrderLine_ID = m.C_OrderLine_ID AND NVL("+e+", 0) != 0 AND m.ISACTIVE = 'Y') AS Qty, (SELECT SUM(IL.QtyInvoiced)  FROM C_INVOICELINE IL INNER JOIN C_Invoice I ON I.C_INVOICE_ID = IL.C_INVOICE_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyInvoiced, (SELECT SUM(IL.QtyInvoiced)  FROM C_ProvisionalInvoiceLine IL INNER JOIN C_ProvisionalInvoice I ON I.C_ProvisionalInvoice_ID = IL.C_ProvisionalInvoice_ID WHERE il.ISACTIVE = 'Y' AND I.DOCSTATUS NOT IN('VO', 'RE') AND OL.C_ORDERLINE_ID = IL.C_ORDERLINE_ID) AS QtyProvisional FROM C_OrderLine ol ";n.Utility.Util.getValueOfString(n.Env.getCtx().getContext("$AllowNonItem"))=="N"&&(u+=" INNER JOIN M_Product p ON ol.M_Product_ID = p.M_Product_ID AND p.ProductType = 'I'");u+=") t GROUP BY C_Order_ID,C_OrderLine_ID,QtyOrdered  HAVING QtyOrdered > SUM(nvl(Qty,0)) AND QtyOrdered > SUM(NVL(QtyInvoiced,0)) AND QtyOrdered > SUM(NVL(QtyProvisional, 0)))";h=n.MLookupFactory.get(n.Env.getCtx(),this.windowNo,0,n.DisplayType.Search,"C_Order_ID",0,!1,u);this.cmbOrder=new n.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,n.DisplayType.Search,h)};i.prototype.jbInit=function(){this.init();this.lblBankAccount.getControl().text(n.Msg.getMsg("BankAcctCurrency"));this.lblBPartner.getControl().text(n.Msg.getMsg("BusinessPartner"));this.lblOrder.getControl().text(n.Msg.getMsg("Order"));this.lblInvoice.getControl().text(n.Msg.getMsg("Invoice"));this.lblShipment.getControl().text(n.Msg.getMsg("Shipment/Receipt"));this.lblLocator.getControl().text(n.Msg.getMsg("M_Locator_ID"));this.lblDeliveryDate.getControl().text(n.Msg.getMsg("DeliveryDate"));this.lblProduct.getControl().text(n.Msg.getMsg("ProductName"));this.lblDocumentNoRef.getControl().text(n.Msg.getMsg("DocumentNo"));this.lblDocumentNo.getControl().text(n.Msg.getMsg("DocumentNo"));this.lblDate.getControl().text(n.Msg.getMsg("DateAcct"));this.lblAmount.getControl().text(n.Msg.getMsg("Amount"));this.lblDepositSlip.getControl().text(n.Msg.getMsg("DepositSlipNo"));this.lblAuthCode.getControl().text(n.Msg.getMsg("AuthCode"));this.lblCheckNo.getControl().text(n.Msg.getMsg("CheckNo"));this.lblProvisionalInvoice.getControl().text(n.Msg.getMsg("ProvisionalInvoice"));var e=t("<div class='VIS_Pref_show'>"),u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>");this.topDiv.append(e);e.append(u);u.append(r);r.append(i);r.append(f);this.vBPartner!=null&&(this.cmbBankAccount!=null?(i.append(this.vBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append(this.vBPartner.getBtn(0)),f.append(this.vBPartner.getBtn(1))):(i.append(this.vBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append(this.vBPartner.getBtn(0))),i.append(this.lblBPartner.getControl().addClass("VIS_Pref_Label_Font")));u=t("<div class='VIS_Pref_dd'>");r=t("<div class='input-group vis-input-wrap'><\/div>");i=t("<div class='vis-control-wrap'><\/div>");f=t("<div class='input-group-append'>");e.append(u);u.append(r);r.append(i);r.append(f);this.cmbBankAccount!=null?(i.append(this.cmbBankAccount.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblBankAccount.getControl().addClass("VIS_Pref_Label_Font"))):this.DocumentNoRef!=null?(i.append(this.DocumentNoRef.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblDocumentNoRef.getControl().addClass("VIS_Pref_Label_Font"))):this.cmbProvisionalInvoice!=null&&$self.mTab.keyColumnName=="C_Invoice_ID"&&"N".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx"))&&(i.append(this.cmbProvisionalInvoice.getControl().attr("data-placeholder","").attr("placeholder"," ")),f.append(this.cmbProvisionalInvoice.getBtn(0)),f.append(this.cmbProvisionalInvoice.getBtn(1)),i.append(this.lblProvisionalInvoice.getControl().addClass("VIS_Pref_Label_Font")));e=t("<div class='VIS_Pref_show'>");u=t("<div class='VIS_Pref_dd'>");r=t("<div class='input-group vis-input-wrap'><\/div>");i=t("<div class='vis-control-wrap'><\/div>");f=t("<div class='input-group-append'>");this.Amount!=null;this.topDiv.append(e);e.append(u);u.append(r);r.append(i);r.append(f);this.DocumentNo!=null&&(u.append(r),i.append(this.DocumentNo.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblDocumentNo.getControl().addClass("VIS_Pref_Label_Font")));this.cmbOrder!=null&&(u.append(r),i.append(this.cmbOrder.getControl()),f.append(this.cmbOrder.getBtn(0)),f.append(this.cmbOrder.getBtn(1)),i.append(this.lblOrder.getControl().addClass("VIS_Pref_Label_Font")));this.Amount!=null&&(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),e.append(u),u.append(r),r.append(i),i.append(this.Amount.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblAmount.getControl().addClass("VIS_Pref_Label_Font")));this.Amount!=null?(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>")):(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>"));e.append(u);u.append(r);r.append(i);r.append(f);this.cmbInvoice!=null&&(i.append(this.cmbInvoice.getControl().attr("data-placeholder","").attr("placeholder"," ")),f.append(this.cmbInvoice.getBtn(0)),f.append(this.cmbInvoice.getBtn(1)),i.append(this.lblInvoice.getControl().addClass("VIS_Pref_Label_Font")));this.cmbShipment!=null&&(i.append(this.cmbShipment.getControl().attr("data-placeholder","").attr("placeholder"," ")),f.append(this.cmbShipment.getBtn(0)),f.append(this.cmbShipment.getBtn(1)),i.append(this.lblShipment.getControl().addClass("VIS_Pref_Label_Font")));this.Date!=null&&(i.append(this.Date.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblDate.getControl().addClass("VIS_Pref_Label_Font")));(this.locatorField!=null||this.cmbContainer!=null)&&(this.middelDiv.css("height","48.5%"),e=t("<div class='VIS_Pref_show'>"),u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>"),this.topDiv.append(e),e.append(u),u.append(r),r.append(i),r.append(f),this.locatorField!=null&&(i.append(this.locatorField.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append(this.locatorField.getBtn(0)),i.append(this.lblLocator.getControl().addClass("VIS_Pref_Label_Font"))),u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>"),e.append(u),u.append(r),r.append(i),r.append(f),this.cmbContainer!=null&&(u.css("visibility","hidden"),n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"]!=undefined&&n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"].equals("Y",!0)&&(u.css("visibility","visible"),this.ContainerTree.removeClass("VIS_Tree-Container-disabled")),i.append(this.cmbContainer.getControl().attr("disabled",!0).attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append(this.ContainerTree),i.append(this.lblContainer.getControl().addClass("VIS_Pref_Label_Font"))));e=t("<div class='VIS_Pref_show'>");this.CheckNo!=null?(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>")):(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>"));$self.mTab.keyColumnName=="C_ProvisionalInvoice_ID"&&this.middelDiv.css("height","64%");this.topDiv.append(e);e.append(u);u.append(r);r.append(i);r.append(f);this.DepositSlip!=null&&(i.append(this.DepositSlip.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblDepositSlip.getControl().addClass("VIS_Pref_Label_Font")));this.deliveryDate!=null&&(i.append(this.deliveryDate.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblDeliveryDate.getControl().addClass("VIS_Pref_Label_Font")));this.CheckNo!=null&&(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),e.append(u),u.append(r),r.append(i),i.append(this.CheckNo.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblCheckNo.getControl().addClass("VIS_Pref_Label_Font")));this.CheckNo!=null?(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>")):(u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),f=t("<div class='input-group-append'>"));e.append(u);u.append(r);r.append(i);r.append(f);this.vProduct!=null&&(i.append(this.vProduct.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),f.append(this.vProduct.getBtn(0)),f.append(this.vProduct.getBtn(1)),i.append(this.lblProduct.getControl().addClass("VIS_Pref_Label_Font")));this.AuthCode!=null&&(i.append(this.AuthCode.getControl().attr("data-placeholder","").attr("placeholder"," ")),i.append(this.lblAuthCode.getControl().addClass("VIS_Pref_Label_Font")));this.relatedToOrg!=null&&(e=t("<div class='VIS_Pref_show'>"),u=t("<div class='VIS_Pref_dd'>"),r=t("<div class='input-group vis-input-wrap'><\/div>"),i=t("<div class='vis-control-wrap'><\/div>"),this.topDiv.append(e),e.append(u),u.append(r),r.append(i),i.append(this.relatedToOrg.getControl()))};i.prototype.init=function(){this.createPageSettings();this.divPaging.append(this.ulPaging);this.$root.append(this.topDiv).append(this.middelDiv).append(this.divPaging).append(this.bottomDiv);this.bottomDiv.append(this.selectAllButton);this.bottomDiv.append(this.btnRefresh);this.bottomDiv.append(this.cancelbtn);this.bottomDiv.append(this.Applybtn);this.bottomDiv.append(this.Okbtn);this.bottomDiv.append(this.divPaging);this.middelDiv.append(this.dGrid);$self=this;this.Okbtn.on("click",function(){var r;if($self.isApplied){$self.$root.dialog("close");return}$self.setBusy(!0);var u=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),f=n.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt($self.cmbShipment.getValue()),o=n.Utility.Util.getValueOfInt($self.cmbProvisionalInvoice.getValue()),i=null;if($self.dGrid!=null&&(i=$self.dGrid.getSelection()),i==null||i.length==0){n.ADialog.info("RecordSelectionRequired");$self.setBusy(!1);return}if($self.locatorField!=null){if($self.dGrid!=null&&u>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.get(i[item]).C_Order_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));else if($self.dGrid!=null&&f>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Invoice_ID_K==$self.dGrid.get(i[item]).C_Invoice_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));$self.MergeItemsForSave();n.VCreateFromShipment.prototype.saveMInOut(!1)}else if($self.cmbBankAccount!=null){if($self.dGrid!=null)for(item in i){if($self.dGrid.get(i[item]).Date=="")return n.ADialog.error("VIS_PLAccountDate"),!1;r=t.grep($self.multiValues,function(n){return n.C_Payment_ID_K==$self.dGrid.get(i[item]).C_Payment_ID_K});r.length>0||$self.multiValues.push($self.dGrid.get(i[item]))}n.VCreateFromStatement.prototype.saveStatment();$self.middelDiv.css("height","61%")}else{if($self.dGrid!=null&&u>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.get(i[item]).C_Order_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));if($self.dGrid!=null&&e>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_InOut_ID_K&&n.M_InOut_ID_K==$self.dGrid.get(i[item]).M_InOut_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));if($self.dGrid!=null&&o>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Invoice_ID_K==$self.dGrid.get(i[item]).C_Invoice_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));$self.mTab.keyColumnName=="C_ProvisionalInvoice_ID"?n.VCreateFormProvisionalInvoice.prototype.saveProvisionalInvoice():n.VCreateFromInvoice.prototype.saveInvoice()}});this.Applybtn.on("click",function(){var r;$self.setBusy(!0);var u=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),f=n.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt($self.cmbShipment.getValue()),i=null;if($self.dGrid!=null&&(i=$self.dGrid.getSelection()),i==null||i.length==0){n.ADialog.info("RecordSelectionRequired");$self.setBusy(!1);return}if($self.locatorField!=null){if($self.dGrid!=null&&u>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.get(i[item]).C_Order_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));else if($self.dGrid!=null&&f>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Invoice_ID_K==$self.dGrid.get(i[item]).C_Invoice_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));$self.MergeItemsForSave();n.VCreateFromShipment.prototype.saveMInOut(!0)}else if($self.cmbBankAccount!=null){if($self.dGrid!=null)for(item in i){if($self.dGrid.get(i[item]).Date=="")return n.ADialog.error("VIS_PLAccountDate"),!1;r=t.grep($self.multiValues,function(n){return n.C_Payment_ID_K==$self.dGrid.get(i[item]).C_Payment_ID_K});r.length>0||$self.multiValues.push($self.dGrid.get(i[item]))}n.VCreateFromStatement.prototype.saveStatment();$self.middelDiv.css("height","61%")}else{if($self.dGrid!=null&&u>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.get(i[item]).C_Order_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));if($self.dGrid!=null&&e>0)for(item in i)r=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(i[item]).M_InOut_ID_K&&n.M_InOut_ID_K==$self.dGrid.get(i[item]).M_InOut_ID_K}),r.length>0||$self.multiValues.push($self.dGrid.get(i[item]));n.VCreateFromInvoice.prototype.saveInvoice()}});i.prototype.callBackSave=function(t){if(t==!1)$self.setBusy(!1);else{$self.isApplied=!0;n.ADialog.info("VIS_SuccessFullyInserted",null,null,null);var i=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),r=n.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),e=n.Utility.Util.getValueOfInt($self.cmbShipment.getValue()),u=$self.vProduct.getValue(),f=$self.deliveryDate.getValue();(i>0||r>0)&&($self.locatorField!=null?($self.dGrid.selectNone(),i>0&&($self.multiValues=[],$self.loadOrders(i,u,f,!1,1)),r>0&&($self.multiValues=[],n.VCreateFromShipment.prototype.loadInvoices(r,u,1)),$self.dGrid.selectNone(),$self.editedItems=[]):($self.dGrid.selectNone(),i>0&&($self.multiValues=[],$self.loadOrders(i,u,f,!0,1)),r>0&&($self.multiValues=[],n.VCreateFromShipment.prototype.loadInvoices(r,u,1)),$self.dGrid.selectNone(),$self.editedItems=[]))}};this.cancelbtn.on("click",function(){$self.setBusy(!1);$self.$root.dialog("close")});this.selectAllButton.on("click",function(){});if(this.relatedToOrg)this.relatedToOrg.getControl().on("click",function(){var i,r,u,t;$self.isApplied=!1;$self.setBusy(!0);$self.multiValues=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);i=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue());r=n.Utility.Util.getValueOfInt($self.cmbProvisionalInvoice.getValue());i>0?($self.cmbInvoice.setValue(-1),$self.cmbShipment.setValue(-1),t=$self.vProduct.getValue(),u=$self.deliveryDate.getValue(),$self.loadOrders(i,t,u,!1,1)):r>0?($self.cmbOrder.setValue(-1),$self.cmbInvoice.setValue(-1),$self.cmbShipment.setValue(-1),t=$self.vProduct.getValue(),n.VCreateFromInvoice.prototype.loadProvisionalInvoices(r,t,1)):$self.setBusy(!1)});if(this.btnRefresh)this.btnRefresh.on("click",function(){var t;if($self.cmbBankAccount!=null&&($self.setBusy(!0),t=$self.cmbBankAccount.getControl().find("option:selected").val(),t)){var i=$self.Date.getValue(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(t,r,i,f,u,e,o,s,$self.cmbPage.val())}});if(this.cmbBankAccount&&this.cmbBankAccount.getControl().change(function(){var t;if($self.editedItems=[],$self.setBusy(!0),t=$self.cmbBankAccount.getControl().find("option:selected").val(),t){n.VCreateFromStatement.prototype.initBPartner(t);$self.Date.setValue("");$self.DepositSlip.setValue("");$self.DocumentNo.setValue("");$self.AuthCode.setValue("");var i=$self.vBPartner.getValue(),r=$self.Date.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(t,i,r,f,u,e,o,s,1)}}),this.Date&&this.Date.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.DocumentNo&&this.DocumentNo.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.DepositSlip&&this.DepositSlip.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.AuthCode&&this.AuthCode.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.CheckNo&&this.CheckNo.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.Amount&&this.Amount.getControl().change(function(){$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=$self.Date.getValue(),i=$self.cmbBankAccount.getControl().find("option:selected").val(),r=$self.vBPartner.getValue(),u=$self.DepositSlip.getValue(),f=$self.DocumentNo.getValue(),e=$self.AuthCode.getValue(),o=$self.CheckNo.getValue(),s=$self.Amount.getValue();n.VCreateFromStatement.prototype.loadBankAccounts(i,r,t,f,u,e,o,s,1)}),this.deliveryDate&&this.deliveryDate.getControl().change(function(){$self.isApplied=!1;$self.setBusy(!0);$self.multiValues=[];$self.editedItems=[];$self.dGrid!=null&&($self.dGrid.destroy(),$self.dGrid=null);var t=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),i=$self.vProduct.getValue(),r=$self.deliveryDate.getValue();$self.locatorField!=null?$self.loadOrders(t,i,r,!1,1):$self.loadOrders(t,i,r,!0,1)}),this.ContainerTree)this.ContainerTree.on("click",function(){var i,t;(n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"]==undefined||n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"].equals("Y",!0))&&(i=$self.locatorField.getValue(),i>0&&(t=new n.productContainerTree(0,i,0),t!=null&&(t.showDialog(),t.onClosing=function(n,t){$self.cmbContainer.getControl().empty();$self.cmbContainer.getControl().append(" <option value="+n+">"+t+"<\/option>")}),t=null),i=null)})};i.prototype.isInitOK=function(){return this.initOK};i.prototype.loadOrders=function(t,i,r,u,f){var e=this.getOrdersData(n.Env.getCtx(),t,i,r,u,f)};i.prototype.getOrdersData=function(i,r,u,f,e,o){var s,v,y,h;if($self.dGrid!=null){s=$self.dGrid.getSelection();for(item in s)v=t.grep($self.multiValues,function(n){return n.M_Product_ID_K==$self.dGrid.get(s[item]).M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.get(s[item]).C_Order_ID_K}),v.length>0||$self.multiValues.push($self.dGrid.get(s[item]))}if($self.mTab.keyColumnName=="M_InOut_ID"?$self.record_ID=$self.mTab.getValue("M_InOut_ID"):$self.mTab.keyColumnName=="C_Invoice_ID"?$self.record_ID=$self.mTab.getValue("C_Invoice_ID"):$self.mTab.keyColumnName=="C_ProvisionalInvoice_ID"&&($self.record_ID=$self.mTab.getValue("C_ProvisionalInvoice_ID")),$self.relatedToOrg!=null&&$self.relatedToOrg.getValue()){var c="",l="",a="",p="";o||(o=1);c=n.Env.isBaseLanguage(i,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i).concat("')");u!=null&&(l=" AND l.M_Product_ID="+u);f!=null&&(h=n.DB.to_date(f,!0),p=h,a=" AND l.DatePromised <= "+h);y=$self.mTab.getValue("AD_Org_ID");t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetOrdersDataCommon",dataType:"json",type:"POST",data:{keyColumnName:$self.mTab.keyColumnName,tableName:"C_OrderLine",recordID:$self.record_ID,pageNo:o,forInvoicees:e,C_Ord_IDs:r,isBaseLangess:c,MProductIDss:l,DelivDates:a,adOrgIDSs:y},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));$self.setBusy(!1);$self.log.info(t);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);$self.setBusy(!1);return}$self.resetPageCtrls(i.pSetting);$self.loadGrid(i.data);$self.setBusy(!1)}})}else{var c="",l="",a="",p="";c=n.Env.isBaseLanguage(i,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"') INNER JOIN C_UOM uom1 ON uom1.C_UOM_ID = uom.C_UOM_ID ";u>0&&(l=" AND l.M_Product_ID="+u);f!=null&&(h=n.DB.to_date(f,!0),a=" AND l.DatePromised <= "+h);o||(o=1);t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetOrdersDataCommonOrg",dataType:"json",type:"POST",data:{keyColumnName:$self.mTab.keyColumnName,tableName:"C_OrderLine",recordID:$self.record_ID,pageNo:o,forInvoicees:e,C_Ord_IDs:r,isBaseLangess:c,MProductIDss:l,DelivDates:a},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));$self.setBusy(!1);$self.log.info(t);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);$self.setBusy(!1);return}$self.resetPageCtrls(i.pSetting);$self.loadGrid(i.data);$self.setBusy(!1)}})}return[]};i.prototype.loadOrder=function(t,i){var r=null;r=this.getOrderData(n.Env.getCtx(),t,i);this.loadGrid(r)};i.prototype.getOrderData=function(i,r,u){var e=[],s,f,o;return $self.relatedToOrg.getValue()?(f="",f=n.Env.isBaseLanguage(i,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"')",s=$self.mTab.getValue($self.windowNo,"AD_Org_ID"),o=n.Env.getAD_Language(i),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetOrderDataCommons",dataType:"json",type:"POST",async:!1,data:{forInvoices:u,isBaseLangs:f,C_OrderID:r,orggetVals:s,langs:o},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));$self.setBusy(!1);$self.log.info(t);return},success:function(n){var i=JSON.parse(n),u,r,t;if(i&&i!=null&&i.length>0)for(u=1,r=0;r<i.length;r++)t={},t.Quantity=i[r].quantity,t.QuantityEntered=i[r].quantityentered,t.C_UOM_ID=i[r].c_uom_id,t.M_Product_ID=i[r].m_product_id,t.M_AttributeSetInstance_ID=i[r].m_attributesetinstance_id,t.C_Order_ID=i[r].c_order_id,t.M_InOut_ID=null,t.C_Invoice_ID=null,t.C_UOM_ID_K=i[r].c_uom_id_k,t.M_Product_ID_K=i[r].m_product_id_k,t.M_AttributeSetInstance_ID_K=i[r].m_attributesetinstance_id_k,t.C_Order_ID_K=i[r].c_order_id_k,t.M_InOut_ID_K=null,t.C_Invoice_ID_K=null,t.C_PaymentTerm_ID=i[r].C_PaymentTerm_ID,t.PaymentTermName=i[r].PaymentTermName,t.IsAdvance=i[r].IsAdvance,t.C_InvoicePaymentTerm_ID=i[r].C_InvoicePaymentTerm_ID,t.IsInvoicePTAdvance=i[r].IsInvoicePTAdvance,t.recid=u,e.push(t);$self.setBusy(!1)}}),e):(f="",f=n.Env.isBaseLanguage(i,"C_UOM")?" LEFT OUTER JOIN C_UOM uom ON (l.C_UOM_ID=uom.C_UOM_ID)":" LEFT OUTER JOIN C_UOM_Trl uom ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"')",o=n.Env.getAD_Language(i),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetOrderDataCommonsNotOrg",dataType:"json",type:"POST",async:!1,data:{forInvoices:u,isBaseLangs:f,C_OrderID:r,langs:o},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));$self.setBusy(!1);$self.log.info(t);return},success:function(n){var i=JSON.parse(n),u,r,t;if(i&&i!=null&&i.length>0)for(u=1,r=0;r<i.length;r++)t={},t.Quantity=i[r].quantity,t.QuantityEntered=i[r].quantityentered,t.C_UOM_ID=i[r].c_uom_id,t.M_Product_ID=i[r].m_product_id,t.M_AttributeSetInstance_ID=i[r].m_attributesetinstance_id,t.C_Order_ID=i[r].c_order_id,t.M_InOut_ID=null,t.C_Invoice_ID=null,t.C_UOM_ID_K=i[r].c_uom_id_k,t.M_Product_ID_K=i[r].m_product_id_k,t.M_AttributeSetInstance_ID_K=i[r].m_attributesetinstance_id_k,t.C_Order_ID_K=i[r].c_order_id_k,t.M_InOut_ID_K=null,t.C_Invoice_ID_K=null,t.C_PaymentTerm_ID=i[r].C_PaymentTerm_ID,t.PaymentTermName=i[r].PaymentTermName,t.IsAdvance=i[r].IsAdvance,t.C_InvoicePaymentTerm_ID=i[r].C_InvoicePaymentTerm_ID,t.IsInvoicePTAdvance=i[r].IsInvoicePTAdvance,$self.mTab.keyColumnName=="C_ProvisionalInvoice_ID"&&(t.POPrice=i[r].POPrice,t.ProvisionalPrice=i[r].ProvisionalPrice),t.recid=u,e.push(t);$self.setBusy(!1)}}),e)};i.prototype.loadGrid=function(i){function a(){for(var n=0;n<$self.dGrid.records.length;n++)$self.NonEditableRecord.indexOf(n+1)>=0&&($self.dGrid.unselect(n+1),t("#grid_"+$self.dGrid.name+"_rec_"+(n+1)+"  input").attr("disabled",!0))}function s(n,i){var u=$self.dGrid.records[i].M_Product_ID_K,s=t.grep($self.editedItems,function(n){return e>0?n.M_Product_ID_K==u&&n.C_Order_ID_K==$self.dGrid.records[i].C_Order_ID_K:o>0?n.M_Product_ID_K==u&&n.C_Invoice_ID_K==$self.dGrid.records[i].C_Invoice_ID_K:c>0?n.M_Product_ID_K==u&&n.M_InOut_ID_K==$self.dGrid.records[i].M_InOut_ID_K:n.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K}),f,r;if(s.length>0)$self.editedItems.splice($self.editedItems.indexOf(s[0]),1),$self.editedItems.push($self.dGrid.records[i]);else{for(f=0,r=0;r<$self.editedItems.length;r++)if($self.editedItems[r].recid==$self.dGrid.records[i].recid){f=1;break}f==0&&$self.editedItems.push($self.dGrid.records[i])}}function w(n,i,r){var u=null;return t.ajax({url:p,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(n)}).done(function(n){u=n;r&&r(n)}),u}var f=n.DisplayType.GetNumberFormat(n.DisplayType.Amount),r=n.Env.isDecimalPoint(),l,h,v,u;this.dGrid!=null&&(this.dGrid.destroy(),this.dGrid=null);l="Y".equals(n.Env.getCtx().getWindowContext(this.windowNo,"IsSOTrx"));this.arrListColumns.length!=0&&($self.mTab.keyColumnName!="C_Invoice_ID"||l)||(this.arrListColumns=[],this.arrListColumns.push({field:"Select",caption:n.Msg.getMsg("Select"),sortable:!1,size:"50px",hidden:!1,render:function(){return'<div><input type=checkbox disabled="true"><\/div>'}}),this.arrListColumns.push({field:"Quantity",caption:n.Msg.getMsg("QtyPending"),sortable:!1,size:"150px",hidden:!1,render:function(n){var t=n.Quantity;return parseFloat(t).toLocaleString(undefined,{minimumFractionDigits:4})}}),this.arrListColumns.push({field:"QuantityPending",caption:n.Msg.getMsg("Quantity"),sortable:!1,size:"150px",render:"number:4",hidden:!0}),n.Utility.Util.getValueOfInt($self.cmbProvisionalInvoice.getValue())>0&&!l?(this.arrListColumns.push({field:"QuantityEntered",caption:n.Msg.getMsg("QtyEntered"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"POPrice",caption:n.Msg.getMsg("POPrice"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"ProvisionalPrice",caption:n.Msg.getMsg("ProvisionalPrice"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"InvoicePrice",caption:n.Msg.getMsg("InvoicePrice"),editable:{type:"number",style:"background-color: #f8f8f8;"},sortable:!1,size:"150px",hidden:!1,render:function(n){var t=n.InvoicePrice;return t=$self.checkcommaordot(event,t),parseFloat(t).toLocaleString(undefined,{minimumFractionDigits:4})},style:"background-color: #d1d1d14a"})):this.arrListColumns.push({field:"QuantityEntered",caption:n.Msg.getMsg("QtyEntered"),editable:{type:"number",style:"background-color: #f8f8f8;"},sortable:!1,size:"150px",hidden:!1,render:function(n){var t=n.QuantityEntered;return t=$self.checkcommaordot(event,t),parseFloat(t).toLocaleString(undefined,{minimumFractionDigits:4})},style:"background-color: #d1d1d14a"}),this.arrListColumns.push({field:"C_UOM_ID",caption:n.Msg.getMsg("UomName"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_Product_SearchKey",caption:n.Msg.getMsg("ProductSearchKey"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_Product_ID",caption:n.Msg.getMsg("ProductName"),sortable:!0,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_AttributeSetInstance_ID",caption:n.Msg.getMsg("ASI"),sortable:!1,size:"150px",editable:{type:"custom",ctrl:$self.$productAttribute,showAll:!0,style:"background-color: #f8f8f8;"},render:function(n){var t=$self.pattrLookup,i=n.M_AttributeSetInstance_ID,r;return n.changes&&typeof n.changes.M_AttributeSetInstance_ID!="undefined"&&(i=n.changes.M_AttributeSetInstance_ID),t&&(r=t.getDisplay(i,!0)),r},style:"background-color: #d1d1d14a"}),this.arrListColumns.push({field:"C_PaymentTerm_ID",caption:n.Msg.getMsg("C_PaymentTerm_ID"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"PaymentTermName",caption:n.Msg.getMsg("PaymentTermName"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"IsAdvance",caption:n.Msg.getMsg("IsAdvance"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_InvoicePaymentTerm_ID",caption:n.Msg.getMsg("C_InvoicePaymentTerm_ID"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"IsInvoicePTAdvance",caption:n.Msg.getMsg("IsInvoicePTAdvance"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_Order_ID",caption:n.Msg.getMsg("OrderLine"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"M_InOut_ID",caption:n.Msg.getMsg("Shipment/Receipt"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"C_Invoice_ID",caption:n.Msg.getMsg("Invoice"),sortable:!1,size:"150px",hidden:!1}),this.arrListColumns.push({field:"C_UOM_ID_K",caption:n.Msg.getMsg("UomName"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"M_Product_ID_K",caption:n.Msg.getMsg("ProductName"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_Order_ID_K",caption:n.Msg.getMsg("Order"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"M_InOut_ID_K",caption:n.Msg.getMsg("Shipment/Receipt"),sortable:!1,size:"150px",hidden:!0}),this.arrListColumns.push({field:"C_Invoice_ID_K",caption:n.Msg.getMsg("Invoice"),sortable:!1,size:"150px",hidden:!0}));w2utils.encodeTags(i);h="gridCreateForm"+this.windowNo;h=h.replace(".","");this.dGrid=t(this.middelDiv).w2grid({name:h,recordHeight:30,show:{selectColumn:!0},multiSelect:!0,columns:this.arrListColumns,records:i,onSelect:function(n){n.onComplete=function(){a()}},onEditField:function(n){var i;id=n.recid;n.column==3&&($self.dGrid.records[n.index].QuantityEntered=$self.checkcommaordot(n,$self.dGrid.records[n.index].QuantityEntered),i=f.GetFormatAmount($self.dGrid.records[n.index].QuantityEntered,"init",r),$self.dGrid.records[n.index].QuantityEntered=f.GetConvertedString(i,r),t("#grid_"+$self.dGrid.name+"_rec_"+id).keydown(function(n){if(r||n.keyCode!=190&&n.keyCode!=110){if(r&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)?n.target.value.indexOf(".")>-1&&(n.target.value=n.target.value.replace(".","")):n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&n.target.value.indexOf(",")>-1&&(n.target.value=n.target.value.replace(",","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0}));n.column==4&&$self.dGrid.columns[n.column].field=="ProvisionalPrice"&&($self.dGrid.records[n.index].ProvisionalPrice=$self.checkcommaordot(n,$self.dGrid.records[n.index].ProvisionalPrice),i=f.GetFormatAmount($self.dGrid.records[n.index].ProvisionalPrice,"init",r),$self.dGrid.records[n.index].ProvisionalPrice=f.GetConvertedString(i,r),$self.dGrid.refreshRow(n.index+1),t("#grid_"+$self.dGrid.name+"_rec_"+id).keydown(function(n){if(r||n.keyCode!=190&&n.keyCode!=110){if(r&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)?n.target.value.indexOf(".")>-1&&(n.target.value=n.target.value.replace(".","")):n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&n.target.value.indexOf(",")>-1&&(n.target.value=n.target.value.replace(",","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0}));n.column==6&&$self.dGrid.columns[n.column].field=="InvoicePrice"&&($self.dGrid.records[n.index].InvoicePrice=$self.checkcommaordot(n,$self.dGrid.records[n.index].InvoicePrice),i=f.GetFormatAmount($self.dGrid.records[n.index].InvoicePrice,"init",r),$self.dGrid.records[n.index].InvoicePrice=f.GetConvertedString(i,r),$self.dGrid.refreshRow(n.index+1),t("#grid_"+$self.dGrid.name+"_rec_"+id).keydown(function(n){if(r||n.keyCode!=190&&n.keyCode!=110){if(r&&n.keyCode==188)return!1}else return!1;return n.target.value.contains(".")&&(n.which==110||n.which==190||n.which==188)?n.target.value.indexOf(".")>-1&&(n.target.value=n.target.value.replace(".","")):n.target.value.contains(",")&&(n.which==110||n.which==190||n.which==188)&&n.target.value.indexOf(",")>-1&&(n.target.value=n.target.value.replace(",","")),n.keyCode!=8&&n.keyCode!=9&&(n.keyCode<37||n.keyCode>40)&&(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105)&&n.keyCode!=109&&n.keyCode!=189&&n.keyCode!=110&&n.keyCode!=144&&n.keyCode!=188&&n.keyCode!=190?!1:void 0}))},onChange:function(i){window.setTimeout(function(){if($self.dGrid.getChanges(i.recid)!=undefined&&i.column==0&&$self.dGrid.columns[i.column].field=="Date"){var r=n.context.getContextAsInt($self.windowNo,"AD_Org_ID"),u=$self.dGrid.records[i.index].Amount,f=$self.dGrid.records[i.index].C_Currency_ID_K,e=$self.dGrid.records[i.index].C_ConversionType_ID,o=$self.dGrid.records[i.index].Date,s=$self.dGrid.records[i.index].Type,h=$self.dGrid.records[i.index].C_Payment_ID_K;t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetConvertedAmount",dataType:"json",type:"POST",data:{_paymentId:h,amount:u,currencyId:f,convsion_Id:e,date:o,paymentType:s,_org_id:r},error:function(){n.ADialog.info("ErrorWhileGettingData",null,"","");self.$super.setBusy(!1);return},success:function(t){t=JSON.parse(t);n.Utility.Util.getValueOfString(t._message)=="Success"?(_convertedAmt=n.Utility.Util.getValueOfDecimal(t.convtAmt),$self.dGrid.records[i.index].changes.ConvertedAmount=_convertedAmt,$self.dGrid.records[i.index].ConvertedAmount=_convertedAmt,$self.dGrid.refreshRow(i.index+1)):n.ADialog.info(t._message,null,"","")}})}},100)}});this.dGrid.selectNone();var e=n.Utility.Util.getValueOfInt($self.cmbOrder.getValue()),o=n.Utility.Util.getValueOfInt($self.cmbInvoice.getValue()),c=n.Utility.Util.getValueOfInt($self.cmbShipment.getValue());for(itm in $self.multiValues)for(item in $self.dGrid.records)v=t.grep($self.multiValues,function(n){return e>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.records[item].C_Order_ID_K:o>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.C_Invoice_ID_K==$self.dGrid.records[item].C_Invoice_ID_K:c>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.M_InOut_ID_K==$self.dGrid.records[item].M_InOut_ID_K:n.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K}),v.length>0&&$self.dGrid.select(parseInt(item)+1);if(this.dGrid.records.length>0)for($self.NonEditableRecord=[],u=0;u<$self.dGrid.records.length;u++)t(t("#grid_"+$self.dGrid.name+"_rec_"+(u+1)).find("input[type=checkbox]")[1]).prop("checked",i[u].Select),$self.dGrid.records[u].C_InvoicePaymentTerm_ID==$self.dGrid.records[u].C_PaymentTerm_ID||$self.dGrid.records[u].C_InvoicePaymentTerm_ID==0||$self.dGrid.records[u].C_InvoicePaymentTerm_ID!=$self.dGrid.records[u].C_PaymentTerm_ID&&$self.dGrid.records[u].IsAdvance==!1&&$self.dGrid.records[u].IsInvoicePTAdvance==!1||(t("#grid_"+$self.dGrid.name+"_rec_"+(u+1)+"  input").attr("disabled",!0),$self.NonEditableRecord.push(u+1));this.dGrid.on("change",function(t){var i;if(a(),$self.dGrid.columns[t.column].field=="QuantityEntered"){if(i=f.GetConvertedNumber(t.value_new,r),$self.fromInvoice){if($self.dGrid.records[t.index].QuantityPending<i.toFixed(4)){n.ADialog.error("InvoiceQtyGreater");t.value_new=t.value_original;return}}else if($self.dGrid.records[t.index].QuantityPending<i.toFixed(4)){n.ADialog.error("QtyCanNotbeGreater");t.value_new=t.value_original;return}$self.dGrid.records[t.index].QuantityEntered=i.toFixed(4);(e>0||o>0)&&s("QuantityEntered",t.index,i.toFixed(4))}if($self.dGrid.columns[t.column].field=="ProvisionalPrice"){if(i=f.GetConvertedNumber(t.value_new,r),i<0){n.ADialog.error("PriceCantNegative");t.value_new=t.value_original;return}$self.dGrid.records[t.index].ProvisionalPrice=i.toFixed(4);s("ProvisionalPrice",t.index,i.toFixed(4))}else if($self.dGrid.columns[t.column].field=="InvoicePrice"){if(i=f.GetConvertedNumber(t.value_new,r),i<0){n.ADialog.error("PriceCantNegative");t.value_new=t.value_original;return}$self.dGrid.records[t.index].InvoicePrice=i.toFixed(4);s("InvoicePrice",t.index,i.toFixed(4))}else $self.dGrid.columns[t.column].field=="M_AttributeSetInstance_ID"?($self.dGrid.records[t.index].M_AttributeSetInstance_ID=t.value_new,(e>0||o>0)&&s("M_AttributeSetInstance_ID",t.index,t.value_new)):$self.dGrid.columns[t.column].field=="Date"&&(t.value_new!=""?$self.dGrid.records[t.index].Date=t.value_new:t.value_previous!=""?$self.dGrid.records[t.index].Date=t.value_previous:t.value_original!=""&&($self.dGrid.records[t.index].Date=t.value_original),$self.dGrid.records[t.index].Date!=""&&s("Date",t.index,$self.dGrid.records[t.index].Date))});this.dGrid.on("click",function(t){t.preventDefault;a();n.Env.getCtx().setContext($self.windowNo,"M_Product_ID",n.Utility.Util.getValueOfInt($self.dGrid.records[t.recid-1].M_Product_ID_K))});var b=function(t,i,r){var f=r?!0:!1,e={sql:t,page:1,pageSize:0},u=null;return w(e,f,function(t){i=(new n.DB.DataSet).toJson(t);var i=(new n.DB.DataSet).toJson(t);u=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null;i.dispose();i=null;f&&r(u)}),u},y=n.Application.contextUrl,p=y+"JsonData/JDataSet",k=y+"JsonData/ExecuteNonQuer";this.dGrid.on("unselect",function(n){if(n.all)n.onComplete=function(){for(item in $self.dGrid.records){var n=t.grep($self.multiValues,function(n){return e>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.C_Order_ID_K==$self.dGrid.records[item].C_Order_ID_K:o>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.C_Invoice_ID_K==$self.dGrid.records[item].C_Invoice_ID_K:c>0?n.M_Product_ID_K==$self.dGrid.records[item].M_Product_ID_K&&n.M_InOut_ID_K==$self.dGrid.records[item].M_InOut_ID_K:n.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K});n.length>0&&$self.multiValues.splice($self.multiValues.indexOf(n[0]),1)}};else{var i=w2ui[n.target].records[n.index].M_Product_ID_K,r=t.grep($self.multiValues,function(t){return e>0?t.M_Product_ID_K==i&&t.C_Order_ID_K==w2ui[n.target].records[n.index].C_Order_ID_K:o>0?t.M_Product_ID_K==i&&t.C_Invoice_ID_K==w2ui[n.target].records[n.index].C_Invoice_ID_K:c>0?t.M_Product_ID_K==i&&t.M_InOut_ID_K==w2ui[n.target].records[n.index].M_InOut_ID_K:t.C_Payment_ID_K==$self.dGrid.records[item].C_Payment_ID_K});r.length>0&&$self.multiValues.splice($self.multiValues.indexOf(r[0]),1)}})};n.VCreateFrom=i})(VIS,jQuery),function(n,t){function i(t){function f(){var t,r;return i.title=n.Msg.getMsg("Invoice")+" .. "+n.Msg.getMsg("CreateFrom"),i.lblInvoice!=null&&i.lblInvoice.getControl().css("display","none"),i.cmbInvoice!=null&&i.cmbInvoice.getControl().css("display","none"),i.lblLocator!=null&&i.lblLocator.getControl().css("display","none"),i.locatorField!=null&&i.locatorField.getControl().css("display","none"),i.deliveryDate=new n.Controls.VDate("DeliveryDate",!1,!1,!0,n.DisplayType.Date,"DeliveryDate"),t=n.MLookupFactory.getMLookUp(n.Env.getCtx(),i.windowNo,2221,n.DisplayType.Search),i.vProduct=new n.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,n.DisplayType.Search,t),r=i.initBPartner(!0),i.vBPartner.setReadOnly(!0),o(r),i.fromInvoice=!0,!0}function e(t,u){var h="Y".equals(n.Env.getCtx().getWindowContext(r.windowNo,"IsDropShip")),e="Y".equals(n.Env.getCtx().getWindowContext(r.windowNo,"IsSOTrx")),c=n.dataContext.getJSONRecord("MDocType/GetDocType",n.Env.getCtx().getContextAsInt(r.windowNo,"C_DocTypeTarget_ID").toString()),o=n.Utility.Util.getValueOfBoolean(c.IsReturnTrx),f=" M_InOut_ID IN (SELECT s.M_InOut_ID FROM M_InOut s WHERE s.C_BPartner_ID = "+u+" AND s.IsSOTrx = '"+(e?"Y":"N")+"' AND s.DocStatus IN('CL', 'CO') AND s.IsDropShip='"+(h?"Y":"N")+"'",s;o!=null&&(f+=" AND S.IsReturnTrx='"+(o==!0?"Y":"N")+"'");e||(f+=" AND s.M_InOut_ID NOT IN (SELECT DISTINCT OL.M_InOut_ID FROM C_ProvisionalInvoice PI INNER JOIN C_ProvisionalInvoiceLine IL ON IL.C_ProvisionalInvoice_ID = PI.C_ProvisionalInvoice_ID INNER JOIN M_InOutLine OL ON OL.M_InOutLine_ID = IL.M_InOutLine_ID AND S.M_InOut_ID = OL.M_InOut_ID WHERE  PI.IsActive = 'Y' AND pi.DocStatus NOT IN('VO', 'RE')) ");f+=" AND s.M_InOut_ID IN (SELECT t.M_InOut_ID FROM (SELECT sl.M_InOut_ID, sl.M_InOutLine_ID, sl.MovementQty,  (SELECT SUM(NVL(il.QtyInvoiced, 0)) FROM C_InvoiceLine il INNER JOIN C_Invoice I ON I.C_INVOICE_ID = il.C_INVOICE_ID WHERE i.DocStatus NOT IN ('VO', 'RE') AND sl.M_InOutLine_ID = il.M_InOutLine_ID) AS QtyInvoiced FROM M_InOutLine sl) t GROUP BY t.M_InOut_ID, t.M_InOutLine_ID, t.MovementQty HAVING t.MovementQty > SUM(NVL(t.QtyInvoiced, 0))))";s=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,0,n.DisplayType.Search,"M_InOut_ID",0,!1,f);i.cmbShipment=new n.Controls.VTextBoxButton("M_InOut_ID",!0,!1,!0,n.DisplayType.Search,s)}function o(t){e(n.Env.getCtx(),t)}var i=this.$super,r,u;i.constructor(t);r=this;f();i.jbInit();i.initOK=!0;u=t.getWindowNo();this.log=n.Logging.VLogger.getVLogger("VCreateFromInvoice");this.disposeComponent=function(){i=null;r=null;this.disposeComponent=null}}n.Utility.inheritPrototype(i,n.VCreateFrom);i.prototype.saveInvoice=function(){var u,t,i;if(this.$super.dGrid==null||(u={},t=this.$super.multiValues,t==null)||t.length<=0)return!1;for(i=0;i<t.length;i++)u[i]=t[i];var f=this.$super.mTab.getValue("C_Invoice_ID"),e=n.Utility.Util.getValueOfInt(this.$super.cmbOrder.getValue()),o=n.Utility.Util.getValueOfInt(this.$super.cmbShipment.getValue()),r=n.Utility.Util.getValueOfInt(this.$super.cmbProvisionalInvoice.getValue());return(r==undefined||r=="")&&(r=0),this.saveData(u,"",e,o,f,r)};i.prototype.loadShipments=function(t,i,r){var u=this.getShipmentsData(n.Env.getCtx(),t,i,r)};i.prototype.getShipmentsData=function(i,r,u,f){var e=this,o,c,s,h;if(this.$super.record_ID=$self.mTab.getValue("C_Invoice_ID"),e.$super.dGrid!=null){o=e.$super.dGrid.getSelection();for(item in o)c=t.grep(e.$super.multiValues,function(n){return n.M_Product_ID_K==e.$super.dGrid.get(o[item]).M_Product_ID_K&&n.M_InOut_ID_K==e.$super.dGrid.get(o[item]).M_InOut_ID_K}),c.length>0||e.$super.multiValues.push(e.$super.dGrid.get(o[item]))}return s="",h="",s=n.Env.isBaseLanguage(i,"C_UOM")?"FROM C_UOM uom INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom Left join C_UOM uom1 on (uom1.C_UOM_ID=uom.C_UOM_ID)  INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"') ",u!=null&&(h=" AND l.M_Product_ID="+u),f||(f=1),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetDataVCreateFrom",dataType:"json",type:"POST",data:{keyColumnName:e.$super.mTab.keyColumnName,tableName:"M_InOutLine",recordID:e.$super.record_ID,pageNo:f,mInOutId:r,isBaseLanguages:s,mProductIDD:h},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));e.$super.setBusy(!1);selfChild.log.info(t);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);e.$super.setBusy(!1);return}e.$super.resetPageCtrls(i.pSetting);e.$super.loadGrid(i.data);e.$super.setBusy(!1)}}),[]};i.prototype.loadShipment=function(t){var i=this.getShipmentData(n.Env.getCtx(),t);this.$super.loadGrid(i)};i.prototype.getShipmentData=function(i,r){var u="";return u=n.Env.isBaseLanguage(i,"C_UOM")?"FROM C_UOM uom INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom INNER JOIN M_InOutLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"') ",t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetShipmentDatas",type:"POST",async:!1,data:{MInOutIDs:r,isBaseLanguageUmos:u},success:function(n){var i=JSON.parse(n),r,u;if(i&&i.length>0)for(r=1,u=0;u<i.length;u++){var t={},f=dr.getDecimal(0),e=dr.getDecimal(1);t.Quantity=f;t.QuantityEntered=e;t.C_UOM_ID=dr.getString(3);t.M_Product_ID=dr.getString(5);t.C_Order_ID=".";t.M_InOut_ID=dr.getString(7);t.C_Invoice_ID=null;t.C_UOM_ID_K=dr.getString(2);t.M_Product_ID_K=dr.getInt(4);t.C_Order_ID_K=dr.getInt(8);t.M_InOut_ID_K=dr.getInt(6);t.C_Invoice_ID_K=null;t.recid=r;r++;n.push(t)}},error:function(){}}),[]};i.prototype.loadProvisionalInvoices=function(t,i,r){var u=this.getProvisionalInvoicesData(n.Env.getCtx(),t,i,r)};i.prototype.getProvisionalInvoicesData=function(i,r,u,f){var e=this,o,l,s,h,c;if(this.$super.record_ID=$self.mTab.getValue("C_Invoice_ID"),e.$super.dGrid!=null){o=e.$super.dGrid.getSelection();for(item in o)l=t.grep(e.$super.multiValues,function(n){return n.M_Product_ID_K==e.$super.dGrid.get(o[item]).M_Product_ID_K&&n.C_Invoice_ID_K==e.$super.dGrid.get(o[item]).C_Invoice_ID_K}),l.length>0||e.$super.multiValues.push(e.$super.dGrid.get(o[item]))}return s="",h="",s=n.Env.isBaseLanguage(i,"C_UOM")?"FROM C_UOM uom INNER JOIN C_ProvisionalInvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom Left join C_UOM uom1 on (uom1.C_UOM_ID=uom.C_UOM_ID) INNER JOIN C_ProvisionalInvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"') ",u!=null&&(h=" AND l.M_Product_ID = "+u),f||(f=1),c=null,e.$super.relatedToOrg!=null&&e.$super.relatedToOrg.getValue()&&(c=e.$super.mTab.getValue("AD_Org_ID")),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetProvisionalInvoicesDataVCreate",dataType:"json",type:"POST",data:{keyColumnName:e.$super.mTab.keyColumnName,tableName:"C_ProvisionalInvoiceLine",recordID:e.$super.record_ID,pageNo:f,isBaseLangss:s,cInvoiceID:r,mProductIDs:h,orgId:c},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));selfChild.log.info(t);e.$super.setBusy(!1);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);e.$super.setBusy(!1);return}e.$super.resetPageCtrls(i.pSetting);e.$super.loadGrid(i.data);e.$super.setBusy(!1)}}),[]};i.prototype.saveData=function(i,r,u,f,e,o){var s=this;t.ajax({type:"POST",url:n.Application.contextUrl+"Common/SaveInvoice",dataType:"json",data:{model:i,selectedItems:r,C_Order_ID:u,C_Invoice_ID:e,M_inout_id:f,C_ProvisionalInvoice_ID:o},success:function(n){if(returnValue=n.result,returnValue){s.dispose();s.$super.$root.dialog("close");s.$super.setBusy(!1);return}s.$super.setBusy(!1);alert(returnValue)},error:function(n,t,i){console.log(t);s.$super.setBusy(!1);alert(i)}})};i.prototype.dispose=function(){this.disposeComponent!=null&&this.disposeComponent()};n.VCreateFromInvoice=i}(VIS,jQuery),function(n,t){function i(t){function u(){var o,t,r,u,f;i.title=n.Msg.getElement(n.Env.getCtx(),"M_InOut_ID",!1)+" .. "+n.Msg.translate(n.Env.getCtx(),"CreateFrom");i.lblShipment!=null&&i.lblShipment.getControl().css("display","none");i.cmbShipment!=null&&i.cmbShipment.getControl().css("display","none");i.Applybtn&&i.Applybtn.css("display","block");o=3537;t=new n.MLocatorLookup(n.Env.getCtx(),i.windowNo);i.locatorField=new n.Controls.VLocator("M_Locator_ID",!0,!1,!0,n.DisplayType.Locator,t);i.deliveryDate=new n.Controls.VDate("DeliveryDate",!1,!1,!0,n.DisplayType.Date,"DeliveryDate");r=n.MLookupFactory.getMLookUp(n.Env.getCtx(),i.windowNo,2221,n.DisplayType.Search);i.vProduct=new n.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,n.DisplayType.Search,r);i.DocumentNoRef=new n.Controls.VTextBox("DocumentNo",!1,!0,!0,50,100,null,null,!1);i.lblContainer=new n.Controls.VLabel;i.cmbContainer=new n.Controls.VComboBox("",!1,!1,!0);i.lblContainer.getControl().text(n.Msg.getMsg("VIS_Container"));i.lblContainer!=null&&i.lblContainer.getControl().css("display","block");i.cmbContainer!=null&&i.cmbContainer.getControl().css("display","block");u=n.Env.getCtx().getContext(i.windowNo,"DocumentNo");i.DocumentNoRef.setValue(u);f=i.initBPartner(!1);i.vBPartner.setReadOnly(!0);e(f)}function f(t,u,f){var s="Y".equals(n.Env.getCtx().getWindowContext(r.windowNo,"IsDropShip")),e=" C_Invoice.C_Invoice_ID IN (SELECT i.C_Invoice_ID FROM C_Invoice i INNER JOIN C_DocType d ON (i.C_DocType_ID = d.C_DocType_ID) WHERE i.C_BPartner_ID="+u+" AND i.IsSOTrx='N' AND i.IsDropShip='"+(s?"Y":"N")+"' AND d.IsReturnTrx='"+(f?"Y":"N")+"' AND i.DocStatus IN ('CL','CO') AND i.TreatAsDiscount = 'N' AND i.C_Invoice_ID IN (SELECT C_Invoice_ID FROM (SELECT il.C_Invoice_ID,il.C_InvoiceLine_ID,il.QtyInvoiced,mi.Qty FROM C_InvoiceLine il  LEFT OUTER JOIN M_MatchInv mi ON (il.C_InvoiceLine_ID=mi.C_InvoiceLine_ID) ",o;e+=n.Utility.Util.getValueOfString(n.Env.getCtx().getContext("$AllowNonItem"))=="N"?" INNER JOIN M_Product Mp On Mp.M_Product_ID = il.M_Product_ID WHERE Mp.ProductType = 'I' AND":" LEFT JOIN M_Product Mp On Mp.M_Product_ID = il.M_Product_ID WHERE";e+=" (il.QtyInvoiced <> nvl(mi.Qty,0) AND mi.C_InvoiceLine_ID IS NOT NULL And Mp.Iscostadjustmentonlost = 'N')  OR (NVL(Mi.Qty,0) = 0 AND Mi.C_Invoiceline_Id IS NOT NULL AND Mp.Iscostadjustmentonlost = 'Y')  OR mi.C_InvoiceLine_ID IS NULL ) t GROUP BY C_Invoice_ID,C_InvoiceLine_ID,QtyInvoiced  HAVING QtyInvoiced > SUM(nvl(Qty,0))))";o=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,0,n.DisplayType.Search,"C_Invoice_ID",0,!1,e);i.cmbInvoice=new n.Controls.VTextBoxButton("C_Invoice_ID",!0,!1,!0,n.DisplayType.Search,o)}function e(t){var r="Y".equals(n.Env.getCtx().getWindowContext(i.windowNo,"IsReturnTrx"));f(n.Env.getCtx(),t,r)}var i=this.$super,r;i.constructor(t);r=this;u();i.jbInit();i.initOK=!0;this.log=n.Logging.VLogger.getVLogger("VCreateFromShipment");this.disposeComponent=function(){i=null;r=null;this.disposeComponent=null}}n.Utility.inheritPrototype(i,n.VCreateFrom);i.prototype.saveMInOut=function(t){var u,i,r,f,e;if(this.$super.dGrid==null||(u={},i=this.$super.multiValues,i==null)||i.length<=0)return this.$super.setBusy(!1),!1;for(r=0;r<i.length;r++)u[r]=i[r];if(f=this.$super.locatorField.getValue(),f==null||f==0)return n.ADialog.info("Error",!0,n.Msg.translate(n.Env.getCtx(),"VIS_locfieldMandatory"),""),this.$super.setBusy(!1),!1;if(u.length==0)return this.$super.setBusy(!1),!1;e=this.$super.cmbContainer.getValue();e===undefined&&(e=0);var o=f,s=this.$super.mTab.getValue("M_InOut_ID"),h=n.Utility.Util.getValueOfInt(this.$super.cmbInvoice.getValue()),c=n.Utility.Util.getValueOfInt(this.$super.cmbOrder.getValue());return this.saveData(u,"",c,h,o,s,e,t)};i.prototype.loadInvoices=function(t,i,r){var u=this.getInvoicesData(n.Env.getCtx(),t,i,r)};i.prototype.getInvoicesData=function(i,r,u,f){var e=this,o,c,s,h;if(this.$super.record_ID=$self.mTab.getValue("M_InOut_ID"),e.$super.dGrid!=null){o=e.$super.dGrid.getSelection();for(item in o)c=t.grep(e.$super.multiValues,function(n){return n.M_Product_ID_K==e.$super.dGrid.get(o[item]).M_Product_ID_K&&n.C_Invoice_ID_K==e.$super.dGrid.get(o[item]).C_Invoice_ID_K}),c.length>0||e.$super.multiValues.push(e.$super.dGrid.get(o[item]))}return s="",h="",s=n.Env.isBaseLanguage(i,"C_UOM")?"FROM C_UOM uom INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID) ":"FROM C_UOM_Trl uom Left join C_UOM uom1 on (uom1.C_UOM_ID=uom.C_UOM_ID) INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='"+n.Env.getAD_Language(i)+"') ",u!=null&&(h=" AND l.M_Product_ID = "+u),f||(f=1),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetInvoicesDataVCreate",dataType:"json",type:"POST",data:{keyColumnName:e.$super.mTab.keyColumnName,tableName:"C_InvoiceLine",recordID:e.$super.record_ID,pageNo:f,isBaseLangss:s,cInvoiceID:r,mProductIDs:h},error:function(t){alert(n.Msg.getMsg("ErrorWhileGettingData"));selfChild.log.info(t);e.$super.setBusy(!1);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);e.$super.setBusy(!1);return}e.$super.resetPageCtrls(i.pSetting);e.$super.loadGrid(i.data);e.$super.setBusy(!1)}}),[]};i.prototype.initContainerDetails=function(){this.$super.cmbContainer.getControl().html("")};i.prototype.loadInvoice=function(t){var i=this.getInvoiceData(n.Env.getCtx(),t);this.$super.loadGrid(i)};i.prototype.getInvoiceData=function(t,i){var o=[],f="SELECT round((l.QtyInvoiced-SUM(COALESCE(mi.Qty,0))) * (CASE WHEN l.QtyInvoiced=0 THEN 0 ELSE l.QtyEntered/l.QtyInvoiced END ),2) as QUANTITY,round((l.QtyInvoiced-SUM(COALESCE(mi.Qty,0))) * (CASE WHEN l.QtyInvoiced=0 THEN 0 ELSE l.QtyEntered/l.QtyInvoiced END ),2) as QTYENTER, l.C_UOM_ID,COALESCE(uom.UOMSymbol,uom.Name), l.M_Product_ID,p.Name, l.C_InvoiceLine_ID,l.Line, l.C_OrderLine_ID ",u,e;f=n.Env.isBaseLanguage(t,"C_UOM")?f.concat("FROM C_UOM uom ").concat("INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID) "):f.concat("FROM C_UOM_Trl uom ").concat("INNER JOIN C_InvoiceLine l ON (l.C_UOM_ID=uom.C_UOM_ID AND uom.AD_Language='").concat(n.Env.getAD_Language(t)).concat("') ");f=f.concat("INNER JOIN M_Product p ON (l.M_Product_ID=p.M_Product_ID) ").concat("LEFT OUTER JOIN M_MatchInv mi ON (l.C_InvoiceLine_ID=mi.C_InvoiceLine_ID) ").concat("WHERE l.C_Invoice_ID="+i+" GROUP BY l.QtyInvoiced,l.QtyEntered,l.C_UOM_ID,COALESCE(uom.UOMSymbol,uom.Name),l.M_Product_ID,p.Name, l.C_InvoiceLine_ID,l.Line,l.C_OrderLine_ID ORDER BY l.Line");u=null;try{for(u=n.DB.executeReader(f.toString(),null,null),e=1;u.read();){var r={},s=u.getDecimal(0),h=u.getDecimal(1);r.Quantity=s;r.QuantityEntered=h;r.C_UOM_ID=u.getString(3);r.M_Product_ID=u.getString(5);r.C_Order_ID=".";r.M_InOut_ID=null;r.C_Invoice_ID=u.getString(7);r.C_UOM_ID_K=u.getString(2);r.M_Product_ID_K=u.getInt(4);r.C_Order_ID_K=u.getInt(8);r.M_InOut_ID_K=null;r.C_Invoice_ID_K=u.getInt(6);r.recid=e;e++;o.push(r)}u.close()}catch(c){}return o};i.prototype.saveData=function(i,r,u,f,e,o,s,h){var c=this;console.log(e);t.ajax({type:"POST",url:n.Application.contextUrl+"Common/SaveShipment",dataType:"json",data:{model:i,selectedItems:r,C_Order_ID:u,C_Invoice_ID:f,M_Locator_ID:e,M_InOut_ID:o,Container_ID:s},success:function(n){if(returnValue=n.result,returnValue){h?c.$super.callBackSave(returnValue):(c.dispose(),c.$super.setBusy(!1),c.$super.$root.dialog("close"));return}},error:function(n,t,i){console.log(t);c.$super.setBusy(!1);alert(i)}})};i.prototype.dispose=function(){this.disposeComponent!=null&&this.disposeComponent()};n.VCreateFromShipment=i}(VIS,jQuery),function(n,t){function i(t){function f(){var f,e,t;return i.mTab.getValue("C_BankStatement_ID")==null?(n.ADialog.error(n.Msg.getMsg("SaveErrorRowNotFound",!0)),!1):(i.title=n.Msg.getElement(n.Env.getCtx(),"C_BankStatement_ID",!1)+" .. "+n.Msg.getMsg("CreateFrom"),i.relatedToOrg=null,i.lblOrder!=null&&i.lblOrder.getControl().css("display","none"),i.cmbOrder!=null&&i.cmbOrder.getControl().css("display","none"),i.lblShipment!=null&&i.lblShipment.getControl().css("display","none"),i.cmbShipment!=null&&i.cmbShipment.getControl().css("display","none"),i.lblInvoice!=null&&i.lblInvoice.getControl().css("display","none"),i.cmbInvoice!=null&&i.cmbInvoice.getControl().css("display","none"),f=4917,e=n.MLookupFactory.getMLookUp(n.Env.getCtx(),u,f,n.DisplayType.TableDir),i.cmbBankAccount=new n.Controls.VComboBox("C_BankAccount_ID",!0,!0,!0,e,150,n.DisplayType.TableDir,0),i.Date=new n.Controls.VDate("Date",!1,!1,!0,n.DisplayType.Date,"Date"),i.DocumentNo=new n.Controls.VTextBox("DocumentNo",!1,!1,!0,50,100,null,null,!1),i.Amount=new n.Controls.VAmountTextBox("Amount",!1,!1,!0,50,100,n.DisplayType.Amount,n.Msg.getMsg("Amount")),i.DepositSlip=new n.Controls.VTextBox("DepositSlip",!1,!1,!0,50,100,null,null,!1),i.AuthCode=new n.Controls.VTextBox("AuthCode",!1,!1,!0,50,100,null,null,!1),i.CheckNo=new n.Controls.VTextBox("CheckNo",!1,!1,!0,50,100,null,null,!1),i.cmbBankAccount.getControl().prop("selectedIndex",0),t=n.Env.getCtx().getContextAsInt(u,"C_BankAccount_ID"),i.cmbBankAccount.setValue(t),r.initBPartner(t),r.loadBankAccounts(t,0,"","","","","","0",1),i.btnRefresh&&i.btnRefresh.css("display","black"),!0)}var i=this.$super,r,u;i.constructor(t);r=this;u=t.getWindowNo();f();i.jbInit();i.initOK=!0;i.middelDiv.css("height","61%");this.disposeComponent=function(){this.disposeComponent=null}}function u(n,i,r){var u=null;return t.ajax({url:e,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(n)}).done(function(n){u=n;r&&r(n)}),u}var f,o;n.Utility.inheritPrototype(i,n.VCreateFrom);i.prototype.initBPartner=function(t){var i=this.$super,r=" C_BPartner.C_BPartner_ID IN (SELECT  p.C_BPartner_ID as C_BPartner_ID FROM C_Payment p WHERE p.Processed='Y' AND p.IsReconciled='N' AND p.DocStatus IN ('CO','CL','RE','VO') AND p.PayAmt<>0 AND p.C_BankAccount_ID = "+t+" AND NOT EXISTS (SELECT * FROM C_BankStatementLine l WHERE p.C_Payment_ID=l.C_Payment_ID AND l.StmtAmt <> 0) )",u=n.MLookupFactory.get(n.Env.getCtx(),this.windowNo,5398,n.DisplayType.Search,"C_BPartner_ID",0,!1,r);i.vBPartner=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,u)};i.prototype.getTableFieldVOs=function(){var t=this.$super,i;t.arrListColumns=[];t.arrListColumns.push({field:"Date",caption:n.Msg.getMsg("DateAcct"),sortable:!0,size:"100px",hidden:!1,editable:{type:"date"},render:function(n){var t=n.Date;return new Date(t).toLocaleDateString()}});t.arrListColumns.push({field:"C_Payment_ID",caption:n.Msg.getMsg("Payment"),sortable:!0,size:"100px",hidden:!1});t.arrListColumns.push({field:"C_Currency_ID",caption:n.Msg.getMsg("Currency"),sortable:!0,size:"80px",hidden:!1});i=n.Utility.Util.getValueOfInt(f("VIS_145"));i>0&&t.arrListColumns.push({field:"VA034_DepositSlipNo",caption:n.Msg.getMsg("DepositSlipNo"),sortable:!0,size:"100px",hidden:!1});t.arrListColumns.push({field:"AuthCode",caption:n.Msg.getMsg("AuthCode"),sortable:!0,size:"100px",hidden:!1});t.arrListColumns.push({field:"CheckNo",caption:n.Msg.getMsg("CheckNo"),sortable:!0,size:"80px",hidden:!1});t.arrListColumns.push({field:"Amount",caption:n.Msg.getMsg("Amount"),sortable:!0,size:"80px",hidden:!1,render:function(t){var i=n.Utility.Util.getValueOfDecimal(t.Amount);return i.toLocaleString()}});t.arrListColumns.push({field:"ConvertedAmount",caption:n.Msg.getMsg("ConvertedAmount"),sortable:!0,size:"80px",hidden:!1,render:function(t){var i=n.Utility.Util.getValueOfDecimal(t.ConvertedAmount);return i.toLocaleString()}});t.arrListColumns.push({field:"Description",caption:n.Msg.getMsg("Description"),sortable:!0,size:"250px",hidden:!1});t.arrListColumns.push({field:"C_BPartner_ID",caption:n.Msg.getMsg("BusinessPartner"),sortable:!0,size:"150px",hidden:!1});t.arrListColumns.push({field:"Type",caption:n.Msg.getMsg("Type"),sortable:!0,size:"80px",hidden:!0});t.arrListColumns.push({field:"C_Payment_ID_K",caption:n.Msg.getMsg("Payment"),sortable:!0,size:"150px",hidden:!0});t.arrListColumns.push({field:"C_Currency_ID_K",caption:n.Msg.getMsg("Currency"),sortable:!0,size:"150px",hidden:!0})};i.prototype.loadBankAccounts=function(t,i,r,u,f,e,o,s,h){var c=this.$super,l=c.mTab.getValue("StatementDate"),a=this.getBankAccountsData(n.Env.getCtx(),t,i,r,l,u,f,e,o,s,h);this.getTableFieldVOs()};i.prototype.getBankAccountsData=function(i,r,u,f,e,o,s,h,c,l,a){var v=this,y,p,nt,tt;if(v.$super.dGrid!=null){y=v.$super.dGrid.getSelection();for(item in y)p=t.grep(v.$super.multiValues,function(n){return n.C_Payment_ID_K==v.$super.dGrid.get(y[item]).C_Payment_ID_K}),p.length>0||v.$super.multiValues.push(v.$super.dGrid.get(y[item]))}e==null&&(e=DateTime.Today.Date);var it=n.DB.to_date(e,!0),w="",b="",k="0",d="",g="";return u>0&&(k=" AND p.C_BPartner_ID = "+u),o!=""&&(d=" AND p.DocumentNo LIKE '"+o+"'"),f!=""&&f!=null&&(nt=n.DB.to_date(f,!0),w=" AND p.DateAcct = "+nt),o!=""&&(g=" AND cs.DocumentNo LIKE '"+o+"'"),f!=""&&f!=null&&(tt=n.DB.to_date(f,!0),b=" AND cs.DateAcct = "+tt),a||(a=1),t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetBankAccountsData",dataType:"json",type:"POST",data:{pageNo:a,dates:it,trxDatess:w,trxDatesUnions:b,cBPartnerIDs:k,DocumentNos:d,DocumentNoUnions:g,DepositSlips:s,AuthCodes:h,CheckNos:c,Amounts:l,cBankAccountId:r},error:function(){alert(n.Msg.getMsg("ErrorWhileGettingData"));v.$super.setBusy(!1);return},success:function(t){var i=JSON.parse(t);if(i.Error){n.ADialog.error(i.Error);v.$super.setBusy(!1);return}v.$super.resetPageCtrls(i.pSetting);v.$super.loadGrid(i.data);v.$super.setBusy(!1)}}),[]};i.prototype.loadBankAccount=function(t){var i=this.$super,r=i.mTab.getValue("StatementDate"),u=this.getBankAccountData(n.Env.getCtx(),t,r);this.getTableFieldVOs();setTimeout(function(){i.loadGrid(u)},10)};i.prototype.getBankAccountData=function(i,r,u){var s=[],f,o,e;try{for(u==null&&(u=DateTime.Today.Date),f=null,t.ajax({url:n.Application.contextUrl+"Form/GetBankAccontData",async:!1,data:{C_BankAccount_ID:r,ts:u}}).done(function(t){f=(new n.DB.DataReader).toJson(t)}),o=1;f.read();)e={},e.Date=f.getString(0),e.C_Payment_ID=f.getString(2),e.C_Currency_ID=f.getString(4),e.Amount=f.getDecimal(5),e.ConvertedAmount=f.getDecimal(6),e.C_BPartner_ID=f.getString(7),e.Type=f.getString(8),e.C_Payment_ID_K=f.getString(1),e.C_Currency_ID_K=f.getInt(3),e.recid=o,o++,s.push(e)}catch(h){}return s};var r=n.Application.contextUrl,e=r+"JsonData/JDataSetWithCode",s=r+"JsonData/ExecuteNonQuer";f=function(t,i,r){var e=r?!0:!1,o={sql:t,page:1,pageSize:0},f=null;return u(o,e,function(t){i=(new n.DB.DataSet).toJson(t);var i=(new n.DB.DataSet).toJson(t);f=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null;i.dispose();i=null;e&&r(f)}),f};o=function(t,i,r){var o=r?!0:!1,e={sql:t,page:1,pageSize:0},f;return i&&(e.param=i),f=null,u(e,o,function(t){f=(new n.DB.DataReader).toJson(t);r&&r(f)}),f};i.prototype.saveStatment=function(){var n;if(this.$super.dGrid==null)return!1;var r=this.$super.mTab.getValue("C_BankStatement_ID"),i={},t=this.$super.multiValues;if(t==null||t.length<=0)return!1;for(n=0;n<t.length;n++)i[n]=t[n];return this.saveData(i,"",r)};i.prototype.saveData=function(i,r,u){var f=this;t.ajax({type:"POST",url:n.Application.contextUrl+"Common/SaveStatment",dataType:"json",data:{model:i,selectedItems:r,C_BankStatement_ID:u},success:function(n){if(returnValue=n.result,returnValue){f.dispose();f.$super.$root.dialog("close");f.$super.setBusy(!1);return}f.$super.setBusy(!1);alert(returnValue)},error:function(n,t,i){console.log(t);f.$super.setBusy(!1);alert(i)}})};i.prototype.dispose=function(){this.disposeComponent!=null&&this.disposeComponent()};n.VCreateFromStatement=i}(VIS,jQuery),function(n,t){function i(i,r,u){var f,e;this.windowNo=i;this.AD_Client_ID=r;this.AD_Org_ID=0;this.DateFrom=null;this.DateTo=null;f=this;this.ASchemas=[];this.ASchema=[];this.log=n.Logging.VLogger.getVLogger("AccountViewer");this.dataByData=null;this._elements=[];this.documentQuery=!1;this.C_AcctSchema_ID=0;this.PostingType="";this.AD_Table_ID=u;this.Record_ID=0;this.whereInfo=[];this.tableInfo=[];this.displayQty=!1;this.displaySourceAmt=!1;this.displayDocumentInfo=!1;this.sortBy1="";this.sortBy2="";this.sortBy3="";this.sortBy4="";this.group1=!1;this.group2=!1;this.group3=!1;this.group4=!1;this._leadingColumns=0;this._ref1=null;this._ref2=null;this.TABLE_ALIAS="zz";this.FUNCTION_COUNT="Count";this.FUNCTION_SUM="Sum";this.onLoaded=null;this.HasOrgUnit=null;this.AD_Client_ID==0&&(this.AD_Client_ID=n.Env.getCtx().getContextAsInt(this.windowNo,"AD_Client_ID"));this.AD_Client_ID==0&&(this.AD_Client_ID=n.Env.getCtx().ctx.AD_Client_ID);this.AD_Org_ID==0&&(this.AD_Org_ID=Number(n.context.getWindowTabContext(this.windowNo,0,"AD_Org_ID")));e=["AmtAcctCr","AmtAcctDr","AmtSourceCr","AmtSourceDr",];n.translatedTexts=n.Msg.translate(n.Env.getCtx(),e,!0);this.ELEMENTTYPE_AD_Reference_ID=181;this.ELEMENTTYPE_Account="AC";this.ELEMENTTYPE_Activity="AY";this.ELEMENTTYPE_BPartner="BP";this.ELEMENTTYPE_LocationFrom="LF";this.ELEMENTTYPE_LocationTo="LT";this.ELEMENTTYPE_Campaign="MC";this.ELEMENTTYPE_Organization="OO";this.ELEMENTTYPE_OrgTrx="OT";this.ELEMENTTYPE_Project="PJ";this.ELEMENTTYPE_Product="PR";this.ELEMENTTYPE_SubAccount="SA";this.ELEMENTTYPE_SalesRegion="SR";this.ELEMENTTYPE_UserList1="U1";this.ELEMENTTYPE_UserList2="U2";this.ELEMENTTYPE_UserElement1="X1";this.ELEMENTTYPE_UserElement2="X2";this.getClientAcctSchema=function(i,r){var e=[],u=this;return t.ajax({url:n.Application.contextUrl+"AcctViewerData/GetClientAcctSchema",type:"POST",async:!0,data:{ad_client_id:i,ad_org_id:r},success:function(t){var r,f,o,i,s;if(t.result&&t.result.AcctSchemas)for(r=t.result.AcctSchemas,i=0;i<r.length;i++)f={},c_acctschema_id=r[i].Key,f.Key=c_acctschema_id,f.Name=n.Utility.encodeText(r[i].Name),e.push(f);if(t.result&&t.result.OtherAcctSchemas)for(o=t.result.OtherAcctSchemas,i=0;i<o.length;i++)s={},s.Key=o[i].Key,s.Name=n.Utility.encodeText(o[i].Name),e.push(s);u.ASchemas=e;u.ASchema=e[0];u.onLoaded&&u.onLoaded()},error:function(n){f.log.info(n);u.onLoaded&&u.onLoaded()}}),e};this.getClientAcctSchema(this.AD_Client_ID,this.AD_Org_ID)}function r(r,u,f,e,o){function wf(){uf.getControl().text(n.Msg.getMsg("Selection"));wr.getControl().text(n.Msg.translate(n.Env.getCtx(),cr));li.getControl().text(n.Msg.translate(n.Env.getCtx(),cr));br.getControl().text(n.Msg.translate(n.Env.getCtx(),yu));et.find("label").text(n.Msg.getMsg(pu));gr.getControl().text(n.Msg.translate(n.Env.getCtx(),lr));nu.getControl().text(n.Msg.translate(n.Env.getCtx(),wi));kr.getControl().text(n.Msg.translate(n.Env.getCtx(),wu));dr.getControl().text(n.Msg.translate(n.Env.getCtx(),"AcctDateTo"));tu.getControl().text(n.Msg.translate(n.Env.getCtx(),vr));iu.getControl().text(n.Msg.translate(n.Env.getCtx(),yr));ru.getControl().text(n.Msg.translate(n.Env.getCtx(),"Project"));ku.getControl().text(n.Msg.translate(n.Env.getCtx(),pr));rf.getControl().text(n.Msg.translate(n.Env.getCtx(),"OrganizationUnit"));ff.getControl().text(n.Msg.getMsg("Display"));tr.find("label").text(n.Msg.getMsg("DisplayQty"));ur.find("label").text(n.Msg.getMsg("DisplaySourceInfo"));rr.find("label").text(n.Msg.getMsg("DisplayDocumentInfo"));uu.getControl().text(n.Msg.getMsg("SortBy"));fu.getControl().text(n.Msg.getMsg("GroupBy"));lt.getControl().css("color","rgba(var(--v-c-primary), 1)");v.text(n.Msg.getMsg("RePost"));notShowPosted?(v.hide(),tt.find("label").text(n.Msg.getMsg("Force")),tt.hide()):(v.show(),tt.find("label").text(n.Msg.getMsg("Force")),tt.show())}function cu(){hi.css("color","rgba(var(--v-c-on-secondary), 1)");si.css("font-size","1rem").css("color","rgba(var(--v-c-primary), 1)");wt.show();b.show();ulPaging.css("display","none");divPaging.css("display","none");ii.css("display","none");v.hide();tt.hide();it.show();lt.getControl().show();ir.hide();li.getControl().hide();nt.getControl().hide();b.find("#btnSelctDoc_"+h).attr("name",b.find("#btnSelctDoc_"+h).parent().find("select").val()+"_ID");b.find("#btnSelctDocClear_"+h).attr("name",b.find("#btnSelctDocClear_"+h).parent().find("select").val()+"_ID")}function or(){si.css("color","rgba(var(--v-c-on-secondary), 1)");hi.css("font-size","1rem").css("color","rgba(var(--v-c-primary), 1)");wt.hide();b.hide();ulPaging.css("display","block");divPaging.css("display","block");ir.show();it.hide();lt.getControl().hide();divPaging.append(ulPaging);at.append(divPaging);ii.css("display","block");notShowPosted?(v.hide(),tt.hide()):(v.show(),tt.show());li.getControl().show();nt.getControl().show()}function bf(){divPaging=t('<div class="vis-info-pagingwrp" style="text-align: right; flex: 1;">');ulPaging=t('<ul class="vis-statusbar-ul">');liFirstPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="'+n.Msg.getMsg("FirstPage")+'" style="opacity: 0.6;"><\/i><\/div><\/li>');liPrevPage=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="'+n.Msg.getMsg("PageUp")+'" style="opacity: 0.6;"><\/i><\/div><\/li>');cmbPage=t("<select>");liCurrPage=t("<li>").append(cmbPage);liNextPage=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="'+n.Msg.getMsg("PageDown")+'" style="opacity: 0.6;"><\/i><\/div><\/li>');liLastPage=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="'+n.Msg.getMsg("LastPage")+'" style="opacity: 0.6;"><\/i><\/div><\/li>');ulPaging.append(liFirstPage).append(liPrevPage).append(liCurrPage).append(liNextPage).append(liLastPage);kf()}function kf(){liFirstPage.on("click",function(){t(this).css("opacity")=="1"&&(l(!0),s.Query(r,ri,ui,1))});liPrevPage.on("click",function(){t(this).css("opacity")=="1"&&(l(!0),s.Query(r,ri,ui,parseInt(cmbPage.val())-1))});liNextPage.on("click",function(){t(this).css("opacity")=="1"&&(l(!0),s.Query(r,ri,ui,parseInt(cmbPage.val())+1))});liLastPage.on("click",function(){t(this).css("opacity")=="1"&&(l(!0),s.Query(r,ri,ui,parseInt(cmbPage.find("Option:last").val())))});cmbPage.on("change",function(){l(!0);s.Query(r,ri,ui,cmbPage.val())})}function l(n){hr.css("display",n?"block":"none")}function df(i){var e,s,o,u,f,r,l;for(c.dGrid!=null&&(c.dGrid.destroy(),c.dGrid=null),c.arrListColumns=[],e=[],s=1,o=0;o<i.Data.length;o++){for(u=i.Data[o],ir.text(i.DebitandCredit),f={},r=0;r<i.Columns.length;r++)c.arrListColumns.length!=i.Columns.length&&(u[r]!=null&&typeof u[r]=="number"&&(n.translatedTexts.AmtAcctCr==i.Columns[r]||n.translatedTexts.AmtAcctDr==i.Columns[r]||n.translatedTexts.AmtSourceCr==i.Columns[r]||n.translatedTexts.AmtSourceDr==i.Columns[r])?c.arrListColumns.push({field:i.Columns[r],caption:n.Msg.translate(n.Env.getCtx(),i.Columns[r]),sortable:!0,size:"16%",hidden:!1,style:"text-align: right"}):c.arrListColumns.push({field:i.Columns[r],caption:n.Msg.translate(n.Env.getCtx(),i.Columns[r]),sortable:!0,size:"16%",hidden:!1})),u[r]!=null&&typeof u[r]=="object"?f[i.Columns[r]]=u[r].Name:u[r]!=null&&i.Columns[r].indexOf("Date")>0?u[r]!=""&&(l=new Date(parseInt(u[r].substr(6))),e!=null&&(f[i.Columns[r]]=l.toLocaleDateString())):f[i.Columns[r]]=u[r]!=null&&typeof u[r]=="number"&&(n.translatedTexts.AmtAcctCr==i.Columns[r]||n.translatedTexts.AmtAcctDr==i.Columns[r]||n.translatedTexts.AmtSourceCr==i.Columns[r]||n.translatedTexts.AmtSourceDr==i.Columns[r])?parseFloat(u[r]).toLocaleString(undefined,{minimumFractionDigits:i.Precision,maximumFractionDigits:i.Precision}):u[r];f.recid=s;s++;e.push(f)}setTimeout(10);w2utils.encodeTags(e);c.dGrid=t(ii).w2grid({name:"gridAccViewer"+h,recordHeight:37,columns:c.arrListColumns,records:e})}function vt(n){var i=n.attr("name"),t;return n.find("span").text(" "),s.whereInfo.length>0&&(t=s.whereInfo.map(function(n){return n.Key==i}).indexOf(!0),s.whereInfo.splice(t,1)),n.width=44,0}function gf(){if(si!=null)si.on(n.Events.onTouchStartOrClick,function(){cu()});if(hi!=null)hi.on(n.Events.onTouchStartOrClick,function(){c.dGrid.refresh();or()});if(yt!=null&&yt.getControl().change(function(){ef()}),nt!=null&&nt.getControl().change(function(){l(!0);s.C_AcctSchema_ID=nt.getControl().find("option:selected").val();setTimeout(function(){s.Query(r,ri,ui,1)},2)}),it!=null)it.on("click",function(){l(!0);nt.setValue(yt.getControl().find("option:selected").val());sr();l(!1)});if(et!=null&&et.change(function(){of()}),pt!=null&&pt.getControl().change(function(){sf();s.Record_ID=f;s.AD_Table_ID}),v!=null)v.on("click",function(){l(!0);var n=re();setTimeout(function(){n?ne(s.Record_ID):l(!1)},5)});if(a!=null)a.on("click",function(){fi(a)});if(k!=null)k.on("click",function(){fi(k)});if(y!=null)y.on("click",function(){fi(y)});if(p!=null)p.on("click",function(){fi(p)});if(w!=null)w.on("click",function(){fi(w)});if(d!=null)d.on("click",function(){fi(d)});if(g!=null)g.on("click",function(){fi(g)});if(ot!=null)ot.on("click",function(){vt(a)});if(st!=null)st.on("click",function(){vt(k)});if(rt!=null)rt.on("click",function(){vt(y)});if(ut!=null)ut.on("click",function(){vt(p)});if(ft!=null)ft.on("click",function(){vt(w)});if(ht!=null)ht.on("click",function(){vt(d)});if(ct!=null)ct.on("click",function(){vt(g)})}function ne(i){t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerRePost",type:"POST",async:!0,data:{dataRecID:i},success:function(){},error:function(n){$selfObj.log.info(n);l(!1)}})}function te(){var u,f;notShowPosted=n.Env.getCtx().getContext("#SHOW_REPOST").equals("N");fr=t("<div id='topDiv_"+h+"' style='float: left; width: 100%;'><div id='queryDiv_"+h+"'style='display: inline-block; margin-right: 15px; margin-top: 5px' ><label id='lblquery_"+h+"' class='VIS_Pref_Label_Font' style='cursor: pointer;font-size: 1rem;color: rgba(var(--v-c-primary), 1);'>"+n.Msg.getMsg("ViewerQuery")+"<\/label><\/div><div id='resulttopDiv_"+h+"' style='display: inline-block; width: 160px;'><label id='lblresult_"+h+"' class='VIS_Pref_Label_Font' style='vertical-align: middle; cursor: pointer;'>"+n.Msg.getMsg("ViewerResult")+"<\/label><\/div><\/div><\/div>");var l=t("<div id='resultTopFilterDiv_"+h+"' style='float: right;width: 50%;'>"),d=t('<div class="input-group vis-input-wrap">'),ht=t('<div class="vis-control-wrap">');l.append(d);d.append(ht);ht.append(nt.getControl()).append(li.getControl());fr.append(l);b=t("<div class='vis-leftsidebarouterwrap' id='leftSideDiv_"+h+"' style='float: left;background-color: rgba(var(--v-c-secondary), 1);overflow: auto;padding: 10px;'>");n.Application.isRTL&&b.css("float","right");b.css("width","50%");b.css("height",er);ti=t("<div style='float: left;width: 100%;height: 100%;' id='parameterLeftDiv_"+h+"'>");b.append(ti);var e=t("<table style='width: 100%;height: 100%;'>"),r=t("<tr>"),i=t("<td>"),u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">');ti.append(e);e.append(r);r.append(i);i.append(u);u.append(f);f.append(yt.getControl()).append(wr.getControl());r=t("<tr>");u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);f.append(bi.getControl()).append(br.getControl());r=t("<tr>");i=t("<td>");u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');e.append(r);r.append(i);i.append(u);u.append(f);f.append(et);r=t("<tr>");i=t("<td>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');e.append(r);r.append(i);i.append(u);u.append(f);u.append(o);f.append(pt.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," "));o.append(a).append(ot);r=t("<tr>");u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);f.append(ai).append(kr.getControl());r=t("<tr>");u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);f.append(vi).append(dr.getControl());r=t("<tr>");u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);f.append(oi.getControl()).append(gr.getControl());r=t("<tr>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">'),s=t('<input type="text" readonly data-hasbtn=" ">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);u.append(o);f.append(s).append(nu.getControl());o.append(k).append(st);r=t("<tr>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">'),s=t('<input type="text" readonly data-hasbtn=" ">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);u.append(o);f.append(s).append(rf.getControl());o.append(g).append(ct);r=t("<tr>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">'),s=t('<input type="text" readonly data-hasbtn=" ">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);u.append(o);f.append(s).append(tu.getControl());o.append(y).append(rt);r=t("<tr>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">'),s=t('<input type="text" readonly data-hasbtn=" ">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);u.append(o);f.append(s).append(iu.getControl());o.append(p).append(ut);r=t("<tr>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">'),s=t('<input type="text" readonly data-hasbtn=" ">');e.append(r);i=t("<td>");r.append(i);i.append(u);u.append(f);u.append(o);f.append(s).append(ru.getControl());o.append(w).append(ft);wt=t("<div id='rightSideDiv_"+h+"' style='float: right;margin-bottom: 3px; margin-right: 0px; '>");wt.css("width","50%");wt.css("height",er);ti=t("<div style='float: left;width: 100%;height: 100%;' id='parameterRightDiv_"+h+"'>");wt.append(ti);e=t("<table style='width: 100%;height: 100%;'>");r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");ti.append(e);e.append(r);r.append(i);i.append(rr);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(ur);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(tr);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(uu.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));i=t("<td style='padding: 0px 15px 0px;'>");r.append(i);i.append(fu.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(kt.getControl().css("display","inline-block").css("width","100%").css("height","32px"));i=t("<td style='padding: 0px 15px 0px;'>");r.append(i);i.append(eu);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(dt.getControl().css("display","inline-block").css("width","100%").css("height","32px"));i=t("<td style='padding: 0px 15px 0px;'>");r.append(i);i.append(ou);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(gt.getControl().css("display","inline-block").css("width","100%").css("height","32px"));i=t("<td style='padding: 0px 15px 0px;'>");r.append(i);i.append(su);r=t("<tr>");i=t("<td style='padding: 0px 15px 0px;'>");e.append(r);r.append(i);i.append(ni.getControl().css("display","inline-block").css("width","100%").css("height","32px"));i=t("<td style='padding: 0px 15px 0px;'>");r.append(i);i.append(hu);at=t("<div class='vis-acctviewerbottdiv'>");c.getIsMenu()||(at.append(v),at.append(tt).append(ir));at.append(lt.getControl().addClass("VIS_Pref_Label_Font"));at.append(it);at.append(ci);ii=t("<div id='resultDiv_"+h+"' style='float: left; width: 100%; display: none;'>");ii.css("height",er);bt.append(fr).append(b).append(wt).append(ii).append(at);bt.append(hr)}function ie(t,u){s=new i(h,r,t);s.onLoaded=function(){pi(yt.getControl(),s.getAcctSchema());nt.getControl().append("<option value='-1' ><\/option>");pi(nt.getControl(),s.getAcctSchema());ef();pi(pt.getControl(),s.getTable());pi(bi.getControl(),s.getPostingType());pi(oi.getControl(),s.getOrg());a.find("span").text("");k.attr("Name",wi);st.attr("Name",wi);k.find("span").text("");y.attr("Name",vr);rt.attr("Name",vr);y.find("span").text("");p.attr("Name",yr);ut.attr("Name",yr);p.find("span").text("");w.attr("Name",bu);ft.attr("Name",bu);w.find("span").text("");d.attr("Name",pr);ht.attr("Name",pr);d.find("span").text("");g.attr("Name",ar);ct.attr("Name",ar);g.find("span").text("");var i=t!=0&&u!=0;i&&et.find("input").prop("checked",!0);of();sf();lt.getControl().text(n.Msg.getMsg("VIS_EnterSelctionAndDisplayToQueryFind"));lt.getControl().css("color","rgba(var(--v-c-primary), 1)");i&&(s.AD_Table_ID=t,s.Record_ID=u);sr()}}function ef(){var o=yt.getControl().find("option:selected").val(),e,r,t,i,u;if(o!=null){for(s.C_AcctSchema_ID=o,e=s.getAcctSchemaElements(s.C_AcctSchema_ID),kt.getControl().empty(),dt.getControl().empty(),gt.getControl().empty(),ni.getControl().empty(),yi({Key:"",Name:""}),yi({Key:"DateAcct",Name:n.Msg.translate(n.Env.getCtx(),"DateAcct")}),yi({Key:"DateTrx",Name:n.Msg.translate(n.Env.getCtx(),"DateTrx")}),yi({Key:"C_Period_ID",Name:n.Msg.translate(n.Env.getCtx(),"C_Period_ID")}),r=[],r.push(du),r.push(gu),r.push(nf),r.push(tf),t=[],t.push(y),t.push(p),t.push(w),t.push(d),t.push(rt),t.push(ut),t.push(ft),t.push(ht),t.push(ki),t.push(di),t.push(gi),t.push(nr),t.push(g),t.push(ct),i=0,u=0;u<e.length&&i<r.length;u++){var f=e[u][0],h=s.getColumnName(f.elementtype),c=s.getColumnName(f.elementtype);yi({Key:h,Name:n.Msg.translate(n.Env.getCtx(),c)});f.elementtype=="OO"||f.elementtype=="AC"||(r[i].getControl().text(n.Msg.translate(n.Env.getCtx(),c)),r[i].getControl().show(),t[i].attr("Name",h),t[i].find("span").text(""),t[i].show(),i++)}while(i<r.length)r[i].getControl().hide(),i++;kt.getControl().prop("selectedIndex",0);dt.getControl().prop("selectedIndex",0);gt.getControl().prop("selectedIndex",0);ni.getControl().prop("selectedIndex",0)}}function yi(n){kt.getControl().append(" <option selected value='"+n.Key+"' >"+n.Name+"<\/option>");dt.getControl().append(" <option selected value='"+n.Key+"' >"+n.Name+"<\/option>");gt.getControl().append(" <option selected value='"+n.Key+"' >"+n.Name+"<\/option>");ni.getControl().append(" <option selected value='"+n.Key+"' >"+n.Name+"<\/option>")}function sr(){var t="",i,u,f,e;if(s.C_AcctSchema_ID=0,s.AD_Org_ID=0,i=yt.getControl().find("option:selected").val(),i!=null&&(s.C_AcctSchema_ID=i),t=t.concat("C_AcctSchema_ID=").concat(s.C_AcctSchema_ID),i=bi.getControl().find("option:selected").val(),i!=null&&i!="0"&&(s.PostingType=i),t=t.concat(", PostingType=").concat(s.PostingType),s.documentQuery=et.find("input").prop("checked"),t=t.concat(", DocumentQuery=").concat(s.documentQuery),et.find("input").prop("checked")){if(s.AD_Table_ID==0||s.Record_ID==0)return;t=t.concat(", AD_Table_ID=").concat(s.AD_Table_ID).concat(", Record_ID=").concat(s.Record_ID)}else if(s.DateFrom=ai.val(),s.DateFrom!=""&&(t=t.concat(", DateFrom=").concat(s.DateFrom)),s.DateTo=vi.val(),s.DateTo!=""&&(t=t.concat(", DateTo=").concat(s.DateTo)),i=oi.getControl().find("option:selected").val(),i!=null&&(s.AD_Org_ID=i),t=t.concat(", AD_Org_ID=").concat(s.AD_Org_ID),u=s.whereInfo,u!=null)for(f=0;f<u.length;f++)t=t.concat(", ").concat(u[f].Value);s.displayQty=tr.prop("checked");t=t.concat(", - Display Qty=").concat(s.displayQty);s.displaySourceAmt=ur.prop("checked");t=t.concat(", Source=").concat(s.displaySourceAmt);s.displayDocumentInfo=rr.prop("checked");t=t.concat(", Doc=").concat(s.displayDocumentInfo);kt.getControl().find("option:selected").val()!=null&&(s.sortBy1=kt.getControl().find("option:selected").val());s.group1=eu.prop("checked");t=t.concat(" - Sorting: ").concat(s.sortBy1).concat("/").concat(s.group1);dt.getControl().find("option:selected").val()!=null&&(s.sortBy2=dt.getControl().find("option:selected").val());s.group2=ou.prop("checked");t=t.concat(", ").concat(s.sortBy2).concat("/").concat(s.group2);gt.getControl().find("option:selected").val()!=null&&(s.sortBy3=gt.getControl().find("option:selected").val());s.group3=su.prop("checked");t=t.concat(", ").concat(s.sortBy3).concat("/").concat(s.group3);ni.getControl().find("option:selected").val()!=null&&(s.sortBy4=ni.getControl().find("option:selected").val());s.group4=hu.prop("checked");t=t.concat(", ").concat(s.sortBy4).concat("/").concat(s.group4);it.Enabled=!1;lt.getControl().text(n.Msg.translate(n.Env.getCtx(),"Processing"));c.getIsMenu()?vu?(c.dGrid.refresh(),or()):cu():or();vu=!0;e=1;s.Query(r,ri,ui,e);s.C_AcctSchema_ID>0&&nt.setValue(s.C_AcctSchema_ID);it.Enabled=!0;lt.getControl().text(n.Msg.getMsg("VIS_EnterSelctionAndDisplayToQueryFind"))}function ri(n){n!=null&&df(n);l(!1)}function ui(n){if(cmbPage.empty(),n.TotalPage>0){for(var i=0;i<n.TotalPage;i++)cmbPage.append(t("<option value="+(i+1)+">"+(i+1)+"<\/option>"));cmbPage.val(n.CurrentPage);n.TotalPage>n.CurrentPage?(liNextPage.css("opacity","1"),liLastPage.css("opacity","1")):(liNextPage.css("opacity","0.6"),liLastPage.css("opacity","0.6"));n.CurrentPage>1?(liFirstPage.css("opacity","1"),liPrevPage.css("opacity","1")):(liFirstPage.css("opacity","0.6"),liPrevPage.css("opacity","0.6"));n.TotalPage==1&&(liFirstPage.css("opacity","0.6"),liPrevPage.css("opacity","0.6"),liNextPage.css("opacity","0.6"),liLastPage.css("opacity","0.6"))}else liFirstPage.css("opacity","0.6"),liPrevPage.css("opacity","0.6"),liNextPage.css("opacity","0.6"),liLastPage.css("opacity","0.6")}function of(){var n=et.find("input").prop("checked");n?(pt.getControl().removeAttr("disabled"),a.removeAttr("disabled"),ot.removeAttr("disabled"),ai.attr("disabled","disabled"),vi.attr("disabled","disabled"),oi.getControl().attr("disabled","disabled"),k.attr("disabled","disabled"),y.attr("disabled","disabled"),p.attr("disabled","disabled"),w.attr("disabled","disabled"),d.attr("disabled","disabled"),g.attr("disabled","disabled"),st.attr("disabled","disabled"),rt.attr("disabled","disabled"),ut.attr("disabled","disabled"),ft.attr("disabled","disabled"),ht.attr("disabled","disabled"),ct.attr("disabled","disabled"),ki.attr("disabled","disabled"),di.attr("disabled","disabled"),gi.attr("disabled","disabled"),nr.attr("disabled","disabled")):(pt.getControl().attr("disabled","disabled"),a.attr("disabled","disabled"),ot.attr("disabled","disabled"),ai.removeAttr("disabled"),vi.removeAttr("disabled"),oi.getControl().removeAttr("disabled"),k.removeAttr("disabled"),y.removeAttr("disabled"),p.removeAttr("disabled"),w.removeAttr("disabled"),d.removeAttr("disabled"),g.removeAttr("disabled"),st.removeAttr("disabled"),rt.removeAttr("disabled"),ut.removeAttr("disabled"),ft.removeAttr("disabled"),ht.removeAttr("disabled"),ct.removeAttr("disabled"),ki.removeAttr("disabled"),di.removeAttr("disabled"),gi.removeAttr("disabled"),nr.removeAttr("disabled"))}function sf(){var n=pt.getControl().find("option:selected").val();n!=null&&jQuery.grep(s.tableInfo,function(t){return t.Name==n})[0]!=null&&(s.AD_Table_ID=jQuery.grep(s.tableInfo,function(t){return t.Name==n})[0].Key);a.find("span").text("");a.attr("Name",n+"_ID");ot.attr("Name",n+"_ID")}function fi(t){var u,o,f;s.HasOrgUnit==null&&fe();var r=t.attr("name"),e="IsSummary='N'",i=r;r.equals("Account_ID")?(i="C_ElementValue_ID",u=s.getAcctSchemaElement("AC"),u!=null&&(e+=" AND C_Element_ID="+u.c_element_id)):r.equals("User1_ID")?(i="C_ElementValue_ID",u=s.getAcctSchemaElement("U1"),u!=null&&(e+=" AND C_Element_ID="+u.c_element_id)):r.equals("User2_ID")?(i="C_ElementValue_ID",u=s.getAcctSchemaElement("U2"),u!=null&&(e+=" AND C_Element_ID="+u.c_element_id)):et.find("input").prop("checked")&&(e="");o=i.substring(0,i.length-3);r=="M_Product_ID"?f=new n.InfoWindow(101,"",s.windowNo,"",!1):r=="C_BPartner_ID"?f=new n.InfoWindow(100,"",s.windowNo,"",!1):r==ar?(i=lr,o=i.substring(0,i.length-3),s.HasOrgUnit&&(e+=" AND (IsCostCenter='Y' OR IsProfitCenter='Y')"),f=new n.infoGeneral(!0,s.windowNo,"",o,i,!1,e)):f=new n.infoGeneral(!0,s.windowNo,"",o,i,!1,e);f.onClose=function(){var u=null,n=f.getSelectedValues();return(n!=null&&n.length>0&&(u=i+"="+n.toString()),f=null,u==null||u.length==0||n.length==0)?(vt(t),0):(t==a?s.Record_ID=n:(vt(t),s.whereInfo.push({Key:r,Value:r+"="+n})),t.find("span").text(s.getButtonText(o,i,u)),t.find("span").text()!=""?t.AutoSize=!0:t.Width=44,n)};f.show()}function re(){n.ADialog.confirm("PostImmediate?",!0,"","Confirm",function(i){if(i){if(l(!0),s.documentQuery&&s.AD_Table_ID!=0&&s.Record_ID!=0){var r=tt.prop("checked");ue(function(i){var u=!1,f,e;i=="Yes"&&(u=!0);window.FRPT&&u?(f=Number(n.context.getWindowTabContext(h,0,"AD_Org_ID")),e=Number(n.context.getWindowTabContext(h,0,"C_DocType_ID")),t.ajax({url:n.Application.contextUrl+"FRPT/PostingLogicFRPT/PostImediateFRPT",dataType:"json",async:!0,data:{AD_Client_ID:s.AD_Client_ID,AD_Table_ID:s.AD_Table_ID,Record_ID:s.Record_ID,force:r,OrgID:f,AD_Window_ID:cf,DocTypeID:e},error:function(){l(!1);n.ADialog.info(n.Msg.getMsg("ERRORGettingPostingServer"))},success:function(t){t.result&&(n.ADialog.info("",!0,t.result,null),sr());l(!1)}})):t.ajax({url:n.Application.contextUrl+"Posting/PostImmediate",dataType:"json",data:{AD_Client_ID:s.AD_Client_ID,AD_Table_ID:s.AD_Table_ID,Record_ID:s.Record_ID,force:r},error:function(){l(!1);n.ADialog.info(n.Msg.getMsg("ERRORGettingPostingServer"))},success:function(n){n.result=="OK"&&sr();l(!1)}})})}return!0}return l(!1),!1})}function ue(i){t.ajax({url:n.Application.contextUrl+"Posting/PostByNewLogic",dataType:"json",async:!0,data:{AD_Client_ID:n.context.getAD_Client_ID()},error:function(){alert(n.Msg.getMsg("ERRORGettingPostingServer"))},success:function(n){i&&i(n.result)}})}function fe(){t.ajax({url:n.Application.contextUrl+"AcctViewerData/HasOrganizationUnit",dataType:"json",async:!1,error:function(){alert(n.Msg.getMsg("ERROR"))},success:function(n){n!=null&&(s.HasOrgUnit=n.result)}})}function pi(t,i){for(var r=0;r<i.length;r++)t.append(" <option selected value='"+i[r].Key+"' >"+n.Utility.decodeText(i[r].Name)+"<\/option>");t.prop("selectedIndex",0)}var bt=t("<div style='position:relative;'>"),hr=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>'),c=this,hf=r,lu=u,au=f,h=e,cf=o;this.arrListColumns=[];this.dGrid=null;this.menuForm=!1;var vu=!1,cr="C_AcctSchema_ID",lf="DocumentType",yu="PostingType",lr="AD_Org_ID",ar="AD_OrgTrx_ID",wi="Account_ID",pu="SelectDocument",wu="AcctDateFrom",vr="M_Product_ID",yr="C_BPartner_ID",bu="C_Project_ID",pr="C_Campaign_ID",ei=n.Application.contextUrl+"Areas/VIS/Images/base/Find24.gif",ee=n.Application.contextUrl+"Areas/VIS/Images/cancel-18.png",af=n.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png",vf=n.Application.contextUrl+"Areas/VIS/Images/base/Print24.PNG",it=t("<button id='btnRefresh_"+h+"'style='margin-top: 0;' class='VIS_Pref_btn-2'><i class='vis vis-refresh'><\/i><\/button>"),ci=t("<button class='VIS_Pref_btn-2' id='btnPrint_"+h+"' style='margin-top: 0px; margin-left: 10px;'><i class='vis vis-print'><\/button>"),v=t("<button class='VIS_Pref_btn-2' id='btnRePost_"+h+"' style='margin-top: 10px;'><img src='"+ei+"'/><\/button>"),a=t("<button class='input-group-text' Name='btnSelctDoc' id='btnSelctDoc_"+h+"'><i class='vis vis-find'><\/i><\/button>"),k=t("<button class='input-group-text' Name='btnAccount' id='btnAccount_"+h+"'><i class='vis vis-find'><\/i><\/button>"),y=t("<button class='input-group-text' Name='btnProduct' id='btnProduct_"+h+"'><i class='vis vis-find'><\/i><\/button>"),p=t("<button class='input-group-text' Name='btnBPartner' id='btnBPartner_"+h+"'><i class='vis vis-find'><\/i><\/button>"),w=t("<button class='input-group-text'Name='btnProject' id='btnProject_"+h+"'><i class='vis vis-find'><\/i><\/button>"),d=t("<button class='input-group-text' Name='btnCampaning' id='btnCampaning_"+h+"'><i class='vis vis-find'><\/i><\/button>"),g=t("<button class='input-group-text' Name='btnOrgUnit' id='btnOrgUnit_"+h+"'><i class='vis vis-find'><\/i><\/button>"),ot=t("<button Name='btnSelctDocClear' id='btnSelctDocClear_"+h+"' class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),st=t("<button  Name='btnAccountClear' id='btnAccountClear_"+h+"'   class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),rt=t("<button  Name='btnProductClear' id='btnProductClear_"+h+"'   class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),ut=t("<button Name='btnBPartnerClear' id='btnBPartnerClear_"+h+"' class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),ft=t("<button  Name='btnProjectClear' id='btnProjectClear_"+h+"'   class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),ht=t("<button Name='btnCampaningClear' id='btnCampaningClear_"+h+"' class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),ct=t("<button Name='btnOrgUnitClear' id='btnOrgUnitClear_"+h+"' class='input-group-text'><i class='vis vis-mark'><\/i><\/button>"),yt=new n.Controls.VComboBox("",!1,!1,!0),nt=new n.Controls.VComboBox("",!1,!1,!0),bi=new n.Controls.VComboBox("",!1,!1,!0),oi=new n.Controls.VComboBox("",!1,!1,!0),pt=new n.Controls.VComboBox("",!1,!1,!0),kt=new n.Controls.VComboBox("",!1,!1,!0),dt=new n.Controls.VComboBox("",!1,!1,!0),gt=new n.Controls.VComboBox("",!1,!1,!0),ni=new n.Controls.VComboBox("",!1,!1,!0),wr=new n.Controls.VLabel,li=new n.Controls.VLabel,br=new n.Controls.VLabel,kr=new n.Controls.VLabel,dr=new n.Controls.VLabel,gr=new n.Controls.VLabel,nu=new n.Controls.VLabel,tu=new n.Controls.VLabel,iu=new n.Controls.VLabel,ru=new n.Controls.VLabel,ku=new n.Controls.VLabel,uu=new n.Controls.VLabel,fu=new n.Controls.VLabel,du=new n.Controls.VLabel,gu=new n.Controls.VLabel,nf=new n.Controls.VLabel,tf=new n.Controls.VLabel,rf=new n.Controls.VLabel,ki=t("<button id='btnSel5_"+h+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+ei+"' /><span><\/span><\/button>"),di=t("<button id='btnSel6_"+h+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+ei+"' /><span><\/span><\/button>"),gi=t("<button id='btnSel7_"+h+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+ei+"' /><span><\/span><\/button>"),nr=t("<button id='btnSel8_"+h+"' style='border: 0px;background-color: transparent; padding: 0px;'><img src='"+ei+"' /><span><\/span><\/button>"),lt=new n.Controls.VLabel,uf=new n.Controls.VLabel,ff=new n.Controls.VLabel,si=null,hi=null,et=t("<label id='lblSelectDoc_"+h+"' class='VIS_Pref_Label_Font vis-ec-col-lblchkbox'><input id='chkSelectDoc_"+h+"' type='checkbox' checked class='VIS_Pref_automatic'>SelectDoc<\/label>"),tr=t("<input id='chkQty_"+h+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblQty_"+h+"' class='VIS_Pref_Label_Font'>chkQty<\/label><\/span>"),tt=t("<input id='chkforcePost_"+h+"' type='checkbox' class='VIS_Pref_automatic' style='display: inline-block;margin-left: 20px; margin-top: 0;'><span><label id='lblforcePost_"+h+"' class='VIS_Pref_Label_Font'>chkforcePost<\/label><\/span>"),ir=t("<span style='margin-left: 20px;'><label id='lblDrAndCR_"+h+"' class='VIS_Pref_Label_Font'><\/label><\/span>"),rr=t("<input id='chkDisDocinfo_"+h+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblDisDocinfo_"+h+"' class='VIS_Pref_Label_Font'>chkDisDocinfo<\/label><\/span>"),ur=t("<input id='chkDisSouce_"+h+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblDisSouce_"+h+"' class='VIS_Pref_Label_Font'>chkDisSouce<\/label><\/span>"),eu=t("<input id='chkSumriz1_"+h+"' type='checkbox' class='VIS_Pref_automatic'>"),ou=t("<input id='chkSumriz2_"+h+"' type='checkbox' class='VIS_Pref_automatic'>"),su=t("<input id='chkSumriz3_"+h+"' type='checkbox' class='VIS_Pref_automatic'>"),hu=t("<input id='chkSumriz4_"+h+"' type='checkbox' class='VIS_Pref_automatic'>"),ai=t("<input id='vdtpkAccDateFrom_"+h+"' type='date' name='DateOrdered'>"),vi=t("<input id='vdtpkAccDateTo_"+h+"' type='date' name='DateOrdered'>"),fr=null,b=null,wt=null,ti=null,at=null,ii=null,yf=t(window).width()/2,pf=t(window).width()/2,er=t(window).height()-200,s=null;bf();this.showDialog=function(){te();l(!0);si=bt.find("#lblquery_"+h);hi=bt.find("#lblresult_"+h);c.getIsMenu()?cu():or();v.hide();tt.hide();ci.hide();wf();gf();ie(lu,au);bt.dialog({modal:!0,resizable:!1,title:n.Msg.getMsg("AcctViewer"),width:t(window).width()/2+t(window).width()/4,position:{at:"center top",of:window},close:function(){c.dGrid!=null&&(c.dGrid.destroy(),c.dGrid=null);c.dispose();c=null;bt.dialog("destroy");bt=null}})};this.disposeComponent=function(){it&&it.off("click");ci&&ci.off("click");v&&v.off("click");a&&a.off("click");k&&k.off("click");y&&y.off("click");p&&p.off("click");w&&w.off("click");d&&d.off("click");ot&&ot.off("click");st&&st.off("click");rt&&rt.off("click");ut&&ut.off("click");ft&&ft.off("click");ht&&ht.off("click");ct&&ct.off("click");g&&g.off("click");hf=null;lu=null;au=null;h=null;this.arrListColumns=null;this.dGrid=null;cr=null;lf=null;yu=null;lr=null;wi=null;pu=null;wu=null;ei=null;af=null;vf=null;it=null;ci=null;v=null;a=null;k=null;y=null;p=null;w=null;d=null;ot=null;st=null;rt=null;ut=null;ft=null;ht=null;yt=null;nt=null;bi=null;oi=null;pt=null;kt=null;dt=null;gt=null;ni=null;wr=null;li=null;br=null;kr=null;dr=null;gr=null;nu=null;tu=null;iu=null;ru=null;ku=null;uu=null;fu=null;du=null;gu=null;nf=null;tf=null;ki=null;di=null;gi=null;nr=null;lt=null;uf=null;ff=null;si=null;hi=null;et=null;tr=null;tt=null;rr=null;ur=null;eu=null;ou=null;su=null;hu=null;ai=null;vi=null;fr=null;b=null;wt=null;ti=null;at=null;ii=null;yf=null;pf=null;er=null;s=null;hr=null;this.disposeComponent=null}}i.prototype.getAcctSchema=function(){return this.ASchemas};i.prototype.getTable=function(){var i=[],r=null,u=this;return t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerGetTabelData",type:"POST",async:!1,success:function(t){var o,f;if((this.tableInfo==undefined||this.tableInfo==null)&&(this.tableInfo=[]),t.result)for(i.push({Key:"",Name:""}),o=t.result,f=0;f<o.length;f++){var s=o[f].AD_Table_ID,e=n.Utility.encodeText(o[f].TableName),h="";h=e=="C_Order"?n.Msg.getMsg("Order"):n.Msg.translate(n.Env.getCtx(),e+"_ID");i.push({Key:e,Name:h});u.tableInfo.push({Key:s,Name:e});s==this.AD_Table_ID&&(r=e)}},error:function(n){$selfObj.log.info(n)}}),i};i.prototype.getOrg=function(){var i=[],r=this.AD_Client_ID;return t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerGetOrgData",type:"POST",async:!1,data:{client_id:r},success:function(t){var u=t.result,r;if(u)for(i.push({Key:0,Name:""}),r=0;r<u.length;r++)i.push({Key:u[r].AD_Org_ID,Name:n.Utility.encodeText(u[r].OrgName)})},error:function(n){$selfObj.log.info(n)}}),i};i.prototype.getPostingType=function(){var i=[];return t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerGetPostingType",type:"POST",async:!1,data:{reference_id:125},success:function(t){var u=t.result,r;if(u)for(i.push({Key:0,Name:""}),r=0;r<u.length;r++)i.push({Key:u[r].PostingValue,Name:n.Utility.encodeText(u[r].PostingName)})},error:function(n){$selfObj.log.info(n)}}),i};i.prototype.getAcctSchemaElements=function(i){this._elements=[];var r=this._elements;return t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerGetAcctSchElements",type:"POST",async:!0,data:{keys:i},success:function(t){var u=t.result,i,f;if(u)for(i=0;i<u.length;i++)f=[],f.push({c_acctschema_element_id:u[i].C_AcctSchema_Element_ID,name:n.Utility.encodeText(u[i].ElementName),elementtype:u[i].ElementType,c_elementvalue_id:u[i].C_ElementValue_ID,seqno:u[i].SeqNo,detail:u[i].Detail,c_element_id:u[i].C_Element_ID}),r.push(f)},error:function(n){$selfObj.log.info(n)}}),r};i.prototype.getAcctSchemaElement=function(n){var t,i;for(this._elements==null&&this.getAcctSchemaElements(),t=0;t<this._elements.length;t++)if(i=this._elements[t][0],i.elementtype.equals(n))return i;return null};i.prototype.getColumnName=function(n){return n.equals(this.ELEMENTTYPE_Organization)?"AD_Org_ID":n.equals(this.ELEMENTTYPE_Account)?"Account_ID":n.equals(this.ELEMENTTYPE_BPartner)?"C_BPartner_ID":n.equals(this.ELEMENTTYPE_Product)?"M_Product_ID":n.equals(this.ELEMENTTYPE_Activity)?"C_Activity_ID":n.equals(this.ELEMENTTYPE_LocationFrom)?"C_LocFrom_ID":n.equals(this.ELEMENTTYPE_LocationTo)?"C_LocTo_ID":n.equals(this.ELEMENTTYPE_Campaign)?"C_Campaign_ID":n.equals(this.ELEMENTTYPE_OrgTrx)?"AD_OrgTrx_ID":n.equals(this.ELEMENTTYPE_Project)?"C_Project_ID":n.equals(this.ELEMENTTYPE_SalesRegion)?"C_SalesRegion_ID":n.equals(this.ELEMENTTYPE_UserList1)?"User1_ID":n.equals(this.ELEMENTTYPE_UserList2)?"User2_ID":n.equals(this.ELEMENTTYPE_UserElement1)?"UserElement1_ID":n.equals(this.ELEMENTTYPE_UserElement2)?"UserElement2_ID":""};i.prototype.getButtonText=function(i,r,u){var e=n.Env.getAD_Language(n.Env.getCtx()),o=n.MLookupFactory.getLookup_TableDirEmbed(e,r,"avd",r),f="<"+u+">";return t.ajax({url:n.Application.contextUrl+"AcctViewerData/AcctViewerGetButtonText",type:"POST",async:!1,data:{lookupDirEmbeded:o,tName:i,wheres:" avd WHERE avd.",selectSQLs:u},success:function(n){var t=n.result;t!=""&&(f=t)},error:function(n){$selfObj.log.info(n)}}),f};i.prototype.Query=function(t,i,r,u){var f="",o,s,h,e;if(this.C_AcctSchema_ID!=0&&(f=f.concat(this.TABLE_ALIAS).concat(".C_AcctSchema_ID=").concat(this.C_AcctSchema_ID)),this.PostingType!=null&&this.PostingType.length>0&&(f.length>0&&(f=f.concat(" AND ")),f=f.concat(this.TABLE_ALIAS).concat(".PostingType='").concat(this.PostingType).concat("'")),this.documentQuery)f.length>0&&(f=f.concat(" AND ")),f=f.concat(this.TABLE_ALIAS).concat(".AD_Table_ID=").concat(this.AD_Table_ID).concat(" AND ").concat(this.TABLE_ALIAS).concat(".Record_ID=").concat(this.Record_ID);else{if(o=this.whereInfo,o!=null)for(s=0;s<o.length;s++)h=o[s].Value,h!=null&&h.length>0&&(f.length>0&&(f=f.concat(" AND ")),f=f.concat(this.TABLE_ALIAS).concat(".").concat(h));(!this.DateFrom!=null||this.DateTo!=null)&&(f.length>0&&(this.DateFrom!=""||this.DateTo!="")&&(f=f.concat(" AND ")),this.DateFrom!=""&&this.DateTo!=""?f=f.concat("TRUNC(").concat(this.TABLE_ALIAS).concat(".DateAcct,'DD') BETWEEN ").concat(n.DB.to_date(this.DateFrom)).concat(" AND ").concat(n.DB.to_date(this.DateTo)):this.DateFrom!=""?f=f.concat("TRUNC(").concat(this.TABLE_ALIAS).concat(".DateAcct,'DD') >= ").concat(n.DB.to_date(this.DateFrom)):this.DateTo!=""&&(f=f.concat("TRUNC(").concat(this.TABLE_ALIAS).concat(".DateAcct,'DD') <= ").concat(n.DB.to_date(this.DateTo))));this.AD_Org_ID!=0&&(f.length>0&&(f=f.concat(" AND ")),f=f.concat(this.TABLE_ALIAS).concat(".AD_Org_ID=").concat(this.AD_Org_ID))}e="";this.sortBy1.length>0&&(e=e.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy1));this.sortBy2.length>0&&(e.length>0&&(e=e.concat(",")),e=e.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy2));this.sortBy3.length>0&&(e.length>0&&(e=e.concat(",")),e=e.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy3));this.sortBy4.length>0&&(e.length>0&&(e=e.concat(",")),e=e.concat(this.TABLE_ALIAS).concat(".").concat(this.sortBy4));e.length==0&&(e=e.concat(this.TABLE_ALIAS).concat(".Fact_Acct_ID"));u||(u=1);this.getDataModel(t,f,e,this.group1,this.group2,this.group3,this.group4,this.sortBy1,this.sortBy2,this.sortBy3,this.sortBy4,this.displayDocumentInfo,this.displaySourceAmt,this.displayQty,i,r,u)};i.prototype.getDataModel=function(i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){var d=this;t.ajax({url:n.Application.contextUrl+"Common/GetDataQuery",async:!0,dataType:"json",type:"POST",data:{AD_Client_ID:i,whereClause:r,orderClause:u,gr1:f,gr2:e,gr3:o,gr4:s,sort1:h,sort2:c,sort3:l,sort4:a,displayDocInfo:v,displaySrcAmt:y,displayqty:p,pageNo:k},success:function(n){d.dataByData=n.result;b(n.result.pSetting);w(n.result)}})};r.prototype.dispose=function(){this.disposeComponent()};r.prototype.setIsMenu=function(n){n!=null&&n!=undefined&&(this.menuForm=n)};r.prototype.getIsMenu=function(){return this.menuForm};n.AcctViewer=r}(VIS,jQuery);VIS=window.VIS||{},function(n,t){n.AcctViewerMenu=function(){function e(){r.on("click",function(){i.frame.dispose()})}this.frame;this.windowNo;var f,i=this,r="",u=t("<div>");this.initalize=function(){u.append('<a id="VIS_btnResult_'+i.windowNo+'">button<\/a>');r=u.find("#VIS_btnResult_"+i.windowNo);e()};this.openAccountViewer=function(){var t=new n.AcctViewer(n.context.getAD_Client_ID(),1,1,this.windowNo,1);t!=null&&(t.setIsMenu(!0),t.showDialog());r.trigger("click")};this.getRoot=function(){return u}};n.AcctViewerMenu.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.initalize();this.openAccountViewer();this.frame.getContentGrid().append(this.getRoot())};n.AcctViewerMenu.prototype.dispose=function(){this.disposeComponent();this.frame=null}}(VIS,jQuery),function(n,t){function i(){function g(){var rt="topDiv_"+i.windowNo,p="btnSpaceDiv_"+i.windowNo,ut="btnSpace_"+i.windowNo,ft="spnSelect_"+i.windowNo,et="spnGenerate_"+i.windowNo,w="lblGenerate_"+i.windowNo,b="lblSelect_"+i.windowNo,k,d,u,f,g,nt,tt,a,it,v,y;o=t('<div class="input-group-append"><button id = "btnClearBP_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" tabindex="-1" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button><\/div>');s=t('<div class="input-group-append"><button id = "btnClearOrd_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" tabindex="-1" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button><\/div>');i.topDiv=t("<div id='"+rt+"' class='vis-archive-l-s-head vis-frm-ls-top' style='padding: 0;'><div id='"+p+"' class='vis-l-s-headwrp'><button id='"+ut+"'  class='vis-archive-sb-t-button'><i class='vis vis-arrow-left'><\/i><\/button><\/div><div id='"+ft+"'style='display: inline-block;  padding-left: 15px;margin-right: 15px;' ><label id='"+b+"' class='VIS_Pref_Label_Font' style='vertical-align: middle;font-size: 28px;color: rgba(var(--v-c-primary), 1);'>"+n.Msg.translate(n.Env.getCtx(),"Select")+"<\/label><\/div><div id='"+et+"' style='display: inline-block; width: 160px;'><label id='"+w+"' class='VIS_Pref_Label_Font' style='vertical-align: middle;font-size: 17px;'>"+n.Msg.translate(n.Env.getCtx(),"Generate")+"<\/label><\/div><\/div>");k="sideDiv_"+i.windowNo;d="parameterDiv_"+i.windowNo;i.btnSpaceDiv=i.topDiv.find("#"+p);this.lblGenrate=i.topDiv.find("#"+w);this.lblSelect=i.topDiv.find("#"+b);i.sideDiv=t("<div id='"+k+"' class='vis-archive-l-s-content vis-leftsidebarouterwrap'>");i.sideDiv.css("width",r);i.sideDiv.css("height","calc(100% - 103px)");i.div=t("<div class='vis-archive-l-s-content-inner' id='"+d+"'>");i.sideDiv.append(i.div);var c=t("<table style='width: 100%;'>"),e=t("<tr>"),h=t("<td style='padding: 10px 10px 0px;'>");i.div.append(c);u=t('<div class="input-group vis-input-wrap">');f=t('<div class="vis-control-wrap">');c.append(e);e.append(h);h.append(u);u.append(f);f.append(i.cmbWarehouse.getControl());f.append(i.lblWarehouse.getControl().addClass("VIS_Pref_Label_Font"));e=t("<tr>");h=t("<td style='padding: 0px 10px 0px;'>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),l=t('<div class="input-group-append">');c.append(e);e.append(h);h.append(u);u.append(f);f.append(i.vSearchBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));f.append(i.lblBPartner.getControl().addClass("VIS_Pref_Label_Font"));u.append(l);l.append(i.vSearchBPartner.getBtn(0));u.append(o);g=n.Msg.translate(n.Env.getCtx(),"SalesOrder_No");e=t("<tr>");h=t("<td style='padding: 0px 10px 0px;'>");var u=t('<div class="input-group vis-input-wrap">'),f=t('<div class="vis-control-wrap">'),l=t('<div class="input-group-append">');c.append(e);e.append(h);h.append(u);u.append(f);f.append(i.vSearchOrder.getControl(0).attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));f.append("<label>"+g+"<\/label>");u.append(l);l.append(i.vSearchOrder.getBtn(0));u.append(s);nt="gridSelectDiv_"+i.windowNo;tt="gridGenerateDiv_"+i.windowNo;i.gridSelectDiv=t("<div id='"+nt+"' class='vis-frm-grid-outerwrp'>");i.gridGenerateDiv=t("<div id='"+tt+"' style='height: 85%; float: right; display: none; background-color: rgba(var(--v-c-secondary), .8); margin-left: 15px;margin-right: 15px;'>");i.gridGenerateDiv.css("width",t(window).width()-30);a="btnOk_"+i.windowNo;i.okBtn=t("<input id='"+a+"' class='VIS_Pref_btn-2' style='margin-top: 0px;width: 70px;height: 38px;' type='button' value='Ok'>");a="btnRefresh_"+i.windowNo;i.btnRefresh=t("<button id='"+a+"' style='margin-top: 0px;' class='VIS_Pref_btn-2'><i class='vis vis-refresh'><\/i><\/button>");it="discriptionDiv_"+i.windowNo;i.bottumDiv=t("<div class='vis-info-btmcnt-wrap vis-p-t-10'>");v=t("<div id='"+it+"' style='flex: 1;padding: 0 10px;'>");v.append(i.lblStatusInfo.getControl().addClass("VIS_Pref_Label_Font"));y=t("<div>");y.append(i.okBtn);i.bottumDiv.append(i.btnRefresh).append(v).append(y);i.$root.append(i.$busyDiv);i.$busyDiv[0].style.visibility="hidden";i.$root.append(i.topDiv).append(i.sideDiv).append(i.gridSelectDiv).append(i.gridGenerateDiv).append(i.bottumDiv)}function nt(){i.lblWarehouse.getControl().text(n.Msg.translate(n.Env.getCtx(),"M_Warehouse_ID"));i.lblBPartner.getControl().text(n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID"));i.tabSelect.getControl().text(n.Msg.getMsg("Select",!1,!1));i.tabGenrate.getControl().text(n.Msg.getMsg("Generate",!1,!1));i.lblStatusInfo.getControl().text(n.Msg.getMsg("VIS_OrderGenShip",!1,!1))}function tt(){var u=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2223,n.DisplayType.TableDir,"M_Warehouse_ID",0,!1,"M_Warehouse.IsActive='Y'"),t,r;i.cmbWarehouse=new n.Controls.VComboBox("M_Warehouse_ID",!0,!1,!0,u,150,n.DisplayType.TableDir,0);t=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2762,n.DisplayType.Search,"C_BPartner_ID",0,!1,"C_BPartner.IsActive ='Y' And C_Bpartner.Issummary ='N'");i.vSearchBPartner=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,t);r=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2161,n.DisplayType.Search,"C_Order_ID",0,!1,"DocStatus='CO'");i.vSearchOrder=new n.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,n.DisplayType.Search,r)}function p(r){i.dGrid!=null&&(i.dGrid.destroy(),i.dGrid=null);i.arrListColumns.length==0&&(i.arrListColumns.push({field:"AD_Org_ID",caption:n.Msg.translate(n.Env.getCtx(),"AD_Org_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"C_DocType_ID",caption:n.Msg.translate(n.Env.getCtx(),"C_DocType_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"DocumentNo",caption:n.Msg.getElement(n.Env.getCtx(),"DocumentNo"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"C_BPartner_ID",caption:n.Msg.getElement(n.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"DateOrdered",caption:n.Msg.getElement(n.Env.getCtx(),"DateOrdered"),sortable:!0,size:"16%",min:150,hidden:!1,render:function(n){var t;return t=n.changes==undefined||n.changes.DateOrdered==undefined?n.DateOrdered:n.changes.DateOrdered,new Date(t).toLocaleDateString()}}),i.arrListColumns.push({field:"C_Order_ID",caption:n.Msg.translate(n.Env.getCtx(),"C_UOM_ID"),sortable:!0,size:"150px",hidden:!0}));setTimeout(10);w2utils.encodeTags(r);i.dGrid=t(i.gridSelectDiv).w2grid({name:"gridGenShipForm"+i.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:i.arrListColumns,records:r})}function y(){var r=[],s=n.Env.getCtx().getAD_Client_ID(),u="",f="",o="";e!=null&&e.toString()!="-1"&&(u=" AND ic.M_Warehouse_ID="+e);l!=null&&(f=" AND ic.C_BPartner_ID="+l);v!=null&&(o=" AND C_Order_ID="+v);t(i.$root[0]).addClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="visible";t.ajax({url:n.Application.contextUrl+"VCreateFrom/ExecuteQueryVinoutgen",type:"POST",data:{adClientID:s,mWarehouseIDs:u,cBPartnerIDs:f,cOrderIDSearchs:o},success:function(u){var f=JSON.parse(u),s,e,o;if(f&&f.length>0)try{for(s=1,e=0;e<f.length;e++)o={},o.C_Order_ID=f[e].c_order_id,o.AD_Org_ID=f[e].ord,o.C_DocType_ID=f[e].doctype,o.DocumentNo=n.Utility.encodeText(f[e].documentno),o.C_BPartner_ID=f[e].bpname,o.DateOrdered=f[e].dateordered,o.recid=s,s++,r.push(o)}catch(h){}else n.ADialog.info("NoDataFound"),i.okBtn.attr("disabled","disabled");p(r);t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="hidden"},error:function(){t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="hidden"}})}function it(){var r,u,f,e,n,t;if(i.dGrid==null)return!1;if((r=[],u=i.dGrid.getSelection(),u!=null)&&!(u.length<=0)){for(f=u.toString().split(","),t=0;t<f.length;t++)r[t]=i.dGrid.get(f[t]).C_Order_ID;if(r.length==0)return"";for(e="C_Order_ID",n=e,n=r.length>1?n.concat(" IN ("):n.concat("="),t=0;t<r.length;t++)t>0&&(n=n.concat(",")),n=e.endsWith("_ID")?n.concat(r[t].toString()):n.concat("'").concat(r[t].toString());return r.length>1&&(n=n.concat(")")),n.toString()}}function rt(r){var u=i;i.$busyDiv[0].style.visibility="visible";t.ajax({url:n.Application.contextUrl+"Common/GenerateShipments",dataType:"json",data:{whereClause:r,M_Warehouse_ID:e},success:function(r){r.DocumentText!=null&&(ut(!0),u.gridGenerateDiv.html(r.DocumentText),u.lblStatusInfo.getControl().text(r.lblStatusInfo));r.ErrorMsg!=null&&n.ADialog.info("",null,r.ErrorMsg,null);u.$busyDiv[0].style.visibility="hidden";t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")},error:function(){u.$busyDiv[0].style.visibility="hidden";t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")}})}function ut(n){n&&(i.btnRefresh.hide(),i.okBtn.hide(),i.btnToggel.animate({borderSpacing:0},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),n=!1,i.gridSelectDiv.animate({width:f},"fast"),i.sideDiv.animate({width:"toggle",height:"toggle"},"slow"));i.gridSelectDiv.css("display","none");i.sideDiv.css("display","none");i.gridGenerateDiv.css("display","block");i.btnToggel.hide();lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary), 1)");lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")}var i;this.frame;this.windowNo;i=this;this.arrListColumns=[];this.dGrid=null;var c=null,e=null,l=null,w=!1,b=!1,u=!1,v=null;this.lblWarehouse=new n.Controls.VLabel;this.lblBPartner=new n.Controls.VLabel;this.lblStatusInfo=new n.Controls.VLabel;this.tabSelect=new n.Controls.VLabel;this.tabGenrate=new n.Controls.VLabel;this.cmbWarehouse=new n.Controls.VComboBox("",!1,!1,!0);this.vSearchBPartner=null;this.vSearchOrder=null;this.$root=t("<div style='width: 100%; height: 100%; background-color: white;'>");this.$busyDiv=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');this.topDiv=null;this.sideDiv=null;this.gridSelectDiv=null;this.gridGenerateDiv=null;this.bottumDiv=null;this.div=null;this.okBtn=null;this.cancelBtn=null;this.btnRefresh=null;this.btnToggel=null;this.spnSelect=null;this.spnGenerate=null;this.btnSpaceDiv=null;this.lblGenrate=null;this.lblSelect=null;var o=null,s=null,r=260,h=50,f=t(window).width()-(r+20),a=t(window).width()-(20+h),k=f+r+5,d=t(window).height()-210;this.vetoablechange=function(){l=i.vSearchBPartner.getValue();v=i.vSearchOrder.getValue();i.okBtn.removeAttr("disabled");y()};this.sizeChanged=function(n,t){f=t-(r+20);a=t-(20+h);u==!0?(i.btnSpaceDiv.animate({width:h},"slow"),i.sideDiv.animate({width:h},"slow"),i.div.css("display","none"),i.gridSelectDiv.animate({width:a},"slow",null,function(){i.dGrid.resize()})):(i.btnSpaceDiv.animate({width:r},"slow"),i.gridSelectDiv.animate({width:f},"slow"),i.div.css("display","block"),i.sideDiv.animate({width:r},"slow",null,function(){i.dGrid.resize()}))};this.Initialize=function(){if(tt(),nt(),g(),this.btnToggel=this.$root.find("#btnSpace_"+i.windowNo),this.spnSelect=this.$root.find("#spnSelect_"+i.windowNo),this.spnGenerate=this.$root.find("#spnGenerate_"+i.windowNo),this.okBtn!=null)this.okBtn.on(n.Events.onTouchStartOrClick,function(){var r=i;if(i.cmbWarehouse.getControl().find("option:selected").val()==undefined){n.ADialog.error("SelectWarehouseFirst");return}i.$busyDiv[0].style.visibility="visible";t(i.$root[0]).addClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv");i.okBtn.attr("disabled","disabled");c=it();c!=null&&c.length>0?rt(c):(n.ADialog.error("PlzSelectatLeast1Inv"),i.$busyDiv[0].style.visibility="hidden");i.okBtn.removeAttr("disabled")});if(this.cancelBtn!=null)this.cancelBtn.on(n.Events.onTouchStartOrClick,function(){i.$root.dialog("close")});if(this.btnRefresh!=null)this.btnRefresh.on(n.Events.onTouchStartOrClick,function(){i.okBtn.removeAttr("disabled");e=i.cmbWarehouse.getControl().find("option:selected").val();l=i.vSearchBPartner.getValue();y()});if(this.btnToggel!=null)this.btnToggel.on(n.Events.onTouchStartOrClick,function(){var e=0;u?(e=n.Application.isRTL?180:0,i.btnToggel.animate({borderSpacing:e},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!1,i.btnSpaceDiv.animate({width:r},"slow"),i.gridSelectDiv.animate({width:f},"slow"),i.div.css("display","block"),i.sideDiv.animate({width:r},"slow",null,function(){i.dGrid.resize()})):(e=n.Application.isRTL?0:180,i.btnToggel.animate({borderSpacing:e},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!0,i.btnSpaceDiv.animate({width:h},"slow"),i.sideDiv.animate({width:h},"slow"),i.div.css("display","none"),i.gridSelectDiv.animate({width:a},"slow",null,function(){i.dGrid.resize()}))});if(this.spnGenerate!=null)this.spnGenerate.on(n.Events.onTouchStartOrClick,function(){i.btnRefresh.hide();i.okBtn.hide();u&&(i.btnToggel.animate({borderSpacing:0},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!1,i.gridSelectDiv.animate({width:f},"fast"),i.sideDiv.animate({width:r},"fast"),i.btnSpaceDiv.animate({width:r},"fast"));i.gridSelectDiv.css("display","none");i.sideDiv.css("display","none");i.gridGenerateDiv.css("display","block");i.btnToggel.hide();lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary), 1)");lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")});if(this.spnSelect!=null)this.spnSelect.on(n.Events.onTouchStartOrClick,function(){u||(i.btnRefresh.show(),i.okBtn.show(),i.gridGenerateDiv.css("display","none"),i.gridSelectDiv.css("display","block"),i.sideDiv.css("display","block"),i.div.css("display","block"),i.gridSelectDiv.animate({width:f},"fast"),i.btnToggel.show(),lblSelect.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)"),lblGenrate.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary), 1)"))});if(this.cmbWarehouse!=null&&this.cmbWarehouse.getControl().change(function(){i.okBtn.removeAttr("disabled");e=i.cmbWarehouse.getControl().find("option:selected").val();y()}),this.vSearchBPartner!=null&&this.vSearchBPartner.addVetoableChangeListener(this),this.vSearchOrder!=null&&this.vSearchOrder.addVetoableChangeListener(this),o!=null)o.on(n.Events.onTouchStartOrClick,function(){i.vSearchBPartner.isReadOnly||i.vSearchBPartner.setValue(null,!1,!0)});if(s!=null)s.on(n.Events.onTouchStartOrClick,function(){i.vSearchOrder.isReadOnly||i.vSearchOrder.setValue(null,!1,!0)})};this.display=function(){p(null)};this.getRoot=function(){return this.$root};this.refreshUI=function(){this.dGrid.resize()};this.disposeComponent=function(){this.okBtn&&this.okBtn.off(n.Events.onTouchStartOrClick);this.cancelBtn&&this.cancelBtn.off(n.Events.onTouchStartOrClick);o&&o.off(n.Events.onTouchStartOrClick);s&&s.off(n.Events.onTouchStartOrClick);i=null;this.frame=null;this.windowNo=null;this.arrListColumns=null;this.dGrid=null;c=null;e=null;l=null;w=null;b=null;u=null;this.lblWarehouse=null;this.lblBPartner=null;this.lblStatusInfo=null;this.tabSelect=null;this.tabGenrate=null;this.cmbWarehouse=null;this.vSearchBPartner=null;this.$root=null;this.$busyDiv=null;this.topDiv=null;this.sideDiv=null;this.gridSelectDiv=null;this.gridGenerateDiv=null;this.bottumDiv=null;this.okBtn=null;this.cancelBtn=null;this.btnRefresh=null;this.btnToggel=null;this.spnSelect=null;this.spnGenerate=null;r=null;f=null;a=null;k=null;d=null;this.getRoot=null;this.disposeComponent=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(t,i){this.frame=i;this.windowNo=t;n.Env.getCtx().setContext(this.windowNo,"IsSOTrx","Y");try{var r=this.Initialize()}catch(u){}this.frame.getContentGrid().append(this.getRoot());this.display();this.cmbWarehouse.getControl().focus()};i.prototype.refresh=function(){this.refreshUI()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VInOutGen=i}(VIS,jQuery),function(n,t){function i(){function g(){var it="topDiv_"+i.windowNo,v="btnSpaceDiv_"+i.windowNo,rt="btnSpace_"+i.windowNo,ut="spnSelect_"+i.windowNo,ft="spnGenerate_"+i.windowNo,y="lblGenerate_"+i.windowNo,p="lblSelect_"+i.windowNo,b,k,e,f,u,d,g,nt,c,w,tt,l,a;o=t('<button id = "btnClearBP_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button>');s=t('<button id = "btnClearOrd_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button>');w=n.Application.contextUrl+"Areas/VIS/Images/base/arrow-left.png";i.topDiv=t("<div id='"+it+"' class='vis-archive-l-s-head vis-frm-ls-top' style='padding: 0;'><div id='"+v+"' class='vis-l-s-headwrp'><button id='"+rt+"' class='vis-archive-sb-t-button' ><i class='vis vis-arrow-left'><\/i><\/button><\/div><div id='"+ut+"'style='display: inline-block;  padding-left: 15px;margin-right: 15px;' ><label id='"+p+"' class='VIS_Pref_Label_Font' style='vertical-align: middle;font-size: 28px;color: rgba(var(--v-c-primary), 1);'>"+n.Msg.translate(n.Env.getCtx(),"Select")+"<\/label><\/div><div id='"+ft+"' style='display: inline-block; width: 160px;'><label id='"+y+"' class='VIS_Pref_Label_Font' style='vertical-align: middle; font-size: 17px;'>"+n.Msg.translate(n.Env.getCtx(),"Generate")+"<\/label><\/div><\/div>");b="sideDiv_"+i.windowNo;k="parameterDiv_"+i.windowNo;i.btnSpaceDiv=i.topDiv.find("#"+v);this.lblGenrate=i.topDiv.find("#"+y);this.lblSelect=i.topDiv.find("#"+p);i.sideDiv=t("<div id='"+b+"' class='vis-archive-l-s-content vis-leftsidebarouterwrap'>");i.sideDiv.css("width",r);i.sideDiv.css("height","calc(100% - 103px)");i.div=t("<div class='vis-archive-l-s-content-inner' id='"+k+"'>");i.sideDiv.append(i.div);e=t("<table style='width: 100%;'>");i.div.append(e);tr=t("<tr>");td=t("<td style='padding: 10px 10px 0px;'>");f=t('<div class="input-group vis-input-wrap">');u=t('<div class="vis-control-wrap">');e.append(tr);tr.append(td);td.append(f);f.append(u);u.append(i.cmbOrg.getControl());u.append(i.lblOrg.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");var f=t('<div class="input-group vis-input-wrap">'),u=t('<div class="vis-control-wrap">'),h=t('<div class="input-group-append">');e.append(tr);tr.append(td);td.append(f);f.append(u);u.append(i.vSearchBPartner.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));h.append(i.vSearchBPartner.getBtn(0));h.append(o);u.append(i.lblBPartner.getControl().addClass("VIS_Pref_Label_Font"));f.append(h);d=n.Msg.translate(n.Env.getCtx(),"DocumentNo");tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");var f=t('<div class="input-group vis-input-wrap">'),u=t('<div class="vis-control-wrap">'),h=t('<div class="input-group-append">');e.append(tr);tr.append(td);td.append(f);f.append(u);u.append(i.vSearchOrderShipment.getControl(0).attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));h.append(i.vSearchOrderShipment.getBtn(0));h.append(s);u.append("<label>"+d+"<\/label>");f.append(h);tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;font-size:12px;'>");e.append(tr);tr.append(td);td.append("("+n.Msg.getMsg("SalesOrderNo",!1,!1)+")");g="gridSelectDiv_"+i.windowNo;nt="gridGenerateDiv_"+i.windowNo;i.gridSelectDiv=t("<div id='"+g+"' class='vis-frm-grid-outerwrp'>");i.gridGenerateDiv=t("<div id='"+nt+"' style='height: 85%; float: right; display: none; background-color: #F1F1F1; margin-left: 15px;;margin-right: 15px;'>");i.gridGenerateDiv.css("width",t(window).width()-30);c="btnOk_"+i.windowNo;i.okBtn=t("<input id='"+c+"' class='VIS_Pref_btn-2' style='margin-top: 0px; float: right;width: 70px;height: 38px;' type='button' value='Ok'>");c="btnRefresh_"+i.windowNo;w=n.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png";i.btnRefresh=t("<button id='"+c+"' style='margin-top: 0px; float: left;height: 38px; ' class='VIS_Pref_btn-2'><i class='vis vis-refresh'><\/i><\/button>");tt="discriptionDiv_"+i.windowNo;i.bottumDiv=t("<div class='vis-info-btmcnt-wrap vis-p-t-10'>");l=t("<div id='"+tt+"' style='flex: 1;padding: 0 10px;'>");l.append(i.lblStatusInfo.getControl().addClass("VIS_Pref_Label_Font"));a=t("<div>");a.append(i.okBtn);i.bottumDiv.append(i.btnRefresh).append(l).append(a);i.$root.append(i.$busyDiv);i.$busyDiv[0].style.visibility="hidden";i.$root.append(i.topDiv).append(i.sideDiv).append(i.gridSelectDiv).append(i.gridGenerateDiv).append(i.bottumDiv)}function nt(){i.lblOrg.getControl().text(n.Msg.translate(n.Env.getCtx(),"AD_Org_ID"));i.lblBPartner.getControl().text(n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID"));i.tabSelect.getControl().text(n.Msg.getMsg("Select",!1,!1));i.tabGenrate.getControl().text(n.Msg.getMsg("Generate",!1,!1));i.lblStatusInfo.getControl().text(n.Msg.getMsg("VIS_OrderGenInv",!1,!1))}function tt(){var u=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2163,n.DisplayType.TableDir,"AD_Org_ID",0,!1,"AD_Org.AD_Org_ID <> 0 AND AD_Org.IsSummary='N' AND AD_Org.IsActive='Y' AND AD_Org.IsCostCenter='N' AND AD_Org.IsProfitCenter='N' "),t,r;i.cmbOrg=new n.Controls.VComboBox("AD_Org_ID",!0,!1,!0,u,150,n.DisplayType.TableDir,0);t=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2762,n.DisplayType.Search,"C_BPartner_ID",0,!1,"C_BPartner.IsActive ='Y' And C_Bpartner.Issummary ='N'");i.vSearchBPartner=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,t,0);r=n.MLookupFactory.get(n.Env.getCtx(),i.windowNo,2161,n.DisplayType.Search,"C_Order_ID",0,!1,"DocStatus='CO'");i.vSearchOrderShipment=new n.Controls.VTextBoxButton("C_Order_ID",!0,!1,!0,n.DisplayType.Search,r,0)}function p(r){i.dGrid!=null&&(i.dGrid.destroy(),i.dGrid=null);i.arrListColumns.length==0&&(i.arrListColumns.push({field:"AD_Org_ID",caption:n.Msg.translate(n.Env.getCtx(),"AD_Org_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"C_DocType_ID",caption:n.Msg.translate(n.Env.getCtx(),"C_DocType_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"DocumentNo",caption:n.Msg.getElement(n.Env.getCtx(),"DocumentNo"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"C_BPartner_ID",caption:n.Msg.getElement(n.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"16%",min:150,hidden:!1}),i.arrListColumns.push({field:"DateOrdered",caption:n.Msg.getElement(n.Env.getCtx(),"DateOrdered"),sortable:!0,size:"16%",min:150,hidden:!1,render:function(n){var t;return t=n.changes==undefined||n.changes.DateOrdered==undefined?n.DateOrdered:n.changes.DateOrdered,new Date(t).toLocaleDateString()}}),i.arrListColumns.push({field:"TotalLines",caption:n.Msg.getElement(n.Env.getCtx(),"TotalLines"),sortable:!0,size:"20%",min:150,hidden:!1,align:"right",render:function(n){var t=n.TotalLines;return parseFloat(t).toLocaleString()}}),i.arrListColumns.push({field:"C_Order_ID",caption:n.Msg.translate(n.Env.getCtx(),"C_UOM_ID"),sortable:!0,size:"150px",hidden:!0}));w2utils.encodeTags(r);i.dGrid=t(i.gridSelectDiv).w2grid({name:"gridGenForm"+i.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:i.arrListColumns,records:r})}function y(){var r=[],s=n.Env.getCtx().getAD_Client_ID(),u="",f="",o="";e!=null&&e.toString()!="-1"&&(u=" AND ic.AD_Org_ID="+e);l!=null&&(f=" AND ic.C_BPartner_ID="+l);a!=null&&(o=" AND C_Order_ID="+a);t(i.$root[0]).addClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="visible";t.ajax({url:n.Application.contextUrl+"VCreateFrom/ExecuteQueryVInvoiceGen",type:"POST",data:{adClientID:s,adOrgIDs:u,cBPartnerIDs:f,ordShipmentids:o},success:function(u){var f=JSON.parse(u),s,e,o;if(f&&f.length>0)try{for(s=1,e=0;e<f.length;e++)o={},o.C_Order_ID=f[e].c_order_id,o.AD_Org_ID=f[e].ord,o.C_DocType_ID=f[e].doctype,o.DocumentNo=f[e].documentno,o.C_BPartner_ID=f[e].bpname,o.DateOrdered=f[e].dateordered,o.TotalLines=f[e].tLines,o.recid=s,s++,r.push(o)}catch(h){}else n.ADialog.info("NoDataFound"),i.okBtn.attr("disabled","disabled");p(r);t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="hidden"},error:function(){t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv");i.$busyDiv[0].style.visibility="hidden"}})}function it(){var r,u,f,t,n;if(i.dGrid==null)return!1;if((r=[],u=i.dGrid.getSelection(),u!=null)&&!(u.length<=0)){for(f=u.toString().split(","),n=0;n<f.length;n++)r[n]=i.dGrid.get(f[n]).C_Order_ID;if(r.length==0)return"";for(t="",n=0;n<r.length;n++)n>0&&(t=t.concat(",")),t=t.concat(r[n].toString());return t.toString()}}function rt(r){var u=i;i.$busyDiv[0].style.visibility="visible";t.ajax({url:n.Application.contextUrl+"Common/GenerateInvoices",dataType:"json",data:{whereClause:r},success:function(r){r.DocumentText!=null&&(ut(!0),u.gridGenerateDiv.html(r.DocumentText),u.lblStatusInfo.getControl().text(r.lblStatusInfo));r.ErrorMsg!=null&&n.ADialog.info("",null,r.ErrorMsg,null);u.$busyDiv[0].style.visibility="hidden";t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")},error:function(){u.$busyDiv[0].style.visibility="hidden";t(i.$root[0]).removeClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).removeClass("vis-apanel-busyVInOutGenBusyDiv")}})}function ut(n){n&&(i.btnRefresh.hide(),i.okBtn.hide(),i.btnToggel.animate({borderSpacing:0},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),n=!1,i.gridSelectDiv.animate({width:f},"fast"),i.sideDiv.animate({width:"toggle",height:"toggle"},"slow"));i.gridSelectDiv.css("display","none");i.sideDiv.css("display","none");i.gridGenerateDiv.css("display","block");i.btnToggel.hide();lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary),1)");lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")}var i,a;this.frame;this.windowNo;i=this;this.arrListColumns=[];this.dGrid=null;var c=null,e=null,l=null,w=!1,b=!1,u=!1;this.lblOrg=new n.Controls.VLabel;this.lblBPartner=new n.Controls.VLabel;this.lblStatusInfo=new n.Controls.VLabel;this.tabSelect=new n.Controls.VLabel;this.tabGenrate=new n.Controls.VLabel;this.cmbOrg=new n.Controls.VComboBox("",!1,!1,!0);this.vSearchBPartner=null;this.vSearchOrderShipment=null;a=null;this.$root=t("<div style='width: 100%; height: 100%; background-color: white;'>");this.$busyDiv=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');this.topDiv=null;this.sideDiv=null;this.gridSelectDiv=null;this.gridGenerateDiv=null;this.bottumDiv=null;this.div=null;this.okBtn=null;this.cancelBtn=null;this.btnRefresh=null;this.btnToggel=null;this.spnSelect=null;this.spnGenerate=null;this.btnSpaceDiv=null;this.lblGenrate=null;this.lblSelect=null;var o=null,s=null,r=260,h=50,f=t(window).width()-(r+20+5),v=t(window).width()-(20+h),k=f+r+5,d=t(window).height()-210;this.vetoablechange=function(){l=i.vSearchBPartner.getValue();a=i.vSearchOrderShipment.getValue();i.okBtn.removeAttr("disabled");y()};this.sizeChanged=function(n,t){f=t-(r+20);v=t-(20+h);u==!0?(i.btnSpaceDiv.animate({width:h},"slow"),i.sideDiv.animate({width:h},"slow"),i.div.css("display","none"),i.gridSelectDiv.animate({width:v},"slow",null,function(){i.dGrid.resize()})):(i.btnSpaceDiv.animate({width:r},"slow"),i.gridSelectDiv.animate({width:f},"slow"),i.div.css("display","block"),i.sideDiv.animate({width:r},"slow",null,function(){i.dGrid.resize()}))};this.Initialize=function(){if(tt(),nt(),g(),this.btnToggel=this.$root.find("#btnSpace_"+i.windowNo),this.spnSelect=this.$root.find("#spnSelect_"+i.windowNo),this.spnGenerate=this.$root.find("#spnGenerate_"+i.windowNo),this.okBtn!=null)this.okBtn.on(n.Events.onTouchStartOrClick,function(){i.$busyDiv[0].style.visibility="visible";t(i.$root[0]).addClass("vis-apanel-busyVInOutGenRoot");t(i.$busyDiv[0]).addClass("vis-apanel-busyVInOutGenBusyDiv");i.okBtn.attr("disabled","disabled");c=it();c!=null&&c.length>0?rt(c):(i.$busyDiv[0].style.visibility="hidden",n.ADialog.error("PlzSelectatLeast1Inv"));i.okBtn.removeAttr("disabled")});if(this.cancelBtn!=null)this.cancelBtn.on(n.Events.onTouchStartOrClick,function(){i.$root.dialog("close")});if(this.btnRefresh!=null)this.btnRefresh.on(n.Events.onTouchStartOrClick,function(){i.okBtn.removeAttr("disabled");e=i.cmbOrg.getControl().find("option:selected").val();l=i.vSearchBPartner.getValue();y()});if(this.btnToggel!=null)var a=0;this.btnToggel.on(n.Events.onTouchStartOrClick,function(){u?(a=n.Application.isRTL?180:0,i.btnToggel.animate({borderSpacing:a},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!1,i.btnSpaceDiv.animate({width:r},"slow"),i.gridSelectDiv.animate({width:f},"slow"),i.div.css("display","block"),i.sideDiv.animate({width:r},"slow",null,function(){i.dGrid.resize()})):(a=n.Application.isRTL?0:180,i.btnToggel.animate({borderSpacing:a},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!0,i.btnSpaceDiv.animate({width:h},"slow"),i.sideDiv.animate({width:h},"slow"),i.div.css("display","none"),i.gridSelectDiv.animate({width:v},"slow",null,function(){i.dGrid.resize()}))});if(this.spnGenerate!=null)this.spnGenerate.on(n.Events.onTouchStartOrClick,function(){i.btnRefresh.hide();i.okBtn.hide();u&&(i.btnToggel.animate({borderSpacing:0},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),u=!1,i.gridSelectDiv.animate({width:f},"fast"),i.sideDiv.animate({width:r},"fast"),i.btnSpaceDiv.animate({width:r},"fast"));i.gridSelectDiv.css("display","none");i.sideDiv.css("display","none");i.gridGenerateDiv.css("display","block");i.btnToggel.hide();lblSelect.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary),1)");lblGenrate.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)")});if(this.spnSelect!=null)this.spnSelect.on(n.Events.onTouchStartOrClick,function(){u||(i.btnRefresh.show(),i.okBtn.show(),i.gridGenerateDiv.css("display","none"),i.gridSelectDiv.css("display","block"),i.sideDiv.css("display","block"),i.div.css("display","block"),i.gridSelectDiv.animate({width:f},"fast"),i.btnToggel.show(),lblSelect.css("font-size","28px").css("color","rgba(var(--v-c-primary), 1)"),lblGenrate.css("font-size","17px").css("color","rgba(var(--v-c-on-secondary),1)"))});if(this.cmbOrg!=null&&this.cmbOrg.getControl().change(function(){i.okBtn.removeAttr("disabled");e=i.cmbOrg.getControl().find("option:selected").val();y()}),this.vSearchBPartner!=null&&this.vSearchBPartner.addVetoableChangeListener(this),this.vSearchOrderShipment!=null&&this.vSearchOrderShipment.addVetoableChangeListener(this),o!=null)o.on(n.Events.onTouchStartOrClick,function(){i.vSearchBPartner.isReadOnly||i.vSearchBPartner.setValue(null,!1,!0)});if(s!=null)s.on(n.Events.onTouchStartOrClick,function(){i.vSearchOrderShipment.isReadOnly||i.vSearchOrderShipment.setValue(null,!1,!0)})};this.display=function(){p(null)};this.getRoot=function(){return this.$root};this.refreshUI=function(){this.dGrid.resize()};this.disposeComponent=function(){this.okBtn&&this.okBtn.off(n.Events.onTouchStartOrClick);this.cancelBtn&&this.cancelBtn.off(n.Events.onTouchStartOrClick);o&&o.off(n.Events.onTouchStartOrClick);s&&s.off(n.Events.onTouchStartOrClick);i=null;this.frame=null;this.windowNo=null;this.arrListColumns=null;this.dGrid=null;c=null;e=null;l=null;w=null;b=null;u=null;this.lblOrg=null;this.lblBPartner=null;this.lblStatusInfo=null;this.tabSelect=null;this.tabGenrate=null;this.cmbOrg=null;this.vSearchBPartner=null;this.$root=null;this.$busyDiv=null;this.topDiv=null;this.sideDiv=null;this.gridSelectDiv=null;this.gridGenerateDiv=null;this.bottumDiv=null;this.okBtn=null;this.cancelBtn=null;this.btnRefresh=null;this.btnToggel=null;this.spnSelect=null;this.spnGenerate=null;r=null;f=null;v=null;k=null;d=null;this.getRoot=null;this.disposeComponent=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(t,i){this.frame=i;this.windowNo=t;n.Env.getCtx().setContext(this.windowNo,"IsSOTrx","Y");try{var r=this.Initialize()}catch(u){}this.frame.getContentGrid().append(this.getRoot());this.display();this.cmbOrg.getControl().focus()};i.prototype.refresh=function(){this.refreshUI()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VInvoiceGen=i}(VIS,jQuery),function(n,t){function i(){function ci(){var tt=n.Application.contextUrl+"Areas/VIS/Images/base/arrow-left.png",e,f,u,r,h;d=t('<button id = "btnClearBP_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button>');g=t('<button id = "btnClearOrd_'+i.windowNo+'" tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i class="fa fa-arrow-left" title="'+n.Msg.getMsg("Clear",!1,!1)+'"><\/i><\/button>');i.topDiv=t("<div id='topDiv_"+i.windowNo+"'  class='vis-archive-l-s-head vis-frm-ls-top' style='padding: 0;'><div id='btnSpaceDiv_"+i.windowNo+"' class='vis-l-s-headwrp'><button id='btnToggelDiv_"+i.windowNo+"' class='vis-archive-sb-t-button' ><i class='vis vis-arrow-left'><\/i><\/button><\/div><\/div>");e=t("<div class='vis-frm-contenthead'>");e.append(i.lblInvoice.getControl().addClass("VIS_Pref_Label_Font"));e.append(chkSameBPartnerDiv);e.append(chkSameProductDiv);e.append(chkSameQtyDiv);i.topDiv.append(e);i.invoiceTopDiv=e;i.btnSpaceDiv=i.topDiv.find("#btnSpaceDiv_"+i.windowNo);i.sideDiv=t("<div id='sideDiv_"+i.windowNo+"' class='vis-archive-l-s-content vis-mi-ls-wrp vis-leftsidebarouterwrap'>");i.sideDiv.css("width",v);i.div=t("<div class='vis-archive-l-s-content-inner' id='parameterDiv_"+i.windowNo+"'>");i.sideDiv.append(i.div);f=t("<table style='width: 100%;height: 100%;'>");i.div.append(f);tr=t("<tr>");td=t("<td style='padding: 10px 10px 0px;'>");u=t('<div class="input-group vis-input-wrap">');r=t('<div class="vis-control-wrap">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.cmbMatchFrom.getControl());r.append(i.lblMatchFrom.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");u=t('<div class="input-group vis-input-wrap">');r=t('<div class="vis-control-wrap">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.cmbMatchTo.getControl());r.append(i.lblMatchTo.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");u=t('<div class="input-group vis-input-wrap">');r=t('<div class="vis-control-wrap">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.cmbMatchMode.getControl());r.append(i.lblMatchMode.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");var u=t('<div class="input-group vis-input-wrap">'),r=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.onlyVendor.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));r.append(i.lblBPartner.getControl().addClass("VIS_Pref_Label_Font"));o.append(i.onlyVendor.getBtn(0));o.append(d);u.append(o);tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");var u=t('<div class="input-group vis-input-wrap">'),r=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.onlyProduct.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));r.append(i.lblProduct.getControl().addClass("VIS_Pref_Label_Font"));o.append(i.onlyProduct.getBtn(0));o.append(g);u.append(o);tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");u=t('<div class="input-group vis-input-wrap">');r=t('<div class="vis-control-wrap">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.dtpFrom);r.append(i.lblDateFrom.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");u=t('<div class="input-group vis-input-wrap">');r=t('<div class="vis-control-wrap">');f.append(tr);tr.append(td);td.append(u);u.append(r);r.append(i.dtpTo);r.append(i.lblDateTo.getControl().addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");f.append(tr);tr.append(td);td.append(chkIsReturnTrxDiv);i.divForGrid=t("<div id='divForGrid_"+i.windowNo+"' class='vis-mi-main-contntwrp'>");i.gridInvoiceDiv=t("<div id='gridInvoiceDiv_"+i.windowNo+"' style='width: 100%;flex: 1; '>");i.invoicegrd=t("<div style='float: left; width: 100%;height: 100%;'>");i.gridInvoiceDiv.append(i.invoicegrd);i.gridReciptDiv=t("<div id='gridReciptDiv_"+i.windowNo+"' style='width: 100%;flex: 1;'>");h=t("<div style='float: left; width: 100%; margin-top: 0px;'>");h.append(i.lblReceipt.getControl().css("display","inline-block").css("font-size","24px").css("color","rgba(var(--v-c-primary), 1)").addClass("VIS_Pref_Label_Font"));i.reciptgrd=t("<div style='float: left; width: 100%;height: 100%;'>");i.gridReciptDiv.append(i.reciptgrd);var s=t("<div class='vis-info-btnfileds-wrap'>"),y=t("<div class='vis-info-botdatafield'>"),p=t("<div class='input-group vis-input-wrap'>"),c=t("<div class='vis-control-wrap'>");y.append(p);p.append(c);c.append(i.txtMatched.getControl());c.append(i.lblMatched.getControl().addClass("VIS_Pref_Label_Font"));s.append(y);var w=t("<div class='vis-info-botdatafield' style='padding-left: 15px;'>"),b=t("<div class='input-group vis-input-wrap'>"),l=t("<div class='vis-control-wrap'>");w.append(b);b.append(l);l.append(i.txtMatchedTo.getControl());l.append(i.lblMatchedTo.getControl().addClass("VIS_Pref_Label_Font"));s.append(w);var k=t("<div class='vis-info-botdatafield' style='padding-left: 15px;'>"),nt=t("<div class='input-group vis-input-wrap'>"),a=t("<div class='vis-control-wrap'>");k.append(nt);nt.append(a);a.append(i.txtDifference.getControl());a.append(i.lblDifference.getControl().addClass("VIS_Pref_Label_Font"));s.append(k);i.bottumButtonDiv=t("<div class='vis-info-btmcnt-wrap'>");i.searchBtnWrap=t("<div class='vis-info-searchbtn-wrap'>");i.bottumButtonDiv.append(i.searchBtnWrap);i.searchBtnWrap.append(i.btnSearch);i.bottumButtonDiv.append(s);i.bottumButtonDiv.append(i.btnProcess);i.bottumDiv=t("<div class='vis-mi-bot-div'>");i.bottumDiv.append(i.lblStatusInfo.getControl().addClass("VIS_Pref_Label_Font"));i.bottumDiv.append(i.lblStatusCount.getControl().css("float","right").addClass("VIS_Pref_Label_Font"));i.divForGrid.append(i.gridInvoiceDiv).append(h).append(i.gridReciptDiv);i.$root.append(i.topDiv).append(i.sideDiv).append(i.divForGrid).append(i.bottumButtonDiv).append(i.bottumDiv);i.$root.append(i.$busyDiv)}function li(){var r=n.Application.contextUrl+"Areas/VIS/Images/base/arrow-left.png";i.dtpFrom=t("<input id='dateFrom_"+i.windowNo+"' type='date' name='DateOrdered'>");i.dtpTo=t("<input id='dateTo_"+i.windowNo+"' type='date' name='DateOrdered'>");this.chkIsReturnTrxDiv=t("<div>");i.chkIsReturnTrx=t("<input id='chkIsReturnTrx_"+i.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblIsReturnTrx_"+i.windowNo+"' class='VIS_Pref_Label_Font'>Return Transaction<\/label><\/span>");this.chkIsReturnTrxDiv.append(i.chkIsReturnTrx);this.chkSameBPartnerDiv=t("<div class='vis-matchpoTopcheckwrap'>");i.chkSameBPartner=t("<input id='chkSameBPartner_"+i.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblSameBPartner_"+i.windowNo+"' class='VIS_Pref_Label_Font'>Same BPartner<\/label><\/span>");this.chkSameBPartnerDiv.append(i.chkSameBPartner);this.chkSameProductDiv=t("<div class='vis-matchpoTopcheckwrap'>");i.chkSameProduct=t("<input id='chkSameProduct_"+i.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblSameProduct_"+i.windowNo+"' class='VIS_Pref_Label_Font'>Same Product<\/label><\/span>");this.chkSameProductDiv.append(i.chkSameProduct);this.chkSameQtyDiv=t("<div class='vis-matchpoTopcheckwrap'>");i.chkSameQty=t("<input id='chkSameQty_"+i.windowNo+"' type='checkbox' class='VIS_Pref_automatic'><span><label id='lblSameQty_"+i.windowNo+"' class='VIS_Pref_Label_Font'>Same Quantity<\/label><\/span>");this.chkSameQtyDiv.append(i.chkSameQty);i.btnSearch=t("<input id='btnSearch_"+i.windowNo+"' class='VIS_Pref_btn-2' style='margin-top: 0px;' type='button' value='Search'>");i.btnProcess=t("<Button id='btnProcess_"+i.windowNo+"' style='margin-top: 0px;' class='VIS_Pref_btn-2'>"+n.Msg.getMsg("Match")+"<\/Button>");i.lblInvoice.getControl().text(n.Msg.translate(n.Env.getCtx(),"Invoice"));i.lblReceipt.getControl().text(n.Msg.translate(n.Env.getCtx(),"Receipt"));i.lblMatchFrom.getControl().text(n.Msg.translate(n.Env.getCtx(),"MatchFrom"));i.lblMatchTo.getControl().text(n.Msg.translate(n.Env.getCtx(),"MatchTo"));i.lblMatchMode.getControl().text(n.Msg.translate(n.Env.getCtx(),"MatchMode"));i.lblBPartner.getControl().text(n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID"));i.lblProduct.getControl().text(n.Msg.translate(n.Env.getCtx(),"M_Product_ID"));i.lblDateFrom.getControl().text(n.Msg.translate(n.Env.getCtx(),"DateFrom"));i.lblDateTo.getControl().text(n.Msg.translate(n.Env.getCtx(),"DateTo"));i.lblMatched.getControl().text(n.Msg.translate(n.Env.getCtx(),"ToBeMatched"));i.lblMatchedTo.getControl().text(n.Msg.translate(n.Env.getCtx(),"Matching"));i.lblDifference.getControl().text(n.Msg.translate(n.Env.getCtx(),"Difference"));i.chkIsReturnTrx.prop("checked",!1);i.btnProcess.attr("disabled","disabled");i.chkSameProduct.prop("checked",!0);i.chkSameBPartner.prop("checked",!0);i.chkSameQty.prop("checked",!1);i.chkIsReturnTrx.next("label").text(n.Msg.translate(n.Env.getCtx(),"isReturnTrx"));i.chkSameProduct.next("label").text(n.Msg.translate(n.Env.getCtx(),"SameProduct"));i.chkSameBPartner.next("label").text(n.Msg.translate(n.Env.getCtx(),"SameBPartner"));i.chkSameQty.next("label").text(n.Msg.translate(n.Env.getCtx(),"SameQty"));i.lblSearch.getControl().text(n.Msg.translate(n.Env.getCtx(),"Search"));i.btnSearch.text(n.Msg.translate(n.Env.getCtx(),"Search"))}function wt(){ri();bt();i.lblStatusInfo.getControl().text("");i.lblStatusCount.getControl().text(0)}function ai(){var t=n.MLookupFactory.getMLookUp(n.Env.getCtx(),i.windowNo,3499,n.DisplayType.Search);i.onlyVendor=new n.Controls.VTextBoxButton("C_BPartner_ID",!0,!1,!0,n.DisplayType.Search,t);t=n.MLookupFactory.getMLookUp(n.Env.getCtx(),i.windowNo,3840,n.DisplayType.Search);i.onlyProduct=new n.Controls.VTextBoxButton("M_Product_ID",!0,!1,!0,n.DisplayType.Search,t)}function bt(){i.cmbMatchTo.getControl().empty();var n=null;i.cmbMatchFrom.getControl().find("option").length>0&&(n=i.cmbMatchFrom.getControl().find("option:selected").val(),n.equals(r[o])?i.cmbMatchTo.getControl().append(" <option value='"+r[f]+"'>"+r[f]+"<\/option>"):n.equals(r[u])?i.cmbMatchTo.getControl().append(" <option value='"+r[f]+"'>"+r[f]+"<\/option>"):(i.cmbMatchTo.getControl().append(" <option value='"+r[o]+"'>"+r[o]+"<\/option>"),i.cmbMatchTo.getControl().append(" <option value='"+r[u]+"'>"+r[u]+"<\/option>")),i.cmbMatchTo.getControl().prop("selectedIndex",0),i.lblInvoice.getControl().text(n));kt()}function kt(){selection=i.cmbMatchTo.getControl().find("option:selected").val();i.lblReceipt.getControl().text(selection)}function et(){var v=i.cmbMatchFrom.getControl()[0].selectedIndex,c=i.cmbMatchTo.getControl().find("option:selected").val(),h=o,l,a,t,e;c.equals(r[f])?h=f:c.equals(r[u])&&(h=u);yt=h;ti(v,h);ft="";i.vdgvReceipt!=null&&i.vdgvReceipt.clear();i.onlyProduct.getValue()!=null&&(l=i.onlyProduct.getValue(),at=" AND lin.M_Product_ID="+l);i.onlyVendor.getValue()!=null&&(a=i.onlyVendor.getValue(),vt=" AND hdr.C_BPartner_ID="+a);t=i.dtpFrom.val();e=i.dtpTo.val();t!=""&&e!=""?ht=" AND "+s+" BETWEEN "+n.DB.to_date(t)+" AND "+n.DB.to_date(e):t!=""?ct=" AND "+s+" >= "+n.DB.to_date(t):e!=""&&(lt=" AND "+s+" <= "+n.DB.to_date(e));ii(i.vdgvInvoice);i.txtMatched.getControl().val(0);i.lblStatusInfo.getControl().text(i.cmbMatchFrom.getControl().find("option:selected").val()+"# = "+i.vdgvInvoice.records.length+" -"+i.cmbMatchTo.getControl().find("option:selected").val()+"# = "+i.vdgvReceipt.records.length);i.lblStatusCount.getControl().text(0)}function c(n){var t,s,h,e,c,v,p,a,w;nt="";tt="";it="";t=-1;n!=null?t=n:i.vdgvInvoice.getSelection().length>0&&(t=Number(i.vdgvInvoice.getSelection().toString()));s=0;t<0?i.$busyDiv[0].style.visibility="hidden":(h=i.cmbMatchTo.getControl().find("option:selected").val(),e=o,h.equals(r[f])?e=f:h.equals(r[u])&&(e=u),c=i.cmbMatchFrom.getControl()[0].selectedIndex,yt=c,ti(e,c),v={key:i.vdgvInvoice.get(t).C_BPartner_ID_K,value:i.vdgvInvoice.get(t).C_BPartner_ID},p={key:i.vdgvInvoice.get(t).M_Product_ID_K,value:i.vdgvInvoice.get(t).M_Product_ID},i.chkSameBPartner.prop("checked")&&(nt=" AND hdr.C_BPartner_ID="+v.key),i.chkSameProduct.prop("checked")&&(tt=" AND lin.M_Product_ID="+p.key),a=i.vdgvInvoice.get(t).Qty,w=i.vdgvInvoice.get(t).Matched,s=a-w,i.chkSameQty.prop("checked")&&(it=" AND "+y+"="+a),ft=i.vdgvInvoice.get(t).Line_K,ii(i.vdgvReceipt));l=s;i.txtMatched.setValue(l);i.txtMatchedTo.setValue(0);i.txtDifference.setValue(l);i.lblStatusInfo.getControl().text(i.cmbMatchFrom.getControl().find("option:selected").val()+"# = "+i.vdgvInvoice.records.length+" -"+i.cmbMatchTo.getControl().find("option:selected").val()+"# = "+i.vdgvReceipt.records.length);i.lblStatusCount.getControl().text(0)}function vi(){var n=-1,o,h,c;if(i.vdgvInvoice.getSelection().length>0&&(n=Number(i.vdgvInvoice.getSelection().toString())),n<0){e=!1;i.$busyDiv[0].style.visibility="hidden";return}var b={key:i.vdgvInvoice.get(n).C_BPartner_ID_K,value:i.vdgvInvoice.get(n).C_BPartner_ID},a={key:i.vdgvInvoice.get(n).Line_K,value:i.vdgvInvoice.get(n).Line},v={key:i.vdgvInvoice.get(n).M_Product_ID_K,value:i.vdgvInvoice.get(n).M_Product_ID},y=l,k=i.vdgvInvoice.get(n).Matched,f=i.vdgvReceipt.getSelection().toString();if(f==null){e=!1;i.$busyDiv[0].style.visibility="hidden";return}if(f.length<=0){e=!1;i.$busyDiv[0].style.visibility="hidden";return}o=!0;(i.cmbMatchFrom.getControl().find("option:selected").val().equals(r[u])||i.cmbMatchTo.getControl().find("option:selected").val().equals(r[u]))&&(o=!1);var p=i.cmbMatchMode.getControl()[0].selectedIndex,w=i.cmbMatchFrom.getControl()[0].selectedIndex,s=[],t=f.toString().split(",");for(n=0;n<t.length;n++)if(h=i.vdgvReceipt.get(t[n])._ID,h!=null){if(c={key:i.vdgvReceipt.get(t[n]).M_Product_ID_K,value:i.vdgvReceipt.get(t[n]).M_Product_ID},v.key!=c.key)continue;s.push(i.vdgvReceipt.get(t[n]))}else continue;if(s.length>0)yi(o,p,w,a.key,y,s);else{e=!1;i.$busyDiv[0].style.visibility="hidden";return}}function ti(n){nt="";tt="";it="";ht="";ct="";lt="";at="";vt="";ni=i.cmbMatchMode.getControl()[0].selectedIndex==pt;ot="";dt=i.chkIsReturnTrx.prop("checked");st="";gt=!1;matchToTypeMATCH_ORDER="matchToTypeMATCH_ORDER";n==o?(ot="displayMATCH_INVOICE",s="hdr.DateInvoiced",y="lin.QtyInvoiced"):n==u?(st="displayMATCH_ORDER",s="hdr.DateOrdered",y="lin.QtyOrdered"):(s="hdr.MovementDate",y="lin.MovementQty")}function ii(r){var e=[],o={displayMATCH_INVOICEs:ot,chkIsReturnTrxProps:dt,displayMATCH_ORDERs:st,matchToTypeMATCH_SHIPMENTs:gt,matchedsss:ni,chkSameBPartnerss:nt,chkSameProductss:tt,chkSameQtyss:it,from_ss:ht,fromIfs:ct,to_Dats:lt,matchToTypes:yt,MATCH_SHIPMENTs:f,MATCH_ORDERs:u,onlyProduct_ss:at,onlyVendor_ss:vt,MatchToID:ft};t.ajax({url:n.Application.contextUrl+"VCreateFrom/GetTableLoadVmatch",dataType:"json",data:o,success:function(n){var t=JSON.parse(n),o,u,f,s,h;if(t&&t!=null)for(o=1,u=0;u<t.length;u++)f={},f._ID=t[u]._ID,f.DocumentNo=t[u].DocNo,s=t[u].Date,h=new Date(s),t[u].Date=h.toLocaleDateString(),f.Date=t[u].Date,f.C_BPartner_ID=t[u].CBPartnerIDK,f.C_BPartner_ID_K=t[u].CBPartnerID,f.Line=t[u].Line,f.Line_K=t[u].Line_K,f.M_Product_ID=t[u].MProductIDK,f.M_Product_ID_K=t[u].MProductID,f.Qty=t[u].Qty,f.Matched=t[u].Matched,f.recid=o,o++,e.push(f);e.length<1?(ri(r.name.contains("vdgvReceipt")),i.$busyDiv[0].style.visibility="hidden"):r.name.contains("vdgvReceipt")?(wi(i.arrListColumns,e),i.$busyDiv[0].style.visibility="hidden"):r.name.contains("vdgvInvoice")&&(pi(i.arrListColumns,e),c())},error:function(n){console.log(n);i.$busyDiv[0].style.visibility="hidden"}})}function yi(r,u,f,o,s,h){var c=i;t.ajax({url:n.Application.contextUrl+"Common/CreateMatchRecord",dataType:"json",data:{invoice:r,MatchMode:u,MatchFrom:f,LineMatched:o,ToMatchQty:s,SelectedItems:JSON.stringify(h)},success:function(t){et();i.vdgvReceipt.delete(!0);var r=JSON.parse(t);r.Msg!=""?n.ADialog.info("",null,r.Msg,null):r.MatchedPO_ID>0?n.ADialog.info("Matched",null,n.Msg.getMsg("PurchaseOrder")+" - "+r.MatchedPO_ID,null):r.MatchedInv_ID>0&&n.ADialog.info("Matched",null,n.Msg.getMsg("Invoice")+" - "+r.MatchedInv_ID,null);e=!1;i.$busyDiv[0].style.visibility="hidden"},error:function(n,t){console.log(t);e=!1;i.$busyDiv[0].style.visibility="hidden"}})}function ri(r){i.arrListColumns.length==0&&(i.arrListColumns.push({field:"_ID",caption:"_ID",sortable:!0,size:"11%",hidden:!0}),i.arrListColumns.push({field:"DocumentNo",caption:n.Msg.translate(n.Env.getCtx(),"DocumentNo"),sortable:!0,size:"11%",hidden:!1}),i.arrListColumns.push({field:"Date",caption:n.Msg.translate(n.Env.getCtx(),"Date"),sortable:!0,size:"11%",hidden:!1}),i.arrListColumns.push({field:"C_BPartner_ID",caption:n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"11%",hidden:!1}),i.arrListColumns.push({field:"C_BPartner_ID_K",caption:n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID"),sortable:!0,size:"11%",hidden:!0}),i.arrListColumns.push({field:"Line",caption:n.Msg.translate(n.Env.getCtx(),"Line"),sortable:!0,size:"11%",hidden:!1}),i.arrListColumns.push({field:"Line_K",caption:n.Msg.translate(n.Env.getCtx(),"Line"),sortable:!0,size:"11%",hidden:!0}),i.arrListColumns.push({field:"M_Product_ID",caption:n.Msg.translate(n.Env.getCtx(),"M_Product_ID"),sortable:!0,size:"11%",hidden:!1}),i.arrListColumns.push({field:"M_Product_ID_K",caption:n.Msg.translate(n.Env.getCtx(),"M_Product_ID"),sortable:!0,size:"11%",hidden:!0}),i.arrListColumns.push({field:"Qty",caption:n.Msg.translate(n.Env.getCtx(),"Qty"),sortable:!0,size:"11%",hidden:!1,render:function(t){var i=n.Utility.Util.getValueOfDecimal(t.Qty);return i.toLocaleString()}}),i.arrListColumns.push({field:"Matched",caption:n.Msg.translate(n.Env.getCtx(),"Matched"),sortable:!0,size:"11%",hidden:!1}));r==null?(i.vdgvInvoice!=null&&(i.vdgvInvoice.destroy(),i.vdgvInvoice=null),i.vdgvInvoice=t(i.invoicegrd).w2grid({name:"vdgvInvoice"+i.windowNo,recordHeight:30,show:{selectColumn:!1},onSelect:function(n){c(n.recid)},multiSelect:!1,columns:i.arrListColumns,records:null}),i.vdgvReceipt!=null&&(i.vdgvReceipt.destroy(),i.vdgvReceipt=null),i.vdgvReceipt=t(i.reciptgrd).w2grid({name:"vdgvReceipt"+i.windowNo,recordHeight:30,show:{selectColumn:!0},onSelect:function(n){this.multiSelect=!0;a(n.recid,!0)},onUnselect:function(n){a(n.recid,!1)},multiSelect:!1,columns:i.arrListColumns,records:null})):r?r&&(i.vdgvReceipt!=null&&(i.vdgvReceipt.destroy(),i.vdgvReceipt=null),i.vdgvReceipt=t(i.reciptgrd).w2grid({name:"vdgvReceipt"+i.windowNo,recordHeight:30,show:{selectColumn:!0},onSelect:function(n){this.multiSelect=!0;a(n.recid,!0)},onUnselect:function(n){a(n.recid,!1)},multiSelect:!1,columns:i.arrListColumns,records:null})):(i.vdgvInvoice!=null&&(i.vdgvInvoice.destroy(),i.vdgvInvoice=null),i.vdgvInvoice=t(i.invoicegrd).w2grid({name:"vdgvInvoice"+i.windowNo,recordHeight:30,show:{selectColumn:!1},onSelect:function(n){c(n.recid)},multiSelect:!1,columns:i.arrListColumns,records:null}))}function pi(n,r){i.vdgvInvoice!=null&&(i.vdgvInvoice.destroy(),i.vdgvInvoice=null);w2utils.encodeTags(r);i.vdgvInvoice=t(i.invoicegrd).w2grid({name:"vdgvInvoice"+i.windowNo,recordHeight:30,show:{selectColumn:!1},onSelect:function(n){c(n.recid)},multiSelect:!1,columns:n,records:r})}function wi(n,r){i.vdgvReceipt!=null&&(i.vdgvReceipt.destroy(),i.vdgvReceipt=null);w2utils.encodeTags(r);i.vdgvReceipt=t(i.reciptgrd).w2grid({name:"vdgvReceipt"+i.windowNo,recordHeight:30,show:{selectColumn:!0},onSelect:function(n){this.multiSelect=!0;a(n.recid,!0)},onUnselect:function(n){a(n.recid,!1)},multiSelect:!1,columns:n,records:r})}function a(n,t){var o,s,r,u,c,a;if(!(i.vdgvInvoice.records.length<1)){if(!i.chkSameProduct.prop("checked")){setTimeout(function(){i.vdgvReceipt.unselect(Number(n))},10);return}o=-1;s=null;i.vdgvInvoice.getSelection().length>0&&(o=Number(i.vdgvInvoice.getSelection().toString()),s={key:i.vdgvInvoice.get(o).M_Product_ID_K,value:i.vdgvInvoice.get(o).M_Product_ID});var f=0,h=0,e=n+","+i.vdgvReceipt.getSelection().toString().replace(n,"");if(t&&e!=null&&e.length>0)for(e=e.replace(/,$/,""),r=e.toString().split(","),u=0;u<r.length;u++)if(c=i.vdgvReceipt.get(r[0])._ID,c!=null){if(a={key:i.vdgvReceipt.get(r[u]).M_Product_ID_K,value:i.vdgvReceipt.get(r[u]).M_Product_ID},s.key!=a.key){setTimeout(function(){i.vdgvReceipt.unselect(Number(n))},10);return}i.cmbMatchMode.getControl()[0].selectedIndex==b&&(f=f+Number(i.vdgvReceipt.get(r[u]).Qty));f=f-Number(i.vdgvReceipt.get(r[u]).Matched);h++}k=f;i.txtMatchedTo.setValue(k.toString());i.txtDifference.setValue(l-k);h<=0&&i.btnProcess.removeAttr("disabled");i.lblStatusCount.getControl().text(h)}}var i,h;this.frame;this.windowNo;i=this;this.arrListColumns=[];this.vdgvInvoice=null;this.vdgvReceipt=null;this.lblMatchFrom=new n.Controls.VLabel;this.lblMatchTo=new n.Controls.VLabel;this.lblMatchMode=new n.Controls.VLabel;this.lblBPartner=new n.Controls.VLabel;this.lblProduct=new n.Controls.VLabel;this.lblDateFrom=new n.Controls.VLabel;this.lblDateTo=new n.Controls.VLabel;this.lblInvoice=new n.Controls.VLabel;this.lblReceipt=new n.Controls.VLabel;this.lblMatched=new n.Controls.VLabel;this.lblMatchedTo=new n.Controls.VLabel;this.lblDifference=new n.Controls.VLabel;this.lblStatusInfo=new n.Controls.VLabel;this.lblStatusCount=new n.Controls.VLabel;this.lblSearch=new n.Controls.VLabel;this.cmbMatchFrom=new n.Controls.VComboBox("",!1,!1,!0);this.cmbMatchTo=new n.Controls.VComboBox("",!1,!1,!0);this.cmbMatchMode=new n.Controls.VComboBox("",!1,!1,!0);this.chkIsReturnTrx=null;this.chkSameBPartner=null;this.chkSameProduct=null;this.chkSameQty=null;this.onlyVendor=null;this.onlyProduct=null;this.dtpFrom=null;this.dtpTo=null;this.btnSearch=null;this.btnProcess=null;this.btnToggel=null;this.txtMatched=new n.Controls.VTextBox("",!1,!0,!1);this.txtMatchedTo=new n.Controls.VTextBox("",!1,!0,!1);this.txtDifference=new n.Controls.VTextBox("",!1,!0,!1);this.$root=t("<div style='width: 100%; height: 100%; background-color: white;'>");this.$busyDiv=t("<div id='testBesy' class='vis-busyindicatorouterwrap'><div class='vis-busyindicatorinnerwrap'><i class='vis-busyindicatordiv'><\/i><\/div><\/div>");this.sideDiv=null;this.gridSelectDiv=null;this.gridInvoiceDiv=null;this.gridReciptDiv=null;this.processlDiv=null;this.bottumDiv=null;this.bottumButtonDiv=null;this.btnSpaceDiv=null;this.topDiv=null;this.div=null;this.divForGrid=null;this.invoicegrd=null;this.reciptgrd=null;this.invoiceTopDiv=null;var p=!1,v=260,w=50,rt=t(window).width()-v,ut=t(window).width()-w,ui=t(window).height()-240,fi=n.Env.getCtx().getAD_Client_ID(),ei=n.Env.getCtx().getAD_Org_ID(),oi=n.Env.getCtx().getAD_User_ID(),o=0,f=1,u=2,b=0,pt=1,si=null,s="",y="",hi="",l=0,k=0,ft="",d=null,g=null,e=!1,r=[];r.push(n.Msg.getElement3(n.Env.getAD_Language(n.Env.getCtx()),"C_Invoice_ID",!1));r.push(n.Msg.getElement3(n.Env.getAD_Language(n.Env.getCtx()),"M_InOut_ID",!1));r.push(n.Msg.getElement3(n.Env.getAD_Language(n.Env.getCtx()),"C_Order_ID",!1));h=[];h.push(n.Msg.getMsg("NotMatched"));h.push(n.Msg.getMsg("Matched"));var ot="",dt="",st="",gt=!1,ni="",nt="",tt="",it="",ht="",ct="",lt="",at="",vt="",yt="";this.Initialize=function(){for(var u=0;u<r.length;u++)this.cmbMatchFrom.getControl().append(" <option value='"+r[u]+"'>"+r[u]+"<\/option>");for(u=0;u<h.length;u++)this.cmbMatchMode.getControl().append(" <option value='"+h[u]+"'>"+h[u]+"<\/option>");if(this.cmbMatchFrom.getControl().prop("selectedIndex",0),this.cmbMatchMode.getControl().prop("selectedIndex",0),ai(),li(),ci(),this.btnToggel=this.$root.find("#btnToggelDiv_"+i.windowNo),this.gridSelectDiv=this.$root.find("#divForGrid_"+i.windowNo),this.cmbMatchFrom.getControl()!=null&&this.cmbMatchFrom.getControl().change(function(){i.$busyDiv[0].style.visibility="visible";wt();bt();i.$busyDiv[0].style.visibility="hidden"}),this.cmbMatchTo.getControl()!=null&&this.cmbMatchTo.getControl().change(function(){i.$busyDiv[0].style.visibility="visible";kt();i.$busyDiv[0].style.visibility="hidden"}),this.cmbMatchMode.getControl()!=null&&this.cmbMatchMode.getControl().change(function(){i.cmbMatchMode.getControl()[0].selectedIndex==b?i.btnProcess.text(n.Msg.getMsg("Match")):i.btnProcess.text(n.Msg.getMsg("Unmatch"))}),this.btnSearch!=null)this.btnSearch.on(n.Events.onTouchStartOrClick,function(){i.$busyDiv[0].style.visibility="visible";et()});if(this.btnProcess!=null)this.btnProcess.on(n.Events.onTouchStartOrClick,function(){e||(i.$busyDiv[0].style.visibility="visible",e=!0,vi())});if(this.btnToggel!=null)this.btnToggel.on(n.Events.onTouchStartOrClick,function(){p?(i.btnToggel.animate({borderSpacing:0},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),p=!1,i.btnSpaceDiv.animate({width:v},"slow"),i.gridSelectDiv.animate({width:rt},"slow"),i.invoiceTopDiv.animate({width:rt},"slow"),i.div.css("display","block"),i.sideDiv.animate({width:v},"slow",null,function(){i.vdgvInvoice.resize();i.vdgvReceipt.resize()})):(i.btnToggel.animate({borderSpacing:180},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),p=!0,i.btnSpaceDiv.animate({width:w},"slow"),i.sideDiv.animate({width:w},"slow"),i.div.css("display","none"),i.invoiceTopDiv.animate({width:ut},"slow"),i.gridSelectDiv.animate({width:ut},"slow",null,function(){i.vdgvInvoice.resize();i.vdgvReceipt.resize()}))});if(this.chkSameBPartner.change(function(){i.$busyDiv[0].style.visibility="visible";c()}),this.chkSameQty.change(function(){i.$busyDiv[0].style.visibility="visible";c()}),this.chkSameProduct.change(function(){i.$busyDiv[0].style.visibility="visible";c()}),d!=null)d.on(n.Events.onTouchStartOrClick,function(){i.onlyVendor.isReadOnly||i.onlyVendor.setValue(null,!1,!0)});if(g!=null)g.on(n.Events.onTouchStartOrClick,function(){i.onlyProduct.isReadOnly||i.onlyProduct.setValue(null,!1,!0)});i.$busyDiv[0].style.visibility="hidden"};this.display=function(){wt()};this.getRoot=function(){return this.$root};this.refreshUI=function(){this.vdgvInvoice.refresh();this.vdgvReceipt.refresh()};this.callConsolidate=function(){t.ajax({url:n.Application.contextUrl+"Common/Consolidate",dataType:"json",async:!0,success:function(){}});i.vdgvReceipt.multiSelect=!0;var r="vdgvReceipt"+i.windowNo;w2ui[r].multiSelect=!0};this.disposeComponent=function(){this.btnSearch&&this.btnSearch.off(n.Events.onTouchStartOrClick);this.btnProcess&&this.btnProcess.off(n.Events.onTouchStartOrClick);this.btnToggel&&this.btnToggel.off(n.Events.onTouchStartOrClick);this.frame=null;this.windowNo=null;this.arrListColumns=null;this.vdgvInvoice=null;this.vdgvReceipt=null;this.lblMatchFrom=null;this.lblMatchTo=null;this.lblMatchMode=null;this.lblBPartner=null;this.lblProduct=null;this.lblDateFrom=null;this.lblDateTo=null;this.lblInvoice=null;this.lblReceipt=null;this.lblMatched=null;this.lblMatchedTo=null;this.lblDifference=null;this.lblStatusInfo=null;this.lblStatusCount=null;this.lblSearch=null;this.cmbMatchFrom=null;this.cmbMatchTo=null;this.cmbMatchMode=null;this.chkIsReturnTrx=null;this.chkSameBPartner=null;this.chkSameProduct=null;this.chkSameQty=null;this.onlyVendor=null;this.onlyProduct=null;this.dtpFrom=null;this.dtpTo=null;this.btnSearch=null;this.btnProcess=null;this.btnToggel=null;this.txtMatched=null;this.txtMatchedTo=null;this.txtDifference=null;this.$root=null;this.$busyDiv=null;this.sideDiv=null;this.gridSelectDiv=null;this.gridInvoiceDiv=null;this.gridReciptDiv=null;this.processlDiv=null;this.bottumDiv=null;this.btnSpaceDiv=null;p=null;v=null;w=null;rt=null;ut=null;ui=null;fi=null;ei=null;oi=null;o=null;f=null;u=null;b=null;pt=null;si=null;s=null;y=null;hi=null;l=null;k=null;i=null;r=null;h=null;this.disposeComponent=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(t,i){this.frame=i;this.windowNo=t;n.Env.getCtx().setContext(this.windowNo,"IsSOTrx","Y");try{var r=this.Initialize()}catch(u){}this.frame.getContentGrid().append(this.getRoot());this.display();this.callConsolidate()};i.prototype.refresh=function(){this.refreshUI()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VMatch=i}(VIS,jQuery),function(n,t){function i(){function dt(){var g,w,s,d;setBusy(!0);v.setValue(!0);g=n.Application.contextUrl+"Areas/VIS/Images/base/arrow-left.png";u=t("<div id='sideDiv_"+i.windowNo+"' class='vis-archive-left-sidebar vis-leftsidebarouterwrap'>");ht=t("<div id='btnSpaceDiv_"+i.windowNo+"' class='vis-archive-l-s-head'><button id='btnSpace_"+i.windowNo+"' class='vis-archive-sb-t-button'><i class='vis vis-arrow-left'><\/i><\/button><\/div><\/div>");p=t("<div class='vis-archive-l-s-content' id='parameterDiv_"+i.windowNo+"'>");u.append(ht).append(p);g=n.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png";e=t("<button id='btnRefresh_"+i.windowNo+"' style='margin-left: 12px;' class='VIS_Pref_btn-2 vis-frm-button vis-pull-left'><i class='vis vis-refresh'><\/i><\/button>");y=t("<input id='btnCreateCharge_"+i.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' type='button' value='"+n.Msg.getMsg("CreateNew",!1,!1)+"'>");a=t("<input id='btnCancel_"+i.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' type='button' value='"+n.Msg.getMsg("Cancel",!1,!1)+"'>");l=t("<input id='btnAccount_"+i.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' type='button' value='"+n.Msg.getMsg("ChargeFromAccount",!1,!1)+"'>");var b=t("<table style='width: 100%;'>"),r=t("<tr>"),o=t("<td style='padding: 0px 10px 0px;'>");p.append(b);r=t("<tr>");o=t("<td style='padding: 0px 10px 0px;'>");w=t('<div class="input-group vis-input-wrap">');s=t('<div class="vis-control-wrap">');b.append(r);r.append(o);o.append(w);w.append(s);s.append(h.getControl().attr("data-placeholder","").attr("placeholder"," "));s.append(tt.getControl().addClass("VIS_Pref_Label_Font"));r=t("<tr>");o=t("<td style='padding: 0px 10px 0px;'>");w=t('<div class="input-group vis-input-wrap">');s=t('<div class="vis-control-wrap">');b.append(r);r.append(o);o.append(w);w.append(s);s.append(c.getControl().attr("data-placeholder","").attr("placeholder"," "));s.append(it.getControl().addClass("VIS_Pref_Label_Font"));r=t("<tr>");o=t("<td style='padding: 0px 10px 0px;'>");b.append(r);r.append(o);o.append(v.getControl());ut=t("<div class='vis-frm-bot-btn-wrp'>");d=t("<div class='vis-frm-bttsec'>");d.append(l).append(a);ut.append(y).append(e);f=t("<div id='rightSideGridDiv_"+i.windowNo+"' class='vis-frm-grid-wrap'>");rt=t("<div id='gridDiv_"+i.windowNo+"' class='vis-frm-grid-inn'>");f.append(rt);f.append(d);u.append(ut);k.append(st);k.append(u).append(f)}function gt(u){r!=null&&(r.destroy(),r=null);s.length==0&&(s.push({field:"C_ElementValue_ID",caption:n.Msg.getMsg("C_ELEMENTVALUE_ID"),sortable:!0,size:"16%",min:150,hidden:!0}),s.push({field:"Value",caption:n.Msg.getMsg("SearchKey"),sortable:!0,size:"25%",min:150,hidden:!1}),s.push({field:"Name",caption:n.Msg.getMsg("Name"),sortable:!0,size:"25%",min:150,hidden:!1}),s.push({field:"Expense",caption:n.Msg.getMsg("Expense"),sortable:!0,size:"25%",min:150,hidden:!1,editable:{type:"checkbox"}}));w2utils.encodeTags(u);r=t(rt).w2grid({name:"gridAccountElement"+i.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:s,records:u})}function at(){var r=[];nt=n.Env.getCtx().getContextAsInt("$C_AcctSchema_ID");ct=n.Env.getCtx().getAD_Client_ID();lt=n.Env.getCtx().getAD_Org_ID();t.ajax({url:n.Application.contextUrl+"VCharge/VChargeLodGrideData",dataType:"json",data:{mcAcctSchemaID:nt,mADClientId:ct},success:function(n){var e,u,f,t,i;if(n.result.meID!=0){if(n.result&&n.result.VchargeMCElemTaxCatID){if(e=n.result.VchargeMCElemTaxCatID,et=n.result.VchargeMCElemTaxCatID[0].mCElementID,et==0)return;ot=n.result.VchargeMCElemTaxCatID[0].mCTaxCategoryID}if(n.result&&n.result.VchargeCElementValue){for(u=n.result.VchargeCElementValue,f=1,t=0;t<u.length;t++)i={},i.C_ElementValue_ID=u[t].C_ElementValue_ID,i.Value=u[t].Value,i.Name=u[t].Name,i.Expense=u[t].Expense=="false"?!1:!0,i.recid=f,f++,r.push(i);gt(r);setBusy(!1)}}},error:function(n){setBusy(!1);i.log.info(n)}})}function ni(i,r,u,f,e){t.ajax({url:n.Application.contextUrl+"VCharge/CreateCharge",dataType:"json",data:{m_C_AcctSchema_ID:i,m_C_TaxCategory_ID:r,name:u,C_ElementValue_ID:f,expense:e},success:function(t){if(t.ID==0){n.ADialog.info("ChargeNotCreated",!0,null);setBusy(!1);return}h.ctrl.val("");c.ctrl.val("");var i=t.ID;n.ADialog.info("ChargeCreated",!0,null);at()}})}function ti(i,r,u,f,e){t.ajax({url:n.Application.contextUrl+"VCharge/CreateChargeByList",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({AcctSchemaID:i,TaxCategoryID:r,namepara:u,ElementValuID:f,expense:e}),success:function(t){t.listCreatedP&&n.ADialog.info("ChargeCreated",!0,null);t.listRejectedP&&n.ADialog.info("ChargeNotCreated",!0,null);setBusy(!1)}})}this.frame;this.windowNo;var i=this,s=[],r=null;this.log=n.Logging.VLogger.getVLogger("VCharge");var vt=!1,yt=!1,b=!1,tt=new n.Controls.VLabel(n.Msg.getMsg("SearchKey",!1,!1),"SearchKey",!1,!0),it=new n.Controls.VLabel(n.Msg.getMsg("Name",!1,!1),"Name",!1,!0),h=new n.Controls.VTextBox("SearchKey",!0,!1,!0,50,100,null,null,!1),c=new n.Controls.VTextBox("Name",!1,!1,!0,50,100,null,null,!1),v=new n.Controls.VCheckBox("Expense",!1,!1,!0,n.Msg.getMsg("Expense",!1,!1),null),pt=new n.Controls.VCheckBox("SelectAll",!1,!1,!0,n.Msg.getMsg("SelectAll",!1,!1),null),y=null,l=null,wt=new n.Controls.VLabel;this.log=n.Logging.VLogger.getVLogger("VCharge");var k=t("<div style='width: 100%; height: 100%; background-color: white; '>"),st=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>'),u=null,f=null,ht=null,p=null,rt=null,ut=null,a=null,e=null,o=null,w=260,d=50,g=t(window).width()-(w+20+5),ft=t(window).width()-(20+d),bt=g+w+5,kt=t(window).height()-210,et=0,nt=0,ot=0,ct=0,lt=0;setBusy=function(n){st.css("display",n?"block":"none")};this.Initialize=function(){if(dt(),o=k.find("#btnSpace_"+i.windowNo),a!=null)a.on(n.Events.onTouchStartOrClick,function(){i.dispose()});if(e!=null)e.on(n.Events.onTouchStartOrClick,function(){h.ctrl.val("");c.ctrl.val("");setBusy(!0);at()});if(o!=null)o.on(n.Events.onTouchStartOrClick,function(){var i=0;b?(i=n.Application.isRTL?180:0,y.show(),e.show(),tt.getControl().show(),it.getControl().show(),h.getControl().show(),c.getControl().show(),v.getControl().show(),o.animate({borderSpacing:i},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),b=!1,f.animate({width:g},"slow"),p.css("display","block"),u.animate({width:w},"slow",null,function(){r.resize()})):(i=n.Application.isRTL?0:180,y.hide(),e.hide(),tt.getControl().hide(),it.getControl().hide(),h.getControl().hide(),c.getControl().hide(),v.getControl().hide(),o.animate({borderSpacing:i},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),b=!0,u.animate({width:d},"slow"),p.css("display","none"),f.animate({width:ft},"slow",null,function(){r.resize()}))});if(this.sizeChanged=function(n,t){g=t-(w+1);ft=t-(d+1);b==!0?(u.animate({width:d},"slow"),f.animate({width:ft},"slow",null,function(){r.resize()})):(f.animate({width:g},"slow"),u.animate({width:w},"slow",null,function(){r.resize()}))},l!=null)l.on(n.Events.onTouchStartOrClick,function(){var i,t,n;setBusy(!0);var u=[],f=[],e=[];if(r){if(i=r.getSelection(),!i){setBusy(!1);return}if(i.length<=0){setBusy(!1);return}for(t=i.toString().split(","),n=0;n<t.length;n++)u[n]=r.get(t[n]).C_ElementValue_ID,f[n]=r.get(t[n]).Name,e[n]=r.get(t[n]).Expense;if(u.length==0)return setBusy(!1),"";ti(nt,ot,f,u,e)}});if(y!=null)y.on(n.Events.onTouchStartOrClick,function(){var u,f,r;if(setBusy(!0),u=v.getValue(),f=h.getValue().trim(),f.length==0){n.ADialog.warn("SearchKeyMandatory",!0,null);setBusy(!1);return}if(r=c.getValue().trim(),r.length==0){n.ADialog.warn("NameMandatory",!0,null);setBusy(!1);return}t.ajax({url:n.Application.contextUrl+"VCharge/CreateElementValue",dataType:"json",data:{m_AD_Org_ID:lt,value:f,name:r,expense:u,m_C_Element_ID:et},success:function(t){if(t.ID==0){i.log.saveError("ChargeNotCreated",t.Msg);n.ADialog.warn(t.Msg,!0,null);setBusy(!1);return}ni(nt,ot,r,t.ID,u)}})})};this.display=function(){setTimeout(at(),5)};this.getRoot=function(){return k};this.refreshUI=function(){r&&r.resize()};this.disposeComponent=function(){a&&a.off(n.Events.onTouchStartOrClick);e&&e.off(n.Events.onTouchStartOrClick);o&&o.off(n.Events.onTouchStartOrClick);l&&l.off(n.Events.onTouchStartOrClick);i.windowNo=null;s=null;r=null;vt=null;yt=null;b=null;tt=null;it=null;h=null;c=null;v=null;pt=null;btnCreateCharg=null;l=null;wt=null;i.log=null;k=null;st=null;u=null;f=null;ht=null;p=null;rt=null;ut=null;a=null;e=null;o=null;w=null;d=null;g=null;ft=null;bt=null;kt=null;et=null;nt=null;ot=null;ct=null;lt=null;i=null;this.getRoot=null;this.disposeComponent=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.Initialize();this.frame.getContentGrid().append(this.getRoot());this.display()};i.prototype.refresh=function(){this.refreshUI()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VCharge=i}(VIS,jQuery),function(n,t){function i(){function ti(){var k,y,o,u,p;setBusy(!0);k=n.Application.contextUrl+"Areas/VIS/Images/base/arrow-left.png";s=t("<div id='sideDiv_"+i.windowNo+"' class='vis-archive-left-sidebar'>");v=t("<div id='btnSpaceDiv_"+i.windowNo+"'  class='vis-archive-l-s-head'><button id='btnSpace_"+i.windowNo+"' class='vis-archive-sb-t-button'><i class='vis vis-arrow-left'><\/i><\/button><\/div><\/div>");l=t("<div class='vis-archive-l-s-content vis-leftsidebarouterwrap' id='parameterDiv_"+i.windowNo+"'>");s.append(v).append(l);k=n.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png";f=t("<button id='btnRefresh_"+i.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button'><i class='vis vis-refresh'><\/i><\/button>");c=t("<input id='btnOk_"+i.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' style='min-width: 70px;' type='button' value='"+n.Msg.getMsg("OK",!1,!1)+"'>");y=t("<table style='width: 100%;'>");l.append(y);tr=t("<tr>");td=t("<td style='padding: 10px 10px 0px'>");o=t('<div class="input-group vis-input-wrap">');u=t('<div class="vis-control-wrap">');y.append(tr);tr.append(td);td.append(o);o.append(u);u.append(b.getControl().css("display","inline-block"));u.append(r.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px;'>");o=t('<div class="input-group vis-input-wrap">');u=t('<div class="vis-control-wrap">');y.append(tr);tr.append(td);td.append(o);o.append(u);u.append(it.getControl().css("display","inline-block"));u.append(w.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px'>");o=t('<div class="input-group vis-input-wrap">');u=t('<div class="vis-control-wrap">');y.append(tr);tr.append(td);td.append(o);o.append(u);u.append(rt.getControl().css("display","inline-block"));u.append(kt.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));tr=t("<tr>");td=t("<td style='padding: 0px 10px 0px'>");o=t('<div class="input-group vis-input-wrap">');u=t('<div class="vis-control-wrap">');y.append(tr);tr.append(td);td.append(o);o.append(u);u.append(ut.getControl().css("display","inline-block"));u.append(dt.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"));g=t("<div class='vis-frm-bot-btn-wrp'>");p=t("<div class='vis-frm-bot-btn-wrp'>");p.append(c);g.append(f);h=t("<div id='rightSideGridDiv_"+i.windowNo+"' class='vis-frm-grid-wrap'>");d=t("<div id='gridDiv_"+i.windowNo+"' class='vis-frm-grid-inn'>");d.append(e);h.append(d);h.append(p);s.append(g);a.append(ft);a.append(s).append(h)}function ii(){st.push({Key:"0",Name:n.Msg.getMsg("ModeView",!1,!1)});ui();ri()}function ri(){t.ajax({url:n.Application.contextUrl+"Common/GetDataQueryAttribute",type:"GET",dataType:"json",async:!1,success:function(n){if(n.lst){u=n.lst;for(var t=0;t<u.length;t++)at(b.getControl(),u[t].GetKeyNamePair,t),at(it.getControl(),u[t].GetKeyNamePair,t)}n.priceList&&ot(rt.getControl(),n.priceList);n.whList&&ot(ut.getControl(),n.whList);setBusy(!1)}})}function ui(){ot(k.getControl(),st)}function ot(n,t){for(var i=0;i<t.length;i++)n.append(" <option selected value='"+t[i].Key+"' >"+t[i].Name+"<\/option>");n.prop("selectedIndex",0)}function at(n,t,i){i==0&&n.append(" <option selected value='0' ><\/option>");n.append(" <option selected value='"+t.Key+"' >"+t.Name+"<\/option>");n.prop("selectedIndex",0)}function fi(i,r){var s,h,o,f,u;for(r=r<2?2:r,i+=1,row=0;row<i;row++)for(s=t("<tr id='row_"+row+"' >"),e.append(s),col=0;col<r;col++)h=t("<td id='col_"+col+"'  style='padding: 4px 15px 2px;'>"),s.append(h);o=new n.Controls.VLabel;o.getControl().text("Mode");f=e.find("#row_0");r==2?(u=f.find("#col_"+(r-1)),u.append(k.getControl().css("display","inline-block").css("width","236px").css("height","30px")),u=f.find("#col_"+(r-2)),u.append(o.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))):(u=f.find("#col_2"),u.append(k.getControl().css("display","inline-block").css("width","236px").css("height","30px")),u=f.find("#col_1"),u.append(o.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")))}function ei(r,u){var f=0,e=0,o=0,s=0;r&&(f=r.GetM_Attribute_ID,e=r.GetM_AttributeValue_ID);u&&(o=u.GetM_Attribute_ID,s=u.GetM_AttributeValue_ID);t.ajax({url:n.Application.contextUrl+"Common/GetGridElement",dataType:"json",data:{xM_Attribute_ID:f,xM_AttributeValue_ID:e,yM_Attribute_ID:o,yM_AttributeValue_ID:s,M_PriceList_Version_ID:ht,M_Warehouse_ID:ct,windowNo:i.windowNo},async:!1,success:function(){setBusy(!1)}})}function oi(){var h,c,a,t,f,p,w;if(b!=null&&!tt){if(h=b.getControl()[0].selectedIndex,c=it.getControl()[0].selectedIndex,h==c){i.log.warning("Same Attribute Selected");return}tt=!0;ht=rt.getControl().find("option:selected").val();ct=ut.getControl().find("option:selected").val();var v=2,o=[],s=[],l=null,y=null;for(h>0&&(o=u[h-1].GetMAttributeValues),o!=null&&(v=o.length+1,i.log.info("X - "+u[h-1].GetName+" #"+o.length)),a=2,c>0&&(s=u[c-1].GetMAttributeValues),s.length>0&&(a=s.length+1,i.log.info("Y - "+u[c-1].GetName+" #"+s.length)),i.log.info("Rows="+a+" - Cols="+v),fi(a,v),t=null,f=null,row=0;row<a;row++)for(col=0;col<v;col++)o!=null&&(l=o[col]),s!=null&&(y=s[row]),row==0&&col==0?(p=new n.Controls.VLabel,w=new n.Controls.VLabel,o!=null&&(p.getControl().text(u[h-1].GetName),t=e.find("#row_1"),f=t.find("#col_"+col),f.append(p.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))),s.length>0&&(w.getControl().text(u[c-1].GetName),t=e.find("#row_1"),f=t.find("#col_"+col),f.append(w.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))),l!=null&&(r=new n.Controls.VLabel,r.getControl().text(l.Name),t=e.find("#row_1"),f=t.find("#col_"+(col+1)),f.append(r.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font")))):row==0?l!=null&&(r=new n.Controls.VLabel,r.getControl().text(l.Name),t=e.find("#row_1"),f=t.find("#col_"+(col+1)),f.append(r.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))):col==0?y!=null&&(r=new n.Controls.VLabel,r.getControl().text(y.Name),t=e.find("#row_"+row+1),f=t.find("#col_"+col),f.append(r.getControl().css("display","inline-block").addClass("VIS_Pref_Label_Font"))):ei(l,y,col,row+1);tt=!1}}function si(){var n=k.getControl().find("option:selected").val();n!=wt&&n!=bt&&n==pt}this.frame;this.windowNo;var i=this,vt=!1,yt=!1,p=!1,tt=!1,st=[],pt=0,wt=0,bt=0,ht=0,ct=0,u=[],r=new n.Controls.VLabel(n.Msg.getElement(n.Env.getCtx(),"M_Attribute_ID"),"M_Attribute_ID",!1,!0),w=new n.Controls.VLabel(n.Msg.getElement(n.Env.getCtx(),"M_Attribute_ID"),"M_Attribute_ID",!1,!0),kt=new n.Controls.VLabel(n.Msg.getElement(n.Env.getCtx(),"M_PriceList_ID"),"M_PriceList_ID",!1,!0),dt=new n.Controls.VLabel(n.Msg.getElement(n.Env.getCtx(),"M_Warehouse_ID"),"M_Warehouse_ID",!1,!0),hi=new n.Controls.VLabel(n.Msg.getMsg("Mode",!1,!1),"Mode",!1,!0),b=new n.Controls.VComboBox("",!1,!1,!0),it=new n.Controls.VComboBox("",!1,!1,!0),rt=new n.Controls.VComboBox("",!1,!1,!0),ut=new n.Controls.VComboBox("",!1,!1,!0),k=new n.Controls.VComboBox("",!1,!1,!0);this.log=n.Logging.VLogger.getVLogger("VAttributeGrid");var a=t("<div class='vis-forms-container' style='width: 100%; height: 100%; background-color: white; '>"),ft=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>'),s=null,h=null,v=null,l=null,d=null,g=null,c=null,f=null,o=null,y=260,nt=50,et=t(window).width()-y,lt=t(window).width()-nt,gt=et+y+5,ni=t(window).height()-210,e=t("<table style='width: 100%;'>");setBusy=function(n){ft.css("display",n?"block":"none")};this.Initialize=function(){if(ti(),o=a.find("#btnSpace_"+i.windowNo),c!=null)c.on(n.Events.onTouchStartOrClick,function(){si();i.dispose()});if(f!=null)f.on(n.Events.onTouchStartOrClick,function(){setBusy(!0);e.empty();oi();setBusy(!1)});if(o!=null)var u=0;o.on(n.Events.onTouchStartOrClick,function(){p?(f.show(),r.getControl().show(),w.getControl().show(),u=n.Application.isRTL?180:0,o.animate({borderSpacing:u},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),p=!1,h.animate({width:et},"slow"),l.css("display","block"),v.animate({width:y},"slow"),s.animate({width:y},"slow")):(u=n.Application.isRTL?0:180,f.hide(),r.getControl().hide(),w.getControl().hide(),o.animate({borderSpacing:u},{step:function(n){t(this).css("-webkit-transform","rotate("+n+"deg)");t(this).css("-moz-transform","rotate("+n+"deg)");t(this).css("transform","rotate("+n+"deg)")},duration:"slow"},"linear"),p=!0,h.animate({width:lt},"slow"),s.animate({width:nt},"slow"),v.animate({width:nt},"slow"),l.css("display","none"))})};this.display=function(){setTimeout(ii(),5)};this.getRoot=function(){return a};this.disposeComponent=function(){c&&c.off(n.Events.onTouchStartOrClick);f&&f.off(n.Events.onTouchStartOrClick);o&&o.off(n.Events.onTouchStartOrClick);i.windowNo=null;vt=null;yt=null;p=null;r=null;w=null;i.log=null;a=null;ft=null;s=null;h=null;v=null;l=null;d=null;g=null;c=null;f=null;o=null;y=null;nt=null;et=null;lt=null;gt=null;ni=null;i=null;this.getRoot=null;this.disposeComponent=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.Initialize();this.frame.getContentGrid().append(this.getRoot());this.display()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VAttributeGrid=i}(VIS,jQuery);VIS=window.VIS||{},function(n,t){function r(){function dt(){w=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');w[0].style.visibility="hidden";b.append(w)}function o(n){w[0].style.visibility=n?"visible":"hidden"}function gt(){var f=t(window).height()*(94/100),i,u;k=t("<div class='vis-mainContainer'>");i=" <div class='vis-pSelectInfo vis-leftsidebarouterwrap'><div class='vis-pSelectInner'> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <select id='VIS_cmbBankAccount_"+r.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"C_BankAccount_ID")+" <\/label><\/div><\/div> <\/div> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtCurrentBal_"+r.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.getMsg("CurrentBalance")+' <\/label><\/div><\/div>  <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbbusinessPartner_'+r.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"C_BPartner_ID")+' <\/label><\/div><\/div>  <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <input  id=\'VIS_cmbPayDate_'+r.windowNo+"'type='date' data-placeholder='' placeholder=' '> <label>"+n.Msg.translate(n.Env.getCtx(),"PayDate")+' <\/label><\/div><\/div>  <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbPaymentMethod_'+r.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"PaymentRule")+" <\/label><\/div><\/div>  <\/div> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='number' id='VIS_txtPaymentAmount_"+r.windowNo+"' disabled MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.getMsg("PaymentAmount")+" <\/label><\/div><\/div>  <\/div> <div class='vis-paymentselect-field'> <input type='checkbox' id='VIS_chkOnlyDue_"+r.windowNo+"' data-placeholder='' placeholder=' '> <label for='VIS_chkOnlyDue_"+r.windowNo+"'>"+n.Msg.getMsg("OnlyDue")+" <\/label>  <\/div> <div class='vis-paymentselect-field'> <label for='VIS_lblShowDetail_"+r.windowNo+"'><\/label> <\/div> <\/div> <div class='vis-paymentselect-field'> <button class='VIS_Pref_btn-2' disabled id='VIS_btnRefresh_"+r.windowNo+"' style='margin-top: 0px;'><i class='vis vis-refresh'><\/i><\/button> <\/div> <\/div>";d=t("<div class='vis-pSelectIionGrid'>");u=" <div class='vis-pSelectProcess'> <div class='vis-paymentselect-field'> <input id='VIS_btnCancel_"+r.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("Cancel")+"' ><\/input> <input id='VIS_btnOK_"+r.windowNo+"' disabled class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("OK")+"' ><\/input> <\/div> <\/div>";k.append(t(i)).append(d).append(t(u));b.append(k);ni()}function ni(){f=t("#VIS_cmbBankAccount_"+r.windowNo);s=t("#VIS_cmbbusinessPartner_"+r.windowNo);h=t("#VIS_cmbPaymentMethod_"+r.windowNo);tt=t("#VIS_txtCurrentBal_"+r.windowNo);y=t("#VIS_chkOnlyDue_"+r.windowNo);a=t("#VIS_txtPaymentAmount_"+r.windowNo);ut=t("#VIS_lblShowDetail_"+r.windowNo);p=t("#VIS_btnRefresh_"+r.windowNo);v=t("#VIS_cmbPayDate_"+r.windowNo);g=t("#VIS_btnOK_"+r.windowNo);it=t("#VIS_btnCancel_"+r.windowNo);var n=new Date,i=("0"+n.getDate()).slice(-2),u=("0"+(n.getMonth()+1)).slice(-2),e=n.getFullYear()+"-"+u+"-"+i;v.val(e);ft();ti();ri();l.BankAccount.length>0&&et()}function ti(){p.on("click",function(){o(!0);ei()&&window.setTimeout(function(){ii();o(!1)},20)});g.on("click",function(){var t,i;if(e.getSelection().length<=0)return n.ADialog.info("PleaseSelectRecord"),!1;if(t=e.getSelection(),t.length>0){for(i=0;i<t.length;i++)rt[t[i]].SELECT=!0;o(!0);window.setTimeout(function(){oi()},20)}});it.on("click",function(){r.dispose()});f.on("change",function(){o(!0);window.setTimeout(function(){fi();et();o(!1)},20)});y.on("click",function(){p.trigger("click")})}function ft(){try{e!=null&&(e.destroy(),e=null)}catch(t){}u.length==0&&(u.push({field:"SELECT",caption:n.Msg.getMsg("SELECT"),sortable:!0,size:"100px",hidden:!0}),u.push({field:"C_INVOICE_ID",caption:n.Msg.getMsg("Invoice"),sortable:!0,size:"100px"}),u.push({field:"DUEDATE",caption:n.Msg.getMsg("DueDate"),sortable:!0,size:"100px",render:function(n){var t;return t=n.changes==undefined||n.changes.DUEDATE==undefined?n.DUEDATE:n.changes.DUEDATE,new Date(t).toLocaleDateString()}}),u.push({field:"BUSINESSPARTNER",caption:n.Msg.getMsg("BusinessPartner"),sortable:!0,size:"100px"}),u.push({field:"DOCUMENTNO",caption:n.Msg.getMsg("Document_No"),sortable:!0,size:"100px"}),u.push({field:"CURRENCY",caption:n.Msg.getMsg("Currency"),sortable:!0,size:"100px"}),u.push({field:"GRANDTOTAL",caption:n.Msg.getMsg("GrandTotal"),sortable:!0,size:"100px",render:function(n){var t=n.GRANDTOTAL;return parseFloat(t).toLocaleString()}}),u.push({field:"DISCOUNTAMOUNT",caption:n.Msg.getMsg("DiscountAmt"),sortable:!0,size:"100px",render:function(n){var t=n.DISCOUNTAMOUNT;return parseFloat(t).toLocaleString()}}),u.push({field:"DISCOUNTDATE",caption:n.Msg.getMsg("DiscountDate"),sortable:!0,size:"100px",render:function(n){var t;return t=n.changes==undefined||n.changes.DISCOUNTDATE==undefined?n.DISCOUNTDATE:n.changes.DISCOUNTDATE,new Date(t).toLocaleDateString()}}),u.push({field:"AMOUNTDUE",caption:n.Msg.getMsg("AmountDue"),sortable:!0,size:"100px",render:function(n){var t=n.AMOUNTDUE;return parseFloat(t).toLocaleString()}}),u.push({field:"PAYMENTAMOUNT",caption:n.Msg.getMsg("PaymentAmount"),sortable:!0,size:"100px",render:function(n){var t=n.PAYMENTAMOUNT;return parseFloat(t).toLocaleString()}}));e=d.w2grid({name:"gridPaymentSelection_"+r.windowNo,recordHeight:40,show:{selectColumn:!0},multiSelect:!0,columns:u,records:c});e.on("select",function(t){nt+=n.Utility.Util.getValueOfDecimal(c[t.index].PAYMENTAMOUNT);a.val(nt);var i=e.getSelection();g.removeAttr("disabled")});e.on("unselect",function(t){nt-=n.Utility.Util.getValueOfDecimal(c[t.index].PAYMENTAMOUNT);a.val(nt);var i=e.getSelection()})}function ii(){var u,r,e;c=[];u=0;r=[];r.push(f.val());l!=null?(e=jQuery.grep(l.BankAccount,function(t){return t.ID==n.Utility.Util.getValueOfInt(f.val())}),e.length>0?r.push(e[0].Currency_ID):r.push(0)):r.push(0);r.push(s.val());r.push(v.val());r.push(h.val());r.push(a.val());r.push(y.prop("checked"));t.ajax({url:n.Application.contextUrl+"VPaySelect/GetGridRecords",async:!1,datatype:"Json",type:"POST",cache:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify(r),success:function(n){var t=JSON.parse(n),r;if(c=[],t!=null||t!=undefined)for(rt=t,i=0;i<t.length;i++)r={},r.SELECT=t[i].SELECT,r.C_INVOICE_ID=t[i].C_INVOICE_ID,r.DUEDATE=t[i].DUEDATE,r.BUSINESSPARTNER=t[i].BUSINESSPARTNER,r.DOCUMENTNO=t[i].DOCUMENTNO,r.CURRENCY=t[i].CURRENCY,r.GRANDTOTAL=t[i].GRANDTOTAL,r.DISCOUNTAMOUNT=t[i].DISCOUNTAMOUNT,r.DISCOUNTDATE=t[i].DISCOUNTDATE,r.AMOUNTDUE=t[i].AMOUNTDUE,r.PAYMENTAMOUNT=t[i].PAYMENTAMOUNT,r.recid=u,u++,c.push(r)},error:function(n){console.log(n)}});ft()}function ri(){t.ajax({url:n.Application.contextUrl+"VPaySelect/GetDetail",async:!1,datatype:"Json",type:"GET",cache:!1,success:function(n){var t=JSON.parse(n);l=t;(t!=null||t!=undefined)&&t.BankAccount.length>0&&(p.removeAttr("disabled"),ui(t));o(!1)},error:function(n){console.log(n);o(!1)}})}function ui(n){var i;if(n.BankAccount!=null||n.BankAccount.length>0){f.empty();for(i in n.BankAccount)f.append(t('<Option value="'+n.BankAccount[i].ID+'">'+n.BankAccount[i].Value+"<\/option>"))}if(n.BusinessPartner!=null||n.BusinessPartner.length>0){s.empty();s.append(t('<Option value="-1"><\/option>'));for(i in n.BusinessPartner)s.append(t('<Option value="'+n.BusinessPartner[i].ID+'">'+n.BusinessPartner[i].Value+"<\/option>"))}if(n.PaymentMethod!=null||n.PaymentMethod.length>0){h.empty();for(i in n.PaymentMethod)h.append(t('<Option value="'+n.PaymentMethod[i].ID+'">'+n.PaymentMethod[i].Value+"<\/option>"))}o(!1)}function fi(){t.ajax({url:n.Application.contextUrl+"VPaySelect/GetPaymentMethod",async:!1,datatype:"Json",type:"GET",cache:!1,data:{C_BankAccount_ID:parseInt(f.val())},success:function(n){var i=JSON.parse(n),r;if((i!=null||i!=undefined)&&(i!=null||i.length>0)){h.empty();for(r in i)h.append(t('<Option value="'+i[r].ID+'">'+i[r].Value+"<\/option>"))}},error:function(n){console.log(n)}})}function et(){var t=jQuery.grep(l.BankAccount,function(t){return t.ID==n.Utility.Util.getValueOfInt(f.val())});t.length>0&&tt.val(t[0].CurrentBalance+" "+t[0].ISOCode)}function ei(){return s!=null&&s.val()<=0?(n.ADialog.info("SelectBusinessPartnerFirst"),o(!1),!1):!0}function oi(){var i=[],u;i.push(f.val());l!=null?(u=jQuery.grep(l.BankAccount,function(t){return t.ID==n.Utility.Util.getValueOfInt(f.val())}),i.push(u[0].Currency_ID)):i.push(0);i.push(s.val());i.push(v.val());i.push(h.val());i.push(a.val());i.push(y.prop("checked"));i.push(JSON.stringify(rt));t.ajax({url:n.Application.contextUrl+"VPaySelect/GeneratePaymentSelection",async:!1,datatype:"Json",type:"POST",cache:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify(i),success:function(t){var f=JSON.parse(t),i,u;(f!=null||f!=undefined)&&(r.dispose(),i=new n.CFrame,u=new n.Apps.AForms.VPayPrint,i.setName(n.Msg.getMsg("Payment Print/Export")),i.setTitle(n.Msg.getMsg("Payment Print/Export")),i.hideHeader(!1),i.setContent(u),i.show(),u.initialize())},error:function(n){console.log(n)}})}this.windowNo;var b=t("<div style='width: 100%; height: 100%; background-color: white;'>"),r=this,k=null,ot=null,st=null,ht=null,ct=null,lt=null,at=null,vt=null,d=null,yt=null,pt=null,wt=null,bt=null,f=null,s=null,h=null,v=null,kt=null,y=null,tt=null,ut=null,a=null,u=[],e=null,p=null,g=null,it=null,c=[],rt=null,l=null,nt=0,w=null;this.initialize=function(){dt();o(!0);window.setTimeout(function(){gt()},20)};this.getRoot=function(){return b};this.disposeComponent=function(){windowNo=null;b=null;r=this;k=null;ot=null;st=null;ht=null;ct=null;lt=null;at=null;vt=null;d=null;yt=null;pt=null;wt=null;bt=null;f=null;s=null;h=null;v=null;kt=null;y=null;tt=null;ut=null;a=null;u=null;e=null;p=null;g=null;it=null;c=null}}n.Apps.AForms=n.Apps.AForms||{};r.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.frame.getContentGrid().append(this.getRoot());this.initialize()};r.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VPaySelect=r}(VIS,jQuery);VIS=window.VIS||{},function(n,t){function i(){function ut(){h=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');h[0].style.visibility="hidden";c.append(h)}function r(n){h[0].style.visibility=n?"visible":"hidden"}function ft(){a=t("<div class='vis-mainContainer vis-formouterwrpdiv'>");var r=" <div class='vis-pPrintInfo'> <div class='vis-paymentselect-field' style='margin-top: 8px;'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <div class='vis-paymentPrintChk-field'> <input type='checkbox' id='VIS_chkShowPrintPayment_"+i.windowNo+"' data-placeholder='' placeholder=' '> <label for='VIS_chkOnlyDue_"+i.windowNo+"'>"+n.Msg.getMsg("ShowPrintedPayments")+" <\/label> <\/div> <select id='VIS_PaySelection_"+i.windowNo+"'><\/select> <label style='top: 11px;'>"+n.Msg.translate(n.Env.getCtx(),"C_PaySelection_ID")+" <\/label><\/div><\/div> <\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' name='vis-name vis-fieldreadonly' class='vis-fieldreadonly' disabled id='VIS_txtBankAccount_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.translate(n.Env.getCtx(),"C_BankAccount_ID")+" <\/label> <\/div><\/div><\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtCurrentBal_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.getMsg("CurrentBalance")+" <\/label> <\/div><\/div><\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <select name='vis-name' id='VIS_cmbPaymentMethod_"+i.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"PaymentRule")+" <\/label> <\/div><\/div><\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtCurrency_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.translate(n.Env.getCtx(),"C_Currency_ID")+" <\/label> <\/div><\/div><\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='number' name='vis-name'  id='VIS_txtCheckNo_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.getMsg("CheckNo")+" <\/label> <\/div><\/div><\/div> <div class='vis-paymentPrint-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input type='text' class='vis-fieldreadonly' disabled id='VIS_txtNoOfPayments_"+i.windowNo+"' MaxLength='50' data-placeholder='' placeholder=' '> <label>"+n.Msg.getMsg("NoOfPayments")+" <\/label> <\/div><\/div><\/div> <\/div>",u=" <div class='vis-pPrintProcess'> <div class='vis-paymentPrint-field'> <input id='VIS_btnCancel_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("Cancel")+"' > <input id='VIS_btnPrint_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("Print")+"' ><\/input> <\/div> <\/div>";a.append(t(r)).append(t(u));c.append(a);ut();et()}function et(){u=t("#VIS_PaySelection_"+i.windowNo);p=t("#VIS_txtBankAccount_"+i.windowNo);w=t("#VIS_txtCurrentBal_"+i.windowNo);f=t("#VIS_cmbPaymentMethod_"+i.windowNo);b=t("#VIS_txtCurrency_"+i.windowNo);e=t("#VIS_txtCheckNo_"+i.windowNo);v=t("#VIS_txtNoOfPayments_"+i.windowNo);l=t("#VIS_chkShowPrintPayment_"+i.windowNo);l.attr("disabled",!0);k=t("#VIS_btnPrint_"+i.windowNo);d=t("#VIS_btnExport_"+i.windowNo);g=t("#VIS_btnCancel_"+i.windowNo);y(!0);st()}function y(i){var f=null;f=i?0:u.val();r(!0);t.ajax({url:n.Application.contextUrl+"VPayPrint/GetDetail",async:!1,datatype:"Json",type:"GET",cache:!1,data:{showPrintedPayment:l.prop("checked"),C_PaymentSelect_ID:f,isFirstTime:i},success:function(n){var t=JSON.parse(n);controlsData=t;(t!=null||t!=undefined)&&(ot(t),nt(),r(!1))},error:function(n){r(!1);console.log(n)}})}function nt(){t.ajax({url:n.Application.contextUrl+"VPayPrint/LoadPaymentRuleInfo",async:!1,datatype:"Json",type:"GET",cache:!1,data:{paymentMethod_ID:f.val(),C_PaySelection_ID:u.val(),m_C_BankAccount_ID:o,PaymentRule:f.text()},success:function(n){var t=JSON.parse(n);r(!1);(t!=null||t!=undefined)&&(e.val(t.CheckNo),v.val(t.NoOfPayments))},error:function(n){console.log(n)}})}function ot(i){var c,l,y,a,h;try{if(c=u.val(),l=0,i.PaymentSelection!=null||i.PaymentSelection.length>0){u.empty();for(h in i.PaymentSelection)u.append(t('<Option value="'+i.PaymentSelection[h].ID+'">'+i.PaymentSelection[h].Value+"<\/option>"))}if(c>0&&(u.val(c),y="VIS_135",a=[],a[0]=new n.DB.SqlParam("@pSelectID",c),l=n.Utility.Util.getValueOfInt(s(y,a))),i.PaymentMethod!=null||i.PaymentMethod.length>0){f.empty();for(h in i.PaymentMethod)f.append(t('<Option value="'+i.PaymentMethod[h].ID+'">'+i.PaymentMethod[h].Value+"<\/option>"))}l>0&&f.val(l);(i.PSelectInfo!=null||i.PSelectInfo.length>0)&&(p.val(i.PSelectInfo[0].BankAccount),e.val(i.PSelectInfo[0].CheckNo),w.val(parseFloat(i.PSelectInfo[0].CurrentBalance).toLocaleString()),b.val(i.PSelectInfo[0].Currency),v.val(i.PSelectInfo[0].NoOfPayments),o=i.PSelectInfo[0].BankAccount_ID)}catch(k){return n.ADialog.info("VPayPrintNoRecords"),r(!1),!1}if(u.val()==null)return n.ADialog.info("VPayPrintNoRecords"),!1}function st(){k.on("click",function(){tt()&&ht()});d.on("click",function(){tt()&&vt()});g.on("click",function(){i.dispose()});u.on("change",function(){r(!0);window.setTimeout(function(){y(!1);r(!1)},20)});f.on("change",function(){r(!0);window.setTimeout(function(){nt();r(!1)},20)});l.on("click",function(){r(!0);window.setTimeout(function(){y(!1);r(!1)},20)})}function tt(){try{if(u==null||u.val()<=-1||o<=-1||f.val()<=-1||e.val().length<=0)return n.ADialog.info("VPayPrintNoRecords"),!1}catch(t){return n.ADialog.info("VPayPrintNoRecords"),!1}return!0}function ht(){r(!0);t.ajax({url:n.Application.contextUrl+"VPayPrint/Cmd_Print",async:!1,datatype:"Json",type:"GET",cache:!1,data:{paymentMethod_ID:f.val(),C_PaySelection_ID:u.val(),m_C_BankAccount_ID:o,PaymentRule:f.text(),checkNo:e.val()},success:function(t){r(!1);var u=JSON.parse(t);if(u!=null||u!=undefined)n.ADialog.confirm("ContinueCheckPrint?",!0,"","Confirm",function(n){n?(r(!0),window.setTimeout(function(){ct(u)},20)):i.dispose()});else return n.ADialog.info("VPayPrintNoRecords"),!1},error:function(n){console.log(n)}})}function ct(h){var l=h.check_ID[0],c=[];c.push(f.val());c.push(u.val());c.push(o);c.push(f.text());c.push(e.val());c.push(JSON.stringify(h.check_ID));c.push(JSON.stringify(h.m_batch));c.push(JSON.stringify(h.m_checks));t.ajax({url:n.Application.contextUrl+"VPayPrint/ContinueCheckPrint",async:!1,datatype:"Json",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(c),success:function(t){var h="VIS_152",c=[],l,a,v,e,y,f;c[0]=new n.DB.SqlParam("@BankAcct_ID",o);l=s(h,c);h="VIS_150";a=s(h);v=new n.APrint(l,a,parseInt(u.val()),i.windowNo);v.startPdf(null);r(!1);e=JSON.parse(t);(e!=null||e!=undefined)&&(y=e.join(),f=lt(y),f=f!=null?n.Msg.getMsg("VIS_PaymentCreated")+f:f,n.ADialog.confirm("VPayPrintPrintRemittance?",!0,f,"Confirm",function(n){n?(r(!0),window.setTimeout(function(){at(t)},20)):i.dispose()}))},error:function(n){r(!1);console.log(n)}})}function lt(i){var r=null;return t.ajax({url:n.Application.contextUrl+"VPayPrint/GetDocumentNo",async:!1,datatype:"Json",type:"GET",contentType:"application/json; charset=utf-8",data:{paymentId:i},success:function(n){r=JSON.parse(n);r=r!=null?r.join():r},error:function(n){console.log(n)}}),r}function at(f){var e=JSON.parse(f);t.ajax({url:n.Application.contextUrl+"VPayPrint/VPayPrintRemittance",async:!1,datatype:"Json",type:"POST",contentType:"application/json; charset=utf-8",data:f,success:function(t){var l,f,o,h,c;r(!1);l=JSON.parse(t);e!=null||e!=undefined?(f="VIS_151",o=s(f),f="VIS_150",h=s(f),c=new n.APrint(o,h,parseInt(u.val()),i.windowNo),c.startPdf(null),i.dispose()):n.ADialog.info("PaymentNotProcessed")},error:function(n){console.log(n)}})}function vt(){r(!0);t.ajax({url:n.Application.contextUrl+"VPayPrint/Cmd_Export",async:!1,datatype:"Json",type:"POST",cache:!1,data:{paymentMethod_ID:f.val(),C_PaySelection_ID:u.val(),m_C_BankAccount_ID:o,PaymentRule:f.text(),checkNo:e.val()},success:function(t){r(!1);var i=JSON.parse(t);if(i!=null||i!=undefined)n.ADialog.confirm("VPayPrintSuccess?",!0,"","Confirm",function(t){if(t){r(!0);window.setTimeout(function(){yt(i)},20);var u=n.Application.contextUrl+"TempDownload/"+i.filepath;window.open(u,"_blank")}});else return n.ADialog.info("VPayPrintNoRecords"),!1},error:function(n){console.log(n)}})}function yt(i){var u=[];u.push(JSON.stringify(i.check_ID));u.push(JSON.stringify(i.m_batch));u.push(JSON.stringify(i.m_checks));t.ajax({url:n.Application.contextUrl+"VPayPrint/VPayPrintSuccess",async:!1,datatype:"Json",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(u),success:function(n){r(!1);var t=JSON.parse(n);t!=null||t!=undefined},error:function(n){console.log(n)}})}function pt(n,i,r){var u=null;return t.ajax({url:rt,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(n)}).done(function(n){u=n;r&&r(n)}),u}var s;this.windowNo=n.Env.getWindowNo();var c=t("<div style='width: 100%; height: 100%; background-color: white;'>"),i=this,a=null,u=null,p=null,w=null,f=null,b=null,e=null,v=null,l=null,k=null,d=null,g=null,o=null,h=null,it=n.Application.contextUrl,rt=it+"JsonData/JDataSetWithCode";this.initialize=function(){ft()};this.getRoot=function(){return c};s=function(t,i,r){var f=r?!0:!1,e={sql:t,page:1,pageSize:0},u=null;return i&&(e.param=i),pt(e,f,function(t){i=(new n.DB.DataSet).toJson(t);var i=(new n.DB.DataSet).toJson(t);u=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null;i.dispose();i=null;f&&r(u)}),u};this.lockUI=function(){};this.unlockUI=function(){};this.disposeComponent=function(){windowNo=null;c=null;i=this}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.frame.getContentGrid().append(this.getRoot());this.initialize()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VPayPrint=i}(VIS,jQuery);VIS=window.VIS||{},function(n,t){function i(){function ut(){l=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');l[0].style.visibility="hidden";v.append(l)}function h(n){l[0].style.visibility=n?"visible":"hidden"}function ft(){var e=t(window).height()*(92/100),u,f;y=t("<div class='vis-mainContainer'>");u=" <div class='vis-pSelectInfo vis-leftsidebarouterwrap'><div class='vis-pSelectInner'> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <select id='VIS_cmbProduct_"+i.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"M_Product_ID")+' <\/label><\/div><\/div> <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbinvoice_'+i.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"C_Invoice_ID")+' <\/label><\/div><\/div> <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbOrder_'+i.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"C_Order_ID")+' <\/label><\/div><\/div> <\/div> <div class=\'vis-paymentselect-field\'><div class="input-group vis-input-wrap"><div class="vis-control-wrap"> <select id=\'VIS_cmbOpportunity_'+i.windowNo+"'><\/select> <label>"+n.Msg.translate(n.Env.getCtx(),"C_Project_ID")+" <\/label><\/div><\/div> <\/div> <div class='vis-paymentselect-field'><div class=\"input-group vis-input-wrap\"><div class=\"vis-control-wrap\"> <input data-placeholder='' placeholder=' ' type='number' id='VIS_txtQuantity_"+i.windowNo+"' min='0' MaxLength='50'> <label>"+n.Msg.translate(n.Env.getCtx(),"Qty")+"<\/label><\/div><\/div> <\/div> <\/div> <div class='vis-paymentselect-field'> <button class='VIS_Pref_btn-2'  id='VIS_btnRefresh_"+i.windowNo+"' style='margin-top: 0px;'><i class='vis vis-refresh'><\/i><\/button> <\/div> <\/div>";r=t("<div class='vis-pSelectIionGrid'>");f=" <div class='vis-pSelectProcess'> <div class='vis-paymentselect-field'> <input id='VIS_btnCancel_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("Cancel")+"' ><\/input> <input id='VIS_btnOK_"+i.windowNo+"' disabled class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("OK")+"' ><\/input> <\/div> <\/div>";y.append(t(u)).append(r).append(t(f));v.append(y);et()}function et(){u=t("#VIS_cmbProduct_"+i.windowNo);f=t("#VIS_cmbinvoice_"+i.windowNo);e=t("#VIS_cmbOrder_"+i.windowNo);o=t("#VIS_cmbOpportunity_"+i.windowNo);a=t("#VIS_txtQuantity_"+i.windowNo);p=t("#VIS_btnCancel_"+i.windowNo);s=t("#VIS_btnOK_"+i.windowNo);w=t("#VIS_btnRefresh_"+i.windowNo);b();ot()}function ot(){w.on("click",function(){h(!0);r.empty();window.setTimeout(function(){b();h(!1)},20)});s.on("click",function(){lt()});p.on("click",function(){i.dispose()});u.on("change",function(){u.val()>0?s.removeAttr("disabled"):s.attr("disabled",!0);h(!0);window.setTimeout(function(){ht()},20)});f.on("change",function(){f.val()>0?(u.val()>0&&s.removeAttr("disabled"),e.attr("disabled",!0),o.attr("disabled",!0)):(s.attr("disabled",!0),e.removeAttr("disabled"),o.removeAttr("disabled"))});e.on("change",function(){e.val()>0?(u.val()>0&&s.removeAttr("disabled"),f.attr("disabled",!0),o.attr("disabled",!0)):(s.attr("disabled",!0),f.removeAttr("disabled"),o.removeAttr("disabled"))});o.on("change",function(){o.val()>0?(u.val()>0&&s.removeAttr("disabled"),e.attr("disabled",!0),f.attr("disabled",!0)):(s.attr("disabled",!0),e.removeAttr("disabled"),f.removeAttr("disabled"))});a.on("change",function(){for(var i,n=0;n<t(r[0]).children().length;n++)i=c[n].BOMQty,t(t(t(t(r[0]).children()[n]).children()[0]).children()[1]).attr("Value",i*a.val())})}function b(){t.ajax({url:n.Application.contextUrl+"VBOMDrop/GetDetail",async:!1,datatype:"Json",type:"GET",cache:!1,success:function(n){var t=JSON.parse(n);controlsData=t;(t!=null||t!=undefined)&&st(t);h(!1)},error:function(n){console.log(n);h(!1)}})}function st(n){var i;if(n.Product!=null||n.Product.length>0){u.empty();u.append(t('<Option value="-1"><\/option>'));for(i in n.Product)u.append(t('<Option value="'+n.Product[i].ID+'">'+n.Product[i].Value+"<\/option>"))}if(n.Invoice!=null||n.Invoice.length>0){f.empty();f.append(t('<Option value="-1"><\/option>'));for(i in n.Invoice)f.append(t('<Option value="'+n.Invoice[i].ID+'">'+n.Invoice[i].Value+"<\/option>"))}if(n.Order!=null||n.Order.length>0){e.empty();e.append(t('<Option value="-1"><\/option>'));for(i in n.Order)e.append(t('<Option value="'+n.Order[i].ID+'">'+n.Order[i].Value+"<\/option>"))}if(n.Opportunity!=null||n.Opportunity.length>0){o.empty();o.append(t('<Option value="-1"><\/option>'));for(i in n.Opportunity)o.append(t('<Option value="'+n.Opportunity[i].ID+'">'+n.Opportunity[i].Value+"<\/option>"))}h(!1)}function ht(){a.val("");t.ajax({url:n.Application.contextUrl+"VBOMDrop/GetBOMLines",async:!1,datatype:"Json",type:"GET",cache:!1,data:{productID:parseInt(u.val())},success:function(n){var t=JSON.parse(n);controlsData=t;t!=null||t!=undefined?ct(t):r.empty();h(!1)},error:function(n){console.log(n);h(!1)}})}function ct(n){var e="",i;r.empty();var u="",f="";for(c=n,i=0;i<n.length;i++){e="";n[i].BOMType=="P"?(u="<input type='checkbox' checked disabled id='VIS_chkBOMLine_"+i+"' style='height: 15px;width: auto;'><\/input>",f="<input type='number' id='VIS_qtyBOMLine_"+i+"' style='background: pink;width:200%;' min='0' value='"+n[i].BOMQty+"'><\/input>"):n[i].BOMType=="O"?(u="<input type='checkbox' id='VIS_chkBOMLine_"+i+"' style='height: 15px;width: auto;'><\/input>",f="<input type='number' disabled id='VIS_qtyBOMLine_"+i+"' style='background: #FFF5FF;width:200%;'  min='0' value='"+n[i].BOMQty+"'><\/input>"):(u=" <input type='radio' name='vis-radiolist' checked id='VIS_chkBOMLine_"+i+"' style='height: 15px;width: auto;'><\/input>",f="<input type='number' id='VIS_qtyBOMLine_"+i+"' style='background: pink;width:200%;' min='0' value='"+n[i].BOMQty+"'><\/input>");e+="<div class='vis-bomlinesdata'> <div style='float:left;width: 50%;'> <label style='margin: 5px;width:100%;'>"+n[i].ProductName+"<\/label>"+f+" <\/div> <div style='float:right;'>"+u+" <label style='margin-right:5px;'>"+n[i].BOMTypeName+"<\/label> <\/div> <\/div>";r.append(t(e));t("#VIS_chkBOMLine_"+i).on("click",function(){var n=t(t(t(t(this).parent()).parent().children()[0]).children()[1]);t(this).prop("checked")?(n.css("background","pink"),n.removeAttr("disabled")):(n.css("background","#FFF5FF"),n.attr("disabled",!0))})}}function lt(){var l=[],s,a;for(l.push(u.val()),l.push(f.val()),l.push(e.val()),l.push(o.val()),s=0;s<t(r[0]).children().length;s++)a=t(t(t(t(r[0]).children()[s]).children()[1]).children()[0]).prop("checked"),a?(c[s].IsSelected=!0,c[s].BOMQty=t(t(t(t(r[0]).children()[s]).children()[0]).children()[1]).val()):c[s].IsSelected=!1;l.push(JSON.stringify(c));t.ajax({url:n.Application.contextUrl+"VBOMDrop/SaveRecord",async:!1,datatype:"Json",type:"POST",cache:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify(l),success:function(t){JSON.parse(t)?i.dispose():n.ADialog.info("RecordNotSaved")},error:function(n){console.log(n);h(!1)}})}this.windowNo=null;var v=t("<div style='width: 100%; height: 100%; background-color: white;'>"),i=this,y=null,k=null,r=null,d=null,g=null,nt=null,tt=null,it=null,rt=null,u=null,f=null,e=null,o=null,a=null,s=null,p=null,l=null,c=[],w=null;this.initialize=function(){ut();h(!0);window.setTimeout(function(){ft()},20)};this.getRoot=function(){return v};this.disposeComponent=function(){v=null;i=null;y=null;k=null;r=null;d=null;g=null;nt=null;tt=null;it=null;rt=null;u=null;f=null;e=null;o=null;a=null;s=null;p=null;l=null;c=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.frame.getContentGrid().append(this.getRoot());this.initialize()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VBOMDrop=i}(VIS,jQuery);VIS=window.VIS||{},function(n,t){function i(){function at(){e=t('<div class="vis-busyindicatorouterwrap" style="visibility: hidden;"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');e[0].style.visibility="hidden";o.append(e)}function l(n){e[0].style.visibility=n?"visible":"hidden"}function vt(){var ti=t(window).height()*(96/100),dt=n.MLookupFactory.get(n.Env.getCtx(),0,0,n.DisplayType.TableDir,"AD_Org_ID",0,!1," AD_Org.AD_Org_ID <> 0 AND AD_Org.IsSummary='N' AND AD_Org.IsActive='Y' AND AD_Org.IsCostCenter='N' AND AD_Org.IsProfitCenter='N' "),et,e,r,nt,tt,ut,ft,kt;a=new n.Controls.VComboBox("AD_Org_ID",!1,!1,!0,dt,50);et=n.MLookupFactory.get(n.Env.getCtx(),0,0,n.DisplayType.List,"MovementType",189,!1,null);v=new n.Controls.VComboBox("MovementType",!1,!1,!0,et,29);var c=t("<div class='input-group vis-input-wrap'>"),y=t("<div class='vis-control-wrap'>"),p=t("<div class='input-group-append'>"),gt=n.MLookupFactory.get(n.context,0,0,n.DisplayType.Search,"M_Locator_ID",0,!1,"");u=new n.Controls.VTextBoxButton("M_Locator_ID",!1,!1,!0,n.DisplayType.Search,gt);c.append(y);y.append(u.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));c.append(p);p.append(u.getBtn(0));p.append(u.getBtn(1));u.getBtn(0).addClass("vis-lookupButtons");u.getBtn(1).addClass("vis-lookupButtons");var w=t("<div class='input-group vis-input-wrap'>"),b=t("<div class='vis-control-wrap'>"),k=t("<div class='input-group-append'>"),ni=n.MLookupFactory.get(n.context,0,0,n.DisplayType.Search,"M_Product_ID",0,!1,"");f=new n.Controls.VTextBoxButton("M_Product_ID",!1,!1,!0,n.DisplayType.Search,ni);w.append(b);b.append(f.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," "));w.append(k);k.append(f.getBtn(0));k.append(f.getBtn(1));f.getBtn(0).addClass("vis-lookupButtons");f.getBtn(1).addClass("vis-lookupButtons");s=t("<div class='vis-mainContainer'>");e=t("<div class='vis-pSelectInfo vis-leftsidebarouterwrap'>");r=t("<div class='vis-pSelectInner'>");e.append(r);var ot=t("<div class='vis-paymentselect-field'>"),st=t("<div class='input-group vis-input-wrap'>"),d=t("<div class='vis-control-wrap'>");ot.append(st);st.append(d);d.append(a.getControl());d.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"AD_Org_ID")+" <\/label>"));r.append(ot);var ht=t("<div class='vis-paymentselect-field'>"),ct=t("<div class='input-group vis-input-wrap'>"),g=t("<div class='vis-control-wrap'>");ht.append(ct);ct.append(g);g.append(v.getControl());g.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"MovementType")+" <\/label>"));r.append(ht);nt=t("<div class='vis-paymentselect-field'>");nt.append(c);y.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"M_Locator_ID")+" <\/label>"));r.append(nt);tt=t("<div class='vis-paymentselect-field'>");tt.append(w);b.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"Product")+" <\/label>"));r.append(tt);var lt=t("<div class='vis-paymentselect-field'>"),at=t("<div class='input-group vis-input-wrap'>"),it=t("<div class='vis-control-wrap'>");it.append(t("<input  id='VIS_dtpFromDate"+i.windowNo+"'type='date'>"));it.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"DateFrom")+" <\/label>"));lt.append(at);at.append(it);r.append(lt);var vt=t("<div class='vis-paymentselect-field'>"),bt=t("<div class='input-group vis-input-wrap'>"),rt=t("<div class='vis-control-wrap'>");rt.append(t("<input  id='VIS_dtpToDate"+i.windowNo+"'type='date'>"));rt.append(t("<label>"+n.Msg.translate(n.Env.getCtx(),"DateTo")+" <\/label>"));vt.append(bt);bt.append(rt);r.append(vt);ut=t("<div class='vis-paymentselect-field'>");ut.append(t("<button class='VIS_Pref_btn-2' id='VIS_btnRefresh_"+i.windowNo+"' style='margin-top: 0px;'><i class='vis vis-refresh'><\/i><\/button>"));e.append(ut);ft=t("<div class='vis-paymentselect-field'>");ft.append(t("<button class='VIS_Pref_btn-2' id='VIS_btnZoom_"+i.windowNo+"' style='margin-top: 0px;'><i class='vis vis-find'><\/i><\/button>"));e.append(ft);h=t("<div class='vis-pSelectIionGrid'>");kt=" <div class='vis-pSelectProcess'> <div class='vis-paymentselect-field'> <input id='VIS_btnCancel_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("Cancel")+"' ><\/input> <input id='VIS_btnOK_"+i.windowNo+"' class='vis-frm-btn' type='submit' value='"+n.Msg.getMsg("OK")+"' ><\/input> <\/div> <\/div>";s.append(e).append(h).append(t(kt));o.append(s);yt();window.setTimeout(function(){wt()},20);pt();l(!0)}function yt(){k=t("#VIS_dtpFromDate"+i.windowNo);d=t("#VIS_dtpToDate"+i.windowNo);y=t("#VIS_btnRefresh_"+i.windowNo);g=t("#VIS_btnZoom_"+i.windowNo);p=t("#VIS_btnOK_"+i.windowNo);w=t("#VIS_btnCancel_"+i.windowNo);var n=new Date,r=("0"+n.getDate()).slice(-2),u=("0"+(n.getMonth()+1)).slice(-2),f=n.getFullYear()+"-"+u+"-"+r}function pt(){y.on("click",function(){nt()});g.on("click",function(){bt()});p.on("click",function(){nt()});w.on("click",function(){i.dispose()})}function wt(){n.AEnv.getGridWindow(i.windowNo,223,function(u){var e,f;if(u.error!=null){n.ADialog.error(u.error);self.dispose();self=null;return}(e=t.parseJSON(u.result),n.context.setContextOfWindow(t.parseJSON(u.wCtx),i.windowNo),f=new n.GridWindow(e),f!=null)&&(b=f.getTabs()[0],r=new n.GridController(!1),r.initGrid(!0,i.windowNo,i,b),r.setVisible(!0),window.innerHeight>700?r.sizeChanged(window.innerHeight-230,window.innerWidth):r.sizeChanged(window.innerHeight-215,window.innerWidth),h.append(r.getRoot()),r.activate(),c=new n.Query,c.addRestriction("AD_Client_ID",n.Query.prototype.EQUAL,n.context.getAD_Client_ID()))})}function nt(){var e=null,t,i;e=c!=null?jQuery.extend(!0,{},c):new n.Query;t=a.getValue();(t==null||t.toString()=="-1"||t.toString().trim().length==0)&&(t=null);t!=null&&t.toString().length>0&&e.addRestriction("AD_Org_ID",n.Query.prototype.EQUAL,t);t=u.getValue();t!=null&&t.toString().length>0&&e.addRestriction("M_Locator_ID",n.Query.prototype.EQUAL,t);t=f.getValue();t!=null&&t.toString().length>0&&e.addRestriction("M_Product_ID",n.Query.prototype.EQUAL,t);t=v.getValue();(t==null||t.toString()=="-1"||t.toString().trim().length==0)&&(t=null);t!=null&&t.toString().length>0&&e.addRestriction("MovementType",n.Query.prototype.EQUAL,t);i=k.val().toString();i!=null&&i.length>0&&(i=new Date(i),e.addRestriction("TRUNC(MovementDate,'DD')",n.Query.prototype.GREATER_EQUAL,i));i=d.val().toString();i!=null&&i.length>0&&(i=new Date(i),e.addRestriction("TRUNC(MovementDate,'DD')",n.Query.prototype.LESS_EQUAL,i));b.setQuery(e);r.query(0,0,!1)}function bt(){var u=0,f=null,e=null,o=[],t=n.context.getContextAsInt(i.windowNo,"M_InOutLine_ID"),s,h;if(t!=0?(n.context.getContext(i.windowNo,"MovementType").equals("C-")?u=169:n.context.getContext(i.windowNo,"MovementType").equals("C+")?u=409:n.context.getContext(i.windowNo,"MovementType").equals("V+")?u=184:n.context.getContext(i.windowNo,"MovementType").equals("V-")&&(u=411),f="M_InOut_ID",e="VIS_140",o[0]=new n.DB.SqlParam("@lineID",t)):(t=n.context.getContextAsInt(i.windowNo,"M_InventoryLine_ID"),t!=0?(u=168,f="M_Inventory_ID",e="VIS_141",o[0]=new n.DB.SqlParam("@lineID",t)):(t=n.context.getContextAsInt(i.windowNo,"M_MovementLine_ID"),t!=0?(u=170,f="M_Movement_ID",e="VIS_142",o[0]=new n.DB.SqlParam("@lineID",t)):(t=n.context.getContextAsInt(i.windowNo,"M_ProductionLine_ID"),t!=0&&(u=191,f="M_Production_ID",e="VIS_143",o[0]=new n.DB.SqlParam("@lineID",t))))),u!=0)if(s=0,h=0,h=r.getSelectedRows(),h.length>0)s=n.Utility.Util.getValueOfInt(tt(e,null,null)),dt(f,t,u,s);else return alert(n.Msg.getMsg("NoRecordSelected"))}function kt(n,i,r){var u=null;return t.ajax({url:lt,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(n)}).done(function(n){u=n;r&&r(n)}),u}function dt(t,i,r,u){var f=new n.Query;f.addRestriction(t,n.Query.prototype.EQUAL,u);n.viewManager.startWindow(r,f)}var tt;this.windowNo=null;var o=t("<div style='width: 100%; height: 100%; background-color: white;'>"),i=this,s=null,it=null,h=null,rt=null,ut=null,ft=null,et=null,a=null,v=null,k=null,d=null,ot=[],st=null,y=null,g=null,p=null,w=null,ht=[],e=null,u=null,f=null,r=null,c=null,b=null,ct=n.Application.contextUrl,lt=ct+"JsonData/JDataSetWithCode";this.initialize=function(){at();l(!0);window.setTimeout(function(){vt();l(!1)},20)};tt=function(t,i,r){var f=r?!0:!1,e={sql:t,page:1,pageSize:0},u=null;return kt(e,f,function(t){i=(new n.DB.DataSet).toJson(t);var i=(new n.DB.DataSet).toJson(t);u=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null;i.dispose();i=null;f&&r(u)}),u};this.getRoot=function(){return o};this.refreshUI=function(){r&&r.vTable.resize()};this.dataStatusChanged=function(){};this.setBusy=function(n){l(n)};this.disposeComponent=function(){windowNo=null;o=null;i=this;s=null;it=null;$divBankAccount=null;$divCurrentBalance=null;$divBusinessPartner=null;$divOnlyDueInvoice=null;$divPaymentDate=null;$divPaymentMethod=null;h=null;rt=null;ut=null;ft=null;et=null;$cmbBankAccount=null;$cmbBusinessPartner=null;$cmbPaymentMethod=null;$cmbPaymentDate=null;$lblCurrentBal=null;$chkOnlyDueInvoice=null;$txtCurrentBal=null;$lblMsg=null;$txtPaymentAmount=null;ot=null;st=null;y=null;p=null;w=null;ht=null}}n.Apps.AForms=n.Apps.AForms||{};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;this.frame.getContentGrid().append(this.getRoot());this.initialize()};i.prototype.refresh=function(){this.refreshUI()};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};n.Apps.AForms.VTrxMaterial=i}(VIS,jQuery),function(n){function hi(){n.CalloutEngine.call(this,"VIS.TestClass")}function r(){n.CalloutEngine.call(this,"VIS.CalloutOrder")}function ci(){n.CalloutEngine.call(this,"VIS.CalloutInventoryMove")}function li(){n.CalloutEngine.call(this,"VIS.CalloutAssignment")}function a(){n.CalloutEngine.call(this,"VIS.CalloutCashJournal")}function yt(){n.CalloutEngine.call(this,"VIS.CalloutSetAttributeCode")}function g(){n.CalloutEngine.call(this,"VIS.CalloutProduct")}function pt(){n.CalloutEngine.call(this,"VIS.CalloutProject")}function nt(){n.CalloutEngine.call(this,"VIS.CalloutBankStatement")}function v(){n.CalloutEngine.call(this,"VIS.CalloutOfferSerIncluded")}function y(){n.CalloutEngine.call(this,"VIS.CalloutOfferServices")}function it(){n.CalloutEngine.call(this,"VIS.CalloutCheckInOut")}function b(){n.CalloutEngine.call(this,"VIS.CalloutInventory")}function f(){n.CalloutEngine.call(this,"VIS.CalloutInvoice")}function p(){n.CalloutEngine.call(this,"VIS.CalloutInvoiceBatch")}function ai(){n.CalloutEngine.call(this,"VIS.CalloutMovement")}function vi(){n.CalloutEngine.call(this,"VIS.CalloutObjectData")}function wt(){n.CalloutEngine.call(this,"VIS.CalloutOffer")}function rt(){n.CalloutEngine.call(this,"VIS.CalloutGLJournal")}function ut(){n.CalloutEngine.call(this,"VIS.CalloutProduction")}function ft(){n.CalloutEngine.call(this,"VIS.CalloutRequest")}function tt(){n.CalloutEngine.call(this,"VIS.CalloutRequisition")}function bt(){n.CalloutEngine.call(this,"VIS.CalloutPaySelection")}function et(){n.CalloutEngine.call(this,"VIS.CalloutOrderLine")}function yi(){n.CalloutEngine.call(this,"VIS.CalloutOrderlineRecording")}function pi(){n.CalloutEngine.call(this,"VIS.CalloutCurrency")}function wi(){n.CalloutEngine.call(this,"VIS.CalloutContractQty")}function bi(){n.CalloutEngine.call(this,"VIS.CalloutContractProduct")}function k(){n.CalloutEngine.call(this,"VIS.CalloutContract")}function kt(){n.CalloutEngine.call(this,"VIS.copyname")}function ki(){n.CalloutEngine.call(this,"VIS.CalloutUserTimeRec")}function ot(){n.CalloutEngine.call(this,"VIS.CalloutTimeExpense")}function c(){n.CalloutEngine.call(this,"VIS.CalloutTeamForcast")}function st(){n.CalloutEngine.call(this,"VIS.CalloutMasterForecast")}function dt(){n.CalloutEngine.call(this,"VIS.CalloutTaxAmt")}function gt(){n.CalloutEngine.call(this,"VIS.CalloutTax")}function di(){n.CalloutEngine.call(this,"VIS.CalloutSetBP")}function gi(){n.CalloutEngine.call(this,"VIS.CalloutProjectLine")}function ni(){n.CalloutEngine.call(this,"VIS.CalloutProductToOpportunity")}function nr(){n.CalloutEngine.call(this,"VIS.CalloutPriceListOpp")}function s(){n.CalloutEngine.call(this,"VIS.CalloutInOut")}function ti(){n.CalloutEngine.call(this,"VIS.CalloutPaymentAllocate")}function h(){n.CalloutEngine.call(this,"VIS.CalloutPayment")}function hu(i){var r=t.getValueOfInt(i.getValue("C_BankAccount_ID")),u=t.getValueOfInt(i.getValue("VA009_PaymentMethod_ID")),o=t.getValueOfString(i.getValue("CheckNo")),f=!1,e;r>0&&u>0&&o!=""&&t.getValueOfString(i.getValue("TenderType"))=="K"&&(e=r.toString()+","+u.toString(),f=t.getValueOfBoolean(n.dataContext.getJSONRecord("MPayment/GetAutoCheckControl",e.toString())));i.setValue("IsOverrideAutoCheck",f)}function w(){n.CalloutEngine.call(this,"VIS.CalloutOrderContract")}function ht(){n.CalloutEngine.call(this,"VIS.CalloutKPI")}function d(){n.CalloutEngine.call(this,"VIS.CalloutDashboard")}function ct(){n.CalloutEngine.call(this,"VIS.CalloutDashboardView")}function tr(){n.CalloutEngine.call(this,"VIS.CalloutService")}function ri(){n.CalloutEngine.call(this,"VIS.CalloutSetReadOnly")}function ir(){n.CalloutEngine.call(this,"VIS.CalloutSetContract")}function ui(){n.CalloutEngine.call(this,"VIS.CallOutWorkflow ")}function rr(){n.CalloutEngine.call(this,"VIS.CalloutSalesQuotation ")}function ur(){n.CalloutEngine.call(this,"VIS.CalloutSetDate ")}function fr(){n.CalloutEngine.call(this,"VIS.CalloutDisplayButton ")}function er(){n.CalloutEngine.call(this,"VIS.CalloutMoveConfirmLine")}function fi(){n.CalloutEngine.call(this,"VIS.CalloutDocumentType")}function or(){n.CalloutEngine.call(this,"VIS.CalloutProjectCBPartner")}function sr(){n.CalloutEngine.call(this,"VIS.CalloutPaymentTypeSO")}function hr(){n.CalloutEngine.call(this,"VIS.CalloutMCampaign")}function ei(){n.CalloutEngine.call(this,"VIS.CalloutMRequest")}function lt(){n.CalloutEngine.call(this,"VIS.CalloutModuleMgmt")}function cr(){n.CalloutEngine.call(this,"VIS.CalloutPriclistUOM")}function at(){n.CalloutEngine.call(this,"VIS.CalloutTaxAmount")}function lr(){n.CalloutEngine.call(this,"VIS.CalloutProdCatVal")}function ar(){n.CalloutEngine.call(this,"VIS.CalloutProdTypeVal")}function vr(){n.CalloutEngine.call(this,"VIS.CalloutProfitTax")}function yr(){n.CalloutEngine.call(this,"VIS.CalloutBPartner")}function pr(){n.CalloutEngine.call(this,"VIS.CalloutshipLine")}function wr(){n.CalloutEngine.call(this,"VIS.CalloutRecurring")}function br(){n.CalloutEngine.call(this,"VIS.CalloutProductionLine")}function oi(){n.CalloutEngine.call(this,"VIS.CalloutProfitLoss")}function kr(){n.CalloutEngine.call(this,"VIS.CalloutShipReceiptConfirmLine")}function si(){n.CalloutEngine.call(this,"VIS.CalloutCashJournalLine")}function gr(){n.CalloutEngine.call(this,"VIS.CalloutUOMConversion")}function nu(){n.CalloutEngine.call(this,"VIS.CalloutIncoTerm")}function tu(){n.CalloutEngine.call(this,"VIS.CalloutBlanketOrderRef")}function l(n){var t=new Date(n);return t.setMinutes(-t.getTimezoneOffset()+t.getMinutes()),t.toISOString()}function iu(){n.CalloutEngine.call(this,"VIS.CalloutLocatorPC")}function ru(){n.CalloutEngine.call(this,"VIS.CalloutSetDates")}function uu(){n.CalloutEngine.call(this,"VIS.CalloutLandedCost")}function fu(){n.CalloutEngine.call(this,"VIS.CalloutRFQ")}function eu(){n.CalloutEngine.call(this,"VIS.CalloutPaymentTerm")}function vt(){n.CalloutEngine.call(this,"VIS.ProvisionalInvoice")}function ou(){n.CalloutEngine.call(this,"VIS.CalloutLead")}function su(){n.CalloutEngine.call(this,"VIS.CalloutAzureBlob")}var i=n.Logging.Level,t=n.Utility.Util,u=!1,o=0;n.Utility.inheritPrototype(hi,n.CalloutEngine);hi.prototype.set=function(n,t,i,r,u){return i.setValue("Description",u),""};n.Model.TestClass=hi;n.Utility.inheritPrototype(r,n.CalloutEngine);r.prototype.DocType=function(r,u,f,e,o,s){var k="PR",y="WR",tt="F",w,b,v,d,nt,a,h,ft;if(this.isCalloutActive()||o==null||o.toString()==""||(w=t.getValueOfInt(o),w==null||w==0))return"";this.setCalloutActive(!0);b=t.getValueOfString(f.getValue("DocumentNo"));v=b==null;!v&&b.startsWith("<")&&b.endsWith(">")&&(v=!0);var it=t.getValueOfInt(f.getValue("C_DocType_ID")),c=null,rt=[];try{d=0;v||t.getValueOfInt(it)==0||(c=n.dataContext.getJSONRecord("MDocType/GetDocTypeData",it.toString()),c!=null&&(d=t.getValueOfInt(c.CurrentNextSys)));c=n.dataContext.getJSONRecord("MDocType/GetDocTypeData",w.toString());rt.length=0;rt=null;var l="",p=!0,g=!1,ut="";if(c!=null&&(l=c.DocSubTypeSO,ut=c.Value,l==null&&(l="--"),r.setContext(u,"OrderType",l),r.setContext(u,"DocTypeValue",ut),l=="BO"?(r.setContext(u,"BlanketOrderType",l),f.setValue("BlanketOrderType",l)):t.getValueOfString(c.IsReleaseDocument).equals("Y")?f.setValue("BlanketOrderType","BO"):(r.setContext(u,"BlanketOrderType","OO"),f.setValue("BlanketOrderType","OO"),f.setValue("C_Order_Blanket",null)),!l=="SO"&&f.setValue("IsDropShip","N"),"N"==c.IsSOTrx&&(p=!1),g=c.IsReturnTrx=="Y"?!0:!1,g?l==y?f.setValue("DeliveryRule",tt):f.setValue("DeliveryRule","M"):(l==y?f.setValue("DeliveryRule",tt):l==k?f.setValue("DeliveryRule","R"):f.setValue("DeliveryRule","A"),l==y||l==k||l=="WI"?f.setValue("InvoiceRule","I"):f.setValue("InvoiceRule","D"),l==y?f.setValue("PaymentRule","B"):f.setValue("PaymentRule","P"),r.setContext(u,"HasCharges",t.getValueOfString(c.HasCharges))),c.IsDocNoControlled=="Y"&&(v||d==t.getValueOfInt(c.AD_Sequence_ID)||(v=!0),v&&(n.Ini.getLocalStorage(n.IniConstants.P_VIENNASYS)&&r.getAD_Client_ID()<1e6?f.setValue("DocumentNo","<"+t.getValueOfInt(c.CurrentNextSys)+">"):f.setValue("DocumentNo","<"+t.getValueOfString(c.CurrentNext)+">")))),g)return this.setCalloutActive(!1),"";l==y||l==k||(nt=r.getContextAsInt(u,"C_BPartner_ID"),a=null,nt!=0&&(a=n.dataContext.getJSONRecord("MBPartner/GetBPDocTypeData",nt.toString())),a!=null&&(h=a[p?"PaymentRule":"PaymentRulePO"],h!=null&&h.length!=0&&((p&&h=="B"||h=="S"||h=="U")&&(h="P"),p||h!="B"||(h="P"),f.setValue("PaymentRule",h)),ft=a[p?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"],f.setValue("C_PaymentTerm_ID",ft),h=a.InvoiceRule,h!=null&&h.length!=0&&f.setValue("InvoiceRule",h),h=a.DeliveryRule,h!=null&&h.length!=0&&f.setValue("DeliveryRule",h),h=a.FreightCostRule,h!=null&&h.length!=0&&f.setValue("FreightCostRule",h),h=a.DeliveryViaRule,h!=null&&h.length!=0&&f.setValue("DeliveryViaRule",h)))}catch(et){return this.setCalloutActive(!1),c!=null&&(c.close(),c=null),this.log.log(i.SEVERE,sql,et),et}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};r.prototype.BlanketOrderLine=function(i,r,u,f,e,o){var s=null,y,nt,rt,p,ut,ft,g;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(y=0,e!=null&&(y=t.getValueOfInt(e.toString())),y==0)return"";if(this.setCalloutActive(!0),nt=y.toString(),s=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",nt),s!=null){var l=t.getValueOfInt(s.M_Product_ID),et=t.getValueOfInt(s.C_Charge_ID),a=t.getValueOfInt(s.Qty),h=t.getValueOfInt(s.QtyOrdered),v=t.getValueOfInt(s.QtyReleased),tt=t.getValueOfDouble(s.PriceList),w=t.getValueOfDouble(s.PriceActual),c=t.getValueOfDouble(s.C_UOM_ID),it=t.getValueOfDouble(s.Discount),b=t.getValueOfDouble(s.PriceEntered),k=t.getValueOfInt(s.M_AttributeSetInstance_ID),d=t.getValueOfDouble(s.C_Tax_ID);QtyEntered=t.getValueOfDecimal(a);paramStr=c.toString().concat(",");rt=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr);p=QtyEntered.toFixed(t.getValueOfInt(rt));QtyEntered!=p&&(this.log.fine("Corrected QtyEntered Scale UOM="+c+"; QtyEntered="+QtyEntered+"->"+p),QtyEntered=p);paramStr=l.toString().concat(",",c.toString(),",",QtyEntered.toString());ut=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr);h=ut;h==null&&(h=QtyEntered);ft=QtyEntered!=h;ft&&(paramStr=l.toString().concat(",",c.toString(),",",v.toString()),g=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",paramStr),g!=null&&(v=g));l!=0&&l!=null?u.setValue("M_Product_ID",l):u.setValue("C_Charge_ID",et);a!=0&&a!=null&&u.setValue("QtyEntered",a);tt!=null&&u.setValue("PriceList",tt);w!=null&&(u.setValue("PriceActual",w),u.setValue("LineNetAmt",w*a));b!=null&&(u.setValue("PriceEntered",b),u.setValue("PriceEntered",b));it!=null&&u.setValue("Discount",it);c!=0&&c!=null&&u.setValue("C_UOM_ID",c);h!=0&&h!=null&&v!=null&&u.setValue("QtyBlanket",h+v-v);k!=0&&k!=null&&u.setValue("M_AttributeSetInstance_ID",k);d!=0&&d!=null&&u.setValue("C_Tax_ID",d)}}catch(ot){return this.setCalloutActive(!1),ot}return this.setCalloutActive(!1),o=null,this.Qty(i,r,u,f,u.getValue("QtyEntered"))};r.prototype.BlanketOrder=function(i,r,u,f,e,o){var s=null,h,rt,it;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(h=0,e!=null&&(h=t.getValueOfInt(e.toString())),h==0)return"";if(this.setCalloutActive(!0),rt=i.isSOTrx(r),it=h.toString(),s=n.dataContext.getJSONRecord("MOrder/GetOrder",it),s!=null){var l=t.getValueOfDouble(s.C_BPartner_ID),a=t.getValueOfDouble(s.M_PriceList_ID),v=t.getValueOfDouble(s.M_Warehouse_ID),y=t.getValueOfDouble(s.C_PaymentTerm_ID),p=t.getValueOfDouble(s.PaymentRule),w=t.getValueOfDouble(s.C_Payment_ID),b=t.getValueOfDouble(s.VA009_PaymentMethod_ID),k=t.getValueOfDouble(s.C_Currency_ID),d=t.getValueOfDouble(s.C_Project_ID),g=t.getValueOfDouble(s.C_Campaign_ID);c;var c=t.getValueOfDouble(s.C_ProjectRef_ID),nt=t.getValueOfDouble(s.SalesRep_ID),tt=t.getValueOfDouble(s.PriorityRule);l!=0&&l!=null&&u.setValue("C_BPartner_ID",l);a!=0&&a!=null&&u.setValue("M_PriceList_ID",a);v!=0&&v!=null&&u.setValue("M_Warehouse_ID",v);y!=0&&y!=null&&u.setValue("C_PaymentTerm_ID",y);p!=0&&p!=null&&u.setValue("PaymentRule",p);w!=0&&w!=null&&u.setValue("C_Payment_ID",w);b!=0&&b!=null&&u.setValue("VA009_PaymentMethod_ID",b);k!=0&&k!=null&&u.setValue("C_Currency_ID",k);d!=0&&d!=null&&u.setValue("C_Project_ID",d);g!=0&&g!=null&&u.setValue("C_Campaign_ID",g);c!=0&&c!=null&&u.setValue("C_ProjectRef_ID",c);nt!=0&&nt!=null&&u.setValue("SalesRep_ID",nt);tt!=0&&tt!=null&&u.setValue("PriorityRule",tt);u.getField("C_IncoTerm_ID")!=null&&u.setValue("C_IncoTerm_ID",t.getValueOfInt(s.C_IncoTerm_ID))}}catch(ut){return this.setCalloutActive(!1),ut}return this.setCalloutActive(!1),o=null,this.BPartner(i,r,u,f,u.getValue("C_BPartner_ID"))};r.prototype.BPartner=function(i,r,u,f,e,o){var c=null,h=null,yt,pt,k,et,ot,st,g,ht,ct,a,d,lt,nt,at,it,wt,tt,rt,ut,s,vt,bt,v,kt;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{var p=0,l="N",ft="N";if((e!=null&&(p=t.getValueOfInt(e.toString())),p==0)||(yt=t.getValueOfBoolean(u.getValue("IsReturnTrx")),yt))return"";this.setCalloutActive(!0);var w=!1,d="VA009_",b=i.isSOTrx(r),h=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix",d);if(h!=null&&(w=h.VA009_),d=w.toString()+","+p,h=n.dataContext.getJSONRecord("MBPartner/GetBPartnerOrderData",d),h!=null){if(pt=t.getValueOfInt(u.getValue("M_PriceList_ID")),v=t.getValueOfDecimal(u.getValue("C_Order_Blanket")),pt>0&&v>0||(k=t.getValueOfInt(b?h.M_PriceList_ID:h.PO_PriceList_ID),k!=0&&u.setValue("M_PriceList_ID",k)),et=t.getValueOfInt(b?h.C_IncoTerm_ID:h.C_IncoTermPO_ID),et>0&&u.setValue("C_IncoTerm_ID",et),u.setValue("Bill_BPartner_ID",p),ot=t.getValueOfInt(h.Bill_Location_ID),ot==0?(st=t.getValueOfInt(h.Bill_BPartner_ID),st>0&&u.setValue("Bill_BPartner_ID",st)):u.setValue("Bill_Location_ID",ot),g=t.getValueOfInt(h.C_BPartner_Location_ID),p.toString()==i.getContext("C_BPartner_ID")&&(ht=i.getContext("C_BPartner_Location_ID"),ht.length>0&&(g=t.getValueOfInt(ht))),g==0?u.setValue("C_BPartner_Location_ID",null):(u.setValue("C_BPartner_Location_ID",g),"Y"==t.getValueOfString(h.IsShipTo)&&u.setValue("Bill_Location_ID",g)),ct=t.getValueOfInt(h.SalesRep_ID),ct>0&&u.setValue("SalesRep_ID",ct),w){var y=t.getValueOfInt(h.VA009_PaymentMethod_ID);v<=0&&(a=n.dataContext.getJSONRecord("MBPartner/GetBPDetails",p),a!=null&&(l=t.getValueOfString(a.IsVendor),ft=t.getValueOfString(a.IsCustomer),b?l=="Y"?(y=0,c=null,ft=="Y"&&(y=t.getValueOfInt(a.VA009_PaymentMethod_ID),c=t.getValueOfString(a.VA009_PAYMENTBASETYPE))):ft=="Y"&&(y=t.getValueOfInt(a.VA009_PaymentMethod_ID),c=t.getValueOfString(a.VA009_PAYMENTBASETYPE)):l=="Y"?(y=t.getValueOfInt(a.VA009_PO_PaymentMethod_ID),c=t.getValueOfString(a.VA009_PAYMENTBASETYPEPO)):(y=0,c=null)));y==0?(v=t.getValueOfInt(u.getValue("C_Order_Blanket")),v>0&&(d=w.toString()+","+v.toString(),h=n.dataContext.getJSONRecord("MOrder/GetPaymentMethod",d),h!=null&&(lt=t.getValueOfInt(h.VA009_PaymentMethod_ID),lt>0&&(u.setValue("VA009_PaymentMethod_ID",lt),c=t.getValueOfString(h.VA009_PaymentBaseType),c!="W"&&c!=null&&(u.setValue("PaymentMethod",c),l=="N"?u.setValue("PaymentRule",c):u.setValue("PaymentRulePO",c)))))):y==0?u.setValue("VA009_PaymentMethod_ID",null):(u.setValue("VA009_PaymentMethod_ID",y),c!="W"&&c!=null?(u.setValue("PaymentMethod",c),l=="N"?u.setValue("PaymentRule",c):u.setValue("PaymentRulePO",c)):(u.setValue("PaymentMethod","T"),l=="N"?u.setValue("PaymentRule","T"):u.setValue("PaymentRulePO","T")))}nt=t.getValueOfInt(h.AD_User_ID);p.toString()==i.getContext("C_BPartner_ID")&&(at=i.getContext("AD_User_ID"),at.length>0&&(nt=t.getValueOfInt(at)));nt==0?u.setValue("AD_User_ID",null):(u.setValue("AD_User_ID",nt),u.setValue("Bill_User_ID",nt));b&&(it=t.getValueOfString(h.CreditStatusSettingOn),it=="CH"?(rt=t.getValueOfDouble(h.SO_CreditLimit),rt!=0&&(ut=t.getValueOfDouble(h.CreditAvailable),ut<=0&&n.ADialog.info("CreditOver"))):(wt=t.getValueOfInt(u.getValue("C_BPartner_Location_ID")),tt=n.dataContext.getJSONRecord("MBPartner/GetLocationData",wt.toString()),tt!=null&&(it=t.getValueOfString(tt.CreditStatusSettingOn),it=="CL"&&(rt=t.getValueOfDouble(tt.SO_CreditLimit),rt!=0&&(ut=t.getValueOfDouble(tt.CreditAvailable),ut<=0&&n.ADialog.info("CreditOver"))))));s=t.getValueOfString(h.POReference);s!=null&&s.length!=0&&u.setValue("POReference",s);s=t.getValueOfString(h.SO_Description);s!=null&&s.trim().length!=0&&u.setValue("Description",s);s=t.getValueOfString(h.IsDiscountPrinted);s!=null&&s.length!=0?u.setValue("IsDiscountPrinted",s):u.setValue("IsDiscountPrinted","N");vt=i.getContext("OrderType");u.setValue("InvoiceRule","D");u.setValue("DeliveryRule","A");w?c!="W"&&c!=null?l=="N"?u.setValue("PaymentRule",c):u.setValue("PaymentRulePO",c):(l=="N"?u.setValue("PaymentRule","T"):u.setValue("PaymentRulePO","T"),u.setValue("PaymentMethod","T")):u.setValue("PaymentRule","P");vt=="PR"?(u.setValue("InvoiceRule","I"),u.setValue("DeliveryRule","R")):vt=="WR"?w?c!="W"&&c!=null?l=="N"?u.setValue("PaymentRule",c):u.setValue("PaymentRulePO",c):(l=="N"?u.setValue("PaymentRule","T"):u.setValue("PaymentRulePO","T"),u.setValue("PaymentMethod","T")):u.setValue("PaymentRule","B"):(w?c!="W"&&c!=null?l=="N"?u.setValue("PaymentRule",c):u.setValue("PaymentRulePO",c):(l=="N"?u.setValue("PaymentRule","T"):u.setValue("PaymentRulePO","T"),u.setValue("PaymentMethod","T")):(s=t.getValueOfString(b?h.PaymentRule:h.PaymentRulePO),s!=null&&s.length!=0&&(s=="B"&&(s="P"),(b&&s=="S"||s=="U")&&(s="P"),u.setValue("PaymentRule",s))),bt=t.getValueOfInt(u.getValue("C_PaymentTerm_ID")),v=t.getValueOfDecimal(u.getValue("C_Order_Blanket")),bt>0&&v>0||(k=t.getValueOfInt(b?h.C_PaymentTerm_ID:h.PO_PaymentTerm_ID),kt=this.checkAdvancePaymentTerm(t.getValueOfInt(u.getValue("C_DocTypeTarget_ID")),k),kt?k!=0&&u.setValue("C_PaymentTerm_ID",k):u.setValue("C_PaymentTerm_ID",null)),s=t.getValueOfString(h.InvoiceRule),s!=null&&s.length!=0&&u.setValue("InvoiceRule",s),s=t.getValueOfString(h.DeliveryRule),s!=null&&s.length!=0&&u.setValue("DeliveryRule",s),s=t.getValueOfString(h.FreightCostRule),s!=null&&s.length!=0&&u.setValue("FreightCostRule",s),s=t.getValueOfString(h.DeliveryViaRule),s!=null&&s.length!=0&&u.setValue("DeliveryViaRule",s))}}catch(dt){return this.setCalloutActive(!1),dt}return this.setCalloutActive(!1),o=null,this.BPartnerBill(i,r,u,f,u.getValue("Bill_BPartner_ID"))};r.prototype.BPartnerLoc=function(r,u,f,e,o,s){var h=null,b="",c,l,a,v,y,p;if(this.isCalloutActive()||o==null||o.toString()=="")return"";try{if((c=0,o!=null&&(c=t.getValueOfInt(o.toString())),c==0)||(l=t.getValueOfBoolean(f.getValue("IsReturnTrx")),l))return"";this.setCalloutActive(!0);a=r.isSOTrx(u);a&&(h=n.dataContext.getJSONRecord("MBPartner/GetLocationData",c.toString()),h!=null&&(v=t.getValueOfString(h.CreditStatusSettingOn),v=="CL"&&(y=t.getValueOfDouble(h.SO_CreditLimit),y!=0&&(p=t.getValueOfDouble(h.CreditAvailable),h!=null&&p<=0&&n.ADialog.info("CreditOver",null,"","")))))}catch(w){return h!=null&&(h.close(),h=null),this.log.log(i.SEVERE,b,w),this.setCalloutActive(!1),w}this.setCalloutActive(!1);s=null};r.prototype.BPartnerBill=function(r,u,f,e,o){var h,c,b,l,a,y,v,p,k,d,s,w,g,nt,tt;if(this.isCalloutActive()||o==null||o.toString()=="")return"";h=null;try{if(c=t.getValueOfInt(o.toString()),c==null||c==0)return"";if(this.setCalloutActive(!0),b=t.getValueOfBoolean(f.getValue("IsReturnTrx")),b)return this.setCalloutActive(!1),"";h=n.dataContext.getJSONRecord("MBPartner/GetBPartnerBillData",c.toString());l="Y"==r.getWindowContext(u,"IsSOTrx",!0);h!=null&&(a=t.getValueOfInt(h.Bill_Location_ID),c.toString()==r.getContext("C_BPartner_ID")&&(y=r.getContext("C_BPartner_Location_ID"),y.length>0&&(a=t.getValueOfInt(y))),a==0?f.setValue("Bill_Location_ID",null):f.setValue("Bill_Location_ID",t.getValueOfInt(a)),v=t.getValueOfInt(h.AD_User_ID),c.toString()==r.getContext("C_BPartner_ID")&&(p=r.getContext("AD_User_ID"),p.length>0&&(v=t.getValueOfInt(p))),v==0?f.setValue("Bill_User_ID",null):f.setValue("Bill_User_ID",t.getValueOfInt(v.toString())),l&&(k=0,k!=0&&(d=0,h!=null&&d<0&&n.ADialog.info("CreditLimitOver",null,"",""))),s=h.POReference,s=h.SO_Description,s!=null&&s.toString().trim().length!=0&&f.setValue("Description",s),s=h.IsDiscountPrinted,s!=null&&s.toString().length!=0?f.setValue("IsDiscountPrinted",s):f.setValue("IsDiscountPrinted","N"),w=r.getContext("OrderType"),f.setValue("InvoiceRule","D"),f.setValue("PaymentRule","P"),w=="PR"?f.setValue("InvoiceRule","I"):w=="WR"?f.setValue("PaymentRule","B"):(s=h[l?"PaymentRule":"PaymentRulePO"],s!=null&&s.toString().length!=0&&(s=="B"&&(s="P"),l&&(s=="S"||s=="U")&&(s="P"),f.setValue("PaymentRule",s)),g=t.getValueOfInt(f.getValue("C_PaymentTerm_ID")),nt=t.getValueOfDecimal(f.getValue("C_Order_Blanket")),g>0&&nt>0||(ii=h[l?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"],tt=this.checkAdvancePaymentTerm(t.getValueOfInt(f.getValue("C_DocTypeTarget_ID")),ii),tt?h!=null&&f.setValue("C_PaymentTerm_ID",ii):f.setValue("C_PaymentTerm_ID",null)),s=h.InvoiceRule,s!=null&&s.toString().length!=0&&f.setValue("InvoiceRule",s)))}catch(it){return this.setCalloutActive(!1),h!=null&&(h.close(),h=null),this.log(i.SEVERE,"bPartnerBill",it),it}return this.setCalloutActive(!1),this.PriceList(r,u,f,e,f.getValue("M_PriceList_ID"))};r.prototype.PriceList=function(r,f,e,o,s,h){var y="",c=null,l,a;if(this.isCalloutActive()||s==null||s.toString()=="")return"";try{if(l=t.getValueOfInt(s.toString()),l==null||l==0)return"";if(this.setCalloutActive(!0),u&&this.log.warning("init"),c=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",s.toString()),c!=null){e.setValue("IsTaxIncluded","Y"==c.IsTaxIncluded);r.setContext(f,"EnforcePriceLimit",c.EnforcePriceLimit);var p=c.C_Currency_ID,w=t.getValueOfInt(e.getValue("C_Currency_ID")),b=t.getValueOfDecimal(e.getValue("C_Order_Blanket"));w>0&&b>0||e.setValue("C_Currency_ID",p);a=c.M_PriceList_Version_ID;r.setContext(f,"M_PriceList_Version_ID",a)}}catch(v){return this.setCalloutActive(!1),c!=null&&c.close(),this.log(i.SEVERE,y,v),v}return u&&this.log.warning("finish"),this.setCalloutActive(!1),r=f=e=o=s=h=null,""};r.prototype.Product=function(i,r,f,e,s,h){var a,c,nt,w,ut,v,l,p,k,tt,ot;if(this.isCalloutActive()||s==null||s.toString()==""||(a=t.getValueOfInt(s),a==null||a==0)||"Y"==i.getWindowContext(r,"IsReturnTrx",!0))return"";this.setCalloutActive(!0);try{u&&this.log.warning("init");f.setValue("C_Charge_ID",null);f.setValue("M_AttributeSetInstance_ID",null);var d=i.getWindowContext(r,"IsSOTrx",!0)=="Y",vt=i.getWindowContext(r,"IsReturnTrx",!0)=="Y",rt=i.getContextAsInt(r,"C_BPartner_ID",!1),st=t.getValueOfDecimal(f.getValue("QtyOrdered")),ht=i.getContextAsInt(r,"M_PriceList_ID",!1),ct=i.getContextAsInt(r,"M_PriceList_Version_ID",!1),g=i.getContextAsInt(r,"M_AttributeSetInstance_ID",!1),lt=f.getValue("DateOrdered"),at=2,y=2,p=a.toString().concat(",",rt.toString(),",",st.toString(),",",d,",",ht.toString(),",",ct.toString(),",",lt.toString(),",",null,",",g.toString());try{if(c=n.dataContext.getJSONRecord("MOrderLine/GetProductInfo",p),c!=null&&(f.setValue("PrintDescription",c.DocumentNote),nt=c.productType.toString(),i.setContext(r,"ProductType",nt),nt=="S"?f.setValue("IsContract",!0):(f.setValue("IsContract",!1),f.setValue("NoofCycle",null),f.setValue("QtyPerCycle",null),f.setValue("StartDate",null),f.setValue("C_Contract_ID",0),f.setValue("EndDate",null),f.setValue("C_Frequency_ID",0)),c.IsDropShip.toString()=="Y"?f.setValue("IsDropShip",!0):f.setValue("IsDropShip",!1),o=t.getValueOfInt(c.countEd011),w=t.getValueOfInt(c.purchasingUom),w>0&&!d?f.setValue("C_UOM_ID",w):f.setValue("C_UOM_ID",t.getValueOfInt(c.headerUom)),at=t.getValueOfInt(c.StdPrecision),y=t.getValueOfInt(c.PriceListPrecision),w>0&&!d?(ut=f.getValue("M_Product_ID").toString().concat(","+i.getAD_Client_ID().toString()+","+f.getValue("C_Order_ID").toString()+","+rt.toString()+","+f.getValue("QtyEntered").toString()+","+t.getValueOfString(w)),v=n.dataContext.getJSONRecord("MOrderLine/GetPricesOnProductChange",ut),PriceList=t.getValueOfDecimal(v.PriceList),f.setValue("PriceList",PriceList),PriceEntered=t.getValueOfDecimal(v.PriceEntered),f.setValue("PriceEntered",PriceEntered),PriceActual=t.getValueOfDecimal(v.PriceEntered.toFixed(y)),f.setValue("PriceActual",PriceActual),f.setValue("QtyOrdered",t.getValueOfDecimal(v.QtyOrdered.toFixed(v.UOMStdPrecision)))):(f.setValue("PriceList",c.PriceList),f.setValue("PriceLimit",c.PriceLimit),f.setValue("PriceActual",t.getValueOfDecimal(c.PriceActual.toFixed(y))),f.setValue("PriceEntered",t.getValueOfDecimal(c.PriceEntered.toFixed(y))),f.setValue("C_Currency_ID",t.getValueOfInt(c.C_Currency_ID)),f.setValue("Discount",t.getValueOfDecimal(c.Discount.toFixed(y))),f.setValue("QtyOrdered",f.getValue("QtyEntered"))),i.setContext(r,"EnforcePriceLimit",c.EnforcePriceLimit?"Y":"N"),i.setContext(r,"DiscountSchema",c.DiscountSchema?"Y":"N"),d)){var ft=t.getValueOfDecimal(f.getValue("QtyOrdered")),et=i.getContextAsInt(r,"M_Warehouse_ID"),g=i.getContextAsInt(r,"M_AttributeSetInstance_ID"),b=0;f.getValue("C_OrderLine_ID")!=null&&(b=t.getValueOfInt(f.getValue("C_OrderLine_ID")));b==null&&(b=0);p=a.toString().concat(",",et.toString(),",",g.toString(),",",b.toString());l=n.dataContext.getJSONRecord("MStorage/GetQtyAvailable",p);l==null&&(l=n.Env.ZERO);l==0||l.toString().compareTo(ft)<0||(p=et.toString()+","+a.toString()+","+g.toString()+","+b.toString(),k=n.dataContext.getJSONRecord("MOrderLine/GetNotReserved",p),k==null&&(k=n.Env.ZERO),tt=l-k,tt.compareTo(ft)<0&&(ot=n.Msg.parseTranslation(i,"@QtyAvailable@="+l+" - @QtyNotReserved@="+k+" = "+tt),n.ADialog.info("InsufficientQtyAvailable",!0,ot,"")))}u&&this.log.warning("fini")}catch(it){return this.log.saveError("calloutorder",it.toString()),this.setCalloutActive(!1),it.message}this.setCalloutActive(!1)}catch(it){this.setCalloutActive(!1);this.log.saveError("calloutorder",it.toString())}return this.setCalloutActive(!1),h=null,this.Tax(i,r,f,e,s)};r.prototype.Charge=function(r,u,f,e,o,s){var c,v,l,a,h;try{if(this.isCalloutActive()||o==null||o.toString()=="")return"";if((this.setCalloutActive(!0),c=t.getValueOfInt(o),c==null||c==0)||(v="Y"==r.getContext("IsReturnTrx"),v))return this.setCalloutActive(!1),"";f.getValue("M_Product_ID")!=null&&f.setValue("M_Product_ID",null);f.setValue("M_AttributeSetInstance_ID",null);f.setValue("S_ResourceAssignment_ID",null);l=r.getContextAsInt("#C_UOM_ID");l>0?f.setValue("C_UOM_ID",l):f.setValue("C_UOM_ID",100);r.setContext(u,"DiscountSchema","N");a=n.dataContext.getJSONRecord("MOrder/GetPrecision",f.getValue("C_Order_ID").toString());h=n.dataContext.getJSONRecord("MCharge/GetChargeDetails",c.toString());h!=null&&(f.setValue("PriceEntered",t.getValueOfDecimal(h.ChargeAmt).toFixed(a)),f.setValue("PrintDescription",t.getValueOfString(h.PrintDescription)),f.setValue("PriceActual",t.getValueOfDecimal(h.ChargeAmt).toFixed(a)));f.setValue("PriceLimit",n.Env.ZERO);f.setValue("PriceList",n.Env.ZERO);f.setValue("Discount",n.Env.ZERO)}catch(y){return this.setCalloutActive(!1),this.log.log(i.SEVERE,y.toString()),y}return this.setCalloutActive(!1),s=null,this.Tax(r,u,f,e,o)};r.prototype.Tax=function(i,r,f,e,o,s){var w,y,l,a,c,b,k,d,g,v,h;if(this.isCalloutActive()||o==null||o.toString()==""||(console.log("Before Charge Or Product"),t.getValueOfInt(f.getValue("C_Charge_ID"))==0&&t.getValueOfInt(f.getValue("M_Product_ID"))==0))return"";this.setCalloutActive(!0);try{var nt="",tt="",it=t.getValueOfString(f.getValue("M_Product_ID")).concat(",",t.getValueOfString(f.getValue("C_Order_ID"))+","+t.getValueOfString(f.getValue("C_Charge_ID"))),h=n.dataContext.getJSONRecord("MOrderLine/GetTaxId",it),rt=t.getValueOfInt(h._CountVATAX),ot=i.getWindowContext(r,"IsSOTrx",!0)=="Y",ut=i.getWindowContext(r,"IsReturnTrx",!0)=="Y";if(rt>0&&(nt=t.getValueOfString(h.taxRule)),nt!="T"||ut){if(y=e.getColumnName(),o==null)return"";if((u&&this.log.warning("init"),l=0,l=y=="M_Product_ID"?t.getValueOfInt(o):t.getValueOfInt(i.getContextAsInt(r,"M_Product_ID")),a=0,a=y=="C_Charge_ID"?t.getValueOfInt(o):t.getValueOfInt(i.getContextAsInt(r,"C_Charge_ID")),this.log.fine("Product="+l+", C_Charge_ID="+a),l==0&&a==0)||(c=0,c=y=="C_BPartner_Location_ID"?t.getValueOfInt(o):t.getValueOfInt(i.getContextAsInt(r,"C_BPartner_Location_ID")),c==0))return this.setCalloutActive(!1),this.Amt(i,r,f,e,o);this.log.fine("Ship BP_Location="+c);b=i.getContext("DateOrdered");this.log.fine("Bill Date="+b);k=i.getContext("DatePromised");this.log.fine("Ship Date="+k);d=i.getContextAsInt(r,"AD_Org_ID");this.log.fine("Org="+d);g=i.getContextAsInt(r,"M_Warehouse_ID");this.log.fine("Warehouse="+g);v=i.getContextAsInt(r,"Bill_Location_ID");v==0&&(v=c);this.log.fine("Bill BP_Location="+v);var ft="Y"==i.getWindowContext(r,"IsSOTrx",!0),tt=l.toString()+","+a.toString()+","+b.toString()+","+k.toString()+","+d.toString()+","+g.toString()+","+v.toString()+","+c.toString()+","+ft.toString(),p=n.dataContext.getJSONRecord("MTax/Get_Tax_ID",tt);this.log.info("Tax ID="+p);p==0||(f.setValue("C_Tax_ID",t.getValueOfInt(p)),f.findColumn("C_TaxExemptReason_ID")>-1&&f.findColumn("IsTaxExempt")>-1&&(h=n.dataContext.getJSONRecord("MTax/GetTaxExempt",p),h!=null&&(f.setValue("C_TaxExemptReason_ID",t.getValueOfInt(h.C_TaxExemptReason_ID)),f.setValue("IsTaxExempt",t.getValueOfString(h.IsTaxExempt).equals("Y")?!0:!1))));u&&this.log.warning("fini")}else if(w=t.getValueOfInt(h.taxId),t.getValueOfInt(w)>0)f.setValue("C_Tax_ID",w),f.findColumn("C_TaxExemptReason_ID")>-1&&f.findColumn("IsTaxExempt")>-1&&(f.setValue("C_TaxExemptReason_ID",t.getValueOfInt(h.C_TaxExemptReason_ID)),f.setValue("IsTaxExempt",t.getValueOfString(h.IsTaxExempt).equals("Y")?!0:!1));else{if(t.getValueOfInt(f.getValue("M_Product_ID"))>0)return f.setValue("M_Product_ID",""),this.setCalloutActive(!1),h.TaxExempt=="Y"?n.ADialog.info("TaxNoExemptFound"):n.ADialog.info("VATAX_DefineTax");if(t.getValueOfInt(f.getValue("C_Charge_ID"))>0)return f.setValue("C_Charge_ID",""),this.setCalloutActive(!1),h.TaxExempt=="Y"?n.ADialog.info("TaxNoExemptFound"):n.ADialog.info("VATAX_DefineChargeTax")}}catch(et){return this.setCalloutActive(!1),et}return this.setCalloutActive(!1),s=null,this.Amt(i,r,f,e,o)};r.prototype.Amt=function(i,r,f,e,o,s){var w,v,d,it,h,c,b,l,a,lt,et,at,nt,ot,rt,vt,y,st,tt,ht;if(this.isCalloutActive()||o==null||o.toString()==""||(console.log("Before Charge Or Product"),t.getValueOfInt(f.getValue("C_Charge_ID"))==0&&t.getValueOfInt(f.getValue("M_Product_ID"))==0))return"";console.log("After Charge Or Product");this.setCalloutActive(!0);try{u&&this.log.Warning("init");var yt=i.getContextAsInt(r,"C_UOM_ID"),pt=i.getContextAsInt(r,"M_Product_ID"),wt=i.getContextAsInt(r,"M_PriceList_ID"),bt=i.getWindowContext(r,"IsSOTrx",!0)=="Y",g=t.getValueOfInt(f.getValue("C_OrderLine_Blanket_ID"))>0?!0:!1,ct=t.getValueOfInt(f.getValue("C_Quotation_Line_ID"))>0?!0:!1;ct&&(g=ct);w=t.getValueOfDecimal(f.getValue("QtyDelivered"))>0?!0:!1;w||(w=t.getValueOfDecimal(f.getValue("QtyInvoiced"))>0?!0:!1);v=n.dataContext.getJSONRecord("MPriceList/GetPriceList",wt.toString());var k=2,p=2,ut="Y",ft="N";if(v!=null&&(k=t.getValueOfInt(v.StdPrecision),p=t.getValueOfInt(v.PriceListPrecision),ut=t.getValueOfString(v.EnforcePriceLimit),ft=t.getValueOfString(v.IsTaxIncluded)),d=t.getValueOfDecimal(f.getValue("QtyEntered")),it=t.getValueOfDecimal(f.getValue("QtyOrdered")),this.log.fine("QtyEntered="+d+", Ordered="+it+", UOM="+yt),h=t.getValueOfDecimal(f.getValue("PriceEntered")),c=t.getValueOfDecimal(f.getValue("PriceActual")),l=t.getValueOfDecimal(f.getValue("Discount")),b=t.getValueOfDecimal(f.getValue("PriceLimit")),a=t.getValueOfDecimal(f.getValue("PriceList")),this.log.fine("PriceList="+a+", Limit="+b+", Precision="+p),this.log.fine("PriceEntered="+h+", Actual="+c+", Discount="+l),et=i.getContextAsInt(r,"C_BPartner_ID",!1),e.getColumnName()=="QtyEntered"&&t.getValueOfInt(f.getValue("Orig_OrderLine_ID"))<=0,e.getColumnName()!="QtyOrdered"&&e.getColumnName()!="QtyEntered"&&e.getColumnName()!="M_Product_ID"||"N"==i.getContext("DiscountSchema")?e.getColumnName()=="PriceActual"?(c=t.getValueOfDecimal(o.toFixed(p)),h=c,this.log.fine("PriceActual="+c+" -> PriceEntered="+h),f.setValue("PriceEntered",h),f.setValue("PriceActual",c)):e.getColumnName()=="PriceEntered"&&(h=t.getValueOfDecimal(o.toFixed(p)),c=h,this.log.fine("PriceEntered="+h+" -> PriceActual="+c),f.setValue("PriceActual",c),f.setValue("PriceEntered",h)):(it==null&&(it=d),t.getValueOfInt(f.getValue("Orig_OrderLine_ID"))<=0&&(et=i.getContextAsInt(r,"C_BPartner_ID",!1),g||w||(at=pt.toString().concat(",",f.getValue("C_Order_ID").toString()+","+t.getValueOfString(f.getValue("M_AttributeSetInstance_ID"))+","+t.getValueOfString(f.getValue("C_UOM_ID"))+","+i.getAD_Client_ID().toString()+","+et.toString()+","+f.getValue("QtyEntered").toString()+",1,1"),nt=n.dataContext.getJSONRecord("MOrderLine/GetPricesOnChange",at),lt=t.getValueOfString(nt.DiscountSchema),(e.getColumnName()=="M_Product_ID"||t.getValueOfDecimal(nt.PriceList)!=0&&f.getValue("PriceList")==0)&&(a=t.getValueOfDecimal(nt.PriceList),f.setValue("PriceList",t.getValueOfDecimal(nt.PriceList)),h=t.getValueOfDecimal(nt.PriceEntered))),this.log.fine("QtyChanged -> PriceActual="+h+", PriceEntered="+h+", Discount="+l),c=t.getValueOfDecimal(h.toFixed(p)),g||w||e.getColumnName()!="M_Product_ID"&&(h==0||f.getValue("PriceEntered")!=0)||(f.setValue("PriceActual",h),c=h,f.setValue("Discount",(t.getValueOfDecimal(f.getValue("PriceList"))-h)/t.getValueOfDecimal(f.getValue("PriceList"))*100)),f.setValue("PriceEntered",h),i.setContext(r,"DiscountSchema",lt))),e.getColumnName()=="Discount")c=t.getValueOfDecimal((100-l)/100*a),t.scale(c)>p&&(c=c.toFixed(p)),h=c,h==null&&(h=c),f.setValue("PriceActual",c),f.setValue("PriceEntered",h);else{if(a==0)l=n.Env.ZERO;else if(l=t.getValueOfDecimal((a-c)/a*100),isNaN(l))return this.setCalloutActive(!1),"PriceListNotSelected";l=t.getValueOfDecimal(l.toFixed(p));f.setValue("PriceList",t.getValueOfDecimal(a.toFixed(p)));g||w||f.setValue("Discount",l)}if(this.log.fine("PriceEntered="+h+", Actual="+c+", Discount="+l),ot=!1,rt=bt&&ut!=null&&ut=="Y",ot=n.MRole.getDefault().getIsOverwritePriceLimit(),vt="Y"==i.getWindowContext(r,"IsReturnTrx",!0),rt&&(ot||vt)&&(rt=!1),rt&&b!=0&&c.compareTo(b)<0&&(c=b,h=c,h==null&&(h=b),this.log.fine("(under) PriceEntered="+h+", Actual"+b),g||w||(f.setValue("PriceActual",b),f.setValue("PriceEntered",h)),n.ADialog.info("UnderLimitPrice",!0,"",""),a!=0&&(l=t.getValueOfDecimal((a-c)/a*100),l=l.toFixed(2),g||w||f.setValue("Discount",l))),h=t.getValueOfDecimal(f.getValue("PriceEntered")),y=d*h,d>0&&y==0&&(st=t.getValueOfDecimal(f.getValue("C_OrderLine_Blanket_ID")),st>0&&(v=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",st.toString()),v!=null))){var a=t.getValueOfDouble(v.PriceList),c=t.getValueOfDouble(v.PriceActual),h=t.getValueOfDouble(v.PriceEntered),l=t.getValueOfDouble(v.Discount);h!=null&&(f.setValue("PriceEntered",h),f.setValue("LineNetAmt",h*d),y=h*d);a!=null&&f.setValue("PriceList",a);l!=null&&f.setValue("Discount",l);c!=null&&f.setValue("PriceActual",c)}if(t.scale(y)>k&&(y=t.getValueOfDecimal(y.toFixed(k))),this.log.info("LineNetAmt="+y),f.setValue("LineNetAmt",y),tt=n.Env.ZERO,e.getColumnName()=="TaxAmt")tt=f.getValue("TaxAmt");else if(ht=f.getValue("C_Tax_ID"),ht!=null){var kt=ht,dt=kt.toString().concat(",",y.toString(),",",ft=="Y",",",k.toString()),v=null;tt=n.dataContext.getJSONRecord("MTax/CalculateTax",dt);f.setValue("TaxAmt",tt);f.getField("SurchargeAmt")!=null&&f.setValue("SurchargeAmt",0)}ft=="Y"?f.setValue("LineTotalAmt",t.getValueOfDecimal(y.toFixed(k))):f.setValue("LineTotalAmt",t.getValueOfDecimal(y.toFixed(k))+t.getValueOfDecimal(tt.toFixed(k)))}catch(gt){return this.setCalloutActive(!1),gt}return this.setCalloutActive(!1),i=r=f=e=o=s=null,""};r.prototype.IsTaxIncluded=function(t,i){var r=i.getContext("IsTaxIncluded"),u;try{if(r.toString().length==0){if(u=i.getContextAsInt(t,"M_PriceList_ID"),u==0)return!1;r=n.dataContext.getJSONRecord("MPriceList/GetTaxIncluded",u.toString());r==null&&(r="N");i.setContext(t,"IsTaxIncluded",r)}}catch(f){this.setCalloutActive(!1);this.log.severe(f.toString())}return i=t=mTab=mField=value=oldValue=null,"Y"==r};r.prototype.Qty=function(i,r,f,e,o,s){var l="",a,ot,st,p,nt,y,ht,ct,w,it,v,at,d,g,rt,vt;if(this.isCalloutActive()||o==null||o.toString()==""||(console.log("Before Charge Or Product"),t.getValueOfInt(f.getValue("C_Charge_ID"))==0&&t.getValueOfInt(f.getValue("M_Product_ID"))==0))return"";console.log("After Charge Or Product");this.setCalloutActive(!0);try{a=i.getContextAsInt(r,"M_Product_ID");u&&this.log.Warning("init - M_Product_ID="+a+" - ");var h=n.Env.ZERO,c=n.Env.ZERO,gt=n.Env.ZERO,ut="Y"==i.getContext("IsReturnTrx"),ft=t.getValueOfInt(f.getValue("C_OrderLine_Blanket_ID"))>0?!0:!1,et=t.getValueOfInt(f.getValue("C_Quotation_Line_ID"))>0?!0:!1;if(et&&(ft=et),ot=i.getContextAsInt(r,"C_BPartner_ID",!1),a==0)c=t.getValueOfDecimal(f.getValue("QtyEntered")),h=c,f.setValue("QtyOrdered",h);else if(e.getColumnName()=="C_UOM_ID"||e.getColumnName()=="M_AttributeSetInstance_ID"||e.getColumnName()=="StartDate")v=t.getValueOfInt(f.getValue("C_UOM_ID")),c=t.getValueOfDecimal(f.getValue("QtyEntered")),st=a.toString().concat(",",f.getValue("C_Order_ID").toString()+","+t.getValueOfString(f.getValue("M_AttributeSetInstance_ID"))+","+t.getValueOfString(f.getValue("C_UOM_ID"))+","+i.getAD_Client_ID().toString()+","+t.getValueOfString(ot)+","+c.toString()+",1,1"),p=n.dataContext.getJSONRecord("MOrderLine/GetPricesOnChange",st),ft||(f.setValue("PriceList",t.getValueOfDecimal(p.PriceList)),f.setValue("PriceLimit",t.getValueOfDecimal(p.PriceLimit)),f.setValue("PriceActual",t.getValueOfDecimal(p.PriceEntered)),f.setValue("PriceEntered",t.getValueOfDecimal(p.PriceEntered))),y=c.toFixed(t.getValueOfInt(p.UOMPrecision)),c!=y&&(this.log.fine("Corrected QtyEntered Scale UOM="+v+"; QtyEntered="+c+"->"+y),c=y,f.setValue("QtyEntered",c)),h=p.QtyOrdered,h==null&&(h=c),f.setValue("QtyOrdered",h);else if(e.getColumnName()=="QtyEntered")v=i.getContextAsInt(r,"C_UOM_ID"),c=t.getValueOfDecimal(o),l=v.toString().concat(","),nt=n.dataContext.getJSONRecord("MUOM/GetPrecision",l),y=c.toFixed(t.getValueOfInt(nt)),c!=y&&(this.log.fine("Corrected QtyEntered Scale UOM="+v+"; QtyEntered="+c+"->"+y),c=y,f.setValue("QtyEntered",c)),l=a.toString().concat(",",v.toString(),",",c.toString()),ht=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",l),h=ht,h==null&&(h=c),w=c!=h,this.log.fine("UOM="+v+", QtyEntered="+c+" -> "+w+" QtyOrdered="+h),i.setContext(r,"UOMConversion",w?"Y":"N"),f.setValue("QtyOrdered",h);else if(e.getColumnName()=="QtyOrdered"){v=i.getContextAsInt(r,"C_UOM_ID");h=t.getValueOfDecimal(o);l=a.toString().concat(",");var nt=n.dataContext.getJSONRecord("MProduct/GetUOMPrecision",l),yt=nt,tt=h.toFixed(yt);h!=tt&&(this.log.fine("Corrected QtyOrdered Scale "+h+"->"+tt),h=tt,f.setValue("QtyOrdered",h));l=a.toString().concat(",",v.toString(),",",h.toString());ct=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",l);c=ct;c==null&&(c=h);w=h!=c;this.log.fine("UOM="+v+", QtyOrdered="+h+" -> "+w+" QtyEntered="+c);i.setContext(r,"UOMConversion",w?"Y":"N");f.setValue("QtyEntered",c)}else h=t.getValueOfDecimal(f.getValue("QtyOrdered"));if(a!=0&&ut&&(it=t.getValueOfInt(f.getValue("Orig_InOutLine_ID")),it!=0)){l=it.toString();var lt=n.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",l),pt=lt.MovementQty,k=t.getValueOfDecimal(pt);h=t.getValueOfDecimal(f.getValue("QtyOrdered"));k<h&&(i.isSOTrx()?n.ADialog.info("QtyShippedAndReturned",null,k.toString(),""):n.ADialog.info("QtyRecievedAndReturnd",null,k.toString(),""),f.setValue("QtyOrdered",k),h=k,v=i.getContextAsInt(r,"C_UOM_ID"),l=a.toString().concat(",",v.toString(),",",h.toString()),c=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",l),c==null&&(c=h),f.setValue("QtyEntered",c),this.log.fine("QtyEntered : "+c.toString()+"QtyOrdered : "+h.toString()))}if(a!=0&&i.isSOTrx()&&h>0&&!ut&&(at=n.dataContext.getJSONRecord("MProduct/GetProduct",a.toString()),d=0,t.getValueOfBoolean(at.IsStocked))){var wt=i.getContextAsInt(r,"M_Warehouse_ID"),bt=i.getContextAsInt(r,"M_AttributeSetInstance_ID"),kt=a.toString().concat(",",wt.toString(),",",bt.toString(),",",d.toString()),lt=null,b=n.dataContext.getJSONRecord("MStorage/GetQtyAvailable",kt);b==null&&(b=n.Env.ZERO);b==0||b.toString().compareTo(h)<0||(d=f.getValue("C_OrderLine_ID")==""?0:t.getValueOfInt(f.getValue("C_OrderLine_ID")),d==null&&(d=0),g=lt.notReserved,g==null&&(g=n.Env.ZERO),rt=b-g,rt<h&&(vt=n.Msg.parseTranslation(i,"@QtyAvailable@="+b+"  -  @QtyNotReserved@="+g+"  =  "+rt),n.ADialog.info("InsufficientQtyAvailable",null,vt,"")))}}catch(dt){return this.setCalloutActive(!1),dt}return this.setCalloutActive(!1),i=r=f=e=o=s=null,""};r.prototype.Orig_Order=function(i,r,u,f,e,o){var h,s,l,y,a,p,v,c;if(this.isCalloutActive()||e==null||e.toString()==""||(h=t.getValueOfInt(e),h==null||h==0))return"";this.setCalloutActive(!0);try{s=n.dataContext.getJSONRecord("MOrder/GetOrder",h.toString());l=n.dataContext.getJSONRecord("MBPartner/GetBPartner",s.C_BPartner_ID.toString());u.setValue("Orig_InOut_ID",null);u.setValue("C_BPartner_ID",t.getValueOfInt(s.C_BPartner_ID));u.setValue("C_BPartner_Location_ID",t.getValueOfInt(s.C_BPartner_Location_ID));u.setValue("Bill_BPartner_ID",t.getValueOfInt(s.Bill_BPartner_ID));u.setValue("Bill_Location_ID",t.getValueOfInt(s.Bill_Location_ID));s.AD_User_ID!=0&&u.setValue("AD_User_ID",t.getValueOfInt(s.AD_User_ID));s.Bill_User_ID!=0&&u.setValue("Bill_User_ID",t.getValueOfInt(s.Bill_User_ID));i.isSOTrx()?u.setValue("M_ReturnPolicy_ID",t.getValueOfInt(l.M_ReturnPolicy_ID)):u.setValue("M_ReturnPolicy_ID",t.getValueOfInt(l.PO_ReturnPolicy_ID));!0&&(this.setCalloutActive(!1),u.setValue("M_PriceList_ID",t.getValueOfInt(s.M_PriceList_ID)),this.setCalloutActive(!0));u.setValue("PaymentRule",s.PaymentRule);y=this.checkAdvancePaymentTerm(t.getValueOfInt(u.getValue("C_DocTypeTarget_ID")),t.getValueOfInt(s.C_PaymentTerm_ID));y?u.setValue("C_PaymentTerm_ID",t.getValueOfInt(s.C_PaymentTerm_ID)):u.setValue("C_PaymentTerm_ID",null);u.setValue("Bill_Location_ID",t.getValueOfInt(s.Bill_Location_ID));u.setValue("InvoiceRule",s.InvoiceRule);u.setValue("PaymentRule",s.PaymentRule);u.setValue("DeliveryViaRule",s.DeliveryViaRule);u.setValue("FreightCostRule",s.FreightCostRule);a=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_");a.VA009_&&(p=a.VA009_.toString()+","+h.toString(),dr=n.dataContext.getJSONRecord("MOrder/GetPaymentMethod",p),dr!=null&&(v=t.getValueOfInt(dr.VA009_PaymentMethod_ID),v>0&&(u.setValue("VA009_PaymentMethod_ID",v),c=t.getValueOfString(dr.VA009_PaymentBaseType),c!="W"&&c!=null&&(u.setValue("PaymentMethod",c),u.setValue("PaymentRule",c)))))}catch(w){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};r.prototype.Orig_InOut=function(i,r,u,f,e,o){var h,s;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(h=t.getValueOfInt(e),h==null||h==0)return"";this.setCalloutActive(!0);s=n.dataContext.getJSONRecord("MInOut/GetInOut",h.toString());u.setValue("C_Project_ID",t.getValueOfInt(s.C_Project_ID));u.setValue("C_Campaign_ID",t.getValueOfInt(s.C_Campaign_ID));u.setValue("C_Activity_ID",t.getValueOfInt(s.C_Activity_ID));u.setValue("AD_OrgTrx_ID",t.getValueOfInt(s.AD_OrgTrx_ID));u.setValue("User1_ID",t.getValueOfInt(s.User1_ID));u.setValue("User2_ID",t.getValueOfInt(s.User2_ID));t.getValueOfString(s.IsDropShip)=="Y"?(u.setValue("M_Warehouse_ID",t.getValueOfInt(s.M_Warehouse_ID)),u.setValue("IsDropShip",!0)):(u.setValue("IsDropShip",!1),u.setValue("M_Warehouse_ID",null))}catch(c){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};r.prototype.Orig_OrderLine=function(i,r,u,f,e,o){var c,s,a,v,l,y,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(c=t.getValueOfInt(e),c==null||c==0)return"";this.setCalloutActive(!0);s=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",c.toString());u.setValue("Orig_InOutLine_ID",null);u.setValue("C_Tax_ID",t.getValueOfInt(s.C_Tax_ID));u.setValue("PriceList",t.getValueOfDecimal(s.PriceList));u.setValue("PriceLimit",t.getValueOfDecimal(s.PriceLimit));u.setValue("PriceActual",t.getValueOfDecimal(s.PriceActual));u.setValue("PriceEntered",t.getValueOfDecimal(s.PriceEntered));u.setValue("C_Currency_ID",t.getValueOfInt(s.C_Currency_ID));u.setValue("Discount",t.getValueOfDecimal(s.Discount));a=i.getContextAsInt(r,"M_PriceList_ID");v=n.dataContext.getJSONRecord("MPriceList/GetPriceList",a.toString());l=t.getValueOfInt(v.StdPrecision);y=t.getValueOfDecimal(u.getValue("QtyOrdered"));h=y*t.getValueOfDecimal(s.PriceActual);t.scale(h)>l&&(h=h.toFixed(l));this.log.info("LineNetAmt="+h);u.setValue("LineNetAmt",h)}catch(p){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};r.prototype.Orig_InOutLine=function(i,r,u,f,e,o){var h,s,c;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(h=t.getValueOfInt(e),h==null||h==0)return"";if(this.setCalloutActive(!0),s=n.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",h.toString()),s!=null){u.setValue("C_Project_ID",t.getValueOfInt(s.C_Project_ID));u.setValue("C_Campaign_ID",t.getValueOfInt(s.C_Campaign_ID));u.setValue("M_Product_ID",t.getValueOfInt(s.M_Product_ID));u.setValue("M_AttributeSetInstance_ID",t.getValueOfInt(s.M_AttributeSetInstance_ID));u.setValue("C_UOM_ID",t.getValueOfInt(s.C_UOM_ID));c=t.getValueOfDecimal(s.QtyEntered);u.setValue("QtyEntered",c);var a=s.M_Product_ID.toString().concat(",",s.C_UOM_ID.toString(),",",c.toString()),v=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",a),l=v;l==null&&(l=c);u.setValue("QtyOrdered",l);t.getValueOfString(s.IsDropShip)=="Y"?(u.setValue("IsDropShip",!0),i.setContext(r,"IsDropShip",t.getValueOfString(s.IsDropShip))):u.setValue("IsDropShip",!1)}}catch(y){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};r.prototype.checkAdvancePaymentTerm=function(i,r){var u=!0,f=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),e;return f!=null&&!f.VA009_?u:(t.getValueOfInt(i)!=0&&t.getValueOfInt(r)!=0&&(e=i.toString()+","+r.toString(),u=n.dataContext.getJSONRecord("MOrder/checkAdvancePaymentTerm",e)),u)};n.Model.CalloutOrder=r;n.Utility.inheritPrototype(ci,n.CalloutEngine);ci.prototype.UOM=function(i,r,u,f,e,o){var c,s,v,a,l,h;if(e==0||e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";this.setCalloutActive(!0);try{if(c=t.getValueOfDecimal(u.getValue("M_Product_ID")),c==0)return QtyEntered=1,QtyOrdered=QtyEntered,u.setValue("QtyOrdered",QtyOrdered),u.setValue("QtyEntered",QtyEntered),this.setCalloutActive(!1),i=r=u=f=e=o=null,"";f.getColumnName()=="C_UOM_ID"?(s=t.getValueOfInt(e),QtyEntered=t.getValueOfDecimal(u.getValue("QtyEntered")),c=t.getValueOfInt(u.getValue("M_Product_ID")),paramStr=c.toString().concat(",").concat(s.toString()).concat(",").concat(QtyEntered.toString()),l=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),QtyOrdered=l,h=!1,QtyOrdered!=null&&(h=QtyEntered!=QtyOrdered),QtyOrdered==null&&(h=!1,QtyOrdered=1),h?u.setValue("MovementQty",QtyOrdered):u.setValue("MovementQty",QtyOrdered*QtyEntered)):f.getColumnName()=="QtyEntered"&&(s=i.getContextAsInt(r,"C_UOM_ID"),QtyEntered=t.getValueOfDecimal(e),paramStr=s.toString().concat(","),v=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),a=QtyEntered.toFixed(t.getValueOfInt(v)),QtyEntered!=a&&(this.log.fine("Corrected QtyEntered Scale UOM="+s+"; QtyEntered="+QtyEntered+"->"+a),QtyEntered=a,u.setValue("QtyEntered",QtyEntered)),paramStr=c.toString().concat(",",s.toString(),",",QtyEntered.toString()),l=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),QtyOrdered=l,QtyOrdered==null&&(QtyOrdered=QtyEntered),h=QtyEntered!=QtyOrdered,this.log.fine("UOM="+s+", QtyEntered="+QtyEntered+" -> "+h+" QtyOrdered="+QtyOrdered),i.setContext(r,"UOMConversion",h?"Y":"N"),u.setValue("MovementQty",QtyOrdered))}catch(y){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutInventoryMove=ci;n.Utility.inheritPrototype(li,n.CalloutEngine);li.prototype.Product=function(r,u,f,e,o,s){var c,v;if(o==null||o.toString()==""||this.isCalloutActive()||o==null||(c=t.getValueOfInt(o),c==0))return"";this.setCalloutActive(!0);var l=0,a=null,y=null,p=null,w="SELECT p.M_Product_ID, ra.Name, ra.Description, ra.Qty FROM S_ResourceAssignment ra INNER JOIN M_Product p ON (p.S_Resource_ID=ra.S_Resource_ID) WHERE ra.S_ResourceAssignment_ID="+c,h=null;try{h=n.DB.executeReader(w,null,null);h.read()&&(l=t.getValueOfInt(h.get(0)),a=t.getValueOfString(h.get(1)),y=t.getValueOfString(h.get(2)),p=t.getValueOfDecimal(h.get(3)));h.close()}catch(b){h!=null&&(h.close(),h=null);this.setCalloutActive(!1);this.log.log(i.SEVERE,"product",b)}return this.log.fine("S_ResourceAssignment_ID="+c+" - M_Product_ID="+l),l!=0&&(f.setValue("M_Product_ID",t.getValueOfInt(l)),y!=null&&(a+=" ("+y+")"),"."!=a&&f.setValue("Description",a),v="Qty",f.getTableName().startsWith("C_Order")?v="QtyOrdered":f.getTableName().startsWith("C_Invoice")&&(v="QtyInvoiced"),p!=null&&f.setValue(v,p)),this.setCalloutActive(!1),r=u=f=e=o=s=null,""};n.Model.CalloutAssignment=li;n.Utility.inheritPrototype(a,n.CalloutEngine);a.prototype.Invoice=function(r,u,f,e,o,s){var l,v,g,d;if(this.isCalloutActive())return"";if(o==null||o.toString()=="")return e.getColumnName()=="C_Invoice_ID"&&(this.setCalloutActive(!0),f.setValue("C_BPartner_ID",null),f.setValue("C_BPartner_Location_ID",null),f.setValue("C_InvoicePaySchedule_ID",null),r.setContext(u,"InvTotalAmt",""),r.setContext("InvTotalAmt",""),f.setValue("ConvertedAmt",n.Env.ZERO),f.setValue("Amount",n.Env.ZERO),f.setValue("DiscountAmt",n.Env.ZERO),f.setValue("WriteOffAmt",n.Env.ZERO),f.setValue("OverUnderAmt",n.Env.ZERO),this.setCalloutActive(!1)),"";this.setCalloutActive(!0);var a=t.getValueOfInt(o),p=0,w=0,b=0,c=null;try{c=n.dataContext.getJSONRecord("MInvoice/GetInvPaySchedDetail",a.toString());c!=null&&(w=t.getValueOfInt(c.C_InvoicePaySchedule_ID),f.setValue("C_InvoicePaySchedule_ID",w),p=t.getValueOfDecimal(c.dueAmount),b=1)}catch(y){return c!=null&&(c=null),this.log.log(i.SEVERE,"CalloutCashJournal.Invoice -"+a,y.message),y.toString()}if(a==null||a==0)return f.setValue("C_Currency_ID",null),this.setCalloutActive(!1),"";var k=new Date(r.getContext(u,"DateAcct")),nt="TO_DATE( '"+(Number(k.getMonth())+1)+"-"+k.getDate()+"-"+k.getFullYear()+"', 'MM-DD-YYYY')",tt=a.toString()+","+nt.toString()+","+w.toString(),h=null;try{h=n.dataContext.getJSONRecord("MInvoice/GetInvoiceDetails",tt);h!=null&&(l=0,f.setValue("C_BPartner_ID",t.getValueOfInt(h.C_BPartner_ID)),f.setValue("C_Currency_ID",t.getValueOfInt(h.C_Currency_ID)),f.setValue("C_ConversionType_ID",t.getValueOfInt(h.C_ConversionType_ID)),f.setValue("C_BPartner_Location_ID",t.getValueOfInt(h.C_BPartner_Location_ID)),l=b==0?t.getValueOfDecimal(h.invoiceOpen):p,v=t.getValueOfDecimal(h.paymentTermDiscount),g="Y"==h.IsSOTrx,g||(l=b==0?l*-1:p*-1,v=v*-1),d=t.getValueOfString(h.docbaseType),"ARC"==d||"API"==d?f.setValue("VSS_PAYMENTTYPE","P"):f.setValue("VSS_PAYMENTTYPE","R"),r.setContext("InvTotalAmt",l.toString()),f.setValue("Amount",l-v),f.setValue("DiscountAmt",v),f.setValue("WriteOffAmt",n.Env.ZERO))}catch(y){return idr!=null&&(idr.close(),idr=null),this.log.log(i.SEVERE,"invoice",y),this.setCalloutActive(!1),y.toString()}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};a.prototype.SetAmount=function(i,r,u,f,e){var l,y,p,o,w,a,v,s,c,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";if(this.setCalloutActive(!0),e==null||e.toString()=="")return t.getValueOfInt(u.getValue("C_Invoice_ID"))>0?(l=t.getValueOfDecimal(n.dataContext.getJSONRecord("MCashBook/GetPaySheduleAmt",u.getValue("C_Invoice_ID").toString())),i.setContext(r,"InvTotalAmt",l.toString()),u.setValue("Amount",l),this.setCalloutActive(!1),""):"";if(u.setValue("DiscountAmt",n.Env.ZERO),u.setValue("WriteOffAmt",n.Env.ZERO),u.setValue("OverUnderAmt",n.Env.ZERO),y=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),y.VA009_){if(i.setContext("InvTotalAmt",""),s=t.getValueOfInt(e),s==null||s==0)return i.setContext(r,"InvTotalAmt",null),u.getTableName()=="C_Payment"?(u.setValue("PayAmt",null),u.setValue("PaymentAmount",null)):u.setValue("Amount",null),u.setValue("DiscountAmt",0),u.setValue("WriteOffAmt",n.Env.ZERO),i.setContext("InvTotalAmt",0),this.setCalloutActive(!1),"";p=s.toString()+","+u.getValue("C_Cash_ID")+","+u.getValue("C_Invoice_ID");o=n.dataContext.getJSONRecord("MCashBook/GetPaySheduleData",p);o!=null&&(u.getTableName()=="C_Payment"?(w=o.IsReturnTrx,w=="Y"?(u.setValue("PayAmt",t.getValueOfDecimal(o.DueAmt)*-1),u.setValue("PaymentAmount",t.getValueOfDecimal(o.DueAmt)*-1)):(u.setValue("PayAmt",t.getValueOfDecimal(o.DueAmt)),u.setValue("PaymentAmount",t.getValueOfDecimal(o.DueAmt)))):(u.setValue("Amount",t.getValueOfDecimal(o.DueAmt)),i.setContext(r,"InvTotalAmt",t.getValueOfDecimal(u.getValue("Amount"))),u.setValue("WriteOffAmt",0),u.setValue("OverUnderAmt",0),a=t.getValueOfDate(o.accountDate),v=t.getValueOfString(o.isSoTrx),t.getValueOfDate(o.DiscountDate)>=a?(v=="N"?u.setValue("DiscountAmt",-1*t.getValueOfDecimal(o.DiscountAmt)):u.setValue("DiscountAmt",t.getValueOfDecimal(o.DiscountAmt)),u.setValue("Amount",t.getValueOfDecimal(o.DueAmt)-t.getValueOfDecimal(o.DiscountAmt))):t.getValueOfDate(o.DiscountDays2)>=a?(v=="N"?u.setValue("DiscountAmt",-1*t.getValueOfDecimal(o.Discount2)):u.setValue("DiscountAmt",t.getValueOfDecimal(o.Discount2)),u.setValue("Amount",t.getValueOfDecimal(o.DueAmt)-t.getValueOfDecimal(o.Discount2))):u.setValue("DiscountAmt",0)))}else{if(s=t.getValueOfInt(e),s==null||s==0)return i.setContext(r,"InvTotalAmt",null),u.getTableName()=="C_Payment"?(u.setValue("PayAmt",null),u.setValue("PaymentAmount",null)):u.setValue("Amount",null),this.setCalloutActive(!1),"";c=n.dataContext.getJSONRecord("MCashBook/GetInvSchedDueAmt",s.toString());c!=null&&(h=c.DueAmt,u.getTableName()=="C_Payment"?c.IsReturnTrx=="Y"?(u.setValue("PayAmt",h*-1),u.setValue("PaymentAmount",h*-1)):(u.setValue("PayAmt",h),u.setValue("PaymentAmount",h)):(u.setValue("Amount",h),i.setContext(r,"InvTotalAmt",t.getValueOfDecimal(u.getValue("Amount")))))}return this.setCalloutActive(!1),""};a.prototype.Amounts=function(i,r,u,f,e,o){var y,c,p,s,b,nt;if(this.isCalloutActive())return"";if(y=0,c=0,"I"==u.getValue("CashType")){if(y=i.getContext("InvTotalAmt"),(y==null||y.toString().length==0)&&(y=i.getContext(r,"InvTotalAmt")),y==null||y.toString().length==0)return"";c=t.getValueOfDecimal(y)}if(this.setCalloutActive(!0),p=0,s=t.getValueOfDecimal(u.getValue("Amount")),"I"==u.getValue("CashType")){var a=t.getValueOfDecimal(u.getValue("DiscountAmt")),l=t.getValueOfDecimal(u.getValue("WriteOffAmt")),h=t.getValueOfDecimal(u.getValue("OverUnderAmt")),w=f.getColumnName(),v=u.getValue("VSS_PaymentType");v=="P"?(s>0&&(s=s*-1,u.setValue("PayAmt",s)),a>0&&(a=a*-1),l>0&&(l=l*-1,u.setValue("WriteOffAmt",l)),h>0&&(h=h*-1,u.setValue("OverUnderAmt",h)),c>0&&(c=c*-1)):(s<0&&(s=s*-1,u.setValue("PayAmt",s)),a<0&&(a=a*-1),l<0&&(l=l*-1,u.setValue("WriteOffAmt",l)),h<0&&(h=h*-1,u.setValue("OverUnderAmt",h)),c<0&&(c=c*-1));this.log.fine(w+" - Invoice="+c+" - Amount="+s+", Discount="+a+", WriteOff="+l);w=="Amount"?(b=c-s,h=b-a-l,(v=="R"&&h>0||v=="P"&&h<0)&&n.ADialog.info("LessScheduleAmount"),(v=="P"&&h>0||v=="R"&&h<0)&&(n.ADialog.info("MoreScheduleAmount"),s=c-a-l,h=c-s-a-l,u.setValue("PayAmt",s)),u.setValue("DiscountAmt",a),u.setValue("OverUnderAmt",h)):(b=c-a,s=b-l-h,(v=="P"&&s>0||v=="R"&&s<0)&&(n.ADialog.info("MoreScheduleAmount"),w=="OverUnderAmt"&&(s=c-a-l,h=c-s-a-l,u.setValue("OverUnderAmt",h)),w=="DiscountAmt"&&(s=c-h-l,a=c-s-h-l,u.setValue("DiscountAmt",a)),w=="WriteOffAmt"&&(s=c-a-h,l=c-s-a-h,u.setValue("WriteOffAmt",l))),u.setValue("Amount",s),(v=="R"&&h>0||v=="P"&&h<0)&&n.ADialog.info("LessScheduleAmount"))}var k=u.getValue("C_Cash_ID").toString(),d=n.dataContext.getJSONRecord("MCashBook/GetCashJournal",k),it=d.DateAcct,g=d.C_Currency_ID,tt=d.C_Currency_ID;return u.getValue("C_Currency_ID")!=null&&(g=u.getValue("C_Currency_ID").toString()),nt=0,u.getField("C_ConversionType_ID")!=null&&(nt=t.getValueOfInt(u.getValue("C_ConversionType_ID"))),g!=tt?(k=s.toString()+","+g+","+tt+","+it+","+nt.toString()+","+i.getAD_Client_ID().toString()+","+i.getAD_Org_ID().toString(),p=n.dataContext.getJSONRecord("MConversionRate/CurrencyConvert",k),t.getValueOfDecimal(u.getValue("Amount"))!=0&&p==0&&n.ADialog.info("NoCurrencyConversion")):p=s,u.setValue("convertedAmt",p),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};a.prototype.BeginningBalCalc=function(r,u,f,e,o,s){var h;if(o==null||o.toString()==""||this.isCalloutActive())return"";if(this.setCalloutActive(!0),h=t.getValueOfInt(o),h==null||h==0)return f.setValue("BeginningBalance",0),this.setCalloutActive(!1),"";var a=t.getValueOfInt(f.getValue("C_CashBook_ID")),v=t.getValueOfInt(f.getValue("AD_Client_ID")),y=t.getValueOfInt(f.getValue("AD_Org_ID")),w=r.getContext("DateAcct"),p=a.toString()+","+v.toString()+","+y.toString(),c=n.dataContext.getJSONRecord("MCashJournal/GetBeginningBalCalc",p);try{c>0?f.setValue("BeginningBalance",c):f.setValue("BeginningBalance",0);idr.close()}catch(l){return idr!=null&&idr.close(),this.log.log(i.SEVERE,"Beginning balance",l),this.setCalloutActive(!1),l.toString()}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};a.prototype.SetCurrency=function(i,r,u,f,e,o){var s,h,c,w,l,b,p;if((e==null||e.toString()=="")&&f.getColumnName()!="C_ConversionType_ID"||this.isCalloutActive())return"";if(this.setCalloutActive(!0),s="",h=t.getValueOfDecimal(u.getValue("Amount")),f.getColumnName()=="C_CashBook_ID"){if(c=t.getValueOfInt(e),c==null||c==0)return u.setValue("C_Currency_ID",0),this.setCalloutActive(!1),"";s=c.toString();w=n.dataContext.getJSONRecord("MCashBook/GetCashBook",s);u.setValue("C_Currency_ID",w.C_Currency_ID)}else if(f.getColumnName()=="C_BankAccount_ID"){if(l=t.getValueOfInt(e),l==null||l==0)return u.setValue("C_Currency_ID",0),this.setCalloutActive(!1),"";s=l.toString();b=t.getValueOfInt(n.dataContext.getJSONRecord("MPayment/GetBankAcctCurrency",s));u.setValue("C_Currency_ID",b)}if(h!=0){s=u.getValue("C_Cash_ID").toString();var a=0,v=n.dataContext.getJSONRecord("MCashBook/GetCashJournal",s),d=v.DateAcct,y=v.C_Currency_ID,k=v.C_Currency_ID;u.getValue("C_Currency_ID")!=null&&(y=u.getValue("C_Currency_ID").toString());p=0;u.getField("C_ConversionType_ID")!=null&&(p=t.getValueOfInt(u.getValue("C_ConversionType_ID")));y!=k?(s=h.toString()+","+y+","+k+","+d+","+p.toString()+","+i.getAD_Client_ID().toString()+","+i.getAD_Org_ID().toString(),a=n.dataContext.getJSONRecord("MConversionRate/CurrencyConvert",s),a==0&&n.ADialog.info("NoCurrencyConversion")):a=h;u.setValue("convertedAmt",a)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};a.prototype.ConvertedAmt=function(i,r,u,f,e,o){if(e==null||e.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);try{if(e>0){if(t.getValueOfInt(u.getValue("C_ConversionType_ID"))<=0)return u.setValue("C_CashLine_ID_1",""),n.ADialog.info("VIS_SelectConversion"),this.setCalloutActive(!1),"";var h=e.toString()+","+u.getValue("C_Cash_ID").toString()+","+u.getValue("AD_Org_ID").toString()+","+u.getValue("C_ConversionType_ID").toString(),s=n.dataContext.getJSONRecord("MCashJournal/ConvertedAmt",h);if(t.getValueOfInt(s.currTo)==0)return this.setCalloutActive(!1),"";t.getValueOfDecimal(s.amt)!=0&&t.getValueOfDecimal(s.transferdAmt)==0&&n.ADialog.info("NoCurrencyConversion");u.setValue("ConvertedAmt",t.getValueOfDecimal(s.transferdAmt));u.setValue("Amount",t.getValueOfDecimal(s.amt))}else u.setValue("ConvertedAmt",0),u.setValue("Amount",0)}catch(c){this.setCalloutActive(!1)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};a.prototype.GetBeginBal=function(t,i,r,u,f){if(f==null||f==""||this.isCalloutActive())return"";this.setCalloutActive(!0);var e=n.dataContext.getJSONRecord("MCashBook/GetBegiBalance",f.toString());return r.setValue("BeginningBalance",e),this.setCalloutActive(!1),""};n.Model.CalloutCashJournal=a;n.Utility.inheritPrototype(yt,n.CalloutEngine);yt.prototype.FillAttribute=function(i,r,u,f,e){var o,c,l,s,a,h;return this.isCalloutActive()||e==null||e.toString()==""?"":(o=i.getContext(r,"AttrCode"),this.setCalloutActive(!0),o!=null&&o!=""&&(c=n.dataContext.getJSONRecord("MProduct/GetAttributeSet",e.toString()),c>0&&(l=o.toString()+","+e.toString(),s=n.dataContext.getJSONRecord("MProduct/GetProductAttribute",l),s>0?u.setValue("M_AttributeSetInstance_ID",s):o.indexOf("(01)")>=0&&(a=o+","+t.getValueOfInt(e)+","+r,h=n.dataContext.getJSONRecord("MInOut/GetASIID",a),h!=0&&u.setValue("M_AttributeSetInstance_ID",h)))),this.setCalloutActive(!1),"")};yt.prototype.FillUPC=function(i,r,u,f,e){var s="",h=0,o;if(this.isCalloutActive()||e==null||e.toString()=="")return"";if(o=i.getContext(r,"AttrCode"),this.setCalloutActive(!0),t.getValueOfString(o)!=""){if(s="SELECT Count(*) FROM M_Manufacturer WHERE IsActive = 'Y' AND UPC = '"+o+"'",h=t.getValueOfInt(n.DB.executeScalar(s,null,null)),h>0)return this.setCalloutActive(!1),n.Msg.getMsg("Attribute Code Already Exist");u.setValue("UPC",o)}return this.setCalloutActive(!1),""};n.Model.CalloutSetAttributeCode=yt;n.Utility.inheritPrototype(g,n.CalloutEngine);g.prototype.ProductCategory=function(i,r,u,f,e,o){var s,c,h,l;return e==null||e.toString()==""?"":(s=t.getValueOfInt(e),s==null||t.getValueOfInt(s)==0||s==0)?"":(c=t.getValueOfInt(e),h=null,h=n.dataContext.getJSONRecord("MProductCategory/GetProductCategory",c),l=h.IsPurchasedToOrder,u.setValue("IsPurchasedToOrder",l),pc=null,i=r=u=f=e=o=null,"")};g.prototype.UOM=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()==""||r.getValue("M_Product_id")==null)return"";this.setCalloutActive(!0);var o=r.getValue("M_Product_ID").toString(),s=n.dataContext.getJSONRecord("MProduct/GetTransactionCount",o);return s>0&&(n.ADialog.info("Can't change UOM due to Transactions happens based on existing UOM"),r.setValue("C_UOM_ID",e)),this.setCalloutActive(!1),t=i=r=u=f=e=null,""};g.prototype.ResourceGroup=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=t.getValueOfString(f);return o==null||o.length==0?"":("O"==o?r.setValue("BasisType",null):r.setValue("BasisType","I"),n=i=r=u=f=e=null,"")};g.prototype.Organization=function(i,r,u,f,e,o){var h,s,c;return e==null||e.toString()==""?"":(h=t.getValueOfInt(e),h==null)?"":(s=null,s=n.dataContext.getJSONRecord("MLocator/GetLocator",paramString),c=s.Default_Locator_ID,u.setValue("M_Locator_ID",c),i=r=u=f=e=o=null,"")};n.Model.CalloutProduct=g;n.Utility.inheritPrototype(pt,n.CalloutEngine);pt.prototype.Planned=function(i,r,u,f,e,o){var g,a,k,v,w;if(e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";this.setCalloutActive(!0);var y,s,c,h,b=0,p=i.getStdPrecision(),l=p,d=i.getContextAsInt(r,"M_PriceList_Version_ID");return d!=0&&(a=n.dataContext.getJSONRecord("MProject/GetPriceListPrecision",d.toString()),a!=null&&(p=t.getValueOfInt(a.StdPrecision),l=t.getValueOfInt(a.PriceListPrecision)),a=null),g=t.getValueOfInt(u.getValue("C_ProjectTask_ID")),a=n.dataContext.getJSONRecord("MProject/GetProjectDetail",g.toString()),a!=null&&(PriceLimit=t.getValueOfDecimal(a.PriceLimit)),y=t.getValueOfDecimal(u.getValue("PlannedQty")),y==null&&(y=Envs.ONE),s=t.getValueOfDecimal(u.getValue("PlannedPrice")),s=s==null?n.Env.ZERO:s.toFixed(l),c=t.getValueOfDecimal(u.getValue("PriceList")),c=c==null?s:c.toFixed(l),h=t.getValueOfDecimal(u.getValue("Discount")),h=h==null?n.Env.ZERO:h.toFixed(l),k=f.getColumnName(),k=="PlannedPrice"?(c==0?h=n.Env.ZERO:(v=(s*n.Env.ONEHUNDRED/c).toFixed(10),h=n.Env.ONEHUNDRED-v),u.setValue("Discount",h.toFixed(l)),u.setValue("PlannedPrice",s),this.log.fine("PriceList="+c+" - Discount="+h+" -> [PlannedPrice="+s+"] (Precision="+l+")")):k=="PriceList"?(n.Env.signum(c)==0?h=n.Env.ZERO:(v=s*n.Env.ONEHUNDRED/c,h=n.Env.ONEHUNDRED-v),u.setValue("Discount",h.toFixed(l)),u.setValue("PriceList",c),this.log.fine("[PriceList="+c+"] - Discount="+h+" -> PlannedPrice="+s+" (Precision="+l+")")):k=="Discount"&&(v=(h/n.Env.ONEHUNDRED).toFixed(10),v=n.Env.ONE-v,s=c*v,t.scale(s)>l&&(s=s.toFixed(l)),u.setValue("PlannedPrice",s),u.setValue("Discount",h),this.log.fine("PriceList="+c+" - [Discount="+h+"] -> PlannedPrice="+s+" (Precision="+l+")")),w=y*s,t.scale(w)>p&&(w=w.toFixed(p)),y!=null&&(b=(t.getValueOfDecimal(u.getValue("PlannedPrice"))-PriceLimit)*t.getValueOfDecimal(u.getValue("PlannedQty")),b=b.toFixed(p)),this.log.fine("PlannedQty="+y+" * PlannedPrice="+s+" -> PlannedAmt="+w+" (Precision="+p+")"),u.setValue("PlannedAmt",w),u.setValue("PlannedMarginAmt",b),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};pt.prototype.Product=function(i,r,u,f,e,o){var c,l,a,h,p;if(e==null||e.toString()==""||(c=t.getValueOfInt(e),l=i.getContextAsInt(r,"M_PriceList_Version_ID"),c==null||t.getValueOfInt(c)==0||l==0))return"";this.setCalloutActive(!0);var v=i.getContextAsInt(r,"C_BPartner_ID"),y=t.getValueOfDecimal(u.getValue("PlannedQty")),s=t.getValueOfDateTime(u.getValue("PlannedDate"));return s==null?(s=t.getValueOfDateTime(u.getValue("DateContract")),s==null&&(s=t.getValueOfDateTime(u.getValue("DateFinish")),s==null&&(s=new Date)),a=c.toString().concat(",",v.toString(),",",y.toString(),",",isSOTrx,",",M_PriceList_ID.toString(),",",l.toString(),",",s.toString(),",",null),h=null,h=n.dataContext.getJSONRecord("MProductPricing/GetProductPricing",a),p=null,u.setValue("PriceList",h.PriceList),u.setValue("PlannedPrice",h.PriceActual),u.setValue("Discount",h.Discount),u.setValue("PlannedAmt",h.LineAmt),""):(i=r=u=f=e=o=null,"")};n.Model.CalloutProject=pt;n.Utility.inheritPrototype(nt,n.CalloutEngine);nt.prototype.BankAccount=function(t,r,u,f,e,o){if(e==null||e.toString()=="")return"";try{var l=e,h=e.toString(),s;s=n.dataContext.getJSONRecord("MBankStatement/GetCurrentBalance",h);u.setValue("BeginningBalance",s)}catch(c){this.setCalloutActive(!1);this.log.log(i.SEVERE,"",c)}return t=r=u=f=e=o=null,""};nt.prototype.Amount=function(n,t,i,r,u,f){var s,h,o,e,c;return u==null||u.toString()==""?"":this.isCalloutActive()?"":(this.setCalloutActive(!0),s=i.getValue("StmtAmt"),s==null&&(s=0),h=i.getValue("TrxAmt"),h==null&&(h=0),e=i.getValue("ChargeAmt"),e==null&&(e=0),o=s-h,r.getColumnName()=="ChargeAmt"?(e=u,e==null&&(e=0),o=o-e,i.setValue("InterestAmt",o)):(c=i.getValue("InterestAmt"),c==null&&(c=0),o=o-c,i.setValue("ChargeAmt",o)),this.setCalloutActive(!1),n=t=i=r=u=f=null,"")};nt.prototype.Payment=function(t,r,u,f,e,o){var h,c,a,s;if(this.isCalloutActive()||e==null||e.toString()==""||(this.setCalloutActive(!0),h=u.getValue("C_Payment_ID"),h==null||h==0))return u.setValue("StmtAmt",0),u.setValue("TrxAmt",0),u.setValue("ChargeAmt",0),u.setValue("C_BPartner_ID",0),u.setValue("C_Invoice_ID",0),u.findColumn("C_ConversionType_ID")>=0&&u.setValue("C_ConversionType_ID",0),this.setCalloutActive(!1),"";c=u.getValue("StmtAmt");c==null&&(c=0);var y=u.getValue("C_Currency_ID"),l=u.getValue("DateAcct"),p=u.getValue("AD_Org_ID");if(l==null)return u.setValue("C_Payment_ID",0),this.setCalloutActive(!1),"PlzSelectStmtDate";try{if(a=h.toString()+","+y.toString()+","+l+","+p.toString(),s=n.dataContext.getJSONRecord("MBankStatement/GetPayment",a),s!=null&&s.length>0){if(s[0].ConvertedAmt!="")return u.setValue("C_Payment_ID",0),this.setCalloutActive(!1),s[0].ConvertedAmt;u.setValue("TrxAmt",s[0].payAmt);u.setValue("StmtAmt",s[0].payAmt);u.findColumn("C_ConversionType_ID")>=0&&u.setValue("C_ConversionType_ID",s[0].C_ConversionType_ID);u.findColumn("VA009_PaymentMethod_ID")>=0&&u.getValue("VA009_PaymentMethod_ID")>0?u.setValue("VA009_PaymentMethod_ID",s[0].VA009_PaymentMethod_ID):u.findColumn("VA009_PaymentMethod_ID")>=0&&u.setValue("VA009_PaymentMethod_ID",null);u.getValue("EFTCheckNo")==null&&s[0].EFTCheckNo!=null&&u.setValue("EFTCheckNo",s[0].EFTCheckNo);s[0].EFTValutaDate!=null&&u.setValue("EFTValutaDate",s[0].EFTValutaDate);u.findColumn("TenderType")>=0&&s[0].TenderType!=null&&u.setValue("TenderType",s[0].TenderType)}}catch(v){return this.setCalloutActive(!1),this.log.log(i.SEVERE,"BankStmt_Payment",v),v.toString()}return this.setCalloutActive(!1),this.Amount(t,r,u,f,e),t=r=u=f=e=o=null,""};nt.prototype.SetConvertedAmt=function(r,u,f,e,o,s){var h,a,c,v,l;if(this.isCalloutActive()||o==null||o.toString()==""||(h=t.getValueOfInt(f.getValue("C_Payment_ID")),h==0))return"";if(a=f.getValue("C_Currency_ID"),c=f.getValue("DateAcct"),c==null)return"PlzSelectStmtDate";try{v=h.toString()+","+a.toString()+","+c.toString();l=n.dataContext.getJSONRecord("MBankStatement/GetConvertedAmt",v);f.setValue("StmtAmt",l);f.setValue("TrxAmt",l)}catch(y){return this.setCalloutActive(!1),this.log.log(i.SEVERE,"BankStmt_DateAcct",y),y.toString()}return this.Amount(r,u,f,e,o),r=u=f=e=o=s=null,""};n.Model.CalloutBankStatement=nt;n.Utility.inheritPrototype(v,n.CalloutEngine);v.prototype.CalculatePrice=function(n,t,i){return Decimal.Subtract(Decimal.Multiply(n,t),i)};v.prototype.CalculateRebate=function(n,t,i){return Decimal.Multiply(Decimal.Multiply(n,t),Decimal.Multiply(new Decimal(.01),i))};v.prototype.OfferServices=function(i,r,u,f,e,o){var it,ht,kt,st;if(e==null||e.toString()==""||(it=24,ht=t.getValueOfInt(e),ht==null||ht==0))return"";var ct=0,lt=new Decimal(0),at=new Decimal(0),vt=new Decimal(0),s,l,a,v,h,k,d,pt,wt,ut=null;try{for(st=[],st[0]=new n.DB.SqlParam("@FO_SERVICE_ID",ht),ut=n.DB.executeReader("select uom.FO_HOTEL_UOM_ID,s.DESCRIPTION from FO_HOTEL_UOM uom inner join FO_SERVICE s ON(uom.FO_HOTEL_UOM_ID= s.FO_HOTEL_UOM_ID) where s.FO_SERVICE_ID=@FO_SERVICE_ID ",st,null);ut.read();)ct=t.getValueOfInt(ut[0]),u.setValue("AUOM_ID",ct),u.setValue("CG1UOM_ID",ct),u.setValue("CG2UOM_ID",ct),u.setValue("DESCRIPTION",t.getValueOfString(ut[1]));ut.close()}catch(bt){this.setCalloutActive(!1);ut!=null&&ut.close();this.log.severe(bt.toString())}kt="select PRICE,CHILDGROUP1,CHILDGROUP2,UOM1,UOM2 from FO_SERVICE_PRICE_PRICELINE where CREATED=(select max(CREATED) from FO_SERVICE_PRICE_PRICELINE where FO_SERVICE_ID=@FO_SERVICE_ID)";try{for(st=[],st[0]=new n.DB.SqlParam("@FO_SERVICE_ID",ht),ut=n.DB.executeReader(kt,st,null);ut.read();)lt=t.getValueOfDecimal(ut[0]),at=t.getValueOfDecimal(ut[1]),vt=t.getValueOfDecimal(ut[2]),pt=ut[3].toString(),wt=ut[4].toString(),pt.equals("Y")&&(at=Decimal.Multiply(Decimal.Multiply(lt,at),new Decimal(.01))),wt.equals("Y")&&(vt=Decimal.Multiply(Decimal.Multiply(lt,vt),new Decimal(.01))),u.setValue("APRICE",lt),u.setValue("CG1PRICE",at),u.setValue("CG2PRICE",vt);ut.close()}catch(bt){this.setCalloutActive(!1);this.log.severe(bt.toString())}var dt=u.getValue("AUOM_ID").toString(),g=t.getValueOfInt(u.getValue("ANUM")),p=t.getValueOfDecimal(u.getValue("AP0RICE")),b=t.getValueOfDecimal(u.getValue("AREBATE")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1P0RICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),gt=t.getValueOfDateTime(u.getValue("ADATETO")),ni=t.getValueOfDateTime(u.getValue("ADATEFROM")),c=Utility.timeUtil.getDaysBetween(ni,gt),yt=ni.Subtract(gt),ft,rt,ti=c/30,ri=c%30,ii=c/7,ui=c%7;ft=ri==0?ti:ti+1;rt=ui==0?ii:ii+1;var fi=yt.TotalMilliseconds,et=yt.TotalSeconds,ot=yt.TotalMinutes;if(t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(dt)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(rt),p,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(it*c),p,h);l=CalculatePrice(new Decimal(it*c),y,h);a=CalculatePrice(new Decimal(it*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(ot),p,h);l=CalculatePrice(new Decimal(ot),y,h);a=CalculatePrice(new Decimal(ot),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(et),p,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}}else switch(int.Parse(dt)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(rt),p,b);s=CalculatePrice(new Decimal(rt),p,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),w,b);a=CalculatePrice(new Decimal(rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(it*c),p,b);s=CalculatePrice(new Decimal(it*c),p,h);k=CalculateRebate(new Decimal(it*c),y,b);l=CalculatePrice(new Decimal(it*c),y,k);d=CalculateRebate(new Decimal(it*c),w,b);a=CalculatePrice(new Decimal(it*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(ot),p,b);s=CalculatePrice(new Decimal(ot),p,h);k=CalculateRebate(new Decimal(ot),y,b);l=CalculatePrice(new Decimal(ot),y,k);d=CalculateRebate(new Decimal(ot),w,b);a=CalculatePrice(new Decimal(ot),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(et),p,b);s=CalculatePrice(new Decimal(et),p,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),w,b);a=CalculatePrice(new Decimal(et),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};v.prototype.tochkdate=function(i,r,u,f,e,o){var it,s,l,a,h,k,d,v,ct,vt,yt,at,st;if(e==null||e.toString()==""||(it=24,ct=t.getValueOfDateTime(e),ct==null||ct.equals(0)))return"";var ot=t.getValueOfDateTime(e),ht=t.getValueOfDateTime(u.getValue("ADATEFROM")),g=t.getValueOfInt(u.getValue("CG1NUM")),nt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),p=t.getValueOfDecimal(u.getValue("CG2PRICE"));try{if(ot=t.getValueOfDateTime(u.getValue("ADATETO")),vt=Utility.timeUtil.getDaysBetween(ht,ot),vt<=0)yt=Utility.TimeUtil.AddDays(ht,1),u.setValue("ADATETO",yt);else if(ot.compareTo(ht)>0){var lt=ot.Subtract(ht),c=Utility.timeUtil.getDaysBetween(ht,ot),gt=lt.TotalMilliseconds,ft=lt.TotalMinutes,et=lt.TotalMinutes,ut,rt,pt=c/30,bt=c%30,wt=c/7,kt=c%7;ut=bt==0?pt:pt+1;rt=kt==0?wt:wt+1;at=t.getValueOfDateTime(u.getValue("ADATEFROM"));u.setValue("CG1DATETO",ot);u.setValue("CG2DATETO",ot);u.setValue("CG1DATEFROM",at);u.setValue("CG2DATEFROM",at);st=u.getValue("AUOM_ID").toString();(st==""||st.toString().trim().length==0)&&(st="0");var w=t.getValueOfDecimal(u.getValue("APRICE")),tt=t.getValueOfInt(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE"));if(t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(st)){case 1000003:s=w;l=y;a=p;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),w,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ut),w,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(rt),w,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),w,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(it*c),w,h);l=CalculatePrice(new Decimal(it*c),y,h);a=CalculatePrice(new Decimal(it*c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),w,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),w,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(tt*rt),w,h);l=CalculatePrice(new Decimal(g*rt),y,h);a=CalculatePrice(new Decimal(nt*rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(tt*rt),w,h);l=CalculatePrice(new Decimal(g*rt),y,h);a=CalculatePrice(new Decimal(nt*rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(tt*(c+1)),w,h);l=CalculatePrice(new Decimal(g*(c+1)),y,h);a=CalculatePrice(new Decimal(nt*(c+1)),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*tt),w,h);l=CalculatePrice(new Decimal((c+1)*g),y,h);a=CalculatePrice(new Decimal((c+1)*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(it*c*tt),w,h);l=CalculatePrice(new Decimal(it*c*g),y,h);a=CalculatePrice(new Decimal(it*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(it*c*tt),w,h);l=CalculatePrice(new Decimal(it*c*g),y,h);a=CalculatePrice(new Decimal(it*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}}else switch(int.Parse(st)){case 1000003:s=w;l=y;a=p;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),w,b);s=CalculatePrice(new Decimal(c),w,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),p,b);a=CalculatePrice(new Decimal(c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ut),w,b);s=CalculatePrice(new Decimal(ut),w,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),p,b);a=CalculatePrice(new Decimal(ut),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(rt),w,b);s=CalculatePrice(new Decimal(rt),w,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),p,b);a=CalculatePrice(new Decimal(rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),w,b);s=CalculatePrice(new Decimal(c+1),w,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),p,b);a=CalculatePrice(new Decimal(c+1),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(it*c),w,b);s=CalculatePrice(new Decimal(it*c),w,h);k=CalculateRebate(new Decimal(it*c),y,b);l=CalculatePrice(new Decimal(it*c),y,k);d=CalculateRebate(new Decimal(it*c),p,b);a=CalculatePrice(new Decimal(it*c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),w,b);s=CalculatePrice(new Decimal(et),w,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),p,b);a=CalculatePrice(new Decimal(et),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),w,b);s=CalculatePrice(new Decimal(ft),w,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),p,b);a=CalculatePrice(new Decimal(ft),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(tt*rt),w,b);s=CalculatePrice(new Decimal(tt*rt),w,h);k=CalculateRebate(new Decimal(g*rt),y,b);l=CalculatePrice(new Decimal(g*rt),y,k);d=CalculateRebate(new Decimal(nt*rt),p,b);a=CalculatePrice(new Decimal(nt*rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(tt*rt),w,b);s=CalculatePrice(new Decimal(tt*rt),w,h);k=CalculateRebate(new Decimal(g*rt),y,b);l=CalculatePrice(new Decimal(g*rt),y,k);d=CalculateRebate(new Decimal(nt*rt),p,b);a=CalculatePrice(new Decimal(nt*rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal(tt*(c+1)),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal((c+1)*tt),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(it*c*tt),w,b);s=CalculatePrice(new Decimal(it*c*tt),w,h);k=CalculateRebate(new Decimal(it*c*g),y,b);l=CalculatePrice(new Decimal(it*c*g),y,k);d=CalculateRebate(new Decimal(it*c*nt),p,b);a=CalculatePrice(new Decimal(it*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(it*c*tt),w,b);s=CalculatePrice(new Decimal(it*c*tt),w,h);k=CalculateRebate(new Decimal(it*c*g),y,b);l=CalculatePrice(new Decimal(it*c*g),y,k);d=CalculateRebate(new Decimal(it*c*nt),p,b);a=CalculatePrice(new Decimal(it*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}tt==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0));g==0&&u.setValue("CG1TOTAL_AMOUNT",0);nt==0&&u.setValue("CG2TOTAL_AMOUNT",0)}}catch(dt){this.setCalloutActive(!1);this.log.severe(dt.toString())}return i=r=u=f=e=o=null,""};v.prototype.fromchkdate=function(i,r,u,f,e,o){var it,s,l,a,h,k,d,v,ct,vt,at,ht;if(e==null||e.toString()==""||(it=24,ct=t.getValueOfDateTime(e),ct==null||ct.equals(0)))return"";var ot=t.getValueOfDateTime(u.getValue("ADATEFROM")),st=t.getValueOfDateTime(u.getValue("ADATETO")),g=t.getValueOfInt(u.getValue("CG1NUM")),nt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),p=t.getValueOfDecimal(u.getValue("CG2PRICE"));try{if(ot=t.getValueOfDateTime(u.getValue("ADATEFROM")),ot.compareTo(st)>0)u.setValue("CG1DATEFROM",ot),u.setValue("CG2DATEFROM",ot),vt=Utility.timeUtil.addDays(ot,1),u.setValue("ADATETO",vt);else if(st.compareTo(ot)>0){var lt=st.Subtract(ot),c=Utility.timeUtil.getDaysBetween(ot,st),dt=lt.TotalMilliseconds,ft=lt.TotalSeconds,et=lt.TotalMinutes,ut,rt,yt=c/30,wt=c%30,pt=c/7,bt=c%7;ut=wt==0?yt:yt+1;rt=bt==0?pt:pt+1;at=t.getValueOfDateTime(u.getValue("ADATEFROM"));u.setValue("CG1DATETO",st);u.setValue("CG2DATETO",st);u.setValue("CG1DATEFROM",at);u.setValue("CG2DATEFROM",at);ht=u.getValue("AUOM_ID").toString();(ht==""||ht.toString().trim().length==0)&&(ht="0");var w=t.getValueOfDecimal(u.getValue("APRICE")),tt=t.getValueOfInt(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE"));if(t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(ht)){case 1000003:s=w;l=y;a=p;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),w,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ut),w,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(rt),w,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),w,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(it*c),w,h);l=CalculatePrice(new Decimal(it*c),y,h);a=CalculatePrice(new Decimal(it*c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),w,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),w,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(tt*rt),w,h);l=CalculatePrice(new Decimal(g*rt),y,h);a=CalculatePrice(new Decimal(nt*rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(tt*rt),w,h);l=CalculatePrice(new Decimal(g*rt),y,h);a=CalculatePrice(new Decimal(nt*rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(tt*(c+1)),w,h);l=CalculatePrice(new Decimal(g*(c+1)),y,h);a=CalculatePrice(new Decimal(nt*(c+1)),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*tt),w,h);l=CalculatePrice(new Decimal((c+1)*g),y,h);a=CalculatePrice(new Decimal((c+1)*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(it*c*tt),w,h);l=CalculatePrice(new Decimal(it*c*g),y,h);a=CalculatePrice(new Decimal(it*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(it*c*tt),w,h);l=CalculatePrice(new Decimal(it*c*g),y,h);a=CalculatePrice(new Decimal(it*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}}else switch(int.Parse(ht)){case 1000003:s=w;l=y;a=p;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),w,b);s=CalculatePrice(new Decimal(c),w,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),p,b);a=CalculatePrice(new Decimal(c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ut),w,b);s=CalculatePrice(new Decimal(ut),w,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),p,b);a=CalculatePrice(new Decimal(ut),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(rt),w,b);s=CalculatePrice(new Decimal(rt),w,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),p,b);a=CalculatePrice(new Decimal(rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),w,b);s=CalculatePrice(new Decimal(c+1),w,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),p,b);a=CalculatePrice(new Decimal(c+1),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(it*c),w,b);s=CalculatePrice(new Decimal(it*c),w,h);k=CalculateRebate(new Decimal(it*c),y,b);l=CalculatePrice(new Decimal(it*c),y,k);d=CalculateRebate(new Decimal(it*c),p,b);a=CalculatePrice(new Decimal(it*c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),w,b);s=CalculatePrice(new Decimal(et),w,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),p,b);a=CalculatePrice(new Decimal(et),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),w,b);s=CalculatePrice(new Decimal(ft),w,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),p,b);a=CalculatePrice(new Decimal(ft),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(tt*rt),w,b);s=CalculatePrice(new Decimal(tt*rt),w,h);k=CalculateRebate(new Decimal(g*rt),y,b);l=CalculatePrice(new Decimal(g*rt),y,k);d=CalculateRebate(new Decimal(nt*rt),p,b);a=CalculatePrice(new Decimal(nt*rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(tt*rt),w,b);s=CalculatePrice(new Decimal(tt*rt),w,h);k=CalculateRebate(new Decimal(g*rt),y,b);l=CalculatePrice(new Decimal(g*rt),y,k);d=CalculateRebate(new Decimal(nt*rt),p,b);a=CalculatePrice(new Decimal(nt*rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal(tt*(c+1)),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal((c+1)*tt),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(it*c*tt),w,b);s=CalculatePrice(new Decimal(it*c*tt),w,h);k=CalculateRebate(new Decimal(it*c*g),y,b);l=CalculatePrice(new Decimal(it*c*g),y,k);d=CalculateRebate(new Decimal(it*c*nt),p,b);a=CalculatePrice(new Decimal(it*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(it*c*tt),w,b);s=CalculatePrice(new Decimal(it*c*tt),w,h);k=CalculateRebate(new Decimal(it*c*g),y,b);l=CalculatePrice(new Decimal(it*c*g),y,k);d=CalculateRebate(new Decimal(it*c*nt),p,b);a=CalculatePrice(new Decimal(it*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}tt==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0));g==0&&u.setValue("CG1TOTAL_AMOUNT",0);nt==0&&u.setValue("CG2TOTAL_AMOUNT",0)}}catch(kt){this.setCalloutActive(!1);this.log.severe(kt.toString())}return i=r=u=f=e=o=null,""};v.prototype.UOMSelected=function(i,r,u,f,e,o){var it,s,l,a,h,k,d,v,ot;if(e==null||e.toString()==""||(it=24,ot=t.getValueOfInt(e),ot=t.getValueOfInt(u.getValue("AUOM_ID")),ot==null))return"";u.setValue("CG1UOM_ID",ot);u.setValue("CG2UOM_ID",ot);var ht=u.getValue("AUOM_ID").toString(),p=t.getValueOfDecimal(u.getValue("APRICE")),g=t.getValueOfInt(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),ct=t.getValueOfDateTime(u.getValue("ADATETO")),lt=t.getValueOfDateTime(u.getValue("ADATEFROM")),st=ct.Subtract(lt),c=Utility.timeUtil.getDaysBetween(lt,ct),wt=st.TotalMilliseconds,ft=st.TotalSeconds,et=st.TotalMinutes,ut,rt,at=c/30,yt=c%30,vt=c/7,pt=c%7;if(ut=yt==0?at:at+1,rt=pt==0?vt:vt+1,t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(ht)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ut),p,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(rt),p,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(it*c),p,h);l=CalculatePrice(new Decimal(it*c),y,h);a=CalculatePrice(new Decimal(it*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),p,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}}else switch(int.Parse(ht)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ut),p,b);s=CalculatePrice(new Decimal(ut),p,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),w,b);a=CalculatePrice(new Decimal(ut),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(rt),p,b);s=CalculatePrice(new Decimal(rt),p,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),w,b);a=CalculatePrice(new Decimal(rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(it*c),p,b);s=CalculatePrice(new Decimal(it*c),p,h);k=CalculateRebate(new Decimal(it*c),y,b);l=CalculatePrice(new Decimal(it*c),y,k);d=CalculateRebate(new Decimal(it*c),w,b);a=CalculatePrice(new Decimal(it*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),p,b);s=CalculatePrice(new Decimal(et),p,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),w,b);a=CalculatePrice(new Decimal(et),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};v.prototype.AVALSelected=function(i,r,u,f,e,o){var it,s,l,a,h,k,d,v,ot;if(e==null||e.toString()=="")return"";it=24;ot=null;try{ot=u.getValue("AUOM_ID").toString()}catch(pt){return this.setCalloutActive(!1),""}var p=t.getValueOfDecimal(u.getValue("APRICE")),b=t.getValueOfDecimal(u.getValue("AREBATE")),g=t.getValueOfInt(u.getValue("ANUM")),ht=t.getValueOfDateTime(u.getValue("ADATETO")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),ct=t.getValueOfDateTime(u.getValue("ADATEFROM")),st=ht.Subtract(ct),c=Utility.timeUtil.getDaysBetween(ct,ht),wt=st.TotalMilliseconds,ft=st.TotalSeconds,et=st.TotalMinutes,ut,rt,lt=c/30,vt=c%30,at=c/7,yt=c%7;if(ut=vt==0?lt:lt+1,rt=yt==0?at:at+1,t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(ot)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ut),p,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(rt),p,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(it*c),p,h);l=CalculatePrice(new Decimal(it*c),y,h);a=CalculatePrice(new Decimal(it*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),p,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*rt),p,h);l=CalculatePrice(new Decimal(nt*rt),y,h);a=CalculatePrice(new Decimal(tt*rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(it*c*g),p,h);l=CalculatePrice(new Decimal(it*c*nt),y,h);a=CalculatePrice(new Decimal(it*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}}else switch(int.Parse(ot)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ut),p,b);s=CalculatePrice(new Decimal(ut),p,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),w,b);a=CalculatePrice(new Decimal(ut),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(rt),p,b);s=CalculatePrice(new Decimal(rt),p,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),w,b);a=CalculatePrice(new Decimal(rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(it*c),p,b);s=CalculatePrice(new Decimal(it*c),p,h);k=CalculateRebate(new Decimal(it*c),y,b);l=CalculatePrice(new Decimal(it*c),y,k);d=CalculateRebate(new Decimal(it*c),w,b);a=CalculatePrice(new Decimal(it*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),p,b);s=CalculatePrice(new Decimal(et),p,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),w,b);a=CalculatePrice(new Decimal(et),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*rt),p,b);s=CalculatePrice(new Decimal(g*rt),p,h);k=CalculateRebate(new Decimal(nt*rt),y,b);l=CalculatePrice(new Decimal(nt*rt),y,k);d=CalculateRebate(new Decimal(tt*rt),w,b);a=CalculatePrice(new Decimal(tt*rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(it*c*g),p,b);s=CalculatePrice(new Decimal(it*c*g),p,h);k=CalculateRebate(new Decimal(it*c*nt),y,b);l=CalculatePrice(new Decimal(it*c*nt),y,k);d=CalculateRebate(new Decimal(it*c*tt),w,b);a=CalculatePrice(new Decimal(it*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v)}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};n.Model.CalloutOfferSerIncluded=v;n.Utility.inheritPrototype(y,n.CalloutEngine);y.prototype.CalculatePrice=function(n,t,i){return Decimal.Subtract(Decimal.Multiply(n,t),i)};y.prototype.CalculateRebate=function(n,t,i){return Decimal.Multiply(Decimal.Multiply(n,t),Decimal.Multiply(new Decimal(.01),i))};y.prototype.OfferServices=function(i,r,u,f,e,o){var st,wt,ot,ft,et;if(e==null||e.toString()==""||(st=t.getValueOfInt(e),st==null||st==0))return"";var ht=0,ct=new Decimal(0),lt=new Decimal(0),at=new Decimal(0),s,l,a,v,h,k,d,vt,yt,rt=null;try{for(ot=[],ot[0]=new n.DB.SqlParam("@FO_SERVICE_ID",st),rt=n.DB.executeReader("select uom.FO_HOTEL_UOM_ID,s.DESCRIPTION from FO_HOTEL_UOM uom inner join FO_SERVICE s ON(uom.FO_HOTEL_UOM_ID= s.FO_HOTEL_UOM_ID) where s.FO_SERVICE_ID=@FO_SERVICE_ID ",ot,null);rt.read();)ht=t.getValueOfInt(rt[0]),u.setValue("AUOM_ID",ht),u.setValue("CG1UOM_ID",ht),u.setValue("CG2UOM_ID",ht),u.setValue("DESCRIPTION",t.getValueOfString(rt[1]));rt.close()}catch(pt){this.setCalloutActive(!1);rt!=null&&rt.close();this.log.severe(pt.toString())}finally{rt!=null&&rt.close()}wt="select PRICE,CHILDGROUP1,CHILDGROUP2,UOM1,UOM2 from FO_SERVICE_PRICE_PRICELINE where CREATED=(select max(CREATED) from FO_SERVICE_PRICE_PRICELINE where FO_SERVICE_ID=@FO_SERVICE_ID)";try{for(ot=[],ot[0]=new SqlParameter("@FO_SERVICE_ID",st),rt=n.DB.executeReader(wt,ot,null);rt.read();)ct=t.getValueOfDecimal(rt[0]),lt=t.getValueOfDecimal(rt[1]),at=t.getValueOfDecimal(rt[2]),vt=rt[3].toString(),yt=rt[4].toString(),vt=="Y"&&(lt=Decimal.Multiply(Decimal.Multiply(ct,lt),new Decimal(.01))),yt=="Y"&&(at=Decimal.Multiply(Decimal.Multiply(ct,at),new Decimal(.01))),u.setValue("APRICE",ct),u.setValue("CG1PRICE",lt),u.setValue("CG2PRICE",at)}catch(pt){this.setCalloutActive(!1);this.log.severe(pt.toString())}finally{rt!=null&&rt.close()}var bt=u.getValue("AUOM_ID").toString(),g=t.getValueOfInt(u.getValue("ANUM")),p=t.getValueOfDecimal(u.getValue("APRICE")),b=t.getValueOfDecimal(u.getValue("AREBATE")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),kt=t.getValueOfDateTime(u.getValue("ADATETO")),dt=t.getValueOfDateTime(u.getValue("ADATEFROM")),c=Utility.timeUtil.getDaysBetween(dt,kt),gt=dt.Subtract(kt),ut,it,ni=c/30,ii=c%30,ti=c/7,ri=c%7;if(ut=ii==0?ni:ni+1,it=ri==0?ti:ti+1,ft=gt.Seconds,et=gt.Minutes,t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(bt)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(ut),p,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(it),p,h);l=CalculatePrice(new Decimal(it),y,h);a=CalculatePrice(new Decimal(it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(24*c),p,h);l=CalculatePrice(new Decimal(24*c),y,h);a=CalculatePrice(new Decimal(24*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),p,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}}else switch(int.Parse(bt)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(ut),p,b);s=CalculatePrice(new Decimal(ut),p,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),w,b);a=CalculatePrice(new Decimal(ut),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(it),p,b);s=CalculatePrice(new Decimal(it),p,h);k=CalculateRebate(new Decimal(it),y,b);l=CalculatePrice(new Decimal(it),y,k);d=CalculateRebate(new Decimal(it),w,b);a=CalculatePrice(new Decimal(it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(24*c),p,b);s=CalculatePrice(new Decimal(24*c),p,h);k=CalculateRebate(new Decimal(24*c),y,b);l=CalculatePrice(new Decimal(24*c),y,k);d=CalculateRebate(new Decimal(24*c),w,b);a=CalculatePrice(new Decimal(24*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),p,b);s=CalculatePrice(new Decimal(et),p,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),w,b);a=CalculatePrice(new Decimal(et),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};y.prototype.tochkdate=function(i,r,u,f,e,o){var s,l,a,h,k,d,v,ht,ut,at,vt,lt,ot;if(e==null||e.toString()==""||(ht=t.getValueOfDateTime(e),ht==null||ht.equals(0)))return"";ut=t.getValueOfDateTime(e);ut=t.getValueOfDateTime(u.getValue("ADATETO"));var st=t.getValueOfDateTime(u.getValue("ADATEFROM")),g=t.getValueOfInt(u.getValue("CG1NUM")),nt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),p=t.getValueOfDecimal(u.getValue("CG2PRICE"));try{if(ut=t.getValueOfDateTime(u.getValue("ADATETO")),at=Utility.TimeUtil.getDaysBetween(st,ut),at<=0)vt=Utility.TimeUtil.AddDays(st,1),u.setValue("ADATETO",vt);else if(ut.compareTo(st)>0){var ct=ut.Subtract(st),c=Utility.TimeUtil.getDaysBetween(st,ut),dt=ct.Milliseconds,ft=ct.Seconds,et=ct.Minutes,rt,it,yt=c/30,wt=c%30,pt=c/7,bt=c%7;rt=wt==0?yt:yt+1;it=bt==0?pt:pt+1;lt=t.getValueOfDateTime(u.getValue("ADATEFROM"));u.setValue("CG1DATETO",ut);u.setValue("CG2DATETO",ut);u.setValue("CG1DATEFROM",lt);u.setValue("CG2DATEFROM",lt);ot=u.getValue("AUOM_ID").toString();(ot==""||ot.Trim().Length==0)&&(ot="0");var w=t.getValueOfDecimal(u.getValue("APRICE")),tt=System.Convert.ToInt16(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE"));if(t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(ot)){case 1000003:s=w;l=y;a=p;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),w,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(rt),w,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(it),w,h);l=CalculatePrice(new Decimal(it),y,h);a=CalculatePrice(new Decimal(it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),w,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(24*c),w,h);l=CalculatePrice(new Decimal(24*c),y,h);a=CalculatePrice(new Decimal(24*c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(et),w,h);l=CalculatePrice(new Decimal(et),y,h);a=CalculatePrice(new Decimal(et),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ft),w,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(tt*it),w,h);l=CalculatePrice(new Decimal(g*it),y,h);a=CalculatePrice(new Decimal(nt*it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(tt*it),w,h);l=CalculatePrice(new Decimal(g*it),y,h);a=CalculatePrice(new Decimal(nt*it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(tt*(c+1)),w,h);l=CalculatePrice(new Decimal(g*(c+1)),y,h);a=CalculatePrice(new Decimal(nt*(c+1)),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*tt),w,h);l=CalculatePrice(new Decimal((c+1)*g),y,h);a=CalculatePrice(new Decimal((c+1)*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(24*c*tt),w,h);l=CalculatePrice(new Decimal(24*c*g),y,h);a=CalculatePrice(new Decimal(24*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(24*c*tt),w,h);l=CalculatePrice(new Decimal(24*c*g),y,h);a=CalculatePrice(new Decimal(24*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}}else switch(int.Parse(ot)){case 1000003:s=w;l=y;a=p;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),w,b);s=CalculatePrice(new Decimal(c),w,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),p,b);a=CalculatePrice(new Decimal(c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(rt),w,b);s=CalculatePrice(new Decimal(rt),w,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),p,b);a=CalculatePrice(new Decimal(rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(it),w,b);s=CalculatePrice(new Decimal(it),w,h);k=CalculateRebate(new Decimal(it),y,b);l=CalculatePrice(new Decimal(it),y,k);d=CalculateRebate(new Decimal(it),p,b);a=CalculatePrice(new Decimal(it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),w,b);s=CalculatePrice(new Decimal(c+1),w,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),p,b);a=CalculatePrice(new Decimal(c+1),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(24*c),w,b);s=CalculatePrice(new Decimal(24*c),w,h);k=CalculateRebate(new Decimal(24*c),y,b);l=CalculatePrice(new Decimal(24*c),y,k);d=CalculateRebate(new Decimal(24*c),p,b);a=CalculatePrice(new Decimal(24*c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(et),w,b);s=CalculatePrice(new Decimal(et),w,h);k=CalculateRebate(new Decimal(et),y,b);l=CalculatePrice(new Decimal(et),y,k);d=CalculateRebate(new Decimal(et),p,b);a=CalculatePrice(new Decimal(et),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ft),w,b);s=CalculatePrice(new Decimal(ft),w,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),p,b);a=CalculatePrice(new Decimal(ft),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(tt*it),w,b);s=CalculatePrice(new Decimal(tt*it),w,h);k=CalculateRebate(new Decimal(g*it),y,b);l=CalculatePrice(new Decimal(g*it),y,k);d=CalculateRebate(new Decimal(nt*it),p,b);a=CalculatePrice(new Decimal(nt*it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(tt*it),w,b);s=CalculatePrice(new Decimal(tt*it),w,h);k=CalculateRebate(new Decimal(g*it),y,b);l=CalculatePrice(new Decimal(g*it),y,k);d=CalculateRebate(new Decimal(nt*it),p,b);a=CalculatePrice(new Decimal(nt*it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal(tt*(c+1)),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal((c+1)*tt),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(24*c*tt),w,b);s=CalculatePrice(new Decimal(24*c*tt),w,h);k=CalculateRebate(new Decimal(24*c*g),y,b);l=CalculatePrice(new Decimal(24*c*g),y,k);d=CalculateRebate(new Decimal(24*c*nt),p,b);a=CalculatePrice(new Decimal(24*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(24*c*tt),w,b);s=CalculatePrice(new Decimal(24*c*tt),w,h);k=CalculateRebate(new Decimal(24*c*g),y,b);l=CalculatePrice(new Decimal(24*c*g),y,k);d=CalculateRebate(new Decimal(24*c*nt),p,b);a=CalculatePrice(new Decimal(24*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}tt==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0));g==0&&u.setValue("CG1TOTAL_AMOUNT",0);nt==0&&u.setValue("CG2TOTAL_AMOUNT",0)}}catch(kt){this.setCalloutActive(!1);this.log.severe(kt.toString())}return i=r=u=f=e=o=null,""};y.prototype.fromchkdate=function(i,r,u,f,e,o){var s,l,a,h,k,d,v,ht,at,lt,st;if(e==null||e.toString()==""||(ht=t.getValueOfDateTime(e),ht==null||ht.equals(0)))return"";var et=t.getValueOfDateTime(u.getValue("ADATEFROM")),ot=t.getValueOfDateTime(u.getValue("ADATETO")),g=t.getValueOfInt(u.getValue("CG1NUM")),nt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),p=t.getValueOfDecimal(u.getValue("CG2PRICE"));try{if(et=t.getValueOfDateTime(u.getValue("ADATEFROM")),et.compareTo(ot)>0)u.setValue("CG1DATEFROM",et),u.setValue("CG2DATEFROM",et),at=et.addDays(1),u.setValue("ADATETO",at);else if(ot.compareTo(et)>0){var ct=et.subtract(ot),c=Utility.TimeUtil.getDaysBetween(et,ot),kt=ct.Milliseconds,ut=ct.Seconds,ft=ct.Minutes,rt,it,vt=c/30,pt=c%30,yt=c/7,wt=c%7;rt=pt==0?vt:vt+1;it=wt==0?yt:yt+1;lt=t.getValueOfDateTime(u.getValue("ADATEFROM"));u.setValue("CG1DATETO",ot);u.setValue("CG2DATETO",ot);u.setValue("CG1DATEFROM",lt);u.setValue("CG2DATEFROM",lt);st=u.getValue("AUOM_ID").toString();(st==""||st.Trim().Length==0)&&(st="0");var w=t.getValueOfDecimal(u.getValue("APRICE")),tt=t.getValueOfInt(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE"));if(t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(st)){case 1000003:s=w;l=y;a=p;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(tt),w,h);l=CalculatePrice(new Decimal(g),y,h);a=CalculatePrice(new Decimal(nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),w,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(rt),w,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(it),w,h);l=CalculatePrice(new Decimal(it),y,h);a=CalculatePrice(new Decimal(it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),w,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(24*c),w,h);l=CalculatePrice(new Decimal(24*c),y,h);a=CalculatePrice(new Decimal(24*c),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(ft),w,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ut),w,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*tt),w,h);l=CalculatePrice(new Decimal(c*g),y,h);a=CalculatePrice(new Decimal(c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(tt*it),w,h);l=CalculatePrice(new Decimal(g*it),y,h);a=CalculatePrice(new Decimal(nt*it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(tt*it),w,h);l=CalculatePrice(new Decimal(g*it),y,h);a=CalculatePrice(new Decimal(nt*it),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(tt*(c+1)),w,h);l=CalculatePrice(new Decimal(g*(c+1)),y,h);a=CalculatePrice(new Decimal(nt*(c+1)),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*tt),w,h);l=CalculatePrice(new Decimal((c+1)*g),y,h);a=CalculatePrice(new Decimal((c+1)*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(24*c*tt),w,h);l=CalculatePrice(new Decimal(24*c*g),y,h);a=CalculatePrice(new Decimal(24*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(24*c*tt),w,h);l=CalculatePrice(new Decimal(24*c*g),y,h);a=CalculatePrice(new Decimal(24*c*nt),p,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}}else switch(int.Parse(st)){case 1000003:s=w;l=y;a=p;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(tt),w,b);s=CalculatePrice(new Decimal(tt),w,h);k=CalculateRebate(new Decimal(g),y,b);l=CalculatePrice(new Decimal(g),y,k);d=CalculateRebate(new Decimal(nt),p,b);a=CalculatePrice(new Decimal(nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),w,b);s=CalculatePrice(new Decimal(c),w,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),p,b);a=CalculatePrice(new Decimal(c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(rt),w,b);s=CalculatePrice(new Decimal(rt),w,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),p,b);a=CalculatePrice(new Decimal(rt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(it),w,b);s=CalculatePrice(new Decimal(it),w,h);k=CalculateRebate(new Decimal(it),y,b);l=CalculatePrice(new Decimal(it),y,k);d=CalculateRebate(new Decimal(it),p,b);a=CalculatePrice(new Decimal(it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),w,b);s=CalculatePrice(new Decimal(c+1),w,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),p,b);a=CalculatePrice(new Decimal(c+1),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(24*c),w,b);s=CalculatePrice(new Decimal(24*c),w,h);k=CalculateRebate(new Decimal(24*c),y,b);l=CalculatePrice(new Decimal(24*c),y,k);d=CalculateRebate(new Decimal(24*c),p,b);a=CalculatePrice(new Decimal(24*c),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(ft),w,b);s=CalculatePrice(new Decimal(ft),w,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),p,b);a=CalculatePrice(new Decimal(ft),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ut),w,b);s=CalculatePrice(new Decimal(ut),w,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),p,b);a=CalculatePrice(new Decimal(ut),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*tt),w,b);s=CalculatePrice(new Decimal(c*tt),w,h);k=CalculateRebate(new Decimal(c*g),y,b);l=CalculatePrice(new Decimal(c*g),y,k);d=CalculateRebate(new Decimal(c*nt),p,b);a=CalculatePrice(new Decimal(c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(tt*it),w,b);s=CalculatePrice(new Decimal(tt*it),w,h);k=CalculateRebate(new Decimal(g*it),y,b);l=CalculatePrice(new Decimal(g*it),y,k);d=CalculateRebate(new Decimal(nt*it),p,b);a=CalculatePrice(new Decimal(nt*it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(tt*it),w,b);s=CalculatePrice(new Decimal(tt*it),w,h);k=CalculateRebate(new Decimal(g*it),y,b);l=CalculatePrice(new Decimal(g*it),y,k);d=CalculateRebate(new Decimal(nt*it),p,b);a=CalculatePrice(new Decimal(nt*it),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal(tt*(c+1)),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(tt*(c+1)),w,b);s=CalculatePrice(new Decimal((c+1)*tt),w,h);k=CalculateRebate(new Decimal(g*(c+1)),y,b);l=CalculatePrice(new Decimal(g*(c+1)),y,k);d=CalculateRebate(new Decimal(nt*(c+1)),p,b);a=CalculatePrice(new Decimal(nt*(c+1)),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(24*c*tt),w,b);s=CalculatePrice(new Decimal(24*c*tt),w,h);k=CalculateRebate(new Decimal(24*c*g),y,b);l=CalculatePrice(new Decimal(24*c*g),y,k);d=CalculateRebate(new Decimal(24*c*nt),p,b);a=CalculatePrice(new Decimal(24*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(24*c*tt),w,b);s=CalculatePrice(new Decimal(24*c*tt),w,h);k=CalculateRebate(new Decimal(24*c*g),y,b);l=CalculatePrice(new Decimal(24*c*g),y,k);d=CalculateRebate(new Decimal(24*c*nt),p,b);a=CalculatePrice(new Decimal(24*c*nt),p,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}tt==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0));g==0&&u.setValue("CG1TOTAL_AMOUNT",0);nt==0&&u.setValue("CG2TOTAL_AMOUNT",0)}}catch(bt){this.setCalloutActive(!1);this.log.severe(bt.toString())}return i=r=u=f=e=o=null,""};y.prototype.UOMSelected=function(i,r,u,f,e,o){var s,l,a,h,k,d,v,et;if(e==null||e.toString()==""||(et=t.getValueOfInt(e),et=t.getValueOfInt(u.getValue("AUOM_ID")),et==null))return"";u.setValue("CG1UOM_ID",et);u.setValue("CG2UOM_ID",et);var ct=u.getValue("AUOM_ID").toString(),p=t.getValueOfDecimal(u.getValue("APRICE")),g=t.getValueOfInt(u.getValue("ANUM")),b=t.getValueOfDecimal(u.getValue("AREBATE")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),ot=t.getValueOfDateTime(u.getValue("ADATETO")),st=t.getValueOfDateTime(u.getValue("ADATEFROM")),ht=st.compareTo(ot)>0?st.Subtract(ot):ot.Subtract(st);var c=Utility.timeUtil.getDaysBetween(st,ot),pt=ht.Milliseconds,ut=ht.Seconds,ft=ht.Minutes,rt,it,lt=c/30,vt=c%30,at=c/7,yt=c%7;if(rt=vt==0?lt:lt+1,it=yt==0?at:at+1,t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(ct)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(rt),p,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(it),p,h);l=CalculatePrice(new Decimal(it),y,h);a=CalculatePrice(new Decimal(it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(24*c),p,h);l=CalculatePrice(new Decimal(24*c),y,h);a=CalculatePrice(new Decimal(24*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ut),p,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}}else switch(int.Parse(ct)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(rt),p,b);s=CalculatePrice(new Decimal(rt),p,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),w,b);a=CalculatePrice(new Decimal(rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(it),p,b);s=CalculatePrice(new Decimal(it),p,h);k=CalculateRebate(new Decimal(it),y,b);l=CalculatePrice(new Decimal(it),y,k);d=CalculateRebate(new Decimal(it),w,b);a=CalculatePrice(new Decimal(it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(24*c),p,b);s=CalculatePrice(new Decimal(24*c),p,h);k=CalculateRebate(new Decimal(24*c),y,b);l=CalculatePrice(new Decimal(24*c),y,k);d=CalculateRebate(new Decimal(24*c),w,b);a=CalculatePrice(new Decimal(24*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ut),p,b);s=CalculatePrice(new Decimal(ut),p,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),w,b);a=CalculatePrice(new Decimal(ut),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};y.prototype.AVALSelected=function(i,r,u,f,e,o){var s,l,a,h,k,d,v,et;if(e==null||e.toString()=="")return"";et=null;try{et=u.getValue("AUOM_ID").toString()}catch(yt){return this.setCalloutActive(!1),""}var p=t.getValueOfDecimal(u.getValue("APRICE")),b=t.getValueOfDecimal(u.getValue("AREBATE")),g=t.getValueOfInt(u.getValue("ANUM")),st=t.getValueOfDateTime(u.getValue("ADATETO")),nt=t.getValueOfInt(u.getValue("CG1NUM")),tt=t.getValueOfInt(u.getValue("CG2NUM")),y=t.getValueOfDecimal(u.getValue("CG1PRICE")),w=t.getValueOfDecimal(u.getValue("CG2PRICE")),ht=t.getValueOfDateTime(u.getValue("ADATEFROM")),ot=ht.Subtract(st),c=Utility.TimeUtil.getDaysBetween(ht,st),pt=ot.Milliseconds,ut=ot.Seconds,ft=ot.Minutes,rt,it,ct=c/30,at=c%30,lt=c/7,vt=c%7;if(rt=at==0?ct:ct+1,it=vt==0?lt:lt+1,t.getValueOfInt(b)==0){h=n.Env.ZERO;switch(int.Parse(et)){case 1000003:s=p;l=y;a=w;l=y;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:s=CalculatePrice(new Decimal(g),p,h);l=CalculatePrice(new Decimal(nt),y,h);a=CalculatePrice(new Decimal(tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:s=CalculatePrice(new Decimal(c),p,h);l=CalculatePrice(new Decimal(c),y,h);a=CalculatePrice(new Decimal(c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:s=CalculatePrice(new Decimal(rt),p,h);l=CalculatePrice(new Decimal(rt),y,h);a=CalculatePrice(new Decimal(rt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:s=CalculatePrice(new Decimal(it),p,h);l=CalculatePrice(new Decimal(it),y,h);a=CalculatePrice(new Decimal(it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:s=CalculatePrice(new Decimal(c+1),p,h);l=CalculatePrice(new Decimal(c+1),y,h);a=CalculatePrice(new Decimal(c+1),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:s=CalculatePrice(new Decimal(24*c),p,h);l=CalculatePrice(new Decimal(24*c),y,h);a=CalculatePrice(new Decimal(24*c),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:s=CalculatePrice(new Decimal(ft),p,h);l=CalculatePrice(new Decimal(ft),y,h);a=CalculatePrice(new Decimal(ft),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:s=CalculatePrice(new Decimal(ut),p,h);l=CalculatePrice(new Decimal(ut),y,h);a=CalculatePrice(new Decimal(ut),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:s=CalculatePrice(new Decimal(c*g),p,h);l=CalculatePrice(new Decimal(c*nt),y,h);a=CalculatePrice(new Decimal(c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:s=CalculatePrice(new Decimal(g*it),p,h);l=CalculatePrice(new Decimal(nt*it),y,h);a=CalculatePrice(new Decimal(tt*it),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:s=CalculatePrice(new Decimal(g*(c+1)),p,h);l=CalculatePrice(new Decimal(nt*(c+1)),y,h);a=CalculatePrice(new Decimal(tt*(c+1)),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:s=CalculatePrice(new Decimal((c+1)*g),p,h);l=CalculatePrice(new Decimal((c+1)*nt),y,h);a=CalculatePrice(new Decimal((c+1)*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:s=CalculatePrice(new Decimal(24*c*g),p,h);l=CalculatePrice(new Decimal(24*c*nt),y,h);a=CalculatePrice(new Decimal(24*c*tt),w,h);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}}else switch(int.Parse(et)){case 1000003:s=p;l=y;a=w;u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000004:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000005:h=CalculateRebate(new Decimal(g),p,b);s=CalculatePrice(new Decimal(g),p,h);k=CalculateRebate(new Decimal(nt),y,b);l=CalculatePrice(new Decimal(nt),y,k);d=CalculateRebate(new Decimal(tt),w,b);a=CalculatePrice(new Decimal(tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000006:h=CalculateRebate(new Decimal(c),p,b);s=CalculatePrice(new Decimal(c),p,h);k=CalculateRebate(new Decimal(c),y,b);l=CalculatePrice(new Decimal(c),y,k);d=CalculateRebate(new Decimal(c),w,b);a=CalculatePrice(new Decimal(c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000007:h=CalculateRebate(new Decimal(rt),p,b);s=CalculatePrice(new Decimal(rt),p,h);k=CalculateRebate(new Decimal(rt),y,b);l=CalculatePrice(new Decimal(rt),y,k);d=CalculateRebate(new Decimal(rt),w,b);a=CalculatePrice(new Decimal(rt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000008:h=CalculateRebate(new Decimal(it),p,b);s=CalculatePrice(new Decimal(it),p,h);k=CalculateRebate(new Decimal(it),y,b);l=CalculatePrice(new Decimal(it),y,k);d=CalculateRebate(new Decimal(it),w,b);a=CalculatePrice(new Decimal(it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000009:h=CalculateRebate(new Decimal(c+1),p,b);s=CalculatePrice(new Decimal(c+1),p,h);k=CalculateRebate(new Decimal(c+1),y,b);l=CalculatePrice(new Decimal(c+1),y,k);d=CalculateRebate(new Decimal(c+1),w,b);a=CalculatePrice(new Decimal(c+1),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000010:h=CalculateRebate(new Decimal(24*c),p,b);s=CalculatePrice(new Decimal(24*c),p,h);k=CalculateRebate(new Decimal(24*c),y,b);l=CalculatePrice(new Decimal(24*c),y,k);d=CalculateRebate(new Decimal(24*c),w,b);a=CalculatePrice(new Decimal(24*c),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000011:h=CalculateRebate(new Decimal(ft),p,b);s=CalculatePrice(new Decimal(ft),p,h);k=CalculateRebate(new Decimal(ft),y,b);l=CalculatePrice(new Decimal(ft),y,k);d=CalculateRebate(new Decimal(ft),w,b);a=CalculatePrice(new Decimal(ft),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000012:h=CalculateRebate(new Decimal(ut),p,b);s=CalculatePrice(new Decimal(ut),p,h);k=CalculateRebate(new Decimal(ut),y,b);l=CalculatePrice(new Decimal(ut),y,k);d=CalculateRebate(new Decimal(ut),w,b);a=CalculatePrice(new Decimal(ut),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000013:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000014:h=CalculateRebate(new Decimal(c*g),p,b);s=CalculatePrice(new Decimal(c*g),p,h);k=CalculateRebate(new Decimal(c*nt),y,b);l=CalculatePrice(new Decimal(c*nt),y,k);d=CalculateRebate(new Decimal(c*tt),w,b);a=CalculatePrice(new Decimal(c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000015:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000016:h=CalculateRebate(new Decimal(g*it),p,b);s=CalculatePrice(new Decimal(g*it),p,h);k=CalculateRebate(new Decimal(nt*it),y,b);l=CalculatePrice(new Decimal(nt*it),y,k);d=CalculateRebate(new Decimal(tt*it),w,b);a=CalculatePrice(new Decimal(tt*it),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000017:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal(g*(c+1)),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000018:h=CalculateRebate(new Decimal(g*(c+1)),p,b);s=CalculatePrice(new Decimal((c+1)*g),p,h);k=CalculateRebate(new Decimal(nt*(c+1)),y,b);l=CalculatePrice(new Decimal(nt*(c+1)),y,k);d=CalculateRebate(new Decimal(tt*(c+1)),w,b);a=CalculatePrice(new Decimal(tt*(c+1)),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;case 1000019:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=Decimal.Add(Decimal.Add(s,l),a);u.setValue("GRAND_TOTAL",v);break;case 1000020:h=CalculateRebate(new Decimal(24*c*g),p,b);s=CalculatePrice(new Decimal(24*c*g),p,h);k=CalculateRebate(new Decimal(24*c*nt),y,b);l=CalculatePrice(new Decimal(24*c*nt),y,k);d=CalculateRebate(new Decimal(24*c*tt),w,b);a=CalculatePrice(new Decimal(24*c*tt),w,d);u.setValue("ATOTAL_AMOUNT",s);u.setValue("CG1TOTAL_AMOUNT",l);u.setValue("CG2TOTAL_AMOUNT",a);v=s;u.setValue("GRAND_TOTAL",v);break;default:ShowMessage.Info("false",!0,"","")}return g==0&&(u.setValue("ATOTAL_AMOUNT",0),u.setValue("GRAND_TOTAL",0)),nt==0&&u.setValue("CG1TOTAL_AMOUNT",0),tt==0&&u.setValue("CG2TOTAL_AMOUNT",0),i=r=u=f=e=o=null,""};n.Model.CalloutOfferServices=y;it.prototype.TypeSelection=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=t.getValueOfBoolean(f);return o==null?"":(o==!0?r.setValue("flag1",!0):r.setValue("flag1",!1),n=i=r=u=f=e=null,"")};it.prototype.RecordSort=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=t.getValueOfBoolean(f);return o==null?"":(o==!0?r.setValue("flag2",!0):r.setValue("flag2",!1),n=i=r=u=f=e=null,"")};it.prototype.EndDate=function(i,r,u,f,e,o){var s,h,c;if(e==null||e.toString()==""||(s=t.getValueOfDateTime(e),s==null||s.equals(0)))return"";h=t.getValueOfDateTime(e);c=t.getValueOfDateTime(u.getValue("DATE_FROM"));try{h=t.getValueOfDateTime(u.getValue("TILL_DATE"));h.compareTo(c)<0&&(n.ADialog.info("EndAndStartDate"),u.setValue("TILL_DATE",c))}catch(l){this.setCalloutActive(!1)}return i=r=u=f=e=o=null,""};it.prototype.StartDate=function(n,i,r,u,f,e){var s,o,h;if(f==null||f.toString()==""||(s=t.getValueOfDateTime(f),s==null||s.equals(0)))return"";o=t.getValueOfDateTime(r.getValue("DATE_FROM"));h=t.getValueOfDateTime(r.getValue("TILL_DATE"));try{o=t.getValueOfDateTime(r.getValue("DATE_FROM"));o.compareTo(h)>0&&r.setValue("TILL_DATE",o)}catch(c){this.setCalloutActive(!1)}return n=i=r=u=f=e=null,""};n.Model.CalloutCheckInOut=it;n.Utility.inheritPrototype(b,n.CalloutEngine);b.prototype.Product=function(i,r,u,f,e,o){var c,a,k,d,ut,s,v,y,h,tt,l,it,p,rt,nt;if(this.isCalloutActive()||f.getColumnName()!="M_ProductContainer_ID"||e!=null&&e.toString()!=""||(e=0),this.isCalloutActive()||e==null||e.toString()=="")return"";c=0;a=i.getContext(r,"AttrCode");a!=null&&a!=""&&f.getColumnName()!="M_ProductContainer_ID"&&(v=e.toString()+","+a.toString(),c=n.dataContext.getJSONRecord("MInventoryLine/GetProductAttribute",v));var w=t.getValueOfInt(u.getValue("M_InventoryLine_ID")),st=t.getValueOfInt(u.getValue("M_Inventory_ID")),b=null,ht=st.toString();if(b=n.dataContext.getJSONRecord("MInventory/GetMInventory",ht),k=b.MovementDate,d=b.AD_Org_ID,f.getColumnName()=="M_Product_ID"&&(ut=n.dataContext.getJSONRecord("MInventoryLine/GetProductUOM",e.toString()),u.setValue("C_UOM_ID",t.getValueOfInt(ut))),s=null,v=w.toString(),w!=null&&w!=0){y=null;y=n.dataContext.getJSONRecord("MInventoryLine/GetMInventoryLine",v);var h=y.M_Product_ID,l=y.M_Locator_ID,g=t.getValueOfInt(u.getValue("M_Product_ID")),ft=t.getValueOfInt(u.getValue("M_Locator_ID")),nt=t.getValueOfInt(u.getValue("M_ProductContainer_ID")),et=0;if(g!=h||ft!=l||f.getColumnName()=="M_ProductContainer_ID"){this.setCalloutActive(!0);c>0&&u.setValue("M_AttributeSetInstance_ID",c);g==h?et=t.getValueOfInt(u.getValue("M_AttributeSetInstance_ID")):u.setValue("M_AttributeSetInstance_ID",null);try{s=this.SetQtyBook(d,et,g,ft,t.getValueOfDate(k),nt);u.setValue("QtyBook",s)}catch(ot){return this.setCalloutActive(!1),this.log.severe(ot.toString()),u.setValue("QtyBook",s)}}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""}if((h=0,tt=t.getValueOfInt(u.getValue("M_Product_ID")),tt!=null&&(h=tt),h==0)||(l=0,it=t.getValueOfInt(u.getValue("M_Locator_ID")),it!=null&&(l=it),l==0))return"";this.setCalloutActive(!0);c>0&&u.setValue("M_AttributeSetInstance_ID",c);p=0;rt=t.getValueOfInt(u.getValue("M_AttributeSetInstance_ID"));rt!=null&&(p=rt);u.setValue("M_AttributeSetInstance_ID",null);nt=t.getValueOfInt(u.getValue("M_ProductContainer_ID"));try{s=this.SetQtyBook(d,p,h,l,t.getValueOfDate(k),nt);u.setValue("QtyBook",s)}catch(ot){return this.setCalloutActive(!1),this.log.severe(ot.toString()),u.setValue("QtyBook",s)}return this.log.info("M_Product_ID="+h+", M_Locator_ID="+l+", M_AttributeSetInstance_ID="+p+" - QtyBook="+s),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};b.prototype.AttributeSetInstance=function(i,r,u,f,e,o){var s,v,l,y,w;if(this.isCalloutActive())return"";var tt=t.getValueOfInt(u.getValue("M_InventoryLine_ID")),b=t.getValueOfInt(u.getValue("M_Inventory_ID")),a=null,k=b.toString();a=n.dataContext.getJSONRecord("MInventory/GetMInventory",k);var d=a.MovementDate,g=a.AD_Org_ID,h=null,c=0,p=t.getValueOfInt(u.getValue("M_Product_ID"));if((p!=null&&(c=p),c==0)||(s=0,v=t.getValueOfInt(u.getValue("M_Locator_ID")),v!=null&&(s=v),s==0))return"";this.setCalloutActive(!0);l=0;y=t.getValueOfInt(u.getValue("M_AttributeSetInstance_ID"));y!=null&&(l=y);w=t.getValueOfInt(u.getValue("M_ProductContainer_ID"));try{h=this.SetQtyBook(g,l,c,s,t.getValueOfDate(d),w);u.setValue("QtyBook",h)}catch(nt){return this.setCalloutActive(!1),this.log.severe(nt.toString()),u.setValue("QtyBook",h)}return this.log.info("M_Product_ID="+c+", M_Locator_ID="+s+", M_AttributeSetInstance_ID="+l+" - QtyBook="+h),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};b.prototype.SetDiff=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=0,s=0,h=0;this.setCalloutActive(!0);try{u.getColumnName().equals("DifferenceQty")?(s=t.getValueOfDecimal(r.getValue("OpeningStock")),h=t.getValueOfDecimal(r.getValue("DifferenceQty")),o=s-h,r.setValue("AsOnDateCount",o),r.setValue("QtyCount",0)):u.getColumnName().equals("AsOnDateCount")&&(s=t.getValueOfDecimal(r.getValue("OpeningStock")),o=t.getValueOfDecimal(r.getValue("AsOnDateCount")),h=s-o,r.setValue("DifferenceQty",h),r.setValue("QtyCount",0))}catch(c){return this.setCalloutActive(!1),this.log.severe(c.toString()),c.message}return this.setCalloutActive(!1),n=i=r=u=f=e=null,""};b.prototype.SetQtyBook=function(t,i,r,u,f,e){var o=!1;n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"]!=undefined&&(o=n.context.ctx["#PRODUCT_CONTAINER_APPLICABLE"].equals("Y",!0));var s=Number(f.getMonth())+1+"-"+f.getDate()+"-"+f.getFullYear(),h=o.toString()+","+s.toString()+","+r.toString()+","+u.toString()+","+i.toString()+","+e.toString()+","+t.toString();return n.dataContext.getJSONRecord("MInventory/GetCurrentQty",h)};b.prototype.SetUOMQty=function(i,r,u,f,e,o){var l,h,a,c,v,y;if(e==null||e.toString()==""||this.isCalloutActive())return"";var p=0,w=0,b=0,s=0;this.setCalloutActive(!0);try{if(l=t.getValueOfDecimal(u.getValue("M_Product_ID")),l==0)return this.setCalloutActive(!1),"";u.getValue("IsInternalUse")==!1||u.getValue("IsInternalUse")==null?(f.getColumnName()=="C_UOM_ID"?(h=t.getValueOfInt(e),QtyEntered=t.getValueOfDecimal(u.getValue("QtyEntered")),l=t.getValueOfInt(u.getValue("M_Product_ID")),paramStr=h.toString().concat(","),a=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),c=QtyEntered.toFixed(t.getValueOfInt(a)),QtyEntered!=c&&(this.log.fine("Corrected QtyEntered Scale UOM="+h+"; QtyEntered="+QtyEntered+"->"+c),QtyEntered=c,u.setValue("QtyEntered",QtyEntered)),paramStr=l.toString().concat(",").concat(h.toString()).concat(",").concat(QtyEntered.toString()),v=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),s=v,s==null&&(s=QtyEntered)):f.getColumnName()=="QtyEntered"&&(h=i.getContextAsInt(r,"C_UOM_ID"),QtyEntered=t.getValueOfDecimal(e),paramStr=h.toString().concat(","),a=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),c=QtyEntered.toFixed(t.getValueOfInt(a)),QtyEntered!=c&&(this.log.fine("Corrected QtyEntered Scale UOM="+h+"; QtyEntered="+QtyEntered+"->"+c),QtyEntered=c,u.setValue("QtyEntered",QtyEntered)),paramStr=l.toString().concat(",",h.toString(),",",QtyEntered.toString()),v=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),s=v,s==null&&(s=QtyEntered),y=QtyEntered!=s,this.log.fine("UOM="+h+", QtyEntered="+QtyEntered+" -> "+y+" QtyOrdered="+s),i.setContext(r,"UOMConversion",y?"Y":"N")),u.getValue("AdjustmentType").toString()=="D"?(w=t.getValueOfDecimal(u.getValue("OpeningStock")),b=s,p=w-b,u.setValue("DifferenceQty",s),u.setValue("AsOnDateCount",p)):u.getValue("AdjustmentType").toString()=="A"&&(w=t.getValueOfDecimal(u.getValue("OpeningStock")),p=s,b=w-p,u.setValue("AsOnDateCount",s),u.setValue("DifferenceQty",b))):u.getValue("IsInternalUse")==!0&&(f.getColumnName()=="C_UOM_ID"?(h=t.getValueOfInt(e),QtyEntered=t.getValueOfDecimal(u.getValue("QtyEntered")),l=t.getValueOfInt(u.getValue("M_Product_ID")),paramStr=h.toString().concat(","),a=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),c=QtyEntered.toFixed(t.getValueOfInt(a)),QtyEntered!=c&&(this.log.fine("Corrected QtyEntered Scale UOM="+h+"; QtyEntered="+QtyEntered+"->"+c),QtyEntered=c,u.setValue("QtyEntered",QtyEntered)),paramStr=l.toString().concat(",").concat(h.toString()).concat(",").concat(QtyEntered.toString()),v=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),s=v,s==null&&(s=QtyEntered),u.setValue("QtyInternalUse",s)):f.getColumnName()=="QtyEntered"&&(h=i.getContextAsInt(r,"C_UOM_ID"),QtyEntered=t.getValueOfDecimal(e),paramStr=h.toString().concat(","),a=n.dataContext.getJSONRecord("MUOM/GetPrecision",paramStr),c=QtyEntered.toFixed(t.getValueOfInt(a)),QtyEntered!=c&&(this.log.fine("Corrected QtyEntered Scale UOM="+h+"; QtyEntered="+QtyEntered+"->"+c),QtyEntered=c,u.setValue("QtyEntered",QtyEntered)),paramStr=l.toString().concat(",",h.toString(),",",QtyEntered.toString()),v=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",paramStr),s=v,s==null&&(s=QtyEntered),y=QtyEntered!=s,this.log.fine("UOM="+h+", QtyEntered="+QtyEntered+" -> "+y+" QtyOrdered="+s),i.setContext(r,"UOMConversion",y?"Y":"N"),u.setValue("QtyInternalUse",s)))}catch(k){return this.setCalloutActive(!1),this.log.severe(k.toString()),k.message}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutInventory=b;n.Utility.inheritPrototype(f,n.CalloutEngine);f.prototype.DocType=function(r,u,f,e,o,s){var l,a,h,c;if(o==null||o.toString()==""||(l=o,l==null||l==0))return"";a=l.toString();h=n.dataContext.getJSONRecord("MDocType/GetDocTypeData",a);try{h!=null&&(r.setContext(u,"HasCharges",t.getValueOfString(h.HasCharges)),h.IsDocNoControlled=="Y"&&f.setValue("DocumentNo","<"+t.getValueOfString(h.CurrentNext)+">"),c=t.getValueOfString(h.DocBaseType),r.setContext(u,"DocBaseType",c),c.startsWith("AP")?f.setValue("PaymentRule","S"):c.endsWith("C")&&f.setValue("PaymentRule","P"),f.getField("TreatAsDiscount")!=null&&(c.equals("APC")?f.setValue("TreatAsDiscount",t.getValueOfBoolean(h.TreatAsDiscount)):f.setValue("TreatAsDiscount",!1)),f.getField("IsReturnTrx")!=null&&f.setValue("IsReturnTrx",t.getValueOfBoolean(h.IsReturnTrx)))}catch(v){return this.setCalloutActive(!1),h!=null&&h.close(),this.log.log(i.SEVERE,sql,v),v.message}return r=u=f=e=o=s=null,""};f.prototype.BPartner=function(r,u,f,e,o,s){var v,w,et,h,st,ht,ct,d,g,nt,tt,it,lt,rt,ut;if(o==null||o.toString()=="")return"";try{if(v=t.getValueOfInt(o),v==null||v==0)return"";var b="N",ft="N",y=r.isSOTrx(u),c=null,k=null;try{if(c=n.dataContext.getJSONRecord("MBPartner/GetBPartnerData",v.toString()),c!=null){if(w=t.getValueOfInt(c[y?"M_PriceList_ID":"PO_PriceList_ID"]),w>0&&f.setValue("M_PriceList_ID",w),et=t.getValueOfInt(c[y?"C_IncoTerm_ID":"C_IncoTermPO_ID"]),et>0&&f.setValue("C_IncoTerm_ID",et),h=t.getValueOfString(c[y?"PaymentRule":"PaymentRulePO"]),h!=null&&h.length!=0&&(r.getContext("DocBaseType").toString().endsWith("C")?h="P":y&&(h.toString().equals("S")||h.toString().equals("U"))&&(h="P"),f.setValue("PaymentRule",h)),st=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),st.VA009_){var p=t.getValueOfInt(c.VA009_PaymentMethod_ID),l=t.getValueOfString(c.VA009_PaymentBaseType),b="N",a=n.dataContext.getJSONRecord("MBPartner/GetBPDetails",v);a!=null&&(b=t.getValueOfString(a.IsVendor),ft=t.getValueOfString(a.IsCustomer),y?b=="Y"?(p=0,l=null,ft=="Y"&&(p=t.getValueOfInt(a.VA009_PaymentMethod_ID),l=t.getValueOfString(a.VA009_PAYMENTBASETYPE))):ft=="Y"&&(p=t.getValueOfInt(a.VA009_PaymentMethod_ID),l=t.getValueOfString(a.VA009_PAYMENTBASETYPE)):b=="Y"?(p=t.getValueOfInt(a.VA009_PO_PaymentMethod_ID),l=t.getValueOfString(a.VA009_PAYMENTBASETYPEPO)):(p=0,l=null));p==0?f.setValue("VA009_PaymentMethod_ID",null):(f.setValue("VA009_PaymentMethod_ID",p),l!=null?(f.setValue("PaymentMethod",l),b=="N"?f.setValue("PaymentRule",l):f.setValue("PaymentRule",l)):(f.setValue("PaymentMethod","T"),b=="N"?f.setValue("PaymentRule","T"):f.setValue("PaymentRule","T")))}ht=t.getValueOfInt(f.getValue("C_PaymentTerm_ID"));ct=t.getValueOfDecimal(f.getValue("C_Order_Blanket"));ht>0&&ct>0||(w=t.getValueOfInt(c[y?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"]),w>0&&f.setValue("C_PaymentTerm_ID",w));d=t.getValueOfInt(c.C_BPartner_Location_ID);v.toString().equals(r.getContext("C_BPartner_ID"))&&(g=r.getContext("C_BPartner_Location_ID"),g&&g.toString().length>0&&(d=parseInt(g)));d==0?f.setValue("C_BPartner_Location_ID",null):f.setValue("C_BPartner_Location_ID",d);nt=t.getValueOfInt(c.AD_User_ID);v.toString().equals(r.getContext("C_BPartner_ID"))&&(tt=r.getContext("AD_User_ID"),tt&&tt.toString().length>0&&(nt=parseInt(tt)));nt==0?f.setValue("AD_User_ID",null):f.setValue("AD_User_ID",nt);y&&(it=c.CreditStatusSettingOn,it=="CH"?(rt=t.getValueOfDouble(c.SO_CreditLimit),rt!=0&&(ut=t.getValueOfDouble(c.CreditAvailable),c!=null&&ut<=0&&n.ADialog.info("CreditOver"))):(lt=t.getValueOfInt(f.getValue("C_BPartner_Location_ID")),dr1=n.dataContext.getJSONRecord("MBPartner/GetLocationData",lt.toString()),k!=null&&(it=k.CreditStatusSettingOn,it=="CL"&&(rt=t.getValueOfDouble(k.SO_CreditLimit),rt!=0&&(ut=t.getValueOfDouble(k.CreditAvailable),c!=null&&ut<=0&&n.ADialog.info("CreditOver"))))));h=t.getValueOfString(c.POReference);h!=null&&h.length!=0?f.setValue("POReference",h):f.setValue("POReference",null);h=t.getValueOfString(c.SO_Description);h!=null&&h.toString().trim().length!=0&&f.setValue("Description",h);h=t.getValueOfString(c.IsDiscountPrinted);h!=null&&h.toString().trim().length!=0?f.setValue("IsDiscountPrinted",h):f.setValue("IsDiscountPrinted","N")}}catch(ot){return this.setCalloutActive(!1),this.log.log(i.SEVERE,"bPartner",ot),ot.message}}catch(ot){this.setCalloutActive(!1);this.log.severe(ot.toString())}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};f.prototype.PaymentTerm=function(t,i,r,u,f,e){var o,h,c,l,s,a;if(f==null||f.toString()=="")return"";try{if(o=f,h=t.getContextAsInt(i,"C_Invoice_ID",!1),o==null||o==0||h==0)return"";if(l=o.toString().concat(",",h.toString()),s=n.dataContext.getJSONRecord("MPaymentTerm/GetPaymentTerm",l),s!=null){if(c=s.Get_ID,a=s.Apply,c==0)return"PaymentTerm not found";r.setValue("IsPayScheduleValid",a?!0:!1)}}catch(v){this.setCalloutActive(!1);this.log.severe(v.toString())}return t=i=r=u=f=e=null,""};f.prototype.Product=function(i,r,u,f,e,s){var l,a,c;if(this.isCalloutActive()||e==null||e.toString()=="")return u.setValue("VA038_AmortizationTemplate_ID",0),"";if(l=e,l==null||l==0)return"";this.setCalloutActive(!0);try{u.setValue("C_Charge_ID",null);u.setValue("M_AttributeSetInstance_ID",null);var v=u.getValue("QtyInvoiced"),y=i.getContextAsInt(r,"M_AttributeSetInstance_ID"),p=u.getValue("C_Invoice_ID").toString().concat(",",l.toString(),",",y.toString(),",",v.toString()),h=n.dataContext.getJSONRecord("MInvoice/GetInvoiceProductInfo",p);o=t.getValueOfInt(h.countEd011);a=t.getValueOfString(h.IsSOTrx)=="Y";c=0;o>0&&(c=t.getValueOfInt(h.purchasingUom),c>0&&a==!1?u.setValue("C_UOM_ID",c):u.setValue("C_UOM_ID",t.getValueOfInt(h.headerUom)));u.findColumn("C_RevenueRecognition_ID")>-1&&u.setValue("C_RevenueRecognition_ID",t.getValueOfInt(h.C_RevenueRecognition_ID));u.setValue("PriceList",t.getValueOfDecimal(h.PriceList));u.setValue("PriceLimit",t.getValueOfDecimal(h.PriceLimit));u.setValue("PriceActual",t.getValueOfDecimal(h.PriceActual));u.setValue("PriceEntered",t.getValueOfDecimal(h.PriceEntered));u.setValue("C_Currency_ID",t.getValueOfInt(h.C_Currency_ID));u.setValue("PrintDescription",t.getValueOfString(h.DocumentNote));o>0&&c>0&&a==!1&&u.setValue("QtyInvoiced",t.getValueOfDecimal(h.QtyInvoiced));i.setContext(r,"EnforcePriceLimit",t.getValueOfString(h.EnforcePriceLimit)?"Y":"N");i.setContext(r,"DiscountSchema",t.getValueOfString(h.DiscountSchema)?"Y":"N")}catch(w){this.setCalloutActive(!1);this.log.severe(w.toString())}return this.setCalloutActive(!1),s=null,this.Tax(i,r,u,f,e)};f.prototype.Charge=function(i,r,u,f,e,o){var h,c,l,s;if(e==null||e.toString()=="")return u.setValue("VA038_AmortizationTemplate_ID",0),"";s=null;try{if(h=e,h==null||h==0)return"";if(u.getValue("M_Product_ID")!=null)return u.setValue("C_Charge_ID",null),"ChargeExclusively";u.setValue("M_AttributeSetInstance_ID",null);u.setValue("S_ResourceAssignment_ID",null);c=i.getContextAsInt("#C_UOM_ID");c>0?u.setValue("C_UOM_ID",c):u.setValue("C_UOM_ID",100);i.setContext(r,"DiscountSchema","N");l=n.dataContext.getJSONRecord("MInvoice/GetPercision",u.getValue("C_Invoice_ID").toString());s=n.dataContext.getJSONRecord("MCharge/GetChargeDetails",h.toString());s!=null&&(u.setValue("PriceEntered",t.getValueOfDecimal(s.ChargeAmt).toFixed(l)),u.setValue("PrintDescription",t.getValueOfString(s.PrintDescription)),u.setValue("PriceActual",t.getValueOfDecimal(s.ChargeAmt).toFixed(l)),u.setValue("PriceLimit",0),u.setValue("PriceList",0),u.setValue("Discount",0));u.setValue("PriceLimit",n.Env.ZERO);u.setValue("PriceList",n.Env.ZERO);u.setValue("Discount",n.Env.ZERO)}catch(a){return this.setCalloutActive(!1),a.message}return o=null,this.Tax(i,r,u,f,e)};f.prototype.Tax=function(i,r,u,f,e,o){var y,p,l,h,c,w,a,b,k,d,nt,v;if(e==null||e.toString()==""||t.getValueOfInt(u.getValue("C_Charge_ID"))==0&&t.getValueOfInt(u.getValue("M_Product_ID"))==0)return"";y=f.getColumnName();try{var g="",tt=t.getValueOfString(u.getValue("C_Invoice_ID")).concat(",",t.getValueOfString(u.getValue("M_Product_ID"))+","+t.getValueOfString(u.getValue("C_Charge_ID"))),s=n.dataContext.getJSONRecord("MInvoice/GetTax",tt),it=t.getValueOfInt(s._CountVATAX),ut=i.getWindowContext(r,"IsSOTrx",!0)=="Y";if(it>0&&(g=t.getValueOfString(s.taxRule)),g=="T")if(p=t.getValueOfInt(s.taxId),p>0)u.setValue("C_Tax_ID",p);else{if(t.getValueOfInt(u.getValue("M_Product_ID"))>0)return u.setValue("M_Product_ID",""),this.setCalloutActive(!1),s.TaxExempt=="Y"?n.ADialog.info("TaxNoExemptFound"):n.ADialog.info("VATAX_DefineTax");if(t.getValueOfInt(u.getValue("C_Charge_ID"))>0)return u.setValue("C_Charge_ID",""),this.setCalloutActive(!1),s.TaxExempt=="Y"?n.ADialog.info("TaxNoExemptFound"):n.ADialog.info("VATAX_DefineChargeTax")}else{if((l=0,l=y.toString()=="M_Product_ID"?e:i.getContextAsInt(r,"M_Product_ID"),h=0,h=y.toString()=="C_Charge_ID"?e:i.getContextAsInt(r,"C_Charge_ID"),this.log.fine("Product="+l+", C_Charge_ID="+h),l==0&&h==0)||(c=i.getContextAsInt(r,"C_BPartner_Location_ID"),c==0))return this.Amt(i,r,u,f,e);this.log.fine("Ship BP_Location="+c);w=c;this.log.fine("Bill BP_Location="+w);a=i.getContext("DateInvoiced");this.log.fine("Bill Date="+a);b=a;this.log.fine("Ship Date="+b);k=i.getContextAsInt(r,"AD_Org_ID");this.log.fine("Org="+k);d=i.getContextAsInt("#M_Warehouse_ID");this.log.fine("Warehouse="+d);nt=h.toString().concat(",",a.toString(),b.toString(),",",k.toString(),",",d.toString(),",",w.toString(),",",c.toString(),",",i.getWindowContext(r,"IsSOTrx",!0).equals("Y"));v=t.getValueOfInt(n.dataContext.getJSONRecord("MTax/Get",nt));this.log.info("Tax ID="+v);v==0||u.setValue("C_Tax_ID",v)}}catch(rt){this.setCalloutActive(!1);this.log.severe(rt.toString())}return o=null,this.Amt(i,r,u,f,e)};f.prototype.Amt=function(r,u,f,e,o,s){var k,tt,h,c,v,it,p,ht,ct,lt,l,ft,et,d,a,g,ot;if(this.isCalloutActive()||o==null||o.toString()==""||t.getValueOfInt(f.getValue("C_Charge_ID"))==0&&t.getValueOfInt(f.getValue("M_Product_ID"))==0)return"";this.setCalloutActive(!0);try{this.log.log(i.WARNING,"amt - init");var st=r.getContextAsInt(u,"C_UOM_ID"),vt=r.getContextAsInt(u,"M_Product_ID"),yt=r.getContextAsInt(u,"M_PriceList_ID"),pt=r.getWindowContext(u,"IsSOTrx",!0)=="Y",wt=yt.toString(),w=n.dataContext.getJSONRecord("MPriceList/GetPriceList",wt);var nt=2,b=2,y="Y",ut="N";if(w!=null&&(b=w.StdPrecision,nt=w.PriceListPrecision,y=t.getValueOfString(w.EnforcePriceLimit),ut=t.getValueOfString(w.IsTaxIncluded)),ct=t.getValueOfInt(f.getValue("C_OrderLine_ID")),k=f.getValue("QtyEntered"),tt=f.getValue("QtyInvoiced"),this.log.fine("QtyEntered="+k+", Invoiced="+tt+", UOM="+st),h=f.getValue("PriceEntered"),c=f.getValue("PriceActual"),v=f.getValue("PriceLimit"),p=f.getValue("PriceList"),this.log.fine("PriceList="+p+", Limit="+v+", Precision="+nt),this.log.fine("PriceEntered="+h+", Actual="+c),e.getColumnName()=="QtyEntered",(e.getColumnName()=="QtyInvoiced"||e.getColumnName()=="QtyEntered"||e.getColumnName()=="M_Product_ID")&&!1==r.getContext("DiscountSchema")?(lt=r.getContextAsInt(u,"C_BPartner_ID"),tt==null&&(tt=k),ct==0&&(rt=vt.toString().concat(",",f.getValue("C_Invoice_ID").toString()+","+t.getValueOfString(f.getValue("M_AttributeSetInstance_ID"))+","+st.toString()+","+r.getAD_Client_ID().toString()+","+lt.toString()+","+k.toString()),l=n.dataContext.getJSONRecord("MInvoice/GetPrices",rt),ft="N",l!=null&&((e.getColumnName()=="M_Product_ID"||t.getValueOfDecimal(l.PriceList)!=0&&f.getValue("PriceList")==0)&&(p=l.PriceList,f.setValue("PriceList",p)),h=l.PriceEntered,ht=t.getValueOfString(l.DiscountSchema),ft=t.getValueOfString(l.IsDiscountApplied),(e.getColumnName()=="M_Product_ID"||t.getValueOfDecimal(l.PriceLimit)!=0&&f.getValue("PriceLimit")==0)&&f.setValue("PriceLimit",l.PriceLimit)),this.log.fine("amt - QtyChanged -> PriceActual="+h+", PriceEntered="+h),c=h,(e.getColumnName()=="M_Product_ID"||h!=0&&f.getValue("PriceEntered")==0||ft.equals("Y")&&h!=0)&&(f.setValue("PriceActual",c),f.setValue("PriceEntered",h))),r.setContext(u,"DiscountSchema",ht?"Y":"N")):e.getColumnName()=="PriceActual"?(c=t.getValueOfDecimal(o.toFixed(nt)),h=c,this.log.fine("amt - PriceActual="+c+" -> PriceEntered="+h),f.setValue("PriceEntered",h),f.SetValue("PriceActual",c)):e.getColumnName()=="PriceEntered"&&(h=t.getValueOfDecimal(o.toFixed(nt)),c=h,c==null&&(c=h),this.log.fine("amt - PriceEntered="+h+" -> PriceActual="+c),f.setValue("PriceActual",c),f.setValue("PriceEntered",h)),et=!1,d=pt&&y!=null&&y=="Y",y==""){var rt=t.getValueOfInt(f.getValue("C_Invoice_ID")).toString(),at=n.dataContext.getJSONRecord("MInvoice/GetInvoice",rt),bt="SELECT EnforcePriceLimit FROM M_PriceList WHERE IsActive = 'Y' AND M_PriceList_ID = "+at.M_PriceList_ID;y=n.DB.executeScalar(bt);d=at.IsSOTrx&&y!=null&&y=="Y"}if(et=n.MRole.getDefault().getIsOverwritePriceLimit(),d&&et&&(d=!1),d&&t.getValueOfDouble(v)!=0&&c.compareTo(v)<0&&(c=v,h=c,h==null&&(h=v),this.log.fine("amt =(under) PriceEntered="+h+", Actual"+v),f.setValue("PriceActual",v),f.setValue("PriceEntered",h),n.ADialog.info("UnderLimitPrice"),t.getValueOfInt(p)!=0&&(it=(p-c)/p*100,t.scale(it)>2&&(it=it.toFixed(2)))),h=t.getValueOfDecimal(f.getValue("PriceEntered")),a=k*h,t.scale(a)>b&&(a=t.getValueOfDecimal(a.toFixed(b))),this.log.info("amt = LineNetAmt="+a),f.setValue("LineNetAmt",a),g=n.Env.ZERO,e.getColumnName()=="TaxAmt")g=f.getValue("TaxAmt");else if(ot=f.getValue("C_Tax_ID"),ot!=null){var kt=ot,ut=this.IsTaxIncluded(u,r),rt=kt.toString().concat(",",a.toString(),",",ut,",",b.toString()),w=null;g=n.dataContext.getJSONRecord("MTax/CalculateTax",rt);f.setValue("TaxAmt",g);f.getField("SurchargeAmt")!=null&&f.setValue("SurchargeAmt",0)}ut?f.setValue("LineTotalAmt",t.getValueOfDecimal(a)):f.setValue("LineTotalAmt",t.getValueOfDecimal((a+g).toFixed(b)))}catch(dt){this.setCalloutActive(!1);this.log.severe(dt.toString())}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};f.prototype.IsTaxIncluded=function(t,i){var r=i.getContext("IsTaxIncluded"),u;try{if(r.toString().length==0){if(u=i.getContextAsInt(t,"M_PriceList_ID"),u==0)return!1;r=n.dataContext.getJSONRecord("MPriceList/GetTaxIncluded",u.toString());r==null&&(r="N");i.setContext(t,"IsTaxIncluded",r)}}catch(f){this.setCalloutActive(!1);this.log.severe(f.toString())}return i=t=mTab=mField=value=oldValue=null,"Y"==r};f.prototype.Qty=function(r,u,f,e,s,h){var y,w,l,c,nt,b,it,ot,k,rt,ut,ft,et,v,d,a,p;if(this.isCalloutActive()||s==null||s.toString()==""||t.getValueOfInt(f.getValue("C_Charge_ID"))==0&&t.getValueOfInt(f.getValue("M_Product_ID"))==0)return"";this.setCalloutActive(!0);try{if(y="",w=r.getContextAsInt(u,"M_Product_ID"),this.log.log(i.WARNING,"qty - init - M_Product_ID="+w),w==0)c=f.getValue("QtyEntered"),f.setValue("QtyInvoiced",c);else if(e.getColumnName().toString().equals("C_UOM_ID")||e.getColumnName().toString().equals("M_AttributeSetInstance_ID"))a=t.getValueOfInt(f.getValue("C_UOM_ID")),c=f.getValue("QtyEntered"),it=r.getContextAsInt(u,"C_BPartner_ID",!1),ot=n.dataContext.getJSONRecord("MBPartner/GetBPartner",it.toString()),y=w.toString().concat(",",f.getValue("C_Invoice_ID").toString()+","+t.getValueOfString(f.getValue("M_AttributeSetInstance_ID"))+","+a.toString()+","+r.getAD_Client_ID().toString()+","+it.toString()+","+c.toString()),k=n.dataContext.getJSONRecord("MInvoice/GetPrices",y),k!=null&&(o=k.countEd011,rt=k.countVAPRC,o<=0&&rt<=0?(v=null,c!=null&&(y=a.toString(),d=n.dataContext.getJSONRecord("MUOM/GetPrecision",y),v=c.toFixed(d)),c!=v&&(this.log.fine("Corrected QtyEntered Scale UOM="+a+"; QtyEntered="+c+"->"+v),c=v,f.setValue("QtyEntered",c)),y=w.toString().concat(",",a.toString(),",",c.toString()),l=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",y),l==null&&(l=c),p=c!=l,nt=f.getValue("PriceActual"),y=w.toString().concat(",",a.toString(),",",nt.toString()),b=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",y),b==null&&(b=nt),this.log.fine("qty - UOM="+a+", QtyEntered/PriceActual="+c+"/"+nt+" -> "+p+" QtyInvoiced/PriceEntered="+l+"/"+b),r.setContext(u,"UOMConversion",p?"Y":"N"),f.setValue("QtyInvoiced",l),f.setValue("PriceEntered",b)):(ut=k.PriceList,f.setValue("PriceList",ut),b=k.PriceEntered,f.setValue("PriceLimit",k.PriceLimit),f.setValue("PriceActual",b),f.setValue("PriceEntered",b),y=a.toString().concat(","),ft=n.dataContext.getJSONRecord("MUOM/GetPrecision",y),v=c.toFixed(t.getValueOfInt(ft)),c!=v&&(this.log.fine("Corrected QtyEntered Scale UOM="+a+"; QtyEntered="+c+"->"+v),c=v,f.setValue("QtyEntered",c)),y=w.toString().concat(",",a.toString(),",",c.toString()),et=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",y),l=et,p=!1,l!=null&&(p=c!=l),l==null&&(p=!1,l=1),p?f.setValue("QtyInvoiced",l):f.setValue("QtyInvoiced",l*v)));else if(e.getColumnName().equals("QtyEntered"))a=r.getContextAsInt(u,"C_UOM_ID"),c=s,v=null,c!=null&&(d=n.dataContext.getJSONRecord("MUOM/GetPrecision",a.toString()),v=c.toFixed(d)),c!=v&&(this.log.fine("Corrected QtyEntered Scale UOM="+a+"; QtyEntered="+c+"->"+v),c=v,f.setValue("QtyEntered",c)),g=w.toString().concat(",",a.toString(),",",c.toString()),l=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",g),l==null&&(l=c),p=c!=l,this.log.fine("qty - UOM="+a+", QtyEntered="+c+" -> "+p+" QtyInvoiced="+l),r.setContext(u,"UOMConversion",p?"Y":"N"),f.setValue("QtyInvoiced",l);else if(e.getColumnName().equals("QtyInvoiced")){a=r.getContextAsInt(u,"C_UOM_ID");l=s;var g=w.toString(),d=n.dataContext.getJSONRecord("MProduct/GetUOMPrecision",g),tt=null;l!=null&&(tt=t.getValueOfDecimal(l.toFixed(d)));l!=tt&&(this.log.fine("Corrected QtyInvoiced Scale "+l+"->"+tt),l=tt,f.setValue("QtyInvoiced",l));g=w.toString().concat(",",a.toString(),",",l.toString());c=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",g);c==null&&(c=l);p=l!=c;this.log.fine("qty - UOM="+a+", QtyInvoiced="+l+" -> "+p+" QtyEntered="+c);r.setContext(u,"UOMConversion",p?"Y":"N");f.setValue("QtyEntered",c)}}catch(st){this.setCalloutActive(!1);this.log.severe(st.toString())}finally{this.setCalloutActive(!1)}return r=u=f=e=s=h=null,""};f.prototype.PriceList=function(r,u,f,e,o,s){var h=null,c,l,a;try{if(o==null||o.toString()==""||(c=t.getValueOfInt(o.toString()),c==null||c==0))return"";h=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",o.toString());h!=null&&(f.setValue("IsTaxIncluded",Boolean("Y".equals(h.IsTaxIncluded))),r.setContext(u,"EnforcePriceLimit",h.EnforcePriceLimit),l=t.getValueOfInt(h.C_Currency_ID),f.setValue("C_Currency_ID",l),a=h.M_PriceList_Version_ID,r.setContext(u,"M_PriceList_Version_ID",a))}catch(v){return this.setCalloutActive(!1),this.log.log(i.severe,null,v),v.message}return r=u=f=e=o=s=null,""};f.prototype.CheckDueDate=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()=="")return"";if(r.getValue("DateInvoiced")==null||r.getValue("DateInvoiced")=="")return this.setCalloutActive(!1),"";try{if(this.setCalloutActive(!0),r.getValue("DateInvoiced")!=null&&r.getValue("DueDate")!=null){var o=new Date(r.getValue("DateInvoiced")),s=new Date(r.getValue("DueDate"));s<o&&(n.ADialog.error("DueDateLessThanInvoiceDate"),r.setValue("DueDate",""))}t=i=r=u=f=e=null;this.setCalloutActive(!1)}catch(h){return this.setCalloutActive(!1),h}return""};n.Model.CalloutInvoice=f;n.Utility.inheritPrototype(p,n.CalloutEngine);p.prototype.Date=function(n,t,i,r,u,f){return u==null||u.toString()==""?"":(i.setValue("DateAcct",u),this.SetDocumentNo(n,t,i),n=t=i=r=u=f=null,"")};p.prototype.BPartner=function(i,r,u,f,e,o){var c,l,s,h,y,a,p,v,w,b,k;if(e==null||e.toString()==""||(c=t.getValueOfInt(e),c==null||c==0))return"";l=i.isSOTrx();s=null;try{s=n.dataContext.getJSONRecord("MBPartner/GetBPartnerData",c.toString());s!=null&&(h=t.getValueOfString(s[l?"PaymentRule":"PaymentRulePO"]),h!=null&&h.length!=0&&(i.getContext("DocBaseType").endsWith("C")?h="P":(this.isSOTrx&&h=="S"||h=="U")&&(h="P")),y=t.getValueOfInt(s[l?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"]),y>0&&u.setValue("C_PaymentTerm_ID",y),a=t.getValueOfInt(s.C_BPartner_Location_ID),c.toString().equals(i.getContext("C_BPartner_ID"))&&(p=i.getContext("C_BPartner_Location_ID"),p.toString().length>0&&(a=t.getValueOfInt(p))),a==0?u.setValue("C_BPartner_Location_ID",null):u.setValue("C_BPartner_Location_ID",t.getValueOfInt(a)),v=t.getValueOfInt(s.AD_User_ID),c.toString().equals(i.getContext("C_BPartner_ID"))&&(w=i.getContext("AD_User_ID"),w.toString().length>0&&(v=t.getValueOfInt(w))),v==0?u.setValue("AD_User_ID",null):u.setValue("AD_User_ID",t.getValueOfInt(v)),l&&(b=t.getValueOfDouble(s.SO_CreditLimit),b!=0&&(k=t.getValueOfDouble(s.CreditAvailable),s==null&&k<0&&n.ADialog.info("CreditLimitOver"))))}catch(d){return this.setCalloutActive(!1),d.message}return this.SetDocumentNo(i,r,u),o=null,this.Tax(i,r,u,f,e)};p.prototype.DocType=function(n,t,i,r,u,f){return this.SetDocumentNo(n,t,i),n=t=i=r=u=f=null,""};p.prototype.SetDocumentNo=function(i,r,u,f,e,o){var y=i.getContextAsInt(r,"C_InvoiceBatch_ID"),p=y.toString(),s=null,l,a,c,h,v;(s=n.dataContext.getJSONRecord("MInvoiceBatchLine/GetInvoiceBatchLineDetail",p),s!=null)&&(l=i.getContextAsInt(r,"C_DocType_ID"),a=i.getContextAsInt(r,"C_BPartner_ID"),l!=s.C_DocType_ID||a!=s.C_BPartner_ID)&&(c=s.DocumentNo,c!=null)&&(h=0,h=t.getValueOfInt(c),h!=0)&&(v=t.getValueOfString(h+1),u.setValue("DocumentNo",v),i=r=u=f=e=o=null)};p.prototype.Charge=function(r,u,f,e,o,s){var h,c;if(o==null||o.toString()==""||(h=t.getValueOfInt(o),h==null||t.getValueOfInt(h)==0))return"";try{c=n.dataContext.getJSONRecord("MCharge/GetCharge",h.toString());f.setValue("PriceEntered",t.getValueOfDecimal(c))}catch(l){return this.setCalloutActive(!1),this.log.log(i.severe,null,l),l.message}return s=null,this.Tax(r,u,f,e,o)};p.prototype.Tax=function(i,r,u,f,e){var p=f.getColumnName(),o,s,h,c,l,a,y,v;return e==null||e.toString()==""?"":(o=0,o=p.equals("C_Charge_ID")?t.getValueOfInt(e):i.getContextAsInt(r,"C_Charge_ID"),this.log.fine("C_Charge_ID="+o),o==0)?this.Amt(i,r,u,f,e):(s=i.getContextAsInt(r,"C_BPartner_Location_ID"),s==0)?this.Amt(i,r,u,f,e):(this.log.fine("BP_Location="+s),h=t.getValueOfDate(i.getContext("DateInvoiced")),this.log.fine("Bill Date="+h),c=h,this.log.fine("Ship Date="+c),l=i.getContextAsInt(r,"AD_Org_ID"),this.log.fine("Org="+l),a=i.getContextAsInt("#M_Warehouse_ID"),this.log.fine("Warehouse="+a),y=o.toString().concat(",",h.toString(),c.toString(),",",l.toString(),",",a.toString(),",",s.toString(),",",s.toString(),",",i.getWindowContext(r,"IsSOTrx",!0).equals("Y")),v=n.dataContext.getJSONRecord("MTax/Get",y),v==0||u.setValue("C_Tax_ID",t.getValueOfInt(v)),this.Amt(i,r,u,f,e))};p.prototype.Amt=function(i,r,u,f,e,o){var s,v,h,y;if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);var a=i.getStdPrecision(),c=t.getValueOfDecimal(u.getValue("QtyEntered")),l=t.getValueOfDecimal(u.getValue("PriceEntered"));if(this.log.fine("QtyEntered="+c+", PriceEntered="+l),c==null&&(c=n.Env.ZERO),l==null&&(l=n.Env.ZERO),s=c*l,t.scale(s)>a&&(s=s.toFixed(a)),v="Y"==i.getContext("IsTaxIncluded"),h=null,f.getColumnName().equals("TaxAmt"))h=u.getValue("TaxAmt");else if(y=u.getValue("C_Tax_ID"),y!=null){var p=t.getValueOfInt(y),w=p.toString().concat(",",s.toString(),",",v.toString(),",",a.toString());h=n.dataContext.getJSONRecord("MTax/CalculateTax",w);u.setValue("TaxAmt",h);u.getField("SurchargeAmt")!=null&&u.setValue("SurchargeAmt",0)}return v?(u.setValue("LineTotalAmt",s),u.setValue("LineNetAmt",t.getValueOfDecimal(s)*t.getValueOfDecimal(h))):(u.setValue("LineNetAmt",s),u.setValue("LineTotalAmt",t.getValueOfDecimal(s)+t.getValueOfDecimal(h))),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutInvoiceBatch=p;n.Utility.inheritPrototype(ai,n.CalloutEngine);ai.prototype.Product=function(r,u,f,e,o,s){var h,c,l,v,y,a;if(o==null||o.toString()=="")return f.setValue("MovementQty",1),f.setValue("QtyEntered",1),"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);try{if(h=o,h==null||h==0)return"";f.setValue("M_AttributeSetInstance_ID",null);c=n.dataContext.getJSONRecord("MProduct/GetC_UOM_ID",h.toString());f.setValue("C_UOM_ID",c);o!=s&&(f.setValue("MovementQty",1),f.setValue("QtyEntered",1));c=t.getValueOfDecimal(f.getValue("C_UOM_ID"));l=t.getValueOfDecimal(f.getValue("QtyEntered"));h=t.getValueOfInt(f.getValue("M_Product_ID"));v=h.toString().concat(",").concat(c.toString()).concat(",").concat(l.toString());y=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",v);QtyOrdered=y;a=!1;QtyOrdered!=null&&(a=l!=QtyOrdered);QtyOrdered==null&&(a=!1,QtyOrdered=1);a?f.setValue("MovementQty",QtyOrdered):f.setValue("MovementQty",QtyOrdered*l)}catch(p){return this.setCalloutActive(!1),this.log.log(i.severe,sql,p),p.message}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};n.Model.CalloutMovement=ai;n.Utility.inheritPrototype(vi,n.CalloutEngine);vi.prototype.Objectchk=function(i,r,u,f,o,s){var y,a,v,c,w,h,p,l;if(o==null||o.toString()==""||o==null||(y=t.getValueOfInt(u.getValue("FO_OBJECT_DATA_ID")),c=t.getValueOfDateTime(u.getValue("TODAYDATE")),y==null))return"";w="select FO_RES_ACCOMODATION_ID,DATE_FROM,TILL_DATE from FO_RES_ACCOMODATION where FO_OBJECT_DATA_ID=@FO_OBJ_DATA_ID";h=null;try{for(p=[],p[0]=new n.DB.SqlParam("@FO_OBJ_DATA_ID",y),h=n.DB.executeReader(w,p,null);h.read();){if((a=t.getValueOfDateTime(h[1]),v=t.getValueOfDateTime(h[2]),l=a,c.compareTo(v)>0)||c.compareTo(a)<0)return u.setValue("RES_STATUS",!1),"";if(c.compareTo(a)>0&&c.compareTo(v)<0)while(!(l.compareTo(v)==0))c.compareTo(l)==0&&u.setValue("RES_STATUS",!0),l=l.AddDays(1)}h.close()}catch(b){this.setCalloutActive(!1);h!=null&&h.close();this.log.severe(e.toString())}finally{h!=null&&h.close()}return i=r=u=f=o=s=null,""};n.Model.CalloutObjectData=vi;n.Utility.inheritPrototype(wt,n.CalloutEngine);wt.prototype.Datechk=function(i,r,u,f,e,o){var c,v,y,p,h,w;if(e==null||e.toString()==""||(c=t.getValueOfDateTime(e),c==null||c==0))return"";var b=u.getValue("AD_ORG_ID"),l=0,k="select  DAYSPAYABLE2 from FO_SETTINGS where AD_ORG_ID="+b,s=null;try{for(s=n.DB.executeReader(k,null,null);s.read();)l=t.getValueOfInt(s[0].toString());s.close()}catch(a){this.setCalloutActive(!1);s!=null&&s.close();this.log.severe(a.toString())}v=t.getValueOfDateTime(u.getValue("DATE1"));y=v.AddDays(l);u.setValue("DATE2",y);h=100;w="select max(OFFERNO)from FO_OFFER";try{for(s=n.DB.executeReader(w,null,null);s.read();)h=t.getValueOfInt(s[0].toString());s.close()}catch(a){this.setCalloutActive(!1);s!=null&&s.close();this.log.severe(a.toString())}finally{s!=null&&s.close()}return p=h==null|h==0?100:h+1,u.setValue("OFFERNO",p),i=r=u=f=e=o=null,""};wt.prototype.guestpricelist=function(i,r,u,f,e,o){var h;if(e==null||(h=t.getValueOfInt(e),h==null||h==0))return"";var l="select FO_PRICE_LIST_ID from FO_ADDRESS_PRICE where FO_ADDRESS_ID="+h,c=0,s=null;try{for(s=n.DB.executeReader(l,null,null);s.read();)c=t.getValueOfInt(s[0]);s.close()}catch(a){this.setCalloutActive(!1);s!=null&&s.close();this.log.severe(a.toString())}finally{s!=null&&s.close()}return u.setValue("FO_PRICE_LIST_ID",c),i=r=u=f=e=o=null,""};n.Model.CalloutOffer=wt;n.Utility.inheritPrototype(rt,n.CalloutEngine);rt.prototype.Period=function(i,r,u,f,e,o){var s,h,a,l;if(this.isCalloutActive()||e==null||e.toString()=="")return"";s=f.getColumnName();this.setCalloutActive(!0);var y=i.getContextAsInt(r,"AD_Client_ID",!1),p=t.getValueOfInt(u.getValue("AD_Org_ID")),c=new Date;if(c=s=="DateAcct"?e:u.getValue("DateAcct"),h=0,s=="C_Period_ID"&&(h=t.getValueOfInt(e)),s=="DateDoc")u.setValue("DateAcct",e);else if(s=="DateAcct"||s=="AD_Org_ID")a=y+","+c+","+p,h=t.getValueOfInt(n.dataContext.getJSONRecord("MPeriod/GetPeriod",a)),h!=0&&u.setValue("C_Period_ID",h);else if(l=n.dataContext.getJSONRecord("MPeriod/GetPeriodDetail",h.toString()),l!=null){var w=l.PeriodType,b=l.StartDate,v=l.EndDate;w=="S"&&(c==null||c<b||c>v)&&u.setValue("DateAcct",v)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};rt.prototype.Rate=function(r,u,f,o,s,h){var a;if(s==null||s.toString()=="")return"";try{var v=t.getValueOfInt(f.getValue("C_Currency_ID")),y=t.getValueOfInt(v),p=t.getValueOfInt(f.getValue("C_ConversionType_ID")),w=t.getValueOfInt(p),l=f.getValue("DateAcct");l==null&&(a=new Date,l=a.toGMTString());var b=t.getValueOfInt(r.getContextAsInt(u,"C_AcctSchema_ID",!1)),k=b,d=n.dataContext.getJSONRecord("MAcctSchema/GetAcctSchema",k),g=t.getValueOfInt(r.getContextAsInt(u,"AD_Client_ID",!1)),nt=t.getValueOfInt(r.getContextAsInt(u,"AD_Org_ID",!1)),tt=y+","+d.C_Currency_ID+","+l+","+w+","+g+","+nt,c=n.dataContext.getJSONRecord("MConversionRate/GetRate",tt);this.log.fine("rate = "+c);c==null&&(c=0);f.setValue("CurrencyRate",c)}catch(it){return this.log.log(i.SEVERE,sql,e),this.setCalloutActive(!1),e.message}return r=u=f=o=s=h=null,""};rt.prototype.Amt=function(i,r,u,f,e,o){var h,c,l,a;if(e==null||e.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);var y=t.getValueOfInt(i.getContextAsInt(r,"C_AcctSchema_ID")),p=y.toString(),w=n.dataContext.getJSONRecord("MAcctSchema/GetAcctSchema",p),v=w.StdPrecision,s=u.getValue("CurrencyRate");return s==null&&(s=1,u.setValue("CurrencyRate",s)),h=u.getValue("AmtSourceDr"),h==null&&(h=0),c=u.getValue("AmtSourceCr"),c==null&&(c=0),l=h*s,l.toFixed(v),u.setValue("AmtAcctDr",l),a=c*s,a.toFixed(v),u.setValue("AmtAcctCr",a),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutGLJournal=rt;n.Utility.inheritPrototype(ut,n.CalloutEngine);ut.prototype.Product=function(n,t,i,r,u,f){if(u==null||u.toString()=="")return"";var e=u;return e==null||e==0?"":(i.setValue("M_AttributeSetInstance_ID",null),n=t=i=r=u=f=null,"")};ut.prototype.SetAttributeSetInstance=function(t,i,r,u,f,e){if(f==null||f.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);try{var o=f.toString(),s=n.dataContext.getJSONRecord("MProductionLine/GetAttributeSetInstance",o);r.setValue("M_AttributeSetInstance_ID",s)}catch(h){this.setCalloutActive(!1);this.log.severe(h.toString())}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};ut.prototype.SetBOM=function(t,i,r,u,f,e){var o,s;if(f==null||f.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);try{u.getColumnName().equals("M_Product_ID")?(r.setValue("M_AttributeSetInstance_ID",0),o=f.toString().concat(",",0)):u.getColumnName().equals("M_AttributeSetInstance_ID")&&(o=r.getValue("M_Product_ID").toString().concat(",",f.toString()));s=n.dataContext.getJSONRecord("MProductionLine/GetBOM",o);r.setValue("M_BOM_ID",s)}catch(h){this.setCalloutActive(!1);this.log.severe(h.toString())}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};n.Model.CalloutProduction=ut;n.Utility.inheritPrototype(ft,n.CalloutEngine);ft.prototype.CopyMail=function(r,u,f,e,o,s){var v=e.getColumnName(),c;if(this.log.info(v+"="+o),o==null||o.toString()=="")return"";var y=t.getValueOfInt(o),l="SELECT MailHeader, MailText FROM R_MailText WHERE R_MailText_ID=@Param1",a=[],h=null;try{a[0]=new n.DB.SqlParam("@Param1",t.getValueOfInt(y));h=n.DB.executeReader(l,a,null);h.read()&&(c=h.get("mailtext"),c=n.Env.parseContext(r,u,c,!1,!0),f.setValue("Result",c));h.close()}catch(p){this.setCalloutActive(!1);h!=null&&h.close();this.log.log(i.SEVERE,l,p)}return r=u=f=e=o=s=null,""};ft.prototype.CopyResponse=function(r,u,f,e,o,s){var v=e.getColumnName(),c;if(this.log.info(v+"="+o),o==null||o.toString()=="")return"";var y=t.getValueOfInt(o),l="SELECT Name, ResponseText FROM R_StandardResponse WHERE R_StandardResponse_ID=@Param1",a=[],h=null;try{a[0]=new n.DB.SqlParam("@Param1",t.getValueOfInt(y));h=n.DB.executeReader(l,a,null);h.read()&&(c=h.get("responsetext"),c=n.Env.parseContext(r,u,c,!1,!0),f.setValue("Result",c));h.close()}catch(p){this.setCalloutActive(!1);h!=null&&h.close();this.log.log(i.SEVERE,l,p)}return r=u=f=e=o=s=null,""};ft.prototype.Type=function(i,r,u,f,e,o){var l=f.getColumnName(),s,c,h;return(this.log.info(l+"="+e),u.setValue("R_Status_ID",null),e==null||e.toString()=="")?"":(s=t.getValueOfInt(e),s==0)?"":(c=s.toString(),h=n.dataContext.getJSONRecord("MRequestType/GetDefaultR_Status_ID",c),h!=0&&u.setValue("R_Status_ID",t.getValueOfInt(h)),i=r=u=f=e=o=null,"")};n.Model.CalloutRequest=ft;n.Utility.inheritPrototype(tt,n.CalloutEngine);tt.prototype.Product=function(i,r,u,f,e,o){var h,s,v,c;try{if(this.isCalloutActive()||e==null||e.toString()==""||(h=e,h==null||h==0))return"";this.setCalloutActive(!0);u.setValue("M_AttributeSetInstance_ID",null);var y=i.getContextAsInt(r,"C_BPartner_ID"),p=u.getValue("Qty"),w=i.getContextAsInt(r,"M_PriceList_ID"),b=i.getContextAsInt(r,"M_PriceList_Version_ID"),k=i.getContext(r,"DateDoc"),l,a=n.dataContext.getJSONRecord("MProduct/GetC_UOM_ID",h);l=h.toString().concat(",",y,",",p,",",!1,",",w,",",b,",",k,",",null,",",a,",",1);s=null;s=n.dataContext.getJSONRecord("MProductPricing/GetProductPricing",l);u.setValue("PriceActual",s.PriceActual);u.setValue("PrintDescription",t.getValueOfString(s.DocumentNote));i.setContext(r,"EnforcePriceLimit",s.EnforcePriceLimit?"Y":"N");i.setContext(r,"DiscountSchema",s.DiscountSchema?"Y":"N");u.setValue("C_UOM_ID",a);v=u.getValue("M_Requisition_ID").toString()+","+i.getAD_Client_ID().toString()+","+e.toString();c=n.dataContext.getJSONRecord("MOrderLine/GetReqOrderLine",v);c>0&&u.setValue("C_OrderLine_ID",c)}catch(d){return this.setCalloutActive(!1),d.message}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};tt.prototype.Charge=function(i,r,u,f,e,o){var s,c,h;try{if(this.isCalloutActive()||e==null||e.toString()=="")return"";if(this.setCalloutActive(!0),s=t.getValueOfInt(e),s==null||s==0)return this.setCalloutActive(!1),"";u.getValue("M_Product_ID")!=null&&u.setValue("M_Product_ID",null);u.setValue("M_AttributeSetInstance_ID",null);c=i.getContextAsInt("#C_UOM_ID");c>0?u.setValue("C_UOM_ID",c):u.setValue("C_UOM_ID",100);h=n.dataContext.getJSONRecord("MCharge/GetChargeDetails",s.toString());h!=null&&(u.setValue("PriceActual",t.getValueOfDecimal(h.ChargeAmt)),u.setValue("PrintDescription",t.getValueOfString(h.PrintDescription)))}catch(l){return this.setCalloutActive(!1),l.message}return this.setCalloutActive(!1),o=null,""};tt.prototype.Amt=function(i,r,u,f,e,o){var y,a,h;if(e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";try{this.setCalloutActive(!0);var c=i.getStdPrecision(),l=c,v=i.getContextAsInt(r,"M_PriceList_ID"),s;if(v!=0&&(s=n.dataContext.getJSONRecord("MPriceList/GetPriceList",v.toString()),s!=null&&(c=t.getValueOfInt(s.StdPrecision),l=t.getValueOfInt(s.PriceListPrecision))),f.getColumnName()=="Qty"&&"Y"==i.getContext("DiscountSchema")){var p=i.getContextAsInt(r,"M_Product_ID"),w=i.getContextAsInt(r,"C_BPartner_ID"),b=e,k=i.getContextAsInt(r,"M_PriceList_Version_ID"),d=u.getValue("DateInvoiced"),g=p.concat(",",w,",",b,",",!1,",",v,",",k,",",d,",",null),s=null;s=n.dataContext.getJSONRecord("MProductPricing/GetProductPricing",g);u.setValue("PriceActual",t.getValueOfDecimal(s.PriceActual.toFixed(l)))}y=u.getValue("QtyEntered");a=u.getValue("PriceActual");this.log.fine("amt - Qty="+y+", Price="+a+", Precision="+l);h=y*a;t.scale(h)>c&&(h=h.toFixed(c));u.setValue("LineNetAmt",h);u.setValue("PriceActual",t.getValueOfDecimal(a.toFixed(l)));this.log.info("amt - LineNetAmt="+h)}catch(nt){this.setCalloutActive(!1);this.log.saveError("CalloutRequisation",nt)}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};tt.prototype.Qty=function(i,r,f,e,o,s){var p="",y,it,ut,a,w,l,rt,nt,k,d,v;if(this.isCalloutActive()||o==null||o.toString()==""||(console.log("Before Charge Or Product"),t.getValueOfInt(f.getValue("M_Product_ID"))==0&&t.getValueOfInt(f.getValue("C_Charge_ID"))==0))return"";console.log("After Charge Or Product");this.setCalloutActive(!0);try{y=i.getContextAsInt(r,"M_Product_ID");u&&this.log.Warning("init - M_Product_ID="+y+" - ");var h=n.Env.ZERO,c=n.Env.ZERO,tt,g=i.getContextAsInt(r,"M_PriceList_ID");if(y==0)h=t.getValueOfDecimal(f.getValue("QtyEntered")),c=h,f.setValue("Qty",c);else if(e.getColumnName()=="C_UOM_ID"||e.getColumnName()=="M_AttributeSetInstance_ID"){a=t.getValueOfInt(f.getValue("C_UOM_ID"));h=t.getValueOfDecimal(f.getValue("QtyEntered"));it=i.getContextAsInt(r,"C_BPartner_ID");ut=e.getColumnName()=="M_AttributeSetInstance_ID"?t.getValueOfInt(f.getValue("M_AttributeSetInstance_ID")):i.getContextAsInt(r,"M_AttributeSetInstance_ID");var ot=i.getContext(r,"DateDoc"),w=2,ft=y.toString().concat(",",f.getValue("M_Requisition_ID").toString()+","+t.getValueOfString(f.getValue("M_AttributeSetInstance_ID"))+","+t.getValueOfString(f.getValue("C_UOM_ID"))+","+i.getAD_Client_ID().toString()+","+t.getValueOfString(it)+","+h.toString()+","+g.toString()),b=n.dataContext.getJSONRecord("MProductPricing/GetPricesOnChange",ft);b!=null&&(f.setValue("PriceActual",t.getValueOfDecimal(b.PriceEntered)),w=t.getValueOfInt(b.UOMPrecision),c=b.QtyOrdered);l=h.toFixed(t.getValueOfInt(w));h!=l&&(this.log.fine("Corrected QtyEntered Scale UOM="+a+"; QtyEntered="+h+"->"+l),h=l,f.setValue("QtyEntered",h));c==null&&(c=h);f.setValue("Qty",c)}else e.getColumnName()=="QtyEntered"&&(a=i.getContextAsInt(r,"C_UOM_ID"),h=t.getValueOfDecimal(o),p=a.toString().concat(","),w=n.dataContext.getJSONRecord("MUOM/GetPrecision",p),l=h.toFixed(t.getValueOfInt(w)),h!=l&&(this.log.fine("Corrected QtyEntered Scale UOM="+a+"; QtyEntered="+h+"->"+l),h=l,f.setValue("QtyEntered",h)),p=y.toString().concat(",",a.toString(),",",h.toString()),rt=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",p),c=rt,c==null&&(c=h),nt=h!=c,this.log.fine("UOM="+a+", QtyEntered="+h+" -> "+nt+" Qty="+c),i.setContext(r,"UOMConversion",nt?"Y":"N"),f.setValue("Qty",c));tt=t.getValueOfDecimal(f.getValue("PriceActual"));k=i.getStdPrecision();g>0&&(d=n.dataContext.getJSONRecord("MPriceList/GetPriceList",g.toString()),d!=null&&(k=t.getValueOfInt(d.StdPrecision)),d=null);v=h*tt;t.scale(v)>k&&(v=v.toFixed(k));f.setValue("LineNetAmt",v);this.log.info("amt - LineNetAmt="+v)}catch(et){return this.setCalloutActive(!1),et}return this.setCalloutActive(!1),i=r=f=e=o=s=null,""};n.Model.CalloutRequisition=tt;n.Utility.inheritPrototype(bt,n.CalloutEngine);bt.prototype.PayAmt=function(n,i,r,u,f,e){var o,h,s;if(this.isCalloutActive()||f==null||f==""||(o=t.getValueOfInt(r.getValue("C_Invoice_ID")),o==null)||(h=o,h==0))return"";var c=t.getValueOfDecimal(r.getValue("OpenAmt")),l=t.getValueOfDecimal(r.getValue("PayAmt")),a=t.getValueOfDecimal(r.getValue("DiscountAmt"));return this.setCalloutActive(!0),s=c-l-a,this.log.fine(" - OpenAmt="+c+" - PayAmt="+l+", Discount="+a+", Difference="+s),r.setValue("DifferenceAmt",s),this.setCalloutActive(!1),n=i=r=u=f=e=null,""};bt.prototype.Invoice=function(i,r,u,f,e,o){var h,v;if(this.isCalloutActive()||e==null||e==""||(h=t.getValueOfInt(e),h==0))return"";this.setCalloutActive(!0);var a=i.getContextAsInt(r,"C_BankAccount_ID"),y=i.getContext("PayDate"),c=n.Env.ZERO,l=n.Env.ZERO,s=null;try{v=h.toString()+", "+a.toString()+","+y.toString();s=n.dataContext.getJSONRecord("MInvoice/GetInvoiceOpenDetail",v);s!=null&&Object.keys(s).length>0&&(c=t.getValueOfDecimal(s.OpenAmt),l=t.getValueOfDecimal(s.DiscountAmt),IsSOTrx="Y"==t.getValueOfString(s.IsSOTrx))}catch(p){this.setCalloutActive(!1)}return this.log.fine(" - OpenAmt="+c+" (Invoice="+h+",BankAcct="+a+")"),u.setValue("OpenAmt",c),u.setValue("PayAmt",c-l),u.setValue("DiscountAmt",l),u.setValue("DifferenceAmt",n.Env.ZERO),u.setValue("IsSOTrx",!1),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutPaySelection=bt;n.Utility.inheritPrototype(et,n.CalloutEngine);et.prototype.EndDate=function(i,r,u,f,e,o){if(e==null||e.toString()=="")return"";var h=new Date(u.getValue("StartDate")),c=t.getValueOfInt(u.getValue("C_Frequency_ID")),l="Select NoOfMonths from C_Frequency where C_Frequency_ID="+c,v=t.getValueOfInt(n.DB.executeScalar(l,null,null)),a=t.getValueOfInt(u.getValue("NoofCycle")),s=h.getDate()+"/"+(h.getMonth()+months*a)+"/"+h.getFullYear();return s=s<=0?new Date:new Date(s),s=s.toISOString(),u.setValue("EndDate",s),i=r=u=f=e=o=null,""};et.prototype.Qty=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var s=t.getValueOfDecimal(f),h=t.getValueOfDecimal(r.getValue("QtyPerCycle")),o=s*h;return r.setValue("QtyEntered",o),r.setValue("QtyOrdered",o),n=i=r=u=f=e=null,""};et.prototype.QtyPerCycle=function(n,i,r,u,f,e){if(f==null||f.toString()=="")return"";var s=t.getValueOfDecimal(f),h=t.getValueOfDecimal(r.getValue("NoofCycle")),o=h*s;return r.setValue("QtyEntered",o),r.setValue("QtyOrdered",o),n=i=r=u=f=e=null,""};n.Model.CalloutOrderLine=et;n.Utility.inheritPrototype(yi,n.CalloutEngine);yi.prototype.Orderline=function(i,r,u,f,e,o){if(e==null||e.toString()==""||t.getValueOfInt(e)==0||this.isCalloutActive())return"";try{this.setCalloutActive(!0);var h=t.getValueOfInt(e),s=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",h);u.setValue("M_Product_ID",s.M_Product_ID);u.setValue("Qty",s.Qty);u.setValue("C_UOM_ID",s.C_UOM_ID);u.setValue("C_BPartner_ID",s.C_BPartner_ID);u.setValue("PlannedHours",s.PlannedHours);this.setCalloutActive(!1)}catch(c){this.setCalloutActive(!1)}return i=r=u=f=e=o=null,""};n.Model.CalloutOrderlineRecording=yi;n.Utility.inheritPrototype(pi,n.CalloutEngine);pi.prototype.Currency=function(t,i,r,u,f,e){if(f==null||f.toString()=="")return"";try{var o=n.dataContext.getJSONRecord("MPriceList/GetPriceList",f.toString());o!=null&&r.setValue("C_Currency_ID",o.C_Currency_ID)}catch(s){this.setCalloutActive(!1)}return t=i=r=u=f=e=null,""};n.Model.CalloutCurrency=pi;n.Utility.inheritPrototype(wi,n.CalloutEngine);wi.prototype.Qty=function(i,r,u,f,e,o){var c,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";var y=t.getValueOfDecimal(u.getValue("PriceActual")),p=t.getValueOfDecimal(u.getValue("QtyEntered")),l=0,w=n.Env.ZERO,s=n.Env.ZERO;if(u.setValue("LineNetAmt",y*p),l=t.getValueOfInt(u.getValue("C_Tax_ID")),u.getField("SurchargeAmt")!=null){var b=0,a=!1,v=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",u.getValue("M_PriceList_ID").toString());v!=null&&(b=v.StdPrecision,a="Y"==v.IsTaxIncluded);h=t.getValueOfDecimal(u.getValue("LineNetAmt"));c=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",l.toString()+","+h.toString()+","+b.toString()+","+a.toString());s=c.TaxAmt;u.setValue("TaxAmt",s);u.setValue("SurchargeAmt",c.SurchargeAmt);a?u.setValue("GrandTotal",h):u.setValue("GrandTotal",h+s+c.SurchargeAmt)}else w=n.dataContext.getJSONRecord("MTax/GetTaxRate",l.toString()),h=t.getValueOfDecimal(u.getValue("LineNetAmt")),s=t.getValueOfDecimal(t.getValueOfDecimal(h)*t.getValueOfDecimal(w)/100),s=s.toFixed(2),u.setValue("taxamt",s),u.setValue("GrandTotal",y*p+t.getValueOfDecimal(u.getValue("TaxAmt")));return i=r=u=f=e=o=null,""};n.Model.CalloutContractQty=wi;n.Utility.inheritPrototype(bi,n.CalloutEngine);bi.prototype.ContractProduct=function(n,i,r,u,f,e){if(f==null||f.toString()==""||t.getValueOfInt(f)==0)return"";var o=t.getValueOfInt(r.getValue("M_Proudct_ID"));return o!=0&&t.getValueOfBoolean(f)&&(r.setValue("PriceList",0),r.setValue("PriceLimit",0),r.setValue("PriceActual",0),r.setValue("PriceEntered",0)),n=i=r=u=f=e=null,""};n.Model.CalloutContractProduct=bi;n.Utility.inheritPrototype(k,n.CalloutEngine);k.prototype.InvoiceCount=function(i,r,u,f,e,o){if(e==null||e.toString()==""||t.getValueOfInt(e)==0)return"";var s=t.getValueOfDateTime(u.getValue("StartDate")),h=u.getValue("EndDate"),c=t.getValueOfInt(u.getValue("C_Frequency_ID")),l="Select NoOfDays from C_Frequency where C_Frequency_ID="+c,a=t.getValueOfInt(n.DB.executeScalar(l,null,null)),v=(h-s).Days,y=v/a;return u.setValue("TotalInvoice",y),i=r=u=f=e=o=null,""};k.prototype.EndDate=function(i,r,u,f,e,o){var h=new Date(u.getValue("StartDate")),c=new Date(u.getValue("StartDate")),l=n.dataContext.getJSONRecord("MOrderLine/GetNoOfMonths",t.getValueOfString(u.getValue("C_Frequency_ID"))),a=t.getValueOfInt(u.getValue("TotalInvoice")),s=h.setMonth(h.getMonth()+l*a);return s=new Date(h.setDate(h.getDate()-1)),u.setValue("EndDate",s),s=new Date(s),s=s.toISOString(),h=c.toISOString(),s<h&&u.setValue("EndDate",c),i=r=u=f=e=o=null,""};k.prototype.BillStartDate=function(t,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=new Date(r.getValue("StartDate")),s=new Date(r.getValue("BillStartDate"));return s.toISOString()<o.toISOString()&&(n.ADialog.info("StartDateShouldBeLessThanBillStartDate"),r.setValue("BillStartDate",r.getValue("StartDate"))),t=i=r=u=f=e=null,""};k.prototype.StartDate=function(i,r,u,f,e,o){if(e==null||e.toString()=="")return"";var h=new Date(u.getValue("StartDate")),c=t.getValueOfInt(u.getValue("C_Frequency_ID")),l="Select NoOfDays from C_Frequency where C_Frequency_ID="+c,a=t.getValueOfInt(n.DB.executeScalar(l,null,null)),v=t.getValueOfInt(u.getValue("TotalInvoice")),y=v*a,s=new Date(h.setDate(h.getDay()+t.getValueOfDouble(y)));return s=s.toISOString(),u.setValue("EndDate",s),i=r=u=f=e=o=null,""};k.prototype.StartDateChange=function(i,r,u,f,e,o){if(e==null||e.toString()=="")return"";var c=t.getValueOfInt(u.getValue("C_Frequency_ID")),l="Select NoOfMonths from C_Frequency where C_Frequency_ID="+c,a=t.getValueOfInt(n.DB.executeScalar(l,null,null)),v=t.getValueOfInt(u.getValue("TotalInvoice")),s=new Date(e),y=new Date(e),h=s.setMonth(s.getMonth()+a*v);return h=new Date(s.setDate(s.getDate()-1)),u.setValue("EndDate",h.toISOString()),h=h.toISOString(),s=y.toISOString(),h<s&&u.setValue("EndDate",s),u.setValue("BillStartDate",u.getValue("StartDate")),i=r=u=f=e=o=null,""};n.Model.CalloutContract=k;n.Utility.inheritPrototype(kt,n.CalloutEngine);kt.prototype.product=function(n,t,i,r,u,f){return i.setValue("Help",i.getValue("Name")),n=t=i=r=u=f=null,""};kt.prototype.product2=function(n,t,i,r,u,f){return i.setValue("Description",i.getValue("Help")),n=t=i=r=u=f=null,""};n.Model.copyname=kt;n.Utility.inheritPrototype(ki,n.CalloutEngine);ki.prototype.IsInternal=function(i,r,u,f,e,o){if(e==null||e.toString()==""||this.isCalloutActive())return"";try{this.setCalloutActive(!0);var h="select ProfileType from S_Resource where AD_User_ID = "+t.getValueOfInt(e),s=t.getValueOfString(n.DB.executeScalar(h,null,null));s!=""&&(s.toUpper()=="I"?u.setValue("IsInternal",!0):s.toUpper()=="E"&&u.setValue("IsInternal",!1));this.setCalloutActive(!1)}catch(c){this.setCalloutActive(!1)}return i=r=u=f=e=o=null,""};n.Model.CalloutUserTimeRec=ki;n.Utility.inheritPrototype(ot,n.CalloutEngine);ot.prototype.Product=function(r,u,f,o,s,h){var c=s,w,v;if(c==null||t.getValueOfInt(c)==0)return"";this.setCalloutActive(!0);var l=null,g=r.getContext(u,"DateExpense"),p=null,a=null;try{w=!0;v=n.dataContext.getJSONRecord("MProduct/GetProduct",c.toString());f.setValue("C_UOM_ID",t.getValueOfInt(v.C_UOM_ID));uom=f.getValue("C_UOM_ID");var b=paramStr=c.toString().concat(",").concat(f.getValue("S_TimeExpense_ID").toString()).concat(",").concat(f.getValue("C_UOM_ID").toString().concat(",").concat(f.getValue("DateExpense").toString())),y=n.dataContext.getJSONRecord("MExpenseReport/GetstandardPrice",b),l=y.PriceActual,k=y.C_Currency_ID;f.setValue("ExpenseAmt",l);f.setValue("C_Currency_ID",k);f.setValue("ConvertedAmt",l)}catch(d){return a!=null&&a.close(),this.log.log(i.SEVERE,p,d),this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),r=u=f=o=s=h=null,""};ot.prototype.Amount=function(i,r,u,f,e,o){var a,s;if(this.isCalloutActive())return"";this.setCalloutActive(!0);var l=u.getValue("ExpenseAmt"),h=0,c=u.getValue("C_Currency_ID");if(h=n.dataContext.getJSONRecord("MExpenseReport/GetPriceListCurrency",u.getValue("S_TimeExpense_ID")),a=i.getContext(r,"DateExpense"),this.log.fine("Amt="+l+", C_Currency_ID="+c),s=l.toString(),!s.equals(n.Env.ZERO)&&h!=t.getValueOfInt(c)){var v=i.getContextAsInt(r,"AD_Client_ID"),y=i.getContextAsInt(r,"AD_Org_ID"),p=s.toString()+","+c.toString()+","+h.toString()+","+a+",0,"+v.toString()+","+y.toString();s=n.dataContext.getJSONRecord("MConversionRate/CurrencyConvert",p)}return u.setValue("ConvertedAmt",s),this.log.fine("= ConvertedAmt="+s),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutTimeExpense=ot;n.Utility.inheritPrototype(c,n.CalloutEngine);c.prototype.ProductInfo=function(i,r,u,f,e,o){var s,c,l,a,h;return e==null||e.toString()==""||t.getValueOfInt(e)==0?"":(s=e,s==null||s==0)?"":(s=i.getContextAsInt(r,"M_Product_ID"),s==null||s==0)?"":(c=i.getContextAsInt(r,"M_PriceList_ID"),l=i.getContextAsInt(r,"M_AttributeSetInstance_ID"),c!=0?(a=s.toString()+", "+c.toString()+","+l.toString(),h=n.dataContext.getJSONRecord("MTeamForcast/GetProductPrice",a),h!=0&&(u.setValue("PriceStd",h),u.setValue("UnitPrice",h),u.setValue("PriceStd",h*t.getValueOfDecimal(u.getValue("QtyEntered"))),u.setValue("TotalPrice",h*t.getValueOfDecimal(u.getValue("QtyEntered"))))):n.ADialog.info("PriceLisetNotFound"),i=r=u=f=e=o=null,"")};c.prototype.Charge=function(n,t,r,u,f,e){try{if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);r.getValue("M_Product_ID")!=null&&(r.setValue("M_Product_ID",null),r.setValue("M_AttributeSetInstance_ID",null));var o=n.getContextAsInt("#C_UOM_ID");o>0?r.setValue("C_UOM_ID",o):r.setValue("C_UOM_ID",100)}catch(s){return this.setCalloutActive(!1),this.log.log(i.SEVERE,sql,s),s}this.setCalloutActive(!1);e=null};c.prototype.CalculatePrice=function(i,r,u,f,e,o){if(this.isCalloutActive()||e==null||e.toString()==""||t.getValueOfInt(e)<=0)return"";this.setCalloutActive(!0);var s=n.dataContext.getJSONRecord("MCurrency/GetCurrency",t.getValueOfString(i.getContextAsInt(r,"C_Currency_ID"))),h=t.getValueOfDecimal(u.getValue("UnitPrice"))*t.getValueOfDecimal(u.getValue("BaseQty"));return u.setValue("PriceStd",h.toFixed(t.getValueOfInt(s.StdPrecision))),u.setValue("TotalPrice",h.toFixed(t.getValueOfInt(s.StdPrecision))),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};c.prototype.Qty=function(i,r,u,f,e,o){var h,s,c;if(this.isCalloutActive()||e==null||e.toString()==""||t.getValueOfInt(e)==0)return"";if(this.setCalloutActive(!0),h=u.getValue("C_UOM_ID"),h==null&&(h=i.getContextAsInt(r,"C_UOM_ID")),s=u.getValue("BaseQty"),c=n.dataContext.getJSONRecord("MCurrency/GetCurrency",t.getValueOfString(i.getContextAsInt(r,"C_Currency_ID"))),u.getValue("M_Product_ID")!=null){var a=u.getValue("M_Product_ID"),v=a.toString().concat(",",h.toString(),",",s.toString()),l=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",v);l!=null?u.setValue("QtyEntered",l):u.setValue("QtyEntered",s)}else u.setValue("QtyEntered",s);return t.getValueOfDecimal(u.getValue("UnitPrice"))!=0&&s!=0&&(u.setValue("PriceStd",(s*u.getValue("UnitPrice")).toFixed(t.getValueOfInt(c.StdPrecision))),u.setValue("TotalPrice",(s*u.getValue("UnitPrice")).toFixed(t.getValueOfInt(c.StdPrecision)))),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};c.prototype.Currency=function(i,r,u,f,e,o){if(this.isCalloutActive()||e==null||e.toString()==""||t.getValueOfInt(e)==0)return"";this.setCalloutActive(!0);var s=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",t.getValueOfString(u.getValue("M_PriceList_ID")));return s.C_Currency_ID!=null&&u.setValue("C_Currency_ID",s.C_Currency_ID),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};c.prototype.ProductPrice=function(i,r,u,f,e,o){var h;if(this.isCalloutActive()||e==null||e.toString()==""||t.getValueOfInt(e)==0)return u.getValue("M_Product_ID")==null&&(u.setValue("PriceStd",0),u.setValue("TotalPrice",0),u.setValue("UnitPrice",0),u.setValue("QtyEntered",1),u.setValue("BaseQty",1)),"";if(this.setCalloutActive(!0),i.getContextAsInt(r,"M_PriceList_ID")>0){var c=n.dataContext.getJSONRecord("MCurrency/GetCurrency",t.getValueOfString(i.getContextAsInt(r,"C_Currency_ID"))),l=t.getValueOfString(u.getValue("M_Product_ID")).concat(",",t.getValueOfString(u.getValue("M_AttributeSetInstance_ID")),",",t.getValueOfString(i.getContextAsInt(r,"M_PriceList_ID")),",",t.getValueOfString(u.getValue("C_UOM_ID"))),s=n.dataContext.getJSONRecord("MProductPricing/GetProductdata",l);s!=null&&(u.setValue("PriceStd",s.PriceStd),u.setValue("UnitPrice",s.PriceStd),u.setValue("PriceStd",(s.PriceStd*t.getValueOfDecimal(u.getValue("BaseQty"))).toFixed(t.getValueOfInt(c.StdPrecision))),u.setValue("TotalPrice",(s.PriceStd*t.getValueOfDecimal(u.getValue("BaseQty"))).toFixed(t.getValueOfInt(c.StdPrecision))),t.getValueOfInt(u.getValue("C_UOM_ID"))==0&&u.setValue("C_UOM_ID",s.C_UOM_ID),u.findColumn("IsBOM")>0&&u.setValue("IsBOM",s.IsBOM))}return h=n.dataContext.getJSONRecord("MTeamForcast/GetBOMdetails",t.getValueOfString(u.getValue("M_Product_ID"))),h!=null&&(u.setValue("BOMUse",h.BOMUse),u.setValue("VAMFG_M_Routing_ID",h.VAMFG_M_Routing_ID),u.setValue("M_BOM_ID",h.M_BOM_ID)),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};c.prototype.AccountDate=function(r,u,f,e,o,s){if(this.isCalloutActive()||o==null||o.toString()=="")return"";try{this.setCalloutActive(!0);var l=t.getValueOfString(f.getValue("AD_Client_ID")).concat(",",t.getValueOfString(f.getValue("DateAcct")),",",t.getValueOfString(f.getValue("AD_Org_ID"))),h=n.dataContext.getJSONRecord("MPeriod/GetPeriod",l);h!=null&&f.setValue("C_Period_ID",h)}catch(c){return this.log.log(i.SEVERE,sql,c),c.message}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};c.prototype.SuperVisor=function(r,u,f,e,o,s){if(this.isCalloutActive()||o==null||o.toString()==""||t.getValueOfInt(o)==0)return"";try{this.setCalloutActive(!0);var h=n.dataContext.getJSONRecord("MTeamForcast/GetSuperVisor",t.getValueOfString(o));h!=null&&f.setValue("Supervisor_ID",h)}catch(c){return this.log.log(i.SEVERE,sql,c),c.message}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};n.Model.CalloutTeamForcast=c;n.Utility.inheritPrototype(st,n.CalloutEngine);st.prototype.Currency=function(r,u,f,e,o,s){if(this.isCalloutActive()||o==null||o.toString()==""||t.getValueOfInt(o)==0)return f.getValue("M_PriceList_ID")==null&&f.setValue("C_Currency_ID",t.getValueOfInt(r.getContext("$C_Currency_ID"))),"";try{this.setCalloutActive(!0);var h=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",t.getValueOfString(f.getValue("M_PriceList_ID")));h.C_Currency_ID!=null&&f.setValue("C_Currency_ID",h.C_Currency_ID)}catch(c){return this.log.log(i.SEVERE,sql,c),c.message}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};st.prototype.Product=function(r,u,f,e,o,s){var c;if(this.isCalloutActive()||o==null||o.toString()==""||t.getValueOfInt(o)==0)return f.getValue("M_Product_ID")==null&&(f.setValue("Price",0),f.setValue("PlannedRevenue",0),f.setValue("ForcastQty",0),f.setValue("TotalQty",0)),"";try{if(this.setCalloutActive(!0),r.getContextAsInt(u,"M_PriceList_ID")>0){var a=n.dataContext.getJSONRecord("MCurrency/GetCurrency",t.getValueOfString(r.getContextAsInt(u,"C_Currency_ID"))),v=t.getValueOfString(f.getValue("M_Product_ID")).concat(",",t.getValueOfString(f.getValue("M_AttributeSetInstance_ID")),",",t.getValueOfString(r.getContextAsInt(u,"M_PriceList_ID")),",",t.getValueOfString(f.getValue("C_UOM_ID"))),h=n.dataContext.getJSONRecord("MProductPricing/GetProductdata",v);h!=null&&(f.setValue("Price",h.PriceStd),f.setValue("PlannedRevenue",(h.PriceStd*t.getValueOfDecimal(f.getValue("TotalQty"))).toFixed(t.getValueOfInt(a.StdPrecision))),t.getValueOfInt(f.getValue("C_UOM_ID"))==0&&f.setValue("C_UOM_ID",h.C_UOM_ID),f.findColumn("IsBOM")>0&&f.setValue("IsBOM",h.IsBOM));c=n.dataContext.getJSONRecord("MTeamForcast/GetBOMdetails",t.getValueOfString(f.getValue("M_Product_ID")));c!=null&&(f.setValue("BOMUse",c.BOMUse),f.setValue("VAMFG_M_Routing_ID",c.VAMFG_M_Routing_ID),f.setValue("M_BOM_ID",c.M_BOM_ID))}}catch(l){return this.log.log(i.SEVERE,sql,l),l.message}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};st.prototype.CalculatePrice=function(r,u,f,e,o,s){var h,c,l;if(this.isCalloutActive()||o==null||o.toString()==""||t.getValueOfInt(o)<=0)return"";try{this.setCalloutActive(!0);h=n.dataContext.getJSONRecord("MCurrency/GetCurrency",t.getValueOfString(r.getContextAsInt(u,"C_Currency_ID")));c=t.getValueOfDecimal(f.getValue("ForcastQty"))+t.getValueOfDecimal(f.getValue("SalesOrderQty"))+t.getValueOfDecimal(f.getValue("OppQty"));f.setValue("TotalQty",c);l=t.getValueOfDecimal(f.getValue("Price"))*t.getValueOfDecimal(f.getValue("TotalQty"));f.setValue("PlannedRevenue",l.toFixed(t.getValueOfInt(h.StdPrecision)))}catch(a){return this.log.log(i.SEVERE,sql,a),a.message}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};n.Model.CalloutMasterForecast=st;n.Utility.inheritPrototype(dt,n.CalloutEngine);dt.prototype.TaxID=function(i,r,u,f,e,o){var h,s;if(e==null||e.toString()==""||t.getValueOfInt(e)==0||this.isCalloutActive())return"";try{this.setCalloutActive(!0);h=n.dataContext.getJSONRecord("MTax/GetTaxRate",t.getValueOfInt(e));h!=0?(s=t.getValueOfDecimal(u.getValue("ApprovedExpenseAmt"))*h/100,s=s.toFixed(2),u.setValue("TaxAmt",s)):u.setValue("TaxAmt",n.Env.ZERO);this.setCalloutActive(!1)}catch(c){this.setCalloutActive(!1)}return i=r=u=f=e=o=null,""};dt.prototype.ExpenseAmt=function(i,r,u,f,e,o){var h,s;if(e==null||e.toString()==""||t.getValueOfInt(e)==0||this.isCalloutActive())return"";try{this.setCalloutActive(!0);h=n.dataContext.getJSONRecord("MTax/GetTaxRate",t.getValueOfInt(u.getValue("C_Tax_ID")));h!=0?(s=t.getValueOfDecimal(e)*h/100,s=s.toFixed(2),u.setValue("TaxAmt",s)):u.setValue("TaxAmt",n.Env.ZERO);this.setCalloutActive(!1)}catch(c){this.setCalloutActive(!1)}return i=r=u=f=e=o=null,""};n.Model.CalloutTaxAmt=dt;n.Utility.inheritPrototype(gt,n.CalloutEngine);gt.prototype.Tax=function(i,r,u,f,e,o){var c,h;if(e==null||e==0||e.toString()=="")return"";var l=0,y=n.Env.ZERO,s=n.Env.ZERO;if(l=t.getValueOfInt(u.getValue("C_Tax_ID")),u.getField("SurchargeAmt")!=null){var p=0,a=!1,v=n.dataContext.getJSONRecord("MPriceList/GetPriceListData",u.getValue("M_PriceList_ID").toString());v!=null&&(p=v.StdPrecision,a="Y"==v.IsTaxIncluded);h=t.getValueOfDecimal(u.getValue("LineNetAmt"));c=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",l.toString()+","+h.toString()+","+p.toString()+","+a.toString());s=c.TaxAmt;u.setValue("TaxAmt",s);u.setValue("SurchargeAmt",c.SurchargeAmt);a?u.setValue("GrandTotal",h):u.setValue("GrandTotal",h+s+c.SurchargeAmt)}else y=n.dataContext.getJSONRecord("MTax/GetTaxRate",l.toString()),h=t.getValueOfDecimal(u.getValue("LineNetAmt")),s=t.getValueOfDecimal(h*y/100),s=t.getValueOfDecimal(s.toFixed(2)),u.setValue("GrandTotal",s+h),u.setValue("taxamt",s);return i=r=u=f=e=o=null,""};gt.prototype.SetTaxExemptReason=function(r,u,f,e,o,s){if(o==null||o==0||o.toString()==""||this.isCalloutActive())return"";try{this.setCalloutActive(!0);var h=n.dataContext.getJSONRecord("MTax/GetTaxExempt",t.getValueOfString(f.getValue("C_Tax_ID")));h!=null&&(f.setValue("IsTaxExempt",t.getValueOfString(h.IsTaxExempt).equals("Y")?!0:!1),f.setValue("C_TaxExemptReason_ID",t.getValueOfInt(h.C_TaxExemptReason_ID)))}catch(c){return this.log.log(i.SEVERE,sql,c),this.setCalloutActive(!1),c.message}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};n.Model.CalloutTax=gt;n.Utility.inheritPrototype(di,n.CalloutEngine);di.prototype.SetBP=function(n,i,r,u,f,e){if(f==null||f.toString()==""||t.getValueOfInt(f)==0||this.isCalloutActive())return"";try{this.setCalloutActive(!0);r.setValue("C_BPartner_ID",t.getValueOfInt(f));this.setCalloutActive(!1)}catch(o){this.setCalloutActive(!1)}return n=i=r=u=f=e=null,""};n.Model.CalloutSetBP=di;n.Utility.inheritPrototype(gi,n.CalloutEngine);gi.prototype.Charge=function(t,i,r,u,f,e){if(f==null||f.toString()=="")return"";var o=r.getValue("C_Charge_ID").toString(),s=n.dataContext.getJSONRecord("MCharge/GetCharge",o);return r.setValue("PlannedQty",1),r.setValue("PlannedPrice",s),t=i=r=u=f=e=null,""};n.Model.CalloutProjectLine=gi;n.Utility.inheritPrototype(ni,n.CalloutEngine);ni.prototype.ProductInfo=function(i,r,u,f,e,o){var y,s,h,c,p,l;if(e==null||e.toString()=="")return t.getValueOfInt(u.getValue("M_Product_ID"))==0&&(u.setValue("PriceList",0),u.setValue("PlannedPrice",0),u.setValue("Discount",0),u.setValue("PlannedMarginAmt",0),u.setValue("PlannedAmt",0)),"";if(t.getValueOfInt(u.getValue("M_Product_ID"))==0)return u.setValue("PriceList",0),u.setValue("PlannedPrice",0),u.setValue("Discount",0),u.setValue("PlannedMarginAmt",0),u.setValue("PlannedAmt",0),"";var w=t.getValueOfInt(u.getValue("C_ProjectTask_ID")),b=t.getValueOfInt(u.getValue("C_ProjectPhase_ID")),k=t.getValueOfInt(u.getValue("C_Project_ID")),d=t.getValueOfInt(u.getValue("M_Product_ID")),a=0,v=0;if(u.findColumn("M_AttributeSetInstance_ID")>0&&(a=t.getValueOfInt(u.getValue("M_AttributeSetInstance_ID"))),u.findColumn("C_UOM_ID")>0&&(v=t.getValueOfInt(u.getValue("C_UOM_ID"))),y=w.toString()+","+b.toString()+","+k.toString()+","+d.toString()+","+a.toString()+","+v.toString(),s=n.dataContext.getJSONRecord("MProject/GetProjectDetail",y),s!=null){h=t.getValueOfDecimal(s.PriceList);u.setValue("PriceList",h);c=t.getValueOfDecimal(s.PriceStd);u.setValue("PlannedPrice",c);u.setValue("PlannedQty",1);p=t.getValueOfDecimal(s.PriceLimit);try{if(l=(h-c)*100/h,isNaN(l))return this.setCalloutActive(!1),n.Msg.getMsg("PriceNotDefined")}catch(g){return this.setCalloutActive(!1),"PriceListNotSelected"}u.setValue("Discount",l.toFixed(2));u.setValue("PlannedMarginAmt",c-p);t.getValueOfInt(u.getValue("C_UOM_ID"))==0&&u.setValue("C_UOM_ID",s.C_UOM_ID)}else u.setValue("PriceList",0),u.setValue("PlannedPrice",0),u.setValue("Discount",0),u.setValue("PlannedMarginAmt",0),u.setValue("PlannedAmt",0);return i=r=u=f=e=o=null,""};ni.prototype.SetQty=function(i,r,u,f,e,o){var h,s;if(this.isCalloutActive()||e==null||e.toString()==""||t.getValueOfInt(e)==0)return"";if(this.setCalloutActive(!0),h=u.getValue("C_UOM_ID"),s=u.getValue("PlannedQty"),u.getValue("M_Product_ID")!=null){var l=u.getValue("M_Product_ID"),a=l.toString().concat(",",h.toString(),",",s.toString()),c=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",a);c!=null?u.setValue("BaseQty",c):u.setValue("BaseQty",s)}else u.setValue("BaseQty",s);return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutProductToOpportunity=ni;n.Utility.inheritPrototype(nr,n.CalloutEngine);nr.prototype.PriceList=function(i,r,u,f,e,o){var s,h,c;if(e==null||e.toString()=="")return"";s="";try{s="select M_PriceList_ID from M_PriceList_Version where M_PriceList_Version_ID = "+t.getValueOfInt(e);h=t.getValueOfInt(n.DB.executeScalar(s,null,null));h!=0&&(u.setValue("M_PriceList_ID",h),s="select C_Currency_id from m_pricelist where m_pricelist_ID = "+h,c=t.getValueOfInt(n.DB.executeScalar(s,null,null)),c!=0?u.setValue("C_Currency_ID",c):n.ADialog.info("CurrencyNotDefinedForThePriceList"))}catch(l){this.setCalloutActive(!1);this.log.saveError(s,s)}return i=r=u=f=e=o=null,""};n.Model.CalloutPriceListOpp=nr;n.Utility.inheritPrototype(s,n.CalloutEngine);s.prototype.Order=function(i,r,u,f,e,o){var h,c;if(e==null||e.toString()=="")return"";try{if((h=t.getValueOfInt(e.toString()),h==null||h==0)||this.isCalloutActive())return"";var a=h.toString(),s=n.dataContext.getJSONRecord("MOrder/GetOrder",a),v=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA077_");t.getValueOfInt(s.ID)!=0&&(u.setValue("DateOrdered",s.DateOrdered),u.setValue("POReference",s.POReference),u.getValue("AD_Org_ID")!=t.getValueOfInt(s.AD_Org_ID)&&u.setValue("AD_Org_ID",t.getValueOfInt(s.AD_Org_ID)),u.setValue("DeliveryRule",s.DeliveryRule),u.setValue("DeliveryViaRule",s.DeliveryViaRule),u.setValue("M_Shipper_ID",t.getValueOfInt(s.M_Shipper_ID)),u.setValue("FreightCostRule",s.FreightCostRule),u.setValue("FreightAmt",s.FreightAmt),u.setValue("C_BPartner_ID",t.getValueOfInt(s.C_BPartner_ID)),u.setValue("C_BPartner_Location_ID",t.getValueOfInt(s.C_BPartner_Location_ID)),u.setValue("AD_OrgTrx_ID",t.getValueOfInt(s.AD_OrgTrx_ID)),u.setValue("C_Activity_ID",t.getValueOfInt(s.C_Activity_ID)),u.setValue("C_Campaign_ID",t.getValueOfInt(s.C_Campaign_ID)),u.setValue("C_Project_ID",t.getValueOfInt(s.C_Project_ID)),u.setValue("User1_ID",t.getValueOfInt(s.User1_ID)),u.setValue("User2_ID",t.getValueOfInt(s.User2_ID)),u.getField("C_IncoTerm_ID")!=null&&u.setValue("C_IncoTerm_ID",t.getValueOfInt(s.C_IncoTerm_ID)),c=u.getValue("IsReturnTrx"),c&&(u.setValue("Orig_Order_ID",s.Orig_Order_ID),u.setValue("Orig_InOut_ID",s.Orig_InOut_ID),t.getValueOfString(s.IsDropShip)=="Y"?u.setValue("IsDropShip",!0):u.setValue("IsDropShip",!1)),u.setValue("M_Warehouse_ID",t.getValueOfInt(s.M_Warehouse_ID)),v.VA077_&&(s.VA077_HistoricContractDate!=""&&u.setValue("VA077_HistoricContractDate",l(s.VA077_HistoricContractDate)),s.VA077_ChangeStartDate!=""&&u.setValue("VA077_ChangeStartDate",l(s.VA077_ChangeStartDate)),s.VA077_ContractCPStartDate!=""&&u.setValue("VA077_ContractCPStartDate",l(s.VA077_ContractCPStartDate)),s.VA077_ContractCPEndDate!=""&&u.setValue("VA077_ContractCPEndDate",l(s.VA077_ContractCPEndDate)),u.setValue("VA077_PartialAmtCatchUp",t.getValueOfDecimal(s.VA077_PartialAmtCatchUp)),u.setValue("VA077_OldAnnualContractTotal",t.getValueOfDecimal(s.VA077_OldAnnualContractTotal)),u.setValue("VA077_AdditionalAnnualCharge",t.getValueOfDecimal(s.VA077_AdditionalAnnualCharge)),u.setValue("VA077_NewAnnualContractTotal",t.getValueOfDecimal(s.VA077_NewAnnualContractTotal)),u.setValue("VA077_SalesCoWorker",t.getValueOfDecimal(s.VA077_SalesCoWorker)),u.setValue("VA077_SalesCoWorkerPer",t.getValueOfDecimal(s.VA077_SalesCoWorkerPer)),u.setValue("VA077_TotalMarginAmt",t.getValueOfDecimal(s.VA077_TotalMarginAmt)),u.setValue("VA077_TotalPurchaseAmt",t.getValueOfDecimal(s.VA077_TotalPurchaseAmt)),u.setValue("VA077_TotalSalesAmt",t.getValueOfDecimal(s.VA077_TotalSalesAmt)),u.setValue("VA077_MarginPercent",t.getValueOfDecimal(s.VA077_MarginPercent))))}catch(y){this.setCalloutActive(!1);this.log.severe(y.toString())}return i=r=u=f=e=o=null,""};s.prototype.DocType=function(r,u,f,e,o,s){var c,v,h,l,a;if(o==null||o.toString()==""||(c=t.getValueOfInt(o.toString()),c==null||c==0))return"";v=c.toString();h=n.dataContext.getJSONRecord("MInOut/GetDocTypeData",v);try{r.setContext(u,"C_DocTypeTarget_ID",c);h!=null&&(l=t.getValueOfString(h.docBaseType),a=h.IsReturnTrx=="Y",l.equals("MMS")&&!a?f.setValue("MovementType","C-"):l.equals("MMS")&&a?f.setValue("MovementType","C+"):l.equals("MMR")&&!a?f.setValue("MovementType","V+"):l.equals("MMR")&&a&&f.setValue("MovementType","V-"),h.IsDocNoControlled=="Y"&&f.setValue("DocumentNo","<"+t.getValueOfString(h.CurrentNext)+">"))}catch(y){return this.setCalloutActive(!1),h!=null&&(h.close(),h=null),this.log.log(i.SEVERE,sql,y),y.message}return r=u=f=e=o=s=null,""};s.prototype.BPartner=function(i,r,u,f,e,o){var s=null,c=null,l,h,y,a,w,b,v;if(e==null||e.toString()=="")return"";try{if(l=t.getValueOfInt(e.toString()),l==null||l==0)return"";var k=u.getValue("IsReturnTrx"),p=u.getValue("IsSOTrx"),d=u.getValue("C_Order_ID"),g=(!0).toString()+","+l,s=n.dataContext.getJSONRecord("MBPartner/GetBPartnerOrderData",g);s!=null&&(h=s.C_BPartner_Location_ID,d==null&&(h==0?u.setValue("C_BPartner_Location_ID",null):u.setValue("C_BPartner_Location_ID",h)),h=s.AD_User_ID,h==0?u.setValue("AD_User_ID",null):u.setValue("AD_User_ID",h),y=p?s.C_IncoTerm_ID:s.C_IncoTermPO_ID,y>0&&u.setValue("C_IncoTerm_ID",y),p&!k&&(a=s.CreditStatusSettingOn,v=s.CreditAvailable,a=="CH"?s.SOCreditStatus!=null&&(s.SOCreditStatus.equals("X")||v<=0&&n.ADialog.info("CreditLimitOver")):(w=t.getValueOfInt(u.getValue("C_BPartner_Location_ID")),c=n.dataContext.getJSONRecord("MBPartner/GetLocationData",w.toString()),c!=null&&(a=t.getValueOfString(c.CreditStatusSettingOn),a=="CL"&&(b=t.getValueOfDouble(c.SO_CreditLimit),b!=0&&(v=t.getValueOfDouble(c.CreditAvailable),v<=0&&n.ADialog.info("CreditOver")))))))}catch(nt){return this.setCalloutActive(!1),nt}return i=r=u=f=e=o=null,""};s.prototype.Warehouse=function(r,u,f,e,o,s){var l,h,c,a;if(o==null||o.toString()==""||this.isCalloutActive()||(l=t.getValueOfInt(o),l==null||l==0))return"";this.setCalloutActive(!0);h=n.dataContext.getJSONRecord("MInOut/GetWarehouse",o.toString());try{h!=null&&(c=t.getValueOfInt(h.AD_Org_ID),a=r.getContextAsInt(u,"AD_Org_ID"),a!=c&&f.setValue("AD_Org_ID",c),c=t.getValueOfInt(h.M_Locator_ID),c==0?r.setContext(u,0,"M_Locator_ID",null):(this.log.config("M_Locator_ID="+c),r.setContext(u,"M_Locator_ID",c)))}catch(v){return this.setCalloutActive(!1),h!=null&&(h.close(),h=null),this.log.log(i.SEVERE,sql,v),this.setCalloutActive(!1),v.message}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};s.prototype.OrderLine=function(i,r,u,f,e,o){var h,v,c,a,p;if(e==null||e.toString()=="")return"";if(this.setCalloutActive(!0),h=t.getValueOfInt(e.toString()),h==null||h==0)return this.setCalloutActive(!1),"";try{var a=h.toString(),y=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA077_"),s=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",a);t.getValueOfInt(s.GetID)!=0&&(t.getValueOfInt(s.M_Product_ID)>0?(u.setValue("M_Product_ID",t.getValueOfInt(s.M_Product_ID)),u.setValue("C_Charge_ID",null)):(u.setValue("C_Charge_ID",t.getValueOfInt(s.C_Charge_ID)),u.setValue("M_Product_ID",null)),u.setValue("PrintDescription",s.PrintDescription.toString()),u.setValue("M_AttributeSetInstance_ID",t.getValueOfInt(s.M_AttributeSetInstance_ID)),u.setValue("C_UOM_ID",t.getValueOfInt(s.C_UOM_ID)),v=t.getValueOfDecimal(s.QtyOrdered)-t.getValueOfDecimal(s.QtyDelivered),u.setValue("MovementQty",v),c=v,t.getValueOfDecimal(s.QtyEntered).toString().compareTo(t.getValueOfDecimal(s.QtyOrdered))!=t.getValueOfDecimal(s.QtyOrdered)&&(c=c*t.getValueOfDecimal(s.QtyEntered)/t.getValueOfDecimal(s.QtyOrdered).toFixed(12)),u.setValue("QtyEntered",c),u.setValue("C_Activity_ID",t.getValueOfInt(s.C_Activity_ID)),u.setValue("C_Campaign_ID",t.getValueOfInt(s.C_Campaign_ID)),u.setValue("C_Project_ID",t.getValueOfInt(s.C_Project_ID)),u.setValue("C_ProjectPhase_ID",t.getValueOfInt(s.C_ProjectPhase_ID)),u.setValue("C_ProjectTask_ID",t.getValueOfInt(s.C_ProjectTask_ID)),u.setValue("AD_OrgTrx_ID",t.getValueOfInt(s.AD_OrgTrx_ID)),u.setValue("User1_ID",t.getValueOfInt(s.User1_ID)),u.setValue("User2_ID",t.getValueOfInt(s.User2_ID)),t.getValueOfBoolean(s.IsReturnTrx)&&(u.setValue("Orig_OrderLine_ID",t.getValueOfInt(s.Orig_OrderLine_ID)),a=s.Orig_InOutLine_ID,p=n.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",a)),t.getValueOfString(s.IsDropShip)=="Y"?u.setValue("IsDropShip",!0):u.setValue("IsDropShip",!1),y.VA077_&&(u.setValue("VA077_CNAutodesk",t.getValueOfString(s.VA077_CNAutodesk)),u.setValue("VA077_Duration",t.getValueOfString(s.VA077_Duration)),u.setValue("VA077_MarginAmt",t.getValueOfDecimal(s.VA077_MarginAmt)),u.setValue("VA077_MarginPercent",t.getValueOfDecimal(s.VA077_MarginPercent)),u.setValue("VA077_OldSN",t.getValueOfString(s.VA077_OldSN)),u.setValue("VA077_ProductInfo",t.getValueOfString(s.VA077_ProductInfo)),u.setValue("VA077_PurchasePrice",t.getValueOfDecimal(s.VA077_PurchasePrice)),u.setValue("VA077_RegEmail",t.getValueOfString(s.VA077_RegEmail)),u.setValue("VA077_SerialNo",t.getValueOfString(s.VA077_SerialNo)),u.setValue("VA077_UpdateFromVersn",t.getValueOfString(s.VA077_UpdateFromVersn)),u.setValue("VA077_UserRef_ID",t.getValueOfInt(s.VA077_UserRef_ID)),u.setValue("VA077_ServiceContract_ID",t.getValueOfInt(s.VA077_ServiceContract_ID)),s.VA077_StartDate!=""&&u.setValue("VA077_StartDate",l(s.VA077_StartDate)),s.VA077_EndDate!=""&&u.setValue("VA077_EndDate",l(s.VA077_EndDate)),t.getValueOfBoolean(s.VA077_LicenceTracked)?u.setValue("VA077_LicenceTracked",!0):u.setValue("VA077_LicenceTracked",!1)))}catch(w){this.setCalloutActive(!1);this.log.severe(w.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};s.prototype.Product=function(i,r,u,f,e,o){var h,y,a,c,v,s,l;if(this.isCalloutActive()||e==null||e.toString()==""||(h=t.getValueOfInt(e),h==0))return"";this.setCalloutActive(!0);try{if(y=0,u.setValue("M_AttributeSetInstance_ID",null),a=i.getWindowContext(r,"IsSOTrx",!0)=="Y",a)return this.setCalloutActive(!1),"";c=t.getValueOfDecimal(u.getValue("QtyEntered"));u.setValue("MovementQty",c);v=u.getValue("M_InOut_ID").toString()+","+h.toString()+","+c.toString()+","+i.getContextAsInt(r,"C_BPartner_ID").toString();s=n.dataContext.getJSONRecord("MInOut/GetUOMConv",v);s!=null&&(s.C_UOM_ID!=s.uom&&s.uom!=0?(u.setValue("QtyEntered",s.qtyentered),u.setValue("C_UOM_ID",s.uom)):u.setValue("C_UOM_ID",s.C_UOM_ID));l=n.dataContext.getJSONRecord("MProduct/GetProduct",h.toString());l!=null&&u.setValue("PrintDescription",l.DocumentNote)}catch(p){this.setCalloutActive(!1);this.log.severe(p.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};s.prototype.Qty=function(r,u,f,e,o,s){var v,c,h,l,w,nt,p,b,y,tt,it,k,d,a;if(this.isCalloutActive()||o==null||o.toString()=="")return"";this.setCalloutActive(!0);try{if(v=r.getContextAsInt(u,"M_Product_ID"),this.log.log(i.WARNING,"qty - init - M_Product_ID="+v),l="",w=0,v==0)h=t.getValueOfDecimal(f.getValue("QtyEntered")),f.setValue("MovementQty",h);else if(e.getColumnName().toString().equals("C_UOM_ID"))a=o,h=t.getValueOfDecimal(f.getValue("QtyEntered")),l=a.toString(),w=n.dataContext.getJSONRecord("MUOM/GetPrecision",l),p=t.getValueOfDecimal(h.toFixed(w)),h.compareTo(p)!=0&&(this.log.fine("Corrected qtyEntered Scale UOM="+a+"; qtyEntered="+h+"->"+p),h=p,f.setValue("QtyEntered",h)),l=v.toString().concat(",",a.toString(),",",h.toString()),c=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",l),c==null&&(c=h),y=h.compareTo(c)!=0,this.log.fine("UOM="+a+", qtyEntered="+h+" -> "+y+" movementQty="+c),r.setContext(u,"UOMConversion",y?"Y":"N"),f.setValue("MovementQty",c);else if(r.getContextAsInt(u,"C_UOM_ID")==0)h=t.getValueOfDecimal(f.getValue("QtyEntered")),f.setValue("MovementQty",h);else if(e.getColumnName().toString().equals("QtyEntered")){if(t.getValueOfInt(f.getValue("M_InOutLine_ID"))>0&&(nt=n.dataContext.getJSONRecord("MInOutLine/GetInvoiceLine",f.getValue("M_InOutLine_ID").toString()),nt>0))return f.setValue("QtyEntered",s),this.setCalloutActive(!1),"VIS_CantChangeQty";a=r.getContextAsInt(u,"C_UOM_ID");h=t.getValueOfDecimal(o);l=v.toString();w=n.dataContext.getJSONRecord("MProduct/GetUOMPrecision",l);p=t.getValueOfDecimal(h.toFixed(w));h.compareTo(p)!=0&&(this.log.fine("Corrected qtyEntered Scale UOM="+a+"; qtyEntered="+h+"->"+p),h=p,f.setValue("QtyEntered",h));l=v.toString().concat(",",a.toString(),",",h.toString());c=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",l);c==null&&(c=h);y=h.compareTo(c)!=0;this.log.fine("UOM="+a+", qtyEntered="+h+" -> "+y+" movementQty="+c);r.setContext(u,"UOMConversion",y?"Y":"N");f.setValue("MovementQty",c)}else e.getColumnName().toString().equals("MovementQty")&&(a=r.getContextAsInt(u,"C_UOM_ID"),c=t.getValueOfDecimal(o),l=v.toString(),w=n.dataContext.getJSONRecord("MProduct/GetUOMPrecision",l),b=t.getValueOfDecimal(c.toFixed(w)),c.compareTo(b)!=0&&(this.log.fine("Corrected movementQty "+c+"->"+b),c=b,f.setValue("MovementQty",c)),l=v.toString().concat(",",a.toString(),",",c.toString()),h=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",l),h==null&&(h=c),y=c.compareTo(h)!=0,this.log.fine("UOM="+a+", movementQty="+c+" -> "+y+" qtyEntered="+h),r.setContext(u,"UOMConversion",y?"Y":"N"),f.setValue("QtyEntered",h));if(tt="Y".equals(r.getContext("IsReturnTrx")),v!=0&&tt&&(it=t.getValueOfInt(f.getValue("C_OrderLine_ID")),l=it.toString(),k=n.dataContext.getJSONRecord("MOrderLine/GetOrderLine",l),k.Get_ID()!=0&&(d=k.Orig_InOutLine_ID,d!=0))){var l=d.toString(),rt=n.dataContext.getJSONRecord("MInOutLine/GetMInOutLine",l),g=rt.MovementQty;c=t.getValueOfDecimal(f.getValue("MovementQty"));g.toString().compareTo(c)<0&&(r.getWindowContext(u,"IsSOTrx",!0)=="Y"?n.ADialog.info("QtyShippedAndReturned"):n.ADialog.info("QtyRecievedAndReturnd"),f.setValue("MovementQty",g),c=g,a=r.getContextAsInt(u,"C_UOM_ID"),l=v.toString().concat(",",a.toString(),",",c.toString()),h=n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",l),h==null&&(h=c),f.setValue("QtyEntered",h),f.setValue("MovementQty",c),this.log.fine("qtyEntered : "+h.toString()+"movementQty : "+c.toString()))}}catch(ut){this.setCalloutActive(!1);this.log.severe(ut.toString())}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};s.prototype.Asi=function(i,r,u,f,e,o){var s,a,h;if(this.isCalloutActive()||e==null||e.toString()==""||(s=t.getValueOfInt(e),s==null||s==0))return"";this.setCalloutActive(!0);try{if(t.getValueOfInt(u.getValue("M_Locator_ID"))==0){var v=i.getContextAsInt(r,"M_Product_ID"),c=i.getContextAsInt(r,"M_Warehouse_ID"),y=c.toString(),l=n.dataContext.getJSONRecord("MInOut/GetDefaultLocatorID",y);i.setContext(r,"M_Locator_ID",l);this.log.fine("M_Product_ID="+v+", M_ASI_ID="+s+" - M_Warehouse_ID="+c+", M_Locator_ID="+l);a=i.getContextAsInt(r,"M_AttributeSetInstance_ID");s==a&&(h=i.getContextAsInt(r,"M_Locator_ID"),h!=0&&(this.log.fine("Selected M_Locator_ID="+h),u.setValue("M_Locator_ID",h)))}}catch(p){this.setCalloutActive(!1);this.log.severe(p.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};s.prototype.Charge=function(i,r,u,f,e,o){var s,h;if(this.isCalloutActive()||e==null||e.toString()==""||(s=t.getValueOfInt(u.getValue("C_Charge_ID")),s==null||s==0))return"";this.setCalloutActive(!0);try{h=n.dataContext.getJSONRecord("MCharge/GetChargeDetails",s.toString());h!=null&&u.setValue("PrintDescription",h.PrintDescription)}catch(c){this.setCalloutActive(!1);this.log.severe(c.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutInOut=s;n.Utility.inheritPrototype(ti,n.CalloutEngine);ti.prototype.Invoice=function(r,u,f,e,o,s){var h,c,b,k,a,v,y;if(o==null||o.toString()==""||(h=t.getValueOfInt(o),this.isCalloutActive()||h==null||h==0))return"";var nt=r.getContextAsInt(u,"C_Payment_ID"),k=nt.toString(),p=null;if(p=n.dataContext.getJSONRecord("MPayment/GetPayment",k),p.C_Charge_ID!=0||p.C_Invoice_ID!=0||p.C_Order_ID!=0)return n.Msg.getMsg("PaymentIsAllocated");this.setCalloutActive(!0);f.setValue("DiscountAmt",n.Env.ZERO);f.setValue("WriteOffAmt",n.Env.ZERO);f.setValue("OverUnderAmt",n.Env.ZERO);c=0;r.getContextAsInt(u,"C_Invoice_ID")==h&&r.getContextAsInt(u,"C_InvoicePaySchedule_ID")!=0&&(c=r.getContextAsInt(u,"C_InvoicePaySchedule_ID"));var w=0,g=0,l=null;try{l=n.dataContext.getJSONRecord("MInvoice/GetInvPaySchedDetail",h);l!=null&&(c=t.getValueOfInt(l.C_InvoicePaySchedule_ID),w=t.getValueOfDecimal(l.dueAmount),IsReturnTrx=l.IsReturnTrx,"Y"==IsReturnTrx&&(w=w*-1),f.setValue("C_InvoicePaySchedule_ID",c),f.setValue("Amount",w),g=1)}catch(d){return this.setCalloutActive(!1),this.log.log(i.SEVERE,"PaymentAllocate.Invoice -"+h,d.message),d.toString()}b=t.getValueOfDate(r.getContextAsTime(u,"DateTrx"));b==null&&(b=new Date);k=h.toString()+","+c.toString()+","+b.toString();a=null;try{a=n.dataContext.getJSONRecord("MPayment/GetInvoiceData",k);a!=null&&(v=t.getValueOfDecimal(a.invoiceOpen),v==null&&(v=n.Env.ZERO),y=t.getValueOfDecimal(a.invoiceDiscount),y==null&&(y=n.Env.ZERO),f.setValue("InvoiceAmt",v),g==0&&f.setValue("Amount",v-y),f.setValue("DiscountAmt",y),r.setContext(u,"C_Invoice_ID",h.toString()))}catch(d){return this.setCalloutActive(!1),d.message}return this.setCalloutActive(!1),r=u=f=e=o=s=null,""};ti.prototype.Amounts=function(i,r,u,f,e,o){var d,g,b,k,p,w,it,y;if(this.isCalloutActive()||(d=i.getContextAsInt(r,"C_Invoice_ID"),d==0))return"";this.setCalloutActive(!0);g=0;u.getValue("C_InvoicePaySchedule_ID")!=null&&(g=u.getValue("C_InvoicePaySchedule_ID"));var a=n.Env.ZERO,v="N",tt=0,nt=!0,h=t.getValueOfDecimal(u.getValue("Amount")),c=t.getValueOfDecimal(u.getValue("DiscountAmt")),l=t.getValueOfDecimal(u.getValue("WriteOffAmt")),s=t.getValueOfDecimal(u.getValue("OverUnderAmt")),rt=t.getValueOfDecimal(u.getValue("InvoiceAmt"));return this.log.fine("Amt="+h+", Discount="+c+", WriteOff="+l+", OverUnder="+s+", Invoice="+rt),b=i.getContext(r,"DateTrx"),b==null&&(b=new Date),k=d.toString()+","+g.toString()+","+b.toString(),p=n.dataContext.getJSONRecord("MPayment/GetInvoiceData",k),p!=null&&(tt=t.getValueOfInt(p.C_Currency_ID),a=t.getValueOfDecimal(p.invoiceOpen),a==null&&(a=n.Env.ZERO),n.Env.ZERO==c&&(c=t.getValueOfDecimal(p.invoiceDiscount)),v=p.IsReturnTrx),v=="Y"?(h>0&&(h=h*-1,u.setValue("Amount",h)),c>0&&(c=c*-1),l>0&&(l=l*-1,u.setValue("WriteOffAmt",l)),s>0&&(s=s*-1,u.setValue("OverUnderAmt",s)),a>0&&(a=a*-1)):(h<0&&(h=h*-1,u.setValue("Amount",h)),c<0&&(c=c*-1),l<0&&(l=l*-1,u.setValue("WriteOffAmt",l)),s<0&&(s=s*-1,u.setValue("OverUnderAmt",s)),a<0&&(a=a*-1)),w=f.getColumnName(),k=tt.toString(),it=n.dataContext.getJSONRecord("MCurrency/GetCurrency",k),y=it.StdPrecision,w=="Amount"?(s=a-h-c-l,(v=="N"&&s>0||v=="Y"&&s<0)&&n.ADialog.info("LessScheduleAmount"),(v=="Y"&&s>0||v=="N"&&s<0)&&(n.ADialog.info("MoreScheduleAmount"),h=a-c-l,s=a-h-c-l,nt?u.setValue("Amount",h.toFixed(y)):u.setValue("Amount",h)),nt?(u.setValue("DiscountAmt",c.toFixed(y)),u.setValue("OverUnderAmt",s.toFixed(y))):(u.setValue("DiscountAmt",c),u.setValue("OverUnderAmt",s))):(h=a-c-l-s,(v=="Y"&&h>0||v=="N"&&h<0)&&(n.ADialog.info("MoreScheduleAmount"),w=="OverUnderAmt"&&(h=a-c-l,s=a-h-c-l),w=="DiscountAmt"&&(h=a-s-l,c=a-h-s-l),w=="WriteOffAmt"&&(h=a-c-s,l=a-h-c-s)),nt?(u.setValue("Amount",h.toFixed(y)),u.setValue("DiscountAmt",c.toFixed(y)),u.setValue("WriteOffAmt",l.toFixed(y)),u.setValue("OverUnderAmt",s.toFixed(y))):(u.setValue("Amount",h),u.setValue("DiscountAmt",c),u.setValue("WriteOffAmt",l),u.setValue("OverUnderAmt",s)),(v=="N"&&s>0||v=="Y"&&s<0)&&n.ADialog.info("LessScheduleAmount")),this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutPaymentAllocate=ti;n.Utility.inheritPrototype(h,n.CalloutEngine);h.prototype.Invoice=function(r,u,f,e,o){var c,g,p,nt,s,tt,y,l;if(o==null||o.toString()==""||(c=t.getValueOfInt(o.toString()),this.isCalloutActive()||c==null||c==0))return"";this.setCalloutActive(!0);f.setValue("C_Order_ID",null);f.setValue("C_Charge_ID",null);f.setValue("IsPrepayment",!1);f.setValue("DiscountAmt",n.Env.ZERO);f.setValue("WriteOffAmt",n.Env.ZERO);f.setValue("IsOverUnderPayment",!1);f.setValue("OverUnderAmt",n.Env.ZERO);var a=0,b="",k=!1,it=f.getField("IsInDispute")!=null,v=0,d=0,h=null;try{h=n.dataContext.getJSONRecord("MInvoice/GetInvPaySchedDetail",c.toString());h!=null&&(a=t.getValueOfInt(h.C_InvoicePaySchedule_ID),v=t.getValueOfDecimal(h.dueAmount),b=t.getValueOfString(h.IsReturnTrx),"Y"==b&&(v=v*-1),f.setValue("C_InvoicePaySchedule_ID",a),f.setValue("PayAmt",v),f.setValue("PaymentAmount",v),d=1,g=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),g.VA009_&&(t.getValueOfString(h.VA009_PaymentBaseType)!="B"&&t.getValueOfString(h.VA009_PaymentBaseType)!="C"&&t.getValueOfString(h.VA009_PaymentBaseType)!="P"?f.setValue("VA009_PaymentMethod_ID",t.getValueOfInt(h.VA009_PaymentMethod_ID)):f.setValue("VA009_PaymentMethod_ID",null)))}catch(w){return this.setCalloutActive(!1),this.log.log(i.SEVERE,"CalloutPayment.Invoice -"+c,w.message),w.toString()}r.getContextAsInt(u,"C_Invoice_ID")==c&&r.getContextAsInt(u,"C_InvoicePaySchedule_ID")!=0&&(a=r.getContextAsInt(u,"C_InvoicePaySchedule_ID"));p=new Date(f.getValue("DateTrx"));p==null&&(p=new Date);nt=c.toString()+","+a.toString()+","+p.toString();s=null;try{s=n.dataContext.getJSONRecord("MPayment/GetInvoiceData",nt);s!=null&&(f.setValue("C_BPartner_ID",t.getValueOfInt(s.C_BPartner_ID)),f.setValue("C_Bpartner_Location_Id",t.getValueOfInt(s.C_Bpartner_Location_Id)),tt=t.getValueOfInt(s.C_Currency_ID),f.setValue("C_Currency_ID",tt),f.setValue("C_ConversionType_ID",s.C_ConversionType_ID),y=t.getValueOfDecimal(s.invoiceOpen),y==null&&(y=n.Env.ZERO),l=t.getValueOfDecimal(s.invoiceDiscount),l==null&&(l=n.Env.ZERO),d==0&&(f.setValue("PayAmt",y-l),f.setValue("PaymentAmount",y-l)),f.setValue("C_InvoicePaySchedule_ID",a),f.setValue("DiscountAmt",l),r.setContext(u,"C_Invoice_ID",c.toString()),k=t.getValueOfString(s.IsInDispute)=="Y",it&&(k?(f.setValue("IsInDispute",!0),n.ADialog.info("DiscrepancyInvoice")):f.setValue("IsInDispute",!1)))}catch(w){return this.setCalloutActive(!1),w.message}return this.setCalloutActive(!1),this.DocType(r,u,f,e,o)};h.prototype.Order=function(r,u,f,e,o){var c,l,h,v;if(o==null||o.toString()==""||(c=o,this.isCalloutActive()||c==null||c==0))return"";this.setCalloutActive(!0);f.setValue("C_Invoice_ID",null);f.setValue("C_Charge_ID",null);f.setValue("IsPrepayment",!0);f.setValue("DiscountAmt",n.Env.ZERO);f.setValue("WriteOffAmt",n.Env.ZERO);f.setValue("IsOverUnderPayment",!1);f.setValue("OverUnderAmt",n.Env.ZERO);l=f.getValue("DateTrx");l==null&&(l=new Date);var a=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),p=a.VA009_+","+c.toString(),s=null;try{s=n.dataContext.getJSONRecord("MPayment/GetOrderData",p);s!=null&&(f.setValue("C_BPartner_ID",t.getValueOfInt(s.C_BPartner_ID)),f.setValue("C_Bpartner_Location_Id",t.getValueOfInt(s.C_BPartner_Location_ID)),f.setValue("C_Currency_ID",t.getValueOfInt(s.C_Currency_ID)),f.setValue("C_ConversionType_ID",t.getValueOfInt(s.C_ConversionType_ID)),h=t.getValueOfDecimal(s.GrandTotal),h==null&&(h=n.Env.ZERO),a.VA009_&&(v=t.getValueOfInt(s.VA009_PaymentMethod_ID),f.setValue("VA009_PaymentMethod_ID",v)),f.setValue("PaymentAmount",h),f.setValue("PayAmt",h),s.IsPrePayOrder==!0?f.getField("PaymentAmount").setReadOnly(!0):f.getField("PaymentAmount").setReadOnly(!1))}catch(y){return s!=null&&(s=null),this.log.log(i.SEVERE,sql,y),this.setCalloutActive(!1),y.message}return this.setCalloutActive(!1),this.DocType(r,u,f,e,o)};h.prototype.Charge=function(t,i,r,u,f){if(f==null||f.toString()=="")return""};h.prototype.DocType=function(i,r,u,f,e,o){var c=i.getContextAsInt(r,"C_Invoice_ID"),v=i.getContextAsInt(r,"C_Order_ID"),l=i.getContextAsInt(r,"C_DocType_ID"),y,p;this.log.fine("Payment_DocType - C_Invoice_ID="+c+", C_DocType_ID="+l);var s=l.toString(),a=n.dataContext.getJSONRecord("MDocType/GetDocType",s),h=t.getValueOfBoolean(a.IsSOTrx);return(l!=0&&(i.setWindowContext(r,"IsSOTrx",h?"Y":"N"),u.setValue("IsReceipt",h?"Y":"N")),c!=0&&(s=c.toString(),y=n.dataContext.getJSONRecord("MInvoice/GetInvoice",s),a!=null&&t.getValueOfBoolean(y.IsSOTrx)!=h))?n.Msg.getMsg("DocTypeInvInconsistent"):v!=0&&(s=v.toString(),p=n.dataContext.getJSONRecord("MOrder/GetOrder",s),a!=null&&t.getValueOfBoolean(p.IsSOTrx)!=h)?n.Msg.getMsg("DocTypeOrdInconsistent"):(i=r=u=f=e=o=null,"")};h.prototype.AmountCurrencyType=function(t,i,r,u,f){var h;if(this.isCalloutActive()||f==null||f.toString()=="")return r.setValue("OutStandingAmount",""),"";this.setCalloutActive(!0);var e="",o=r.getValue("C_BPartner_ID"),s=r.getValue("AsOnDate");if(s==""||s==null||o==""||o==null)return r.setValue("OutStandingAmount",e),this.setCalloutActive(!1),"";h="N,"+o.toString()+","+s.toString();try{e=n.dataContext.getJSONRecord("MPayment/GetOutStandingAmt",h);r.setValue("OutStandingAmount",e)}catch(c){this.setCalloutActive(!1)}return this.setCalloutActive(!1),""};h.prototype.Amounts=function(r,u,f,e,o,s){var k,it,w,ft,rt,st,g,at,vt,yt;if(this.isCalloutActive()||(k=r.getContextAsInt(u,"C_Invoice_ID"),r.getContextAsInt(u,"C_Payment_ID")==0&&r.getContextAsInt(u,"C_BPartner_ID")==0&&k==0)||(it=f.getValue("C_Currency_ID"),it==null))return"";if(k!=0){this.setCalloutActive(!0);w=e.getColumnName();ft=0;r.getContextAsInt(u,"C_Invoice_ID")==k&&f.getValue("C_InvoicePaySchedule_ID")!=null&&(ft=f.getValue("C_InvoicePaySchedule_ID"));var a=n.Env.ZERO,l=n.Env.ZERO,d=0,et=0,b="N",ot=!0;k!=0&&(rt=f.getValue("DateTrx"),rt==null&&(rt=new Date),st=k.toString()+","+ft.toString()+","+rt.toString(),g=n.dataContext.getJSONRecord("MPayment/GetInvoiceData",st),g!=null&&(d=t.getValueOfInt(g.C_Currency_ID),et=t.getValueOfInt(g.C_ConversionType_ID),a=t.getValueOfDecimal(g.invoiceOpen),a==null&&(a=n.Env.ZERO),l=t.getValueOfDecimal(g.invoiceDiscount),b=g.IsReturnTrx));this.log.fine("Open="+a+" Discount= "+l+", C_Invoice_ID="+k+", C_Currency_ID="+d);w=="PaymentAmount"&&f.setValue("PayAmt",f.getValue("PaymentAmount"));var h=t.getValueOfDecimal(f.getValue("PayAmt")==null?n.Env.ZERO:f.getValue("PayAmt")),v=t.getValueOfDecimal(f.getValue("WriteOffAmt")==null?n.Env.ZERO:f.getValue("WriteOffAmt")),c=t.getValueOfDecimal(f.getValue("OverUnderAmt")==null?n.Env.ZERO:f.getValue("OverUnderAmt")),y=t.getValueOfDecimal(f.getValue("DiscountAmt")==null?n.Env.ZERO:f.getValue("DiscountAmt"));b=="Y"?(h>0?(h=h*-1,f.setValue("PayAmt",h),f.setValue("PaymentAmount",h)):f.setValue("PaymentAmount",h),y>0&&(y=y*-1),l>0&&(l=l*-1),v>0&&(v=v*-1,f.setValue("WriteOffAmt",v)),c>0&&(c=c*-1,f.setValue("OverUnderAmt",c)),a>0&&(a=a*-1)):(h<0?(h=h*-1,f.setValue("PayAmt",h),f.setValue("PaymentAmount",h)):f.setValue("PaymentAmount",h),y<0&&(y=y*-1),l<0&&(l=l*-1),v<0&&(v=v*-1,f.setValue("WriteOffAmt",v)),c<0&&(c=c*-1,f.setValue("OverUnderAmt",c)),a<0&&(a=a*-1));this.log.fine("Pay="+h+", Discount="+y+", WriteOff="+v+", OverUnderAmt="+c);var tt=t.getValueOfInt(it),st=tt.toString(),ut=n.dataContext.getJSONRecord("MCurrency/GetCurrency",st),p=ut.StdPrecision,ct=f.getValue("DateAcct"),ht=0,lt=t.getValueOfInt(f.getValue("C_ConversionType_ID"));lt!=null&&(ht=lt);var wt=r.getContextAsInt(u,"AD_Client_ID"),bt=r.getContextAsInt(u,"AD_Org_ID"),nt=n.Env.ONE;if(tt>0&&d>0&&tt!=d||w=="C_Currency_ID"||w=="C_ConversionType_ID"){if(this.log.fine("InvCurrency="+d+", PayCurrency="+tt+", Date="+ct+", Type="+ht),at=d+","+tt+","+ct+","+ht+","+wt+","+bt,nt=n.dataContext.getJSONRecord("MConversionRate/GetRate",at),nt==null||nt.toString()==0){if(this.setCalloutActive(!1),d==0)return"";if(f.setValue("C_Currency_ID",d),w=="C_ConversionType_ID"){if(et==0)return"";f.setValue("C_ConversionType_ID",et)}return"NoCurrencyConversion"}a=t.getValueOfDecimal((a*nt).toFixed(ut.StdPrecision));y!=0&&(l=y);l=t.getValueOfDecimal((l*nt).toFixed(ut.StdPrecision));this.log.fine("Rate="+nt+", InvoiceOpenAmt="+a+", DiscountAmt="+l)}w=="C_Currency_ID"||w=="C_ConversionType_ID"?(v=0,f.setValue("WriteOffAmt",v),c=0,f.setValue("OverUnderAmt",c),y=0,f.setValue("DiscountAmt",y),l=y,h=a-l-v-c,f.setValue("PayAmt",t.getValueOfDecimal(h.toFixed(p))),f.setValue("PaymentAmount",t.getValueOfDecimal(h.toFixed(p)))):k==0?(n.Env.ZERO!=l&&f.setValue("DiscountAmt",n.Env.ZERO),n.Env.ZERO!=v&&f.setValue("WriteOffAmt",n.Env.ZERO),n.Env.ZERO!=c&&f.setValue("OverUnderAmt",n.Env.ZERO)):w=="PayAmt"||w=="PaymentAmount"?(y!=0&&(l=y),c=a-h-l-v,(b=="N"&&c>0||b=="Y"&&c<0)&&n.ADialog.info("LessScheduleAmount"),(b=="Y"&&c>0||b=="N"&&c<0)&&(n.ADialog.info("MoreScheduleAmount"),h=a-l-v,c=a-h-l-v,ot?(f.setValue("PayAmt",t.getValueOfDecimal(h.toFixed(p))),f.setValue("PaymentAmount",t.getValueOfDecimal(h.toFixed(p)))):(f.setValue("PayAmt",h),f.setValue("PaymentAmount",h))),ot?(f.setValue("DiscountAmt",t.getValueOfDecimal(l.toFixed(p))),f.setValue("OverUnderAmt",t.getValueOfDecimal(c.toFixed(p)))):(f.setValue("DiscountAmt",l),f.setValue("OverUnderAmt",c))):(l=y,h=a-l-v-c,(b=="Y"&&h>0||b=="N"&&h<0)&&(n.ADialog.info("MoreScheduleAmount"),w=="OverUnderAmt"&&(h=a-l-v,c=a-h-l-v),w=="DiscountAmt"&&(h=a-c-v,l=a-h-c-v),w=="WriteOffAmt"&&(h=a-l-c,v=a-h-l-c)),ot?(f.setValue("PayAmt",t.getValueOfDecimal(h.toFixed(p))),f.setValue("PaymentAmount",t.getValueOfDecimal(h.toFixed(p))),f.setValue("DiscountAmt",t.getValueOfDecimal(l.toFixed(p))),f.setValue("WriteOffAmt",t.getValueOfDecimal(v.toFixed(p))),f.setValue("OverUnderAmt",t.getValueOfDecimal(c.toFixed(p)))):(f.setValue("PayAmt",h),f.setValue("PaymentAmount",h),f.setValue("DiscountAmt",l),f.setValue("WriteOffAmt",v),f.setValue("OverUnderAmt",c)),(b=="N"&&c>0||b=="Y"&&c<0)&&n.ADialog.info("LessScheduleAmount"));this.setCalloutActive(!1)}else{this.setCalloutActive(!0);try{if((t.getValueOfInt(f.getValue("C_Order_ID"))>0&&t.getValueOfInt(f.getValue("VA009_OrderPaySchedule_ID"))==0||t.getValueOfInt(f.getValue("C_Order_ID"))==0&&t.getValueOfInt(f.getValue("VA009_OrderPaySchedule_ID"))==0&&t.getValueOfInt(f.getValue("C_Invoice_ID"))==0&&t.getValueOfInt(f.getValue("C_InvoicePaySchedule_ID"))==0)&&f.setValue("PayAmt",t.getValueOfDecimal(f.getValue("PaymentAmount"))),vt=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA026_"),vt.VA026_&&e.getColumnName()=="PaymentAmount"&&(yt=n.dataContext.getJSONRecord("MDocType/GetDocType",f.getValue("C_DocType_ID")),!t.getValueOfBoolean(yt.IsSOTrx))){var ut=n.dataContext.getJSONRecord("MCurrency/GetCurrency",it),p=ut.StdPrecision,kt=t.getValueOfDecimal(f.getValue("PaymentAmount"))/t.getValueOfDecimal(f.getValue("VA026_Interest")/100+1).toString();f.setValue("VA026_InterestAmt",t.getValueOfDecimal(kt.toFixed(p)));f.setValue("VA026_InterestAmount",t.getValueOfDecimal((f.getValue("PaymentAmount")-f.getValue("VA026_InterestAmt")).toFixed(p)))}this.setCalloutActive(!1)}catch(pt){return this.setCalloutActive(!1),this.log.log(i.SEVERE,sql,pt),pt}}return r=u=f=e=o=s=null,""};h.prototype.BankAccount=function(i,r,u,f,e,o){var s,h;if(e==null||e.toString()==""||(s=e,this.isCalloutActive()))return"";this.setCalloutActive(!0);try{h=t.getValueOfInt(n.dataContext.getJSONRecord("MPayment/GetBankAcctCurrency",s.toString()));u.setValue("C_Currency_ID",h);hu(u)}catch(c){return this.setCalloutActive(!1),c.message}return this.setCalloutActive(!1),i=u=f=e=o=null,""};h.prototype.SetOverrideAutoCheck=function(n,t,i,r,u,f){if(u==null||u.toString()=="")return i.setValue("IsOverrideAutoCheck",!1),"";if(this.isCalloutActive())return"";this.setCalloutActive(!0);try{hu(i)}catch(e){return this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),n=i=r=u=f=null,""};h.prototype.ProvisionalInvoice=function(i,r,u,f,e,o){var s,h;if(e==null||e.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);try{s=n.dataContext.getJSONRecord("MPayment/GetProvisionalInvoiceData",t.getValueOfInt(u.getValue("C_ProvisionalInvoice_ID")));s!=null&&(u.setValue("C_BPartner_ID",s.C_BPartner_ID),u.setValue("C_BPartner_Location_ID",s.C_BPartner_Location_ID),u.setValue("PaymentAmount",s.GrandTotal),u.setValue("PayAmt",s.GrandTotal),u.setValue("C_Currency_ID",s.C_Currency_ID),u.setValue("C_ConversionType_ID",s.C_ConversionType_ID),h=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),h.VA009_)}catch(c){this.setCalloutActive(!1);this.log.severe(c.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutPayment=h;n.Utility.inheritPrototype(w,n.CalloutEngine);w.prototype.DocType=function(r,u,f,o,s,h){var st="O",ht="S",st="O",ht="S",ut="F",nt="PR",b="WR",y="",d,g,w,tt,it,a,ft,l,p,c,et;try{if(s==null||s.toString()==""||(d=s,d==null||d==0))return"";if(g=f.getValue("DocumentNo"),w=g==null,!w&&g.toString().startsWith("<")&&g.toString().endsWith(">")&&(w=!0),tt=f.getValue("C_DocType_ID"),y="SELECT d.DocSubTypeSO,d.HasCharges,'N',d.IsDocNoControlled,s.CurrentNext,s.CurrentNextSys,s.AD_Sequence_ID,d.IsSOTrx, d.IsReturnTrx FROM C_DocType d LEFT OUTER JOIN AD_Sequence s ON (d.DocNoSequence_ID=s.AD_Sequence_ID) WHERE C_DocType_ID=",it=0,a=null,w||tt==0)y=y+d,a=n.DB.executeDataset(y,null);else for(y=y+tt,a=n.DB.executeDataset(y,null),l=0;l<a.getTables()[0].rows.count;l++)it=t.getValueOfInt(a.getRows()[l].getCell("AD_Sequence_ID"));var v="",k=!0,rt=!1;for(l=0;l<a.getTables()[0].rows.count;l++)if(v=t.getValueOfString(a.getRows()[l].getCell("DocSubTypeSO")),v==null&&(v="--"),r.setContext(u,"OrderType",v),v.toString().equals("SO")||f.setValue("IsDropShip","N"),"N".toString().equals(t.getValueOfString(a.getRows()[l].getCell("IsSOTrx")))&&(k=!1),rt="Y".toString().equals(t.getValueOfString(a.getRows()[l].getCell("IsReturnTrx"))),rt?v.toString().equals(b)?f.setValue("DeliveryRule",ut):f.setValue("DeliveryRule","M"):(v.toString().equals(b)?f.setValue("DeliveryRule",ut):v.toString().equals(nt)?f.setValue("DeliveryRule","R"):f.setValue("DeliveryRule","A"),v.toString().equals(b)||v.toString().equals(nt)||v.toString().equals("WI")?f.setValue("InvoiceRule","I"):f.setValue("InvoiceRule","D"),v.toString().equals(b)?f.setValue("PaymentRule",PAYMENTRULE_Cash):f.setValue("PaymentRule",PAYMENTRULE_OnCredit),r.setContext(u,"HasCharges",t.getValueOfString(a.getRows()[l].getCell("HasCharges")))),p[3].toString().equals("Y")&&(w||it==t.getValueOfInt(a.getRows()[l].getCell("AD_Sequence_ID"))||(w=!0),w))try{f.setValue("DocumentNo","<"+t.getValueOfString(a.getRows()[l].getCell("CurrentNext"))+">")}catch(ot){this.setCalloutActive(!1)}if(rt)return"";if(!v.toString().equals(b)&&!v.toString().equals(nt))for(ft=r.getContextAsInt(u,"C_BPartner_ID"),y="SELECT PaymentRule,C_PaymentTerm_ID,InvoiceRule,DeliveryRule,FreightCostRule,DeliveryViaRule, PaymentRulePO,PO_PaymentTerm_ID FROM C_BPartner WHERE C_BPartner_ID="+ft,a=n.DB.executeDataset(y,null),l=0;l<a.getTables()[0].rows.count;l++)p=a.getTables()[0].rows[l],c=t.getValueOfString(p.get(k?"paymentrule":"paymentrulepo")),c!=null&&c.toString().length!=0&&(k&&(c.toString().equals("B")||c.toString().equals("S")||c.toString().equals("U"))&&(c="P"),!k&&c.toString().equals("B")&&(c="P"),f.setValue("PaymentRule",c)),et=t.getValueOfInt(p.get(k?"c_paymentterm_id":"po_paymentterm_id")),p!=null&&f.setValue("C_PaymentTerm_ID",et),c=p[2].toString(),c!=null&&c.length!=0&&f.setValue("InvoiceRule",c),c=p[3].toString(),c!=null&&c.length!=0&&f.setValue("DeliveryRule",c),c=p[4].toString(),c!=null&&c.length!=0&&f.setValue("FreightCostRule",c),c=p[5].toString(),c!=null&&c.length!=0&&f.setValue("DeliveryViaRule",c)}catch(ot){return this.setCalloutActive(!1),this.log.log(i.SEVERE,y,ot),e.message}return r=u=f=o=s=h=null,""};w.prototype.BPartner=function(r,u,f,o,s,h){var ot="O",st="S",ot="O",st="S",k="",a,rt,v,d,b,l,y,g,p,nt,w,tt,ut,ft,c,it;try{if(s==null||s==0||s.toString()==""||(a=0,s!=null&&(a=t.getValueOfInt(s.toString())),a==0)||(rt=f.getValue("IsReturnTrx"),rt))return"";for(this.setCalloutActive(!0),k="SELECT p.AD_Language,p.C_PaymentTerm_ID, COALESCE(p.M_PriceList_ID,g.M_PriceList_ID) AS M_PriceList_ID, p.PaymentRule,p.POReference, p.SO_Description,p.IsDiscountPrinted, p.InvoiceRule,p.DeliveryRule,p.FreightCostRule,DeliveryViaRule, p.SO_CreditLimit, p.SO_CreditLimit-p.SO_CreditUsed AS CreditAvailable, lship.C_BPartner_Location_ID,c.AD_User_ID, COALESCE(p.PO_PriceList_ID,g.PO_PriceList_ID) AS PO_PriceList_ID, p.PaymentRulePO,p.PO_PaymentTerm_ID, lbill.C_BPartner_Location_ID AS Bill_Location_ID, p.SOCreditStatus, lbill.IsShipTo FROM C_BPartner p INNER JOIN C_BP_Group g ON (p.C_BP_Group_ID=g.C_BP_Group_ID) LEFT OUTER JOIN C_BPartner_Location lbill ON (p.C_BPartner_ID=lbill.C_BPartner_ID AND lbill.IsBillTo='Y' AND lbill.IsActive='Y') LEFT OUTER JOIN C_BPartner_Location lship ON (p.C_BPartner_ID=lship.C_BPartner_ID AND lship.IsShipTo='Y' AND lship.IsActive='Y') LEFT OUTER JOIN AD_User c ON (p.C_BPartner_ID=c.C_BPartner_ID) WHERE p.C_BPartner_ID="+a+" AND p.IsActive='Y'",v=r.getWindowContext(u,"IsSOTrx",!0)=="Y",d=n.DB.executeDataset(k,null),b=0;b<d.getTables()[0].rows.count;b++)l=d.getTables()[0].rows[b],y=t.getValueOfInt(l.get(v?"m_pricelist_id":"po_pricelist_id")),l!=null&&y!=0&&f.setValue("M_PriceList_ID",y),f.setValue("Bill_BPartner_ID",a),g=t.getValueOfInt(l.get("bill_location_id")),g==0?f.setValue("Bill_Location_ID",null):f.setValue("Bill_Location_ID",g),p=t.getValueOfInt(l.get("c_bpartner_location_id")),a.toString().equals(r.getContext("C_BPartner_ID"))&&(nt=r.getContext("C_BPartner_Location_ID"),nt.toString().length>0&&(p=int.Parse(nt))),p==0?f.setValue("C_BPartner_Location_ID",null):(f.setValue("C_BPartner_Location_ID",p),"Y".toString().equals(t.getValueOfString(l.get("isshipto")))&&f.setValue("Bill_Location_ID",p)),w=t.getValueOfInt(l.get("ad_user_id").toString()),a.toString().toString().equals(r.getContext("C_BPartner_ID"))&&(tt=r.getContext("AD_User_ID"),tt.toString().length>0&&(w=t.getValueOfInt(tt))),w==0?f.setValue("AD_User_ID",null):(f.setValue("AD_User_ID",w),f.setValue("Bill_User_ID",w)),v&&(ut=t.getValueOfDouble(l.get("so_creditlimit")),ut!=0&&(ft=t.getValueOfDouble(l.get("creditavailable")),l!=null&&ft<0)),c=l.get("poreference").toString(),c!=null&&c.toString().length!=0&&f.setValue("POReference",c),c=t.getValueOfString(l.get("so_description")),c!=null&&c.toString().trim().length!=0&&f.setValue("Description",c),c=t.getValueOfString(l.get("isdiscountprinted")),c!=null&&c.toString().length!=0?f.setValue("IsDiscountPrinted",c):f.setValue("IsDiscountPrinted","N"),it=r.getContext("OrderType"),f.setValue("InvoiceRule","D"),f.setValue("DeliveryRule","A"),f.setValue("PaymentRule",PAYMENTRULE_OnCredit),it.toString().equals("PR")?(f.setValue("InvoiceRule","I"),f.setValue("DeliveryRule","R")):it.toString().equals(MOrder.DocSubTypeSO_POS)?f.setValue("PaymentRule",PAYMENTRULE_Cash):(c=l[v?"PaymentRule":"PaymentRulePO"].toString(),c!=null&&c.length!=0&&(c.toString().equals("B")&&(c="P"),v&&(c.toString().equals("S")||c.toString().equals("U"))&&(c="P"),f.setValue("PaymentRule",c)),y=t.getValueOfInt(l.get(v?"c_paymentterm_id":"po_paymentterm_id")),l!=null&&y!=0&&f.setValue("C_PaymentTerm_ID",y),c=t.getValueOfString(l.get("invoicerule")),c!=null&&c.length!=0&&f.setValue("InvoiceRule",c),c=t.getValueOfString(l.get("deliveryrule")),c!=null&&c.length!=0&&f.setValue("DeliveryRule",c),c=t.getValueOfString(l.get("freightcostrule")),c!=null&&c.length!=0&&f.setValue("FreightCostRule",c),c=t.getValueOfString(l.get("deliveryviarule")),c!=null&&c.length!=0&&f.setValue("DeliveryViaRule",c))}catch(et){return this.log.log(i.SEVERE,k,et),this.setCalloutActive(!1),e.message}return this.setCalloutActive(!1),r=u=f=o=s=h=null,""};w.prototype.Product=function(i,r,f,e,s){var c,b,p,nt,h,l,tt,y,w,ft;if(s==null||s==0||s.toString()=="")return"";try{if((c=s,c==null||c==0)||(b="Y".toString().equals(i.getContext("IsReturnTrx")),b))return"";this.setCalloutActive(!0);u&&this.log.warning("init");f.setValue("C_Charge_ID",null);f.setValue("M_AttributeSetInstance_ID",null);var et=i.getContextAsInt(r,"C_BPartner_ID"),ot=t.getValueOfDecimal(f.getValue("QtyEntered")),k=i.getWindowContext(r,"IsSOTrx",!0)=="Y",d=i.getContextAsInt(r,"M_PriceList_ID"),st=d.toString().concat(",",t.getValueOfString(f.getValue("StartDate")),",",t.getValueOfString(f.getValue("M_Product_ID")),",",t.getValueOfInt(f.getValue("C_UOM_ID")),",",t.getValueOfInt(f.getValue("M_AttributeSetInstance_ID"))),g=n.dataContext.getJSONRecord("MPriceListVersion/GetM_PriceList_Version_ID_On_Transaction_Date",st),ht=f.getValue("DateOrdered"),a="SELECT COUNT(AD_MODULEINFO_ID) FROM AD_MODULEINFO WHERE PREFIX='ED011_'";if(o=t.getValueOfInt(n.DB.executeScalar(a)),p=0,o>0&&(a="SELECT C_UOM_ID FROM M_Product_PO WHERE IsActive = 'Y' AND  C_BPartner_ID = "+t.getValueOfInt(f.getValue("C_BPartner_ID"))+" AND M_Product_ID = "+c,p=t.getValueOfInt(n.DB.executeScalar(a)),p>0&&k==!1?f.setValue("C_UOM_ID",p):(a="SELECT C_UOM_ID FROM M_Product WHERE IsActive = 'Y' AND M_Product_ID = "+c,f.setValue("C_UOM_ID",t.getValueOfInt(n.DB.executeScalar(a))))),nt=t.getValueOfInt(f.getValue("C_UOM_ID")),l=c.toString().concat(",",et.toString(),",",ot.toString(),",",k,",",d.toString(),",",g.toString(),",",null,",",null,",",null,",",nt,",",o),t.getValueOfInt(g)>0&&(h=null,h=n.dataContext.getJSONRecord("MProductPricing/GetProductPricing",l),f.setValue("PriceList",h.PriceList),f.setValue("PriceLimit",h.PriceLimit),f.setValue("PriceActual",h.PriceActual),f.setValue("PriceEntered",h.PriceEntered),t.getValueOfInt(h.C_Currency_ID)>0&&f.setValue("C_Currency_ID",t.getValueOfInt(h.C_Currency_ID)),f.setValue("Discount",h.Discount),f.setValue("C_UOM_ID",t.getValueOfInt(h.C_UOM_ID)),f.setValue("QtyOrdered",f.getValue("QtyEntered")),i.setContext(r,"EnforcePriceLimit",h.IsEnforcePriceLimit?"Y":"N"),i.setContext(r,"DiscountSchema",h.IsDiscountSchema?"Y":"N")),i.getWindowContext(r,"IsSOTrx",!0)=="Y"&&(l=c.toString()+",0",tt=n.dataContext.getJSONRecord("MProduct/GetProduct",l),tt)){var it=t.getValueOfDecimal(f.getValue("QtyEntered")),rt=i.getContextAsInt(r,"M_Warehouse_ID"),ut=i.getContextAsInt(r,"M_AttributeSetInstance_ID"),l=rt+","+c+","+ut,v=n.dataContext.getJSONRecord("MStorage/GetQtyAvailable",l);v==null&&(v=n.Env.ZERO);v==0||v.toString().compareTo(it)<0||(y=0,f.getValue("C_OrderLine_ID")!=null&&(y=t.getValueOfInt(f.getValue("C_OrderLine_ID"))),y==null&&(y=0),l=rt.toString()+","+c.toString()+","+ut.toString()+","+y.toString(),w=t.getValueOfDecimal(n.dataContext.getJSONRecord("MOrderLine/GetNotReserved",l)),w==null&&(w=n.Env.ZERO),ft=v-w,ft.toString().compareTo(it)<0)}this.setCalloutActive(!1);u&&this.log.warning("fini")}catch(ct){this.setCalloutActive(!1)}return this.Tax(i,r,f,e,s)};w.prototype.Tax=function(i,r,u,f,e){var o=0,s=n.Env.ZERO,h=n.Env.ZERO,a="",c,l;return o=t.getValueOfInt(u.getValue("C_Tax_ID")),c="select rate from c_tax WHERE c_tax_id="+o+"",s=t.getValueOfDecimal(n.DB.executeScalar(c,null,null)),a=this.Amt(i,r,u,f,e),l=t.getValueOfDecimal(u.getValue("LineNetAmt")),h=t.getValueOfDecimal(t.getValueOfDecimal(l)*t.getValueOfDecimal(s)/100),u.setValue("taxamt",h),this.Amt(i,r,u,f,e)};w.prototype.Amt=function(i,r,f,e,s,h){var ft,it,st,v,y,g;if(this.isCalloutActive()||s==null||s.toString()=="")return"";this.setCalloutActive(!0);try{u&&this.log.warning("init");var d=i.getContextAsInt(r,"C_UOM_ID"),p=i.getContextAsInt(r,"M_Product_ID"),rt=i.getContextAsInt(r,"M_PriceList_ID"),ct=rt.toString(),y=n.dataContext.getJSONRecord("MPriceList/GetPriceList",ct),nt=t.getValueOfInt(y.StdPrecision),k,c,l,w,a,b;if(k=t.getValueOfDecimal(f.getValue("QtyEntered")),k=t.getValueOfDecimal(f.getValue("QtyEntered")),this.log.fine("QtyEntered="+k+", Ordered="+k+", UOM="+d),c=t.getValueOfDecimal(f.getValue("PriceEntered")),l=t.getValueOfDecimal(f.getValue("PriceActual")),a=t.getValueOfDecimal(f.getValue("Discount")),w=t.getValueOfDecimal(f.getValue("PriceLimit")),b=t.getValueOfDecimal(f.getValue("PriceList")),this.log.fine("PriceList="+b+", Limit="+w+", Precision="+nt),this.log.fine("PriceEntered="+c+", Actual="+l+", Discount="+a),(e.getColumnName().toString().equals("QtyEntered")||e.getColumnName().toString().equals("QtyEntered")||e.getColumnName().toString().equals("M_Product_ID"))&&!"N".toString().equals(i.getContext("DiscountSchema"))){ft=i.getContextAsInt(r,"C_BPartner_ID");e.getColumnName().toString().equals("QtyEntered")&&(v=p.toString()+","+d.toString()+","+k.toString(),k=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",v)));var et=i.getWindowContext(r,"IsSOTrx",!0)=="Y",lt=rt.toString().concat(",",t.getValueOfString(f.getValue("StartDate")),",",t.getValueOfString(f.getValue("M_Product_ID")),",",t.getValueOfInt(f.getValue("C_UOM_ID")),",",t.getValueOfInt(f.getValue("M_AttributeSetInstance_ID"))),ot=n.dataContext.getJSONRecord("MPriceListVersion/GetM_PriceList_Version_ID_On_Transaction_Date",lt),tt="SELECT COUNT(AD_MODULEINFO_ID) FROM AD_MODULEINFO WHERE PREFIX='ED011_'";o=t.getValueOfInt(n.DB.executeScalar(tt));it=0;o>0&&(tt="SELECT C_UOM_ID FROM M_Product_PO WHERE IsActive = 'Y' AND  C_BPartner_ID = "+t.getValueOfInt(f.getValue("C_BPartner_ID"))+" AND M_Product_ID = "+p,it=t.getValueOfInt(n.DB.executeScalar(tt)),it>0&&et==!1?f.setValue("C_UOM_ID",it):(tt="SELECT C_UOM_ID FROM M_Product WHERE IsActive = 'Y' AND M_Product_ID = "+p,f.setValue("C_UOM_ID",t.getValueOfInt(n.DB.executeScalar(tt)))));st=t.getValueOfInt(f.getValue("C_UOM_ID"));v=p.toString().concat(",",ft.toString(),",",k.toString(),",",et,",",rt.toString(),",",ot.toString(),",",null,",",null,",",null,",",st,",",o);t.getValueOfInt(ot)>0&&(y=null,y=n.dataContext.getJSONRecord("MProductPricing/GetProductPricing",v),v=p.toString()+","+d.toString()+","+y.PriceStd.toString(),c=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",v)),(c==null||c==0)&&(c=y.PriceStd),this.log.fine("QtyChanged -> PriceActual="+y.PriceStd+", PriceEntered="+c+", Discount="+y.Discount),l=y.PriceStd,f.setValue("PriceActual",y.PriceActual),f.setValue("Discount",y.Discount),f.setValue("PriceEntered",y.PriceEntered),i.setContext(r,"DiscountSchema",y.DiscountSchema?"Y":"N"))}else e.getColumnName().toString().equals("PriceActual")?(l=t.getValueOfDecimal(s),v=p.toString()+","+d.toString()+","+l.toString(),c=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",v)),(c==null||c==0)&&(c=l),this.log.fine("PriceActual="+l+" -> PriceEntered="+c),f.setValue("PriceEntered",c)):e.getColumnName().toString().equals("PriceEntered")&&(c=t.getValueOfDecimal(s),v=p.toString()+","+d.toString()+","+c.toString(),l=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductTo",v)),(l==null||c==0)&&(l=c),this.log.fine("PriceEntered="+c+" -> PriceActual="+l),f.setValue("PriceActual",l));e.getColumnName().toString().equals("Discount")?(l=t.getValueOfDecimal((100-t.getValueOfDouble(a))/100*t.getValueOfDouble(b)),t.scale(l)>nt&&(l=l.toFixed(nt)),v=p.toString()+","+d.toString()+","+l.toString(),c=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",v)),(c==null||c==0)&&(c=l),f.setValue("PriceActual",l),f.setValue("PriceEntered",c)):(a=b==0?n.Env.ZERO:t.getValueOfDecimal((b-l)/b*100),t.scale(a)>2&&(a=a.toFixed(2)),f.setValue("Discount",a));this.log.fine("PriceEntered="+c+", Actual="+l+", Discount="+a);var ht=i.getContext("EnforcePriceLimit"),ut=i.getWindowContext(r,"IsSOTrx",!0)=="Y"&&ht!=null&&ht.toString().equals("Y"),at="Y".toString().equals(i.getContext("IsReturnTrx"));ut&&(n.MRole.getDefault().getIsOverwritePriceLimit()||at)&&(ut=!1);ut&&t.getValueOfDouble(w)!=0&&l.toString().compare(w)<0&&(l=w,v=p.toString()+","+d.toString()+","+w.toString(),c=t.getValueOfDecimal(n.dataContext.getJSONRecord("MUOMConversion/ConvertProductFrom",v)),(c==null||c==0)&&(c=w),this.log.fine("(under) PriceEntered="+c+", Actual"+w),f.setValue("PriceActual",w),f.setValue("PriceEntered",c),n.ADialog.info("UnderLimitPrice"),b!=0&&(a=t.getValueOfDecimal((b-l)/b*100),t.scale(a)>2&&(a=a.toFixed(2)),f.setValue("Discount",a)));g=k*l;t.scale(g)>nt&&(g=g.toFixed(nt));this.log.info("LineNetAmt="+g);f.setValue("LineNetAmt",g);f.setValue("GrandTotal",t.getValueOfDecimal(f.getValue("TaxAmt"))+g)}catch(vt){}return this.setCalloutActive(!1),i=r=f=e=s=h=null,""};w.prototype.BPartnerContract=function(i,r,u,f,e,o){var h=null,s=null,at,yt,ft,et,w,ot,st,c,nt,p,ht,b,ct,tt,vt,k,it,rt,pt,y;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{var a=0,v="N",ut="N",lt=t.getValueOfString(u.getValue("ContractType"));if(lt==""||(e!=null&&(a=t.getValueOfInt(e.toString())),a==0)||(at=t.getValueOfBoolean(u.getValue("IsReturnTrx")),at))return"";this.setCalloutActive(!0);var d=!1,p="VA009_",g=lt=="ASR"?!0:!1,s=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix",p);if(s!=null&&(d=s.VA009_),p=d.toString()+","+a,s=n.dataContext.getJSONRecord("MBPartner/GetBPartnerOrderData",p),s!=null){if(yt=t.getValueOfInt(u.getValue("M_PriceList_ID")),y=t.getValueOfInt(g?s.M_PriceList_ID:s.PO_PriceList_ID),y!=0?u.setValue("M_PriceList_ID",y):u.setValue("M_PriceList_ID",null),u.setValue("Bill_BPartner_ID",a),ft=t.getValueOfInt(s.Bill_Location_ID),ft==0?(et=t.getValueOfInt(s.Bill_BPartner_ID),et>0&&u.setValue("Bill_BPartner_ID",et)):u.setValue("Bill_Location_ID",ft),w=t.getValueOfInt(s.C_BPartner_Location_ID),a.toString()==i.getContext("C_BPartner_ID")&&(ot=i.getContext("C_BPartner_Location_ID"),ot.length>0&&(w=t.getValueOfInt(ot))),w==0?u.setValue("C_BPartner_Location_ID",null):(u.setValue("C_BPartner_Location_ID",w),"Y"==t.getValueOfString(s.IsShipTo)&&u.setValue("Bill_Location_ID",w)),st=t.getValueOfInt(s.SalesRep_ID),st>0&&u.setValue("SalesRep_ID",st),d){var l=t.getValueOfInt(s.VA009_PaymentMethod_ID);nt<=0&&(c=n.dataContext.getJSONRecord("MBPartner/GetBPDetails",a),c!=null&&(v=t.getValueOfString(c.IsVendor),ut=t.getValueOfString(c.IsCustomer),g?v=="Y"?(l=0,h=null,ut=="Y"&&(l=t.getValueOfInt(c.VA009_PaymentMethod_ID),h=t.getValueOfString(c.VA009_PAYMENTBASETYPE))):ut=="Y"&&(l=t.getValueOfInt(c.VA009_PaymentMethod_ID),h=t.getValueOfString(c.VA009_PAYMENTBASETYPE)):v=="Y"?(l=t.getValueOfInt(c.VA009_PO_PaymentMethod_ID),h=t.getValueOfString(c.VA009_PAYMENTBASETYPEPO)):(l=0,h=null)));l==0?(nt=t.getValueOfInt(u.getValue("C_Order_Blanket")),nt>0&&(p=d.toString()+","+nt.toString(),s=n.dataContext.getJSONRecord("MOrder/GetPaymentMethod",p),s!=null&&(ht=t.getValueOfInt(s.VA009_PaymentMethod_ID),ht>0&&(u.setValue("VA009_PaymentMethod_ID",ht),h=t.getValueOfString(s.VA009_PaymentBaseType),h!="W"&&h!=null&&(u.setValue("PaymentMethod",h),v=="N"?u.setValue("PaymentRule",h):u.setValue("PaymentRulePO",h)))))):l==0?u.setValue("VA009_PaymentMethod_ID",null):(u.setValue("VA009_PaymentMethod_ID",l),h!="W"&&h!=null?(u.setValue("PaymentMethod",h),v=="N"?u.setValue("PaymentRule",h):u.setValue("PaymentRulePO",h)):(u.setValue("PaymentMethod","T"),v=="N"?u.setValue("PaymentRule","T"):u.setValue("PaymentRulePO","T")))}b=t.getValueOfInt(s.AD_User_ID);a.toString()==i.getContext("C_BPartner_ID")&&(ct=i.getContext("AD_User_ID"),ct.length>0&&(b=t.getValueOfInt(ct)));b==0?u.setValue("AD_User_ID",null):(u.setValue("AD_User_ID",b),u.setValue("Bill_User_ID",b));g&&(tt=t.getValueOfString(s.CreditStatusSettingOn),tt=="CH"?(it=t.getValueOfDouble(s.SO_CreditLimit),it!=0&&(rt=t.getValueOfDouble(s.CreditAvailable),rt<=0&&n.ADialog.info("CreditOver"))):(vt=t.getValueOfInt(u.getValue("C_BPartner_Location_ID")),k=n.dataContext.getJSONRecord("MBPartner/GetLocationData",vt.toString()),k!=null&&(tt=t.getValueOfString(k.CreditStatusSettingOn),tt=="CL"&&(it=t.getValueOfDouble(k.SO_CreditLimit),it!=0&&(rt=t.getValueOfDouble(k.CreditAvailable),rt<=0&&n.ADialog.info("CreditOver"))))));pt=t.getValueOfInt(u.getValue("C_PaymentTerm_ID"));y=t.getValueOfInt(g?s.C_PaymentTerm_ID:s.PO_PaymentTerm_ID);y!=0?u.setValue("C_PaymentTerm_ID",y):u.setValue("C_PaymentTerm_ID",null)}}catch(wt){return this.setCalloutActive(!1),wt}this.setCalloutActive(!1);o=null};w.prototype.UpdateIsSOTrx=function(n,t,i,r,u){if(this.isCalloutActive()||u==null||u.toString()==""||u==!1)return"";this.setCalloutActive(!0);n.setIsSOTrx(t,u=="ASR"?!0:!1);this.setCalloutActive(!1)};n.Model.CalloutOrderContract=w;n.Utility.inheritPrototype(ht,n.CalloutEngine);ht.prototype.CalculationSelection=function(n,t,i,r,u){return this.isCalloutActive()||u==null||u.toString()==""||u==!1?"":(this.setCalloutActive(!0),r.getColumnName()=="IsSum"?(i.setValue("IsMaximum",!1),i.setValue("IsCount",!1),i.setValue("IsMinimum",!1)):r.getColumnName()=="IsMaximum"?(i.setValue("IsSum",!1),i.setValue("IsMinimum",!1),i.setValue("IsCount",!1)):r.getColumnName()=="IsCount"?(i.setValue("IsMaximum",!1),i.setValue("IsSum",!1),i.setValue("IsMinimum",!1)):r.getColumnName()=="IsMinimum"&&(i.setValue("IsSum",!1),i.setValue("IsCount",!1),i.setValue("IsMaximum",!1)),this.setCalloutActive(!1),"")};ht.prototype.UpdateKPITableInContext=function(n,t,i,r,u){return this.isCalloutActive()||u==null||u.toString()==""?"":(this.setCalloutActive(!0),u==!0?(i.setValue("AD_Table_ID",-1),i.setValue("AD_Tab_ID",-1),n.setContext(t,"AD_Table_ID",-1),n.setContext(t,"AD_Tab_ID",-1)):(i.setValue("TableView_ID",-1),n.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1),"")};ht.prototype.UpdateTabIDContext=function(n,t,i,r,u){return this.isCalloutActive()?"":(this.setCalloutActive(!0),u<1||u==null||u.toString()==""?(i.setValue("AD_Tab_ID",-1),n.setContext(t,"AD_Tab_ID",-1)):n.setContext(t,"AD_Tab_ID",u),this.setCalloutActive(!1),"")};n.Model.CalloutKPI=ht;n.Utility.inheritPrototype(d,n.CalloutEngine);d.prototype.UpdateTableInContext=function(n,t,i,r,u){return this.isCalloutActive()?"":(this.setCalloutActive(!0),u==!0?(i.setValue("AD_Table_ID",-1),i.setValue("AD_Tab_ID",-1),n.setContext(t,"AD_Table_ID",-1),n.setContext(t,"AD_Tab_ID",-1)):(i.setValue("TableView_ID",-1),n.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1),"")};d.prototype.UpdateTabIDContext=function(n,t,i,r,u){return this.isCalloutActive()?"":(this.setCalloutActive(!0),u<1||u==null||u.toString()==""?(i.setValue("AD_Tab_ID",-1),n.setContext(t,"AD_Tab_ID",-1)):(n.setContext(t,"AD_Tab_ID",u),i.setValue("TableView_ID",-1),n.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1),"")};d.prototype.UpdateTableViewIDOnTableContext=function(n,t,i,r,u){return this.isCalloutActive()||u==null||u.toString()==""?"":(this.setCalloutActive(!0),u>0&&(i.setValue("TableView_ID",-1),n.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1),"")};d.prototype.SelectFunctionOnDashboard=function(n,i,r,u,f){if(this.isCalloutActive()||f==null||f.toString()==""||f==!1)return"";this.setCalloutActive(!0);var e=t.getValueOfBoolean(f);return u.getColumnName()=="IsSum"?(r.setValue("IsAvg",!1),r.setValue("IsCount",!1),r.setValue("IsNone",!1)):u.getColumnName()=="IsAvg"?(r.setValue("IsSum",!1),r.setValue("IsCount",!1),r.setValue("IsNone",!1)):u.getColumnName()=="IsCount"?(r.setValue("IsSum",!1),r.setValue("IsAvg",!1),r.setValue("IsNone",!1)):u.getColumnName()=="IsNone"&&(r.setValue("IsSum",!1),r.setValue("IsCount",!1),r.setValue("IsAvg",!1)),this.setCalloutActive(!1),""};d.prototype.ValueCheck=function(n,t,i,r,u,f){if(this.isCalloutActive())return"";this.setCalloutActive(!0);var e=i.getValue("LastNValue");return e>60&&i.setValue("LastNValue",1),this.setCalloutActive(!1),n=t=i=r=u=f=null,""};n.Model.CalloutDashboard=d;n.Utility.inheritPrototype(ct,n.CalloutEngine);ct.prototype.UpdateTabIDContext=function(n,t,i,r,u){return this.isCalloutActive()?"":(this.setCalloutActive(!0),u<1||u==null||u.toString()==""?(i.setValue("AD_Tab_ID",-1),n.setContext(t,"AD_Tab_ID",-1)):n.setContext(t,"AD_Tab_ID",u),this.setCalloutActive(!1),"")};ct.prototype.GroupByChecked=function(t,i,r,u,f){if(this.isCalloutActive()||f==null)return"";this.setCalloutActive(!0);var e="UPDATE RC_ViewColumn SET IsGroupBy='N' WHERE RC_View_ID="+r.getValue("RC_View_ID")+" AND RC_ViewColumn_ID NOT IN("+r.getValue("RC_ViewColumn_ID")+")",o=n.DB.executeQuery(e);return this.setCalloutActive(!1),""};ct.prototype.IsViewChecked=function(n,t,i,r,u){return this.isCalloutActive()||u==null?"":(this.setCalloutActive(!0),u?(i.setValue("AD_Tab_ID",-1),i.setValue("AD_Table_ID",-1),n.setContext(t,"AD_Tab_ID",-1),n.setContext(t,"AD_Table_ID",-1)):(i.setValue("TableView_ID",-1),n.setContext(t,"TableView_ID",-1)),this.setCalloutActive(!1),"")};n.Model.CalloutDashboardView=ct;n.Utility.inheritPrototype(tr,n.CalloutEngine);tr.prototype.StatisticGroup=function(n,t,i,r,u){return u==null||u.toString()==""?"":(i.setValue("FO_STATISTICSUBGROUP_ID",0),"")};n.Model.CalloutService=tr;n.Utility.inheritPrototype(ri,n.CalloutEngine);ri.prototype.SetReadnly=function(n,i,r,u,f){return f==null||f.toString()==""||f.toString()=="E"?(this.setCalloutActive(!1),f!=null&&f.toString()=="E"&&(r.getField("VSS_PAYMENTTYPE").setReadOnly(!0),r.setValue("VSS_PAYMENTTYPE","P")),""):(this.setCalloutActive(!0),t.getValueOfString(r.getValue("CashType"))=="A"||t.getValueOfString(r.getValue("CashType"))=="E"?(r.setValue("VSS_PAYMENTTYPE","P"),r.getField("VSS_PAYMENTTYPE").setReadOnly(!0)):t.getValueOfString(r.getValue("CashType"))=="F"||t.getValueOfString(r.getValue("CashType"))=="R"?(r.setValue("VSS_PAYMENTTYPE","R"),r.getField("VSS_PAYMENTTYPE").setReadOnly(!0)):t.getValueOfString(r.getValue("CashType"))=="I"||t.getValueOfString(r.getValue("CashType"))=="O"?r.getField("VSS_PAYMENTTYPE").setReadOnly(!0):r.getField("VSS_PAYMENTTYPE").setReadOnly(!1),t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="P"||t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="E"?t.getValueOfDecimal(r.getValue("amount"))>0&&r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount"))):(t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="R"||t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="A")&&t.getValueOfDecimal(r.getValue("amount"))<0&&r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount"))),this.setCalloutActive(!1),"")};ri.prototype.SetAmountValue=function(n,i,r,u,f){if(f==null||f.toString()=="")return r.getField("VSS_PAYMENTTYPE").setReadOnly(!1),this.setCalloutActive(!1),"";if(this.setCalloutActive(!0),t.getValueOfString(r.getValue("CashType"))!="B")t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="P"?t.getValueOfDecimal(r.getValue("amount"))>0&&r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount"))):t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"))=="R"&&t.getValueOfDecimal(r.getValue("amount"))<0&&r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount")));else if(t.getValueOfString(r.getValue("CashType"))=="B"){var e=t.getValueOfString(r.getValue("VSS_PAYMENTTYPE"));(e=="P"||e=="E")&&t.getValueOfDecimal(r.getValue("amount"))>0?(r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount"))),r.setValue("ConvertedAmount",0-t.getValueOfDecimal(r.getValue("ConvertedAmount")))):(e=="R"||e=="A")&&t.getValueOfDecimal(r.getValue("amount"))<0&&(r.setValue("Amount",0-t.getValueOfDecimal(r.getValue("amount"))),r.setValue("ConvertedAmount",0-t.getValueOfDecimal(r.getValue("ConvertedAmount"))))}return this.setCalloutActive(!1),""};n.Model.CalloutSetReadOnly=ri;n.Utility.inheritPrototype(ir,n.CalloutEngine);ir.prototype.SetContract=function(i,r,u,f,e){if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{var s=i.getContextAsInt(r,"M_Product_ID"),h=s.toString().concat(","),o=i.getWindowContext(r,"ProductType",!0);t.getValueOfString(o)==""&&(o=n.dataContext.getJSONRecord("MProduct/GetProductType",h));o=="S"?u.getField("IsContract").setReadOnly(!1):(u.getValue("IsContract",!1),u.getField("IsContract").setReadOnly(!0))}catch(c){this.log.severe(c.toString())}return this.setCalloutActive(!1),""};n.Model.CalloutSetContract=ir;n.Utility.inheritPrototype(ui,n.CalloutEngine);ui.prototype.WorkflowType=function(i,r,u,f,e){var s,o;if(e==null||e.toString()=="")return"";if(this.setCalloutActive(!0),s=t.getValueOfString(e.toString()),s=="R"){if(o=t.getValueOfInt(n.DB.executeScalar("SELECT AD_Table_ID FROM AD_Table WHERE IsActive='Y' AND TableName= 'VADMS_MetaData'")),o==0)return n.ADialog.info("No_VADMS",null,"",""),n.Msg.getMsg("No_VADMS");u.setValue("AD_Table_ID",o)}return this.setCalloutActive(!1),""};ui.prototype.SetSelectedColumn=function(i,r,u,f,e){return e==null||e.toString()==""?"":(this.setCalloutActive(!0),t.getValueOfString(n.DB.executeScalar("SELECT ColumnName FROM AD_Column WHERE AD_Column_ID="+e)).toLower()=="C_GenAttributeSetInstance_ID".toLower()?i.setContext(r,"IsGenericAttribute","Y"):i.setContext(r,"IsGenericAttribute","N"),this.setCalloutActive(!1),"")};n.Model.CallOutWorkflow=ui;n.Utility.inheritPrototype(rr,n.CalloutEngine);rr.prototype.GetPaymentNote=function(t,i,r,u,f){if(f==null||f.toString()==""||f==""||this.isCalloutActive())return"";this.setCalloutActive(!0);var e=n.dataContext.getJSONRecord("MPaymentTerm/GetPaymentNote",f.toString());return e!=null&&r.setValue("description",e.DocumentNote),this.setCalloutActive(!1),""};n.Model.CalloutSalesQuotation=rr;n.Utility.inheritPrototype(ur,n.CalloutEngine);ur.prototype.SetDate=function(i,r,u,f,e,o){var h,s,c;if(e==null||e.toString()=="")return"";if(u.getValue("StartDate")==null||u.getValue("NoofCycle")==null)return this.setCalloutActive(!1),"";try{this.setCalloutActive(!0);h="";h=n.dataContext.getJSONRecord("MOrderLine/GetNoOfMonths",t.getValueOfString(u.getValue("C_Frequency_ID")));s=new Date(u.getValue("StartDate"));c=s.setMonth(s.getMonth()+h*t.getValueOfInt(u.getValue("NoofCycle")));c=new Date(s.setDate(s.getDate()-1));u.setValue("EndDate",c.toISOString());i=r=u=f=e=o=null;this.setCalloutActive(!1)}catch(l){}return""};n.Model.CalloutSetDate=ur;n.Utility.inheritPrototype(fr,n.CalloutEngine);fr.prototype.DisplayButton=function(i,r,u,f,e){if(e==null||e.toString()=="")return"";if(t.getValueOfInt(u.getValue("C_DocTypeTarget_ID"))!=0){var o=n.dataContext.getJSONRecord("MDocType/GetDocSubType",e.toString());o=="WR"||o=="WI"?u.setValue("InvoicePrint","Y"):u.setValue("InvoicePrint","N")}else return this.setCalloutActive(!1),"";return this.setCalloutActive(!1),""};n.Model.CalloutDisplayButton=fr;n.Utility.inheritPrototype(er,n.CalloutEngine);er.prototype.SetQty=function(n,i,r,u,f){if(this.isCalloutActive()||f==null||f.toString()=="")return"";if(this.setCalloutActive(!0),t.getValueOfDecimal(r.getValue("TargetQty"))<t.getValueOfDecimal(r.getValue("ConfirmedQty")))return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";if(u.getColumnName()=="ConfirmedQty"){if(t.getValueOfDecimal(r.getValue("ConfirmedQty"))<0)return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";r.setValue("ScrappedQty",0);r.setValue("DifferenceQty",t.getValueOfDecimal(r.getValue("TargetQty"))-(t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty"))))}else if(u.getColumnName()=="DifferenceQty"){if(t.getValueOfDecimal(r.getValue("TargetQty"))<t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("DifferenceQty")))return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";r.setValue("ScrappedQty",t.getValueOfDecimal(r.getValue("TargetQty"))-(t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("DifferenceQty"))))}else if(u.getColumnName()=="ScrappedQty"){if(t.getValueOfDecimal(r.getValue("ScrappedQty"))<0||t.getValueOfDecimal(r.getValue("TargetQty"))<t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty")))return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";r.setValue("DifferenceQty",t.getValueOfDecimal(r.getValue("TargetQty"))-(t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty"))))}return this.setCalloutActive(!1),""};n.Model.CalloutMoveConfirmLine=er;n.Utility.inheritPrototype(fi,n.CalloutEngine);fi.prototype.SetSalesQuotation=function(n,i,r,u,f){if(this.isCalloutActive()||f==null||f.toString()=="")return"";try{this.setCalloutActive(!0);t.getValueOfString(r.getValue("DocSubTypeSO"))=="OB"||t.getValueOfString(r.getValue("DocSubTypeSO"))=="ON"?r.setValue("IsSalesQuotation",!0):r.setValue("IsSalesQuotation",!1)}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),""};fi.prototype.Organization=function(t,i,r,u,f){var o,e;if(this.isCalloutActive()||f==null||f.toString()=="")return"";try{this.setCalloutActive(!0);o="";r.getField("M_Warehouse_ID")!=null&&(e=n.dataContext.getJSONRecord("MDocType/GetWarehouse",f.toString()),e>0?r.getTableName()=="M_Movement"&&r.getField("DTD001_MWarehouseSource_ID")!=null?r.setValue("DTD001_MWarehouseSource_ID",e):r.setValue("M_Warehouse_ID",e):r.getTableName()=="M_Movement"&&r.getField("DTD001_MWarehouseSource_ID")!=null?r.setValue("DTD001_MWarehouseSource_ID",0):r.setValue("M_Warehouse_ID",0))}catch(s){return this.setCalloutActive(!1),s}return this.setCalloutActive(!1),""};n.Model.CalloutDocumentType=fi;n.Utility.inheritPrototype(or,n.CalloutEngine);or.prototype.SetAddress=function(i,r,u,f,e){var o,s,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{this.setCalloutActive(!0);f.getColumnName()=="C_BPartner_ID"?(u.getField("Ref_BPartner_ID")!=null&&u.setValue("Ref_BPartner_ID",e),o=null,o=n.dataContext.getJSONRecord("MBPartner/GetBPData",t.getValueOfString(u.getValue("C_BPartner_ID"))),o!=null&&(s=n.Utility.Util.getValueOfInt(o.C_BPartner_Location_ID),s==0?u.setValue("C_BPartner_Location_ID",null):u.setValue("C_BPartner_Location_ID",s),h=n.Utility.Util.getValueOfInt(o.AD_User_ID),h==0?u.setValue("AD_User_ID",null):u.setValue("AD_User_ID",h))):f.getColumnName()=="C_BPartnerSR_ID"&&(u.getField("Ref_BPartner_ID")!=null&&u.setValue("Ref_BPartner_ID",e),o=null,o=n.dataContext.getJSONRecord("MBPartner/GetBPData",t.getValueOfString(u.getValue("C_BPartnerSR_ID"))),o!=null&&(s=n.Utility.Util.getValueOfInt(o.C_BPartner_Location_ID),s==0?u.setValue("C_BPartner_Location_ID",null):u.setValue("C_BPartner_Location_ID",s),h=n.Utility.Util.getValueOfInt(o.AD_User_ID),h==0?u.setValue("AD_User_ID",null):u.setValue("AD_User_ID",h)))}catch(c){return this.setCalloutActive(!1),c}return this.setCalloutActive(!1),""};n.Model.CalloutProjectCBPartner=or;n.Utility.inheritPrototype(sr,n.CalloutEngine);sr.prototype.SetPaymentType=function(n,t,i,r,u){if(this.isCalloutActive()||u==null||u.toString()=="")return"";try{if(this.setCalloutActive(!0),r.getColumnName()=="PaymentRule")if(i.getValue("PaymentRule")==null)i.setValue("PaymentMethod",null);else{var f=i.getValue("PaymentRule");i.setValue("PaymentMethod",f)}}catch(e){return this.setCalloutActive(!1),e}return this.setCalloutActive(!1),""};n.Model.CalloutPaymentTypeSO=sr;n.Utility.inheritPrototype(hr,n.CalloutEngine);hr.prototype.DateRequired=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);try{var s,o;s=new Date(r.getValue("DateContract"));o=new Date(r.getValue("DateFinish"));o.toISOString()<s.toISOString()&&(r.setValue("DateFinish",""),this.setCalloutActive(!1),n.ADialog.info("DateInvalid",null,"",""));this.log.fine("DateFinish="+o)}catch(h){return n.ADialog.info("DateError"+h,null,"",""),this.setCalloutActive(!1),h}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};n.Model.CalloutMCampaign=hr;n.Utility.inheritPrototype(ei,n.CalloutEngine);ei.prototype.DateRequired=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);try{var s,o;s=new Date(r.getValue("StartDate"));o=new Date(r.getValue("CloseDate"));o.toISOString()<s.toISOString()&&(r.setValue("CloseDate",""),this.setCalloutActive(!1),n.ADialog.info("CloseDateInvalid",null,"",""));this.log.fine("CloseDate="+o)}catch(h){return n.ADialog.info("error in Date"+h,null,"",""),this.setCalloutActive(!1),h}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};ei.prototype.PlanDateRequired=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);try{var s,o;s=new Date(r.getValue("DateStartPlan"));o=new Date(r.getValue("DateCompletePlan"));o.toISOString()<s.toISOString()&&(r.setValue("DateCompletePlan",""),this.setCalloutActive(!1),n.ADialog.info("CmpDateInvalid",null,"",""));this.log.fine("DateCompletePlan="+o)}catch(h){return n.ADialog.info("error in Date"+h,null,"",""),this.setCalloutActive(!1),h}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};n.Model.CalloutMRequest=ei;n.Utility.inheritPrototype(lt,n.CalloutEngine);lt.prototype.GenerateMenuItemExportID=function(n,t,i,r,u){var f,e,o;return u==null||u.toString()==""?"":(f=n.getContext(t,"Prefix"),i.getValue("MenuItemExport_ID")==null&&i.getValue("IsMenuItem").toString()=="true"&&(e=new Date,o=f+e.getTime(),i.setValue("MenuItemExport_ID",o)),this.setCalloutActive(!1),"")};lt.prototype.GenerateVersionID=function(n,t,i,r,u){if(u==null||u.toString()=="")return"";var f=n.getContext(t,"VersionNo"),e=f.replace(".","");return i.setValue("VersionID",e),this.setCalloutActive(!1),""};lt.prototype.CheckBoxValidation=function(n,i,r,u,f){var o,e;return f==null||f.toString()==""?"":(o=t.getValueOfBoolean(f),o==!0&&(e=u.getColumnName(),e=="IsProfessionalFree"?(r.setValue("IsProfessionalPaid",!1),r.setValue("IsFree",!1),r.setValue("IsPaid",!1)):e=="IsProfessionalPaid"?(r.setValue("IsProfessionalFree",!1),r.setValue("IsFree",!1),r.setValue("IsPaid",!1)):e=="IsFree"?(r.setValue("IsProfessionalPaid",!1),r.setValue("IsProfessionalFree",!1),r.setValue("IsPaid",!1)):e=="IsPaid"&&(r.setValue("IsProfessionalPaid",!1),r.setValue("IsFree",!1),r.setValue("IsProfessionalFree",!1))),this.setCalloutActive(!1),"")};n.Model.CalloutModuleMgmt=lt;n.Utility.inheritPrototype(cr,n.CalloutEngine);cr.prototype.SetUOM=function(t,i,r,u,f,e){if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);r.getField("M_AttributeSetInstance_ID")!=null&&r.setValue("M_AttributeSetInstance_ID",null);try{var o=n.dataContext.getJSONRecord("MProduct/GetC_UOM_ID",f.toString());r.setValue("C_UOM_ID",o)}catch(s){this.setCalloutActive(!1);this.log.severe(s.toString())}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};n.Model.CalloutPriclistUOM=cr;n.Utility.inheritPrototype(at,n.CalloutEngine);at.prototype.PaymentTaxAmount=function(i,r,u,f,e,o){var a,l,s,c,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{if(a=n.dataContext.getJSONRecord("MCurrency/GetCurrency",u.getValue("C_Currency_ID").toString()),l=a.StdPrecision,f.getColumnName()=="C_Tax_ID"){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",e.toString()+","+u.getValue("PayAmt").toString()+","+l.toString()),u.setValue("TaxAmount",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",e.toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("PayAmt"))-t.getValueOfDecimal(u.getValue("PayAmt"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmount",h);else return u.setValue("TaxAmount",0),this.setCalloutActive(!1),""}else if(t.getValueOfInt(u.getValue("C_Tax_ID"))>0){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",u.getValue("C_Tax_ID").toString()+","+u.getValue("PayAmt").toString()+","+l.toString()),u.setValue("TaxAmount",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",u.getValue("C_Tax_ID").toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("PayAmt"))-t.getValueOfDecimal(u.getValue("PayAmt"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmount",h);else return u.setValue("TaxAmount",0),this.setCalloutActive(!1),""}else return this.setCalloutActive(!1),""}catch(v){this.setCalloutActive(!1);this.log.severe(v.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};at.prototype.CashLineTaxAmount=function(i,r,u,f,e,o){var a,l,s,c,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{if(a=n.dataContext.getJSONRecord("MCurrency/GetCurrency",i.getContext(r,"C_Currency_ID").toString()),l=a.StdPrecision,f.getColumnName()=="C_Tax_ID")if(t.getValueOfDecimal(u.getValue("Amount"))!=0){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",e.toString()+","+u.getValue("Amount").toString()+","+l.toString()),u.setValue("TaxAmt",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",e.toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("Amount"))-t.getValueOfDecimal(u.getValue("Amount"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmt",h);else return u.setValue("TaxAmt",0),this.setCalloutActive(!1),""}else return this.setCalloutActive(!1),"";else if(t.getValueOfInt(u.getValue("C_Tax_ID"))>0){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",u.getValue("C_Tax_ID").toString()+","+u.getValue("Amount").toString()+","+l.toString()),u.setValue("TaxAmt",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",u.getValue("C_Tax_ID").toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("Amount"))-t.getValueOfDecimal(u.getValue("Amount"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmt",h);else return u.setValue("TaxAmt",0),this.setCalloutActive(!1),""}else return this.setCalloutActive(!1),""}catch(v){this.setCalloutActive(!1);this.log.severe(v.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};at.prototype.BankStatementLineTaxAmount=function(i,r,u,f,e,o){var a,v,l,s,c,h;if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);a="";try{if(a=u.getValue("C_Currency_ID").toString(),v=n.dataContext.getJSONRecord("MCurrency/GetCurrency",a),l=v.StdPrecision,f.getColumnName()=="C_Tax_ID")if(t.getValueOfDecimal(u.getValue("ChargeAmt"))!=0){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",e.toString()+","+u.getValue("ChargeAmt").toString()+","+l.toString()),u.setValue("TaxAmt",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",e.toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("ChargeAmt"))-t.getValueOfDecimal(u.getValue("ChargeAmt"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmt",h);else return u.setValue("TaxAmt",0),this.setCalloutActive(!1),i=r=u=f=e=o=null,""}else return this.setCalloutActive(!1),i=r=u=f=e=o=null,"";else if(t.getValueOfInt(u.getValue("C_Tax_ID"))>0){if(s=null,u.getField("SurchargeAmt")!=null)return s=n.dataContext.getJSONRecord("MTax/CalculateSurcharge",u.getValue("C_Tax_ID").toString()+","+u.getValue("ChargeAmt").toString()+","+l.toString()),u.setValue("TaxAmt",s.TaxAmt),u.setValue("SurchargeAmt",s.SurchargeAmt),this.setCalloutActive(!1),"";if(s=n.dataContext.getJSONRecord("MTax/GetTaxRate",u.getValue("C_Tax_ID").toString()),c=t.getValueOfDecimal(s),c>0)h=t.getValueOfDecimal(t.getValueOfDecimal(u.getValue("ChargeAmt"))-t.getValueOfDecimal(u.getValue("ChargeAmt"))/(c/100+1)),h=t.getValueOfDecimal(h.toFixed(l)),u.setValue("TaxAmt",h);else return u.setValue("TaxAmt",0),this.setCalloutActive(!1),i=r=u=f=e=o=null,""}else return this.setCalloutActive(!1),i=r=u=f=e=o=null,""}catch(y){this.setCalloutActive(!1);this.log.severe(y.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutTaxAmount=at;n.Utility.inheritPrototype(lr,n.CalloutEngine);lr.prototype.SetProdCatValues=function(i,r,u,f,e,o){var s,l,a;if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{var h="SELECT IsActive ",v=t.getValueOfInt(n.DB.executeScalar("SELECT COUNT(AD_MODULEINFO_ID) FROM AD_MODULEINFO WHERE PREFIX='VA038_' ")),c=t.getValueOfInt(n.DB.executeScalar("SELECT COUNT(AD_MODULEINFO_ID) FROM AD_MODULEINFO WHERE PREFIX='DTD001_' "));c>0&&(h+=" , producttype ");c>0&&(h+=" , m_attributeset_id, c_taxcategory_id ");h+=" FROM M_Product_Category WHERE m_product_category_id="+t.getValueOfInt(e);s=n.DB.executeDataSet(h);s!=null&&s.tables[0].rows.length>0&&(t.getValueOfInt(n.DB.executeScalar("SELECT COUNT(AD_MODULEINFO_ID) FROM AD_MODULEINFO WHERE PREFIX='DTD001_' "))>0&&(s.tables[0].rows[0].cells.producttype!=null||t.getValueOfString(s.tables[0].rows[0].cells.producttype)!=""?u.setValue("PRODUCTTYPE",s.tables[0].rows[0].cells.producttype):u.setValue("PRODUCTTYPE","")),c>0&&(s.tables[0].rows[0].cells.m_attributeset_id!=null||t.getValueOfString(s.tables[0].rows[0].cells.m_attributeset_id)!=""?u.setValue("M_AttributeSet_ID",t.getValueOfInt(s.tables[0].rows[0].cells.m_attributeset_id)):u.setValue("M_AttributeSet_ID",0),s.tables[0].rows[0].cells.c_taxcategory_id!=null||t.getValueOfString(s.tables[0].rows[0].cells.c_taxcategory_id)!=""?u.setValue("C_TaxCategory_ID",t.getValueOfInt(s.tables[0].rows[0].cells.c_taxcategory_id)):u.setValue("C_TaxCategory_ID",0)));v>0&&(t.getValueOfString(s.tables[0].rows[0].cells.producttype)=="E"||t.getValueOfString(s.tables[0].rows[0].cells.producttype)=="S"?(l=t.getValueOfInt(n.DB.executeScalar("SELECT A_Asset_Group_ID FROM M_Product_Category WHERE M_Product_Category_ID="+t.getValueOfInt(e))),l>0?(a=t.getValueOfInt(n.DB.executeScalar("SELECT VA038_AmortizationTemplate_ID FROM A_Asset_Group WHERE A_Asset_Group_ID="+l)),a>0?u.setValue("VA038_AmortizationTemplate_ID",a):u.setValue("VA038_AmortizationTemplate_ID",0)):u.setValue("VA038_AmortizationTemplate_ID",0)):u.setValue("VA038_AmortizationTemplate_ID",0))}catch(y){this.setCalloutActive(!1);this.log.severe(y.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutProdCatVal=lr;n.Utility.inheritPrototype(ar,n.CalloutEngine);ar.prototype.SetProdTypeValues=function(n,t,i,r,u,f){if(this.isCalloutActive()||u==null||u.toString()=="")return"";this.setCalloutActive(!0);try{u!="I"&&i.setValue("IsStocked",!1)}catch(e){this.setCalloutActive(!1);this.log.severe(e.toString())}return this.setCalloutActive(!1),n=t=i=r=u=f=null,""};n.Model.CalloutProdTypeVal=ar;n.Utility.inheritPrototype(vr,n.CalloutEngine);vr.prototype.SetProfitBeforeTax=function(i,r,u,f,e,o){if(e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";this.setCalloutActive(!0);try{var s=n.dataContext.getJSONRecord("MProfitTax/GetProfitLossDetails",e.toString());Object.keys(s).length>0&&(u.setValue("ProfitBeforeTax",t.getValueOfDecimal(s.ProfitBeforeTax)),u.setValue("C_Year_ID",t.getValueOfInt(s.C_Year_ID)),u.setValue("C_ProfitAndLoss_ID",t.getValueOfInt(s.C_ProfitAndLoss_ID)))}catch(h){this.setCalloutActive(!1);this.log.severe(h.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutProfitTax=vr;n.Utility.inheritPrototype(yr,n.CalloutEngine);yr.prototype.BPGroup=function(i,r,u,f,e,o){if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{var a="select M_ReturnPolicy_ID, M_DiscountSchema_ID, M_PRICELIST_ID, PO_PriceList_ID,PO_DiscountSchema_ID,PO_ReturnPolicy_ID from C_BP_Group where C_BP_Group_ID="+t.getValueOfInt(e),s=n.DB.executeDataSet(a),v=u.getValue("IsCustomer"),y=u.getValue("IsVendor");if(v&&s!=null&&s.tables[0].rows.length>0){var h=t.getValueOfInt(s.tables[0].rows[0].cells.m_returnpolicy_id),c=t.getValueOfInt(s.tables[0].rows[0].cells.m_discountschema_id),l=t.getValueOfInt(s.tables[0].rows[0].cells.m_pricelist_id);u.setValue("M_ReturnPolicy_ID",h);u.setValue("M_DiscountSchema_ID",c);u.setValue("M_PRICELIST_ID",l)}y&&s!=null&&s.tables[0].rows.length>0&&(h=t.getValueOfInt(s.tables[0].rows[0].cells.po_returnpolicy_id),c=t.getValueOfInt(s.tables[0].rows[0].cells.po_discountschema_id),l=t.getValueOfInt(s.tables[0].rows[0].cells.po_pricelist_id),u.setValue("PO_ReturnPolicy_ID",h),u.setValue("PO_DiscountSchema_ID",c),u.setValue("PO_PriceList_ID",l))}catch(p){this.setCalloutActive(!1);this.log.severe(p.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutBPartner=yr;n.Utility.inheritPrototype(pr,n.CalloutEngine);pr.prototype.DocType=function(i,r,u,f,e,o){var s,h,c,l,a;if(e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";this.setCalloutActive(!0);try{sql="SELECT M_Product_ID , movementqty , M_AttributeSetInstance_ID FROM M_InOutLine WHERE M_InOutLine_ID="+t.getValueOfInt(e);s=n.DB.executeDataSet(sql);h=0;s.getTables().length>0&&s.getTables()[0].getRows().length>0&&(c=t.getValueOfInt(s.getTables()[0].getRows()[0].getCell("M_Product_ID")),h=t.getValueOfDecimal(s.getTables()[0].getRows()[0].getCell("movementqty")),l=t.getValueOfInt(s.getTables()[0].getRows()[0].getCell("M_AttributeSetInstance_ID")));sql="SELECT  SUM(ConfirmedQty + scrappedqty) FROM M_PackageLine WHERE  M_Package_ID="+u.getValue("M_Package_ID")+" and m_inoutline_id =  "+u.getValue("M_InOutLine_ID");a=t.getValueOfDecimal(n.DB.executeScalar(sql));u.setValue("M_Product_ID",c);u.setValue("Qty",h-a);u.setValue("M_AttributeSetInstance_ID",l);u.setValue("DTD001_IsConfirm",!0)}catch(v){this.setCalloutActive(!1);this.log.severe(v.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutshipLine=pr;n.Utility.inheritPrototype(wr,n.CalloutEngine);wr.prototype.SetMaxRunZero=function(n,t,i,r,u,f){if(u==null||u.toString()=="")return"";this.setCalloutActive(!0);var e=i.getValue("RunsMax");return e!=""&&e>0&&i.setValue("RunsRemaining",0),this.setCalloutActive(!1),n=t=i=r=u=f=null,""};n.Model.CalloutRecurring=wr;n.Utility.inheritPrototype(br,n.CalloutEngine);br.prototype.SetChargeAmount=function(t,i,r,u,f,e){if(f==null||f.toString()=="")return"";this.setCalloutActive(!0);try{var s=f.toString(),o=n.dataContext.getJSONRecord("MProductionLine/GetChargeAmt",s);o!=null&&(r.setValue("Amt",o.ChargeAmt),r.setValue("M_Product_ID",null))}catch(h){this.setCalloutActive(!1);this.log.severe(h.toString())}return this.setCalloutActive(!1),t=i=r=u=f=e=null,""};n.Model.CalloutProductionLine=br;n.Utility.inheritPrototype(oi,n.CalloutEngine);oi.prototype.SetDateFromAndDateTo=function(i,r,u,f,e,o){var h,s,c,l;if(e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{h=e.toString()+","+i.getAD_Client_ID().toString();s=n.dataContext.getJSONRecord("Common/GetPeriodFromYear",h);s!=null&&(c=t.getValueOfDate(s.STARTDATE),l=t.getValueOfDate(s.ENDDATE),u.setValue("DateFrom",c),u.setValue("DateTo",l))}catch(a){this.setCalloutActive(!1);this.log.severe(a.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};oi.prototype.SetCurrency=function(i,r,u,f,e,o){var h,s,c;if(e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{h=e.toString()+","+i.getAD_Client_ID().toString();s=n.dataContext.getJSONRecord("Common/GetCurrencyFromAccountingSchema",h);s!=null&&(c=t.getValueOfInt(s.CurrencyID),u.setValue("C_Currency_ID",c))}catch(l){this.setCalloutActive(!1);this.log.severe(l.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.CalloutProfitLoss=oi;n.Utility.inheritPrototype(kr,n.CalloutEngine);kr.prototype.SetQty=function(n,i,r,u,f){if(this.isCalloutActive()||f==null||f.toString()=="")return"";if(this.setCalloutActive(!0),t.getValueOfDecimal(r.getValue("TargetQty"))<t.getValueOfDecimal(r.getValue("ConfirmedQty")))return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";if(u.getColumnName()=="ConfirmedQty"){if(t.getValueOfDecimal(r.getValue("ConfirmedQty"))<0)return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";r.setValue("ScrappedQty",0);r.setValue("DifferenceQty",t.getValueOfDecimal(r.getValue("TargetQty"))-(t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty"))))}else if(u.getColumnName()=="ScrappedQty"){if(t.getValueOfDecimal(r.getValue("ScrappedQty"))<0||t.getValueOfDecimal(r.getValue("TargetQty"))<t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty")))return r.setValue("ConfirmedQty",t.getValueOfDecimal(r.getValue("TargetQty"))),r.setValue("DifferenceQty",0),r.setValue("ScrappedQty",0),this.setCalloutActive(!1),"";r.setValue("DifferenceQty",t.getValueOfDecimal(r.getValue("TargetQty"))-(t.getValueOfDecimal(r.getValue("ConfirmedQty"))+t.getValueOfDecimal(r.getValue("ScrappedQty"))))}return this.setCalloutActive(!1),""};n.Model.CalloutShipReceiptConfirmLine=kr;n.Utility.inheritPrototype(si,n.CalloutEngine);si.prototype.SetBPLocation=function(i,r,u,f,e){var o,c,s,l,h;if(this.isCalloutActive()||e==null||e.toString()=="")return u.setValue("C_BPartner_Location_ID",null),"";this.setCalloutActive(!0);try{if(u.getValue("CashType")=="B"||u.getValue("CashType")=="C"){if(o=u.getValue("C_BPartner_ID"),o==null||o=="")return u.setValue("C_BPartner_Location_ID",null),this.setCalloutActive(!1),"";if(c=o.toString()+","+i.getAD_Client_ID().toString(),s=n.dataContext.getJSONRecord("MCashJournal/GetBPLocation",c),s!=null){if(l=t.getValueOfInt(s.CreditStatusSettingOn),h=t.getValueOfInt(s.C_BPartner_Location_ID),l=="CL"&&h==0)return this.setCalloutActive(!1),n.Msg.getMsg("LocationNew");u.setValue("C_BPartner_Location_ID",h)}}}catch(a){this.setCalloutActive(!1);this.log.severe(a.toString())}return this.setCalloutActive(!1),""};si.prototype.setAccountNo=function(i,r,u,f,e){if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);try{var o=n.dataContext.getJSONRecord("MCashJournal/GetBankAccountData",e);o!=null&&(u.setValue("RoutingNo",t.getValueOfString(o.RoutingNo)),u.setValue("AccountNo",t.getValueOfString(o.AccountNo)))}catch(s){this.setCalloutActive(!1);this.log.severe(s.toString())}return this.setCalloutActive(!1),""};n.Model.CalloutCashJournalLine=si;n.Utility.inheritPrototype(gr,n.CalloutEngine);gr.prototype.SetMultiplyRate=function(n,t,i,r,u){if(this.isCalloutActive()||u==null||u.toString()=="")return i.setValue("MultiplyRate",0),"";this.setCalloutActive(!0);var f=i.getValue("C_UOM_ID"),e=i.getValue("C_UOM_To_ID");return f==e&&(i.setValue("DivideRate",1),i.setValue("MultiplyRate",1)),this.setCalloutActive(!1),""};n.Model.CalloutUOMConversion=gr;n.Utility.inheritPrototype(nu,n.CalloutEngine);nu.prototype.CheckIncoTerm=function(i,r,u,f,e){if(this.isCalloutActive()||e==null||e.toString()=="")return"";this.setCalloutActive(!0);var s=i.isSOTrx(r),h=0,o="";try{if(u.getTableName().startsWith("C_Order")?s&&t.getValueOfInt(u.getValue("C_Order_Quotation"))>0?(o=s+","+u.getTableName()+",C_Order_Quotation,"+t.getValueOfInt(u.getValue("C_Order_Quotation")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):!s&&t.getValueOfInt(u.getValue("Ref_Order_ID"))>0?(o=s+","+u.getTableName()+",Ref_Order_ID,"+t.getValueOfInt(u.getValue("Ref_Order_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):t.getValueOfInt(u.getValue("C_Order_Blanket"))>0&&(o=s+","+u.getTableName()+",C_Order_Blanket,"+t.getValueOfInt(u.getValue("C_Order_Blanket")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):u.getTableName().startsWith("C_Invoice")?s&&t.getValueOfInt(u.getValue("C_Order_ID"))>0?(o=s+","+u.getTableName()+",C_Order_ID,"+t.getValueOfInt(u.getValue("C_Order_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):!s&&t.getValueOfInt(u.getValue("C_Order_ID"))>0?(o=s+","+u.getTableName()+",C_Order_ID,"+t.getValueOfInt(u.getValue("C_Order_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):!s&&t.getValueOfInt(u.getValue("M_InOut_ID"))>0&&(o=s+","+u.getTableName()+",M_InOut_ID,"+t.getValueOfInt(u.getValue("M_InOut_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):u.getTableName().startsWith("M_InOut")&&(s&&t.getValueOfInt(u.getValue("C_Order_ID"))>0?(o=s+","+u.getTableName()+",C_Order_ID,"+t.getValueOfInt(u.getValue("C_Order_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):!s&&t.getValueOfInt(u.getValue("C_Order_ID"))>0?(o=s+","+u.getTableName()+",C_Order_ID,"+t.getValueOfInt(u.getValue("C_Order_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o)):!s&&t.getValueOfInt(u.getValue("C_Invoice_ID"))>0&&(o=s+","+u.getTableName()+",C_Invoice_ID,"+t.getValueOfInt(u.getValue("C_Invoice_ID")).toString(),h=n.dataContext.getJSONRecord("MOrder/GetIncoTerm",o))),h>0&h!=e)return this.setCalloutActive(!1),n.ADialog.warn("IncoTermChanged"),""}catch(c){this.setCalloutActive(!1);this.log.severe(c.toString())}return this.setCalloutActive(!1),""};n.Model.CalloutIncoTerm=nu;n.Utility.inheritPrototype(tu,n.CalloutEngine);tu.prototype.BlanketOrderRef=function(t,i,r,u,f){var o,s,e;return this.isCalloutActive()||f==null||f.toString()==""?"":(this.setCalloutActive(!0),u.getColumnName()=="Blanket_Ref_Order_ID"&&(o=n.dataContext.getJSONRecord("ModulePrefix/GetModulePrefix","VA009_"),s=o.VA009_?f.toString()+","+o.VA009_:f.toString()+",false",e=n.dataContext.getJSONRecord("MOrder/GetOrderHeader",s),e!=null&&(r.setValue("AD_Client_ID",e.AD_Client_ID),r.setValue("AD_Org_ID",e.AD_Org_ID),r.setValue("Description",e.Description),r.setValue("C_DocTypeTarget_ID",e.C_DocTypeTarget_ID),r.setValue("DateOrdered",l(e.DateOrdered)),r.setValue("DatePromised",l(e.DatePromised)),r.setValue("OrderValidFrom",l(e.OrderValidFrom)),r.setValue("OrderValidTo",l(e.OrderValidTo)),r.setValue("C_BPartner_ID",e.C_BPartner_ID),r.setValue("Bill_BPartner_ID",e.Bill_BPartner_ID),r.setValue("C_BPartner_Location_ID",e.C_BPartner_Location_ID),r.setValue("Bill_Location_ID",e.Bill_Location_ID),r.setValue("AD_User_ID",e.AD_User_ID),r.setValue("Bill_User_ID",e.Bill_User_ID),r.setValue("M_Warehouse_ID",e.M_Warehouse_ID),r.setValue("PriorityRule",e.PriorityRule),r.setValue("M_PriceList_ID",e.M_PriceList_ID),r.setValue("C_IncoTerm_ID",e.C_IncoTerm_ID),r.setValue("C_Currency_ID",e.C_Currency_ID),r.setValue("C_ConversionType_ID",e.C_ConversionType_ID),r.setValue("SalesRep_ID",e.SalesRep_ID),o.VA009_&&r.setValue("VA009_PaymentMethod_ID",e.VA009_PaymentMethod_ID),r.setValue("C_PaymentTerm_ID",e.C_PaymentTerm_ID),r.setValue("C_Campaign_ID",e.C_Campaign_ID),r.setValue("C_Activity_ID",e.C_Activity_ID),r.setValue("AD_OrgTrx_ID",e.AD_OrgTrx_ID),r.setValue("User1_ID",e.User1_ID),r.setValue("User2_ID",e.User2_ID),r.setValue("TotalLines",e.TotalLines),r.setValue("GrandTotal",e.GrandTotal))),this.setCalloutActive(!1),"")};n.Model.CalloutBlanketOrderRef=tu;n.Utility.inheritPrototype(iu,n.CalloutEngine);iu.prototype.SetLocatorPC=function(n,t,i,r,u,f){return this.isCalloutActive()||u==null||u.toString()==""?"":(this.setCalloutActive(!0),r.getColumnName()=="M_Warehouse_ID"?u!=f&&(i.setValue("M_Locator_ID",""),i.setValue("Ref_M_Container_ID","")):r.getColumnName()=="M_Locator_ID"&&u!=f&&i.setValue("Ref_M_Container_ID",""),this.setCalloutActive(!1),n=t=i=r=u=f=null,"")};n.Model.CalloutLocatorPC=iu;n.Utility.inheritPrototype(ru,n.CalloutEngine);ru.prototype.SetDates=function(n,t,i,r,u,f){return this.isCalloutActive()||u==null||u.toString()==""?"":(this.setCalloutActive(!0),r.getColumnName()=="C_Frequency_ID"&&u!=f&&(i.setValue("StartDate",""),i.setValue("EndDate","")),this.setCalloutActive(!1),"")};n.Model.CalloutSetDates=ru;n.Utility.inheritPrototype(uu,n.CalloutEngine);uu.prototype.Product=function(n,t,i,r,u){return this.isCalloutActive()||u==null||u.toString()==""?"":(this.setCalloutActive(!0),i.getField("M_AttributeSetInstance_ID")!=null&&i.setValue("M_AttributeSetInstance_ID",null),this.setCalloutActive(!1),"")};n.Model.CalloutLandedCost=uu;n.Utility.inheritPrototype(fu,n.CalloutEngine);fu.prototype.Comparedates=function(t,i,r,u,f){if(this.isCalloutActive()||f==null||f.toString()=="")return"";this.setCalloutActive(!0);var e=new Date(r.getValue("DateWorkStart")),o=new Date(r.getValue("DateWorkComplete"));if(u.getColumnName()=="DateWorkStart"){if(e>=o&&r.getValue("DateWorkComplete")!=null)return r.setValue("DateWorkStart",""),this.setCalloutActive(!1),n.ADialog.info("DateWorkGreater")}else if(e>=o&&r.getValue("DateWorkStart")!=null)return r.setValue("DateWorkComplete",""),this.setCalloutActive(!1),n.ADialog.info("DateWorkGreater");return this.setCalloutActive(!1),""};n.Model.CalloutRFQ=fu;n.Utility.inheritPrototype(eu,n.CalloutEngine);eu.prototype.ClearWeekDay=function(t,i,r,u,f){return this.isCalloutActive()||f==null||f.toString()==""?"":(this.setCalloutActive(!0),f==!0&&(r.setValue("NetDay",""),r.setValue("WeekOffset",n.Env.ZERO)),this.setCalloutActive(!1),"")};ot.prototype.SetPrice=function(i,r,u,f,e){var o,l,s,h,c;if(e==null||e.toString()==""||this.isCalloutActive()||e==null)return"";this.setCalloutActive(!0);try{if(o="",l=i.getContextAsInt(r,"M_Product_ID"),o=l.toString().concat(",").concat(u.getValue("S_TimeExpense_ID").toString()).concat(",").concat(t.getValueOfString(u.getValue("C_UOM_ID"))),s=n.dataContext.getJSONRecord("MExpenseReport/GetPrices",o),s!=null&&(h=s.PriceStd,u.setValue("ExpenseAmt",h),u.setValue("ConvertedAmt",h)),u.getValue("C_Charge_ID")>0){c=i.getContextAsInt("#C_UOM_ID");c>0?u.setValue("C_UOM_ID",c):u.setValue("C_UOM_ID",100);var v=n.Utility.Util.getValueOfInt(u.getValue("C_Charge_ID")),y=v.toString(),a=n.dataContext.getJSONRecord("MExpenseReport/GetChargeAmount",y);u.setValue("ExpenseAmt",a);u.setValue("ConvertedAmt",a)}this.setCalloutActive(!1);return}catch(p){this.setCalloutActive(!1);this.log.severe(p.toString())}return this.setCalloutActive(!1),""};n.Model.CalloutPaymentTerm=eu;n.Utility.inheritPrototype(vt,n.CalloutEngine);vt.prototype.DateAcct=function(n,t,i,r,u,f){if(u==null||u.toString()==""||this.isCalloutActive())return"";this.setCalloutActive(!0);try{i.setValue("DateAcct",u)}catch(e){this.setCalloutActive(!1);this.log.severe(e.toString())}return this.setCalloutActive(!1),n=t=i=r=u=f=null,""};vt.prototype.PriceList=function(r,f,e,o,s,h){var l,c,a,v;if(this.isCalloutActive()||s==null||s.toString()=="")return"";try{if(l=s.toString(),t.getValueOfInt(l)==0)return"";this.setCalloutActive(!0);u&&this.log.warning("init");c=n.dataContext.getJSONRecord("MPriceList/GetPriceListDataForProvisionalInvoice",l);c!=null&&(e.setValue("IsTaxIncluded","Y"==c.IsTaxIncluded),r.setContext(f,"EnforcePriceLimit",c.EnforcePriceLimit),a=t.getValueOfInt(c.C_Currency_ID),e.setValue("C_Currency_ID",a),v=t.getValueOfInt(c.M_PriceList_Version_ID),r.setContext(f,"M_PriceList_Version_ID",v))}catch(y){return this.setCalloutActive(!1),this.log(i.SEVERE,"",y),y}return u&&this.log.warning("finish"),this.setCalloutActive(!1),r=f=e=o=s=h=null,""};vt.prototype.BPartner=function(i,r,u,f,e,o){var h,l,s,c,b,a,v,y,p,w;if(this.isCalloutActive()||e==null||e.toString()=="")return"";try{if(h=t.getValueOfInt(e),h==null||h==0)return"";this.isCalloutActive(!0);l=i.isSOTrx(r);s=n.dataContext.getJSONRecord("MBPartner/GetBPDataForProvisionalInvoice",h);s!=null&&(c=t.getValueOfInt(s[l?"M_PriceList_ID":"PO_PriceList_ID"]),c>0&&u.setValue("M_PriceList_ID",c),b=s.countVA009,b>0&&(a=0,a=l||t.getValueOfString(s.IsVendor)!="Y"?l&&t.getValueOfString(s.IsCustomer)=="Y"?t.getValueOfInt(s.VA009_PaymentMethod_ID):0:t.getValueOfInt(s.VA009_PO_PaymentMethod_ID),a==0?u.setValue("VA009_PaymentMethod_ID",null):u.setValue("VA009_PaymentMethod_ID",a)),c=t.getValueOfInt(s[l?"C_PaymentTerm_ID":"PO_PaymentTerm_ID"]),c>0&&u.setValue("C_PaymentTerm_ID",c),v=t.getValueOfInt(s.C_BPartner_Location_ID),h.toString().equals(i.getContext("C_BPartner_ID"))&&(y=i.getContext("C_BPartner_Location_ID"),y&&y.toString().length>0&&(v=parseInt(y))),v==0?u.setValue("C_BPartner_Location_ID",null):u.setValue("C_BPartner_Location_ID",v),p=t.getValueOfInt(s.AD_User_ID),h.toString().equals(i.getContext("C_BPartner_ID"))&&(w=i.getContext("AD_User_ID"),w&&w.toString().length>0&&(p=parseInt(w))),p==0?u.setValue("AD_User_ID",null):u.setValue("AD_User_ID",p))}catch(k){this.setCalloutActive(!1);this.log.severe(k.toString())}return this.setCalloutActive(!1),i=r=u=f=e=o=null,""};n.Model.ProvisionalInvoice=vt;n.Utility.inheritPrototype(ou,n.CalloutEngine);ou.prototype.SetFullName=function(n,t,i,r,u,f){if((this.isCalloutActive()||u==null||u.toString()=="")&&r.getColumnName()!="LastName")return"";this.setCalloutActive(!0);var e="";return i.getValue("Firstname")!=null&&(e=i.getValue("Firstname")),i.getValue("LastName")!=null&&i.getValue("LastName")!=""&&(e=e==""?i.getValue("LastName"):e+" "+i.getValue("LastName")),e!=""&&i.setValue("ContactName",e),this.setCalloutActive(!1),n=t=i=r=u=f=null,""};n.Model.CalloutLead=ou;n.Utility.inheritPrototype(su,n.CalloutEngine);su.prototype.CheckModule=function(i,r,u,f,e){var o,s;return this.isCalloutActive()||e==null||e.toString()==""?"":(this.setCalloutActive(!0),o=t.getValueOfString(u.getValue("SaveAttachmentOn")),o=="AB"&&(s=n.dataContext.getJSONRecord("VIS/ModulePrefix/GetModulePrefix","VA090_"),!s.VA090_))?(u.setValue("SaveAttachmentOn",null),this.setCalloutActive(!1),n.Msg.getMsg("VIS_VA090NotInstalled")):(this.setCalloutActive(!1),"")};n.Model.CalloutAzureBlob=su}(VIS,jQuery)
